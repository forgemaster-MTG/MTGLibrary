(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const g of h.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&o(g)}).observe(document,{childList:!0,subtree:!0});function i(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(d){if(d.ep)return;d.ep=!0;const h=i(d);fetch(d.href,h)}})();function af(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Nh={exports:{}},Wl={};var up;function Xv(){if(up)return Wl;up=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function i(o,d,h){var g=null;if(h!==void 0&&(g=""+h),d.key!==void 0&&(g=""+d.key),"key"in d){h={};for(var p in d)p!=="key"&&(h[p]=d[p])}else h=d;return d=h.ref,{$$typeof:a,type:o,key:g,ref:d!==void 0?d:null,props:h}}return Wl.Fragment=n,Wl.jsx=i,Wl.jsxs=i,Wl}var hp;function Jv(){return hp||(hp=1,Nh.exports=Xv()),Nh.exports}var s=Jv(),_h={exports:{}},Ue={};var fp;function Qv(){if(fp)return Ue;fp=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),g=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),_=Symbol.iterator;function I(D){return D===null||typeof D!="object"?null:(D=_&&D[_]||D["@@iterator"],typeof D=="function"?D:null)}var L={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,U={};function P(D,F,W){this.props=D,this.context=F,this.refs=U,this.updater=W||L}P.prototype.isReactComponent={},P.prototype.setState=function(D,F){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,F,"setState")},P.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function z(){}z.prototype=P.prototype;function G(D,F,W){this.props=D,this.context=F,this.refs=U,this.updater=W||L}var X=G.prototype=new z;X.constructor=G,T(X,P.prototype),X.isPureReactComponent=!0;var se=Array.isArray;function te(){}var R={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function E(D,F,W){var q=W.ref;return{$$typeof:a,type:D,key:F,ref:q!==void 0?q:null,props:W}}function S(D,F){return E(D.type,F,D.props)}function A(D){return typeof D=="object"&&D!==null&&D.$$typeof===a}function B(D){var F={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(W){return F[W]})}var O=/\/+/g;function ye(D,F){return typeof D=="object"&&D!==null&&D.key!=null?B(""+D.key):F.toString(36)}function ue(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(te,te):(D.status="pending",D.then(function(F){D.status==="pending"&&(D.status="fulfilled",D.value=F)},function(F){D.status==="pending"&&(D.status="rejected",D.reason=F)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function V(D,F,W,q,Q){var xe=typeof D;(xe==="undefined"||xe==="boolean")&&(D=null);var pe=!1;if(D===null)pe=!0;else switch(xe){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(D.$$typeof){case a:case n:pe=!0;break;case N:return pe=D._init,V(pe(D._payload),F,W,q,Q)}}if(pe)return Q=Q(D),pe=q===""?"."+ye(D,0):q,se(Q)?(W="",pe!=null&&(W=pe.replace(O,"$&/")+"/"),V(Q,F,W,"",function(Ve){return Ve})):Q!=null&&(A(Q)&&(Q=S(Q,W+(Q.key==null||D&&D.key===Q.key?"":(""+Q.key).replace(O,"$&/")+"/")+pe)),F.push(Q)),1;pe=0;var _e=q===""?".":q+":";if(se(D))for(var Te=0;Te<D.length;Te++)q=D[Te],xe=_e+ye(q,Te),pe+=V(q,F,W,xe,Q);else if(Te=I(D),typeof Te=="function")for(D=Te.call(D),Te=0;!(q=D.next()).done;)q=q.value,xe=_e+ye(q,Te++),pe+=V(q,F,W,xe,Q);else if(xe==="object"){if(typeof D.then=="function")return V(ue(D),F,W,q,Q);throw F=String(D),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return pe}function ie(D,F,W){if(D==null)return D;var q=[],Q=0;return V(D,q,"","",function(xe){return F.call(W,xe,Q++)}),q}function K(D){if(D._status===-1){var F=D._result;F=F(),F.then(function(W){(D._status===0||D._status===-1)&&(D._status=1,D._result=W)},function(W){(D._status===0||D._status===-1)&&(D._status=2,D._result=W)}),D._status===-1&&(D._status=0,D._result=F)}if(D._status===1)return D._result.default;throw D._result}var oe=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},me={map:ie,forEach:function(D,F,W){ie(D,function(){F.apply(this,arguments)},W)},count:function(D){var F=0;return ie(D,function(){F++}),F},toArray:function(D){return ie(D,function(F){return F})||[]},only:function(D){if(!A(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return Ue.Activity=j,Ue.Children=me,Ue.Component=P,Ue.Fragment=i,Ue.Profiler=d,Ue.PureComponent=G,Ue.StrictMode=o,Ue.Suspense=x,Ue.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ue.__COMPILER_RUNTIME={__proto__:null,c:function(D){return R.H.useMemoCache(D)}},Ue.cache=function(D){return function(){return D.apply(null,arguments)}},Ue.cacheSignal=function(){return null},Ue.cloneElement=function(D,F,W){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var q=T({},D.props),Q=D.key;if(F!=null)for(xe in F.key!==void 0&&(Q=""+F.key),F)!k.call(F,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&F.ref===void 0||(q[xe]=F[xe]);var xe=arguments.length-2;if(xe===1)q.children=W;else if(1<xe){for(var pe=Array(xe),_e=0;_e<xe;_e++)pe[_e]=arguments[_e+2];q.children=pe}return E(D.type,Q,q)},Ue.createContext=function(D){return D={$$typeof:g,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:h,_context:D},D},Ue.createElement=function(D,F,W){var q,Q={},xe=null;if(F!=null)for(q in F.key!==void 0&&(xe=""+F.key),F)k.call(F,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(Q[q]=F[q]);var pe=arguments.length-2;if(pe===1)Q.children=W;else if(1<pe){for(var _e=Array(pe),Te=0;Te<pe;Te++)_e[Te]=arguments[Te+2];Q.children=_e}if(D&&D.defaultProps)for(q in pe=D.defaultProps,pe)Q[q]===void 0&&(Q[q]=pe[q]);return E(D,xe,Q)},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(D){return{$$typeof:p,render:D}},Ue.isValidElement=A,Ue.lazy=function(D){return{$$typeof:N,_payload:{_status:-1,_result:D},_init:K}},Ue.memo=function(D,F){return{$$typeof:b,type:D,compare:F===void 0?null:F}},Ue.startTransition=function(D){var F=R.T,W={};R.T=W;try{var q=D(),Q=R.S;Q!==null&&Q(W,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(te,oe)}catch(xe){oe(xe)}finally{F!==null&&W.types!==null&&(F.types=W.types),R.T=F}},Ue.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ue.use=function(D){return R.H.use(D)},Ue.useActionState=function(D,F,W){return R.H.useActionState(D,F,W)},Ue.useCallback=function(D,F){return R.H.useCallback(D,F)},Ue.useContext=function(D){return R.H.useContext(D)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(D,F){return R.H.useDeferredValue(D,F)},Ue.useEffect=function(D,F){return R.H.useEffect(D,F)},Ue.useEffectEvent=function(D){return R.H.useEffectEvent(D)},Ue.useId=function(){return R.H.useId()},Ue.useImperativeHandle=function(D,F,W){return R.H.useImperativeHandle(D,F,W)},Ue.useInsertionEffect=function(D,F){return R.H.useInsertionEffect(D,F)},Ue.useLayoutEffect=function(D,F){return R.H.useLayoutEffect(D,F)},Ue.useMemo=function(D,F){return R.H.useMemo(D,F)},Ue.useOptimistic=function(D,F){return R.H.useOptimistic(D,F)},Ue.useReducer=function(D,F,W){return R.H.useReducer(D,F,W)},Ue.useRef=function(D){return R.H.useRef(D)},Ue.useState=function(D){return R.H.useState(D)},Ue.useSyncExternalStore=function(D,F,W){return R.H.useSyncExternalStore(D,F,W)},Ue.useTransition=function(){return R.H.useTransition()},Ue.version="19.2.3",Ue}var gp;function lf(){return gp||(gp=1,_h.exports=Qv()),_h.exports}var w=lf();const Tn=af(w);var kh={exports:{}},ql={},Sh={exports:{}},Ch={};var mp;function Zv(){return mp||(mp=1,(function(a){function n(V,ie){var K=V.length;V.push(ie);e:for(;0<K;){var oe=K-1>>>1,me=V[oe];if(0<d(me,ie))V[oe]=ie,V[K]=me,K=oe;else break e}}function i(V){return V.length===0?null:V[0]}function o(V){if(V.length===0)return null;var ie=V[0],K=V.pop();if(K!==ie){V[0]=K;e:for(var oe=0,me=V.length,D=me>>>1;oe<D;){var F=2*(oe+1)-1,W=V[F],q=F+1,Q=V[q];if(0>d(W,K))q<me&&0>d(Q,W)?(V[oe]=Q,V[q]=K,oe=q):(V[oe]=W,V[F]=K,oe=F);else if(q<me&&0>d(Q,K))V[oe]=Q,V[q]=K,oe=q;else break e}}return ie}function d(V,ie){var K=V.sortIndex-ie.sortIndex;return K!==0?K:V.id-ie.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;a.unstable_now=function(){return h.now()}}else{var g=Date,p=g.now();a.unstable_now=function(){return g.now()-p}}var x=[],b=[],N=1,j=null,_=3,I=!1,L=!1,T=!1,U=!1,P=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function X(V){for(var ie=i(b);ie!==null;){if(ie.callback===null)o(b);else if(ie.startTime<=V)o(b),ie.sortIndex=ie.expirationTime,n(x,ie);else break;ie=i(b)}}function se(V){if(T=!1,X(V),!L)if(i(x)!==null)L=!0,te||(te=!0,B());else{var ie=i(b);ie!==null&&ue(se,ie.startTime-V)}}var te=!1,R=-1,k=5,E=-1;function S(){return U?!0:!(a.unstable_now()-E<k)}function A(){if(U=!1,te){var V=a.unstable_now();E=V;var ie=!0;try{e:{L=!1,T&&(T=!1,z(R),R=-1),I=!0;var K=_;try{t:{for(X(V),j=i(x);j!==null&&!(j.expirationTime>V&&S());){var oe=j.callback;if(typeof oe=="function"){j.callback=null,_=j.priorityLevel;var me=oe(j.expirationTime<=V);if(V=a.unstable_now(),typeof me=="function"){j.callback=me,X(V),ie=!0;break t}j===i(x)&&o(x),X(V)}else o(x);j=i(x)}if(j!==null)ie=!0;else{var D=i(b);D!==null&&ue(se,D.startTime-V),ie=!1}}break e}finally{j=null,_=K,I=!1}ie=void 0}}finally{ie?B():te=!1}}}var B;if(typeof G=="function")B=function(){G(A)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,ye=O.port2;O.port1.onmessage=A,B=function(){ye.postMessage(null)}}else B=function(){P(A,0)};function ue(V,ie){R=P(function(){V(a.unstable_now())},ie)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(V){V.callback=null},a.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<V?Math.floor(1e3/V):5},a.unstable_getCurrentPriorityLevel=function(){return _},a.unstable_next=function(V){switch(_){case 1:case 2:case 3:var ie=3;break;default:ie=_}var K=_;_=ie;try{return V()}finally{_=K}},a.unstable_requestPaint=function(){U=!0},a.unstable_runWithPriority=function(V,ie){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var K=_;_=V;try{return ie()}finally{_=K}},a.unstable_scheduleCallback=function(V,ie,K){var oe=a.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?oe+K:oe):K=oe,V){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=K+me,V={id:N++,callback:ie,priorityLevel:V,startTime:K,expirationTime:me,sortIndex:-1},K>oe?(V.sortIndex=K,n(b,V),i(x)===null&&V===i(b)&&(T?(z(R),R=-1):T=!0,ue(se,K-oe))):(V.sortIndex=me,n(x,V),L||I||(L=!0,te||(te=!0,B()))),V},a.unstable_shouldYield=S,a.unstable_wrapCallback=function(V){var ie=_;return function(){var K=_;_=ie;try{return V.apply(this,arguments)}finally{_=K}}}})(Ch)),Ch}var pp;function e2(){return pp||(pp=1,Sh.exports=Zv()),Sh.exports}var Eh={exports:{}},rn={};var xp;function t2(){if(xp)return rn;xp=1;var a=lf();function n(x){var b="https://react.dev/errors/"+x;if(1<arguments.length){b+="?args[]="+encodeURIComponent(arguments[1]);for(var N=2;N<arguments.length;N++)b+="&args[]="+encodeURIComponent(arguments[N])}return"Minified React error #"+x+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var o={d:{f:i,r:function(){throw Error(n(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},d=Symbol.for("react.portal");function h(x,b,N){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:j==null?null:""+j,children:x,containerInfo:b,implementation:N}}var g=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(x,b){if(x==="font")return"";if(typeof b=="string")return b==="use-credentials"?b:""}return rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,rn.createPortal=function(x,b){var N=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)throw Error(n(299));return h(x,b,null,N)},rn.flushSync=function(x){var b=g.T,N=o.p;try{if(g.T=null,o.p=2,x)return x()}finally{g.T=b,o.p=N,o.d.f()}},rn.preconnect=function(x,b){typeof x=="string"&&(b?(b=b.crossOrigin,b=typeof b=="string"?b==="use-credentials"?b:"":void 0):b=null,o.d.C(x,b))},rn.prefetchDNS=function(x){typeof x=="string"&&o.d.D(x)},rn.preinit=function(x,b){if(typeof x=="string"&&b&&typeof b.as=="string"){var N=b.as,j=p(N,b.crossOrigin),_=typeof b.integrity=="string"?b.integrity:void 0,I=typeof b.fetchPriority=="string"?b.fetchPriority:void 0;N==="style"?o.d.S(x,typeof b.precedence=="string"?b.precedence:void 0,{crossOrigin:j,integrity:_,fetchPriority:I}):N==="script"&&o.d.X(x,{crossOrigin:j,integrity:_,fetchPriority:I,nonce:typeof b.nonce=="string"?b.nonce:void 0})}},rn.preinitModule=function(x,b){if(typeof x=="string")if(typeof b=="object"&&b!==null){if(b.as==null||b.as==="script"){var N=p(b.as,b.crossOrigin);o.d.M(x,{crossOrigin:N,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0})}}else b==null&&o.d.M(x)},rn.preload=function(x,b){if(typeof x=="string"&&typeof b=="object"&&b!==null&&typeof b.as=="string"){var N=b.as,j=p(N,b.crossOrigin);o.d.L(x,N,{crossOrigin:j,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0,type:typeof b.type=="string"?b.type:void 0,fetchPriority:typeof b.fetchPriority=="string"?b.fetchPriority:void 0,referrerPolicy:typeof b.referrerPolicy=="string"?b.referrerPolicy:void 0,imageSrcSet:typeof b.imageSrcSet=="string"?b.imageSrcSet:void 0,imageSizes:typeof b.imageSizes=="string"?b.imageSizes:void 0,media:typeof b.media=="string"?b.media:void 0})}},rn.preloadModule=function(x,b){if(typeof x=="string")if(b){var N=p(b.as,b.crossOrigin);o.d.m(x,{as:typeof b.as=="string"&&b.as!=="script"?b.as:void 0,crossOrigin:N,integrity:typeof b.integrity=="string"?b.integrity:void 0})}else o.d.m(x)},rn.requestFormReset=function(x){o.d.r(x)},rn.unstable_batchedUpdates=function(x,b){return x(b)},rn.useFormState=function(x,b,N){return g.H.useFormState(x,b,N)},rn.useFormStatus=function(){return g.H.useHostTransitionStatus()},rn.version="19.2.3",rn}var yp;function Sx(){if(yp)return Eh.exports;yp=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),Eh.exports=t2(),Eh.exports}var bp;function n2(){if(bp)return ql;bp=1;var a=e2(),n=lf(),i=Sx();function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function g(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function x(e){if(h(e)!==e)throw Error(o(188))}function b(e){var t=e.alternate;if(!t){if(t=h(e),t===null)throw Error(o(188));return t!==e?null:e}for(var r=e,l=t;;){var u=r.return;if(u===null)break;var f=u.alternate;if(f===null){if(l=u.return,l!==null){r=l;continue}break}if(u.child===f.child){for(f=u.child;f;){if(f===r)return x(u),e;if(f===l)return x(u),t;f=f.sibling}throw Error(o(188))}if(r.return!==l.return)r=u,l=f;else{for(var y=!1,C=u.child;C;){if(C===r){y=!0,r=u,l=f;break}if(C===l){y=!0,l=u,r=f;break}C=C.sibling}if(!y){for(C=f.child;C;){if(C===r){y=!0,r=f,l=u;break}if(C===l){y=!0,l=f,r=u;break}C=C.sibling}if(!y)throw Error(o(189))}}if(r.alternate!==l)throw Error(o(190))}if(r.tag!==3)throw Error(o(188));return r.stateNode.current===r?e:t}function N(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=N(e),t!==null)return t;e=e.sibling}return null}var j=Object.assign,_=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),G=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),S=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function B(e){return e===null||typeof e!="object"?null:(e=A&&e[A]||e["@@iterator"],typeof e=="function"?e:null)}var O=Symbol.for("react.client.reference");function ye(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===O?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case T:return"Fragment";case P:return"Profiler";case U:return"StrictMode";case se:return"Suspense";case te:return"SuspenseList";case E:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case L:return"Portal";case G:return e.displayName||"Context";case z:return(e._context.displayName||"Context")+".Consumer";case X:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case R:return t=e.displayName||null,t!==null?t:ye(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return ye(e(t))}catch{}}return null}var ue=Array.isArray,V=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},oe=[],me=-1;function D(e){return{current:e}}function F(e){0>me||(e.current=oe[me],oe[me]=null,me--)}function W(e,t){me++,oe[me]=e.current,e.current=t}var q=D(null),Q=D(null),xe=D(null),pe=D(null);function _e(e,t){switch(W(xe,t),W(Q,e),W(q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Om(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Om(t),e=Im(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F(q),W(q,e)}function Te(){F(q),F(Q),F(xe)}function Ve(e){e.memoizedState!==null&&W(pe,e);var t=q.current,r=Im(t,e.type);t!==r&&(W(Q,e),W(q,r))}function Ie(e){Q.current===e&&(F(q),F(Q)),pe.current===e&&(F(pe),Gl._currentValue=K)}var Ye,xt;function we(e){if(Ye===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ye=t&&t[1]||"",xt=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ye+e+xt}var je=!1;function Ee(e,t){if(!e||je)return"";je=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(ae){var ne=ae}Reflect.construct(e,[],he)}else{try{he.call()}catch(ae){ne=ae}e.call(he.prototype)}}else{try{throw Error()}catch(ae){ne=ae}(he=e())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(ae){if(ae&&ne&&typeof ae.stack=="string")return[ae.stack,ne.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=l.DetermineComponentFrameRoot(),y=f[0],C=f[1];if(y&&C){var H=y.split(`
`),ee=C.split(`
`);for(u=l=0;l<H.length&&!H[l].includes("DetermineComponentFrameRoot");)l++;for(;u<ee.length&&!ee[u].includes("DetermineComponentFrameRoot");)u++;if(l===H.length||u===ee.length)for(l=H.length-1,u=ee.length-1;1<=l&&0<=u&&H[l]!==ee[u];)u--;for(;1<=l&&0<=u;l--,u--)if(H[l]!==ee[u]){if(l!==1||u!==1)do if(l--,u--,0>u||H[l]!==ee[u]){var le=`
`+H[l].replace(" at new "," at ");return e.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",e.displayName)),le}while(1<=l&&0<=u);break}}}finally{je=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?we(r):""}function ke(e,t){switch(e.tag){case 26:case 27:case 5:return we(e.type);case 16:return we("Lazy");case 13:return e.child!==t&&t!==null?we("Suspense Fallback"):we("Suspense");case 19:return we("SuspenseList");case 0:case 15:return Ee(e.type,!1);case 11:return Ee(e.type.render,!1);case 1:return Ee(e.type,!0);case 31:return we("Activity");default:return""}}function Ae(e){try{var t="",r=null;do t+=ke(e,r),r=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Ce=Object.prototype.hasOwnProperty,Be=a.unstable_scheduleCallback,Vt=a.unstable_cancelCallback,ge=a.unstable_shouldYield,fe=a.unstable_requestPaint,ve=a.unstable_now,Me=a.unstable_getCurrentPriorityLevel,de=a.unstable_ImmediatePriority,De=a.unstable_UserBlockingPriority,Ze=a.unstable_NormalPriority,Mn=a.unstable_LowPriority,qt=a.unstable_IdlePriority,tn=a.log,rt=a.unstable_setDisableYieldValue,Ct=null,Yt=null;function Ln(e){if(typeof tn=="function"&&rt(e),Yt&&typeof Yt.setStrictMode=="function")try{Yt.setStrictMode(Ct,e)}catch{}}var Rt=Math.clz32?Math.clz32:jo,wo=Math.log,qi=Math.LN2;function jo(e){return e>>>=0,e===0?32:31-(wo(e)/qi|0)|0}var hs=256,oa=262144,Mt=4194304;function fs(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function gs(e,t,r){var l=e.pendingLanes;if(l===0)return 0;var u=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var C=l&134217727;return C!==0?(l=C&~f,l!==0?u=fs(l):(y&=C,y!==0?u=fs(y):r||(r=C&~e,r!==0&&(u=fs(r))))):(C=l&~f,C!==0?u=fs(C):y!==0?u=fs(y):r||(r=l&~e,r!==0&&(u=fs(r)))),u===0?0:t!==0&&t!==u&&(t&f)===0&&(f=u&-u,r=t&-t,f>=r||f===32&&(r&4194048)!==0)?t:u}function Kn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Cd(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function No(){var e=Mt;return Mt<<=1,(Mt&62914560)===0&&(Mt=4194304),e}function ms(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ca(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ed(e,t,r,l,u,f){var y=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var C=e.entanglements,H=e.expirationTimes,ee=e.hiddenUpdates;for(r=y&~r;0<r;){var le=31-Rt(r),he=1<<le;C[le]=0,H[le]=-1;var ne=ee[le];if(ne!==null)for(ee[le]=null,le=0;le<ne.length;le++){var ae=ne[le];ae!==null&&(ae.lane&=-536870913)}r&=~he}l!==0&&Xa(e,l,0),f!==0&&u===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function Xa(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-Rt(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|r&261930}function _o(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var l=31-Rt(r),u=1<<l;u&t|e[l]&t&&(e[l]|=t),r&=~u}}function Yi(e,t){var r=t&-t;return r=(r&42)!==0?1:da(r),(r&(e.suspendedLanes|t))!==0?0:r}function da(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Hs(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ko(){var e=ie.p;return e!==0?e:(e=window.event,e===void 0?32:rp(e.type))}function Xn(e,t){var r=ie.p;try{return ie.p=e,t()}finally{ie.p=r}}var Jn=Math.random().toString(36).slice(2),Lt="__reactFiber$"+Jn,$t="__reactProps$"+Jn,ps="__reactContainer$"+Jn,Ja="__reactEvents$"+Jn,Td="__reactListeners$"+Jn,So="__reactHandles$"+Jn,Co="__reactResources$"+Jn,xs="__reactMarker$"+Jn;function Qa(e){delete e[Lt],delete e[$t],delete e[Ja],delete e[Td],delete e[So]}function ys(e){var t=e[Lt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ps]||r[Lt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Gm(e);e!==null;){if(r=e[Lt])return r;e=Gm(e)}return t}e=r,r=e.parentNode}return null}function On(e){if(e=e[Lt]||e[ps]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function vn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(o(33))}function bs(e){var t=e[Co];return t||(t=e[Co]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ot(e){e[xs]=!0}var Ki=new Set,Xi={};function vs(e,t){ws(e,t),ws(e+"Capture",t)}function ws(e,t){for(Xi[e]=t,e=0;e<t.length;e++)Ki.add(t[e])}var Ji=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qi={},Zi={};function Eo(e){return Ce.call(Zi,e)?!0:Ce.call(Qi,e)?!1:Ji.test(e)?Zi[e]=!0:(Qi[e]=!0,!1)}function Za(e,t,r){if(Eo(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function wn(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function It(e,t,r,l){if(l===null)e.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+l)}}function Ft(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function yr(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function el(e,t,r){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var u=l.get,f=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(y){r=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return r},setValue:function(y){r=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function at(e){if(!e._valueTracker){var t=yr(e)?"checked":"value";e._valueTracker=el(e,t,""+e[t])}}function ua(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),l="";return e&&(l=yr(e)?e.checked?"true":"false":e.value),e=l,e!==r?(t.setValue(e),!0):!1}function js(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ha=/[\n"\\]/g;function un(e){return e.replace(ha,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function ei(e,t,r,l,u,f,y,C){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ft(t)):e.value!==""+Ft(t)&&(e.value=""+Ft(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?tl(e,y,Ft(t)):r!=null?tl(e,y,Ft(r)):l!=null&&e.removeAttribute("value"),u==null&&f!=null&&(e.defaultChecked=!!f),u!=null&&(e.checked=u&&typeof u!="function"&&typeof u!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?e.name=""+Ft(C):e.removeAttribute("name")}function To(e,t,r,l,u,f,y,C){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||r!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){at(e);return}r=r!=null?""+Ft(r):"",t=t!=null?""+Ft(t):r,C||t===e.value||(e.value=t),e.defaultValue=t}l=l??u,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=C?e.checked:!!l,e.defaultChecked=!!l,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),at(e)}function tl(e,t,r){t==="number"&&js(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function br(e,t,r,l){if(e=e.options,t){t={};for(var u=0;u<r.length;u++)t["$"+r[u]]=!0;for(r=0;r<e.length;r++)u=t.hasOwnProperty("$"+e[r].value),e[r].selected!==u&&(e[r].selected=u),u&&l&&(e[r].defaultSelected=!0)}else{for(r=""+Ft(r),t=null,u=0;u<e.length;u++){if(e[u].value===r){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function Ao(e,t,r){if(t!=null&&(t=""+Ft(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+Ft(r):""}function vr(e,t,r,l){if(t==null){if(l!=null){if(r!=null)throw Error(o(92));if(ue(l)){if(1<l.length)throw Error(o(93));l=l[0]}r=l}r==null&&(r=""),t=r}r=Ft(t),e.defaultValue=r,l=e.textContent,l===r&&l!==""&&l!==null&&(e.value=l),at(e)}function hn(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ro=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nl(e,t,r){var l=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,r):typeof r!="number"||r===0||Ro.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function sl(e,t,r){if(t!=null&&typeof t!="object")throw Error(o(62));if(e=e.style,r!=null){for(var l in r)!r.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var u in t)l=t[u],t.hasOwnProperty(u)&&r[u]!==l&&nl(e,u,l)}else for(var f in t)t.hasOwnProperty(f)&&nl(e,f,t[f])}function ti(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ni(e){return wr.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Qn(){}var rl=null;function In(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var jr=null,Ns=null;function fa(e){var t=On(e);if(t&&(e=t.stateNode)){var r=e[$t]||null;e:switch(e=t.stateNode,t.type){case"input":if(ei(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+un(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var l=r[t];if(l!==e&&l.form===e.form){var u=l[$t]||null;if(!u)throw Error(o(90));ei(l,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(t=0;t<r.length;t++)l=r[t],l.form===e.form&&ua(l)}break e;case"textarea":Ao(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&br(e,!!r.multiple,t,!1)}}}var si=!1;function Nr(e,t,r){if(si)return e(t,r);si=!0;try{var l=e(t);return l}finally{if(si=!1,(jr!==null||Ns!==null)&&(kc(),jr&&(t=jr,e=Ns,Ns=jr=null,fa(t),e)))for(t=0;t<e.length;t++)fa(e[t])}}function Zn(e,t){var r=e.stateNode;if(r===null)return null;var l=r[$t]||null;if(l===null)return null;r=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(o(231,t,typeof r));return r}var Dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ga=!1;if(Dn)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){ga=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{ga=!1}var _s=null,al=null,ma=null;function il(){if(ma)return ma;var e,t=al,r=t.length,l,u="value"in _s?_s.value:_s.textContent,f=u.length;for(e=0;e<r&&t[e]===u[e];e++);var y=r-e;for(l=1;l<=y&&t[r-l]===u[f-l];l++);return ma=u.slice(e,1<l?1-l:void 0)}function pa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Gs(){return!0}function es(){return!1}function Kt(e){function t(r,l,u,f,y){this._reactName=r,this._targetInst=u,this.type=l,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var C in e)e.hasOwnProperty(C)&&(r=e[C],this[C]=r?r(f):f[C]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Gs:es,this.isPropagationStopped=es,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Gs)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Gs)},persist:function(){},isPersistent:Gs}),t}var Vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ks=Kt(Vs),_r=j({},Vs,{view:0,detail:0}),ll=Kt(_r),kr,ri,Ss,ai=j({},_r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ss&&(Ss&&e.type==="mousemove"?(kr=e.screenX-Ss.screenX,ri=e.screenY-Ss.screenY):ri=kr=0,Ss=e),kr)},movementY:function(e){return"movementY"in e?e.movementY:ri}}),ol=Kt(ai),xa=j({},ai,{dataTransfer:0}),Lo=Kt(xa),Oo=j({},_r,{relatedTarget:0}),ya=Kt(Oo),cl=j({},Vs,{animationName:0,elapsedTime:0,pseudoElement:0}),Io=Kt(cl),ii=j({},Vs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Do=Kt(ii),Uo=j({},Vs,{data:0}),Cs=Kt(Uo),Bo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Po={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ho(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Po[e])?!!t[e]:!1}function nn(){return Ho}var Go=j({},_r,{key:function(e){if(e.key){var t=Bo[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zo[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nn,charCode:function(e){return e.type==="keypress"?pa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vo=Kt(Go),Sr=j({},ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),c=Kt(Sr),m=j({},_r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nn}),v=Kt(m),M=j({},Vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),J=Kt(M),re=j({},ai,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),be=Kt(re),ze=j({},Vs,{newState:0,oldState:0}),Et=Kt(ze),it=[9,13,27,32],wt=Dn&&"CompositionEvent"in window,sn=null;Dn&&"documentMode"in document&&(sn=document.documentMode);var $s=Dn&&"TextEvent"in window&&!sn,ts=Dn&&(!wt||sn&&8<sn&&11>=sn),ns=" ",ba=!1;function li(e,t){switch(e){case"keyup":return it.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $f(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var oi=!1;function vb(e,t){switch(e){case"compositionend":return $f(t);case"keypress":return t.which!==32?null:(ba=!0,ns);case"textInput":return e=t.data,e===ns&&ba?null:e;default:return null}}function wb(e,t){if(oi)return e==="compositionend"||!wt&&li(e,t)?(e=il(),ma=al=_s=null,oi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ts&&t.locale!=="ko"?null:t.data;default:return null}}var jb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ff(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!jb[e.type]:t==="textarea"}function Wf(e,t,r,l){jr?Ns?Ns.push(l):Ns=[l]:jr=l,t=Mc(t,"onChange"),0<t.length&&(r=new ks("onChange","change",null,r,l),e.push({event:r,listeners:t}))}var dl=null,ul=null;function Nb(e){Em(e,0)}function $o(e){var t=vn(e);if(ua(t))return e}function qf(e,t){if(e==="change")return t}var Yf=!1;if(Dn){var Ad;if(Dn){var Rd="oninput"in document;if(!Rd){var Kf=document.createElement("div");Kf.setAttribute("oninput","return;"),Rd=typeof Kf.oninput=="function"}Ad=Rd}else Ad=!1;Yf=Ad&&(!document.documentMode||9<document.documentMode)}function Xf(){dl&&(dl.detachEvent("onpropertychange",Jf),ul=dl=null)}function Jf(e){if(e.propertyName==="value"&&$o(ul)){var t=[];Wf(t,ul,e,In(e)),Nr(Nb,t)}}function _b(e,t,r){e==="focusin"?(Xf(),dl=t,ul=r,dl.attachEvent("onpropertychange",Jf)):e==="focusout"&&Xf()}function kb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return $o(ul)}function Sb(e,t){if(e==="click")return $o(t)}function Cb(e,t){if(e==="input"||e==="change")return $o(t)}function Eb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jn=typeof Object.is=="function"?Object.is:Eb;function hl(e,t){if(jn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),l=Object.keys(t);if(r.length!==l.length)return!1;for(l=0;l<r.length;l++){var u=r[l];if(!Ce.call(t,u)||!jn(e[u],t[u]))return!1}return!0}function Qf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zf(e,t){var r=Qf(e);e=0;for(var l;r;){if(r.nodeType===3){if(l=e+r.textContent.length,e<=t&&l>=t)return{node:r,offset:t-e};e=l}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qf(r)}}function e0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t0(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=js(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=js(e.document)}return t}function Md(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Tb=Dn&&"documentMode"in document&&11>=document.documentMode,ci=null,Ld=null,fl=null,Od=!1;function n0(e,t,r){var l=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Od||ci==null||ci!==js(l)||(l=ci,"selectionStart"in l&&Md(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),fl&&hl(fl,l)||(fl=l,l=Mc(Ld,"onSelect"),0<l.length&&(t=new ks("onSelect","select",null,t,r),e.push({event:t,listeners:l}),t.target=ci)))}function va(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var di={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionrun:va("Transition","TransitionRun"),transitionstart:va("Transition","TransitionStart"),transitioncancel:va("Transition","TransitionCancel"),transitionend:va("Transition","TransitionEnd")},Id={},s0={};Dn&&(s0=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function wa(e){if(Id[e])return Id[e];if(!di[e])return e;var t=di[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in s0)return Id[e]=t[r];return e}var r0=wa("animationend"),a0=wa("animationiteration"),i0=wa("animationstart"),Ab=wa("transitionrun"),Rb=wa("transitionstart"),Mb=wa("transitioncancel"),l0=wa("transitionend"),o0=new Map,Dd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dd.push("scrollEnd");function ss(e,t){o0.set(e,t),vs(t,[e])}var Fo=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Un=[],ui=0,Ud=0;function Wo(){for(var e=ui,t=Ud=ui=0;t<e;){var r=Un[t];Un[t++]=null;var l=Un[t];Un[t++]=null;var u=Un[t];Un[t++]=null;var f=Un[t];if(Un[t++]=null,l!==null&&u!==null){var y=l.pending;y===null?u.next=u:(u.next=y.next,y.next=u),l.pending=u}f!==0&&c0(r,u,f)}}function qo(e,t,r,l){Un[ui++]=e,Un[ui++]=t,Un[ui++]=r,Un[ui++]=l,Ud|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function Bd(e,t,r,l){return qo(e,t,r,l),Yo(e)}function ja(e,t){return qo(e,null,null,t),Yo(e)}function c0(e,t,r){e.lanes|=r;var l=e.alternate;l!==null&&(l.lanes|=r);for(var u=!1,f=e.return;f!==null;)f.childLanes|=r,l=f.alternate,l!==null&&(l.childLanes|=r),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(u=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,u&&t!==null&&(u=31-Rt(r),e=f.hiddenUpdates,l=e[u],l===null?e[u]=[t]:l.push(t),t.lane=r|536870912),f):null}function Yo(e){if(50<Il)throw Il=0,qu=null,Error(o(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var hi={};function Lb(e,t,r,l){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(e,t,r,l){return new Lb(e,t,r,l)}function zd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fs(e,t){var r=e.alternate;return r===null?(r=Nn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function d0(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ko(e,t,r,l,u,f){var y=0;if(l=e,typeof e=="function")zd(e)&&(y=1);else if(typeof e=="string")y=Bv(e,r,q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case E:return e=Nn(31,r,t,u),e.elementType=E,e.lanes=f,e;case T:return Na(r.children,u,f,t);case U:y=8,u|=24;break;case P:return e=Nn(12,r,t,u|2),e.elementType=P,e.lanes=f,e;case se:return e=Nn(13,r,t,u),e.elementType=se,e.lanes=f,e;case te:return e=Nn(19,r,t,u),e.elementType=te,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case G:y=10;break e;case z:y=9;break e;case X:y=11;break e;case R:y=14;break e;case k:y=16,l=null;break e}y=29,r=Error(o(130,e===null?"null":typeof e,"")),l=null}return t=Nn(y,r,t,u),t.elementType=e,t.type=l,t.lanes=f,t}function Na(e,t,r,l){return e=Nn(7,e,l,t),e.lanes=r,e}function Pd(e,t,r){return e=Nn(6,e,null,t),e.lanes=r,e}function u0(e){var t=Nn(18,null,null,0);return t.stateNode=e,t}function Hd(e,t,r){return t=Nn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var h0=new WeakMap;function Bn(e,t){if(typeof e=="object"&&e!==null){var r=h0.get(e);return r!==void 0?r:(t={value:e,source:t,stack:Ae(t)},h0.set(e,t),t)}return{value:e,source:t,stack:Ae(t)}}var fi=[],gi=0,Xo=null,gl=0,zn=[],Pn=0,Cr=null,Es=1,Ts="";function Ws(e,t){fi[gi++]=gl,fi[gi++]=Xo,Xo=e,gl=t}function f0(e,t,r){zn[Pn++]=Es,zn[Pn++]=Ts,zn[Pn++]=Cr,Cr=e;var l=Es;e=Ts;var u=32-Rt(l)-1;l&=~(1<<u),r+=1;var f=32-Rt(t)+u;if(30<f){var y=u-u%5;f=(l&(1<<y)-1).toString(32),l>>=y,u-=y,Es=1<<32-Rt(t)+u|r<<u|l,Ts=f+e}else Es=1<<f|r<<u|l,Ts=e}function Gd(e){e.return!==null&&(Ws(e,1),f0(e,1,0))}function Vd(e){for(;e===Xo;)Xo=fi[--gi],fi[gi]=null,gl=fi[--gi],fi[gi]=null;for(;e===Cr;)Cr=zn[--Pn],zn[Pn]=null,Ts=zn[--Pn],zn[Pn]=null,Es=zn[--Pn],zn[Pn]=null}function g0(e,t){zn[Pn++]=Es,zn[Pn++]=Ts,zn[Pn++]=Cr,Es=t.id,Ts=t.overflow,Cr=e}var Xt=null,gt=null,Ke=!1,Er=null,Hn=!1,$d=Error(o(519));function Tr(e){var t=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ml(Bn(t,e)),$d}function m0(e){var t=e.stateNode,r=e.type,l=e.memoizedProps;switch(t[Lt]=e,t[$t]=l,r){case"dialog":Fe("cancel",t),Fe("close",t);break;case"iframe":case"object":case"embed":Fe("load",t);break;case"video":case"audio":for(r=0;r<Ul.length;r++)Fe(Ul[r],t);break;case"source":Fe("error",t);break;case"img":case"image":case"link":Fe("error",t),Fe("load",t);break;case"details":Fe("toggle",t);break;case"input":Fe("invalid",t),To(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Fe("invalid",t);break;case"textarea":Fe("invalid",t),vr(t,l.value,l.defaultValue,l.children)}r=l.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||l.suppressHydrationWarning===!0||Mm(t.textContent,r)?(l.popover!=null&&(Fe("beforetoggle",t),Fe("toggle",t)),l.onScroll!=null&&Fe("scroll",t),l.onScrollEnd!=null&&Fe("scrollend",t),l.onClick!=null&&(t.onclick=Qn),t=!0):t=!1,t||Tr(e,!0)}function p0(e){for(Xt=e.return;Xt;)switch(Xt.tag){case 5:case 31:case 13:Hn=!1;return;case 27:case 3:Hn=!0;return;default:Xt=Xt.return}}function mi(e){if(e!==Xt)return!1;if(!Ke)return p0(e),Ke=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||oh(e.type,e.memoizedProps)),r=!r),r&&gt&&Tr(e),p0(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));gt=Hm(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));gt=Hm(e)}else t===27?(t=gt,Vr(e.type)?(e=fh,fh=null,gt=e):gt=t):gt=Xt?Vn(e.stateNode.nextSibling):null;return!0}function _a(){gt=Xt=null,Ke=!1}function Fd(){var e=Er;return e!==null&&(pn===null?pn=e:pn.push.apply(pn,e),Er=null),e}function ml(e){Er===null?Er=[e]:Er.push(e)}var Wd=D(null),ka=null,qs=null;function Ar(e,t,r){W(Wd,t._currentValue),t._currentValue=r}function Ys(e){e._currentValue=Wd.current,F(Wd)}function qd(e,t,r){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===r)break;e=e.return}}function Yd(e,t,r,l){var u=e.child;for(u!==null&&(u.return=e);u!==null;){var f=u.dependencies;if(f!==null){var y=u.child;f=f.firstContext;e:for(;f!==null;){var C=f;f=u;for(var H=0;H<t.length;H++)if(C.context===t[H]){f.lanes|=r,C=f.alternate,C!==null&&(C.lanes|=r),qd(f.return,r,e),l||(y=null);break e}f=C.next}}else if(u.tag===18){if(y=u.return,y===null)throw Error(o(341));y.lanes|=r,f=y.alternate,f!==null&&(f.lanes|=r),qd(y,r,e),y=null}else y=u.child;if(y!==null)y.return=u;else for(y=u;y!==null;){if(y===e){y=null;break}if(u=y.sibling,u!==null){u.return=y.return,y=u;break}y=y.return}u=y}}function pi(e,t,r,l){e=null;for(var u=t,f=!1;u!==null;){if(!f){if((u.flags&524288)!==0)f=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var y=u.alternate;if(y===null)throw Error(o(387));if(y=y.memoizedProps,y!==null){var C=u.type;jn(u.pendingProps.value,y.value)||(e!==null?e.push(C):e=[C])}}else if(u===pe.current){if(y=u.alternate,y===null)throw Error(o(387));y.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(e!==null?e.push(Gl):e=[Gl])}u=u.return}e!==null&&Yd(t,e,r,l),t.flags|=262144}function Jo(e){for(e=e.firstContext;e!==null;){if(!jn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Sa(e){ka=e,qs=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Jt(e){return x0(ka,e)}function Qo(e,t){return ka===null&&Sa(e),x0(e,t)}function x0(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},qs===null){if(e===null)throw Error(o(308));qs=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else qs=qs.next=t;return r}var Ob=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},Ib=a.unstable_scheduleCallback,Db=a.unstable_NormalPriority,Dt={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kd(){return{controller:new Ob,data:new Map,refCount:0}}function pl(e){e.refCount--,e.refCount===0&&Ib(Db,function(){e.controller.abort()})}var xl=null,Xd=0,xi=0,yi=null;function Ub(e,t){if(xl===null){var r=xl=[];Xd=0,xi=Zu(),yi={status:"pending",value:void 0,then:function(l){r.push(l)}}}return Xd++,t.then(y0,y0),t}function y0(){if(--Xd===0&&xl!==null){yi!==null&&(yi.status="fulfilled");var e=xl;xl=null,xi=0,yi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Bb(e,t){var r=[],l={status:"pending",value:null,reason:null,then:function(u){r.push(u)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var u=0;u<r.length;u++)(0,r[u])(t)},function(u){for(l.status="rejected",l.reason=u,u=0;u<r.length;u++)(0,r[u])(void 0)}),l}var b0=V.S;V.S=function(e,t){nm=ve(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Ub(e,t),b0!==null&&b0(e,t)};var Ca=D(null);function Jd(){var e=Ca.current;return e!==null?e:ft.pooledCache}function Zo(e,t){t===null?W(Ca,Ca.current):W(Ca,t.pool)}function v0(){var e=Jd();return e===null?null:{parent:Dt._currentValue,pool:e}}var bi=Error(o(460)),Qd=Error(o(474)),ec=Error(o(542)),tc={then:function(){}};function w0(e){return e=e.status,e==="fulfilled"||e==="rejected"}function j0(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(Qn,Qn),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,_0(e),e;default:if(typeof t.status=="string")t.then(Qn,Qn);else{if(e=ft,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var u=t;u.status="fulfilled",u.value=l}},function(l){if(t.status==="pending"){var u=t;u.status="rejected",u.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,_0(e),e}throw Ta=t,bi}}function Ea(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(Ta=r,bi):r}}var Ta=null;function N0(){if(Ta===null)throw Error(o(459));var e=Ta;return Ta=null,e}function _0(e){if(e===bi||e===ec)throw Error(o(483))}var vi=null,yl=0;function nc(e){var t=yl;return yl+=1,vi===null&&(vi=[]),j0(vi,e,t)}function bl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function sc(e,t){throw t.$$typeof===_?Error(o(525)):(e=Object.prototype.toString.call(t),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function k0(e){function t(Y,$){if(e){var Z=Y.deletions;Z===null?(Y.deletions=[$],Y.flags|=16):Z.push($)}}function r(Y,$){if(!e)return null;for(;$!==null;)t(Y,$),$=$.sibling;return null}function l(Y){for(var $=new Map;Y!==null;)Y.key!==null?$.set(Y.key,Y):$.set(Y.index,Y),Y=Y.sibling;return $}function u(Y,$){return Y=Fs(Y,$),Y.index=0,Y.sibling=null,Y}function f(Y,$,Z){return Y.index=Z,e?(Z=Y.alternate,Z!==null?(Z=Z.index,Z<$?(Y.flags|=67108866,$):Z):(Y.flags|=67108866,$)):(Y.flags|=1048576,$)}function y(Y){return e&&Y.alternate===null&&(Y.flags|=67108866),Y}function C(Y,$,Z,ce){return $===null||$.tag!==6?($=Pd(Z,Y.mode,ce),$.return=Y,$):($=u($,Z),$.return=Y,$)}function H(Y,$,Z,ce){var Re=Z.type;return Re===T?le(Y,$,Z.props.children,ce,Z.key):$!==null&&($.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===k&&Ea(Re)===$.type)?($=u($,Z.props),bl($,Z),$.return=Y,$):($=Ko(Z.type,Z.key,Z.props,null,Y.mode,ce),bl($,Z),$.return=Y,$)}function ee(Y,$,Z,ce){return $===null||$.tag!==4||$.stateNode.containerInfo!==Z.containerInfo||$.stateNode.implementation!==Z.implementation?($=Hd(Z,Y.mode,ce),$.return=Y,$):($=u($,Z.children||[]),$.return=Y,$)}function le(Y,$,Z,ce,Re){return $===null||$.tag!==7?($=Na(Z,Y.mode,ce,Re),$.return=Y,$):($=u($,Z),$.return=Y,$)}function he(Y,$,Z){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Pd(""+$,Y.mode,Z),$.return=Y,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case I:return Z=Ko($.type,$.key,$.props,null,Y.mode,Z),bl(Z,$),Z.return=Y,Z;case L:return $=Hd($,Y.mode,Z),$.return=Y,$;case k:return $=Ea($),he(Y,$,Z)}if(ue($)||B($))return $=Na($,Y.mode,Z,null),$.return=Y,$;if(typeof $.then=="function")return he(Y,nc($),Z);if($.$$typeof===G)return he(Y,Qo(Y,$),Z);sc(Y,$)}return null}function ne(Y,$,Z,ce){var Re=$!==null?$.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Re!==null?null:C(Y,$,""+Z,ce);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case I:return Z.key===Re?H(Y,$,Z,ce):null;case L:return Z.key===Re?ee(Y,$,Z,ce):null;case k:return Z=Ea(Z),ne(Y,$,Z,ce)}if(ue(Z)||B(Z))return Re!==null?null:le(Y,$,Z,ce,null);if(typeof Z.then=="function")return ne(Y,$,nc(Z),ce);if(Z.$$typeof===G)return ne(Y,$,Qo(Y,Z),ce);sc(Y,Z)}return null}function ae(Y,$,Z,ce,Re){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Y=Y.get(Z)||null,C($,Y,""+ce,Re);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case I:return Y=Y.get(ce.key===null?Z:ce.key)||null,H($,Y,ce,Re);case L:return Y=Y.get(ce.key===null?Z:ce.key)||null,ee($,Y,ce,Re);case k:return ce=Ea(ce),ae(Y,$,Z,ce,Re)}if(ue(ce)||B(ce))return Y=Y.get(Z)||null,le($,Y,ce,Re,null);if(typeof ce.then=="function")return ae(Y,$,Z,nc(ce),Re);if(ce.$$typeof===G)return ae(Y,$,Z,Qo($,ce),Re);sc($,ce)}return null}function Ne(Y,$,Z,ce){for(var Re=null,et=null,Se=$,He=$=0,qe=null;Se!==null&&He<Z.length;He++){Se.index>He?(qe=Se,Se=null):qe=Se.sibling;var tt=ne(Y,Se,Z[He],ce);if(tt===null){Se===null&&(Se=qe);break}e&&Se&&tt.alternate===null&&t(Y,Se),$=f(tt,$,He),et===null?Re=tt:et.sibling=tt,et=tt,Se=qe}if(He===Z.length)return r(Y,Se),Ke&&Ws(Y,He),Re;if(Se===null){for(;He<Z.length;He++)Se=he(Y,Z[He],ce),Se!==null&&($=f(Se,$,He),et===null?Re=Se:et.sibling=Se,et=Se);return Ke&&Ws(Y,He),Re}for(Se=l(Se);He<Z.length;He++)qe=ae(Se,Y,He,Z[He],ce),qe!==null&&(e&&qe.alternate!==null&&Se.delete(qe.key===null?He:qe.key),$=f(qe,$,He),et===null?Re=qe:et.sibling=qe,et=qe);return e&&Se.forEach(function(Yr){return t(Y,Yr)}),Ke&&Ws(Y,He),Re}function Le(Y,$,Z,ce){if(Z==null)throw Error(o(151));for(var Re=null,et=null,Se=$,He=$=0,qe=null,tt=Z.next();Se!==null&&!tt.done;He++,tt=Z.next()){Se.index>He?(qe=Se,Se=null):qe=Se.sibling;var Yr=ne(Y,Se,tt.value,ce);if(Yr===null){Se===null&&(Se=qe);break}e&&Se&&Yr.alternate===null&&t(Y,Se),$=f(Yr,$,He),et===null?Re=Yr:et.sibling=Yr,et=Yr,Se=qe}if(tt.done)return r(Y,Se),Ke&&Ws(Y,He),Re;if(Se===null){for(;!tt.done;He++,tt=Z.next())tt=he(Y,tt.value,ce),tt!==null&&($=f(tt,$,He),et===null?Re=tt:et.sibling=tt,et=tt);return Ke&&Ws(Y,He),Re}for(Se=l(Se);!tt.done;He++,tt=Z.next())tt=ae(Se,Y,He,tt.value,ce),tt!==null&&(e&&tt.alternate!==null&&Se.delete(tt.key===null?He:tt.key),$=f(tt,$,He),et===null?Re=tt:et.sibling=tt,et=tt);return e&&Se.forEach(function(Kv){return t(Y,Kv)}),Ke&&Ws(Y,He),Re}function ut(Y,$,Z,ce){if(typeof Z=="object"&&Z!==null&&Z.type===T&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case I:e:{for(var Re=Z.key;$!==null;){if($.key===Re){if(Re=Z.type,Re===T){if($.tag===7){r(Y,$.sibling),ce=u($,Z.props.children),ce.return=Y,Y=ce;break e}}else if($.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===k&&Ea(Re)===$.type){r(Y,$.sibling),ce=u($,Z.props),bl(ce,Z),ce.return=Y,Y=ce;break e}r(Y,$);break}else t(Y,$);$=$.sibling}Z.type===T?(ce=Na(Z.props.children,Y.mode,ce,Z.key),ce.return=Y,Y=ce):(ce=Ko(Z.type,Z.key,Z.props,null,Y.mode,ce),bl(ce,Z),ce.return=Y,Y=ce)}return y(Y);case L:e:{for(Re=Z.key;$!==null;){if($.key===Re)if($.tag===4&&$.stateNode.containerInfo===Z.containerInfo&&$.stateNode.implementation===Z.implementation){r(Y,$.sibling),ce=u($,Z.children||[]),ce.return=Y,Y=ce;break e}else{r(Y,$);break}else t(Y,$);$=$.sibling}ce=Hd(Z,Y.mode,ce),ce.return=Y,Y=ce}return y(Y);case k:return Z=Ea(Z),ut(Y,$,Z,ce)}if(ue(Z))return Ne(Y,$,Z,ce);if(B(Z)){if(Re=B(Z),typeof Re!="function")throw Error(o(150));return Z=Re.call(Z),Le(Y,$,Z,ce)}if(typeof Z.then=="function")return ut(Y,$,nc(Z),ce);if(Z.$$typeof===G)return ut(Y,$,Qo(Y,Z),ce);sc(Y,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,$!==null&&$.tag===6?(r(Y,$.sibling),ce=u($,Z),ce.return=Y,Y=ce):(r(Y,$),ce=Pd(Z,Y.mode,ce),ce.return=Y,Y=ce),y(Y)):r(Y,$)}return function(Y,$,Z,ce){try{yl=0;var Re=ut(Y,$,Z,ce);return vi=null,Re}catch(Se){if(Se===bi||Se===ec)throw Se;var et=Nn(29,Se,null,Y.mode);return et.lanes=ce,et.return=Y,et}}}var Aa=k0(!0),S0=k0(!1),Rr=!1;function Zd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Mr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Lr(e,t,r){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(nt&2)!==0){var u=l.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),l.pending=t,t=Yo(e),c0(e,null,r),t}return qo(e,l,t,r),Yo(e)}function vl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,r|=l,t.lanes=r,_o(e,r)}}function tu(e,t){var r=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,r===l)){var u=null,f=null;if(r=r.firstBaseUpdate,r!==null){do{var y={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};f===null?u=f=y:f=f.next=y,r=r.next}while(r!==null);f===null?u=f=t:f=f.next=t}else u=f=t;r={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:f,shared:l.shared,callbacks:l.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var nu=!1;function wl(){if(nu){var e=yi;if(e!==null)throw e}}function jl(e,t,r,l){nu=!1;var u=e.updateQueue;Rr=!1;var f=u.firstBaseUpdate,y=u.lastBaseUpdate,C=u.shared.pending;if(C!==null){u.shared.pending=null;var H=C,ee=H.next;H.next=null,y===null?f=ee:y.next=ee,y=H;var le=e.alternate;le!==null&&(le=le.updateQueue,C=le.lastBaseUpdate,C!==y&&(C===null?le.firstBaseUpdate=ee:C.next=ee,le.lastBaseUpdate=H))}if(f!==null){var he=u.baseState;y=0,le=ee=H=null,C=f;do{var ne=C.lane&-536870913,ae=ne!==C.lane;if(ae?(We&ne)===ne:(l&ne)===ne){ne!==0&&ne===xi&&(nu=!0),le!==null&&(le=le.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var Ne=e,Le=C;ne=t;var ut=r;switch(Le.tag){case 1:if(Ne=Le.payload,typeof Ne=="function"){he=Ne.call(ut,he,ne);break e}he=Ne;break e;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=Le.payload,ne=typeof Ne=="function"?Ne.call(ut,he,ne):Ne,ne==null)break e;he=j({},he,ne);break e;case 2:Rr=!0}}ne=C.callback,ne!==null&&(e.flags|=64,ae&&(e.flags|=8192),ae=u.callbacks,ae===null?u.callbacks=[ne]:ae.push(ne))}else ae={lane:ne,tag:C.tag,payload:C.payload,callback:C.callback,next:null},le===null?(ee=le=ae,H=he):le=le.next=ae,y|=ne;if(C=C.next,C===null){if(C=u.shared.pending,C===null)break;ae=C,C=ae.next,ae.next=null,u.lastBaseUpdate=ae,u.shared.pending=null}}while(!0);le===null&&(H=he),u.baseState=H,u.firstBaseUpdate=ee,u.lastBaseUpdate=le,f===null&&(u.shared.lanes=0),Br|=y,e.lanes=y,e.memoizedState=he}}function C0(e,t){if(typeof e!="function")throw Error(o(191,e));e.call(t)}function E0(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)C0(r[e],t)}var wi=D(null),rc=D(0);function T0(e,t){e=sr,W(rc,e),W(wi,t),sr=e|t.baseLanes}function su(){W(rc,sr),W(wi,wi.current)}function ru(){sr=rc.current,F(wi),F(rc)}var _n=D(null),Gn=null;function Or(e){var t=e.alternate;W(Tt,Tt.current&1),W(_n,e),Gn===null&&(t===null||wi.current!==null||t.memoizedState!==null)&&(Gn=e)}function au(e){W(Tt,Tt.current),W(_n,e),Gn===null&&(Gn=e)}function A0(e){e.tag===22?(W(Tt,Tt.current),W(_n,e),Gn===null&&(Gn=e)):Ir()}function Ir(){W(Tt,Tt.current),W(_n,_n.current)}function kn(e){F(_n),Gn===e&&(Gn=null),F(Tt)}var Tt=D(0);function ac(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||uh(r)||hh(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ks=0,Pe=null,ct=null,Ut=null,ic=!1,ji=!1,Ra=!1,lc=0,Nl=0,Ni=null,zb=0;function jt(){throw Error(o(321))}function iu(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!jn(e[r],t[r]))return!1;return!0}function lu(e,t,r,l,u,f){return Ks=f,Pe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,V.H=e===null||e.memoizedState===null?fg:ju,Ra=!1,f=r(l,u),Ra=!1,ji&&(f=M0(t,r,l,u)),R0(e),f}function R0(e){V.H=Sl;var t=ct!==null&&ct.next!==null;if(Ks=0,Ut=ct=Pe=null,ic=!1,Nl=0,Ni=null,t)throw Error(o(300));e===null||Bt||(e=e.dependencies,e!==null&&Jo(e)&&(Bt=!0))}function M0(e,t,r,l){Pe=e;var u=0;do{if(ji&&(Ni=null),Nl=0,ji=!1,25<=u)throw Error(o(301));if(u+=1,Ut=ct=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}V.H=gg,f=t(r,l)}while(ji);return f}function Pb(){var e=V.H,t=e.useState()[0];return t=typeof t.then=="function"?_l(t):t,e=e.useState()[0],(ct!==null?ct.memoizedState:null)!==e&&(Pe.flags|=1024),t}function ou(){var e=lc!==0;return lc=0,e}function cu(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function du(e){if(ic){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}ic=!1}Ks=0,Ut=ct=Pe=null,ji=!1,Nl=lc=0,Ni=null}function an(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?Pe.memoizedState=Ut=e:Ut=Ut.next=e,Ut}function At(){if(ct===null){var e=Pe.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=Ut===null?Pe.memoizedState:Ut.next;if(t!==null)Ut=t,ct=e;else{if(e===null)throw Pe.alternate===null?Error(o(467)):Error(o(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},Ut===null?Pe.memoizedState=Ut=e:Ut=Ut.next=e}return Ut}function oc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _l(e){var t=Nl;return Nl+=1,Ni===null&&(Ni=[]),e=j0(Ni,e,t),t=Pe,(Ut===null?t.memoizedState:Ut.next)===null&&(t=t.alternate,V.H=t===null||t.memoizedState===null?fg:ju),e}function cc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return _l(e);if(e.$$typeof===G)return Jt(e)}throw Error(o(438,String(e)))}function uu(e){var t=null,r=Pe.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var l=Pe.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(u){return u.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=oc(),Pe.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),l=0;l<e;l++)r[l]=S;return t.index++,r}function Xs(e,t){return typeof t=="function"?t(e):t}function dc(e){var t=At();return hu(t,ct,e)}function hu(e,t,r){var l=e.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=r;var u=e.baseQueue,f=l.pending;if(f!==null){if(u!==null){var y=u.next;u.next=f.next,f.next=y}t.baseQueue=u=f,l.pending=null}if(f=e.baseState,u===null)e.memoizedState=f;else{t=u.next;var C=y=null,H=null,ee=t,le=!1;do{var he=ee.lane&-536870913;if(he!==ee.lane?(We&he)===he:(Ks&he)===he){var ne=ee.revertLane;if(ne===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),he===xi&&(le=!0);else if((Ks&ne)===ne){ee=ee.next,ne===xi&&(le=!0);continue}else he={lane:0,revertLane:ee.revertLane,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},H===null?(C=H=he,y=f):H=H.next=he,Pe.lanes|=ne,Br|=ne;he=ee.action,Ra&&r(f,he),f=ee.hasEagerState?ee.eagerState:r(f,he)}else ne={lane:he,revertLane:ee.revertLane,gesture:ee.gesture,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},H===null?(C=H=ne,y=f):H=H.next=ne,Pe.lanes|=he,Br|=he;ee=ee.next}while(ee!==null&&ee!==t);if(H===null?y=f:H.next=C,!jn(f,e.memoizedState)&&(Bt=!0,le&&(r=yi,r!==null)))throw r;e.memoizedState=f,e.baseState=y,e.baseQueue=H,l.lastRenderedState=f}return u===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function fu(e){var t=At(),r=t.queue;if(r===null)throw Error(o(311));r.lastRenderedReducer=e;var l=r.dispatch,u=r.pending,f=t.memoizedState;if(u!==null){r.pending=null;var y=u=u.next;do f=e(f,y.action),y=y.next;while(y!==u);jn(f,t.memoizedState)||(Bt=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),r.lastRenderedState=f}return[f,l]}function L0(e,t,r){var l=Pe,u=At(),f=Ke;if(f){if(r===void 0)throw Error(o(407));r=r()}else r=t();var y=!jn((ct||u).memoizedState,r);if(y&&(u.memoizedState=r,Bt=!0),u=u.queue,pu(D0.bind(null,l,u,e),[e]),u.getSnapshot!==t||y||Ut!==null&&Ut.memoizedState.tag&1){if(l.flags|=2048,_i(9,{destroy:void 0},I0.bind(null,l,u,r,t),null),ft===null)throw Error(o(349));f||(Ks&127)!==0||O0(l,t,r)}return r}function O0(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Pe.updateQueue,t===null?(t=oc(),Pe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function I0(e,t,r,l){t.value=r,t.getSnapshot=l,U0(t)&&B0(e)}function D0(e,t,r){return r(function(){U0(t)&&B0(e)})}function U0(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!jn(e,r)}catch{return!0}}function B0(e){var t=ja(e,2);t!==null&&xn(t,e,2)}function gu(e){var t=an();if(typeof e=="function"){var r=e;if(e=r(),Ra){Ln(!0);try{r()}finally{Ln(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:e},t}function z0(e,t,r,l){return e.baseState=r,hu(e,ct,typeof l=="function"?l:Xs)}function Hb(e,t,r,l,u){if(fc(e))throw Error(o(485));if(e=t.action,e!==null){var f={payload:u,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};V.T!==null?r(!0):f.isTransition=!1,l(f),r=t.pending,r===null?(f.next=t.pending=f,P0(t,f)):(f.next=r.next,t.pending=r.next=f)}}function P0(e,t){var r=t.action,l=t.payload,u=e.state;if(t.isTransition){var f=V.T,y={};V.T=y;try{var C=r(u,l),H=V.S;H!==null&&H(y,C),H0(e,t,C)}catch(ee){mu(e,t,ee)}finally{f!==null&&y.types!==null&&(f.types=y.types),V.T=f}}else try{f=r(u,l),H0(e,t,f)}catch(ee){mu(e,t,ee)}}function H0(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(l){G0(e,t,l)},function(l){return mu(e,t,l)}):G0(e,t,r)}function G0(e,t,r){t.status="fulfilled",t.value=r,V0(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,P0(e,r)))}function mu(e,t,r){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=r,V0(t),t=t.next;while(t!==l)}e.action=null}function V0(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function $0(e,t){return t}function F0(e,t){if(Ke){var r=ft.formState;if(r!==null){e:{var l=Pe;if(Ke){if(gt){t:{for(var u=gt,f=Hn;u.nodeType!==8;){if(!f){u=null;break t}if(u=Vn(u.nextSibling),u===null){u=null;break t}}f=u.data,u=f==="F!"||f==="F"?u:null}if(u){gt=Vn(u.nextSibling),l=u.data==="F!";break e}}Tr(l)}l=!1}l&&(t=r[0])}}return r=an(),r.memoizedState=r.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$0,lastRenderedState:t},r.queue=l,r=dg.bind(null,Pe,l),l.dispatch=r,l=gu(!1),f=wu.bind(null,Pe,!1,l.queue),l=an(),u={state:t,dispatch:null,action:e,pending:null},l.queue=u,r=Hb.bind(null,Pe,u,f,r),u.dispatch=r,l.memoizedState=e,[t,r,!1]}function W0(e){var t=At();return q0(t,ct,e)}function q0(e,t,r){if(t=hu(e,t,$0)[0],e=dc(Xs)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=_l(t)}catch(y){throw y===bi?ec:y}else l=t;t=At();var u=t.queue,f=u.dispatch;return r!==t.memoizedState&&(Pe.flags|=2048,_i(9,{destroy:void 0},Gb.bind(null,u,r),null)),[l,f,e]}function Gb(e,t){e.action=t}function Y0(e){var t=At(),r=ct;if(r!==null)return q0(t,r,e);At(),t=t.memoizedState,r=At();var l=r.queue.dispatch;return r.memoizedState=e,[t,l,!1]}function _i(e,t,r,l){return e={tag:e,create:r,deps:l,inst:t,next:null},t=Pe.updateQueue,t===null&&(t=oc(),Pe.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(l=r.next,r.next=e,e.next=l,t.lastEffect=e),e}function K0(){return At().memoizedState}function uc(e,t,r,l){var u=an();Pe.flags|=e,u.memoizedState=_i(1|t,{destroy:void 0},r,l===void 0?null:l)}function hc(e,t,r,l){var u=At();l=l===void 0?null:l;var f=u.memoizedState.inst;ct!==null&&l!==null&&iu(l,ct.memoizedState.deps)?u.memoizedState=_i(t,f,r,l):(Pe.flags|=e,u.memoizedState=_i(1|t,f,r,l))}function X0(e,t){uc(8390656,8,e,t)}function pu(e,t){hc(2048,8,e,t)}function Vb(e){Pe.flags|=4;var t=Pe.updateQueue;if(t===null)t=oc(),Pe.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function J0(e){var t=At().memoizedState;return Vb({ref:t,nextImpl:e}),function(){if((nt&2)!==0)throw Error(o(440));return t.impl.apply(void 0,arguments)}}function Q0(e,t){return hc(4,2,e,t)}function Z0(e,t){return hc(4,4,e,t)}function eg(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tg(e,t,r){r=r!=null?r.concat([e]):null,hc(4,4,eg.bind(null,t,e),r)}function xu(){}function ng(e,t){var r=At();t=t===void 0?null:t;var l=r.memoizedState;return t!==null&&iu(t,l[1])?l[0]:(r.memoizedState=[e,t],e)}function sg(e,t){var r=At();t=t===void 0?null:t;var l=r.memoizedState;if(t!==null&&iu(t,l[1]))return l[0];if(l=e(),Ra){Ln(!0);try{e()}finally{Ln(!1)}}return r.memoizedState=[l,t],l}function yu(e,t,r){return r===void 0||(Ks&1073741824)!==0&&(We&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=rm(),Pe.lanes|=e,Br|=e,r)}function rg(e,t,r,l){return jn(r,t)?r:wi.current!==null?(e=yu(e,r,l),jn(e,t)||(Bt=!0),e):(Ks&42)===0||(Ks&1073741824)!==0&&(We&261930)===0?(Bt=!0,e.memoizedState=r):(e=rm(),Pe.lanes|=e,Br|=e,t)}function ag(e,t,r,l,u){var f=ie.p;ie.p=f!==0&&8>f?f:8;var y=V.T,C={};V.T=C,wu(e,!1,t,r);try{var H=u(),ee=V.S;if(ee!==null&&ee(C,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var le=Bb(H,l);kl(e,t,le,En(e))}else kl(e,t,l,En(e))}catch(he){kl(e,t,{then:function(){},status:"rejected",reason:he},En())}finally{ie.p=f,y!==null&&C.types!==null&&(y.types=C.types),V.T=y}}function $b(){}function bu(e,t,r,l){if(e.tag!==5)throw Error(o(476));var u=ig(e).queue;ag(e,u,t,K,r===null?$b:function(){return lg(e),r(l)})}function ig(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:K},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function lg(e){var t=ig(e);t.next===null&&(t=e.alternate.memoizedState),kl(e,t.next.queue,{},En())}function vu(){return Jt(Gl)}function og(){return At().memoizedState}function cg(){return At().memoizedState}function Fb(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=En();e=Mr(r);var l=Lr(t,e,r);l!==null&&(xn(l,t,r),vl(l,t,r)),t={cache:Kd()},e.payload=t;return}t=t.return}}function Wb(e,t,r){var l=En();r={lane:l,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},fc(e)?ug(t,r):(r=Bd(e,t,r,l),r!==null&&(xn(r,e,l),hg(r,t,l)))}function dg(e,t,r){var l=En();kl(e,t,r,l)}function kl(e,t,r,l){var u={lane:l,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(fc(e))ug(t,u);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,C=f(y,r);if(u.hasEagerState=!0,u.eagerState=C,jn(C,y))return qo(e,t,u,0),ft===null&&Wo(),!1}catch{}if(r=Bd(e,t,u,l),r!==null)return xn(r,e,l),hg(r,t,l),!0}return!1}function wu(e,t,r,l){if(l={lane:2,revertLane:Zu(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},fc(e)){if(t)throw Error(o(479))}else t=Bd(e,r,l,2),t!==null&&xn(t,e,2)}function fc(e){var t=e.alternate;return e===Pe||t!==null&&t===Pe}function ug(e,t){ji=ic=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function hg(e,t,r){if((r&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,r|=l,t.lanes=r,_o(e,r)}}var Sl={readContext:Jt,use:cc,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useLayoutEffect:jt,useInsertionEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useSyncExternalStore:jt,useId:jt,useHostTransitionStatus:jt,useFormState:jt,useActionState:jt,useOptimistic:jt,useMemoCache:jt,useCacheRefresh:jt};Sl.useEffectEvent=jt;var fg={readContext:Jt,use:cc,useCallback:function(e,t){return an().memoizedState=[e,t===void 0?null:t],e},useContext:Jt,useEffect:X0,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,uc(4194308,4,eg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return uc(4194308,4,e,t)},useInsertionEffect:function(e,t){uc(4,2,e,t)},useMemo:function(e,t){var r=an();t=t===void 0?null:t;var l=e();if(Ra){Ln(!0);try{e()}finally{Ln(!1)}}return r.memoizedState=[l,t],l},useReducer:function(e,t,r){var l=an();if(r!==void 0){var u=r(t);if(Ra){Ln(!0);try{r(t)}finally{Ln(!1)}}}else u=t;return l.memoizedState=l.baseState=u,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:u},l.queue=e,e=e.dispatch=Wb.bind(null,Pe,e),[l.memoizedState,e]},useRef:function(e){var t=an();return e={current:e},t.memoizedState=e},useState:function(e){e=gu(e);var t=e.queue,r=dg.bind(null,Pe,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:xu,useDeferredValue:function(e,t){var r=an();return yu(r,e,t)},useTransition:function(){var e=gu(!1);return e=ag.bind(null,Pe,e.queue,!0,!1),an().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var l=Pe,u=an();if(Ke){if(r===void 0)throw Error(o(407));r=r()}else{if(r=t(),ft===null)throw Error(o(349));(We&127)!==0||O0(l,t,r)}u.memoizedState=r;var f={value:r,getSnapshot:t};return u.queue=f,X0(D0.bind(null,l,f,e),[e]),l.flags|=2048,_i(9,{destroy:void 0},I0.bind(null,l,f,r,t),null),r},useId:function(){var e=an(),t=ft.identifierPrefix;if(Ke){var r=Ts,l=Es;r=(l&~(1<<32-Rt(l)-1)).toString(32)+r,t="_"+t+"R_"+r,r=lc++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=zb++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:vu,useFormState:F0,useActionState:F0,useOptimistic:function(e){var t=an();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=wu.bind(null,Pe,!0,r),r.dispatch=t,[e,t]},useMemoCache:uu,useCacheRefresh:function(){return an().memoizedState=Fb.bind(null,Pe)},useEffectEvent:function(e){var t=an(),r={impl:e};return t.memoizedState=r,function(){if((nt&2)!==0)throw Error(o(440));return r.impl.apply(void 0,arguments)}}},ju={readContext:Jt,use:cc,useCallback:ng,useContext:Jt,useEffect:pu,useImperativeHandle:tg,useInsertionEffect:Q0,useLayoutEffect:Z0,useMemo:sg,useReducer:dc,useRef:K0,useState:function(){return dc(Xs)},useDebugValue:xu,useDeferredValue:function(e,t){var r=At();return rg(r,ct.memoizedState,e,t)},useTransition:function(){var e=dc(Xs)[0],t=At().memoizedState;return[typeof e=="boolean"?e:_l(e),t]},useSyncExternalStore:L0,useId:og,useHostTransitionStatus:vu,useFormState:W0,useActionState:W0,useOptimistic:function(e,t){var r=At();return z0(r,ct,e,t)},useMemoCache:uu,useCacheRefresh:cg};ju.useEffectEvent=J0;var gg={readContext:Jt,use:cc,useCallback:ng,useContext:Jt,useEffect:pu,useImperativeHandle:tg,useInsertionEffect:Q0,useLayoutEffect:Z0,useMemo:sg,useReducer:fu,useRef:K0,useState:function(){return fu(Xs)},useDebugValue:xu,useDeferredValue:function(e,t){var r=At();return ct===null?yu(r,e,t):rg(r,ct.memoizedState,e,t)},useTransition:function(){var e=fu(Xs)[0],t=At().memoizedState;return[typeof e=="boolean"?e:_l(e),t]},useSyncExternalStore:L0,useId:og,useHostTransitionStatus:vu,useFormState:Y0,useActionState:Y0,useOptimistic:function(e,t){var r=At();return ct!==null?z0(r,ct,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:uu,useCacheRefresh:cg};gg.useEffectEvent=J0;function Nu(e,t,r,l){t=e.memoizedState,r=r(l,t),r=r==null?t:j({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _u={enqueueSetState:function(e,t,r){e=e._reactInternals;var l=En(),u=Mr(l);u.payload=t,r!=null&&(u.callback=r),t=Lr(e,u,l),t!==null&&(xn(t,e,l),vl(t,e,l))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var l=En(),u=Mr(l);u.tag=1,u.payload=t,r!=null&&(u.callback=r),t=Lr(e,u,l),t!==null&&(xn(t,e,l),vl(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=En(),l=Mr(r);l.tag=2,t!=null&&(l.callback=t),t=Lr(e,l,r),t!==null&&(xn(t,e,r),vl(t,e,r))}};function mg(e,t,r,l,u,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,f,y):t.prototype&&t.prototype.isPureReactComponent?!hl(r,l)||!hl(u,f):!0}function pg(e,t,r,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,l),t.state!==e&&_u.enqueueReplaceState(t,t.state,null)}function Ma(e,t){var r=t;if("ref"in t){r={};for(var l in t)l!=="ref"&&(r[l]=t[l])}if(e=e.defaultProps){r===t&&(r=j({},r));for(var u in e)r[u]===void 0&&(r[u]=e[u])}return r}function xg(e){Fo(e)}function yg(e){console.error(e)}function bg(e){Fo(e)}function gc(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function vg(e,t,r){try{var l=e.onCaughtError;l(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function ku(e,t,r){return r=Mr(r),r.tag=3,r.payload={element:null},r.callback=function(){gc(e,t)},r}function wg(e){return e=Mr(e),e.tag=3,e}function jg(e,t,r,l){var u=r.type.getDerivedStateFromError;if(typeof u=="function"){var f=l.value;e.payload=function(){return u(f)},e.callback=function(){vg(t,r,l)}}var y=r.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){vg(t,r,l),typeof u!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var C=l.stack;this.componentDidCatch(l.value,{componentStack:C!==null?C:""})})}function qb(e,t,r,l,u){if(r.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=r.alternate,t!==null&&pi(t,r,u,!0),r=_n.current,r!==null){switch(r.tag){case 31:case 13:return Gn===null?Sc():r.alternate===null&&Nt===0&&(Nt=3),r.flags&=-257,r.flags|=65536,r.lanes=u,l===tc?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([l]):t.add(l),Xu(e,l,u)),!1;case 22:return r.flags|=65536,l===tc?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([l]):r.add(l)),Xu(e,l,u)),!1}throw Error(o(435,r.tag))}return Xu(e,l,u),Sc(),!1}if(Ke)return t=_n.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=u,l!==$d&&(e=Error(o(422),{cause:l}),ml(Bn(e,r)))):(l!==$d&&(t=Error(o(423),{cause:l}),ml(Bn(t,r))),e=e.current.alternate,e.flags|=65536,u&=-u,e.lanes|=u,l=Bn(l,r),u=ku(e.stateNode,l,u),tu(e,u),Nt!==4&&(Nt=2)),!1;var f=Error(o(520),{cause:l});if(f=Bn(f,r),Ol===null?Ol=[f]:Ol.push(f),Nt!==4&&(Nt=2),t===null)return!0;l=Bn(l,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=u&-u,r.lanes|=e,e=ku(r.stateNode,l,e),tu(r,e),!1;case 1:if(t=r.type,f=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(zr===null||!zr.has(f))))return r.flags|=65536,u&=-u,r.lanes|=u,u=wg(u),jg(u,e,r,l),tu(r,u),!1}r=r.return}while(r!==null);return!1}var Su=Error(o(461)),Bt=!1;function Qt(e,t,r,l){t.child=e===null?S0(t,null,r,l):Aa(t,e.child,r,l)}function Ng(e,t,r,l,u){r=r.render;var f=t.ref;if("ref"in l){var y={};for(var C in l)C!=="ref"&&(y[C]=l[C])}else y=l;return Sa(t),l=lu(e,t,r,y,f,u),C=ou(),e!==null&&!Bt?(cu(e,t,u),Js(e,t,u)):(Ke&&C&&Gd(t),t.flags|=1,Qt(e,t,l,u),t.child)}function _g(e,t,r,l,u){if(e===null){var f=r.type;return typeof f=="function"&&!zd(f)&&f.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=f,kg(e,t,f,l,u)):(e=Ko(r.type,null,l,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!Ou(e,u)){var y=f.memoizedProps;if(r=r.compare,r=r!==null?r:hl,r(y,l)&&e.ref===t.ref)return Js(e,t,u)}return t.flags|=1,e=Fs(f,l),e.ref=t.ref,e.return=t,t.child=e}function kg(e,t,r,l,u){if(e!==null){var f=e.memoizedProps;if(hl(f,l)&&e.ref===t.ref)if(Bt=!1,t.pendingProps=l=f,Ou(e,u))(e.flags&131072)!==0&&(Bt=!0);else return t.lanes=e.lanes,Js(e,t,u)}return Cu(e,t,r,l,u)}function Sg(e,t,r,l){var u=l.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|r:r,e!==null){for(l=t.child=e.child,u=0;l!==null;)u=u|l.lanes|l.childLanes,l=l.sibling;l=u&~f}else l=0,t.child=null;return Cg(e,t,f,r,l)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Zo(t,f!==null?f.cachePool:null),f!==null?T0(t,f):su(),A0(t);else return l=t.lanes=536870912,Cg(e,t,f!==null?f.baseLanes|r:r,r,l)}else f!==null?(Zo(t,f.cachePool),T0(t,f),Ir(),t.memoizedState=null):(e!==null&&Zo(t,null),su(),Ir());return Qt(e,t,u,r),t.child}function Cl(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Cg(e,t,r,l,u){var f=Jd();return f=f===null?null:{parent:Dt._currentValue,pool:f},t.memoizedState={baseLanes:r,cachePool:f},e!==null&&Zo(t,null),su(),A0(t),e!==null&&pi(e,t,l,!0),t.childLanes=u,null}function mc(e,t){return t=xc({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Eg(e,t,r){return Aa(t,e.child,null,r),e=mc(t,t.pendingProps),e.flags|=2,kn(t),t.memoizedState=null,e}function Yb(e,t,r){var l=t.pendingProps,u=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ke){if(l.mode==="hidden")return e=mc(t,l),t.lanes=536870912,Cl(null,e);if(au(t),(e=gt)?(e=Pm(e,Hn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Cr!==null?{id:Es,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},r=u0(e),r.return=t,t.child=r,Xt=t,gt=null)):e=null,e===null)throw Tr(t);return t.lanes=536870912,null}return mc(t,l)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(au(t),u)if(t.flags&256)t.flags&=-257,t=Eg(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(o(558));else if(Bt||pi(e,t,r,!1),u=(r&e.childLanes)!==0,Bt||u){if(l=ft,l!==null&&(y=Yi(l,r),y!==0&&y!==f.retryLane))throw f.retryLane=y,ja(e,y),xn(l,e,y),Su;Sc(),t=Eg(e,t,r)}else e=f.treeContext,gt=Vn(y.nextSibling),Xt=t,Ke=!0,Er=null,Hn=!1,e!==null&&g0(t,e),t=mc(t,l),t.flags|=4096;return t}return e=Fs(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function pc(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(o(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function Cu(e,t,r,l,u){return Sa(t),r=lu(e,t,r,l,void 0,u),l=ou(),e!==null&&!Bt?(cu(e,t,u),Js(e,t,u)):(Ke&&l&&Gd(t),t.flags|=1,Qt(e,t,r,u),t.child)}function Tg(e,t,r,l,u,f){return Sa(t),t.updateQueue=null,r=M0(t,l,r,u),R0(e),l=ou(),e!==null&&!Bt?(cu(e,t,f),Js(e,t,f)):(Ke&&l&&Gd(t),t.flags|=1,Qt(e,t,r,f),t.child)}function Ag(e,t,r,l,u){if(Sa(t),t.stateNode===null){var f=hi,y=r.contextType;typeof y=="object"&&y!==null&&(f=Jt(y)),f=new r(l,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=_u,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=l,f.state=t.memoizedState,f.refs={},Zd(t),y=r.contextType,f.context=typeof y=="object"&&y!==null?Jt(y):hi,f.state=t.memoizedState,y=r.getDerivedStateFromProps,typeof y=="function"&&(Nu(t,r,y,l),f.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&_u.enqueueReplaceState(f,f.state,null),jl(t,l,f,u),wl(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){f=t.stateNode;var C=t.memoizedProps,H=Ma(r,C);f.props=H;var ee=f.context,le=r.contextType;y=hi,typeof le=="object"&&le!==null&&(y=Jt(le));var he=r.getDerivedStateFromProps;le=typeof he=="function"||typeof f.getSnapshotBeforeUpdate=="function",C=t.pendingProps!==C,le||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(C||ee!==y)&&pg(t,f,l,y),Rr=!1;var ne=t.memoizedState;f.state=ne,jl(t,l,f,u),wl(),ee=t.memoizedState,C||ne!==ee||Rr?(typeof he=="function"&&(Nu(t,r,he,l),ee=t.memoizedState),(H=Rr||mg(t,r,H,l,ne,ee,y))?(le||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=ee),f.props=l,f.state=ee,f.context=y,l=H):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{f=t.stateNode,eu(e,t),y=t.memoizedProps,le=Ma(r,y),f.props=le,he=t.pendingProps,ne=f.context,ee=r.contextType,H=hi,typeof ee=="object"&&ee!==null&&(H=Jt(ee)),C=r.getDerivedStateFromProps,(ee=typeof C=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==he||ne!==H)&&pg(t,f,l,H),Rr=!1,ne=t.memoizedState,f.state=ne,jl(t,l,f,u),wl();var ae=t.memoizedState;y!==he||ne!==ae||Rr||e!==null&&e.dependencies!==null&&Jo(e.dependencies)?(typeof C=="function"&&(Nu(t,r,C,l),ae=t.memoizedState),(le=Rr||mg(t,r,le,l,ne,ae,H)||e!==null&&e.dependencies!==null&&Jo(e.dependencies))?(ee||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(l,ae,H),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(l,ae,H)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&ne===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&ne===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=ae),f.props=l,f.state=ae,f.context=H,l=le):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&ne===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&ne===e.memoizedState||(t.flags|=1024),l=!1)}return f=l,pc(e,t),l=(t.flags&128)!==0,f||l?(f=t.stateNode,r=l&&typeof r.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&l?(t.child=Aa(t,e.child,null,u),t.child=Aa(t,null,r,u)):Qt(e,t,r,u),t.memoizedState=f.state,e=t.child):e=Js(e,t,u),e}function Rg(e,t,r,l){return _a(),t.flags|=256,Qt(e,t,r,l),t.child}var Eu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Tu(e){return{baseLanes:e,cachePool:v0()}}function Au(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=Cn),e}function Mg(e,t,r){var l=t.pendingProps,u=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(Tt.current&2)!==0),y&&(u=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ke){if(u?Or(t):Ir(),(e=gt)?(e=Pm(e,Hn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Cr!==null?{id:Es,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},r=u0(e),r.return=t,t.child=r,Xt=t,gt=null)):e=null,e===null)throw Tr(t);return hh(e)?t.lanes=32:t.lanes=536870912,null}var C=l.children;return l=l.fallback,u?(Ir(),u=t.mode,C=xc({mode:"hidden",children:C},u),l=Na(l,u,r,null),C.return=t,l.return=t,C.sibling=l,t.child=C,l=t.child,l.memoizedState=Tu(r),l.childLanes=Au(e,y,r),t.memoizedState=Eu,Cl(null,l)):(Or(t),Ru(t,C))}var H=e.memoizedState;if(H!==null&&(C=H.dehydrated,C!==null)){if(f)t.flags&256?(Or(t),t.flags&=-257,t=Mu(e,t,r)):t.memoizedState!==null?(Ir(),t.child=e.child,t.flags|=128,t=null):(Ir(),C=l.fallback,u=t.mode,l=xc({mode:"visible",children:l.children},u),C=Na(C,u,r,null),C.flags|=2,l.return=t,C.return=t,l.sibling=C,t.child=l,Aa(t,e.child,null,r),l=t.child,l.memoizedState=Tu(r),l.childLanes=Au(e,y,r),t.memoizedState=Eu,t=Cl(null,l));else if(Or(t),hh(C)){if(y=C.nextSibling&&C.nextSibling.dataset,y)var ee=y.dgst;y=ee,l=Error(o(419)),l.stack="",l.digest=y,ml({value:l,source:null,stack:null}),t=Mu(e,t,r)}else if(Bt||pi(e,t,r,!1),y=(r&e.childLanes)!==0,Bt||y){if(y=ft,y!==null&&(l=Yi(y,r),l!==0&&l!==H.retryLane))throw H.retryLane=l,ja(e,l),xn(y,e,l),Su;uh(C)||Sc(),t=Mu(e,t,r)}else uh(C)?(t.flags|=192,t.child=e.child,t=null):(e=H.treeContext,gt=Vn(C.nextSibling),Xt=t,Ke=!0,Er=null,Hn=!1,e!==null&&g0(t,e),t=Ru(t,l.children),t.flags|=4096);return t}return u?(Ir(),C=l.fallback,u=t.mode,H=e.child,ee=H.sibling,l=Fs(H,{mode:"hidden",children:l.children}),l.subtreeFlags=H.subtreeFlags&65011712,ee!==null?C=Fs(ee,C):(C=Na(C,u,r,null),C.flags|=2),C.return=t,l.return=t,l.sibling=C,t.child=l,Cl(null,l),l=t.child,C=e.child.memoizedState,C===null?C=Tu(r):(u=C.cachePool,u!==null?(H=Dt._currentValue,u=u.parent!==H?{parent:H,pool:H}:u):u=v0(),C={baseLanes:C.baseLanes|r,cachePool:u}),l.memoizedState=C,l.childLanes=Au(e,y,r),t.memoizedState=Eu,Cl(e.child,l)):(Or(t),r=e.child,e=r.sibling,r=Fs(r,{mode:"visible",children:l.children}),r.return=t,r.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=r,t.memoizedState=null,r)}function Ru(e,t){return t=xc({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function xc(e,t){return e=Nn(22,e,null,t),e.lanes=0,e}function Mu(e,t,r){return Aa(t,e.child,null,r),e=Ru(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Lg(e,t,r){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),qd(e.return,t,r)}function Lu(e,t,r,l,u,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:r,tailMode:u,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=l,y.tail=r,y.tailMode=u,y.treeForkCount=f)}function Og(e,t,r){var l=t.pendingProps,u=l.revealOrder,f=l.tail;l=l.children;var y=Tt.current,C=(y&2)!==0;if(C?(y=y&1|2,t.flags|=128):y&=1,W(Tt,y),Qt(e,t,l,r),l=Ke?gl:0,!C&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lg(e,r,t);else if(e.tag===19)Lg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(u){case"forwards":for(r=t.child,u=null;r!==null;)e=r.alternate,e!==null&&ac(e)===null&&(u=r),r=r.sibling;r=u,r===null?(u=t.child,t.child=null):(u=r.sibling,r.sibling=null),Lu(t,!1,u,r,f,l);break;case"backwards":case"unstable_legacy-backwards":for(r=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&ac(e)===null){t.child=u;break}e=u.sibling,u.sibling=r,r=u,u=e}Lu(t,!0,r,null,f,l);break;case"together":Lu(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function Js(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Br|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(pi(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(o(153));if(t.child!==null){for(e=t.child,r=Fs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Fs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ou(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Jo(e)))}function Kb(e,t,r){switch(t.tag){case 3:_e(t,t.stateNode.containerInfo),Ar(t,Dt,e.memoizedState.cache),_a();break;case 27:case 5:Ve(t);break;case 4:_e(t,t.stateNode.containerInfo);break;case 10:Ar(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,au(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(Or(t),t.flags|=128,null):(r&t.child.childLanes)!==0?Mg(e,t,r):(Or(t),e=Js(e,t,r),e!==null?e.sibling:null);Or(t);break;case 19:var u=(e.flags&128)!==0;if(l=(r&t.childLanes)!==0,l||(pi(e,t,r,!1),l=(r&t.childLanes)!==0),u){if(l)return Og(e,t,r);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),W(Tt,Tt.current),l)break;return null;case 22:return t.lanes=0,Sg(e,t,r,t.pendingProps);case 24:Ar(t,Dt,e.memoizedState.cache)}return Js(e,t,r)}function Ig(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)Bt=!0;else{if(!Ou(e,r)&&(t.flags&128)===0)return Bt=!1,Kb(e,t,r);Bt=(e.flags&131072)!==0}else Bt=!1,Ke&&(t.flags&1048576)!==0&&f0(t,gl,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=Ea(t.elementType),t.type=e,typeof e=="function")zd(e)?(l=Ma(e,l),t.tag=1,t=Ag(null,t,e,l,r)):(t.tag=0,t=Cu(null,t,e,l,r));else{if(e!=null){var u=e.$$typeof;if(u===X){t.tag=11,t=Ng(null,t,e,l,r);break e}else if(u===R){t.tag=14,t=_g(null,t,e,l,r);break e}}throw t=ye(e)||e,Error(o(306,t,""))}}return t;case 0:return Cu(e,t,t.type,t.pendingProps,r);case 1:return l=t.type,u=Ma(l,t.pendingProps),Ag(e,t,l,u,r);case 3:e:{if(_e(t,t.stateNode.containerInfo),e===null)throw Error(o(387));l=t.pendingProps;var f=t.memoizedState;u=f.element,eu(e,t),jl(t,l,null,r);var y=t.memoizedState;if(l=y.cache,Ar(t,Dt,l),l!==f.cache&&Yd(t,[Dt],r,!0),wl(),l=y.element,f.isDehydrated)if(f={element:l,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Rg(e,t,l,r);break e}else if(l!==u){u=Bn(Error(o(424)),t),ml(u),t=Rg(e,t,l,r);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,gt=Vn(e.firstChild),Xt=t,Ke=!0,Er=null,Hn=!0,r=S0(t,null,l,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_a(),l===u){t=Js(e,t,r);break e}Qt(e,t,l,r)}t=t.child}return t;case 26:return pc(e,t),e===null?(r=Wm(t.type,null,t.pendingProps,null))?t.memoizedState=r:Ke||(r=t.type,e=t.pendingProps,l=Lc(xe.current).createElement(r),l[Lt]=t,l[$t]=e,Zt(l,r,e),Ot(l),t.stateNode=l):t.memoizedState=Wm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ve(t),e===null&&Ke&&(l=t.stateNode=Vm(t.type,t.pendingProps,xe.current),Xt=t,Hn=!0,u=gt,Vr(t.type)?(fh=u,gt=Vn(l.firstChild)):gt=u),Qt(e,t,t.pendingProps.children,r),pc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ke&&((u=l=gt)&&(l=kv(l,t.type,t.pendingProps,Hn),l!==null?(t.stateNode=l,Xt=t,gt=Vn(l.firstChild),Hn=!1,u=!0):u=!1),u||Tr(t)),Ve(t),u=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,l=f.children,oh(u,f)?l=null:y!==null&&oh(u,y)&&(t.flags|=32),t.memoizedState!==null&&(u=lu(e,t,Pb,null,null,r),Gl._currentValue=u),pc(e,t),Qt(e,t,l,r),t.child;case 6:return e===null&&Ke&&((e=r=gt)&&(r=Sv(r,t.pendingProps,Hn),r!==null?(t.stateNode=r,Xt=t,gt=null,e=!0):e=!1),e||Tr(t)),null;case 13:return Mg(e,t,r);case 4:return _e(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Aa(t,null,l,r):Qt(e,t,l,r),t.child;case 11:return Ng(e,t,t.type,t.pendingProps,r);case 7:return Qt(e,t,t.pendingProps,r),t.child;case 8:return Qt(e,t,t.pendingProps.children,r),t.child;case 12:return Qt(e,t,t.pendingProps.children,r),t.child;case 10:return l=t.pendingProps,Ar(t,t.type,l.value),Qt(e,t,l.children,r),t.child;case 9:return u=t.type._context,l=t.pendingProps.children,Sa(t),u=Jt(u),l=l(u),t.flags|=1,Qt(e,t,l,r),t.child;case 14:return _g(e,t,t.type,t.pendingProps,r);case 15:return kg(e,t,t.type,t.pendingProps,r);case 19:return Og(e,t,r);case 31:return Yb(e,t,r);case 22:return Sg(e,t,r,t.pendingProps);case 24:return Sa(t),l=Jt(Dt),e===null?(u=Jd(),u===null&&(u=ft,f=Kd(),u.pooledCache=f,f.refCount++,f!==null&&(u.pooledCacheLanes|=r),u=f),t.memoizedState={parent:l,cache:u},Zd(t),Ar(t,Dt,u)):((e.lanes&r)!==0&&(eu(e,t),jl(t,null,null,r),wl()),u=e.memoizedState,f=t.memoizedState,u.parent!==l?(u={parent:l,cache:l},t.memoizedState=u,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=u),Ar(t,Dt,l)):(l=f.cache,Ar(t,Dt,l),l!==u.cache&&Yd(t,[Dt],r,!0))),Qt(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Qs(e){e.flags|=4}function Iu(e,t,r,l,u){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(u&335544128)===u)if(e.stateNode.complete)e.flags|=8192;else if(om())e.flags|=8192;else throw Ta=tc,Qd}else e.flags&=-16777217}function Dg(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Jm(t))if(om())e.flags|=8192;else throw Ta=tc,Qd}function yc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?No():536870912,e.lanes|=t,Ei|=t)}function El(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,l=0;if(t)for(var u=e.child;u!==null;)r|=u.lanes|u.childLanes,l|=u.subtreeFlags&65011712,l|=u.flags&65011712,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)r|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=r,t}function Xb(e,t,r){var l=t.pendingProps;switch(Vd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(t),null;case 1:return mt(t),null;case 3:return r=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Ys(Dt),Te(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(mi(t)?Qs(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Fd())),mt(t),null;case 26:var u=t.type,f=t.memoizedState;return e===null?(Qs(t),f!==null?(mt(t),Dg(t,f)):(mt(t),Iu(t,u,null,l,r))):f?f!==e.memoizedState?(Qs(t),mt(t),Dg(t,f)):(mt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&Qs(t),mt(t),Iu(t,u,e,l,r)),null;case 27:if(Ie(t),r=xe.current,u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&Qs(t);else{if(!l){if(t.stateNode===null)throw Error(o(166));return mt(t),null}e=q.current,mi(t)?m0(t):(e=Vm(u,l,r),t.stateNode=e,Qs(t))}return mt(t),null;case 5:if(Ie(t),u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&Qs(t);else{if(!l){if(t.stateNode===null)throw Error(o(166));return mt(t),null}if(f=q.current,mi(t))m0(t);else{var y=Lc(xe.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof l.is=="string"?y.createElement("select",{is:l.is}):y.createElement("select"),l.multiple?f.multiple=!0:l.size&&(f.size=l.size);break;default:f=typeof l.is=="string"?y.createElement(u,{is:l.is}):y.createElement(u)}}f[Lt]=t,f[$t]=l;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(Zt(f,u,l),u){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&Qs(t)}}return mt(t),Iu(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&Qs(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(o(166));if(e=xe.current,mi(t)){if(e=t.stateNode,r=t.memoizedProps,l=null,u=Xt,u!==null)switch(u.tag){case 27:case 5:l=u.memoizedProps}e[Lt]=t,e=!!(e.nodeValue===r||l!==null&&l.suppressHydrationWarning===!0||Mm(e.nodeValue,r)),e||Tr(t,!0)}else e=Lc(e).createTextNode(l),e[Lt]=t,t.stateNode=e}return mt(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(l=mi(t),r!==null){if(e===null){if(!l)throw Error(o(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[Lt]=t}else _a(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;mt(t),e=!1}else r=Fd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(kn(t),t):(kn(t),null);if((t.flags&128)!==0)throw Error(o(558))}return mt(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(u=mi(t),l!==null&&l.dehydrated!==null){if(e===null){if(!u)throw Error(o(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(o(317));u[Lt]=t}else _a(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;mt(t),u=!1}else u=Fd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=u),u=!0;if(!u)return t.flags&256?(kn(t),t):(kn(t),null)}return kn(t),(t.flags&128)!==0?(t.lanes=r,t):(r=l!==null,e=e!==null&&e.memoizedState!==null,r&&(l=t.child,u=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(u=l.alternate.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==u&&(l.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),yc(t,t.updateQueue),mt(t),null);case 4:return Te(),e===null&&sh(t.stateNode.containerInfo),mt(t),null;case 10:return Ys(t.type),mt(t),null;case 19:if(F(Tt),l=t.memoizedState,l===null)return mt(t),null;if(u=(t.flags&128)!==0,f=l.rendering,f===null)if(u)El(l,!1);else{if(Nt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=ac(e),f!==null){for(t.flags|=128,El(l,!1),e=f.updateQueue,t.updateQueue=e,yc(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)d0(r,e),r=r.sibling;return W(Tt,Tt.current&1|2),Ke&&Ws(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&ve()>Nc&&(t.flags|=128,u=!0,El(l,!1),t.lanes=4194304)}else{if(!u)if(e=ac(f),e!==null){if(t.flags|=128,u=!0,e=e.updateQueue,t.updateQueue=e,yc(t,e),El(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!Ke)return mt(t),null}else 2*ve()-l.renderingStartTime>Nc&&r!==536870912&&(t.flags|=128,u=!0,El(l,!1),t.lanes=4194304);l.isBackwards?(f.sibling=t.child,t.child=f):(e=l.last,e!==null?e.sibling=f:t.child=f,l.last=f)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=ve(),e.sibling=null,r=Tt.current,W(Tt,u?r&1|2:r&1),Ke&&Ws(t,l.treeForkCount),e):(mt(t),null);case 22:case 23:return kn(t),ru(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(r&536870912)!==0&&(t.flags&128)===0&&(mt(t),t.subtreeFlags&6&&(t.flags|=8192)):mt(t),r=t.updateQueue,r!==null&&yc(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==r&&(t.flags|=2048),e!==null&&F(Ca),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ys(Dt),mt(t),null;case 25:return null;case 30:return null}throw Error(o(156,t.tag))}function Jb(e,t){switch(Vd(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ys(Dt),Te(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ie(t),null;case 31:if(t.memoizedState!==null){if(kn(t),t.alternate===null)throw Error(o(340));_a()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(kn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(o(340));_a()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return F(Tt),null;case 4:return Te(),null;case 10:return Ys(t.type),null;case 22:case 23:return kn(t),ru(),e!==null&&F(Ca),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ys(Dt),null;case 25:return null;default:return null}}function Ug(e,t){switch(Vd(t),t.tag){case 3:Ys(Dt),Te();break;case 26:case 27:case 5:Ie(t);break;case 4:Te();break;case 31:t.memoizedState!==null&&kn(t);break;case 13:kn(t);break;case 19:F(Tt);break;case 10:Ys(t.type);break;case 22:case 23:kn(t),ru(),e!==null&&F(Ca);break;case 24:Ys(Dt)}}function Tl(e,t){try{var r=t.updateQueue,l=r!==null?r.lastEffect:null;if(l!==null){var u=l.next;r=u;do{if((r.tag&e)===e){l=void 0;var f=r.create,y=r.inst;l=f(),y.destroy=l}r=r.next}while(r!==u)}}catch(C){ot(t,t.return,C)}}function Dr(e,t,r){try{var l=t.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&e)===e){var y=l.inst,C=y.destroy;if(C!==void 0){y.destroy=void 0,u=t;var H=r,ee=C;try{ee()}catch(le){ot(u,H,le)}}}l=l.next}while(l!==f)}}catch(le){ot(t,t.return,le)}}function Bg(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{E0(t,r)}catch(l){ot(e,e.return,l)}}}function zg(e,t,r){r.props=Ma(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(l){ot(e,t,l)}}function Al(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof r=="function"?e.refCleanup=r(l):r.current=l}}catch(u){ot(e,t,u)}}function As(e,t){var r=e.ref,l=e.refCleanup;if(r!==null)if(typeof l=="function")try{l()}catch(u){ot(e,t,u)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(u){ot(e,t,u)}else r.current=null}function Pg(e){var t=e.type,r=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&l.focus();break e;case"img":r.src?l.src=r.src:r.srcSet&&(l.srcset=r.srcSet)}}catch(u){ot(e,e.return,u)}}function Du(e,t,r){try{var l=e.stateNode;bv(l,e.type,r,t),l[$t]=t}catch(u){ot(e,e.return,u)}}function Hg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Vr(e.type)||e.tag===4}function Uu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Vr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Bu(e,t,r){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Qn));else if(l!==4&&(l===27&&Vr(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(Bu(e,t,r),e=e.sibling;e!==null;)Bu(e,t,r),e=e.sibling}function bc(e,t,r){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(l!==4&&(l===27&&Vr(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(bc(e,t,r),e=e.sibling;e!==null;)bc(e,t,r),e=e.sibling}function Gg(e){var t=e.stateNode,r=e.memoizedProps;try{for(var l=e.type,u=t.attributes;u.length;)t.removeAttributeNode(u[0]);Zt(t,l,r),t[Lt]=e,t[$t]=r}catch(f){ot(e,e.return,f)}}var Zs=!1,zt=!1,zu=!1,Vg=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function Qb(e,t){if(e=e.containerInfo,ih=Pc,e=t0(e),Md(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var l=r.getSelection&&r.getSelection();if(l&&l.rangeCount!==0){r=l.anchorNode;var u=l.anchorOffset,f=l.focusNode;l=l.focusOffset;try{r.nodeType,f.nodeType}catch{r=null;break e}var y=0,C=-1,H=-1,ee=0,le=0,he=e,ne=null;t:for(;;){for(var ae;he!==r||u!==0&&he.nodeType!==3||(C=y+u),he!==f||l!==0&&he.nodeType!==3||(H=y+l),he.nodeType===3&&(y+=he.nodeValue.length),(ae=he.firstChild)!==null;)ne=he,he=ae;for(;;){if(he===e)break t;if(ne===r&&++ee===u&&(C=y),ne===f&&++le===l&&(H=y),(ae=he.nextSibling)!==null)break;he=ne,ne=he.parentNode}he=ae}r=C===-1||H===-1?null:{start:C,end:H}}else r=null}r=r||{start:0,end:0}}else r=null;for(lh={focusedElem:e,selectionRange:r},Pc=!1,Wt=t;Wt!==null;)if(t=Wt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Wt=e;else for(;Wt!==null;){switch(t=Wt,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)u=e[r],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,r=t,u=f.memoizedProps,f=f.memoizedState,l=r.stateNode;try{var Ne=Ma(r.type,u);e=l.getSnapshotBeforeUpdate(Ne,f),l.__reactInternalSnapshotBeforeUpdate=e}catch(Le){ot(r,r.return,Le)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)dh(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":dh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=t.sibling,e!==null){e.return=t.return,Wt=e;break}Wt=t.return}}function $g(e,t,r){var l=r.flags;switch(r.tag){case 0:case 11:case 15:tr(e,r),l&4&&Tl(5,r);break;case 1:if(tr(e,r),l&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(y){ot(r,r.return,y)}else{var u=Ma(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(u,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){ot(r,r.return,y)}}l&64&&Bg(r),l&512&&Al(r,r.return);break;case 3:if(tr(e,r),l&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{E0(e,t)}catch(y){ot(r,r.return,y)}}break;case 27:t===null&&l&4&&Gg(r);case 26:case 5:tr(e,r),t===null&&l&4&&Pg(r),l&512&&Al(r,r.return);break;case 12:tr(e,r);break;case 31:tr(e,r),l&4&&qg(e,r);break;case 13:tr(e,r),l&4&&Yg(e,r),l&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=lv.bind(null,r),Cv(e,r))));break;case 22:if(l=r.memoizedState!==null||Zs,!l){t=t!==null&&t.memoizedState!==null||zt,u=Zs;var f=zt;Zs=l,(zt=t)&&!f?nr(e,r,(r.subtreeFlags&8772)!==0):tr(e,r),Zs=u,zt=f}break;case 30:break;default:tr(e,r)}}function Fg(e){var t=e.alternate;t!==null&&(e.alternate=null,Fg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Qa(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var pt=null,fn=!1;function er(e,t,r){for(r=r.child;r!==null;)Wg(e,t,r),r=r.sibling}function Wg(e,t,r){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(Ct,r)}catch{}switch(r.tag){case 26:zt||As(r,t),er(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:zt||As(r,t);var l=pt,u=fn;Vr(r.type)&&(pt=r.stateNode,fn=!1),er(e,t,r),zl(r.stateNode),pt=l,fn=u;break;case 5:zt||As(r,t);case 6:if(l=pt,u=fn,pt=null,er(e,t,r),pt=l,fn=u,pt!==null)if(fn)try{(pt.nodeType===9?pt.body:pt.nodeName==="HTML"?pt.ownerDocument.body:pt).removeChild(r.stateNode)}catch(f){ot(r,t,f)}else try{pt.removeChild(r.stateNode)}catch(f){ot(r,t,f)}break;case 18:pt!==null&&(fn?(e=pt,Bm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),Di(e)):Bm(pt,r.stateNode));break;case 4:l=pt,u=fn,pt=r.stateNode.containerInfo,fn=!0,er(e,t,r),pt=l,fn=u;break;case 0:case 11:case 14:case 15:Dr(2,r,t),zt||Dr(4,r,t),er(e,t,r);break;case 1:zt||(As(r,t),l=r.stateNode,typeof l.componentWillUnmount=="function"&&zg(r,t,l)),er(e,t,r);break;case 21:er(e,t,r);break;case 22:zt=(l=zt)||r.memoizedState!==null,er(e,t,r),zt=l;break;default:er(e,t,r)}}function qg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Di(e)}catch(r){ot(t,t.return,r)}}}function Yg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Di(e)}catch(r){ot(t,t.return,r)}}function Zb(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Vg),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Vg),t;default:throw Error(o(435,e.tag))}}function vc(e,t){var r=Zb(e);t.forEach(function(l){if(!r.has(l)){r.add(l);var u=ov.bind(null,e,l);l.then(u,u)}})}function gn(e,t){var r=t.deletions;if(r!==null)for(var l=0;l<r.length;l++){var u=r[l],f=e,y=t,C=y;e:for(;C!==null;){switch(C.tag){case 27:if(Vr(C.type)){pt=C.stateNode,fn=!1;break e}break;case 5:pt=C.stateNode,fn=!1;break e;case 3:case 4:pt=C.stateNode.containerInfo,fn=!0;break e}C=C.return}if(pt===null)throw Error(o(160));Wg(f,y,u),pt=null,fn=!1,f=u.alternate,f!==null&&(f.return=null),u.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Kg(t,e),t=t.sibling}var rs=null;function Kg(e,t){var r=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:gn(t,e),mn(e),l&4&&(Dr(3,e,e.return),Tl(3,e),Dr(5,e,e.return));break;case 1:gn(t,e),mn(e),l&512&&(zt||r===null||As(r,r.return)),l&64&&Zs&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?l:r.concat(l))));break;case 26:var u=rs;if(gn(t,e),mn(e),l&512&&(zt||r===null||As(r,r.return)),l&4){var f=r!==null?r.memoizedState:null;if(l=e.memoizedState,r===null)if(l===null)if(e.stateNode===null){e:{l=e.type,r=e.memoizedProps,u=u.ownerDocument||u;t:switch(l){case"title":f=u.getElementsByTagName("title")[0],(!f||f[xs]||f[Lt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=u.createElement(l),u.head.insertBefore(f,u.querySelector("head > title"))),Zt(f,l,r),f[Lt]=e,Ot(f),l=f;break e;case"link":var y=Km("link","href",u).get(l+(r.href||""));if(y){for(var C=0;C<y.length;C++)if(f=y[C],f.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&f.getAttribute("rel")===(r.rel==null?null:r.rel)&&f.getAttribute("title")===(r.title==null?null:r.title)&&f.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){y.splice(C,1);break t}}f=u.createElement(l),Zt(f,l,r),u.head.appendChild(f);break;case"meta":if(y=Km("meta","content",u).get(l+(r.content||""))){for(C=0;C<y.length;C++)if(f=y[C],f.getAttribute("content")===(r.content==null?null:""+r.content)&&f.getAttribute("name")===(r.name==null?null:r.name)&&f.getAttribute("property")===(r.property==null?null:r.property)&&f.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&f.getAttribute("charset")===(r.charSet==null?null:r.charSet)){y.splice(C,1);break t}}f=u.createElement(l),Zt(f,l,r),u.head.appendChild(f);break;default:throw Error(o(468,l))}f[Lt]=e,Ot(f),l=f}e.stateNode=l}else Xm(u,e.type,e.stateNode);else e.stateNode=Ym(u,l,e.memoizedProps);else f!==l?(f===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):f.count--,l===null?Xm(u,e.type,e.stateNode):Ym(u,l,e.memoizedProps)):l===null&&e.stateNode!==null&&Du(e,e.memoizedProps,r.memoizedProps)}break;case 27:gn(t,e),mn(e),l&512&&(zt||r===null||As(r,r.return)),r!==null&&l&4&&Du(e,e.memoizedProps,r.memoizedProps);break;case 5:if(gn(t,e),mn(e),l&512&&(zt||r===null||As(r,r.return)),e.flags&32){u=e.stateNode;try{hn(u,"")}catch(Ne){ot(e,e.return,Ne)}}l&4&&e.stateNode!=null&&(u=e.memoizedProps,Du(e,u,r!==null?r.memoizedProps:u)),l&1024&&(zu=!0);break;case 6:if(gn(t,e),mn(e),l&4){if(e.stateNode===null)throw Error(o(162));l=e.memoizedProps,r=e.stateNode;try{r.nodeValue=l}catch(Ne){ot(e,e.return,Ne)}}break;case 3:if(Dc=null,u=rs,rs=Oc(t.containerInfo),gn(t,e),rs=u,mn(e),l&4&&r!==null&&r.memoizedState.isDehydrated)try{Di(t.containerInfo)}catch(Ne){ot(e,e.return,Ne)}zu&&(zu=!1,Xg(e));break;case 4:l=rs,rs=Oc(e.stateNode.containerInfo),gn(t,e),mn(e),rs=l;break;case 12:gn(t,e),mn(e);break;case 31:gn(t,e),mn(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,vc(e,l)));break;case 13:gn(t,e),mn(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(jc=ve()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,vc(e,l)));break;case 22:u=e.memoizedState!==null;var H=r!==null&&r.memoizedState!==null,ee=Zs,le=zt;if(Zs=ee||u,zt=le||H,gn(t,e),zt=le,Zs=ee,mn(e),l&8192)e:for(t=e.stateNode,t._visibility=u?t._visibility&-2:t._visibility|1,u&&(r===null||H||Zs||zt||La(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){H=r=t;try{if(f=H.stateNode,u)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{C=H.stateNode;var he=H.memoizedProps.style,ne=he!=null&&he.hasOwnProperty("display")?he.display:null;C.style.display=ne==null||typeof ne=="boolean"?"":(""+ne).trim()}}catch(Ne){ot(H,H.return,Ne)}}}else if(t.tag===6){if(r===null){H=t;try{H.stateNode.nodeValue=u?"":H.memoizedProps}catch(Ne){ot(H,H.return,Ne)}}}else if(t.tag===18){if(r===null){H=t;try{var ae=H.stateNode;u?zm(ae,!0):zm(H.stateNode,!1)}catch(Ne){ot(H,H.return,Ne)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(r=l.retryQueue,r!==null&&(l.retryQueue=null,vc(e,r))));break;case 19:gn(t,e),mn(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,vc(e,l)));break;case 30:break;case 21:break;default:gn(t,e),mn(e)}}function mn(e){var t=e.flags;if(t&2){try{for(var r,l=e.return;l!==null;){if(Hg(l)){r=l;break}l=l.return}if(r==null)throw Error(o(160));switch(r.tag){case 27:var u=r.stateNode,f=Uu(e);bc(e,f,u);break;case 5:var y=r.stateNode;r.flags&32&&(hn(y,""),r.flags&=-33);var C=Uu(e);bc(e,C,y);break;case 3:case 4:var H=r.stateNode.containerInfo,ee=Uu(e);Bu(e,ee,H);break;default:throw Error(o(161))}}catch(le){ot(e,e.return,le)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Xg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Xg(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function tr(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)$g(e,t.alternate,t),t=t.sibling}function La(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Dr(4,t,t.return),La(t);break;case 1:As(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&zg(t,t.return,r),La(t);break;case 27:zl(t.stateNode);case 26:case 5:As(t,t.return),La(t);break;case 22:t.memoizedState===null&&La(t);break;case 30:La(t);break;default:La(t)}e=e.sibling}}function nr(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,u=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:nr(u,f,r),Tl(4,f);break;case 1:if(nr(u,f,r),l=f,u=l.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(ee){ot(l,l.return,ee)}if(l=f,u=l.updateQueue,u!==null){var C=l.stateNode;try{var H=u.shared.hiddenCallbacks;if(H!==null)for(u.shared.hiddenCallbacks=null,u=0;u<H.length;u++)C0(H[u],C)}catch(ee){ot(l,l.return,ee)}}r&&y&64&&Bg(f),Al(f,f.return);break;case 27:Gg(f);case 26:case 5:nr(u,f,r),r&&l===null&&y&4&&Pg(f),Al(f,f.return);break;case 12:nr(u,f,r);break;case 31:nr(u,f,r),r&&y&4&&qg(u,f);break;case 13:nr(u,f,r),r&&y&4&&Yg(u,f);break;case 22:f.memoizedState===null&&nr(u,f,r),Al(f,f.return);break;case 30:break;default:nr(u,f,r)}t=t.sibling}}function Pu(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&pl(r))}function Hu(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&pl(e))}function as(e,t,r,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Jg(e,t,r,l),t=t.sibling}function Jg(e,t,r,l){var u=t.flags;switch(t.tag){case 0:case 11:case 15:as(e,t,r,l),u&2048&&Tl(9,t);break;case 1:as(e,t,r,l);break;case 3:as(e,t,r,l),u&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&pl(e)));break;case 12:if(u&2048){as(e,t,r,l),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,C=f.onPostCommit;typeof C=="function"&&C(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(H){ot(t,t.return,H)}}else as(e,t,r,l);break;case 31:as(e,t,r,l);break;case 13:as(e,t,r,l);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?as(e,t,r,l):Rl(e,t):f._visibility&2?as(e,t,r,l):(f._visibility|=2,ki(e,t,r,l,(t.subtreeFlags&10256)!==0||!1)),u&2048&&Pu(y,t);break;case 24:as(e,t,r,l),u&2048&&Hu(t.alternate,t);break;default:as(e,t,r,l)}}function ki(e,t,r,l,u){for(u=u&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,C=r,H=l,ee=y.flags;switch(y.tag){case 0:case 11:case 15:ki(f,y,C,H,u),Tl(8,y);break;case 23:break;case 22:var le=y.stateNode;y.memoizedState!==null?le._visibility&2?ki(f,y,C,H,u):Rl(f,y):(le._visibility|=2,ki(f,y,C,H,u)),u&&ee&2048&&Pu(y.alternate,y);break;case 24:ki(f,y,C,H,u),u&&ee&2048&&Hu(y.alternate,y);break;default:ki(f,y,C,H,u)}t=t.sibling}}function Rl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,l=t,u=l.flags;switch(l.tag){case 22:Rl(r,l),u&2048&&Pu(l.alternate,l);break;case 24:Rl(r,l),u&2048&&Hu(l.alternate,l);break;default:Rl(r,l)}t=t.sibling}}var Ml=8192;function Si(e,t,r){if(e.subtreeFlags&Ml)for(e=e.child;e!==null;)Qg(e,t,r),e=e.sibling}function Qg(e,t,r){switch(e.tag){case 26:Si(e,t,r),e.flags&Ml&&e.memoizedState!==null&&zv(r,rs,e.memoizedState,e.memoizedProps);break;case 5:Si(e,t,r);break;case 3:case 4:var l=rs;rs=Oc(e.stateNode.containerInfo),Si(e,t,r),rs=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=Ml,Ml=16777216,Si(e,t,r),Ml=l):Si(e,t,r));break;default:Si(e,t,r)}}function Zg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ll(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var l=t[r];Wt=l,tm(l,e)}Zg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)em(e),e=e.sibling}function em(e){switch(e.tag){case 0:case 11:case 15:Ll(e),e.flags&2048&&Dr(9,e,e.return);break;case 3:Ll(e);break;case 12:Ll(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,wc(e)):Ll(e);break;default:Ll(e)}}function wc(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var l=t[r];Wt=l,tm(l,e)}Zg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Dr(8,t,t.return),wc(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,wc(t));break;default:wc(t)}e=e.sibling}}function tm(e,t){for(;Wt!==null;){var r=Wt;switch(r.tag){case 0:case 11:case 15:Dr(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var l=r.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:pl(r.memoizedState.cache)}if(l=r.child,l!==null)l.return=r,Wt=l;else e:for(r=e;Wt!==null;){l=Wt;var u=l.sibling,f=l.return;if(Fg(l),l===r){Wt=null;break e}if(u!==null){u.return=f,Wt=u;break e}Wt=f}}}var ev={getCacheForType:function(e){var t=Jt(Dt),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Jt(Dt).controller.signal}},tv=typeof WeakMap=="function"?WeakMap:Map,nt=0,ft=null,$e=null,We=0,lt=0,Sn=null,Ur=!1,Ci=!1,Gu=!1,sr=0,Nt=0,Br=0,Oa=0,Vu=0,Cn=0,Ei=0,Ol=null,pn=null,$u=!1,jc=0,nm=0,Nc=1/0,_c=null,zr=null,Ht=0,Pr=null,Ti=null,rr=0,Fu=0,Wu=null,sm=null,Il=0,qu=null;function En(){return(nt&2)!==0&&We!==0?We&-We:V.T!==null?Zu():ko()}function rm(){if(Cn===0)if((We&536870912)===0||Ke){var e=oa;oa<<=1,(oa&3932160)===0&&(oa=262144),Cn=e}else Cn=536870912;return e=_n.current,e!==null&&(e.flags|=32),Cn}function xn(e,t,r){(e===ft&&(lt===2||lt===9)||e.cancelPendingCommit!==null)&&(Ai(e,0),Hr(e,We,Cn,!1)),ca(e,r),((nt&2)===0||e!==ft)&&(e===ft&&((nt&2)===0&&(Oa|=r),Nt===4&&Hr(e,We,Cn,!1)),Rs(e))}function am(e,t,r){if((nt&6)!==0)throw Error(o(327));var l=!r&&(t&127)===0&&(t&e.expiredLanes)===0||Kn(e,t),u=l?rv(e,t):Ku(e,t,!0),f=l;do{if(u===0){Ci&&!l&&Hr(e,t,0,!1);break}else{if(r=e.current.alternate,f&&!nv(r)){u=Ku(e,t,!1),f=!1;continue}if(u===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var C=e;u=Ol;var H=C.current.memoizedState.isDehydrated;if(H&&(Ai(C,y).flags|=256),y=Ku(C,y,!1),y!==2){if(Gu&&!H){C.errorRecoveryDisabledLanes|=f,Oa|=f,u=4;break e}f=pn,pn=u,f!==null&&(pn===null?pn=f:pn.push.apply(pn,f))}u=y}if(f=!1,u!==2)continue}}if(u===1){Ai(e,0),Hr(e,t,0,!0);break}e:{switch(l=e,f=u,f){case 0:case 1:throw Error(o(345));case 4:if((t&4194048)!==t)break;case 6:Hr(l,t,Cn,!Ur);break e;case 2:pn=null;break;case 3:case 5:break;default:throw Error(o(329))}if((t&62914560)===t&&(u=jc+300-ve(),10<u)){if(Hr(l,t,Cn,!Ur),gs(l,0,!0)!==0)break e;rr=t,l.timeoutHandle=Dm(im.bind(null,l,r,pn,_c,$u,t,Cn,Oa,Ei,Ur,f,"Throttled",-0,0),u);break e}im(l,r,pn,_c,$u,t,Cn,Oa,Ei,Ur,f,null,-0,0)}}break}while(!0);Rs(e)}function im(e,t,r,l,u,f,y,C,H,ee,le,he,ne,ae){if(e.timeoutHandle=-1,he=t.subtreeFlags,he&8192||(he&16785408)===16785408){he={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qn},Qg(t,f,he);var Ne=(f&62914560)===f?jc-ve():(f&4194048)===f?nm-ve():0;if(Ne=Pv(he,Ne),Ne!==null){rr=f,e.cancelPendingCommit=Ne(gm.bind(null,e,t,f,r,l,u,y,C,H,le,he,null,ne,ae)),Hr(e,f,y,!ee);return}}gm(e,t,f,r,l,u,y,C,H)}function nv(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var l=0;l<r.length;l++){var u=r[l],f=u.getSnapshot;u=u.value;try{if(!jn(f(),u))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hr(e,t,r,l){t&=~Vu,t&=~Oa,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var u=t;0<u;){var f=31-Rt(u),y=1<<f;l[f]=-1,u&=~y}r!==0&&Xa(e,r,t)}function kc(){return(nt&6)===0?(Dl(0),!1):!0}function Yu(){if($e!==null){if(lt===0)var e=$e.return;else e=$e,qs=ka=null,du(e),vi=null,yl=0,e=$e;for(;e!==null;)Ug(e.alternate,e),e=e.return;$e=null}}function Ai(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,jv(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),rr=0,Yu(),ft=e,$e=r=Fs(e.current,null),We=t,lt=0,Sn=null,Ur=!1,Ci=Kn(e,t),Gu=!1,Ei=Cn=Vu=Oa=Br=Nt=0,pn=Ol=null,$u=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var u=31-Rt(l),f=1<<u;t|=e[u],l&=~f}return sr=t,Wo(),r}function lm(e,t){Pe=null,V.H=Sl,t===bi||t===ec?(t=N0(),lt=3):t===Qd?(t=N0(),lt=4):lt=t===Su?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Sn=t,$e===null&&(Nt=1,gc(e,Bn(t,e.current)))}function om(){var e=_n.current;return e===null?!0:(We&4194048)===We?Gn===null:(We&62914560)===We||(We&536870912)!==0?e===Gn:!1}function cm(){var e=V.H;return V.H=Sl,e===null?Sl:e}function dm(){var e=V.A;return V.A=ev,e}function Sc(){Nt=4,Ur||(We&4194048)!==We&&_n.current!==null||(Ci=!0),(Br&134217727)===0&&(Oa&134217727)===0||ft===null||Hr(ft,We,Cn,!1)}function Ku(e,t,r){var l=nt;nt|=2;var u=cm(),f=dm();(ft!==e||We!==t)&&(_c=null,Ai(e,t)),t=!1;var y=Nt;e:do try{if(lt!==0&&$e!==null){var C=$e,H=Sn;switch(lt){case 8:Yu(),y=6;break e;case 3:case 2:case 9:case 6:_n.current===null&&(t=!0);var ee=lt;if(lt=0,Sn=null,Ri(e,C,H,ee),r&&Ci){y=0;break e}break;default:ee=lt,lt=0,Sn=null,Ri(e,C,H,ee)}}sv(),y=Nt;break}catch(le){lm(e,le)}while(!0);return t&&e.shellSuspendCounter++,qs=ka=null,nt=l,V.H=u,V.A=f,$e===null&&(ft=null,We=0,Wo()),y}function sv(){for(;$e!==null;)um($e)}function rv(e,t){var r=nt;nt|=2;var l=cm(),u=dm();ft!==e||We!==t?(_c=null,Nc=ve()+500,Ai(e,t)):Ci=Kn(e,t);e:do try{if(lt!==0&&$e!==null){t=$e;var f=Sn;t:switch(lt){case 1:lt=0,Sn=null,Ri(e,t,f,1);break;case 2:case 9:if(w0(f)){lt=0,Sn=null,hm(t);break}t=function(){lt!==2&&lt!==9||ft!==e||(lt=7),Rs(e)},f.then(t,t);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:w0(f)?(lt=0,Sn=null,hm(t)):(lt=0,Sn=null,Ri(e,t,f,7));break;case 5:var y=null;switch($e.tag){case 26:y=$e.memoizedState;case 5:case 27:var C=$e;if(y?Jm(y):C.stateNode.complete){lt=0,Sn=null;var H=C.sibling;if(H!==null)$e=H;else{var ee=C.return;ee!==null?($e=ee,Cc(ee)):$e=null}break t}}lt=0,Sn=null,Ri(e,t,f,5);break;case 6:lt=0,Sn=null,Ri(e,t,f,6);break;case 8:Yu(),Nt=6;break e;default:throw Error(o(462))}}av();break}catch(le){lm(e,le)}while(!0);return qs=ka=null,V.H=l,V.A=u,nt=r,$e!==null?0:(ft=null,We=0,Wo(),Nt)}function av(){for(;$e!==null&&!ge();)um($e)}function um(e){var t=Ig(e.alternate,e,sr);e.memoizedProps=e.pendingProps,t===null?Cc(e):$e=t}function hm(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Tg(r,t,t.pendingProps,t.type,void 0,We);break;case 11:t=Tg(r,t,t.pendingProps,t.type.render,t.ref,We);break;case 5:du(t);default:Ug(r,t),t=$e=d0(t,sr),t=Ig(r,t,sr)}e.memoizedProps=e.pendingProps,t===null?Cc(e):$e=t}function Ri(e,t,r,l){qs=ka=null,du(t),vi=null,yl=0;var u=t.return;try{if(qb(e,u,t,r,We)){Nt=1,gc(e,Bn(r,e.current)),$e=null;return}}catch(f){if(u!==null)throw $e=u,f;Nt=1,gc(e,Bn(r,e.current)),$e=null;return}t.flags&32768?(Ke||l===1?e=!0:Ci||(We&536870912)!==0?e=!1:(Ur=e=!0,(l===2||l===9||l===3||l===6)&&(l=_n.current,l!==null&&l.tag===13&&(l.flags|=16384))),fm(t,e)):Cc(t)}function Cc(e){var t=e;do{if((t.flags&32768)!==0){fm(t,Ur);return}e=t.return;var r=Xb(t.alternate,t,sr);if(r!==null){$e=r;return}if(t=t.sibling,t!==null){$e=t;return}$e=t=e}while(t!==null);Nt===0&&(Nt=5)}function fm(e,t){do{var r=Jb(e.alternate,e);if(r!==null){r.flags&=32767,$e=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){$e=e;return}$e=e=r}while(e!==null);Nt=6,$e=null}function gm(e,t,r,l,u,f,y,C,H){e.cancelPendingCommit=null;do Ec();while(Ht!==0);if((nt&6)!==0)throw Error(o(327));if(t!==null){if(t===e.current)throw Error(o(177));if(f=t.lanes|t.childLanes,f|=Ud,Ed(e,r,f,y,C,H),e===ft&&($e=ft=null,We=0),Ti=t,Pr=e,rr=r,Fu=f,Wu=u,sm=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,cv(Ze,function(){return bm(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=V.T,V.T=null,u=ie.p,ie.p=2,y=nt,nt|=4;try{Qb(e,t,r)}finally{nt=y,ie.p=u,V.T=l}}Ht=1,mm(),pm(),xm()}}function mm(){if(Ht===1){Ht=0;var e=Pr,t=Ti,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=V.T,V.T=null;var l=ie.p;ie.p=2;var u=nt;nt|=4;try{Kg(t,e);var f=lh,y=t0(e.containerInfo),C=f.focusedElem,H=f.selectionRange;if(y!==C&&C&&C.ownerDocument&&e0(C.ownerDocument.documentElement,C)){if(H!==null&&Md(C)){var ee=H.start,le=H.end;if(le===void 0&&(le=ee),"selectionStart"in C)C.selectionStart=ee,C.selectionEnd=Math.min(le,C.value.length);else{var he=C.ownerDocument||document,ne=he&&he.defaultView||window;if(ne.getSelection){var ae=ne.getSelection(),Ne=C.textContent.length,Le=Math.min(H.start,Ne),ut=H.end===void 0?Le:Math.min(H.end,Ne);!ae.extend&&Le>ut&&(y=ut,ut=Le,Le=y);var Y=Zf(C,Le),$=Zf(C,ut);if(Y&&$&&(ae.rangeCount!==1||ae.anchorNode!==Y.node||ae.anchorOffset!==Y.offset||ae.focusNode!==$.node||ae.focusOffset!==$.offset)){var Z=he.createRange();Z.setStart(Y.node,Y.offset),ae.removeAllRanges(),Le>ut?(ae.addRange(Z),ae.extend($.node,$.offset)):(Z.setEnd($.node,$.offset),ae.addRange(Z))}}}}for(he=[],ae=C;ae=ae.parentNode;)ae.nodeType===1&&he.push({element:ae,left:ae.scrollLeft,top:ae.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<he.length;C++){var ce=he[C];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}Pc=!!ih,lh=ih=null}finally{nt=u,ie.p=l,V.T=r}}e.current=t,Ht=2}}function pm(){if(Ht===2){Ht=0;var e=Pr,t=Ti,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=V.T,V.T=null;var l=ie.p;ie.p=2;var u=nt;nt|=4;try{$g(e,t.alternate,t)}finally{nt=u,ie.p=l,V.T=r}}Ht=3}}function xm(){if(Ht===4||Ht===3){Ht=0,fe();var e=Pr,t=Ti,r=rr,l=sm;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ht=5:(Ht=0,Ti=Pr=null,ym(e,e.pendingLanes));var u=e.pendingLanes;if(u===0&&(zr=null),Hs(r),t=t.stateNode,Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(Ct,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=V.T,u=ie.p,ie.p=2,V.T=null;try{for(var f=e.onRecoverableError,y=0;y<l.length;y++){var C=l[y];f(C.value,{componentStack:C.stack})}}finally{V.T=t,ie.p=u}}(rr&3)!==0&&Ec(),Rs(e),u=e.pendingLanes,(r&261930)!==0&&(u&42)!==0?e===qu?Il++:(Il=0,qu=e):Il=0,Dl(0)}}function ym(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,pl(t)))}function Ec(){return mm(),pm(),xm(),bm()}function bm(){if(Ht!==5)return!1;var e=Pr,t=Fu;Fu=0;var r=Hs(rr),l=V.T,u=ie.p;try{ie.p=32>r?32:r,V.T=null,r=Wu,Wu=null;var f=Pr,y=rr;if(Ht=0,Ti=Pr=null,rr=0,(nt&6)!==0)throw Error(o(331));var C=nt;if(nt|=4,em(f.current),Jg(f,f.current,y,r),nt=C,Dl(0,!1),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(Ct,f)}catch{}return!0}finally{ie.p=u,V.T=l,ym(e,t)}}function vm(e,t,r){t=Bn(r,t),t=ku(e.stateNode,t,2),e=Lr(e,t,2),e!==null&&(ca(e,2),Rs(e))}function ot(e,t,r){if(e.tag===3)vm(e,e,r);else for(;t!==null;){if(t.tag===3){vm(t,e,r);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(zr===null||!zr.has(l))){e=Bn(r,e),r=wg(2),l=Lr(t,r,2),l!==null&&(jg(r,l,t,e),ca(l,2),Rs(l));break}}t=t.return}}function Xu(e,t,r){var l=e.pingCache;if(l===null){l=e.pingCache=new tv;var u=new Set;l.set(t,u)}else u=l.get(t),u===void 0&&(u=new Set,l.set(t,u));u.has(r)||(Gu=!0,u.add(r),e=iv.bind(null,e,t,r),t.then(e,e))}function iv(e,t,r){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,ft===e&&(We&r)===r&&(Nt===4||Nt===3&&(We&62914560)===We&&300>ve()-jc?(nt&2)===0&&Ai(e,0):Vu|=r,Ei===We&&(Ei=0)),Rs(e)}function wm(e,t){t===0&&(t=No()),e=ja(e,t),e!==null&&(ca(e,t),Rs(e))}function lv(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),wm(e,r)}function ov(e,t){var r=0;switch(e.tag){case 31:case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(r=u.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(o(314))}l!==null&&l.delete(t),wm(e,r)}function cv(e,t){return Be(e,t)}var Tc=null,Mi=null,Ju=!1,Ac=!1,Qu=!1,Gr=0;function Rs(e){e!==Mi&&e.next===null&&(Mi===null?Tc=Mi=e:Mi=Mi.next=e),Ac=!0,Ju||(Ju=!0,uv())}function Dl(e,t){if(!Qu&&Ac){Qu=!0;do for(var r=!1,l=Tc;l!==null;){if(e!==0){var u=l.pendingLanes;if(u===0)var f=0;else{var y=l.suspendedLanes,C=l.pingedLanes;f=(1<<31-Rt(42|e)+1)-1,f&=u&~(y&~C),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(r=!0,km(l,f))}else f=We,f=gs(l,l===ft?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(f&3)===0||Kn(l,f)||(r=!0,km(l,f));l=l.next}while(r);Qu=!1}}function dv(){jm()}function jm(){Ac=Ju=!1;var e=0;Gr!==0&&wv()&&(e=Gr);for(var t=ve(),r=null,l=Tc;l!==null;){var u=l.next,f=Nm(l,t);f===0?(l.next=null,r===null?Tc=u:r.next=u,u===null&&(Mi=r)):(r=l,(e!==0||(f&3)!==0)&&(Ac=!0)),l=u}Ht!==0&&Ht!==5||Dl(e),Gr!==0&&(Gr=0)}function Nm(e,t){for(var r=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Rt(f),C=1<<y,H=u[y];H===-1?((C&r)===0||(C&l)!==0)&&(u[y]=Cd(C,t)):H<=t&&(e.expiredLanes|=C),f&=~C}if(t=ft,r=We,r=gs(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,r===0||e===t&&(lt===2||lt===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&Vt(l),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||Kn(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(l!==null&&Vt(l),Hs(r)){case 2:case 8:r=De;break;case 32:r=Ze;break;case 268435456:r=qt;break;default:r=Ze}return l=_m.bind(null,e),r=Be(r,l),e.callbackPriority=t,e.callbackNode=r,t}return l!==null&&l!==null&&Vt(l),e.callbackPriority=2,e.callbackNode=null,2}function _m(e,t){if(Ht!==0&&Ht!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Ec()&&e.callbackNode!==r)return null;var l=We;return l=gs(e,e===ft?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(am(e,l,t),Nm(e,ve()),e.callbackNode!=null&&e.callbackNode===r?_m.bind(null,e):null)}function km(e,t){if(Ec())return null;am(e,t,!0)}function uv(){Nv(function(){(nt&6)!==0?Be(de,dv):jm()})}function Zu(){if(Gr===0){var e=xi;e===0&&(e=hs,hs<<=1,(hs&261888)===0&&(hs=256)),Gr=e}return Gr}function Sm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ni(""+e)}function Cm(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function hv(e,t,r,l,u){if(t==="submit"&&r&&r.stateNode===u){var f=Sm((u[$t]||null).action),y=l.submitter;y&&(t=(t=y[$t]||null)?Sm(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var C=new ks("action","action",null,l,u);e.push({event:C,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Gr!==0){var H=y?Cm(u,y):new FormData(u);bu(r,{pending:!0,data:H,method:u.method,action:f},null,H)}}else typeof f=="function"&&(C.preventDefault(),H=y?Cm(u,y):new FormData(u),bu(r,{pending:!0,data:H,method:u.method,action:f},f,H))},currentTarget:u}]})}}for(var eh=0;eh<Dd.length;eh++){var th=Dd[eh],fv=th.toLowerCase(),gv=th[0].toUpperCase()+th.slice(1);ss(fv,"on"+gv)}ss(r0,"onAnimationEnd"),ss(a0,"onAnimationIteration"),ss(i0,"onAnimationStart"),ss("dblclick","onDoubleClick"),ss("focusin","onFocus"),ss("focusout","onBlur"),ss(Ab,"onTransitionRun"),ss(Rb,"onTransitionStart"),ss(Mb,"onTransitionCancel"),ss(l0,"onTransitionEnd"),ws("onMouseEnter",["mouseout","mouseover"]),ws("onMouseLeave",["mouseout","mouseover"]),ws("onPointerEnter",["pointerout","pointerover"]),ws("onPointerLeave",["pointerout","pointerover"]),vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vs("onBeforeInput",["compositionend","keypress","textInput","paste"]),vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ul));function Em(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var l=e[r],u=l.event;l=l.listeners;e:{var f=void 0;if(t)for(var y=l.length-1;0<=y;y--){var C=l[y],H=C.instance,ee=C.currentTarget;if(C=C.listener,H!==f&&u.isPropagationStopped())break e;f=C,u.currentTarget=ee;try{f(u)}catch(le){Fo(le)}u.currentTarget=null,f=H}else for(y=0;y<l.length;y++){if(C=l[y],H=C.instance,ee=C.currentTarget,C=C.listener,H!==f&&u.isPropagationStopped())break e;f=C,u.currentTarget=ee;try{f(u)}catch(le){Fo(le)}u.currentTarget=null,f=H}}}}function Fe(e,t){var r=t[Ja];r===void 0&&(r=t[Ja]=new Set);var l=e+"__bubble";r.has(l)||(Tm(t,e,2,!1),r.add(l))}function nh(e,t,r){var l=0;t&&(l|=4),Tm(r,e,l,t)}var Rc="_reactListening"+Math.random().toString(36).slice(2);function sh(e){if(!e[Rc]){e[Rc]=!0,Ki.forEach(function(r){r!=="selectionchange"&&(mv.has(r)||nh(r,!1,e),nh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rc]||(t[Rc]=!0,nh("selectionchange",!1,t))}}function Tm(e,t,r,l){switch(rp(t)){case 2:var u=Vv;break;case 8:u=$v;break;default:u=yh}r=u.bind(null,t,r,e),u=void 0,!ga||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(t,r,{capture:!0,passive:u}):e.addEventListener(t,r,!0):u!==void 0?e.addEventListener(t,r,{passive:u}):e.addEventListener(t,r,!1)}function rh(e,t,r,l,u){var f=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var y=l.tag;if(y===3||y===4){var C=l.stateNode.containerInfo;if(C===u)break;if(y===4)for(y=l.return;y!==null;){var H=y.tag;if((H===3||H===4)&&y.stateNode.containerInfo===u)return;y=y.return}for(;C!==null;){if(y=ys(C),y===null)return;if(H=y.tag,H===5||H===6||H===26||H===27){l=f=y;continue e}C=C.parentNode}}l=l.return}Nr(function(){var ee=f,le=In(r),he=[];e:{var ne=o0.get(e);if(ne!==void 0){var ae=ks,Ne=e;switch(e){case"keypress":if(pa(r)===0)break e;case"keydown":case"keyup":ae=Vo;break;case"focusin":Ne="focus",ae=ya;break;case"focusout":Ne="blur",ae=ya;break;case"beforeblur":case"afterblur":ae=ya;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=ol;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=Lo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=v;break;case r0:case a0:case i0:ae=Io;break;case l0:ae=J;break;case"scroll":case"scrollend":ae=ll;break;case"wheel":ae=be;break;case"copy":case"cut":case"paste":ae=Do;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=c;break;case"toggle":case"beforetoggle":ae=Et}var Le=(t&4)!==0,ut=!Le&&(e==="scroll"||e==="scrollend"),Y=Le?ne!==null?ne+"Capture":null:ne;Le=[];for(var $=ee,Z;$!==null;){var ce=$;if(Z=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||Z===null||Y===null||(ce=Zn($,Y),ce!=null&&Le.push(Bl($,ce,Z))),ut)break;$=$.return}0<Le.length&&(ne=new ae(ne,Ne,null,r,le),he.push({event:ne,listeners:Le}))}}if((t&7)===0){e:{if(ne=e==="mouseover"||e==="pointerover",ae=e==="mouseout"||e==="pointerout",ne&&r!==rl&&(Ne=r.relatedTarget||r.fromElement)&&(ys(Ne)||Ne[ps]))break e;if((ae||ne)&&(ne=le.window===le?le:(ne=le.ownerDocument)?ne.defaultView||ne.parentWindow:window,ae?(Ne=r.relatedTarget||r.toElement,ae=ee,Ne=Ne?ys(Ne):null,Ne!==null&&(ut=h(Ne),Le=Ne.tag,Ne!==ut||Le!==5&&Le!==27&&Le!==6)&&(Ne=null)):(ae=null,Ne=ee),ae!==Ne)){if(Le=ol,ce="onMouseLeave",Y="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(Le=c,ce="onPointerLeave",Y="onPointerEnter",$="pointer"),ut=ae==null?ne:vn(ae),Z=Ne==null?ne:vn(Ne),ne=new Le(ce,$+"leave",ae,r,le),ne.target=ut,ne.relatedTarget=Z,ce=null,ys(le)===ee&&(Le=new Le(Y,$+"enter",Ne,r,le),Le.target=Z,Le.relatedTarget=ut,ce=Le),ut=ce,ae&&Ne)t:{for(Le=pv,Y=ae,$=Ne,Z=0,ce=Y;ce;ce=Le(ce))Z++;ce=0;for(var Re=$;Re;Re=Le(Re))ce++;for(;0<Z-ce;)Y=Le(Y),Z--;for(;0<ce-Z;)$=Le($),ce--;for(;Z--;){if(Y===$||$!==null&&Y===$.alternate){Le=Y;break t}Y=Le(Y),$=Le($)}Le=null}else Le=null;ae!==null&&Am(he,ne,ae,Le,!1),Ne!==null&&ut!==null&&Am(he,ut,Ne,Le,!0)}}e:{if(ne=ee?vn(ee):window,ae=ne.nodeName&&ne.nodeName.toLowerCase(),ae==="select"||ae==="input"&&ne.type==="file")var et=qf;else if(Ff(ne))if(Yf)et=Cb;else{et=kb;var Se=_b}else ae=ne.nodeName,!ae||ae.toLowerCase()!=="input"||ne.type!=="checkbox"&&ne.type!=="radio"?ee&&ti(ee.elementType)&&(et=qf):et=Sb;if(et&&(et=et(e,ee))){Wf(he,et,r,le);break e}Se&&Se(e,ne,ee),e==="focusout"&&ee&&ne.type==="number"&&ee.memoizedProps.value!=null&&tl(ne,"number",ne.value)}switch(Se=ee?vn(ee):window,e){case"focusin":(Ff(Se)||Se.contentEditable==="true")&&(ci=Se,Ld=ee,fl=null);break;case"focusout":fl=Ld=ci=null;break;case"mousedown":Od=!0;break;case"contextmenu":case"mouseup":case"dragend":Od=!1,n0(he,r,le);break;case"selectionchange":if(Tb)break;case"keydown":case"keyup":n0(he,r,le)}var He;if(wt)e:{switch(e){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else oi?li(e,r)&&(qe="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(qe="onCompositionStart");qe&&(ts&&r.locale!=="ko"&&(oi||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&oi&&(He=il()):(_s=le,al="value"in _s?_s.value:_s.textContent,oi=!0)),Se=Mc(ee,qe),0<Se.length&&(qe=new Cs(qe,e,null,r,le),he.push({event:qe,listeners:Se}),He?qe.data=He:(He=$f(r),He!==null&&(qe.data=He)))),(He=$s?vb(e,r):wb(e,r))&&(qe=Mc(ee,"onBeforeInput"),0<qe.length&&(Se=new Cs("onBeforeInput","beforeinput",null,r,le),he.push({event:Se,listeners:qe}),Se.data=He)),hv(he,e,ee,r,le)}Em(he,t)})}function Bl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Mc(e,t){for(var r=t+"Capture",l=[];e!==null;){var u=e,f=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||f===null||(u=Zn(e,r),u!=null&&l.unshift(Bl(e,u,f)),u=Zn(e,t),u!=null&&l.push(Bl(e,u,f))),e.tag===3)return l;e=e.return}return[]}function pv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Am(e,t,r,l,u){for(var f=t._reactName,y=[];r!==null&&r!==l;){var C=r,H=C.alternate,ee=C.stateNode;if(C=C.tag,H!==null&&H===l)break;C!==5&&C!==26&&C!==27||ee===null||(H=ee,u?(ee=Zn(r,f),ee!=null&&y.unshift(Bl(r,ee,H))):u||(ee=Zn(r,f),ee!=null&&y.push(Bl(r,ee,H)))),r=r.return}y.length!==0&&e.push({event:t,listeners:y})}var xv=/\r\n?/g,yv=/\u0000|\uFFFD/g;function Rm(e){return(typeof e=="string"?e:""+e).replace(xv,`
`).replace(yv,"")}function Mm(e,t){return t=Rm(t),Rm(e)===t}function dt(e,t,r,l,u,f){switch(r){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||hn(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&hn(e,""+l);break;case"className":wn(e,"class",l);break;case"tabIndex":wn(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":wn(e,r,l);break;case"style":sl(e,l,f);break;case"data":if(t!=="object"){wn(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(r);break}l=ni(""+l),e.setAttribute(r,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(r==="formAction"?(t!=="input"&&dt(e,t,"name",u.name,u,null),dt(e,t,"formEncType",u.formEncType,u,null),dt(e,t,"formMethod",u.formMethod,u,null),dt(e,t,"formTarget",u.formTarget,u,null)):(dt(e,t,"encType",u.encType,u,null),dt(e,t,"method",u.method,u,null),dt(e,t,"target",u.target,u,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(r);break}l=ni(""+l),e.setAttribute(r,l);break;case"onClick":l!=null&&(e.onclick=Qn);break;case"onScroll":l!=null&&Fe("scroll",e);break;case"onScrollEnd":l!=null&&Fe("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(r=l.__html,r!=null){if(u.children!=null)throw Error(o(60));e.innerHTML=r}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}r=ni(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(r,""+l):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":l===!0?e.setAttribute(r,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(r,l):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(r,l):e.removeAttribute(r);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(r):e.setAttribute(r,l);break;case"popover":Fe("beforetoggle",e),Fe("toggle",e),Za(e,"popover",l);break;case"xlinkActuate":It(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":It(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":It(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":It(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":It(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":It(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":It(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":It(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":It(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Za(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=Mo.get(r)||r,Za(e,r,l))}}function ah(e,t,r,l,u,f){switch(r){case"style":sl(e,l,f);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(r=l.__html,r!=null){if(u.children!=null)throw Error(o(60));e.innerHTML=r}}break;case"children":typeof l=="string"?hn(e,l):(typeof l=="number"||typeof l=="bigint")&&hn(e,""+l);break;case"onScroll":l!=null&&Fe("scroll",e);break;case"onScrollEnd":l!=null&&Fe("scrollend",e);break;case"onClick":l!=null&&(e.onclick=Qn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xi.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(u=r.endsWith("Capture"),t=r.slice(2,u?r.length-7:void 0),f=e[$t]||null,f=f!=null?f[r]:null,typeof f=="function"&&e.removeEventListener(t,f,u),typeof l=="function")){typeof f!="function"&&f!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,l,u);break e}r in e?e[r]=l:l===!0?e.setAttribute(r,""):Za(e,r,l)}}}function Zt(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",e),Fe("load",e);var l=!1,u=!1,f;for(f in r)if(r.hasOwnProperty(f)){var y=r[f];if(y!=null)switch(f){case"src":l=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:dt(e,t,f,y,r,null)}}u&&dt(e,t,"srcSet",r.srcSet,r,null),l&&dt(e,t,"src",r.src,r,null);return;case"input":Fe("invalid",e);var C=f=y=u=null,H=null,ee=null;for(l in r)if(r.hasOwnProperty(l)){var le=r[l];if(le!=null)switch(l){case"name":u=le;break;case"type":y=le;break;case"checked":H=le;break;case"defaultChecked":ee=le;break;case"value":f=le;break;case"defaultValue":C=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(o(137,t));break;default:dt(e,t,l,le,r,null)}}To(e,f,C,H,ee,y,u,!1);return;case"select":Fe("invalid",e),l=y=f=null;for(u in r)if(r.hasOwnProperty(u)&&(C=r[u],C!=null))switch(u){case"value":f=C;break;case"defaultValue":y=C;break;case"multiple":l=C;default:dt(e,t,u,C,r,null)}t=f,r=y,e.multiple=!!l,t!=null?br(e,!!l,t,!1):r!=null&&br(e,!!l,r,!0);return;case"textarea":Fe("invalid",e),f=u=l=null;for(y in r)if(r.hasOwnProperty(y)&&(C=r[y],C!=null))switch(y){case"value":l=C;break;case"defaultValue":u=C;break;case"children":f=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(o(91));break;default:dt(e,t,y,C,r,null)}vr(e,l,u,f);return;case"option":for(H in r)r.hasOwnProperty(H)&&(l=r[H],l!=null)&&(H==="selected"?e.selected=l&&typeof l!="function"&&typeof l!="symbol":dt(e,t,H,l,r,null));return;case"dialog":Fe("beforetoggle",e),Fe("toggle",e),Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":Fe("load",e);break;case"video":case"audio":for(l=0;l<Ul.length;l++)Fe(Ul[l],e);break;case"image":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"embed":case"source":case"link":Fe("error",e),Fe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ee in r)if(r.hasOwnProperty(ee)&&(l=r[ee],l!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:dt(e,t,ee,l,r,null)}return;default:if(ti(t)){for(le in r)r.hasOwnProperty(le)&&(l=r[le],l!==void 0&&ah(e,t,le,l,r,void 0));return}}for(C in r)r.hasOwnProperty(C)&&(l=r[C],l!=null&&dt(e,t,C,l,r,null))}function bv(e,t,r,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,f=null,y=null,C=null,H=null,ee=null,le=null;for(ae in r){var he=r[ae];if(r.hasOwnProperty(ae)&&he!=null)switch(ae){case"checked":break;case"value":break;case"defaultValue":H=he;default:l.hasOwnProperty(ae)||dt(e,t,ae,null,l,he)}}for(var ne in l){var ae=l[ne];if(he=r[ne],l.hasOwnProperty(ne)&&(ae!=null||he!=null))switch(ne){case"type":f=ae;break;case"name":u=ae;break;case"checked":ee=ae;break;case"defaultChecked":le=ae;break;case"value":y=ae;break;case"defaultValue":C=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(o(137,t));break;default:ae!==he&&dt(e,t,ne,ae,l,he)}}ei(e,y,C,H,ee,le,f,u);return;case"select":ae=y=C=ne=null;for(f in r)if(H=r[f],r.hasOwnProperty(f)&&H!=null)switch(f){case"value":break;case"multiple":ae=H;default:l.hasOwnProperty(f)||dt(e,t,f,null,l,H)}for(u in l)if(f=l[u],H=r[u],l.hasOwnProperty(u)&&(f!=null||H!=null))switch(u){case"value":ne=f;break;case"defaultValue":C=f;break;case"multiple":y=f;default:f!==H&&dt(e,t,u,f,l,H)}t=C,r=y,l=ae,ne!=null?br(e,!!r,ne,!1):!!l!=!!r&&(t!=null?br(e,!!r,t,!0):br(e,!!r,r?[]:"",!1));return;case"textarea":ae=ne=null;for(C in r)if(u=r[C],r.hasOwnProperty(C)&&u!=null&&!l.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:dt(e,t,C,null,l,u)}for(y in l)if(u=l[y],f=r[y],l.hasOwnProperty(y)&&(u!=null||f!=null))switch(y){case"value":ne=u;break;case"defaultValue":ae=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(o(91));break;default:u!==f&&dt(e,t,y,u,l,f)}Ao(e,ne,ae);return;case"option":for(var Ne in r)ne=r[Ne],r.hasOwnProperty(Ne)&&ne!=null&&!l.hasOwnProperty(Ne)&&(Ne==="selected"?e.selected=!1:dt(e,t,Ne,null,l,ne));for(H in l)ne=l[H],ae=r[H],l.hasOwnProperty(H)&&ne!==ae&&(ne!=null||ae!=null)&&(H==="selected"?e.selected=ne&&typeof ne!="function"&&typeof ne!="symbol":dt(e,t,H,ne,l,ae));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in r)ne=r[Le],r.hasOwnProperty(Le)&&ne!=null&&!l.hasOwnProperty(Le)&&dt(e,t,Le,null,l,ne);for(ee in l)if(ne=l[ee],ae=r[ee],l.hasOwnProperty(ee)&&ne!==ae&&(ne!=null||ae!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(o(137,t));break;default:dt(e,t,ee,ne,l,ae)}return;default:if(ti(t)){for(var ut in r)ne=r[ut],r.hasOwnProperty(ut)&&ne!==void 0&&!l.hasOwnProperty(ut)&&ah(e,t,ut,void 0,l,ne);for(le in l)ne=l[le],ae=r[le],!l.hasOwnProperty(le)||ne===ae||ne===void 0&&ae===void 0||ah(e,t,le,ne,l,ae);return}}for(var Y in r)ne=r[Y],r.hasOwnProperty(Y)&&ne!=null&&!l.hasOwnProperty(Y)&&dt(e,t,Y,null,l,ne);for(he in l)ne=l[he],ae=r[he],!l.hasOwnProperty(he)||ne===ae||ne==null&&ae==null||dt(e,t,he,ne,l,ae)}function Lm(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vv(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),l=0;l<r.length;l++){var u=r[l],f=u.transferSize,y=u.initiatorType,C=u.duration;if(f&&C&&Lm(y)){for(y=0,C=u.responseEnd,l+=1;l<r.length;l++){var H=r[l],ee=H.startTime;if(ee>C)break;var le=H.transferSize,he=H.initiatorType;le&&Lm(he)&&(H=H.responseEnd,y+=le*(H<C?1:(C-ee)/(H-ee)))}if(--l,t+=8*(f+y)/(u.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var ih=null,lh=null;function Lc(e){return e.nodeType===9?e:e.ownerDocument}function Om(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Im(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function oh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ch=null;function wv(){var e=window.event;return e&&e.type==="popstate"?e===ch?!1:(ch=e,!0):(ch=null,!1)}var Dm=typeof setTimeout=="function"?setTimeout:void 0,jv=typeof clearTimeout=="function"?clearTimeout:void 0,Um=typeof Promise=="function"?Promise:void 0,Nv=typeof queueMicrotask=="function"?queueMicrotask:typeof Um<"u"?function(e){return Um.resolve(null).then(e).catch(_v)}:Dm;function _v(e){setTimeout(function(){throw e})}function Vr(e){return e==="head"}function Bm(e,t){var r=t,l=0;do{var u=r.nextSibling;if(e.removeChild(r),u&&u.nodeType===8)if(r=u.data,r==="/$"||r==="/&"){if(l===0){e.removeChild(u),Di(t);return}l--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")l++;else if(r==="html")zl(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,zl(r);for(var f=r.firstChild;f;){var y=f.nextSibling,C=f.nodeName;f[xs]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&f.rel.toLowerCase()==="stylesheet"||r.removeChild(f),f=y}}else r==="body"&&zl(e.ownerDocument.body);r=u}while(r);Di(t)}function zm(e,t){var r=e;e=0;do{var l=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),l&&l.nodeType===8)if(r=l.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=l}while(r)}function dh(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":dh(r),Qa(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function kv(e,t,r,l){for(;e.nodeType===1;){var u=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[xs])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==u.rel||e.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||e.getAttribute("title")!==(u.title==null?null:u.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(u.src==null?null:u.src)||e.getAttribute("type")!==(u.type==null?null:u.type)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=u.name==null?null:""+u.name;if(u.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=Vn(e.nextSibling),e===null)break}return null}function Sv(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Vn(e.nextSibling),e===null))return null;return e}function Pm(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Vn(e.nextSibling),e===null))return null;return e}function uh(e){return e.data==="$?"||e.data==="$~"}function hh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Cv(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var l=function(){t(),r.removeEventListener("DOMContentLoaded",l)};r.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function Vn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var fh=null;function Hm(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return Vn(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function Gm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function Vm(e,t,r){switch(t=Lc(r),e){case"html":if(e=t.documentElement,!e)throw Error(o(452));return e;case"head":if(e=t.head,!e)throw Error(o(453));return e;case"body":if(e=t.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function zl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qa(e)}var $n=new Map,$m=new Set;function Oc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ar=ie.d;ie.d={f:Ev,r:Tv,D:Av,C:Rv,L:Mv,m:Lv,X:Iv,S:Ov,M:Dv};function Ev(){var e=ar.f(),t=kc();return e||t}function Tv(e){var t=On(e);t!==null&&t.tag===5&&t.type==="form"?lg(t):ar.r(e)}var Li=typeof document>"u"?null:document;function Fm(e,t,r){var l=Li;if(l&&typeof t=="string"&&t){var u=un(t);u='link[rel="'+e+'"][href="'+u+'"]',typeof r=="string"&&(u+='[crossorigin="'+r+'"]'),$m.has(u)||($m.add(u),e={rel:e,crossOrigin:r,href:t},l.querySelector(u)===null&&(t=l.createElement("link"),Zt(t,"link",e),Ot(t),l.head.appendChild(t)))}}function Av(e){ar.D(e),Fm("dns-prefetch",e,null)}function Rv(e,t){ar.C(e,t),Fm("preconnect",e,t)}function Mv(e,t,r){ar.L(e,t,r);var l=Li;if(l&&e&&t){var u='link[rel="preload"][as="'+un(t)+'"]';t==="image"&&r&&r.imageSrcSet?(u+='[imagesrcset="'+un(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(u+='[imagesizes="'+un(r.imageSizes)+'"]')):u+='[href="'+un(e)+'"]';var f=u;switch(t){case"style":f=Oi(e);break;case"script":f=Ii(e)}$n.has(f)||(e=j({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),$n.set(f,e),l.querySelector(u)!==null||t==="style"&&l.querySelector(Pl(f))||t==="script"&&l.querySelector(Hl(f))||(t=l.createElement("link"),Zt(t,"link",e),Ot(t),l.head.appendChild(t)))}}function Lv(e,t){ar.m(e,t);var r=Li;if(r&&e){var l=t&&typeof t.as=="string"?t.as:"script",u='link[rel="modulepreload"][as="'+un(l)+'"][href="'+un(e)+'"]',f=u;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Ii(e)}if(!$n.has(f)&&(e=j({rel:"modulepreload",href:e},t),$n.set(f,e),r.querySelector(u)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Hl(f)))return}l=r.createElement("link"),Zt(l,"link",e),Ot(l),r.head.appendChild(l)}}}function Ov(e,t,r){ar.S(e,t,r);var l=Li;if(l&&e){var u=bs(l).hoistableStyles,f=Oi(e);t=t||"default";var y=u.get(f);if(!y){var C={loading:0,preload:null};if(y=l.querySelector(Pl(f)))C.loading=5;else{e=j({rel:"stylesheet",href:e,"data-precedence":t},r),(r=$n.get(f))&&gh(e,r);var H=y=l.createElement("link");Ot(H),Zt(H,"link",e),H._p=new Promise(function(ee,le){H.onload=ee,H.onerror=le}),H.addEventListener("load",function(){C.loading|=1}),H.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Ic(y,t,l)}y={type:"stylesheet",instance:y,count:1,state:C},u.set(f,y)}}}function Iv(e,t){ar.X(e,t);var r=Li;if(r&&e){var l=bs(r).hoistableScripts,u=Ii(e),f=l.get(u);f||(f=r.querySelector(Hl(u)),f||(e=j({src:e,async:!0},t),(t=$n.get(u))&&mh(e,t),f=r.createElement("script"),Ot(f),Zt(f,"link",e),r.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(u,f))}}function Dv(e,t){ar.M(e,t);var r=Li;if(r&&e){var l=bs(r).hoistableScripts,u=Ii(e),f=l.get(u);f||(f=r.querySelector(Hl(u)),f||(e=j({src:e,async:!0,type:"module"},t),(t=$n.get(u))&&mh(e,t),f=r.createElement("script"),Ot(f),Zt(f,"link",e),r.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(u,f))}}function Wm(e,t,r,l){var u=(u=xe.current)?Oc(u):null;if(!u)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=Oi(r.href),r=bs(u).hoistableStyles,l=r.get(t),l||(l={type:"style",instance:null,count:0,state:null},r.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Oi(r.href);var f=bs(u).hoistableStyles,y=f.get(e);if(y||(u=u.ownerDocument||u,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=u.querySelector(Pl(e)))&&!f._p&&(y.instance=f,y.state.loading=5),$n.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},$n.set(e,r),f||Uv(u,e,r,y.state))),t&&l===null)throw Error(o(528,""));return y}if(t&&l!==null)throw Error(o(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ii(r),r=bs(u).hoistableScripts,l=r.get(t),l||(l={type:"script",instance:null,count:0,state:null},r.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Oi(e){return'href="'+un(e)+'"'}function Pl(e){return'link[rel="stylesheet"]['+e+"]"}function qm(e){return j({},e,{"data-precedence":e.precedence,precedence:null})}function Uv(e,t,r,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),Zt(t,"link",r),Ot(t),e.head.appendChild(t))}function Ii(e){return'[src="'+un(e)+'"]'}function Hl(e){return"script[async]"+e}function Ym(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+un(r.href)+'"]');if(l)return t.instance=l,Ot(l),l;var u=j({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),Ot(l),Zt(l,"style",u),Ic(l,r.precedence,e),t.instance=l;case"stylesheet":u=Oi(r.href);var f=e.querySelector(Pl(u));if(f)return t.state.loading|=4,t.instance=f,Ot(f),f;l=qm(r),(u=$n.get(u))&&gh(l,u),f=(e.ownerDocument||e).createElement("link"),Ot(f);var y=f;return y._p=new Promise(function(C,H){y.onload=C,y.onerror=H}),Zt(f,"link",l),t.state.loading|=4,Ic(f,r.precedence,e),t.instance=f;case"script":return f=Ii(r.src),(u=e.querySelector(Hl(f)))?(t.instance=u,Ot(u),u):(l=r,(u=$n.get(f))&&(l=j({},r),mh(l,u)),e=e.ownerDocument||e,u=e.createElement("script"),Ot(u),Zt(u,"link",l),e.head.appendChild(u),t.instance=u);case"void":return null;default:throw Error(o(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,Ic(l,r.precedence,e));return t.instance}function Ic(e,t,r){for(var l=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=l.length?l[l.length-1]:null,f=u,y=0;y<l.length;y++){var C=l[y];if(C.dataset.precedence===t)f=C;else if(f!==u)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function gh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function mh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Dc=null;function Km(e,t,r){if(Dc===null){var l=new Map,u=Dc=new Map;u.set(r,l)}else u=Dc,l=u.get(r),l||(l=new Map,u.set(r,l));if(l.has(e))return l;for(l.set(e,null),r=r.getElementsByTagName(e),u=0;u<r.length;u++){var f=r[u];if(!(f[xs]||f[Lt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var C=l.get(y);C?C.push(f):l.set(y,[f])}}return l}function Xm(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function Bv(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Jm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function zv(e,t,r,l){if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var u=Oi(l.href),f=t.querySelector(Pl(u));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Uc.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=f,Ot(f);return}f=t.ownerDocument||t,l=qm(l),(u=$n.get(u))&&gh(l,u),f=f.createElement("link"),Ot(f);var y=f;y._p=new Promise(function(C,H){y.onload=C,y.onerror=H}),Zt(f,"link",l),r.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Uc.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var ph=0;function Pv(e,t){return e.stylesheets&&e.count===0&&zc(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var l=setTimeout(function(){if(e.stylesheets&&zc(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&ph===0&&(ph=62500*vv());var u=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&zc(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>ph?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(u)}}:null}function Uc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)zc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Bc=null;function zc(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Bc=new Map,t.forEach(Hv,e),Bc=null,Uc.call(e))}function Hv(e,t){if(!(t.state.loading&4)){var r=Bc.get(e);if(r)var l=r.get(null);else{r=new Map,Bc.set(e,r);for(var u=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<u.length;f++){var y=u[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(r.set(y.dataset.precedence,y),l=y)}l&&r.set(null,l)}u=t.instance,y=u.getAttribute("data-precedence"),f=r.get(y)||l,f===l&&r.set(null,u),r.set(y,u),this.count++,l=Uc.bind(this),u.addEventListener("load",l),u.addEventListener("error",l),f?f.parentNode.insertBefore(u,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(u,e.firstChild)),t.state.loading|=4}}var Gl={$$typeof:G,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function Gv(e,t,r,l,u,f,y,C,H){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ms(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ms(0),this.hiddenUpdates=ms(null),this.identifierPrefix=l,this.onUncaughtError=u,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Qm(e,t,r,l,u,f,y,C,H,ee,le,he){return e=new Gv(e,t,r,y,H,ee,le,he,C),t=1,f===!0&&(t|=24),f=Nn(3,null,null,t),e.current=f,f.stateNode=e,t=Kd(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:l,isDehydrated:r,cache:t},Zd(f),e}function Zm(e){return e?(e=hi,e):hi}function ep(e,t,r,l,u,f){u=Zm(u),l.context===null?l.context=u:l.pendingContext=u,l=Mr(t),l.payload={element:r},f=f===void 0?null:f,f!==null&&(l.callback=f),r=Lr(e,l,t),r!==null&&(xn(r,e,t),vl(r,e,t))}function tp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xh(e,t){tp(e,t),(e=e.alternate)&&tp(e,t)}function np(e){if(e.tag===13||e.tag===31){var t=ja(e,67108864);t!==null&&xn(t,e,67108864),xh(e,67108864)}}function sp(e){if(e.tag===13||e.tag===31){var t=En();t=da(t);var r=ja(e,t);r!==null&&xn(r,e,t),xh(e,t)}}var Pc=!0;function Vv(e,t,r,l){var u=V.T;V.T=null;var f=ie.p;try{ie.p=2,yh(e,t,r,l)}finally{ie.p=f,V.T=u}}function $v(e,t,r,l){var u=V.T;V.T=null;var f=ie.p;try{ie.p=8,yh(e,t,r,l)}finally{ie.p=f,V.T=u}}function yh(e,t,r,l){if(Pc){var u=bh(l);if(u===null)rh(e,t,l,Hc,r),ap(e,l);else if(Wv(u,e,t,r,l))l.stopPropagation();else if(ap(e,l),t&4&&-1<Fv.indexOf(e)){for(;u!==null;){var f=On(u);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=fs(f.pendingLanes);if(y!==0){var C=f;for(C.pendingLanes|=2,C.entangledLanes|=2;y;){var H=1<<31-Rt(y);C.entanglements[1]|=H,y&=~H}Rs(f),(nt&6)===0&&(Nc=ve()+500,Dl(0))}}break;case 31:case 13:C=ja(f,2),C!==null&&xn(C,f,2),kc(),xh(f,2)}if(f=bh(l),f===null&&rh(e,t,l,Hc,r),f===u)break;u=f}u!==null&&l.stopPropagation()}else rh(e,t,l,null,r)}}function bh(e){return e=In(e),vh(e)}var Hc=null;function vh(e){if(Hc=null,e=ys(e),e!==null){var t=h(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=g(t),e!==null)return e;e=null}else if(r===31){if(e=p(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Hc=e,null}function rp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Me()){case de:return 2;case De:return 8;case Ze:case Mn:return 32;case qt:return 268435456;default:return 32}default:return 32}}var wh=!1,$r=null,Fr=null,Wr=null,Vl=new Map,$l=new Map,qr=[],Fv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ap(e,t){switch(e){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":Wr=null;break;case"pointerover":case"pointerout":Vl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$l.delete(t.pointerId)}}function Fl(e,t,r,l,u,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:r,eventSystemFlags:l,nativeEvent:f,targetContainers:[u]},t!==null&&(t=On(t),t!==null&&np(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function Wv(e,t,r,l,u){switch(t){case"focusin":return $r=Fl($r,e,t,r,l,u),!0;case"dragenter":return Fr=Fl(Fr,e,t,r,l,u),!0;case"mouseover":return Wr=Fl(Wr,e,t,r,l,u),!0;case"pointerover":var f=u.pointerId;return Vl.set(f,Fl(Vl.get(f)||null,e,t,r,l,u)),!0;case"gotpointercapture":return f=u.pointerId,$l.set(f,Fl($l.get(f)||null,e,t,r,l,u)),!0}return!1}function ip(e){var t=ys(e.target);if(t!==null){var r=h(t);if(r!==null){if(t=r.tag,t===13){if(t=g(r),t!==null){e.blockedOn=t,Xn(e.priority,function(){sp(r)});return}}else if(t===31){if(t=p(r),t!==null){e.blockedOn=t,Xn(e.priority,function(){sp(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Gc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=bh(e.nativeEvent);if(r===null){r=e.nativeEvent;var l=new r.constructor(r.type,r);rl=l,r.target.dispatchEvent(l),rl=null}else return t=On(r),t!==null&&np(t),e.blockedOn=r,!1;t.shift()}return!0}function lp(e,t,r){Gc(e)&&r.delete(t)}function qv(){wh=!1,$r!==null&&Gc($r)&&($r=null),Fr!==null&&Gc(Fr)&&(Fr=null),Wr!==null&&Gc(Wr)&&(Wr=null),Vl.forEach(lp),$l.forEach(lp)}function Vc(e,t){e.blockedOn===t&&(e.blockedOn=null,wh||(wh=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,qv)))}var $c=null;function op(e){$c!==e&&($c=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){$c===e&&($c=null);for(var t=0;t<e.length;t+=3){var r=e[t],l=e[t+1],u=e[t+2];if(typeof l!="function"){if(vh(l||r)===null)continue;break}var f=On(r);f!==null&&(e.splice(t,3),t-=3,bu(f,{pending:!0,data:u,method:r.method,action:l},l,u))}}))}function Di(e){function t(H){return Vc(H,e)}$r!==null&&Vc($r,e),Fr!==null&&Vc(Fr,e),Wr!==null&&Vc(Wr,e),Vl.forEach(t),$l.forEach(t);for(var r=0;r<qr.length;r++){var l=qr[r];l.blockedOn===e&&(l.blockedOn=null)}for(;0<qr.length&&(r=qr[0],r.blockedOn===null);)ip(r),r.blockedOn===null&&qr.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(l=0;l<r.length;l+=3){var u=r[l],f=r[l+1],y=u[$t]||null;if(typeof f=="function")y||op(r);else if(y){var C=null;if(f&&f.hasAttribute("formAction")){if(u=f,y=f[$t]||null)C=y.formAction;else if(vh(u)!==null)continue}else C=y.action;typeof C=="function"?r[l+1]=C:(r.splice(l,3),l-=3),op(r)}}}function cp(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return u=y})},focusReset:"manual",scroll:"manual"})}function t(){u!==null&&(u(),u=null),l||setTimeout(r,20)}function r(){if(!l&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,u=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),u!==null&&(u(),u=null)}}}function jh(e){this._internalRoot=e}Fc.prototype.render=jh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(o(409));var r=t.current,l=En();ep(r,l,e,t,null,null)},Fc.prototype.unmount=jh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ep(e.current,2,null,e,null,null),kc(),t[ps]=null}};function Fc(e){this._internalRoot=e}Fc.prototype.unstable_scheduleHydration=function(e){if(e){var t=ko();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qr.length&&t!==0&&t<qr[r].priority;r++);qr.splice(r,0,e),r===0&&ip(e)}};var dp=n.version;if(dp!=="19.2.3")throw Error(o(527,dp,"19.2.3"));ie.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=b(t),e=e!==null?N(e):null,e=e===null?null:e.stateNode,e};var Yv={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{Ct=Wc.inject(Yv),Yt=Wc}catch{}}return ql.createRoot=function(e,t){if(!d(e))throw Error(o(299));var r=!1,l="",u=xg,f=yg,y=bg;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(u=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=Qm(e,1,!1,null,null,r,l,null,u,f,y,cp),e[ps]=t.current,sh(e),new jh(t)},ql.hydrateRoot=function(e,t,r){if(!d(e))throw Error(o(299));var l=!1,u="",f=xg,y=yg,C=bg,H=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(C=r.onRecoverableError),r.formState!==void 0&&(H=r.formState)),t=Qm(e,1,!0,t,r??null,l,u,H,f,y,C,cp),t.context=Zm(null),r=t.current,l=En(),l=da(l),u=Mr(l),u.callback=null,Lr(r,u,l),r=l,t.current.lanes=r,ca(t,r),Rs(t),e[ps]=t.current,sh(e),new Fc(t)},ql.version="19.2.3",ql}var vp;function s2(){if(vp)return kh.exports;vp=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),kh.exports=n2(),kh.exports}var r2=s2();const a2=af(r2);var wp="popstate";function i2(a={}){function n(o,d){let{pathname:h,search:g,hash:p}=o.location;return Fh("",{pathname:h,search:g,hash:p},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function i(o,d){return typeof d=="string"?d:ao(d)}return o2(n,i,null,a)}function bt(a,n){if(a===!1||a===null||typeof a>"u")throw new Error(n)}function ds(a,n){if(!a){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function l2(){return Math.random().toString(36).substring(2,10)}function jp(a,n){return{usr:a.state,key:a.key,idx:n}}function Fh(a,n,i=null,o){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof n=="string"?$i(n):n,state:i,key:n&&n.key||o||l2()}}function ao({pathname:a="/",search:n="",hash:i=""}){return n&&n!=="?"&&(a+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(a+=i.charAt(0)==="#"?i:"#"+i),a}function $i(a){let n={};if(a){let i=a.indexOf("#");i>=0&&(n.hash=a.substring(i),a=a.substring(0,i));let o=a.indexOf("?");o>=0&&(n.search=a.substring(o),a=a.substring(0,o)),a&&(n.pathname=a)}return n}function o2(a,n,i,o={}){let{window:d=document.defaultView,v5Compat:h=!1}=o,g=d.history,p="POP",x=null,b=N();b==null&&(b=0,g.replaceState({...g.state,idx:b},""));function N(){return(g.state||{idx:null}).idx}function j(){p="POP";let U=N(),P=U==null?null:U-b;b=U,x&&x({action:p,location:T.location,delta:P})}function _(U,P){p="PUSH";let z=Fh(T.location,U,P);b=N()+1;let G=jp(z,b),X=T.createHref(z);try{g.pushState(G,"",X)}catch(se){if(se instanceof DOMException&&se.name==="DataCloneError")throw se;d.location.assign(X)}h&&x&&x({action:p,location:T.location,delta:1})}function I(U,P){p="REPLACE";let z=Fh(T.location,U,P);b=N();let G=jp(z,b),X=T.createHref(z);g.replaceState(G,"",X),h&&x&&x({action:p,location:T.location,delta:0})}function L(U){return c2(U)}let T={get action(){return p},get location(){return a(d,g)},listen(U){if(x)throw new Error("A history only accepts one active listener");return d.addEventListener(wp,j),x=U,()=>{d.removeEventListener(wp,j),x=null}},createHref(U){return n(d,U)},createURL:L,encodeLocation(U){let P=L(U);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:_,replace:I,go(U){return g.go(U)}};return T}function c2(a,n=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),bt(i,"No window.location.(origin|href) available to create URL");let o=typeof a=="string"?a:ao(a);return o=o.replace(/ $/,"%20"),!n&&o.startsWith("//")&&(o=i+o),new URL(o,i)}function Cx(a,n,i="/"){return d2(a,n,i,!1)}function d2(a,n,i,o){let d=typeof n=="string"?$i(n):n,h=gr(d.pathname||"/",i);if(h==null)return null;let g=Ex(a);u2(g);let p=null;for(let x=0;p==null&&x<g.length;++x){let b=j2(h);p=v2(g[x],b,o)}return p}function Ex(a,n=[],i=[],o="",d=!1){let h=(g,p,x=d,b)=>{let N={relativePath:b===void 0?g.path||"":b,caseSensitive:g.caseSensitive===!0,childrenIndex:p,route:g};if(N.relativePath.startsWith("/")){if(!N.relativePath.startsWith(o)&&x)return;bt(N.relativePath.startsWith(o),`Absolute route path "${N.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),N.relativePath=N.relativePath.slice(o.length)}let j=hr([o,N.relativePath]),_=i.concat(N);g.children&&g.children.length>0&&(bt(g.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),Ex(g.children,n,_,j,x)),!(g.path==null&&!g.index)&&n.push({path:j,score:y2(j,g.index),routesMeta:_})};return a.forEach((g,p)=>{if(g.path===""||!g.path?.includes("?"))h(g,p);else for(let x of Tx(g.path))h(g,p,!0,x)}),n}function Tx(a){let n=a.split("/");if(n.length===0)return[];let[i,...o]=n,d=i.endsWith("?"),h=i.replace(/\?$/,"");if(o.length===0)return d?[h,""]:[h];let g=Tx(o.join("/")),p=[];return p.push(...g.map(x=>x===""?h:[h,x].join("/"))),d&&p.push(...g),p.map(x=>a.startsWith("/")&&x===""?"/":x)}function u2(a){a.sort((n,i)=>n.score!==i.score?i.score-n.score:b2(n.routesMeta.map(o=>o.childrenIndex),i.routesMeta.map(o=>o.childrenIndex)))}var h2=/^:[\w-]+$/,f2=3,g2=2,m2=1,p2=10,x2=-2,Np=a=>a==="*";function y2(a,n){let i=a.split("/"),o=i.length;return i.some(Np)&&(o+=x2),n&&(o+=g2),i.filter(d=>!Np(d)).reduce((d,h)=>d+(h2.test(h)?f2:h===""?m2:p2),o)}function b2(a,n){return a.length===n.length&&a.slice(0,-1).every((o,d)=>o===n[d])?a[a.length-1]-n[n.length-1]:0}function v2(a,n,i=!1){let{routesMeta:o}=a,d={},h="/",g=[];for(let p=0;p<o.length;++p){let x=o[p],b=p===o.length-1,N=h==="/"?n:n.slice(h.length)||"/",j=dd({path:x.relativePath,caseSensitive:x.caseSensitive,end:b},N),_=x.route;if(!j&&b&&i&&!o[o.length-1].route.index&&(j=dd({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},N)),!j)return null;Object.assign(d,j.params),g.push({params:d,pathname:hr([h,j.pathname]),pathnameBase:S2(hr([h,j.pathnameBase])),route:_}),j.pathnameBase!=="/"&&(h=hr([h,j.pathnameBase]))}return g}function dd(a,n){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[i,o]=w2(a.path,a.caseSensitive,a.end),d=n.match(i);if(!d)return null;let h=d[0],g=h.replace(/(.)\/+$/,"$1"),p=d.slice(1);return{params:o.reduce((b,{paramName:N,isOptional:j},_)=>{if(N==="*"){let L=p[_]||"";g=h.slice(0,h.length-L.length).replace(/(.)\/+$/,"$1")}const I=p[_];return j&&!I?b[N]=void 0:b[N]=(I||"").replace(/%2F/g,"/"),b},{}),pathname:h,pathnameBase:g,pattern:a}}function w2(a,n=!1,i=!0){ds(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let o=[],d="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(g,p,x)=>(o.push({paramName:p,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(o.push({paramName:"*"}),d+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?d+="\\/*$":a!==""&&a!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,n?void 0:"i"),o]}function j2(a){try{return a.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return ds(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),a}}function gr(a,n){if(n==="/")return a;if(!a.toLowerCase().startsWith(n.toLowerCase()))return null;let i=n.endsWith("/")?n.length-1:n.length,o=a.charAt(i);return o&&o!=="/"?null:a.slice(i)||"/"}var Ax=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,N2=a=>Ax.test(a);function _2(a,n="/"){let{pathname:i,search:o="",hash:d=""}=typeof a=="string"?$i(a):a,h;if(i)if(N2(i))h=i;else{if(i.includes("//")){let g=i;i=i.replace(/\/\/+/g,"/"),ds(!1,`Pathnames cannot have embedded double slashes - normalizing ${g} -> ${i}`)}i.startsWith("/")?h=_p(i.substring(1),"/"):h=_p(i,n)}else h=n;return{pathname:h,search:C2(o),hash:E2(d)}}function _p(a,n){let i=n.replace(/\/+$/,"").split("/");return a.split("/").forEach(d=>{d===".."?i.length>1&&i.pop():d!=="."&&i.push(d)}),i.length>1?i.join("/"):"/"}function Th(a,n,i,o){return`Cannot include a '${a}' character in a manually specified \`to.${n}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function k2(a){return a.filter((n,i)=>i===0||n.route.path&&n.route.path.length>0)}function Rx(a){let n=k2(a);return n.map((i,o)=>o===n.length-1?i.pathname:i.pathnameBase)}function Mx(a,n,i,o=!1){let d;typeof a=="string"?d=$i(a):(d={...a},bt(!d.pathname||!d.pathname.includes("?"),Th("?","pathname","search",d)),bt(!d.pathname||!d.pathname.includes("#"),Th("#","pathname","hash",d)),bt(!d.search||!d.search.includes("#"),Th("#","search","hash",d)));let h=a===""||d.pathname==="",g=h?"/":d.pathname,p;if(g==null)p=i;else{let j=n.length-1;if(!o&&g.startsWith("..")){let _=g.split("/");for(;_[0]==="..";)_.shift(),j-=1;d.pathname=_.join("/")}p=j>=0?n[j]:"/"}let x=_2(d,p),b=g&&g!=="/"&&g.endsWith("/"),N=(h||g===".")&&i.endsWith("/");return!x.pathname.endsWith("/")&&(b||N)&&(x.pathname+="/"),x}var hr=a=>a.join("/").replace(/\/\/+/g,"/"),S2=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),C2=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,E2=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a,T2=class{constructor(a,n,i,o=!1){this.status=a,this.statusText=n||"",this.internal=o,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}};function A2(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}function R2(a){return a.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Lx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ox(a,n){let i=a;if(typeof i!="string"||!Ax.test(i))return{absoluteURL:void 0,isExternal:!1,to:i};let o=i,d=!1;if(Lx)try{let h=new URL(window.location.href),g=i.startsWith("//")?new URL(h.protocol+i):new URL(i),p=gr(g.pathname,n);g.origin===h.origin&&p!=null?i=p+g.search+g.hash:d=!0}catch{ds(!1,`<Link to="${i}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:o,isExternal:d,to:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ix=["POST","PUT","PATCH","DELETE"];new Set(Ix);var M2=["GET",...Ix];new Set(M2);var Fi=w.createContext(null);Fi.displayName="DataRouter";var wd=w.createContext(null);wd.displayName="DataRouterState";var L2=w.createContext(!1),Dx=w.createContext({isTransitioning:!1});Dx.displayName="ViewTransition";var O2=w.createContext(new Map);O2.displayName="Fetchers";var I2=w.createContext(null);I2.displayName="Await";var qn=w.createContext(null);qn.displayName="Navigation";var co=w.createContext(null);co.displayName="Location";var Bs=w.createContext({outlet:null,matches:[],isDataRoute:!1});Bs.displayName="Route";var of=w.createContext(null);of.displayName="RouteError";var Ux="REACT_ROUTER_ERROR",D2="REDIRECT",U2="ROUTE_ERROR_RESPONSE";function B2(a){if(a.startsWith(`${Ux}:${D2}:{`))try{let n=JSON.parse(a.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function z2(a){if(a.startsWith(`${Ux}:${U2}:{`))try{let n=JSON.parse(a.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new T2(n.status,n.statusText,n.data)}catch{}}function P2(a,{relative:n}={}){bt(uo(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:o}=w.useContext(qn),{hash:d,pathname:h,search:g}=ho(a,{relative:n}),p=h;return i!=="/"&&(p=h==="/"?i:hr([i,h])),o.createHref({pathname:p,search:g,hash:d})}function uo(){return w.useContext(co)!=null}function zs(){return bt(uo(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(co).location}var Bx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zx(a){w.useContext(qn).static||w.useLayoutEffect(a)}function us(){let{isDataRoute:a}=w.useContext(Bs);return a?Z2():H2()}function H2(){bt(uo(),"useNavigate() may be used only in the context of a <Router> component.");let a=w.useContext(Fi),{basename:n,navigator:i}=w.useContext(qn),{matches:o}=w.useContext(Bs),{pathname:d}=zs(),h=JSON.stringify(Rx(o)),g=w.useRef(!1);return zx(()=>{g.current=!0}),w.useCallback((x,b={})=>{if(ds(g.current,Bx),!g.current)return;if(typeof x=="number"){i.go(x);return}let N=Mx(x,JSON.parse(h),d,b.relative==="path");a==null&&n!=="/"&&(N.pathname=N.pathname==="/"?n:hr([n,N.pathname])),(b.replace?i.replace:i.push)(N,b.state,b)},[n,i,h,d,a])}w.createContext(null);function cf(){let{matches:a}=w.useContext(Bs),n=a[a.length-1];return n?n.params:{}}function ho(a,{relative:n}={}){let{matches:i}=w.useContext(Bs),{pathname:o}=zs(),d=JSON.stringify(Rx(i));return w.useMemo(()=>Mx(a,JSON.parse(d),o,n==="path"),[a,d,o,n])}function G2(a,n){return Px(a,n)}function Px(a,n,i,o,d){bt(uo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:h}=w.useContext(qn),{matches:g}=w.useContext(Bs),p=g[g.length-1],x=p?p.params:{},b=p?p.pathname:"/",N=p?p.pathnameBase:"/",j=p&&p.route;{let z=j&&j.path||"";Gx(b,!j||z.endsWith("*")||z.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${b}" (under <Route path="${z}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${z}"> to <Route path="${z==="/"?"*":`${z}/*`}">.`)}let _=zs(),I;if(n){let z=typeof n=="string"?$i(n):n;bt(N==="/"||z.pathname?.startsWith(N),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${N}" but pathname "${z.pathname}" was given in the \`location\` prop.`),I=z}else I=_;let L=I.pathname||"/",T=L;if(N!=="/"){let z=N.replace(/^\//,"").split("/");T="/"+L.replace(/^\//,"").split("/").slice(z.length).join("/")}let U=Cx(a,{pathname:T});ds(j||U!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),ds(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=q2(U&&U.map(z=>Object.assign({},z,{params:Object.assign({},x,z.params),pathname:hr([N,h.encodeLocation?h.encodeLocation(z.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?N:hr([N,h.encodeLocation?h.encodeLocation(z.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:z.pathnameBase])})),g,i,o,d);return n&&P?w.createElement(co.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},P):P}function V2(){let a=Q2(),n=A2(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),i=a instanceof Error?a.stack:null,o="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:o},h={padding:"2px 4px",backgroundColor:o},g=null;return console.error("Error handled by React Router default ErrorBoundary:",a),g=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:h},"ErrorBoundary")," or"," ",w.createElement("code",{style:h},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),i?w.createElement("pre",{style:d},i):null,g)}var $2=w.createElement(V2,null),Hx=class extends w.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,n){return n.location!==a.location||n.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:n.error,location:n.location,revalidation:a.revalidation||n.revalidation}}componentDidCatch(a,n){this.props.onError?this.props.onError(a,n):console.error("React Router caught the following error during render",a)}render(){let a=this.state.error;if(this.context&&typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){const i=z2(a.digest);i&&(a=i)}let n=a!==void 0?w.createElement(Bs.Provider,{value:this.props.routeContext},w.createElement(of.Provider,{value:a,children:this.props.component})):this.props.children;return this.context?w.createElement(F2,{error:a},n):n}};Hx.contextType=L2;var Ah=new WeakMap;function F2({children:a,error:n}){let{basename:i}=w.useContext(qn);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let o=B2(n.digest);if(o){let d=Ah.get(n);if(d)throw d;let h=Ox(o.location,i);if(Lx&&!Ah.get(n))if(h.isExternal||o.reloadDocument)window.location.href=h.absoluteURL||h.to;else{const g=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(h.to,{replace:o.replace}));throw Ah.set(n,g),g}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${h.absoluteURL||h.to}`})}}return a}function W2({routeContext:a,match:n,children:i}){let o=w.useContext(Fi);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Bs.Provider,{value:a},i)}function q2(a,n=[],i=null,o=null,d=null){if(a==null){if(!i)return null;if(i.errors)a=i.matches;else if(n.length===0&&!i.initialized&&i.matches.length>0)a=i.matches;else return null}let h=a,g=i?.errors;if(g!=null){let N=h.findIndex(j=>j.route.id&&g?.[j.route.id]!==void 0);bt(N>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(g).join(",")}`),h=h.slice(0,Math.min(h.length,N+1))}let p=!1,x=-1;if(i)for(let N=0;N<h.length;N++){let j=h[N];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(x=N),j.route.id){let{loaderData:_,errors:I}=i,L=j.route.loader&&!_.hasOwnProperty(j.route.id)&&(!I||I[j.route.id]===void 0);if(j.route.lazy||L){p=!0,x>=0?h=h.slice(0,x+1):h=[h[0]];break}}}let b=i&&o?(N,j)=>{o(N,{location:i.location,params:i.matches?.[0]?.params??{},unstable_pattern:R2(i.matches),errorInfo:j})}:void 0;return h.reduceRight((N,j,_)=>{let I,L=!1,T=null,U=null;i&&(I=g&&j.route.id?g[j.route.id]:void 0,T=j.route.errorElement||$2,p&&(x<0&&_===0?(Gx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),L=!0,U=null):x===_&&(L=!0,U=j.route.hydrateFallbackElement||null)));let P=n.concat(h.slice(0,_+1)),z=()=>{let G;return I?G=T:L?G=U:j.route.Component?G=w.createElement(j.route.Component,null):j.route.element?G=j.route.element:G=N,w.createElement(W2,{match:j,routeContext:{outlet:N,matches:P,isDataRoute:i!=null},children:G})};return i&&(j.route.ErrorBoundary||j.route.errorElement||_===0)?w.createElement(Hx,{location:i.location,revalidation:i.revalidation,component:T,error:I,children:z(),routeContext:{outlet:null,matches:P,isDataRoute:!0},onError:b}):z()},null)}function df(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Y2(a){let n=w.useContext(Fi);return bt(n,df(a)),n}function K2(a){let n=w.useContext(wd);return bt(n,df(a)),n}function X2(a){let n=w.useContext(Bs);return bt(n,df(a)),n}function uf(a){let n=X2(a),i=n.matches[n.matches.length-1];return bt(i.route.id,`${a} can only be used on routes that contain a unique "id"`),i.route.id}function J2(){return uf("useRouteId")}function Q2(){let a=w.useContext(of),n=K2("useRouteError"),i=uf("useRouteError");return a!==void 0?a:n.errors?.[i]}function Z2(){let{router:a}=Y2("useNavigate"),n=uf("useNavigate"),i=w.useRef(!1);return zx(()=>{i.current=!0}),w.useCallback(async(d,h={})=>{ds(i.current,Bx),i.current&&(typeof d=="number"?await a.navigate(d):await a.navigate(d,{fromRouteId:n,...h}))},[a,n])}var kp={};function Gx(a,n,i){!n&&!kp[a]&&(kp[a]=!0,ds(!1,i))}w.memo(e1);function e1({routes:a,future:n,state:i,onError:o}){return Px(a,void 0,i,o,n)}function on(a){bt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function t1({basename:a="/",children:n=null,location:i,navigationType:o="POP",navigator:d,static:h=!1,unstable_useTransitions:g}){bt(!uo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=a.replace(/^\/*/,"/"),x=w.useMemo(()=>({basename:p,navigator:d,static:h,unstable_useTransitions:g,future:{}}),[p,d,h,g]);typeof i=="string"&&(i=$i(i));let{pathname:b="/",search:N="",hash:j="",state:_=null,key:I="default"}=i,L=w.useMemo(()=>{let T=gr(b,p);return T==null?null:{location:{pathname:T,search:N,hash:j,state:_,key:I},navigationType:o}},[p,b,N,j,_,I,o]);return ds(L!=null,`<Router basename="${p}"> is not able to match the URL "${b}${N}${j}" because it does not start with the basename, so the <Router> won't render anything.`),L==null?null:w.createElement(qn.Provider,{value:x},w.createElement(co.Provider,{children:n,value:L}))}function n1({children:a,location:n}){return G2(Wh(a),n)}function Wh(a,n=[]){let i=[];return w.Children.forEach(a,(o,d)=>{if(!w.isValidElement(o))return;let h=[...n,d];if(o.type===w.Fragment){i.push.apply(i,Wh(o.props.children,h));return}bt(o.type===on,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bt(!o.props.index||!o.props.children,"An index route cannot have child routes.");let g={id:o.props.id||h.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(g.children=Wh(o.props.children,h)),i.push(g)}),i}var sd="get",rd="application/x-www-form-urlencoded";function jd(a){return typeof HTMLElement<"u"&&a instanceof HTMLElement}function s1(a){return jd(a)&&a.tagName.toLowerCase()==="button"}function r1(a){return jd(a)&&a.tagName.toLowerCase()==="form"}function a1(a){return jd(a)&&a.tagName.toLowerCase()==="input"}function i1(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function l1(a,n){return a.button===0&&(!n||n==="_self")&&!i1(a)}var qc=null;function o1(){if(qc===null)try{new FormData(document.createElement("form"),0),qc=!1}catch{qc=!0}return qc}var c1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Rh(a){return a!=null&&!c1.has(a)?(ds(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${rd}"`),null):a}function d1(a,n){let i,o,d,h,g;if(r1(a)){let p=a.getAttribute("action");o=p?gr(p,n):null,i=a.getAttribute("method")||sd,d=Rh(a.getAttribute("enctype"))||rd,h=new FormData(a)}else if(s1(a)||a1(a)&&(a.type==="submit"||a.type==="image")){let p=a.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=a.getAttribute("formaction")||p.getAttribute("action");if(o=x?gr(x,n):null,i=a.getAttribute("formmethod")||p.getAttribute("method")||sd,d=Rh(a.getAttribute("formenctype"))||Rh(p.getAttribute("enctype"))||rd,h=new FormData(p,a),!o1()){let{name:b,type:N,value:j}=a;if(N==="image"){let _=b?`${b}.`:"";h.append(`${_}x`,"0"),h.append(`${_}y`,"0")}else b&&h.append(b,j)}}else{if(jd(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=sd,o=null,d=rd,g=a}return h&&d==="text/plain"&&(g=h,h=void 0),{action:o,method:i.toLowerCase(),encType:d,formData:h,body:g}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hf(a,n){if(a===!1||a===null||typeof a>"u")throw new Error(n)}function u1(a,n,i){let o=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return o.pathname==="/"?o.pathname=`_root.${i}`:n&&gr(o.pathname,n)==="/"?o.pathname=`${n.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function h1(a,n){if(a.id in n)return n[a.id];try{let i=await import(a.module);return n[a.id]=i,i}catch(i){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function f1(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function g1(a,n,i){let o=await Promise.all(a.map(async d=>{let h=n.routes[d.route.id];if(h){let g=await h1(h,i);return g.links?g.links():[]}return[]}));return y1(o.flat(1).filter(f1).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function Sp(a,n,i,o,d,h){let g=(x,b)=>i[b]?x.route.id!==i[b].route.id:!0,p=(x,b)=>i[b].pathname!==x.pathname||i[b].route.path?.endsWith("*")&&i[b].params["*"]!==x.params["*"];return h==="assets"?n.filter((x,b)=>g(x,b)||p(x,b)):h==="data"?n.filter((x,b)=>{let N=o.routes[x.route.id];if(!N||!N.hasLoader)return!1;if(g(x,b)||p(x,b))return!0;if(x.route.shouldRevalidate){let j=x.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:i[0]?.params||{},nextUrl:new URL(a,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function m1(a,n,{includeHydrateFallback:i}={}){return p1(a.map(o=>{let d=n.routes[o.route.id];if(!d)return[];let h=[d.module];return d.clientActionModule&&(h=h.concat(d.clientActionModule)),d.clientLoaderModule&&(h=h.concat(d.clientLoaderModule)),i&&d.hydrateFallbackModule&&(h=h.concat(d.hydrateFallbackModule)),d.imports&&(h=h.concat(d.imports)),h}).flat(1))}function p1(a){return[...new Set(a)]}function x1(a){let n={},i=Object.keys(a).sort();for(let o of i)n[o]=a[o];return n}function y1(a,n){let i=new Set;return new Set(n),a.reduce((o,d)=>{let h=JSON.stringify(x1(d));return i.has(h)||(i.add(h),o.push({key:h,link:d})),o},[])}function Vx(){let a=w.useContext(Fi);return hf(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function b1(){let a=w.useContext(wd);return hf(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var ff=w.createContext(void 0);ff.displayName="FrameworkContext";function $x(){let a=w.useContext(ff);return hf(a,"You must render this element inside a <HydratedRouter> element"),a}function v1(a,n){let i=w.useContext(ff),[o,d]=w.useState(!1),[h,g]=w.useState(!1),{onFocus:p,onBlur:x,onMouseEnter:b,onMouseLeave:N,onTouchStart:j}=n,_=w.useRef(null);w.useEffect(()=>{if(a==="render"&&g(!0),a==="viewport"){let T=P=>{P.forEach(z=>{g(z.isIntersecting)})},U=new IntersectionObserver(T,{threshold:.5});return _.current&&U.observe(_.current),()=>{U.disconnect()}}},[a]),w.useEffect(()=>{if(o){let T=setTimeout(()=>{g(!0)},100);return()=>{clearTimeout(T)}}},[o]);let I=()=>{d(!0)},L=()=>{d(!1),g(!1)};return i?a!=="intent"?[h,_,{}]:[h,_,{onFocus:Yl(p,I),onBlur:Yl(x,L),onMouseEnter:Yl(b,I),onMouseLeave:Yl(N,L),onTouchStart:Yl(j,I)}]:[!1,_,{}]}function Yl(a,n){return i=>{a&&a(i),i.defaultPrevented||n(i)}}function w1({page:a,...n}){let{router:i}=Vx(),o=w.useMemo(()=>Cx(i.routes,a,i.basename),[i.routes,a,i.basename]);return o?w.createElement(N1,{page:a,matches:o,...n}):null}function j1(a){let{manifest:n,routeModules:i}=$x(),[o,d]=w.useState([]);return w.useEffect(()=>{let h=!1;return g1(a,n,i).then(g=>{h||d(g)}),()=>{h=!0}},[a,n,i]),o}function N1({page:a,matches:n,...i}){let o=zs(),{manifest:d,routeModules:h}=$x(),{basename:g}=Vx(),{loaderData:p,matches:x}=b1(),b=w.useMemo(()=>Sp(a,n,x,d,o,"data"),[a,n,x,d,o]),N=w.useMemo(()=>Sp(a,n,x,d,o,"assets"),[a,n,x,d,o]),j=w.useMemo(()=>{if(a===o.pathname+o.search+o.hash)return[];let L=new Set,T=!1;if(n.forEach(P=>{let z=d.routes[P.route.id];!z||!z.hasLoader||(!b.some(G=>G.route.id===P.route.id)&&P.route.id in p&&h[P.route.id]?.shouldRevalidate||z.hasClientLoader?T=!0:L.add(P.route.id))}),L.size===0)return[];let U=u1(a,g,"data");return T&&L.size>0&&U.searchParams.set("_routes",n.filter(P=>L.has(P.route.id)).map(P=>P.route.id).join(",")),[U.pathname+U.search]},[g,p,o,d,b,n,a,h]),_=w.useMemo(()=>m1(N,d),[N,d]),I=j1(N);return w.createElement(w.Fragment,null,j.map(L=>w.createElement("link",{key:L,rel:"prefetch",as:"fetch",href:L,...i})),_.map(L=>w.createElement("link",{key:L,rel:"modulepreload",href:L,...i})),I.map(({key:L,link:T})=>w.createElement("link",{key:L,nonce:i.nonce,...T})))}function _1(...a){return n=>{a.forEach(i=>{typeof i=="function"?i(n):i!=null&&(i.current=n)})}}var k1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{k1&&(window.__reactRouterVersion="7.11.0")}catch{}function S1({basename:a,children:n,unstable_useTransitions:i,window:o}){let d=w.useRef();d.current==null&&(d.current=i2({window:o,v5Compat:!0}));let h=d.current,[g,p]=w.useState({action:h.action,location:h.location}),x=w.useCallback(b=>{i===!1?p(b):w.startTransition(()=>p(b))},[i]);return w.useLayoutEffect(()=>h.listen(x),[h,x]),w.createElement(t1,{basename:a,children:n,location:g.location,navigationType:g.action,navigator:h,unstable_useTransitions:i})}var Fx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yt=w.forwardRef(function({onClick:n,discover:i="render",prefetch:o="none",relative:d,reloadDocument:h,replace:g,state:p,target:x,to:b,preventScrollReset:N,viewTransition:j,unstable_defaultShouldRevalidate:_,...I},L){let{basename:T,unstable_useTransitions:U}=w.useContext(qn),P=typeof b=="string"&&Fx.test(b),z=Ox(b,T);b=z.to;let G=P2(b,{relative:d}),[X,se,te]=v1(o,I),R=A1(b,{replace:g,state:p,target:x,preventScrollReset:N,relative:d,viewTransition:j,unstable_defaultShouldRevalidate:_,unstable_useTransitions:U});function k(S){n&&n(S),S.defaultPrevented||R(S)}let E=w.createElement("a",{...I,...te,href:z.absoluteURL||G,onClick:z.isExternal||h?n:k,ref:_1(L,se),target:x,"data-discover":!P&&i==="render"?"true":void 0});return X&&!P?w.createElement(w.Fragment,null,E,w.createElement(w1,{page:G})):E});yt.displayName="Link";var C1=w.forwardRef(function({"aria-current":n="page",caseSensitive:i=!1,className:o="",end:d=!1,style:h,to:g,viewTransition:p,children:x,...b},N){let j=ho(g,{relative:b.relative}),_=zs(),I=w.useContext(wd),{navigator:L,basename:T}=w.useContext(qn),U=I!=null&&I1(j)&&p===!0,P=L.encodeLocation?L.encodeLocation(j).pathname:j.pathname,z=_.pathname,G=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;i||(z=z.toLowerCase(),G=G?G.toLowerCase():null,P=P.toLowerCase()),G&&T&&(G=gr(G,T)||G);const X=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let se=z===P||!d&&z.startsWith(P)&&z.charAt(X)==="/",te=G!=null&&(G===P||!d&&G.startsWith(P)&&G.charAt(P.length)==="/"),R={isActive:se,isPending:te,isTransitioning:U},k=se?n:void 0,E;typeof o=="function"?E=o(R):E=[o,se?"active":null,te?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let S=typeof h=="function"?h(R):h;return w.createElement(yt,{...b,"aria-current":k,className:E,ref:N,style:S,to:g,viewTransition:p},typeof x=="function"?x(R):x)});C1.displayName="NavLink";var E1=w.forwardRef(({discover:a="render",fetcherKey:n,navigate:i,reloadDocument:o,replace:d,state:h,method:g=sd,action:p,onSubmit:x,relative:b,preventScrollReset:N,viewTransition:j,unstable_defaultShouldRevalidate:_,...I},L)=>{let{unstable_useTransitions:T}=w.useContext(qn),U=L1(),P=O1(p,{relative:b}),z=g.toLowerCase()==="get"?"get":"post",G=typeof p=="string"&&Fx.test(p),X=se=>{if(x&&x(se),se.defaultPrevented)return;se.preventDefault();let te=se.nativeEvent.submitter,R=te?.getAttribute("formmethod")||g,k=()=>U(te||se.currentTarget,{fetcherKey:n,method:R,navigate:i,replace:d,state:h,relative:b,preventScrollReset:N,viewTransition:j,unstable_defaultShouldRevalidate:_});T&&i!==!1?w.startTransition(()=>k()):k()};return w.createElement("form",{ref:L,method:z,action:P,onSubmit:o?x:X,...I,"data-discover":!G&&a==="render"?"true":void 0})});E1.displayName="Form";function T1(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wx(a){let n=w.useContext(Fi);return bt(n,T1(a)),n}function A1(a,{target:n,replace:i,state:o,preventScrollReset:d,relative:h,viewTransition:g,unstable_defaultShouldRevalidate:p,unstable_useTransitions:x}={}){let b=us(),N=zs(),j=ho(a,{relative:h});return w.useCallback(_=>{if(l1(_,n)){_.preventDefault();let I=i!==void 0?i:ao(N)===ao(j),L=()=>b(a,{replace:I,state:o,preventScrollReset:d,relative:h,viewTransition:g,unstable_defaultShouldRevalidate:p});x?w.startTransition(()=>L()):L()}},[N,b,j,i,o,n,a,d,h,g,p,x])}var R1=0,M1=()=>`__${String(++R1)}__`;function L1(){let{router:a}=Wx("useSubmit"),{basename:n}=w.useContext(qn),i=J2(),o=a.fetch,d=a.navigate;return w.useCallback(async(h,g={})=>{let{action:p,method:x,encType:b,formData:N,body:j}=d1(h,n);if(g.navigate===!1){let _=g.fetcherKey||M1();await o(_,i,g.action||p,{unstable_defaultShouldRevalidate:g.unstable_defaultShouldRevalidate,preventScrollReset:g.preventScrollReset,formData:N,body:j,formMethod:g.method||x,formEncType:g.encType||b,flushSync:g.flushSync})}else await d(g.action||p,{unstable_defaultShouldRevalidate:g.unstable_defaultShouldRevalidate,preventScrollReset:g.preventScrollReset,formData:N,body:j,formMethod:g.method||x,formEncType:g.encType||b,replace:g.replace,state:g.state,fromRouteId:i,flushSync:g.flushSync,viewTransition:g.viewTransition})},[o,d,n,i])}function O1(a,{relative:n}={}){let{basename:i}=w.useContext(qn),o=w.useContext(Bs);bt(o,"useFormAction must be used inside a RouteContext");let[d]=o.matches.slice(-1),h={...ho(a||".",{relative:n})},g=zs();if(a==null){h.search=g.search;let p=new URLSearchParams(h.search),x=p.getAll("index");if(x.some(N=>N==="")){p.delete("index"),x.filter(j=>j).forEach(j=>p.append("index",j));let N=p.toString();h.search=N?`?${N}`:""}}return(!a||a===".")&&d.route.index&&(h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(h.pathname=h.pathname==="/"?i:hr([i,h.pathname])),ao(h)}function I1(a,{relative:n}={}){let i=w.useContext(Dx);bt(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Wx("useViewTransitionState"),d=ho(a,{relative:n});if(!i.isTransitioning)return!1;let h=gr(i.currentLocation.pathname,o)||i.currentLocation.pathname,g=gr(i.nextLocation.pathname,o)||i.nextLocation.pathname;return dd(d.pathname,g)!=null||dd(d.pathname,h)!=null}var aa=Sx();const qx=af(aa),D1=()=>{};var Cp={};const Yx=function(a){const n=[];let i=0;for(let o=0;o<a.length;o++){let d=a.charCodeAt(o);d<128?n[i++]=d:d<2048?(n[i++]=d>>6|192,n[i++]=d&63|128):(d&64512)===55296&&o+1<a.length&&(a.charCodeAt(o+1)&64512)===56320?(d=65536+((d&1023)<<10)+(a.charCodeAt(++o)&1023),n[i++]=d>>18|240,n[i++]=d>>12&63|128,n[i++]=d>>6&63|128,n[i++]=d&63|128):(n[i++]=d>>12|224,n[i++]=d>>6&63|128,n[i++]=d&63|128)}return n},U1=function(a){const n=[];let i=0,o=0;for(;i<a.length;){const d=a[i++];if(d<128)n[o++]=String.fromCharCode(d);else if(d>191&&d<224){const h=a[i++];n[o++]=String.fromCharCode((d&31)<<6|h&63)}else if(d>239&&d<365){const h=a[i++],g=a[i++],p=a[i++],x=((d&7)<<18|(h&63)<<12|(g&63)<<6|p&63)-65536;n[o++]=String.fromCharCode(55296+(x>>10)),n[o++]=String.fromCharCode(56320+(x&1023))}else{const h=a[i++],g=a[i++];n[o++]=String.fromCharCode((d&15)<<12|(h&63)<<6|g&63)}}return n.join("")},Kx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(a,n){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let d=0;d<a.length;d+=3){const h=a[d],g=d+1<a.length,p=g?a[d+1]:0,x=d+2<a.length,b=x?a[d+2]:0,N=h>>2,j=(h&3)<<4|p>>4;let _=(p&15)<<2|b>>6,I=b&63;x||(I=64,g||(_=64)),o.push(i[N],i[j],i[_],i[I])}return o.join("")},encodeString(a,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(a):this.encodeByteArray(Yx(a),n)},decodeString(a,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(a):U1(this.decodeStringToByteArray(a,n))},decodeStringToByteArray(a,n){this.init_();const i=n?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let d=0;d<a.length;){const h=i[a.charAt(d++)],p=d<a.length?i[a.charAt(d)]:0;++d;const b=d<a.length?i[a.charAt(d)]:64;++d;const j=d<a.length?i[a.charAt(d)]:64;if(++d,h==null||p==null||b==null||j==null)throw new B1;const _=h<<2|p>>4;if(o.push(_),b!==64){const I=p<<4&240|b>>2;if(o.push(I),j!==64){const L=b<<6&192|j;o.push(L)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class B1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const z1=function(a){const n=Yx(a);return Kx.encodeByteArray(n,!0)},ud=function(a){return z1(a).replace(/\./g,"")},Xx=function(a){try{return Kx.decodeString(a,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};function P1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const H1=()=>P1().__FIREBASE_DEFAULTS__,G1=()=>{if(typeof process>"u"||typeof Cp>"u")return;const a=Cp.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},V1=()=>{if(typeof document>"u")return;let a;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const n=a&&Xx(a[1]);return n&&JSON.parse(n)},gf=()=>{try{return D1()||H1()||G1()||V1()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},Jx=a=>gf()?.emulatorHosts?.[a],Qx=a=>{const n=Jx(a);if(!n)return;const i=n.lastIndexOf(":");if(i<=0||i+1===n.length)throw new Error(`Invalid host ${n} with no separate hostname and port!`);const o=parseInt(n.substring(i+1),10);return n[0]==="["?[n.substring(1,i-1),o]:[n.substring(0,i),o]},Zx=()=>gf()?.config,ey=a=>gf()?.[`_${a}`];class $1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,i)=>{this.resolve=n,this.reject=i})}wrapCallback(n){return(i,o)=>{i?this.reject(i):this.resolve(o),typeof n=="function"&&(this.promise.catch(()=>{}),n.length===1?n(i):n(i,o))}}}function Ya(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch{return!1}}async function mf(a){return(await fetch(a,{credentials:"include"})).ok}function ty(a,n){if(a.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},o=n||"demo-project",d=a.iat||0,h=a.sub||a.user_id;if(!h)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const g={iss:`https://securetoken.google.com/${o}`,aud:o,iat:d,exp:d+3600,auth_time:d,sub:h,user_id:h,firebase:{sign_in_provider:"custom",identities:{}},...a};return[ud(JSON.stringify(i)),ud(JSON.stringify(g)),""].join(".")}const Ql={};function F1(){const a={prod:[],emulator:[]};for(const n of Object.keys(Ql))Ql[n]?a.emulator.push(n):a.prod.push(n);return a}function W1(a){let n=document.getElementById(a),i=!1;return n||(n=document.createElement("div"),n.setAttribute("id",a),i=!0),{created:i,element:n}}let Ep=!1;function pf(a,n){if(typeof window>"u"||typeof document>"u"||!Ya(window.location.host)||Ql[a]===n||Ql[a]||Ep)return;Ql[a]=n;function i(_){return`__firebase__banner__${_}`}const o="__firebase__banner",h=F1().prod.length>0;function g(){const _=document.getElementById(o);_&&_.remove()}function p(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function x(_,I){_.setAttribute("width","24"),_.setAttribute("id",I),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function b(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Ep=!0,g()},_}function N(_,I){_.setAttribute("id",I),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function j(){const _=W1(o),I=i("text"),L=document.getElementById(I)||document.createElement("span"),T=i("learnmore"),U=document.getElementById(T)||document.createElement("a"),P=i("preprendIcon"),z=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const G=_.element;p(G),N(U,T);const X=b();x(z,P),G.append(z,L,U,X),document.body.appendChild(G)}h?(L.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",j):j()}function dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function q1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dn())}function Y1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function K1(){const a=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof a=="object"&&a.id!==void 0}function X1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function J1(){const a=dn();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function Q1(){try{return typeof indexedDB=="object"}catch{return!1}}function Z1(){return new Promise((a,n)=>{try{let i=!0;const o="validate-browser-context-for-indexeddb-analytics-module",d=self.indexedDB.open(o);d.onsuccess=()=>{d.result.close(),i||self.indexedDB.deleteDatabase(o),a(!0)},d.onupgradeneeded=()=>{i=!1},d.onerror=()=>{n(d.error?.message||"")}}catch(i){n(i)}})}const ew="FirebaseError";class Ps extends Error{constructor(n,i,o){super(i),this.code=n,this.customData=o,this.name=ew,Object.setPrototypeOf(this,Ps.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fo.prototype.create)}}class fo{constructor(n,i,o){this.service=n,this.serviceName=i,this.errors=o}create(n,...i){const o=i[0]||{},d=`${this.service}/${n}`,h=this.errors[n],g=h?tw(h,o):"Error",p=`${this.serviceName}: ${g} (${d}).`;return new Ps(d,p,o)}}function tw(a,n){return a.replace(nw,(i,o)=>{const d=n[o];return d!=null?String(d):`<${o}?>`})}const nw=/\{\$([^}]+)}/g;function sw(a){for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n))return!1;return!0}function Ga(a,n){if(a===n)return!0;const i=Object.keys(a),o=Object.keys(n);for(const d of i){if(!o.includes(d))return!1;const h=a[d],g=n[d];if(Tp(h)&&Tp(g)){if(!Ga(h,g))return!1}else if(h!==g)return!1}for(const d of o)if(!i.includes(d))return!1;return!0}function Tp(a){return a!==null&&typeof a=="object"}function go(a){const n=[];for(const[i,o]of Object.entries(a))Array.isArray(o)?o.forEach(d=>{n.push(encodeURIComponent(i)+"="+encodeURIComponent(d))}):n.push(encodeURIComponent(i)+"="+encodeURIComponent(o));return n.length?"&"+n.join("&"):""}function Xl(a){const n={};return a.replace(/^\?/,"").split("&").forEach(o=>{if(o){const[d,h]=o.split("=");n[decodeURIComponent(d)]=decodeURIComponent(h)}}),n}function Jl(a){const n=a.indexOf("?");if(!n)return"";const i=a.indexOf("#",n);return a.substring(n,i>0?i:void 0)}function rw(a,n){const i=new aw(a,n);return i.subscribe.bind(i)}class aw{constructor(n,i){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=i,this.task.then(()=>{n(this)}).catch(o=>{this.error(o)})}next(n){this.forEachObserver(i=>{i.next(n)})}error(n){this.forEachObserver(i=>{i.error(n)}),this.close(n)}complete(){this.forEachObserver(n=>{n.complete()}),this.close()}subscribe(n,i,o){let d;if(n===void 0&&i===void 0&&o===void 0)throw new Error("Missing Observer.");iw(n,["next","error","complete"])?d=n:d={next:n,error:i,complete:o},d.next===void 0&&(d.next=Mh),d.error===void 0&&(d.error=Mh),d.complete===void 0&&(d.complete=Mh);const h=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch{}}),this.observers.push(d),h}unsubscribeOne(n){this.observers===void 0||this.observers[n]===void 0||(delete this.observers[n],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(n){if(!this.finalized)for(let i=0;i<this.observers.length;i++)this.sendOne(i,n)}sendOne(n,i){this.task.then(()=>{if(this.observers!==void 0&&this.observers[n]!==void 0)try{i(this.observers[n])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})}close(n){this.finalized||(this.finalized=!0,n!==void 0&&(this.finalError=n),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function iw(a,n){if(typeof a!="object"||a===null)return!1;for(const i of n)if(i in a&&typeof a[i]=="function")return!0;return!1}function Mh(){}function bn(a){return a&&a._delegate?a._delegate:a}class sa{constructor(n,i,o){this.name=n,this.instanceFactory=i,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}}const Ia="[DEFAULT]";class lw{constructor(n,i){this.name=n,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){const i=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(i)){const o=new $1;if(this.instancesDeferred.set(i,o),this.isInitialized(i)||this.shouldAutoInitialize())try{const d=this.getOrInitializeService({instanceIdentifier:i});d&&o.resolve(d)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(n){const i=this.normalizeInstanceIdentifier(n?.identifier),o=n?.optional??!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(d){if(o)return null;throw d}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,!!this.shouldAutoInitialize()){if(cw(n))try{this.getOrInitializeService({instanceIdentifier:Ia})}catch{}for(const[i,o]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(i);try{const h=this.getOrInitializeService({instanceIdentifier:d});o.resolve(h)}catch{}}}}clearInstance(n=Ia){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}async delete(){const n=Array.from(this.instances.values());await Promise.all([...n.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...n.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(n=Ia){return this.instances.has(n)}getOptions(n=Ia){return this.instancesOptions.get(n)||{}}initialize(n={}){const{options:i={}}=n,o=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const d=this.getOrInitializeService({instanceIdentifier:o,options:i});for(const[h,g]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(h);o===p&&g.resolve(d)}return d}onInit(n,i){const o=this.normalizeInstanceIdentifier(i),d=this.onInitCallbacks.get(o)??new Set;d.add(n),this.onInitCallbacks.set(o,d);const h=this.instances.get(o);return h&&n(h,o),()=>{d.delete(n)}}invokeOnInitCallbacks(n,i){const o=this.onInitCallbacks.get(i);if(o)for(const d of o)try{d(n,i)}catch{}}getOrInitializeService({instanceIdentifier:n,options:i={}}){let o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:ow(n),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch{}return o||null}normalizeInstanceIdentifier(n=Ia){return this.component?this.component.multipleInstances?n:Ia:n}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ow(a){return a===Ia?void 0:a}function cw(a){return a.instantiationMode==="EAGER"}class dw{constructor(n){this.name=n,this.providers=new Map}addComponent(n){const i=this.getProvider(n.name);if(i.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);i.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);const i=new lw(n,this);return this.providers.set(n,i),i}getProviders(){return Array.from(this.providers.values())}}var st;(function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"})(st||(st={}));const uw={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},hw=st.INFO,fw={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},gw=(a,n,...i)=>{if(n<a.logLevel)return;const o=new Date().toISOString(),d=fw[n];if(d)console[d](`[${o}]  ${a.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`)};class xf{constructor(n){this.name=n,this._logLevel=hw,this._logHandler=gw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in st))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel=typeof n=="string"?uw[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if(typeof n!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...n),this._logHandler(this,st.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...n),this._logHandler(this,st.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,st.INFO,...n),this._logHandler(this,st.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,st.WARN,...n),this._logHandler(this,st.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...n),this._logHandler(this,st.ERROR,...n)}}const mw=(a,n)=>n.some(i=>a instanceof i);let Ap,Rp;function pw(){return Ap||(Ap=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xw(){return Rp||(Rp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ny=new WeakMap,qh=new WeakMap,sy=new WeakMap,Lh=new WeakMap,yf=new WeakMap;function yw(a){const n=new Promise((i,o)=>{const d=()=>{a.removeEventListener("success",h),a.removeEventListener("error",g)},h=()=>{i(ta(a.result)),d()},g=()=>{o(a.error),d()};a.addEventListener("success",h),a.addEventListener("error",g)});return n.then(i=>{i instanceof IDBCursor&&ny.set(i,a)}).catch(()=>{}),yf.set(n,a),n}function bw(a){if(qh.has(a))return;const n=new Promise((i,o)=>{const d=()=>{a.removeEventListener("complete",h),a.removeEventListener("error",g),a.removeEventListener("abort",g)},h=()=>{i(),d()},g=()=>{o(a.error||new DOMException("AbortError","AbortError")),d()};a.addEventListener("complete",h),a.addEventListener("error",g),a.addEventListener("abort",g)});qh.set(a,n)}let Yh={get(a,n,i){if(a instanceof IDBTransaction){if(n==="done")return qh.get(a);if(n==="objectStoreNames")return a.objectStoreNames||sy.get(a);if(n==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return ta(a[n])},set(a,n,i){return a[n]=i,!0},has(a,n){return a instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in a}};function vw(a){Yh=a(Yh)}function ww(a){return a===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...i){const o=a.call(Oh(this),n,...i);return sy.set(o,n.sort?n.sort():[n]),ta(o)}:xw().includes(a)?function(...n){return a.apply(Oh(this),n),ta(ny.get(this))}:function(...n){return ta(a.apply(Oh(this),n))}}function jw(a){return typeof a=="function"?ww(a):(a instanceof IDBTransaction&&bw(a),mw(a,pw())?new Proxy(a,Yh):a)}function ta(a){if(a instanceof IDBRequest)return yw(a);if(Lh.has(a))return Lh.get(a);const n=jw(a);return n!==a&&(Lh.set(a,n),yf.set(n,a)),n}const Oh=a=>yf.get(a);function Nw(a,n,{blocked:i,upgrade:o,blocking:d,terminated:h}={}){const g=indexedDB.open(a,n),p=ta(g);return o&&g.addEventListener("upgradeneeded",x=>{o(ta(g.result),x.oldVersion,x.newVersion,ta(g.transaction),x)}),i&&g.addEventListener("blocked",x=>i(x.oldVersion,x.newVersion,x)),p.then(x=>{h&&x.addEventListener("close",()=>h()),d&&x.addEventListener("versionchange",b=>d(b.oldVersion,b.newVersion,b))}).catch(()=>{}),p}const _w=["get","getKey","getAll","getAllKeys","count"],kw=["put","add","delete","clear"],Ih=new Map;function Mp(a,n){if(!(a instanceof IDBDatabase&&!(n in a)&&typeof n=="string"))return;if(Ih.get(n))return Ih.get(n);const i=n.replace(/FromIndex$/,""),o=n!==i,d=kw.includes(i);if(!(i in(o?IDBIndex:IDBObjectStore).prototype)||!(d||_w.includes(i)))return;const h=async function(g,...p){const x=this.transaction(g,d?"readwrite":"readonly");let b=x.store;return o&&(b=b.index(p.shift())),(await Promise.all([b[i](...p),d&&x.done]))[0]};return Ih.set(n,h),h}vw(a=>({...a,get:(n,i,o)=>Mp(n,i)||a.get(n,i,o),has:(n,i)=>!!Mp(n,i)||a.has(n,i)}));class Sw{constructor(n){this.container=n}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(Cw(i)){const o=i.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(i=>i).join(" ")}}function Cw(a){return a.getComponent()?.type==="VERSION"}const Kh="@firebase/app",Lp="0.14.6";const mr=new xf("@firebase/app"),Ew="@firebase/app-compat",Tw="@firebase/analytics-compat",Aw="@firebase/analytics",Rw="@firebase/app-check-compat",Mw="@firebase/app-check",Lw="@firebase/auth",Ow="@firebase/auth-compat",Iw="@firebase/database",Dw="@firebase/data-connect",Uw="@firebase/database-compat",Bw="@firebase/functions",zw="@firebase/functions-compat",Pw="@firebase/installations",Hw="@firebase/installations-compat",Gw="@firebase/messaging",Vw="@firebase/messaging-compat",$w="@firebase/performance",Fw="@firebase/performance-compat",Ww="@firebase/remote-config",qw="@firebase/remote-config-compat",Yw="@firebase/storage",Kw="@firebase/storage-compat",Xw="@firebase/firestore",Jw="@firebase/ai",Qw="@firebase/firestore-compat",Zw="firebase",ej="12.6.0";const Xh="[DEFAULT]",tj={[Kh]:"fire-core",[Ew]:"fire-core-compat",[Aw]:"fire-analytics",[Tw]:"fire-analytics-compat",[Mw]:"fire-app-check",[Rw]:"fire-app-check-compat",[Lw]:"fire-auth",[Ow]:"fire-auth-compat",[Iw]:"fire-rtdb",[Dw]:"fire-data-connect",[Uw]:"fire-rtdb-compat",[Bw]:"fire-fn",[zw]:"fire-fn-compat",[Pw]:"fire-iid",[Hw]:"fire-iid-compat",[Gw]:"fire-fcm",[Vw]:"fire-fcm-compat",[$w]:"fire-perf",[Fw]:"fire-perf-compat",[Ww]:"fire-rc",[qw]:"fire-rc-compat",[Yw]:"fire-gcs",[Kw]:"fire-gcs-compat",[Xw]:"fire-fst",[Qw]:"fire-fst-compat",[Jw]:"fire-vertex","fire-js":"fire-js",[Zw]:"fire-js-all"};const hd=new Map,nj=new Map,Jh=new Map;function Op(a,n){try{a.container.addComponent(n)}catch(i){mr.debug(`Component ${n.name} failed to register with FirebaseApp ${a.name}`,i)}}function Va(a){const n=a.name;if(Jh.has(n))return mr.debug(`There were multiple attempts to register component ${n}.`),!1;Jh.set(n,a);for(const i of hd.values())Op(i,a);for(const i of nj.values())Op(i,a);return!0}function Nd(a,n){const i=a.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),a.container.getProvider(n)}function yn(a){return a==null?!1:a.settings!==void 0}const sj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},na=new fo("app","Firebase",sj);class rj{constructor(n,i,o){this._isDeleted=!1,this._options={...n},this._config={...i},this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new sa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(n){this.checkDestroyed(),this._automaticDataCollectionEnabled=n}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(n){this._isDeleted=n}checkDestroyed(){if(this.isDeleted)throw na.create("app-deleted",{appName:this._name})}}const Ka=ej;function ry(a,n={}){let i=a;typeof n!="object"&&(n={name:n});const o={name:Xh,automaticDataCollectionEnabled:!0,...n},d=o.name;if(typeof d!="string"||!d)throw na.create("bad-app-name",{appName:String(d)});if(i||(i=Zx()),!i)throw na.create("no-options");const h=hd.get(d);if(h){if(Ga(i,h.options)&&Ga(o,h.config))return h;throw na.create("duplicate-app",{appName:d})}const g=new dw(d);for(const x of Jh.values())g.addComponent(x);const p=new rj(i,o,g);return hd.set(d,p),p}function bf(a=Xh){const n=hd.get(a);if(!n&&a===Xh&&Zx())return ry();if(!n)throw na.create("no-app",{appName:a});return n}function Ds(a,n,i){let o=tj[a]??a;i&&(o+=`-${i}`);const d=o.match(/\s|\//),h=n.match(/\s|\//);if(d||h){const g=[`Unable to register library "${o}" with version "${n}":`];d&&g.push(`library name "${o}" contains illegal characters (whitespace or "/")`),d&&h&&g.push("and"),h&&g.push(`version name "${n}" contains illegal characters (whitespace or "/")`),mr.warn(g.join(" "));return}Va(new sa(`${o}-version`,()=>({library:o,version:n}),"VERSION"))}const aj="firebase-heartbeat-database",ij=1,io="firebase-heartbeat-store";let Dh=null;function ay(){return Dh||(Dh=Nw(aj,ij,{upgrade:(a,n)=>{switch(n){case 0:try{a.createObjectStore(io)}catch(i){console.warn(i)}}}}).catch(a=>{throw na.create("idb-open",{originalErrorMessage:a.message})})),Dh}async function lj(a){try{const i=(await ay()).transaction(io),o=await i.objectStore(io).get(iy(a));return await i.done,o}catch(n){if(n instanceof Ps)mr.warn(n.message);else{const i=na.create("idb-get",{originalErrorMessage:n?.message});mr.warn(i.message)}}}async function Ip(a,n){try{const o=(await ay()).transaction(io,"readwrite");await o.objectStore(io).put(n,iy(a)),await o.done}catch(i){if(i instanceof Ps)mr.warn(i.message);else{const o=na.create("idb-set",{originalErrorMessage:i?.message});mr.warn(o.message)}}}function iy(a){return`${a.name}!${a.options.appId}`}const oj=1024,cj=30;class dj{constructor(n){this.container=n,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new hj(i),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Dp();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(d=>d.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>cj){const d=fj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){mr.warn(n)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Dp(),{heartbeatsToSend:i,unsentEntries:o}=uj(this._heartbeatsCache.heartbeats),d=ud(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(n){return mr.warn(n),""}}}function Dp(){return new Date().toISOString().substring(0,10)}function uj(a,n=oj){const i=[];let o=a.slice();for(const d of a){const h=i.find(g=>g.agent===d.agent);if(h){if(h.dates.push(d.date),Up(i)>n){h.dates.pop();break}}else if(i.push({agent:d.agent,dates:[d.date]}),Up(i)>n){i.pop();break}o=o.slice(1)}return{heartbeatsToSend:i,unsentEntries:o}}class hj{constructor(n){this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Q1()?Z1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const i=await lj(this.app);return i?.heartbeats?i:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(n){if(await this._canUseIndexedDBPromise){const o=await this.read();return Ip(this.app,{lastSentHeartbeatDate:n.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:n.heartbeats})}else return}async add(n){if(await this._canUseIndexedDBPromise){const o=await this.read();return Ip(this.app,{lastSentHeartbeatDate:n.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...n.heartbeats]})}else return}}function Up(a){return ud(JSON.stringify({version:2,heartbeats:a})).length}function fj(a){if(a.length===0)return-1;let n=0,i=a[0].date;for(let o=1;o<a.length;o++)a[o].date<i&&(i=a[o].date,n=o);return n}function gj(a){Va(new sa("platform-logger",n=>new Sw(n),"PRIVATE")),Va(new sa("heartbeat",n=>new dj(n),"PRIVATE")),Ds(Kh,Lp,a),Ds(Kh,Lp,"esm2020"),Ds("fire-js","")}gj("");function ly(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mj=ly,oy=new fo("auth","Firebase",ly());const fd=new xf("@firebase/auth");function pj(a,...n){fd.logLevel<=st.WARN&&fd.warn(`Auth (${Ka}): ${a}`,...n)}function ad(a,...n){fd.logLevel<=st.ERROR&&fd.error(`Auth (${Ka}): ${a}`,...n)}function Wn(a,...n){throw wf(a,...n)}function cs(a,...n){return wf(a,...n)}function vf(a,n,i){const o={...mj(),[n]:i};return new fo("auth","Firebase",o).create(n,{appName:a.name})}function fr(a){return vf(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xj(a,n,i){const o=i;if(!(n instanceof o))throw o.name!==n.constructor.name&&Wn(a,"argument-error"),vf(a,"argument-error",`Type of ${n.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wf(a,...n){if(typeof a!="string"){const i=n[0],o=[...n.slice(1)];return o[0]&&(o[0].appName=a.name),a._errorFactory.create(i,...o)}return oy.create(a,...n)}function Oe(a,n,...i){if(!a)throw wf(n,...i)}function dr(a){const n="INTERNAL ASSERTION FAILED: "+a;throw ad(n),new Error(n)}function pr(a,n){a||dr(n)}function Qh(){return typeof self<"u"&&self.location?.href||""}function yj(){return Bp()==="http:"||Bp()==="https:"}function Bp(){return typeof self<"u"&&self.location?.protocol||null}function bj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yj()||K1()||"connection"in navigator)?navigator.onLine:!0}function vj(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}class mo{constructor(n,i){this.shortDelay=n,this.longDelay=i,pr(i>n,"Short delay should be less than long delay!"),this.isMobile=q1()||X1()}get(){return bj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function jf(a,n){pr(a.emulator,"Emulator should always be set here");const{url:i}=a.emulator;return n?`${i}${n.startsWith("/")?n.slice(1):n}`:i}class cy{static initialize(n,i,o){this.fetchImpl=n,i&&(this.headersImpl=i),o&&(this.responseImpl=o)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;dr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;dr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;dr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const jj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Nj=new mo(3e4,6e4);function ia(a,n){return a.tenantId&&!n.tenantId?{...n,tenantId:a.tenantId}:n}async function xr(a,n,i,o,d={}){return dy(a,d,async()=>{let h={},g={};o&&(n==="GET"?g=o:h={body:JSON.stringify(o)});const p=go({key:a.config.apiKey,...g}).slice(1),x=await a._getAdditionalHeaders();x["Content-Type"]="application/json",a.languageCode&&(x["X-Firebase-Locale"]=a.languageCode);const b={method:n,headers:x,...h};return Y1()||(b.referrerPolicy="no-referrer"),a.emulatorConfig&&Ya(a.emulatorConfig.host)&&(b.credentials="include"),cy.fetch()(await uy(a,a.config.apiHost,i,p),b)})}async function dy(a,n,i){a._canInitEmulator=!1;const o={...wj,...n};try{const d=new kj(a),h=await Promise.race([i(),d.promise]);d.clearNetworkTimeout();const g=await h.json();if("needConfirmation"in g)throw Yc(a,"account-exists-with-different-credential",g);if(h.ok&&!("errorMessage"in g))return g;{const p=h.ok?g.errorMessage:g.error.message,[x,b]=p.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yc(a,"credential-already-in-use",g);if(x==="EMAIL_EXISTS")throw Yc(a,"email-already-in-use",g);if(x==="USER_DISABLED")throw Yc(a,"user-disabled",g);const N=o[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(b)throw vf(a,N,b);Wn(a,N)}}catch(d){if(d instanceof Ps)throw d;Wn(a,"network-request-failed",{message:String(d)})}}async function po(a,n,i,o,d={}){const h=await xr(a,n,i,o,d);return"mfaPendingCredential"in h&&Wn(a,"multi-factor-auth-required",{_serverResponse:h}),h}async function uy(a,n,i,o){const d=`${n}${i}?${o}`,h=a,g=h.config.emulator?jf(a.config,d):`${a.config.apiScheme}://${d}`;return jj.includes(i)&&(await h._persistenceManagerAvailable,h._getPersistenceType()==="COOKIE")?h._getPersistence()._getFinalTarget(g).toString():g}function _j(a){switch(a){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(n){this.auth=n,this.timer=null,this.promise=new Promise((i,o)=>{this.timer=setTimeout(()=>o(cs(this.auth,"network-request-failed")),Nj.get())})}}function Yc(a,n,i){const o={appName:a.name};i.email&&(o.email=i.email),i.phoneNumber&&(o.phoneNumber=i.phoneNumber);const d=cs(a,n,o);return d.customData._tokenResponse=i,d}function zp(a){return a!==void 0&&a.enterprise!==void 0}class Sj{constructor(n){if(this.siteKey="",this.recaptchaEnforcementState=[],n.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=n.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=n.recaptchaEnforcementState}getProviderEnforcementState(n){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const i of this.recaptchaEnforcementState)if(i.provider&&i.provider===n)return _j(i.enforcementState);return null}isProviderEnabled(n){return this.getProviderEnforcementState(n)==="ENFORCE"||this.getProviderEnforcementState(n)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Cj(a,n){return xr(a,"GET","/v2/recaptchaConfig",ia(a,n))}async function Ej(a,n){return xr(a,"POST","/v1/accounts:delete",n)}async function gd(a,n){return xr(a,"POST","/v1/accounts:lookup",n)}function Zl(a){if(a)try{const n=new Date(Number(a));if(!isNaN(n.getTime()))return n.toUTCString()}catch{}}async function Tj(a,n=!1){const i=bn(a),o=await i.getIdToken(n),d=Nf(o);Oe(d&&d.exp&&d.auth_time&&d.iat,i.auth,"internal-error");const h=typeof d.firebase=="object"?d.firebase:void 0,g=h?.sign_in_provider;return{claims:d,token:o,authTime:Zl(Uh(d.auth_time)),issuedAtTime:Zl(Uh(d.iat)),expirationTime:Zl(Uh(d.exp)),signInProvider:g||null,signInSecondFactor:h?.sign_in_second_factor||null}}function Uh(a){return Number(a)*1e3}function Nf(a){const[n,i,o]=a.split(".");if(n===void 0||i===void 0||o===void 0)return ad("JWT malformed, contained fewer than 3 sections"),null;try{const d=Xx(i);return d?JSON.parse(d):(ad("Failed to decode base64 JWT payload"),null)}catch(d){return ad("Caught error parsing JWT payload as JSON",d?.toString()),null}}function Pp(a){const n=Nf(a);return Oe(n,"internal-error"),Oe(typeof n.exp<"u","internal-error"),Oe(typeof n.iat<"u","internal-error"),Number(n.exp)-Number(n.iat)}async function Gi(a,n,i=!1){if(i)return n;try{return await n}catch(o){throw o instanceof Ps&&Aj(o)&&a.auth.currentUser===a&&await a.auth.signOut(),o}}function Aj({code:a}){return a==="auth/user-disabled"||a==="auth/user-token-expired"}class Rj{constructor(n){this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(n){if(n){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,o)}}schedule(n=!1){if(!this.isRunning)return;const i=this.getInterval(n);this.timerId=setTimeout(async()=>{await this.iteration()},i)}async iteration(){try{await this.user.getIdToken(!0)}catch(n){n?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Zh{constructor(n,i){this.createdAt=n,this.lastLoginAt=i,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zl(this.lastLoginAt),this.creationTime=Zl(this.createdAt)}_copy(n){this.createdAt=n.createdAt,this.lastLoginAt=n.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function md(a){const n=a.auth,i=await a.getIdToken(),o=await Gi(a,gd(n,{idToken:i}));Oe(o?.users.length,n,"internal-error");const d=o.users[0];a._notifyReloadListener(d);const h=d.providerUserInfo?.length?hy(d.providerUserInfo):[],g=Lj(a.providerData,h),p=a.isAnonymous,x=!(a.email&&d.passwordHash)&&!g?.length,b=p?x:!1,N={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:g,metadata:new Zh(d.createdAt,d.lastLoginAt),isAnonymous:b};Object.assign(a,N)}async function Mj(a){const n=bn(a);await md(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function Lj(a,n){return[...a.filter(o=>!n.some(d=>d.providerId===o.providerId)),...n]}function hy(a){return a.map(({providerId:n,...i})=>({providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}))}async function Oj(a,n){const i=await dy(a,{},async()=>{const o=go({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:d,apiKey:h}=a.config,g=await uy(a,d,"/v1/token",`key=${h}`),p=await a._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:p,body:o};return a.emulatorConfig&&Ya(a.emulatorConfig.host)&&(x.credentials="include"),cy.fetch()(g,x)});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}async function Ij(a,n){return xr(a,"POST","/v2/accounts:revokeToken",ia(a,n))}class Bi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(n){Oe(n.idToken,"internal-error"),Oe(typeof n.idToken<"u","internal-error"),Oe(typeof n.refreshToken<"u","internal-error");const i="expiresIn"in n&&typeof n.expiresIn<"u"?Number(n.expiresIn):Pp(n.idToken);this.updateTokensAndExpiration(n.idToken,n.refreshToken,i)}updateFromIdToken(n){Oe(n.length!==0,"internal-error");const i=Pp(n);this.updateTokensAndExpiration(n,null,i)}async getToken(n,i=!1){return!i&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,n,"user-token-expired"),this.refreshToken?(await this.refresh(n,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(n,i){const{accessToken:o,refreshToken:d,expiresIn:h}=await Oj(n,i);this.updateTokensAndExpiration(o,d,Number(h))}updateTokensAndExpiration(n,i,o){this.refreshToken=i||null,this.accessToken=n||null,this.expirationTime=Date.now()+o*1e3}static fromJSON(n,i){const{refreshToken:o,accessToken:d,expirationTime:h}=i,g=new Bi;return o&&(Oe(typeof o=="string","internal-error",{appName:n}),g.refreshToken=o),d&&(Oe(typeof d=="string","internal-error",{appName:n}),g.accessToken=d),h&&(Oe(typeof h=="number","internal-error",{appName:n}),g.expirationTime=h),g}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(n){this.accessToken=n.accessToken,this.refreshToken=n.refreshToken,this.expirationTime=n.expirationTime}_clone(){return Object.assign(new Bi,this.toJSON())}_performRefresh(){return dr("not implemented")}}function Kr(a,n){Oe(typeof a=="string"||typeof a>"u","internal-error",{appName:n})}class ls{constructor({uid:n,auth:i,stsTokenManager:o,...d}){this.providerId="firebase",this.proactiveRefresh=new Rj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=d.displayName||null,this.email=d.email||null,this.emailVerified=d.emailVerified||!1,this.phoneNumber=d.phoneNumber||null,this.photoURL=d.photoURL||null,this.isAnonymous=d.isAnonymous||!1,this.tenantId=d.tenantId||null,this.providerData=d.providerData?[...d.providerData]:[],this.metadata=new Zh(d.createdAt||void 0,d.lastLoginAt||void 0)}async getIdToken(n){const i=await Gi(this,this.stsTokenManager.getToken(this.auth,n));return Oe(i,this.auth,"internal-error"),this.accessToken!==i&&(this.accessToken=i,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),i}getIdTokenResult(n){return Tj(this,n)}reload(){return Mj(this)}_assign(n){this!==n&&(Oe(this.uid===n.uid,this.auth,"internal-error"),this.displayName=n.displayName,this.photoURL=n.photoURL,this.email=n.email,this.emailVerified=n.emailVerified,this.phoneNumber=n.phoneNumber,this.isAnonymous=n.isAnonymous,this.tenantId=n.tenantId,this.providerData=n.providerData.map(i=>({...i})),this.metadata._copy(n.metadata),this.stsTokenManager._assign(n.stsTokenManager))}_clone(n){const i=new ls({...this,auth:n,stsTokenManager:this.stsTokenManager._clone()});return i.metadata._copy(this.metadata),i}_onReload(n){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=n,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(n){this.reloadListener?this.reloadListener(n):this.reloadUserInfo=n}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(n,i=!1){let o=!1;n.idToken&&n.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(n),o=!0),i&&await md(this),await this.auth._persistUserIfCurrent(this),o&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yn(this.auth.app))return Promise.reject(fr(this.auth));const n=await this.getIdToken();return await Gi(this,Ej(this.auth,{idToken:n})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(n=>({...n})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(n,i){const o=i.displayName??void 0,d=i.email??void 0,h=i.phoneNumber??void 0,g=i.photoURL??void 0,p=i.tenantId??void 0,x=i._redirectEventId??void 0,b=i.createdAt??void 0,N=i.lastLoginAt??void 0,{uid:j,emailVerified:_,isAnonymous:I,providerData:L,stsTokenManager:T}=i;Oe(j&&T,n,"internal-error");const U=Bi.fromJSON(this.name,T);Oe(typeof j=="string",n,"internal-error"),Kr(o,n.name),Kr(d,n.name),Oe(typeof _=="boolean",n,"internal-error"),Oe(typeof I=="boolean",n,"internal-error"),Kr(h,n.name),Kr(g,n.name),Kr(p,n.name),Kr(x,n.name),Kr(b,n.name),Kr(N,n.name);const P=new ls({uid:j,auth:n,email:d,emailVerified:_,displayName:o,isAnonymous:I,photoURL:g,phoneNumber:h,tenantId:p,stsTokenManager:U,createdAt:b,lastLoginAt:N});return L&&Array.isArray(L)&&(P.providerData=L.map(z=>({...z}))),x&&(P._redirectEventId=x),P}static async _fromIdTokenResponse(n,i,o=!1){const d=new Bi;d.updateFromServerResponse(i);const h=new ls({uid:i.localId,auth:n,stsTokenManager:d,isAnonymous:o});return await md(h),h}static async _fromGetAccountInfoResponse(n,i,o){const d=i.users[0];Oe(d.localId!==void 0,"internal-error");const h=d.providerUserInfo!==void 0?hy(d.providerUserInfo):[],g=!(d.email&&d.passwordHash)&&!h?.length,p=new Bi;p.updateFromIdToken(o);const x=new ls({uid:d.localId,auth:n,stsTokenManager:p,isAnonymous:g}),b={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:h,metadata:new Zh(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!h?.length};return Object.assign(x,b),x}}const Hp=new Map;function ur(a){pr(a instanceof Function,"Expected a class definition");let n=Hp.get(a);return n?(pr(n instanceof a,"Instance stored in cache mismatched with class"),n):(n=new a,Hp.set(a,n),n)}class fy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(n,i){this.storage[n]=i}async _get(n){const i=this.storage[n];return i===void 0?null:i}async _remove(n){delete this.storage[n]}_addListener(n,i){}_removeListener(n,i){}}fy.type="NONE";const Gp=fy;function id(a,n,i){return`firebase:${a}:${n}:${i}`}class zi{constructor(n,i,o){this.persistence=n,this.auth=i,this.userKey=o;const{config:d,name:h}=this.auth;this.fullUserKey=id(this.userKey,d.apiKey,h),this.fullPersistenceKey=id("persistence",d.apiKey,h),this.boundEventHandler=i._onStorageEvent.bind(i),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(n){return this.persistence._set(this.fullUserKey,n.toJSON())}async getCurrentUser(){const n=await this.persistence._get(this.fullUserKey);if(!n)return null;if(typeof n=="string"){const i=await gd(this.auth,{idToken:n}).catch(()=>{});return i?ls._fromGetAccountInfoResponse(this.auth,i,n):null}return ls._fromJSON(this.auth,n)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(n){if(this.persistence===n)return;const i=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=n,i)return this.setCurrentUser(i)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(n,i,o="authUser"){if(!i.length)return new zi(ur(Gp),n,o);const d=(await Promise.all(i.map(async b=>{if(await b._isAvailable())return b}))).filter(b=>b);let h=d[0]||ur(Gp);const g=id(o,n.config.apiKey,n.name);let p=null;for(const b of i)try{const N=await b._get(g);if(N){let j;if(typeof N=="string"){const _=await gd(n,{idToken:N}).catch(()=>{});if(!_)break;j=await ls._fromGetAccountInfoResponse(n,_,N)}else j=ls._fromJSON(n,N);b!==h&&(p=j),h=b;break}}catch{}const x=d.filter(b=>b._shouldAllowMigration);return!h._shouldAllowMigration||!x.length?new zi(h,n,o):(h=x[0],p&&await h._set(g,p.toJSON()),await Promise.all(i.map(async b=>{if(b!==h)try{await b._remove(g)}catch{}})),new zi(h,n,o))}}function Vp(a){const n=a.toLowerCase();if(n.includes("opera/")||n.includes("opr/")||n.includes("opios/"))return"Opera";if(xy(n))return"IEMobile";if(n.includes("msie")||n.includes("trident/"))return"IE";if(n.includes("edge/"))return"Edge";if(gy(n))return"Firefox";if(n.includes("silk/"))return"Silk";if(by(n))return"Blackberry";if(vy(n))return"Webos";if(my(n))return"Safari";if((n.includes("chrome/")||py(n))&&!n.includes("edge/"))return"Chrome";if(yy(n))return"Android";{const i=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,o=a.match(i);if(o?.length===2)return o[1]}return"Other"}function gy(a=dn()){return/firefox\//i.test(a)}function my(a=dn()){const n=a.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function py(a=dn()){return/crios\//i.test(a)}function xy(a=dn()){return/iemobile/i.test(a)}function yy(a=dn()){return/android/i.test(a)}function by(a=dn()){return/blackberry/i.test(a)}function vy(a=dn()){return/webos/i.test(a)}function _f(a=dn()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function Dj(a=dn()){return _f(a)&&!!window.navigator?.standalone}function Uj(){return J1()&&document.documentMode===10}function wy(a=dn()){return _f(a)||yy(a)||vy(a)||by(a)||/windows phone/i.test(a)||xy(a)}function jy(a,n=[]){let i;switch(a){case"Browser":i=Vp(dn());break;case"Worker":i=`${Vp(dn())}-${a}`;break;default:i=a}const o=n.length?n.join(","):"FirebaseCore-web";return`${i}/JsCore/${Ka}/${o}`}class Bj{constructor(n){this.auth=n,this.queue=[]}pushCallback(n,i){const o=h=>new Promise((g,p)=>{try{const x=n(h);g(x)}catch(x){p(x)}});o.onAbort=i,this.queue.push(o);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(n){if(this.auth.currentUser===n)return;const i=[];try{for(const o of this.queue)await o(n),o.onAbort&&i.push(o.onAbort)}catch(o){i.reverse();for(const d of i)try{d()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:o?.message})}}}async function zj(a,n={}){return xr(a,"GET","/v2/passwordPolicy",ia(a,n))}const Pj=6;class Hj{constructor(n){const i=n.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=i.minPasswordLength??Pj,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=n.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=n.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=n.forceUpgradeOnSignin??!1,this.schemaVersion=n.schemaVersion}validatePassword(n){const i={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(n,i),this.validatePasswordCharacterOptions(n,i),i.isValid&&(i.isValid=i.meetsMinPasswordLength??!0),i.isValid&&(i.isValid=i.meetsMaxPasswordLength??!0),i.isValid&&(i.isValid=i.containsLowercaseLetter??!0),i.isValid&&(i.isValid=i.containsUppercaseLetter??!0),i.isValid&&(i.isValid=i.containsNumericCharacter??!0),i.isValid&&(i.isValid=i.containsNonAlphanumericCharacter??!0),i}validatePasswordLengthOptions(n,i){const o=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;o&&(i.meetsMinPasswordLength=n.length>=o),d&&(i.meetsMaxPasswordLength=n.length<=d)}validatePasswordCharacterOptions(n,i){this.updatePasswordCharacterOptionsStatuses(i,!1,!1,!1,!1);let o;for(let d=0;d<n.length;d++)o=n.charAt(d),this.updatePasswordCharacterOptionsStatuses(i,o>="a"&&o<="z",o>="A"&&o<="Z",o>="0"&&o<="9",this.allowedNonAlphanumericCharacters.includes(o))}updatePasswordCharacterOptionsStatuses(n,i,o,d,h){this.customStrengthOptions.containsLowercaseLetter&&(n.containsLowercaseLetter||(n.containsLowercaseLetter=i)),this.customStrengthOptions.containsUppercaseLetter&&(n.containsUppercaseLetter||(n.containsUppercaseLetter=o)),this.customStrengthOptions.containsNumericCharacter&&(n.containsNumericCharacter||(n.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(n.containsNonAlphanumericCharacter||(n.containsNonAlphanumericCharacter=h))}}class Gj{constructor(n,i,o,d){this.app=n,this.heartbeatServiceProvider=i,this.appCheckServiceProvider=o,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $p(this),this.idTokenSubscription=new $p(this),this.beforeStateQueue=new Bj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(h=>this._resolvePersistenceManagerAvailable=h)}_initializeWithPersistence(n,i){return i&&(this._popupRedirectResolver=ur(i)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await zi.create(this,n),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(i),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const n=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!n)){if(this.currentUser&&n&&this.currentUser.uid===n.uid){this._currentUser._assign(n),await this.currentUser.getIdToken();return}await this._updateCurrentUser(n,!0)}}async initializeCurrentUserFromIdToken(n){try{const i=await gd(this,{idToken:n}),o=await ls._fromGetAccountInfoResponse(this,i,n);await this.directlySetCurrentUser(o)}catch(i){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",i),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(n){if(yn(this.app)){const h=this.app.settings.authIdToken;return h?new Promise(g=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(h).then(g,g))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,d=!1;if(n&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const h=this.redirectUser?._redirectEventId,g=o?._redirectEventId,p=await this.tryRedirectSignIn(n);(!h||h===g)&&p?.user&&(o=p.user,d=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(d)try{await this.beforeStateQueue.runMiddleware(o)}catch(h){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(h))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(n){let i=null;try{i=await this._popupRedirectResolver._completeRedirectFn(this,n,!0)}catch{await this._setRedirectUser(null)}return i}async reloadAndSetCurrentUserOrClear(n){try{await md(n)}catch(i){if(i?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(n)}useDeviceLanguage(){this.languageCode=vj()}async _delete(){this._deleted=!0}async updateCurrentUser(n){if(yn(this.app))return Promise.reject(fr(this));const i=n?bn(n):null;return i&&Oe(i.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(i&&i._clone(this))}async _updateCurrentUser(n,i=!1){if(!this._deleted)return n&&Oe(this.tenantId===n.tenantId,this,"tenant-id-mismatch"),i||await this.beforeStateQueue.runMiddleware(n),this.queue(async()=>{await this.directlySetCurrentUser(n),this.notifyAuthListeners()})}async signOut(){return yn(this.app)?Promise.reject(fr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(n){return yn(this.app)?Promise.reject(fr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ur(n))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(n){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const i=this._getPasswordPolicyInternal();return i.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):i.validatePassword(n)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const n=await zj(this),i=new Hj(n);this.tenantId===null?this._projectPasswordPolicy=i:this._tenantPasswordPolicies[this.tenantId]=i}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(n){this._errorFactory=new fo("auth","Firebase",n())}onAuthStateChanged(n,i,o){return this.registerStateListener(this.authStateSubscription,n,i,o)}beforeAuthStateChanged(n,i){return this.beforeStateQueue.pushCallback(n,i)}onIdTokenChanged(n,i,o){return this.registerStateListener(this.idTokenSubscription,n,i,o)}authStateReady(){return new Promise((n,i)=>{if(this.currentUser)n();else{const o=this.onAuthStateChanged(()=>{o(),n()},i)}})}async revokeAccessToken(n){if(this.currentUser){const i=await this.currentUser.getIdToken(),o={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:n,idToken:i};this.tenantId!=null&&(o.tenantId=this.tenantId),await Ij(this,o)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(n,i){const o=await this.getOrInitRedirectPersistenceManager(i);return n===null?o.removeCurrentUser():o.setCurrentUser(n)}async getOrInitRedirectPersistenceManager(n){if(!this.redirectPersistenceManager){const i=n&&ur(n)||this._popupRedirectResolver;Oe(i,this,"argument-error"),this.redirectPersistenceManager=await zi.create(this,[ur(i._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(n){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===n?this._currentUser:this.redirectUser?._redirectEventId===n?this.redirectUser:null}async _persistUserIfCurrent(n){if(n===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(n))}_notifyListenersIfCurrent(n){n===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=this.currentUser?.uid??null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(n,i,o,d){if(this._deleted)return()=>{};const h=typeof i=="function"?i:i.next.bind(i);let g=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(p,this,"internal-error"),p.then(()=>{g||h(this.currentUser)}),typeof i=="function"){const x=n.addObserver(i,o,d);return()=>{g=!0,x()}}else{const x=n.addObserver(i);return()=>{g=!0,x()}}}async directlySetCurrentUser(n){this.currentUser&&this.currentUser!==n&&this._currentUser._stopProactiveRefresh(),n&&this.isProactiveRefreshEnabled&&n._startProactiveRefresh(),this.currentUser=n,n?await this.assertedPersistence.setCurrentUser(n):await this.assertedPersistence.removeCurrentUser()}queue(n){return this.operations=this.operations.then(n,n),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(n){!n||this.frameworks.includes(n)||(this.frameworks.push(n),this.frameworks.sort(),this.clientVersion=jy(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const i=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n}async _getAppCheckToken(){if(yn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return n?.error&&pj(`Error while retrieving App Check token: ${n.error}`),n?.token}}function la(a){return bn(a)}class $p{constructor(n){this.auth=n,this.observer=null,this.addObserver=rw(i=>this.observer=i)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let _d={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Vj(a){_d=a}function Ny(a){return _d.loadJS(a)}function $j(){return _d.recaptchaEnterpriseScript}function Fj(){return _d.gapiScript}function Wj(a){return`__${a}${Math.floor(Math.random()*1e6)}`}class qj{constructor(){this.enterprise=new Yj}ready(n){n()}execute(n,i){return Promise.resolve("token")}render(n,i){return""}}class Yj{ready(n){n()}execute(n,i){return Promise.resolve("token")}render(n,i){return""}}const Kj="recaptcha-enterprise",_y="NO_RECAPTCHA";class Xj{constructor(n){this.type=Kj,this.auth=la(n)}async verify(n="verify",i=!1){async function o(h){if(!i){if(h.tenantId==null&&h._agentRecaptchaConfig!=null)return h._agentRecaptchaConfig.siteKey;if(h.tenantId!=null&&h._tenantRecaptchaConfigs[h.tenantId]!==void 0)return h._tenantRecaptchaConfigs[h.tenantId].siteKey}return new Promise(async(g,p)=>{Cj(h,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const b=new Sj(x);return h.tenantId==null?h._agentRecaptchaConfig=b:h._tenantRecaptchaConfigs[h.tenantId]=b,g(b.siteKey)}}).catch(x=>{p(x)})})}function d(h,g,p){const x=window.grecaptcha;zp(x)?x.enterprise.ready(()=>{x.enterprise.execute(h,{action:n}).then(b=>{g(b)}).catch(()=>{g(_y)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new qj().execute("siteKey",{action:"verify"}):new Promise((h,g)=>{o(this.auth).then(p=>{if(!i&&zp(window.grecaptcha))d(p,h,g);else{if(typeof window>"u"){g(new Error("RecaptchaVerifier is only supported in browser"));return}let x=$j();x.length!==0&&(x+=p),Ny(x).then(()=>{d(p,h,g)}).catch(b=>{g(b)})}}).catch(p=>{g(p)})})}}async function Fp(a,n,i,o=!1,d=!1){const h=new Xj(a);let g;if(d)g=_y;else try{g=await h.verify(i)}catch{g=await h.verify(i,!0)}const p={...n};if(i==="mfaSmsEnrollment"||i==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const x=p.phoneEnrollmentInfo.phoneNumber,b=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:b,captchaResponse:g,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const x=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:g,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return o?Object.assign(p,{captchaResp:g}):Object.assign(p,{captchaResponse:g}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function ef(a,n,i,o,d){if(a._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const h=await Fp(a,n,i,i==="getOobCode");return o(a,h)}else return o(a,n).catch(async h=>{if(h.code==="auth/missing-recaptcha-token"){console.log(`${i} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const g=await Fp(a,n,i,i==="getOobCode");return o(a,g)}else return Promise.reject(h)})}function Jj(a,n){const i=Nd(a,"auth");if(i.isInitialized()){const d=i.getImmediate(),h=i.getOptions();if(Ga(h,n??{}))return d;Wn(d,"already-initialized")}return i.initialize({options:n})}function Qj(a,n){const i=n?.persistence||[],o=(Array.isArray(i)?i:[i]).map(ur);n?.errorMap&&a._updateErrorMap(n.errorMap),a._initializeWithPersistence(o,n?.popupRedirectResolver)}function Zj(a,n,i){const o=la(a);Oe(/^https?:\/\//.test(n),o,"invalid-emulator-scheme");const d=!1,h=ky(n),{host:g,port:p}=eN(n),x=p===null?"":`:${p}`,b={url:`${h}//${g}${x}/`},N=Object.freeze({host:g,port:p,protocol:h.replace(":",""),options:Object.freeze({disableWarnings:d})});if(!o._canInitEmulator){Oe(o.config.emulator&&o.emulatorConfig,o,"emulator-config-failed"),Oe(Ga(b,o.config.emulator)&&Ga(N,o.emulatorConfig),o,"emulator-config-failed");return}o.config.emulator=b,o.emulatorConfig=N,o.settings.appVerificationDisabledForTesting=!0,Ya(g)?(mf(`${h}//${g}${x}`),pf("Auth",!0)):tN()}function ky(a){const n=a.indexOf(":");return n<0?"":a.substr(0,n+1)}function eN(a){const n=ky(a),i=/(\/\/)?([^?#/]+)/.exec(a.substr(n.length));if(!i)return{host:"",port:null};const o=i[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(o);if(d){const h=d[1];return{host:h,port:Wp(o.substr(h.length+1))}}else{const[h,g]=o.split(":");return{host:h,port:Wp(g)}}}function Wp(a){if(!a)return null;const n=Number(a);return isNaN(n)?null:n}function tN(){function a(){const n=document.createElement("p"),i=n.style;n.innerText="Running in emulator mode. Do not use with production credentials.",i.position="fixed",i.width="100%",i.backgroundColor="#ffffff",i.border=".1em solid #000000",i.color="#b50000",i.bottom="0px",i.left="0px",i.margin="0px",i.zIndex="10000",i.textAlign="center",n.classList.add("firebase-emulator-warning"),document.body.appendChild(n)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",a):a())}class kf{constructor(n,i){this.providerId=n,this.signInMethod=i}toJSON(){return dr("not implemented")}_getIdTokenResponse(n){return dr("not implemented")}_linkToIdToken(n,i){return dr("not implemented")}_getReauthenticationResolver(n){return dr("not implemented")}}async function nN(a,n){return xr(a,"POST","/v1/accounts:signUp",n)}async function sN(a,n){return po(a,"POST","/v1/accounts:signInWithPassword",ia(a,n))}async function rN(a,n){return po(a,"POST","/v1/accounts:signInWithEmailLink",ia(a,n))}async function aN(a,n){return po(a,"POST","/v1/accounts:signInWithEmailLink",ia(a,n))}class lo extends kf{constructor(n,i,o,d=null){super("password",o),this._email=n,this._password=i,this._tenantId=d}static _fromEmailAndPassword(n,i){return new lo(n,i,"password")}static _fromEmailAndCode(n,i,o=null){return new lo(n,i,"emailLink",o)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(n){const i=typeof n=="string"?JSON.parse(n):n;if(i?.email&&i?.password){if(i.signInMethod==="password")return this._fromEmailAndPassword(i.email,i.password);if(i.signInMethod==="emailLink")return this._fromEmailAndCode(i.email,i.password,i.tenantId)}return null}async _getIdTokenResponse(n){switch(this.signInMethod){case"password":const i={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ef(n,i,"signInWithPassword",sN);case"emailLink":return rN(n,{email:this._email,oobCode:this._password});default:Wn(n,"internal-error")}}async _linkToIdToken(n,i){switch(this.signInMethod){case"password":const o={idToken:i,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ef(n,o,"signUpPassword",nN);case"emailLink":return aN(n,{idToken:i,email:this._email,oobCode:this._password});default:Wn(n,"internal-error")}}_getReauthenticationResolver(n){return this._getIdTokenResponse(n)}}async function Pi(a,n){return po(a,"POST","/v1/accounts:signInWithIdp",ia(a,n))}const iN="http://localhost";class $a extends kf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(n){const i=new $a(n.providerId,n.signInMethod);return n.idToken||n.accessToken?(n.idToken&&(i.idToken=n.idToken),n.accessToken&&(i.accessToken=n.accessToken),n.nonce&&!n.pendingToken&&(i.nonce=n.nonce),n.pendingToken&&(i.pendingToken=n.pendingToken)):n.oauthToken&&n.oauthTokenSecret?(i.accessToken=n.oauthToken,i.secret=n.oauthTokenSecret):Wn("argument-error"),i}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(n){const i=typeof n=="string"?JSON.parse(n):n,{providerId:o,signInMethod:d,...h}=i;if(!o||!d)return null;const g=new $a(o,d);return g.idToken=h.idToken||void 0,g.accessToken=h.accessToken||void 0,g.secret=h.secret,g.nonce=h.nonce,g.pendingToken=h.pendingToken||null,g}_getIdTokenResponse(n){const i=this.buildRequest();return Pi(n,i)}_linkToIdToken(n,i){const o=this.buildRequest();return o.idToken=i,Pi(n,o)}_getReauthenticationResolver(n){const i=this.buildRequest();return i.autoCreate=!1,Pi(n,i)}buildRequest(){const n={requestUri:iN,returnSecureToken:!0};if(this.pendingToken)n.pendingToken=this.pendingToken;else{const i={};this.idToken&&(i.id_token=this.idToken),this.accessToken&&(i.access_token=this.accessToken),this.secret&&(i.oauth_token_secret=this.secret),i.providerId=this.providerId,this.nonce&&!this.pendingToken&&(i.nonce=this.nonce),n.postBody=go(i)}return n}}function lN(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function oN(a){const n=Xl(Jl(a)).link,i=n?Xl(Jl(n)).deep_link_id:null,o=Xl(Jl(a)).deep_link_id;return(o?Xl(Jl(o)).link:null)||o||i||n||a}class Sf{constructor(n){const i=Xl(Jl(n)),o=i.apiKey??null,d=i.oobCode??null,h=lN(i.mode??null);Oe(o&&d&&h,"argument-error"),this.apiKey=o,this.operation=h,this.code=d,this.continueUrl=i.continueUrl??null,this.languageCode=i.lang??null,this.tenantId=i.tenantId??null}static parseLink(n){const i=oN(n);try{return new Sf(i)}catch{return null}}}class Wi{constructor(){this.providerId=Wi.PROVIDER_ID}static credential(n,i){return lo._fromEmailAndPassword(n,i)}static credentialWithLink(n,i){const o=Sf.parseLink(i);return Oe(o,"argument-error"),lo._fromEmailAndCode(n,o.code,o.tenantId)}}Wi.PROVIDER_ID="password";Wi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Wi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Cf{constructor(n){this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(n){this.defaultLanguageCode=n}setCustomParameters(n){return this.customParameters=n,this}getCustomParameters(){return this.customParameters}}class xo extends Cf{constructor(){super(...arguments),this.scopes=[]}addScope(n){return this.scopes.includes(n)||this.scopes.push(n),this}getScopes(){return[...this.scopes]}}class Jr extends xo{constructor(){super("facebook.com")}static credential(n){return $a._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.FACEBOOK_SIGN_IN_METHOD,accessToken:n})}static credentialFromResult(n){return Jr.credentialFromTaggedObject(n)}static credentialFromError(n){return Jr.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n||!("oauthAccessToken"in n)||!n.oauthAccessToken)return null;try{return Jr.credential(n.oauthAccessToken)}catch{return null}}}Jr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Jr.PROVIDER_ID="facebook.com";class or extends xo{constructor(){super("google.com"),this.addScope("profile")}static credential(n,i){return $a._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.GOOGLE_SIGN_IN_METHOD,idToken:n,accessToken:i})}static credentialFromResult(n){return or.credentialFromTaggedObject(n)}static credentialFromError(n){return or.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n)return null;const{oauthIdToken:i,oauthAccessToken:o}=n;if(!i&&!o)return null;try{return or.credential(i,o)}catch{return null}}}or.GOOGLE_SIGN_IN_METHOD="google.com";or.PROVIDER_ID="google.com";class Qr extends xo{constructor(){super("github.com")}static credential(n){return $a._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.GITHUB_SIGN_IN_METHOD,accessToken:n})}static credentialFromResult(n){return Qr.credentialFromTaggedObject(n)}static credentialFromError(n){return Qr.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n||!("oauthAccessToken"in n)||!n.oauthAccessToken)return null;try{return Qr.credential(n.oauthAccessToken)}catch{return null}}}Qr.GITHUB_SIGN_IN_METHOD="github.com";Qr.PROVIDER_ID="github.com";class Zr extends xo{constructor(){super("twitter.com")}static credential(n,i){return $a._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.TWITTER_SIGN_IN_METHOD,oauthToken:n,oauthTokenSecret:i})}static credentialFromResult(n){return Zr.credentialFromTaggedObject(n)}static credentialFromError(n){return Zr.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n)return null;const{oauthAccessToken:i,oauthTokenSecret:o}=n;if(!i||!o)return null;try{return Zr.credential(i,o)}catch{return null}}}Zr.TWITTER_SIGN_IN_METHOD="twitter.com";Zr.PROVIDER_ID="twitter.com";async function cN(a,n){return po(a,"POST","/v1/accounts:signUp",ia(a,n))}class Fa{constructor(n){this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}static async _fromIdTokenResponse(n,i,o,d=!1){const h=await ls._fromIdTokenResponse(n,o,d),g=qp(o);return new Fa({user:h,providerId:g,_tokenResponse:o,operationType:i})}static async _forOperation(n,i,o){await n._updateTokensIfNecessary(o,!0);const d=qp(o);return new Fa({user:n,providerId:d,_tokenResponse:o,operationType:i})}}function qp(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class pd extends Ps{constructor(n,i,o,d){super(i.code,i.message),this.operationType=o,this.user=d,Object.setPrototypeOf(this,pd.prototype),this.customData={appName:n.name,tenantId:n.tenantId??void 0,_serverResponse:i.customData._serverResponse,operationType:o}}static _fromErrorAndOperation(n,i,o,d){return new pd(n,i,o,d)}}function Sy(a,n,i,o){return(n==="reauthenticate"?i._getReauthenticationResolver(a):i._getIdTokenResponse(a)).catch(h=>{throw h.code==="auth/multi-factor-auth-required"?pd._fromErrorAndOperation(a,h,n,o):h})}async function dN(a,n,i=!1){const o=await Gi(a,n._linkToIdToken(a.auth,await a.getIdToken()),i);return Fa._forOperation(a,"link",o)}async function uN(a,n,i=!1){const{auth:o}=a;if(yn(o.app))return Promise.reject(fr(o));const d="reauthenticate";try{const h=await Gi(a,Sy(o,d,n,a),i);Oe(h.idToken,o,"internal-error");const g=Nf(h.idToken);Oe(g,o,"internal-error");const{sub:p}=g;return Oe(a.uid===p,o,"user-mismatch"),Fa._forOperation(a,d,h)}catch(h){throw h?.code==="auth/user-not-found"&&Wn(o,"user-mismatch"),h}}async function Cy(a,n,i=!1){if(yn(a.app))return Promise.reject(fr(a));const o="signIn",d=await Sy(a,o,n),h=await Fa._fromIdTokenResponse(a,o,d);return i||await a._updateCurrentUser(h.user),h}async function hN(a,n){return Cy(la(a),n)}async function Ey(a){const n=la(a);n._getPasswordPolicyInternal()&&await n._updatePasswordPolicy()}async function fN(a,n,i){if(yn(a.app))return Promise.reject(fr(a));const o=la(a),g=await ef(o,{returnSecureToken:!0,email:n,password:i,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cN).catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&Ey(a),x}),p=await Fa._fromIdTokenResponse(o,"signIn",g);return await o._updateCurrentUser(p.user),p}function gN(a,n,i){return yn(a.app)?Promise.reject(fr(a)):hN(bn(a),Wi.credential(n,i)).catch(async o=>{throw o.code==="auth/password-does-not-meet-requirements"&&Ey(a),o})}async function mN(a,n){return xr(a,"POST","/v1/accounts:update",n)}async function pN(a,{displayName:n,photoURL:i}){if(n===void 0&&i===void 0)return;const o=bn(a),h={idToken:await o.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},g=await Gi(o,mN(o.auth,h));o.displayName=g.displayName||null,o.photoURL=g.photoUrl||null;const p=o.providerData.find(({providerId:x})=>x==="password");p&&(p.displayName=o.displayName,p.photoURL=o.photoURL),await o._updateTokensIfNecessary(g)}function xN(a,n,i,o){return bn(a).onIdTokenChanged(n,i,o)}function yN(a,n,i){return bn(a).beforeAuthStateChanged(n,i)}function bN(a,n,i,o){return bn(a).onAuthStateChanged(n,i,o)}function vN(a){return bn(a).signOut()}const xd="__sak";class Ty{constructor(n,i){this.storageRetriever=n,this.type=i}_isAvailable(){try{return this.storage?(this.storage.setItem(xd,"1"),this.storage.removeItem(xd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(n,i){return this.storage.setItem(n,JSON.stringify(i)),Promise.resolve()}_get(n){const i=this.storage.getItem(n);return Promise.resolve(i?JSON.parse(i):null)}_remove(n){return this.storage.removeItem(n),Promise.resolve()}get storage(){return this.storageRetriever()}}const wN=1e3,jN=10;class Ay extends Ty{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,i)=>this.onStorageEvent(n,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wy(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(const i of Object.keys(this.listeners)){const o=this.storage.getItem(i),d=this.localCache[i];o!==d&&n(i,d,o)}}onStorageEvent(n,i=!1){if(!n.key){this.forAllChangedKeys((g,p,x)=>{this.notifyListeners(g,x)});return}const o=n.key;i?this.detachListener():this.stopPolling();const d=()=>{const g=this.storage.getItem(o);!i&&this.localCache[o]===g||this.notifyListeners(o,g)},h=this.storage.getItem(o);Uj()&&h!==n.newValue&&n.newValue!==n.oldValue?setTimeout(d,jN):d()}notifyListeners(n,i){this.localCache[n]=i;const o=this.listeners[n];if(o)for(const d of Array.from(o))d(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,i,o)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:i,newValue:o}),!0)})},wN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(i)}_removeListener(n,i){this.listeners[n]&&(this.listeners[n].delete(i),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(n,i){await super._set(n,i),this.localCache[n]=JSON.stringify(i)}async _get(n){const i=await super._get(n);return this.localCache[n]=JSON.stringify(i),i}async _remove(n){await super._remove(n),delete this.localCache[n]}}Ay.type="LOCAL";const NN=Ay;class Ry extends Ty{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,i){}_removeListener(n,i){}}Ry.type="SESSION";const My=Ry;function _N(a){return Promise.all(a.map(async n=>{try{return{fulfilled:!0,value:await n}}catch(i){return{fulfilled:!1,reason:i}}}))}class kd{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){const i=this.receivers.find(d=>d.isListeningto(n));if(i)return i;const o=new kd(n);return this.receivers.push(o),o}isListeningto(n){return this.eventTarget===n}async handleEvent(n){const i=n,{eventId:o,eventType:d,data:h}=i.data,g=this.handlersMap[d];if(!g?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:d});const p=Array.from(g).map(async b=>b(i.origin,h)),x=await _N(p);i.ports[0].postMessage({status:"done",eventId:o,eventType:d,response:x})}_subscribe(n,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(i)}_unsubscribe(n,i){this.handlersMap[n]&&i&&this.handlersMap[n].delete(i),(!i||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kd.receivers=[];function Ef(a="",n=10){let i="";for(let o=0;o<n;o++)i+=Math.floor(Math.random()*10);return a+i}class kN{constructor(n){this.target=n,this.handlers=new Set}removeMessageHandler(n){n.messageChannel&&(n.messageChannel.port1.removeEventListener("message",n.onMessage),n.messageChannel.port1.close()),this.handlers.delete(n)}async _send(n,i,o=50){const d=typeof MessageChannel<"u"?new MessageChannel:null;if(!d)throw new Error("connection_unavailable");let h,g;return new Promise((p,x)=>{const b=Ef("",20);d.port1.start();const N=setTimeout(()=>{x(new Error("unsupported_event"))},o);g={messageChannel:d,onMessage(j){const _=j;if(_.data.eventId===b)switch(_.data.status){case"ack":clearTimeout(N),h=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(h),p(_.data.response);break;default:clearTimeout(N),clearTimeout(h),x(new Error("invalid_response"));break}}},this.handlers.add(g),d.port1.addEventListener("message",g.onMessage),this.target.postMessage({eventType:n,eventId:b,data:i},[d.port2])}).finally(()=>{g&&this.removeMessageHandler(g)})}}function Us(){return window}function SN(a){Us().location.href=a}function Ly(){return typeof Us().WorkerGlobalScope<"u"&&typeof Us().importScripts=="function"}async function CN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function EN(){return navigator?.serviceWorker?.controller||null}function TN(){return Ly()?self:null}const Oy="firebaseLocalStorageDb",AN=1,yd="firebaseLocalStorage",Iy="fbase_key";class yo{constructor(n){this.request=n}toPromise(){return new Promise((n,i)=>{this.request.addEventListener("success",()=>{n(this.request.result)}),this.request.addEventListener("error",()=>{i(this.request.error)})})}}function Sd(a,n){return a.transaction([yd],n?"readwrite":"readonly").objectStore(yd)}function RN(){const a=indexedDB.deleteDatabase(Oy);return new yo(a).toPromise()}function tf(){const a=indexedDB.open(Oy,AN);return new Promise((n,i)=>{a.addEventListener("error",()=>{i(a.error)}),a.addEventListener("upgradeneeded",()=>{const o=a.result;try{o.createObjectStore(yd,{keyPath:Iy})}catch(d){i(d)}}),a.addEventListener("success",async()=>{const o=a.result;o.objectStoreNames.contains(yd)?n(o):(o.close(),await RN(),n(await tf()))})})}async function Yp(a,n,i){const o=Sd(a,!0).put({[Iy]:n,value:i});return new yo(o).toPromise()}async function MN(a,n){const i=Sd(a,!1).get(n),o=await new yo(i).toPromise();return o===void 0?null:o.value}function Kp(a,n){const i=Sd(a,!0).delete(n);return new yo(i).toPromise()}const LN=800,ON=3;class Dy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tf(),this.db)}async _withRetries(n){let i=0;for(;;)try{const o=await this._openDb();return await n(o)}catch(o){if(i++>ON)throw o;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ly()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kd._getInstance(TN()),this.receiver._subscribe("keyChanged",async(n,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(n,i)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await CN(),!this.activeServiceWorker)return;this.sender=new kN(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&n[0]?.fulfilled&&n[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(n){if(!(!this.sender||!this.activeServiceWorker||EN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const n=await tf();return await Yp(n,xd,"1"),await Kp(n,xd),!0}catch{}return!1}async _withPendingWrite(n){this.pendingWrites++;try{await n()}finally{this.pendingWrites--}}async _set(n,i){return this._withPendingWrite(async()=>(await this._withRetries(o=>Yp(o,n,i)),this.localCache[n]=i,this.notifyServiceWorker(n)))}async _get(n){const i=await this._withRetries(o=>MN(o,n));return this.localCache[n]=i,i}async _remove(n){return this._withPendingWrite(async()=>(await this._withRetries(i=>Kp(i,n)),delete this.localCache[n],this.notifyServiceWorker(n)))}async _poll(){const n=await this._withRetries(d=>{const h=Sd(d,!1).getAll();return new yo(h).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];const i=[],o=new Set;if(n.length!==0)for(const{fbase_key:d,value:h}of n)o.add(d),JSON.stringify(this.localCache[d])!==JSON.stringify(h)&&(this.notifyListeners(d,h),i.push(d));for(const d of Object.keys(this.localCache))this.localCache[d]&&!o.has(d)&&(this.notifyListeners(d,null),i.push(d));return i}notifyListeners(n,i){this.localCache[n]=i;const o=this.listeners[n];if(o)for(const d of Array.from(o))d(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(i)}_removeListener(n,i){this.listeners[n]&&(this.listeners[n].delete(i),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dy.type="LOCAL";const IN=Dy;new mo(3e4,6e4);function Uy(a,n){return n?ur(n):(Oe(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}class Tf extends kf{constructor(n){super("custom","custom"),this.params=n}_getIdTokenResponse(n){return Pi(n,this._buildIdpRequest())}_linkToIdToken(n,i){return Pi(n,this._buildIdpRequest(i))}_getReauthenticationResolver(n){return Pi(n,this._buildIdpRequest())}_buildIdpRequest(n){const i={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return n&&(i.idToken=n),i}}function DN(a){return Cy(a.auth,new Tf(a),a.bypassAuthState)}function UN(a){const{auth:n,user:i}=a;return Oe(i,n,"internal-error"),uN(i,new Tf(a),a.bypassAuthState)}async function BN(a){const{auth:n,user:i}=a;return Oe(i,n,"internal-error"),dN(i,new Tf(a),a.bypassAuthState)}class By{constructor(n,i,o,d,h=!1){this.auth=n,this.resolver=o,this.user=d,this.bypassAuthState=h,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(i)?i:[i]}execute(){return new Promise(async(n,i)=>{this.pendingPromise={resolve:n,reject:i};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(o){this.reject(o)}})}async onAuthEvent(n){const{urlResponse:i,sessionId:o,postBody:d,tenantId:h,error:g,type:p}=n;if(g){this.reject(g);return}const x={auth:this.auth,requestUri:i,sessionId:o,tenantId:h||void 0,postBody:d||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(x))}catch(b){this.reject(b)}}onError(n){this.reject(n)}getIdpTask(n){switch(n){case"signInViaPopup":case"signInViaRedirect":return DN;case"linkViaPopup":case"linkViaRedirect":return BN;case"reauthViaPopup":case"reauthViaRedirect":return UN;default:Wn(this.auth,"internal-error")}}resolve(n){pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(n),this.unregisterAndCleanUp()}reject(n){pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(n),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const zN=new mo(2e3,1e4);async function PN(a,n,i){if(yn(a.app))return Promise.reject(cs(a,"operation-not-supported-in-this-environment"));const o=la(a);xj(a,n,Cf);const d=Uy(o,i);return new Ua(o,"signInViaPopup",n,d).executeNotNull()}class Ua extends By{constructor(n,i,o,d,h){super(n,i,d,h),this.provider=o,this.authWindow=null,this.pollId=null,Ua.currentPopupAction&&Ua.currentPopupAction.cancel(),Ua.currentPopupAction=this}async executeNotNull(){const n=await this.execute();return Oe(n,this.auth,"internal-error"),n}async onExecution(){pr(this.filter.length===1,"Popup operations only handle one event");const n=Ef();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],n),this.authWindow.associatedEvent=n,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(cs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(cs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ua.currentPopupAction=null}pollUserCancellation(){const n=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(cs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(n,zN.get())};n()}}Ua.currentPopupAction=null;const HN="pendingRedirect",ld=new Map;class GN extends By{constructor(n,i,o=!1){super(n,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,o),this.eventId=null}async execute(){let n=ld.get(this.auth._key());if(!n){try{const o=await VN(this.resolver,this.auth)?await super.execute():null;n=()=>Promise.resolve(o)}catch(i){n=()=>Promise.reject(i)}ld.set(this.auth._key(),n)}return this.bypassAuthState||ld.set(this.auth._key(),()=>Promise.resolve(null)),n()}async onAuthEvent(n){if(n.type==="signInViaRedirect")return super.onAuthEvent(n);if(n.type==="unknown"){this.resolve(null);return}if(n.eventId){const i=await this.auth._redirectUserForId(n.eventId);if(i)return this.user=i,super.onAuthEvent(n);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VN(a,n){const i=WN(n),o=FN(a);if(!await o._isAvailable())return!1;const d=await o._get(i)==="true";return await o._remove(i),d}function $N(a,n){ld.set(a._key(),n)}function FN(a){return ur(a._redirectPersistence)}function WN(a){return id(HN,a.config.apiKey,a.name)}async function qN(a,n,i=!1){if(yn(a.app))return Promise.reject(fr(a));const o=la(a),d=Uy(o,n),g=await new GN(o,d,i).execute();return g&&!i&&(delete g.user._redirectEventId,await o._persistUserIfCurrent(g.user),await o._setRedirectUser(null,n)),g}const YN=600*1e3;class KN{constructor(n){this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(n){this.consumers.add(n),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,n)&&(this.sendToConsumer(this.queuedRedirectEvent,n),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(n){this.consumers.delete(n)}onEvent(n){if(this.hasEventBeenHandled(n))return!1;let i=!1;return this.consumers.forEach(o=>{this.isEventForConsumer(n,o)&&(i=!0,this.sendToConsumer(n,o),this.saveEventToCache(n))}),this.hasHandledPotentialRedirect||!XN(n)||(this.hasHandledPotentialRedirect=!0,i||(this.queuedRedirectEvent=n,i=!0)),i}sendToConsumer(n,i){if(n.error&&!zy(n)){const o=n.error.code?.split("auth/")[1]||"internal-error";i.onError(cs(this.auth,o))}else i.onAuthEvent(n)}isEventForConsumer(n,i){const o=i.eventId===null||!!n.eventId&&n.eventId===i.eventId;return i.filter.includes(n.type)&&o}hasEventBeenHandled(n){return Date.now()-this.lastProcessedEventTime>=YN&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xp(n))}saveEventToCache(n){this.cachedEventUids.add(Xp(n)),this.lastProcessedEventTime=Date.now()}}function Xp(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(n=>n).join("-")}function zy({type:a,error:n}){return a==="unknown"&&n?.code==="auth/no-auth-event"}function XN(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zy(a);default:return!1}}async function JN(a,n={}){return xr(a,"GET","/v1/projects",n)}const QN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZN=/^https?/;async function e4(a){if(a.config.emulator)return;const{authorizedDomains:n}=await JN(a);for(const i of n)try{if(t4(i))return}catch{}Wn(a,"unauthorized-domain")}function t4(a){const n=Qh(),{protocol:i,hostname:o}=new URL(n);if(a.startsWith("chrome-extension://")){const g=new URL(a);return g.hostname===""&&o===""?i==="chrome-extension:"&&a.replace("chrome-extension://","")===n.replace("chrome-extension://",""):i==="chrome-extension:"&&g.hostname===o}if(!ZN.test(i))return!1;if(QN.test(a))return o===a;const d=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(o)}const n4=new mo(3e4,6e4);function Jp(){const a=Us().___jsl;if(a?.H){for(const n of Object.keys(a.H))if(a.H[n].r=a.H[n].r||[],a.H[n].L=a.H[n].L||[],a.H[n].r=[...a.H[n].L],a.CP)for(let i=0;i<a.CP.length;i++)a.CP[i]=null}}function s4(a){return new Promise((n,i)=>{function o(){Jp(),gapi.load("gapi.iframes",{callback:()=>{n(gapi.iframes.getContext())},ontimeout:()=>{Jp(),i(cs(a,"network-request-failed"))},timeout:n4.get()})}if(Us().gapi?.iframes?.Iframe)n(gapi.iframes.getContext());else if(Us().gapi?.load)o();else{const d=Wj("iframefcb");return Us()[d]=()=>{gapi.load?o():i(cs(a,"network-request-failed"))},Ny(`${Fj()}?onload=${d}`).catch(h=>i(h))}}).catch(n=>{throw od=null,n})}let od=null;function r4(a){return od=od||s4(a),od}const a4=new mo(5e3,15e3),i4="__/auth/iframe",l4="emulator/auth/iframe",o4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function d4(a){const n=a.config;Oe(n.authDomain,a,"auth-domain-config-required");const i=n.emulator?jf(n,l4):`https://${a.config.authDomain}/${i4}`,o={apiKey:n.apiKey,appName:a.name,v:Ka},d=c4.get(a.config.apiHost);d&&(o.eid=d);const h=a._getFrameworks();return h.length&&(o.fw=h.join(",")),`${i}?${go(o).slice(1)}`}async function u4(a){const n=await r4(a),i=Us().gapi;return Oe(i,a,"internal-error"),n.open({where:document.body,url:d4(a),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o4,dontclear:!0},o=>new Promise(async(d,h)=>{await o.restyle({setHideOnLeave:!1});const g=cs(a,"network-request-failed"),p=Us().setTimeout(()=>{h(g)},a4.get());function x(){Us().clearTimeout(p),d(o)}o.ping(x).then(x,()=>{h(g)})}))}const h4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f4=500,g4=600,m4="_blank",p4="http://localhost";class Qp{constructor(n){this.window=n,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function x4(a,n,i,o=f4,d=g4){const h=Math.max((window.screen.availHeight-d)/2,0).toString(),g=Math.max((window.screen.availWidth-o)/2,0).toString();let p="";const x={...h4,width:o.toString(),height:d.toString(),top:h,left:g},b=dn().toLowerCase();i&&(p=py(b)?m4:i),gy(b)&&(n=n||p4,x.scrollbars="yes");const N=Object.entries(x).reduce((_,[I,L])=>`${_}${I}=${L},`,"");if(Dj(b)&&p!=="_self")return y4(n||"",p),new Qp(null);const j=window.open(n||"",p,N);Oe(j,a,"popup-blocked");try{j.focus()}catch{}return new Qp(j)}function y4(a,n){const i=document.createElement("a");i.href=a,i.target=n;const o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),i.dispatchEvent(o)}const b4="__/auth/handler",v4="emulator/auth/handler",w4=encodeURIComponent("fac");async function Zp(a,n,i,o,d,h){Oe(a.config.authDomain,a,"auth-domain-config-required"),Oe(a.config.apiKey,a,"invalid-api-key");const g={apiKey:a.config.apiKey,appName:a.name,authType:i,redirectUrl:o,v:Ka,eventId:d};if(n instanceof Cf){n.setDefaultLanguage(a.languageCode),g.providerId=n.providerId||"",sw(n.getCustomParameters())||(g.customParameters=JSON.stringify(n.getCustomParameters()));for(const[N,j]of Object.entries({}))g[N]=j}if(n instanceof xo){const N=n.getScopes().filter(j=>j!=="");N.length>0&&(g.scopes=N.join(","))}a.tenantId&&(g.tid=a.tenantId);const p=g;for(const N of Object.keys(p))p[N]===void 0&&delete p[N];const x=await a._getAppCheckToken(),b=x?`#${w4}=${encodeURIComponent(x)}`:"";return`${j4(a)}?${go(p).slice(1)}${b}`}function j4({config:a}){return a.emulator?jf(a,v4):`https://${a.authDomain}/${b4}`}const Bh="webStorageSupport";class N4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=My,this._completeRedirectFn=qN,this._overrideRedirectResult=$N}async _openPopup(n,i,o,d){pr(this.eventManagers[n._key()]?.manager,"_initialize() not called before _openPopup()");const h=await Zp(n,i,o,Qh(),d);return x4(n,h,Ef())}async _openRedirect(n,i,o,d){await this._originValidation(n);const h=await Zp(n,i,o,Qh(),d);return SN(h),new Promise(()=>{})}_initialize(n){const i=n._key();if(this.eventManagers[i]){const{manager:d,promise:h}=this.eventManagers[i];return d?Promise.resolve(d):(pr(h,"If manager is not set, promise should be"),h)}const o=this.initAndGetManager(n);return this.eventManagers[i]={promise:o},o.catch(()=>{delete this.eventManagers[i]}),o}async initAndGetManager(n){const i=await u4(n),o=new KN(n);return i.register("authEvent",d=>(Oe(d?.authEvent,n,"invalid-auth-event"),{status:o.onEvent(d.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[n._key()]={manager:o},this.iframes[n._key()]=i,o}_isIframeWebStorageSupported(n,i){this.iframes[n._key()].send(Bh,{type:Bh},d=>{const h=d?.[0]?.[Bh];h!==void 0&&i(!!h),Wn(n,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(n){const i=n._key();return this.originValidationPromises[i]||(this.originValidationPromises[i]=e4(n)),this.originValidationPromises[i]}get _shouldInitProactively(){return wy()||my()||_f()}}const _4=N4;var ex="@firebase/auth",tx="1.12.0";class k4{constructor(n){this.auth=n,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(n){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(n)}:null}addAuthTokenListener(n){if(this.assertAuthConfigured(),this.internalListeners.has(n))return;const i=this.auth.onIdTokenChanged(o=>{n(o?.stsTokenManager.accessToken||null)});this.internalListeners.set(n,i),this.updateProactiveRefresh()}removeAuthTokenListener(n){this.assertAuthConfigured();const i=this.internalListeners.get(n);i&&(this.internalListeners.delete(n),i(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function S4(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function C4(a){Va(new sa("auth",(n,{options:i})=>{const o=n.getProvider("app").getImmediate(),d=n.getProvider("heartbeat"),h=n.getProvider("app-check-internal"),{apiKey:g,authDomain:p}=o.options;Oe(g&&!g.includes(":"),"invalid-api-key",{appName:o.name});const x={apiKey:g,authDomain:p,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jy(a)},b=new Gj(o,d,h,x);return Qj(b,i),b},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,i,o)=>{n.getProvider("auth-internal").initialize()})),Va(new sa("auth-internal",n=>{const i=la(n.getProvider("auth").getImmediate());return(o=>new k4(o))(i)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ds(ex,tx,S4(a)),Ds(ex,tx,"esm2020")}const E4=300,T4=ey("authIdTokenMaxAge")||E4;let nx=null;const A4=a=>async n=>{const i=n&&await n.getIdTokenResult(),o=i&&(new Date().getTime()-Date.parse(i.issuedAtTime))/1e3;if(o&&o>T4)return;const d=i?.token;nx!==d&&(nx=d,await fetch(a,{method:d?"POST":"DELETE",headers:d?{Authorization:`Bearer ${d}`}:{}}))};function R4(a=bf()){const n=Nd(a,"auth");if(n.isInitialized())return n.getImmediate();const i=Jj(a,{popupRedirectResolver:_4,persistence:[IN,NN,My]}),o=ey("authTokenSyncURL");if(o&&typeof isSecureContext=="boolean"&&isSecureContext){const h=new URL(o,location.origin);if(location.origin===h.origin){const g=A4(h.toString());yN(i,g,()=>g(i.currentUser)),xN(i,p=>g(p))}}const d=Jx("auth");return d&&Zj(i,`http://${d}`),i}function M4(){return document.getElementsByTagName("head")?.[0]??document}Vj({loadJS(a){return new Promise((n,i)=>{const o=document.createElement("script");o.setAttribute("src",a),o.onload=n,o.onerror=d=>{const h=cs("internal-error");h.customData=d,i(h)},o.type="text/javascript",o.charset="UTF-8",M4().appendChild(o)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});C4("Browser");const Py="firebasestorage.googleapis.com",Hy="storageBucket",L4=120*1e3,O4=600*1e3;class St extends Ps{constructor(n,i,o=0){super(zh(n),`Firebase Storage: ${i} (${zh(n)})`),this.status_=o,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,St.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return zh(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kt;(function(a){a.UNKNOWN="unknown",a.OBJECT_NOT_FOUND="object-not-found",a.BUCKET_NOT_FOUND="bucket-not-found",a.PROJECT_NOT_FOUND="project-not-found",a.QUOTA_EXCEEDED="quota-exceeded",a.UNAUTHENTICATED="unauthenticated",a.UNAUTHORIZED="unauthorized",a.UNAUTHORIZED_APP="unauthorized-app",a.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",a.INVALID_CHECKSUM="invalid-checksum",a.CANCELED="canceled",a.INVALID_EVENT_NAME="invalid-event-name",a.INVALID_URL="invalid-url",a.INVALID_DEFAULT_BUCKET="invalid-default-bucket",a.NO_DEFAULT_BUCKET="no-default-bucket",a.CANNOT_SLICE_BLOB="cannot-slice-blob",a.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",a.NO_DOWNLOAD_URL="no-download-url",a.INVALID_ARGUMENT="invalid-argument",a.INVALID_ARGUMENT_COUNT="invalid-argument-count",a.APP_DELETED="app-deleted",a.INVALID_ROOT_OPERATION="invalid-root-operation",a.INVALID_FORMAT="invalid-format",a.INTERNAL_ERROR="internal-error",a.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kt||(kt={}));function zh(a){return"storage/"+a}function Af(){const a="An unknown error occurred, please check the error payload for server response.";return new St(kt.UNKNOWN,a)}function I4(a){return new St(kt.OBJECT_NOT_FOUND,"Object '"+a+"' does not exist.")}function D4(a){return new St(kt.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function U4(){const a="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new St(kt.UNAUTHENTICATED,a)}function B4(){return new St(kt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function z4(a){return new St(kt.UNAUTHORIZED,"User does not have permission to access '"+a+"'.")}function P4(){return new St(kt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function H4(){return new St(kt.CANCELED,"User canceled the upload/download.")}function G4(a){return new St(kt.INVALID_URL,"Invalid URL '"+a+"'.")}function V4(a){return new St(kt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+a+"'.")}function $4(){return new St(kt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Hy+"' property when initializing the app?")}function F4(){return new St(kt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function W4(){return new St(kt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function q4(a){return new St(kt.UNSUPPORTED_ENVIRONMENT,`${a} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function nf(a){return new St(kt.INVALID_ARGUMENT,a)}function Gy(){return new St(kt.APP_DELETED,"The Firebase app was deleted.")}function Y4(a){return new St(kt.INVALID_ROOT_OPERATION,"The operation '"+a+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function eo(a,n){return new St(kt.INVALID_FORMAT,"String does not match format '"+a+"': "+n)}function Kl(a){throw new St(kt.INTERNAL_ERROR,"Internal error: "+a)}class An{constructor(n,i){this.bucket=n,this.path_=i}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,i){let o;try{o=An.makeFromUrl(n,i)}catch{return new An(n,"")}if(o.path==="")return o;throw V4(n)}static makeFromUrl(n,i){let o=null;const d="([A-Za-z0-9.\\-_]+)";function h(X){X.path.charAt(X.path.length-1)==="/"&&(X.path_=X.path_.slice(0,-1))}const g="(/(.*))?$",p=new RegExp("^gs://"+d+g,"i"),x={bucket:1,path:3};function b(X){X.path_=decodeURIComponent(X.path)}const N="v[A-Za-z0-9_]+",j=i.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",I=new RegExp(`^https?://${j}/${N}/b/${d}/o${_}`,"i"),L={bucket:1,path:3},T=i===Py?"(?:storage.googleapis.com|storage.cloud.google.com)":i,U="([^?#]*)",P=new RegExp(`^https?://${T}/${d}/${U}`,"i"),G=[{regex:p,indices:x,postModify:h},{regex:I,indices:L,postModify:b},{regex:P,indices:{bucket:1,path:2},postModify:b}];for(let X=0;X<G.length;X++){const se=G[X],te=se.regex.exec(n);if(te){const R=te[se.indices.bucket];let k=te[se.indices.path];k||(k=""),o=new An(R,k),se.postModify(o);break}}if(o==null)throw G4(n);return o}}class K4{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}function X4(a,n,i){let o=1,d=null,h=null,g=!1,p=0;function x(){return p===2}let b=!1;function N(...U){b||(b=!0,n.apply(null,U))}function j(U){d=setTimeout(()=>{d=null,a(I,x())},U)}function _(){h&&clearTimeout(h)}function I(U,...P){if(b){_();return}if(U){_(),N.call(null,U,...P);return}if(x()||g){_(),N.call(null,U,...P);return}o<64&&(o*=2);let G;p===1?(p=2,G=0):G=(o+Math.random())*1e3,j(G)}let L=!1;function T(U){L||(L=!0,_(),!b&&(d!==null?(U||(p=2),clearTimeout(d),j(0)):U||(p=1)))}return j(0),h=setTimeout(()=>{g=!0,T(!0)},i),T}function J4(a){a(!1)}function Q4(a){return a!==void 0}function Z4(a){return typeof a=="object"&&!Array.isArray(a)}function Rf(a){return typeof a=="string"||a instanceof String}function sx(a){return Mf()&&a instanceof Blob}function Mf(){return typeof Blob<"u"}function rx(a,n,i,o){if(o<n)throw nf(`Invalid value for '${a}'. Expected ${n} or greater.`);if(o>i)throw nf(`Invalid value for '${a}'. Expected ${i} or less.`)}function Lf(a,n,i){let o=n;return i==null&&(o=`https://${n}`),`${i}://${o}/v0${a}`}function Vy(a){const n=encodeURIComponent;let i="?";for(const o in a)if(a.hasOwnProperty(o)){const d=n(o)+"="+n(a[o]);i=i+d+"&"}return i=i.slice(0,-1),i}var za;(function(a){a[a.NO_ERROR=0]="NO_ERROR",a[a.NETWORK_ERROR=1]="NETWORK_ERROR",a[a.ABORT=2]="ABORT"})(za||(za={}));function e5(a,n){const i=a>=500&&a<600,d=[408,429].indexOf(a)!==-1,h=n.indexOf(a)!==-1;return i||d||h}class t5{constructor(n,i,o,d,h,g,p,x,b,N,j,_=!0,I=!1){this.url_=n,this.method_=i,this.headers_=o,this.body_=d,this.successCodes_=h,this.additionalRetryCodes_=g,this.callback_=p,this.errorCallback_=x,this.timeout_=b,this.progressCallback_=N,this.connectionFactory_=j,this.retry=_,this.isUsingEmulator=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((L,T)=>{this.resolve_=L,this.reject_=T,this.start_()})}start_(){const n=(o,d)=>{if(d){o(!1,new Kc(!1,null,!0));return}const h=this.connectionFactory_();this.pendingConnection_=h;const g=p=>{const x=p.loaded,b=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(x,b)};this.progressCallback_!==null&&h.addUploadProgressListener(g),h.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&h.removeUploadProgressListener(g),this.pendingConnection_=null;const p=h.getErrorCode()===za.NO_ERROR,x=h.getStatus();if(!p||e5(x,this.additionalRetryCodes_)&&this.retry){const N=h.getErrorCode()===za.ABORT;o(!1,new Kc(!1,null,N));return}const b=this.successCodes_.indexOf(x)!==-1;o(!0,new Kc(b,h))})},i=(o,d)=>{const h=this.resolve_,g=this.reject_,p=d.connection;if(d.wasSuccessCode)try{const x=this.callback_(p,p.getResponse());Q4(x)?h(x):h()}catch(x){g(x)}else if(p!==null){const x=Af();x.serverResponse=p.getErrorText(),this.errorCallback_?g(this.errorCallback_(p,x)):g(x)}else if(d.canceled){const x=this.appDelete_?Gy():H4();g(x)}else{const x=P4();g(x)}};this.canceled_?i(!1,new Kc(!1,null,!0)):this.backoffId_=X4(n,i,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,this.backoffId_!==null&&J4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Kc{constructor(n,i,o){this.wasSuccessCode=n,this.connection=i,this.canceled=!!o}}function n5(a,n){n!==null&&n.length>0&&(a.Authorization="Firebase "+n)}function s5(a,n){a["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}function r5(a,n){n&&(a["X-Firebase-GMPID"]=n)}function a5(a,n){n!==null&&(a["X-Firebase-AppCheck"]=n)}function i5(a,n,i,o,d,h,g=!0,p=!1){const x=Vy(a.urlParams),b=a.url+x,N=Object.assign({},a.headers);return r5(N,n),n5(N,i),s5(N,h),a5(N,o),new t5(b,a.method,N,a.body,a.successCodes,a.additionalRetryCodes,a.handler,a.errorHandler,a.timeout,a.progressCallback,d,g,p)}function l5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function o5(...a){const n=l5();if(n!==void 0){const i=new n;for(let o=0;o<a.length;o++)i.append(a[o]);return i.getBlob()}else{if(Mf())return new Blob(a);throw new St(kt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function c5(a,n,i){return a.webkitSlice?a.webkitSlice(n,i):a.mozSlice?a.mozSlice(n,i):a.slice?a.slice(n,i):null}function d5(a){if(typeof atob>"u")throw q4("base-64");return atob(a)}const Os={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ph{constructor(n,i){this.data=n,this.contentType=i||null}}function u5(a,n){switch(a){case Os.RAW:return new Ph($y(n));case Os.BASE64:case Os.BASE64URL:return new Ph(Fy(a,n));case Os.DATA_URL:return new Ph(f5(n),g5(n))}throw Af()}function $y(a){const n=[];for(let i=0;i<a.length;i++){let o=a.charCodeAt(i);if(o<=127)n.push(o);else if(o<=2047)n.push(192|o>>6,128|o&63);else if((o&64512)===55296)if(!(i<a.length-1&&(a.charCodeAt(i+1)&64512)===56320))n.push(239,191,189);else{const h=o,g=a.charCodeAt(++i);o=65536|(h&1023)<<10|g&1023,n.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63)}else(o&64512)===56320?n.push(239,191,189):n.push(224|o>>12,128|o>>6&63,128|o&63)}return new Uint8Array(n)}function h5(a){let n;try{n=decodeURIComponent(a)}catch{throw eo(Os.DATA_URL,"Malformed data URL.")}return $y(n)}function Fy(a,n){switch(a){case Os.BASE64:{const d=n.indexOf("-")!==-1,h=n.indexOf("_")!==-1;if(d||h)throw eo(a,"Invalid character '"+(d?"-":"_")+"' found: is it base64url encoded?");break}case Os.BASE64URL:{const d=n.indexOf("+")!==-1,h=n.indexOf("/")!==-1;if(d||h)throw eo(a,"Invalid character '"+(d?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{i=d5(n)}catch(d){throw d.message.includes("polyfill")?d:eo(a,"Invalid character found")}const o=new Uint8Array(i.length);for(let d=0;d<i.length;d++)o[d]=i.charCodeAt(d);return o}class Wy{constructor(n){this.base64=!1,this.contentType=null;const i=n.match(/^data:([^,]+)?,/);if(i===null)throw eo(Os.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const o=i[1]||null;o!=null&&(this.base64=m5(o,";base64"),this.contentType=this.base64?o.substring(0,o.length-7):o),this.rest=n.substring(n.indexOf(",")+1)}}function f5(a){const n=new Wy(a);return n.base64?Fy(Os.BASE64,n.rest):h5(n.rest)}function g5(a){return new Wy(a).contentType}function m5(a,n){return a.length>=n.length?a.substring(a.length-n.length)===n:!1}class ea{constructor(n,i){let o=0,d="";sx(n)?(this.data_=n,o=n.size,d=n.type):n instanceof ArrayBuffer?(i?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),o=this.data_.length):n instanceof Uint8Array&&(i?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),o=n.length),this.size_=o,this.type_=d}size(){return this.size_}type(){return this.type_}slice(n,i){if(sx(this.data_)){const o=this.data_,d=c5(o,n,i);return d===null?null:new ea(d)}else{const o=new Uint8Array(this.data_.buffer,n,i-n);return new ea(o,!0)}}static getBlob(...n){if(Mf()){const i=n.map(o=>o instanceof ea?o.data_:o);return new ea(o5.apply(null,i))}else{const i=n.map(g=>Rf(g)?u5(Os.RAW,g).data:g.data_);let o=0;i.forEach(g=>{o+=g.byteLength});const d=new Uint8Array(o);let h=0;return i.forEach(g=>{for(let p=0;p<g.length;p++)d[h++]=g[p]}),new ea(d,!0)}}uploadData(){return this.data_}}function qy(a){let n;try{n=JSON.parse(a)}catch{return null}return Z4(n)?n:null}function p5(a){if(a.length===0)return null;const n=a.lastIndexOf("/");return n===-1?"":a.slice(0,n)}function x5(a,n){const i=n.split("/").filter(o=>o.length>0).join("/");return a.length===0?i:a+"/"+i}function Yy(a){const n=a.lastIndexOf("/",a.length-2);return n===-1?a:a.slice(n+1)}function y5(a,n){return n}class ln{constructor(n,i,o,d){this.server=n,this.local=i||n,this.writable=!!o,this.xform=d||y5}}let Xc=null;function b5(a){return!Rf(a)||a.length<2?a:Yy(a)}function Ky(){if(Xc)return Xc;const a=[];a.push(new ln("bucket")),a.push(new ln("generation")),a.push(new ln("metageneration")),a.push(new ln("name","fullPath",!0));function n(h,g){return b5(g)}const i=new ln("name");i.xform=n,a.push(i);function o(h,g){return g!==void 0?Number(g):g}const d=new ln("size");return d.xform=o,a.push(d),a.push(new ln("timeCreated")),a.push(new ln("updated")),a.push(new ln("md5Hash",null,!0)),a.push(new ln("cacheControl",null,!0)),a.push(new ln("contentDisposition",null,!0)),a.push(new ln("contentEncoding",null,!0)),a.push(new ln("contentLanguage",null,!0)),a.push(new ln("contentType",null,!0)),a.push(new ln("metadata","customMetadata",!0)),Xc=a,Xc}function v5(a,n){function i(){const o=a.bucket,d=a.fullPath,h=new An(o,d);return n._makeStorageReference(h)}Object.defineProperty(a,"ref",{get:i})}function w5(a,n,i){const o={};o.type="file";const d=i.length;for(let h=0;h<d;h++){const g=i[h];o[g.local]=g.xform(o,n[g.server])}return v5(o,a),o}function Xy(a,n,i){const o=qy(n);return o===null?null:w5(a,o,i)}function j5(a,n,i,o){const d=qy(n);if(d===null||!Rf(d.downloadTokens))return null;const h=d.downloadTokens;if(h.length===0)return null;const g=encodeURIComponent;return h.split(",").map(b=>{const N=a.bucket,j=a.fullPath,_="/b/"+g(N)+"/o/"+g(j),I=Lf(_,i,o),L=Vy({alt:"media",token:b});return I+L})[0]}function N5(a,n){const i={},o=n.length;for(let d=0;d<o;d++){const h=n[d];h.writable&&(i[h.server]=a[h.local])}return JSON.stringify(i)}class Jy{constructor(n,i,o,d){this.url=n,this.method=i,this.handler=o,this.timeout=d,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Qy(a){if(!a)throw Af()}function _5(a,n){function i(o,d){const h=Xy(a,d,n);return Qy(h!==null),h}return i}function k5(a,n){function i(o,d){const h=Xy(a,d,n);return Qy(h!==null),j5(h,d,a.host,a._protocol)}return i}function Zy(a){function n(i,o){let d;return i.getStatus()===401?i.getErrorText().includes("Firebase App Check token is invalid")?d=B4():d=U4():i.getStatus()===402?d=D4(a.bucket):i.getStatus()===403?d=z4(a.path):d=o,d.status=i.getStatus(),d.serverResponse=o.serverResponse,d}return n}function S5(a){const n=Zy(a);function i(o,d){let h=n(o,d);return o.getStatus()===404&&(h=I4(a.path)),h.serverResponse=d.serverResponse,h}return i}function C5(a,n,i){const o=n.fullServerUrl(),d=Lf(o,a.host,a._protocol),h="GET",g=a.maxOperationRetryTime,p=new Jy(d,h,k5(a,i),g);return p.errorHandler=S5(n),p}function E5(a,n){return a&&a.contentType||n&&n.type()||"application/octet-stream"}function T5(a,n,i){const o=Object.assign({},i);return o.fullPath=a.path,o.size=n.size(),o.contentType||(o.contentType=E5(null,n)),o}function A5(a,n,i,o,d){const h=n.bucketOnlyServerUrl(),g={"X-Goog-Upload-Protocol":"multipart"};function p(){let G="";for(let X=0;X<2;X++)G=G+Math.random().toString().slice(2);return G}const x=p();g["Content-Type"]="multipart/related; boundary="+x;const b=T5(n,o,d),N=N5(b,i),j="--"+x+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+N+`\r
--`+x+`\r
Content-Type: `+b.contentType+`\r
\r
`,_=`\r
--`+x+"--",I=ea.getBlob(j,o,_);if(I===null)throw F4();const L={name:b.fullPath},T=Lf(h,a.host,a._protocol),U="POST",P=a.maxUploadRetryTime,z=new Jy(T,U,_5(a,i),P);return z.urlParams=L,z.headers=g,z.body=I.uploadData(),z.errorHandler=Zy(n),z}class R5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=za.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=za.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=za.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,i,o,d,h){if(this.sent_)throw Kl("cannot .send() more than once");if(Ya(n)&&o&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(i,n,!0),h!==void 0)for(const g in h)h.hasOwnProperty(g)&&this.xhr_.setRequestHeader(g,h[g].toString());return d!==void 0?this.xhr_.send(d):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Kl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Kl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Kl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Kl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",n)}}class M5 extends R5{initXhr(){this.xhr_.responseType="text"}}function eb(){return new M5}class Wa{constructor(n,i){this._service=n,i instanceof An?this._location=i:this._location=An.makeFromUrl(i,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,i){return new Wa(n,i)}get root(){const n=new An(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Yy(this._location.path)}get storage(){return this._service}get parent(){const n=p5(this._location.path);if(n===null)return null;const i=new An(this._location.bucket,n);return new Wa(this._service,i)}_throwIfRoot(n){if(this._location.path==="")throw Y4(n)}}function L5(a,n,i){a._throwIfRoot("uploadBytes");const o=A5(a.storage,a._location,Ky(),new ea(n,!0),i);return a.storage.makeRequestWithTokens(o,eb).then(d=>({metadata:d,ref:a}))}function O5(a){a._throwIfRoot("getDownloadURL");const n=C5(a.storage,a._location,Ky());return a.storage.makeRequestWithTokens(n,eb).then(i=>{if(i===null)throw W4();return i})}function I5(a,n){const i=x5(a._location.path,n),o=new An(a._location.bucket,i);return new Wa(a.storage,o)}function D5(a){return/^[A-Za-z]+:\/\//.test(a)}function U5(a,n){return new Wa(a,n)}function tb(a,n){if(a instanceof Of){const i=a;if(i._bucket==null)throw $4();const o=new Wa(i,i._bucket);return n!=null?tb(o,n):o}else return n!==void 0?I5(a,n):a}function B5(a,n){if(n&&D5(n)){if(a instanceof Of)return U5(a,n);throw nf("To use ref(service, url), the first argument must be a Storage instance.")}else return tb(a,n)}function ax(a,n){const i=n?.[Hy];return i==null?null:An.makeFromBucketSpec(i,a)}function z5(a,n,i,o={}){a.host=`${n}:${i}`;const d=Ya(n);d&&(mf(`https://${a.host}/b`),pf("Storage",!0)),a._isUsingEmulator=!0,a._protocol=d?"https":"http";const{mockUserToken:h}=o;h&&(a._overrideAuthToken=typeof h=="string"?h:ty(h,a.app.options.projectId))}class Of{constructor(n,i,o,d,h,g=!1){this.app=n,this._authProvider=i,this._appCheckProvider=o,this._url=d,this._firebaseVersion=h,this._isUsingEmulator=g,this._bucket=null,this._host=Py,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=L4,this._maxUploadRetryTime=O4,this._requests=new Set,d!=null?this._bucket=An.makeFromBucketSpec(d,this._host):this._bucket=ax(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._url!=null?this._bucket=An.makeFromBucketSpec(this._url,n):this._bucket=ax(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){rx("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){rx("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const n=this._authProvider.getImmediate({optional:!0});if(n){const i=await n.getToken();if(i!==null)return i.accessToken}return null}async _getAppCheckToken(){if(yn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=this._appCheckProvider.getImmediate({optional:!0});return n?(await n.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new Wa(this,n)}_makeRequest(n,i,o,d,h=!0){if(this._deleted)return new K4(Gy());{const g=i5(n,this._appId,o,d,i,this._firebaseVersion,h,this._isUsingEmulator);return this._requests.add(g),g.getPromise().then(()=>this._requests.delete(g),()=>this._requests.delete(g)),g}}async makeRequestWithTokens(n,i){const[o,d]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(n,i,o,d).getPromise()}}const ix="@firebase/storage",lx="0.14.0";const nb="storage";function P5(a,n,i){return a=bn(a),L5(a,n,i)}function H5(a){return a=bn(a),O5(a)}function G5(a,n){return a=bn(a),B5(a,n)}function V5(a=bf(),n){a=bn(a);const o=Nd(a,nb).getImmediate({identifier:n}),d=Qx("storage");return d&&$5(o,...d),o}function $5(a,n,i,o={}){z5(a,n,i,o)}function F5(a,{instanceIdentifier:n}){const i=a.getProvider("app").getImmediate(),o=a.getProvider("auth-internal"),d=a.getProvider("app-check-internal");return new Of(i,o,d,n,Ka)}function W5(){Va(new sa(nb,F5,"PUBLIC").setMultipleInstances(!0)),Ds(ix,lx,""),Ds(ix,lx,"esm2020")}W5();var q5="firebase",Y5="12.7.0";Ds(q5,Y5,"app");var ox=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var If;(function(){var a;function n(R,k){function E(){}E.prototype=k.prototype,R.F=k.prototype,R.prototype=new E,R.prototype.constructor=R,R.D=function(S,A,B){for(var O=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)O[ye-2]=arguments[ye];return k.prototype[A].apply(S,O)}}function i(){this.blockSize=-1}function o(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}n(o,i),o.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function d(R,k,E){E||(E=0);const S=Array(16);if(typeof k=="string")for(var A=0;A<16;++A)S[A]=k.charCodeAt(E++)|k.charCodeAt(E++)<<8|k.charCodeAt(E++)<<16|k.charCodeAt(E++)<<24;else for(A=0;A<16;++A)S[A]=k[E++]|k[E++]<<8|k[E++]<<16|k[E++]<<24;k=R.g[0],E=R.g[1],A=R.g[2];let B=R.g[3],O;O=k+(B^E&(A^B))+S[0]+3614090360&4294967295,k=E+(O<<7&4294967295|O>>>25),O=B+(A^k&(E^A))+S[1]+3905402710&4294967295,B=k+(O<<12&4294967295|O>>>20),O=A+(E^B&(k^E))+S[2]+606105819&4294967295,A=B+(O<<17&4294967295|O>>>15),O=E+(k^A&(B^k))+S[3]+3250441966&4294967295,E=A+(O<<22&4294967295|O>>>10),O=k+(B^E&(A^B))+S[4]+4118548399&4294967295,k=E+(O<<7&4294967295|O>>>25),O=B+(A^k&(E^A))+S[5]+1200080426&4294967295,B=k+(O<<12&4294967295|O>>>20),O=A+(E^B&(k^E))+S[6]+2821735955&4294967295,A=B+(O<<17&4294967295|O>>>15),O=E+(k^A&(B^k))+S[7]+4249261313&4294967295,E=A+(O<<22&4294967295|O>>>10),O=k+(B^E&(A^B))+S[8]+1770035416&4294967295,k=E+(O<<7&4294967295|O>>>25),O=B+(A^k&(E^A))+S[9]+2336552879&4294967295,B=k+(O<<12&4294967295|O>>>20),O=A+(E^B&(k^E))+S[10]+4294925233&4294967295,A=B+(O<<17&4294967295|O>>>15),O=E+(k^A&(B^k))+S[11]+2304563134&4294967295,E=A+(O<<22&4294967295|O>>>10),O=k+(B^E&(A^B))+S[12]+1804603682&4294967295,k=E+(O<<7&4294967295|O>>>25),O=B+(A^k&(E^A))+S[13]+4254626195&4294967295,B=k+(O<<12&4294967295|O>>>20),O=A+(E^B&(k^E))+S[14]+2792965006&4294967295,A=B+(O<<17&4294967295|O>>>15),O=E+(k^A&(B^k))+S[15]+1236535329&4294967295,E=A+(O<<22&4294967295|O>>>10),O=k+(A^B&(E^A))+S[1]+4129170786&4294967295,k=E+(O<<5&4294967295|O>>>27),O=B+(E^A&(k^E))+S[6]+3225465664&4294967295,B=k+(O<<9&4294967295|O>>>23),O=A+(k^E&(B^k))+S[11]+643717713&4294967295,A=B+(O<<14&4294967295|O>>>18),O=E+(B^k&(A^B))+S[0]+3921069994&4294967295,E=A+(O<<20&4294967295|O>>>12),O=k+(A^B&(E^A))+S[5]+3593408605&4294967295,k=E+(O<<5&4294967295|O>>>27),O=B+(E^A&(k^E))+S[10]+38016083&4294967295,B=k+(O<<9&4294967295|O>>>23),O=A+(k^E&(B^k))+S[15]+3634488961&4294967295,A=B+(O<<14&4294967295|O>>>18),O=E+(B^k&(A^B))+S[4]+3889429448&4294967295,E=A+(O<<20&4294967295|O>>>12),O=k+(A^B&(E^A))+S[9]+568446438&4294967295,k=E+(O<<5&4294967295|O>>>27),O=B+(E^A&(k^E))+S[14]+3275163606&4294967295,B=k+(O<<9&4294967295|O>>>23),O=A+(k^E&(B^k))+S[3]+4107603335&4294967295,A=B+(O<<14&4294967295|O>>>18),O=E+(B^k&(A^B))+S[8]+1163531501&4294967295,E=A+(O<<20&4294967295|O>>>12),O=k+(A^B&(E^A))+S[13]+2850285829&4294967295,k=E+(O<<5&4294967295|O>>>27),O=B+(E^A&(k^E))+S[2]+4243563512&4294967295,B=k+(O<<9&4294967295|O>>>23),O=A+(k^E&(B^k))+S[7]+1735328473&4294967295,A=B+(O<<14&4294967295|O>>>18),O=E+(B^k&(A^B))+S[12]+2368359562&4294967295,E=A+(O<<20&4294967295|O>>>12),O=k+(E^A^B)+S[5]+4294588738&4294967295,k=E+(O<<4&4294967295|O>>>28),O=B+(k^E^A)+S[8]+2272392833&4294967295,B=k+(O<<11&4294967295|O>>>21),O=A+(B^k^E)+S[11]+1839030562&4294967295,A=B+(O<<16&4294967295|O>>>16),O=E+(A^B^k)+S[14]+4259657740&4294967295,E=A+(O<<23&4294967295|O>>>9),O=k+(E^A^B)+S[1]+2763975236&4294967295,k=E+(O<<4&4294967295|O>>>28),O=B+(k^E^A)+S[4]+1272893353&4294967295,B=k+(O<<11&4294967295|O>>>21),O=A+(B^k^E)+S[7]+4139469664&4294967295,A=B+(O<<16&4294967295|O>>>16),O=E+(A^B^k)+S[10]+3200236656&4294967295,E=A+(O<<23&4294967295|O>>>9),O=k+(E^A^B)+S[13]+681279174&4294967295,k=E+(O<<4&4294967295|O>>>28),O=B+(k^E^A)+S[0]+3936430074&4294967295,B=k+(O<<11&4294967295|O>>>21),O=A+(B^k^E)+S[3]+3572445317&4294967295,A=B+(O<<16&4294967295|O>>>16),O=E+(A^B^k)+S[6]+76029189&4294967295,E=A+(O<<23&4294967295|O>>>9),O=k+(E^A^B)+S[9]+3654602809&4294967295,k=E+(O<<4&4294967295|O>>>28),O=B+(k^E^A)+S[12]+3873151461&4294967295,B=k+(O<<11&4294967295|O>>>21),O=A+(B^k^E)+S[15]+530742520&4294967295,A=B+(O<<16&4294967295|O>>>16),O=E+(A^B^k)+S[2]+3299628645&4294967295,E=A+(O<<23&4294967295|O>>>9),O=k+(A^(E|~B))+S[0]+4096336452&4294967295,k=E+(O<<6&4294967295|O>>>26),O=B+(E^(k|~A))+S[7]+1126891415&4294967295,B=k+(O<<10&4294967295|O>>>22),O=A+(k^(B|~E))+S[14]+2878612391&4294967295,A=B+(O<<15&4294967295|O>>>17),O=E+(B^(A|~k))+S[5]+4237533241&4294967295,E=A+(O<<21&4294967295|O>>>11),O=k+(A^(E|~B))+S[12]+1700485571&4294967295,k=E+(O<<6&4294967295|O>>>26),O=B+(E^(k|~A))+S[3]+2399980690&4294967295,B=k+(O<<10&4294967295|O>>>22),O=A+(k^(B|~E))+S[10]+4293915773&4294967295,A=B+(O<<15&4294967295|O>>>17),O=E+(B^(A|~k))+S[1]+2240044497&4294967295,E=A+(O<<21&4294967295|O>>>11),O=k+(A^(E|~B))+S[8]+1873313359&4294967295,k=E+(O<<6&4294967295|O>>>26),O=B+(E^(k|~A))+S[15]+4264355552&4294967295,B=k+(O<<10&4294967295|O>>>22),O=A+(k^(B|~E))+S[6]+2734768916&4294967295,A=B+(O<<15&4294967295|O>>>17),O=E+(B^(A|~k))+S[13]+1309151649&4294967295,E=A+(O<<21&4294967295|O>>>11),O=k+(A^(E|~B))+S[4]+4149444226&4294967295,k=E+(O<<6&4294967295|O>>>26),O=B+(E^(k|~A))+S[11]+3174756917&4294967295,B=k+(O<<10&4294967295|O>>>22),O=A+(k^(B|~E))+S[2]+718787259&4294967295,A=B+(O<<15&4294967295|O>>>17),O=E+(B^(A|~k))+S[9]+3951481745&4294967295,R.g[0]=R.g[0]+k&4294967295,R.g[1]=R.g[1]+(A+(O<<21&4294967295|O>>>11))&4294967295,R.g[2]=R.g[2]+A&4294967295,R.g[3]=R.g[3]+B&4294967295}o.prototype.v=function(R,k){k===void 0&&(k=R.length);const E=k-this.blockSize,S=this.C;let A=this.h,B=0;for(;B<k;){if(A==0)for(;B<=E;)d(this,R,B),B+=this.blockSize;if(typeof R=="string"){for(;B<k;)if(S[A++]=R.charCodeAt(B++),A==this.blockSize){d(this,S),A=0;break}}else for(;B<k;)if(S[A++]=R[B++],A==this.blockSize){d(this,S),A=0;break}}this.h=A,this.o+=k},o.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var k=1;k<R.length-8;++k)R[k]=0;k=this.o*8;for(var E=R.length-8;E<R.length;++E)R[E]=k&255,k/=256;for(this.v(R),R=Array(16),k=0,E=0;E<4;++E)for(let S=0;S<32;S+=8)R[k++]=this.g[E]>>>S&255;return R};function h(R,k){var E=p;return Object.prototype.hasOwnProperty.call(E,R)?E[R]:E[R]=k(R)}function g(R,k){this.h=k;const E=[];let S=!0;for(let A=R.length-1;A>=0;A--){const B=R[A]|0;S&&B==k||(E[A]=B,S=!1)}this.g=E}var p={};function x(R){return-128<=R&&R<128?h(R,function(k){return new g([k|0],k<0?-1:0)}):new g([R|0],R<0?-1:0)}function b(R){if(isNaN(R)||!isFinite(R))return j;if(R<0)return U(b(-R));const k=[];let E=1;for(let S=0;R>=E;S++)k[S]=R/E|0,E*=4294967296;return new g(k,0)}function N(R,k){if(R.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(R.charAt(0)=="-")return U(N(R.substring(1),k));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=b(Math.pow(k,8));let S=j;for(let B=0;B<R.length;B+=8){var A=Math.min(8,R.length-B);const O=parseInt(R.substring(B,B+A),k);A<8?(A=b(Math.pow(k,A)),S=S.j(A).add(b(O))):(S=S.j(E),S=S.add(b(O)))}return S}var j=x(0),_=x(1),I=x(16777216);a=g.prototype,a.m=function(){if(T(this))return-U(this).m();let R=0,k=1;for(let E=0;E<this.g.length;E++){const S=this.i(E);R+=(S>=0?S:4294967296+S)*k,k*=4294967296}return R},a.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(L(this))return"0";if(T(this))return"-"+U(this).toString(R);const k=b(Math.pow(R,6));var E=this;let S="";for(;;){const A=X(E,k).g;E=P(E,A.j(k));let B=((E.g.length>0?E.g[0]:E.h)>>>0).toString(R);if(E=A,L(E))return B+S;for(;B.length<6;)B="0"+B;S=B+S}},a.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function L(R){if(R.h!=0)return!1;for(let k=0;k<R.g.length;k++)if(R.g[k]!=0)return!1;return!0}function T(R){return R.h==-1}a.l=function(R){return R=P(this,R),T(R)?-1:L(R)?0:1};function U(R){const k=R.g.length,E=[];for(let S=0;S<k;S++)E[S]=~R.g[S];return new g(E,~R.h).add(_)}a.abs=function(){return T(this)?U(this):this},a.add=function(R){const k=Math.max(this.g.length,R.g.length),E=[];let S=0;for(let A=0;A<=k;A++){let B=S+(this.i(A)&65535)+(R.i(A)&65535),O=(B>>>16)+(this.i(A)>>>16)+(R.i(A)>>>16);S=O>>>16,B&=65535,O&=65535,E[A]=O<<16|B}return new g(E,E[E.length-1]&-2147483648?-1:0)};function P(R,k){return R.add(U(k))}a.j=function(R){if(L(this)||L(R))return j;if(T(this))return T(R)?U(this).j(U(R)):U(U(this).j(R));if(T(R))return U(this.j(U(R)));if(this.l(I)<0&&R.l(I)<0)return b(this.m()*R.m());const k=this.g.length+R.g.length,E=[];for(var S=0;S<2*k;S++)E[S]=0;for(S=0;S<this.g.length;S++)for(let A=0;A<R.g.length;A++){const B=this.i(S)>>>16,O=this.i(S)&65535,ye=R.i(A)>>>16,ue=R.i(A)&65535;E[2*S+2*A]+=O*ue,z(E,2*S+2*A),E[2*S+2*A+1]+=B*ue,z(E,2*S+2*A+1),E[2*S+2*A+1]+=O*ye,z(E,2*S+2*A+1),E[2*S+2*A+2]+=B*ye,z(E,2*S+2*A+2)}for(R=0;R<k;R++)E[R]=E[2*R+1]<<16|E[2*R];for(R=k;R<2*k;R++)E[R]=0;return new g(E,0)};function z(R,k){for(;(R[k]&65535)!=R[k];)R[k+1]+=R[k]>>>16,R[k]&=65535,k++}function G(R,k){this.g=R,this.h=k}function X(R,k){if(L(k))throw Error("division by zero");if(L(R))return new G(j,j);if(T(R))return k=X(U(R),k),new G(U(k.g),U(k.h));if(T(k))return k=X(R,U(k)),new G(U(k.g),k.h);if(R.g.length>30){if(T(R)||T(k))throw Error("slowDivide_ only works with positive integers.");for(var E=_,S=k;S.l(R)<=0;)E=se(E),S=se(S);var A=te(E,1),B=te(S,1);for(S=te(S,2),E=te(E,2);!L(S);){var O=B.add(S);O.l(R)<=0&&(A=A.add(E),B=O),S=te(S,1),E=te(E,1)}return k=P(R,A.j(k)),new G(A,k)}for(A=j;R.l(k)>=0;){for(E=Math.max(1,Math.floor(R.m()/k.m())),S=Math.ceil(Math.log(E)/Math.LN2),S=S<=48?1:Math.pow(2,S-48),B=b(E),O=B.j(k);T(O)||O.l(R)>0;)E-=S,B=b(E),O=B.j(k);L(B)&&(B=_),A=A.add(B),R=P(R,O)}return new G(A,R)}a.B=function(R){return X(this,R).h},a.and=function(R){const k=Math.max(this.g.length,R.g.length),E=[];for(let S=0;S<k;S++)E[S]=this.i(S)&R.i(S);return new g(E,this.h&R.h)},a.or=function(R){const k=Math.max(this.g.length,R.g.length),E=[];for(let S=0;S<k;S++)E[S]=this.i(S)|R.i(S);return new g(E,this.h|R.h)},a.xor=function(R){const k=Math.max(this.g.length,R.g.length),E=[];for(let S=0;S<k;S++)E[S]=this.i(S)^R.i(S);return new g(E,this.h^R.h)};function se(R){const k=R.g.length+1,E=[];for(let S=0;S<k;S++)E[S]=R.i(S)<<1|R.i(S-1)>>>31;return new g(E,R.h)}function te(R,k){const E=k>>5;k%=32;const S=R.g.length-E,A=[];for(let B=0;B<S;B++)A[B]=k>0?R.i(B+E)>>>k|R.i(B+E+1)<<32-k:R.i(B+E);return new g(A,R.h)}o.prototype.digest=o.prototype.A,o.prototype.reset=o.prototype.u,o.prototype.update=o.prototype.v,g.prototype.add=g.prototype.add,g.prototype.multiply=g.prototype.j,g.prototype.modulo=g.prototype.B,g.prototype.compare=g.prototype.l,g.prototype.toNumber=g.prototype.m,g.prototype.toString=g.prototype.toString,g.prototype.getBits=g.prototype.i,g.fromNumber=b,g.fromString=N,If=g}).apply(typeof ox<"u"?ox:typeof self<"u"?self:typeof window<"u"?window:{});var Jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var a,n=Object.defineProperty;function i(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jc=="object"&&Jc];for(var m=0;m<c.length;++m){var v=c[m];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var o=i(this);function d(c,m){if(m)e:{var v=o;c=c.split(".");for(var M=0;M<c.length-1;M++){var J=c[M];if(!(J in v))break e;v=v[J]}c=c[c.length-1],M=v[c],m=m(M),m!=M&&m!=null&&n(v,c,{configurable:!0,writable:!0,value:m})}}d("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),d("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),d("Object.entries",function(c){return c||function(m){var v=[],M;for(M in m)Object.prototype.hasOwnProperty.call(m,M)&&v.push([M,m[M]]);return v}});var h=h||{},g=this||self;function p(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function x(c,m,v){return c.call.apply(c.bind,arguments)}function b(c,m,v){return b=x,b.apply(null,arguments)}function N(c,m){var v=Array.prototype.slice.call(arguments,1);return function(){var M=v.slice();return M.push.apply(M,arguments),c.apply(this,M)}}function j(c,m){function v(){}v.prototype=m.prototype,c.Z=m.prototype,c.prototype=new v,c.prototype.constructor=c,c.Ob=function(M,J,re){for(var be=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)be[ze-2]=arguments[ze];return m.prototype[J].apply(M,be)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function I(c){const m=c.length;if(m>0){const v=Array(m);for(let M=0;M<m;M++)v[M]=c[M];return v}return[]}function L(c,m){for(let M=1;M<arguments.length;M++){const J=arguments[M];var v=typeof J;if(v=v!="object"?v:J?Array.isArray(J)?"array":v:"null",v=="array"||v=="object"&&typeof J.length=="number"){v=c.length||0;const re=J.length||0;c.length=v+re;for(let be=0;be<re;be++)c[v+be]=J[be]}else c.push(J)}}class T{constructor(m,v){this.i=m,this.j=v,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function U(c){g.setTimeout(()=>{throw c},0)}function P(){var c=R;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class z{constructor(){this.h=this.g=null}add(m,v){const M=G.get();M.set(m,v),this.h?this.h.next=M:this.g=M,this.h=M}}var G=new T(()=>new X,c=>c.reset());class X{constructor(){this.next=this.g=this.h=null}set(m,v){this.h=m,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let se,te=!1,R=new z,k=()=>{const c=Promise.resolve(void 0);se=()=>{c.then(E)}};function E(){for(var c;c=P();){try{c.h.call(c.g)}catch(v){U(v)}var m=G;m.j(c),m.h<100&&(m.h++,c.next=m.g,m.g=c)}te=!1}function S(){this.u=this.u,this.C=this.C}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!g.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};g.addEventListener("test",v,m),g.removeEventListener("test",v,m)}catch{}return c})();function O(c){return/^[\s\xa0]*$/.test(c)}function ye(c,m){A.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,m)}j(ye,A),ye.prototype.init=function(c,m){const v=this.type=c.type,M=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget,m||(v=="mouseover"?m=c.fromElement:v=="mouseout"&&(m=c.toElement)),this.relatedTarget=m,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&ye.Z.h.call(this)},ye.prototype.h=function(){ye.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),V=0;function ie(c,m,v,M,J){this.listener=c,this.proxy=null,this.src=m,this.type=v,this.capture=!!M,this.ha=J,this.key=++V,this.da=this.fa=!1}function K(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function oe(c,m,v){for(const M in c)m.call(v,c[M],M,c)}function me(c,m){for(const v in c)m.call(void 0,c[v],v,c)}function D(c){const m={};for(const v in c)m[v]=c[v];return m}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(c,m){let v,M;for(let J=1;J<arguments.length;J++){M=arguments[J];for(v in M)c[v]=M[v];for(let re=0;re<F.length;re++)v=F[re],Object.prototype.hasOwnProperty.call(M,v)&&(c[v]=M[v])}}function q(c){this.src=c,this.g={},this.h=0}q.prototype.add=function(c,m,v,M,J){const re=c.toString();c=this.g[re],c||(c=this.g[re]=[],this.h++);const be=xe(c,m,M,J);return be>-1?(m=c[be],v||(m.fa=!1)):(m=new ie(m,this.src,re,!!M,J),m.fa=v,c.push(m)),m};function Q(c,m){const v=m.type;if(v in c.g){var M=c.g[v],J=Array.prototype.indexOf.call(M,m,void 0),re;(re=J>=0)&&Array.prototype.splice.call(M,J,1),re&&(K(m),c.g[v].length==0&&(delete c.g[v],c.h--))}}function xe(c,m,v,M){for(let J=0;J<c.length;++J){const re=c[J];if(!re.da&&re.listener==m&&re.capture==!!v&&re.ha==M)return J}return-1}var pe="closure_lm_"+(Math.random()*1e6|0),_e={};function Te(c,m,v,M,J){if(Array.isArray(m)){for(let re=0;re<m.length;re++)Te(c,m[re],v,M,J);return null}return v=Ae(v),c&&c[ue]?c.J(m,v,p(M)?!!M.capture:!1,J):Ve(c,m,v,!1,M,J)}function Ve(c,m,v,M,J,re){if(!m)throw Error("Invalid event type");const be=p(J)?!!J.capture:!!J;let ze=Ee(c);if(ze||(c[pe]=ze=new q(c)),v=ze.add(m,v,M,be,re),v.proxy)return v;if(M=Ie(),v.proxy=M,M.src=c,M.listener=v,c.addEventListener)B||(J=be),J===void 0&&(J=!1),c.addEventListener(m.toString(),M,J);else if(c.attachEvent)c.attachEvent(we(m.toString()),M);else if(c.addListener&&c.removeListener)c.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Ie(){function c(v){return m.call(c.src,c.listener,v)}const m=je;return c}function Ye(c,m,v,M,J){if(Array.isArray(m))for(var re=0;re<m.length;re++)Ye(c,m[re],v,M,J);else M=p(M)?!!M.capture:!!M,v=Ae(v),c&&c[ue]?(c=c.i,re=String(m).toString(),re in c.g&&(m=c.g[re],v=xe(m,v,M,J),v>-1&&(K(m[v]),Array.prototype.splice.call(m,v,1),m.length==0&&(delete c.g[re],c.h--)))):c&&(c=Ee(c))&&(m=c.g[m.toString()],c=-1,m&&(c=xe(m,v,M,J)),(v=c>-1?m[c]:null)&&xt(v))}function xt(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[ue])Q(m.i,c);else{var v=c.type,M=c.proxy;m.removeEventListener?m.removeEventListener(v,M,c.capture):m.detachEvent?m.detachEvent(we(v),M):m.addListener&&m.removeListener&&m.removeListener(M),(v=Ee(m))?(Q(v,c),v.h==0&&(v.src=null,m[pe]=null)):K(c)}}}function we(c){return c in _e?_e[c]:_e[c]="on"+c}function je(c,m){if(c.da)c=!0;else{m=new ye(m,this);const v=c.listener,M=c.ha||c.src;c.fa&&xt(c),c=v.call(M,m)}return c}function Ee(c){return c=c[pe],c instanceof q?c:null}var ke="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ae(c){return typeof c=="function"?c:(c[ke]||(c[ke]=function(m){return c.handleEvent(m)}),c[ke])}function Ce(){S.call(this),this.i=new q(this),this.M=this,this.G=null}j(Ce,S),Ce.prototype[ue]=!0,Ce.prototype.removeEventListener=function(c,m,v,M){Ye(this,c,m,v,M)};function Be(c,m){var v,M=c.G;if(M)for(v=[];M;M=M.G)v.push(M);if(c=c.M,M=m.type||m,typeof m=="string")m=new A(m,c);else if(m instanceof A)m.target=m.target||c;else{var J=m;m=new A(M,c),W(m,J)}J=!0;let re,be;if(v)for(be=v.length-1;be>=0;be--)re=m.g=v[be],J=Vt(re,M,!0,m)&&J;if(re=m.g=c,J=Vt(re,M,!0,m)&&J,J=Vt(re,M,!1,m)&&J,v)for(be=0;be<v.length;be++)re=m.g=v[be],J=Vt(re,M,!1,m)&&J}Ce.prototype.N=function(){if(Ce.Z.N.call(this),this.i){var c=this.i;for(const m in c.g){const v=c.g[m];for(let M=0;M<v.length;M++)K(v[M]);delete c.g[m],c.h--}}this.G=null},Ce.prototype.J=function(c,m,v,M){return this.i.add(String(c),m,!1,v,M)},Ce.prototype.K=function(c,m,v,M){return this.i.add(String(c),m,!0,v,M)};function Vt(c,m,v,M){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();let J=!0;for(let re=0;re<m.length;++re){const be=m[re];if(be&&!be.da&&be.capture==v){const ze=be.listener,Et=be.ha||be.src;be.fa&&Q(c.i,be),J=ze.call(Et,M)!==!1&&J}}return J&&!M.defaultPrevented}function ge(c,m){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=b(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:g.setTimeout(c,m||0)}function fe(c){c.g=ge(()=>{c.g=null,c.i&&(c.i=!1,fe(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class ve extends S{constructor(m,v){super(),this.m=m,this.l=v,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:fe(this)}N(){super.N(),this.g&&(g.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Me(c){S.call(this),this.h=c,this.g={}}j(Me,S);var de=[];function De(c){oe(c.g,function(m,v){this.g.hasOwnProperty(v)&&xt(m)},c),c.g={}}Me.prototype.N=function(){Me.Z.N.call(this),De(this)},Me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ze=g.JSON.stringify,Mn=g.JSON.parse,qt=class{stringify(c){return g.JSON.stringify(c,void 0)}parse(c){return g.JSON.parse(c,void 0)}};function tn(){}function rt(){}var Ct={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Yt(){A.call(this,"d")}j(Yt,A);function Ln(){A.call(this,"c")}j(Ln,A);var Rt={},wo=null;function qi(){return wo=wo||new Ce}Rt.Ia="serverreachability";function jo(c){A.call(this,Rt.Ia,c)}j(jo,A);function hs(c){const m=qi();Be(m,new jo(m))}Rt.STAT_EVENT="statevent";function oa(c,m){A.call(this,Rt.STAT_EVENT,c),this.stat=m}j(oa,A);function Mt(c){const m=qi();Be(m,new oa(m,c))}Rt.Ja="timingevent";function fs(c,m){A.call(this,Rt.Ja,c),this.size=m}j(fs,A);function gs(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return g.setTimeout(function(){c()},m)}function Kn(){this.g=!0}Kn.prototype.ua=function(){this.g=!1};function Cd(c,m,v,M,J,re){c.info(function(){if(c.g)if(re){var be="",ze=re.split("&");for(let it=0;it<ze.length;it++){var Et=ze[it].split("=");if(Et.length>1){const wt=Et[0];Et=Et[1];const sn=wt.split("_");be=sn.length>=2&&sn[1]=="type"?be+(wt+"="+Et+"&"):be+(wt+"=redacted&")}}}else be=null;else be=re;return"XMLHTTP REQ ("+M+") [attempt "+J+"]: "+m+`
`+v+`
`+be})}function No(c,m,v,M,J,re,be){c.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+J+"]: "+m+`
`+v+`
`+re+" "+be})}function ms(c,m,v,M){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+Ed(c,v)+(M?" "+M:"")})}function ca(c,m){c.info(function(){return"TIMEOUT: "+m})}Kn.prototype.info=function(){};function Ed(c,m){if(!c.g)return m;if(!m)return null;try{const re=JSON.parse(m);if(re){for(c=0;c<re.length;c++)if(Array.isArray(re[c])){var v=re[c];if(!(v.length<2)){var M=v[1];if(Array.isArray(M)&&!(M.length<1)){var J=M[0];if(J!="noop"&&J!="stop"&&J!="close")for(let be=1;be<M.length;be++)M[be]=""}}}}return Ze(re)}catch{return m}}var Xa={NO_ERROR:0,TIMEOUT:8},_o={},Yi;function da(){}j(da,tn),da.prototype.g=function(){return new XMLHttpRequest},Yi=new da;function Hs(c){return encodeURIComponent(String(c))}function ko(c){var m=1;c=c.split(":");const v=[];for(;m>0&&c.length;)v.push(c.shift()),m--;return c.length&&v.push(c.join(":")),v}function Xn(c,m,v,M){this.j=c,this.i=m,this.l=v,this.S=M||1,this.V=new Me(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Jn}function Jn(){this.i=null,this.g="",this.h=!1}var Lt={},$t={};function ps(c,m,v){c.M=1,c.A=ua(It(m)),c.u=v,c.R=!0,Ja(c,null)}function Ja(c,m){c.F=Date.now(),xs(c),c.B=It(c.A);var v=c.B,M=c.S;Array.isArray(M)||(M=[String(M)]),ti(v.i,"t",M),c.C=0,v=c.j.L,c.h=new Jn,c.g=Po(c.j,v?m:null,!c.u),c.P>0&&(c.O=new ve(b(c.Y,c,c.g),c.P)),m=c.V,v=c.g,M=c.ba;var J="readystatechange";Array.isArray(J)||(J&&(de[0]=J.toString()),J=de);for(let re=0;re<J.length;re++){const be=Te(v,J[re],M||m.handleEvent,!1,m.h||m);if(!be)break;m.g[be.key]=be}m=c.J?D(c.J):{},c.u?(c.v||(c.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,m)):(c.v="GET",c.g.ea(c.B,c.v,null,m)),hs(),Cd(c.i,c.v,c.B,c.l,c.S,c.u)}Xn.prototype.ba=function(c){c=c.target;const m=this.O;m&&es(c)==3?m.j():this.Y(c)},Xn.prototype.Y=function(c){try{if(c==this.g)e:{const ze=es(this.g),Et=this.g.ya(),it=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||Kt(this.g)))){this.K||ze!=4||Et==7||(Et==8||it<=0?hs(3):hs(2)),ys(this);var m=this.g.ca();this.X=m;var v=Td(this);if(this.o=m==200,No(this.i,this.v,this.B,this.l,this.S,ze,m),this.o){if(this.U&&!this.L){t:{if(this.g){var M,J=this.g;if((M=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(M)){var re=M;break t}}re=null}if(c=re)ms(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bs(this,c);else{this.o=!1,this.m=3,Mt(12),vn(this),On(this);break e}}if(this.R){c=!0;let wt;for(;!this.K&&this.C<v.length;)if(wt=Co(this,v),wt==$t){ze==4&&(this.m=4,Mt(14),c=!1),ms(this.i,this.l,null,"[Incomplete Response]");break}else if(wt==Lt){this.m=4,Mt(15),ms(this.i,this.l,v,"[Invalid Chunk]"),c=!1;break}else ms(this.i,this.l,wt,null),bs(this,wt);if(So(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||v.length!=0||this.h.h||(this.m=1,Mt(16),c=!1),this.o=this.o&&c,!c)ms(this.i,this.l,v,"[Invalid Chunked Response]"),vn(this),On(this);else if(v.length>0&&!this.W){this.W=!0;var be=this.j;be.g==this&&be.aa&&!be.P&&(be.j.info("Great, no buffering proxy detected. Bytes received: "+v.length),cl(be),be.P=!0,Mt(11))}}else ms(this.i,this.l,v,null),bs(this,v);ze==4&&vn(this),this.o&&!this.K&&(ze==4?Do(this.j,this):(this.o=!1,xs(this)))}else Vs(this.g),m==400&&v.indexOf("Unknown SID")>0?(this.m=3,Mt(12)):(this.m=0,Mt(13)),vn(this),On(this)}}}catch{}};function Td(c){if(!So(c))return c.g.la();const m=Kt(c.g);if(m==="")return"";let v="";const M=m.length,J=es(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return vn(c),On(c),"";c.h.i=new g.TextDecoder}for(let re=0;re<M;re++)c.h.h=!0,v+=c.h.i.decode(m[re],{stream:!(J&&re==M-1)});return m.length=0,c.h.g+=v,c.C=0,c.h.g}function So(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Co(c,m){var v=c.C,M=m.indexOf(`
`,v);return M==-1?$t:(v=Number(m.substring(v,M)),isNaN(v)?Lt:(M+=1,M+v>m.length?$t:(m=m.slice(M,M+v),c.C=M+v,m)))}Xn.prototype.cancel=function(){this.K=!0,vn(this)};function xs(c){c.T=Date.now()+c.H,Qa(c,c.H)}function Qa(c,m){if(c.D!=null)throw Error("WatchDog timer not null");c.D=gs(b(c.aa,c),m)}function ys(c){c.D&&(g.clearTimeout(c.D),c.D=null)}Xn.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ca(this.i,this.B),this.M!=2&&(hs(),Mt(17)),vn(this),this.m=2,On(this)):Qa(this,this.T-c)};function On(c){c.j.I==0||c.K||Do(c.j,c)}function vn(c){ys(c);var m=c.O;m&&typeof m.dispose=="function"&&m.dispose(),c.O=null,De(c.V),c.g&&(m=c.g,c.g=null,m.abort(),m.dispose())}function bs(c,m){try{var v=c.j;if(v.I!=0&&(v.g==c||ws(v.h,c))){if(!c.L&&ws(v.h,c)&&v.I==3){try{var M=v.Ba.g.parse(m)}catch{M=null}if(Array.isArray(M)&&M.length==3){var J=M;if(J[0]==0){e:if(!v.v){if(v.g)if(v.g.F+3e3<c.F)ii(v),kr(v);else break e;ya(v),Mt(18)}}else v.xa=J[1],0<v.xa-v.K&&J[2]<37500&&v.F&&v.A==0&&!v.C&&(v.C=gs(b(v.Va,v),6e3));vs(v.h)<=1&&v.ta&&(v.ta=void 0)}else Cs(v,11)}else if((c.L||v.g==c)&&ii(v),!O(m))for(J=v.Ba.g.parse(m),m=0;m<J.length;m++){let it=J[m];const wt=it[0];if(!(wt<=v.K))if(v.K=wt,it=it[1],v.I==2)if(it[0]=="c"){v.M=it[1],v.ba=it[2];const sn=it[3];sn!=null&&(v.ka=sn,v.j.info("VER="+v.ka));const $s=it[4];$s!=null&&(v.za=$s,v.j.info("SVER="+v.za));const ts=it[5];ts!=null&&typeof ts=="number"&&ts>0&&(M=1.5*ts,v.O=M,v.j.info("backChannelRequestTimeoutMs_="+M)),M=v;const ns=c.g;if(ns){const ba=ns.g?ns.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ba){var re=M.h;re.g||ba.indexOf("spdy")==-1&&ba.indexOf("quic")==-1&&ba.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(Ji(re,re.h),re.h=null))}if(M.G){const li=ns.g?ns.g.getResponseHeader("X-HTTP-Session-Id"):null;li&&(M.wa=li,at(M.J,M.G,li))}}v.I=3,v.l&&v.l.ra(),v.aa&&(v.T=Date.now()-c.F,v.j.info("Handshake RTT: "+v.T+"ms")),M=v;var be=c;if(M.na=zo(M,M.L?M.ba:null,M.W),be.L){Qi(M.h,be);var ze=be,Et=M.O;Et&&(ze.H=Et),ze.D&&(ys(ze),xs(ze)),M.g=be}else Oo(M);v.i.length>0&&Ss(v)}else it[0]!="stop"&&it[0]!="close"||Cs(v,7);else v.I==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?Cs(v,7):ll(v):it[0]!="noop"&&v.l&&v.l.qa(it),v.A=0)}}hs(4)}catch{}}var Ot=class{constructor(c,m){this.g=c,this.map=m}};function Ki(c){this.l=c||10,g.PerformanceNavigationTiming?(c=g.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(g.chrome&&g.chrome.loadTimes&&g.chrome.loadTimes()&&g.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xi(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function vs(c){return c.h?1:c.g?c.g.size:0}function ws(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function Ji(c,m){c.g?c.g.add(m):c.h=m}function Qi(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}Ki.prototype.cancel=function(){if(this.i=Zi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Zi(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const v of c.g.values())m=m.concat(v.G);return m}return I(c.i)}var Eo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Za(c,m){if(c){c=c.split("&");for(let v=0;v<c.length;v++){const M=c[v].indexOf("=");let J,re=null;M>=0?(J=c[v].substring(0,M),re=c[v].substring(M+1)):J=c[v],m(J,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function wn(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;c instanceof wn?(this.l=c.l,Ft(this,c.j),this.o=c.o,this.g=c.g,yr(this,c.u),this.h=c.h,el(this,Mo(c.i)),this.m=c.m):c&&(m=String(c).match(Eo))?(this.l=!1,Ft(this,m[1]||"",!0),this.o=js(m[2]||""),this.g=js(m[3]||"",!0),yr(this,m[4]),this.h=js(m[5]||"",!0),el(this,m[6]||"",!0),this.m=js(m[7]||"")):(this.l=!1,this.i=new vr(null,this.l))}wn.prototype.toString=function(){const c=[];var m=this.j;m&&c.push(ha(m,ei,!0),":");var v=this.g;return(v||m=="file")&&(c.push("//"),(m=this.o)&&c.push(ha(m,ei,!0),"@"),c.push(Hs(v).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.u,v!=null&&c.push(":",String(v))),(v=this.h)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(ha(v,v.charAt(0)=="/"?tl:To,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",ha(v,Ao)),c.join("")},wn.prototype.resolve=function(c){const m=It(this);let v=!!c.j;v?Ft(m,c.j):v=!!c.o,v?m.o=c.o:v=!!c.g,v?m.g=c.g:v=c.u!=null;var M=c.h;if(v)yr(m,c.u);else if(v=!!c.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var J=m.h.lastIndexOf("/");J!=-1&&(M=m.h.slice(0,J+1)+M)}if(J=M,J==".."||J==".")M="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){M=J.lastIndexOf("/",0)==0,J=J.split("/");const re=[];for(let be=0;be<J.length;){const ze=J[be++];ze=="."?M&&be==J.length&&re.push(""):ze==".."?((re.length>1||re.length==1&&re[0]!="")&&re.pop(),M&&be==J.length&&re.push("")):(re.push(ze),M=!0)}M=re.join("/")}else M=J}return v?m.h=M:v=c.i.toString()!=="",v?el(m,Mo(c.i)):v=!!c.m,v&&(m.m=c.m),m};function It(c){return new wn(c)}function Ft(c,m,v){c.j=v?js(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function yr(c,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);c.u=m}else c.u=null}function el(c,m,v){m instanceof vr?(c.i=m,ni(c.i,c.l)):(v||(m=ha(m,br)),c.i=new vr(m,c.l))}function at(c,m,v){c.i.set(m,v)}function ua(c){return at(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function js(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ha(c,m,v){return typeof c=="string"?(c=encodeURI(c).replace(m,un),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function un(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ei=/[#\/\?@]/g,To=/[#\?:]/g,tl=/[#\?]/g,br=/[#\?@]/g,Ao=/#/g;function vr(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function hn(c){c.g||(c.g=new Map,c.h=0,c.i&&Za(c.i,function(m,v){c.add(decodeURIComponent(m.replace(/\+/g," ")),v)}))}a=vr.prototype,a.add=function(c,m){hn(this),this.i=null,c=wr(this,c);let v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(m),this.h+=1,this};function Ro(c,m){hn(c),m=wr(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function nl(c,m){return hn(c),m=wr(c,m),c.g.has(m)}a.forEach=function(c,m){hn(this),this.g.forEach(function(v,M){v.forEach(function(J){c.call(m,J,M,this)},this)},this)};function sl(c,m){hn(c);let v=[];if(typeof m=="string")nl(c,m)&&(v=v.concat(c.g.get(wr(c,m))));else for(c=Array.from(c.g.values()),m=0;m<c.length;m++)v=v.concat(c[m]);return v}a.set=function(c,m){return hn(this),this.i=null,c=wr(this,c),nl(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},a.get=function(c,m){return c?(c=sl(this,c),c.length>0?String(c[0]):m):m};function ti(c,m,v){Ro(c,m),v.length>0&&(c.i=null,c.g.set(wr(c,m),I(v)),c.h+=v.length)}a.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(let M=0;M<m.length;M++){var v=m[M];const J=Hs(v);v=sl(this,v);for(let re=0;re<v.length;re++){let be=J;v[re]!==""&&(be+="="+Hs(v[re])),c.push(be)}}return this.i=c.join("&")};function Mo(c){const m=new vr;return m.i=c.i,c.g&&(m.g=new Map(c.g),m.h=c.h),m}function wr(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function ni(c,m){m&&!c.j&&(hn(c),c.i=null,c.g.forEach(function(v,M){const J=M.toLowerCase();M!=J&&(Ro(this,M),ti(this,J,v))},c)),c.j=m}function Qn(c,m){const v=new Kn;if(g.Image){const M=new Image;M.onload=N(In,v,"TestLoadImage: loaded",!0,m,M),M.onerror=N(In,v,"TestLoadImage: error",!1,m,M),M.onabort=N(In,v,"TestLoadImage: abort",!1,m,M),M.ontimeout=N(In,v,"TestLoadImage: timeout",!1,m,M),g.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=c}else m(!1)}function rl(c,m){const v=new Kn,M=new AbortController,J=setTimeout(()=>{M.abort(),In(v,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:M.signal}).then(re=>{clearTimeout(J),re.ok?In(v,"TestPingServer: ok",!0,m):In(v,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(J),In(v,"TestPingServer: error",!1,m)})}function In(c,m,v,M,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),M(v)}catch{}}function jr(){this.g=new qt}function Ns(c){this.i=c.Sb||null,this.h=c.ab||!1}j(Ns,tn),Ns.prototype.g=function(){return new fa(this.i,this.h)};function fa(c,m){Ce.call(this),this.H=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}j(fa,Ce),a=fa.prototype,a.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=m,this.readyState=1,Zn(this)},a.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(m.body=c),(this.H||g).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},a.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Nr(this)),this.readyState=0},a.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Zn(this)),this.g&&(this.readyState=3,Zn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof g.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;si(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function si(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}a.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?Nr(this):Zn(this),this.readyState==3&&si(this)}},a.Oa=function(c){this.g&&(this.response=this.responseText=c,Nr(this))},a.Na=function(c){this.g&&(this.response=c,Nr(this))},a.ga=function(){this.g&&Nr(this)};function Nr(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Zn(c)}a.setRequestHeader=function(c,m){this.A.append(c,m)},a.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},a.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var v=m.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=m.next();return c.join(`\r
`)};function Zn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(fa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Dn(c){let m="";return oe(c,function(v,M){m+=M,m+=":",m+=v,m+=`\r
`}),m}function ga(c,m,v){e:{for(M in v){var M=!1;break e}M=!0}M||(v=Dn(v),typeof c=="string"?v!=null&&Hs(v):at(c,m,v))}function ht(c){Ce.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}j(ht,Ce);var _s=/^https?$/i,al=["POST","PUT"];a=ht.prototype,a.Fa=function(c){this.H=c},a.ea=function(c,m,v,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Yi.g(),this.g.onreadystatechange=_(b(this.Ca,this));try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(re){ma(this,re);return}if(c=v||"",v=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var J in M)v.set(J,M[J]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const re of M.keys())v.set(re,M.get(re));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(v.keys()).find(re=>re.toLowerCase()=="content-type"),J=g.FormData&&c instanceof g.FormData,!(Array.prototype.indexOf.call(al,m,void 0)>=0)||M||J||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,be]of v)this.g.setRequestHeader(re,be);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(re){ma(this,re)}};function ma(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.o=5,il(c),Gs(c)}function il(c){c.A||(c.A=!0,Be(c,"complete"),Be(c,"error"))}a.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Be(this,"complete"),Be(this,"abort"),Gs(this))},a.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gs(this,!0)),ht.Z.N.call(this)},a.Ca=function(){this.u||(this.B||this.v||this.j?pa(this):this.Xa())},a.Xa=function(){pa(this)};function pa(c){if(c.h&&typeof h<"u"){if(c.v&&es(c)==4)setTimeout(c.Ca.bind(c),0);else if(Be(c,"readystatechange"),es(c)==4){c.h=!1;try{const re=c.ca();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var v;if(!(v=m)){var M;if(M=re===0){let be=String(c.D).match(Eo)[1]||null;!be&&g.self&&g.self.location&&(be=g.self.location.protocol.slice(0,-1)),M=!_s.test(be?be.toLowerCase():"")}v=M}if(v)Be(c,"complete"),Be(c,"success");else{c.o=6;try{var J=es(c)>2?c.g.statusText:""}catch{J=""}c.l=J+" ["+c.ca()+"]",il(c)}}finally{Gs(c)}}}}function Gs(c,m){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const v=c.g;c.g=null,m||Be(c,"ready");try{v.onreadystatechange=null}catch{}}}a.isActive=function(){return!!this.g};function es(c){return c.g?c.g.readyState:0}a.ca=function(){try{return es(this)>2?this.g.status:-1}catch{return-1}},a.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},a.La=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),Mn(m)}};function Kt(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Vs(c){const m={};c=(c.g&&es(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<c.length;M++){if(O(c[M]))continue;var v=ko(c[M]);const J=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const re=m[J]||[];m[J]=re,re.push(v)}me(m,function(M){return M.join(", ")})}a.ya=function(){return this.o},a.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ks(c,m,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||m}function _r(c){this.za=0,this.i=[],this.j=new Kn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ks("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ks("baseRetryDelayMs",5e3,c),this.Za=ks("retryDelaySeedMs",1e4,c),this.Ta=ks("forwardChannelMaxRetries",2,c),this.va=ks("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Ki(c&&c.concurrentRequestLimit),this.Ba=new jr,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}a=_r.prototype,a.ka=8,a.I=1,a.connect=function(c,m,v,M){Mt(0),this.W=c,this.H=m||{},v&&M!==void 0&&(this.H.OSID=v,this.H.OAID=M),this.F=this.X,this.J=zo(this,null,this.W),Ss(this)};function ll(c){if(ri(c),c.I==3){var m=c.V++,v=It(c.J);if(at(v,"SID",c.M),at(v,"RID",m),at(v,"TYPE","terminate"),xa(c,v),m=new Xn(c,c.j,m),m.M=2,m.A=ua(It(v)),v=!1,g.navigator&&g.navigator.sendBeacon)try{v=g.navigator.sendBeacon(m.A.toString(),"")}catch{}!v&&g.Image&&(new Image().src=m.A,v=!0),v||(m.g=Po(m.j,null),m.g.ea(m.A)),m.F=Date.now(),xs(m)}Bo(c)}function kr(c){c.g&&(cl(c),c.g.cancel(),c.g=null)}function ri(c){kr(c),c.v&&(g.clearTimeout(c.v),c.v=null),ii(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&g.clearTimeout(c.m),c.m=null)}function Ss(c){if(!Xi(c.h)&&!c.m){c.m=!0;var m=c.Ea;se||k(),te||(se(),te=!0),R.add(m,c),c.D=0}}function ai(c,m){return vs(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=m.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=gs(b(c.Ea,c,m),Uo(c,c.D)),c.D++,!0)}a.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const J=new Xn(this,this.j,c);let re=this.o;if(this.U&&(re?(re=D(re),W(re,this.U)):re=this.U),this.u!==null||this.R||(J.J=re,re=null),this.S)e:{for(var m=0,v=0;v<this.i.length;v++){t:{var M=this.i[v];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(m+=M,m>4096){m=v;break e}if(m===4096||v===this.i.length-1){m=v+1;break e}}m=1e3}else m=1e3;m=Lo(this,J,m),v=It(this.J),at(v,"RID",c),at(v,"CVER",22),this.G&&at(v,"X-HTTP-Session-Id",this.G),xa(this,v),re&&(this.R?m="headers="+Hs(Dn(re))+"&"+m:this.u&&ga(v,this.u,re)),Ji(this.h,J),this.Ra&&at(v,"TYPE","init"),this.S?(at(v,"$req",m),at(v,"SID","null"),J.U=!0,ps(J,v,null)):ps(J,v,m),this.I=2}}else this.I==3&&(c?ol(this,c):this.i.length==0||Xi(this.h)||ol(this))};function ol(c,m){var v;m?v=m.l:v=c.V++;const M=It(c.J);at(M,"SID",c.M),at(M,"RID",v),at(M,"AID",c.K),xa(c,M),c.u&&c.o&&ga(M,c.u,c.o),v=new Xn(c,c.j,v,c.D+1),c.u===null&&(v.J=c.o),m&&(c.i=m.G.concat(c.i)),m=Lo(c,v,1e3),v.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Ji(c.h,v),ps(v,M,m)}function xa(c,m){c.H&&oe(c.H,function(v,M){at(m,M,v)}),c.l&&oe({},function(v,M){at(m,M,v)})}function Lo(c,m,v){v=Math.min(c.i.length,v);const M=c.l?b(c.l.Ka,c.l,c):null;e:{var J=c.i;let ze=-1;for(;;){const Et=["count="+v];ze==-1?v>0?(ze=J[0].g,Et.push("ofs="+ze)):ze=0:Et.push("ofs="+ze);let it=!0;for(let wt=0;wt<v;wt++){var re=J[wt].g;const sn=J[wt].map;if(re-=ze,re<0)ze=Math.max(0,J[wt].g-100),it=!1;else try{re="req"+re+"_"||"";try{var be=sn instanceof Map?sn:Object.entries(sn);for(const[$s,ts]of be){let ns=ts;p(ts)&&(ns=Ze(ts)),Et.push(re+$s+"="+encodeURIComponent(ns))}}catch($s){throw Et.push(re+"type="+encodeURIComponent("_badmap")),$s}}catch{M&&M(sn)}}if(it){be=Et.join("&");break e}}be=void 0}return c=c.i.splice(0,v),m.G=c,be}function Oo(c){if(!c.g&&!c.v){c.Y=1;var m=c.Da;se||k(),te||(se(),te=!0),R.add(m,c),c.A=0}}function ya(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=gs(b(c.Da,c),Uo(c,c.A)),c.A++,!0)}a.Da=function(){if(this.v=null,Io(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=gs(b(this.Wa,this),c)}},a.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Mt(10),kr(this),Io(this))};function cl(c){c.B!=null&&(g.clearTimeout(c.B),c.B=null)}function Io(c){c.g=new Xn(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var m=It(c.na);at(m,"RID","rpc"),at(m,"SID",c.M),at(m,"AID",c.K),at(m,"CI",c.F?"0":"1"),!c.F&&c.ia&&at(m,"TO",c.ia),at(m,"TYPE","xmlhttp"),xa(c,m),c.u&&c.o&&ga(m,c.u,c.o),c.O&&(c.g.H=c.O);var v=c.g;c=c.ba,v.M=1,v.A=ua(It(m)),v.u=null,v.R=!0,Ja(v,c)}a.Va=function(){this.C!=null&&(this.C=null,kr(this),ya(this),Mt(19))};function ii(c){c.C!=null&&(g.clearTimeout(c.C),c.C=null)}function Do(c,m){var v=null;if(c.g==m){ii(c),cl(c),c.g=null;var M=2}else if(ws(c.h,m))v=m.G,Qi(c.h,m),M=1;else return;if(c.I!=0){if(m.o)if(M==1){v=m.u?m.u.length:0,m=Date.now()-m.F;var J=c.D;M=qi(),Be(M,new fs(M,v)),Ss(c)}else Oo(c);else if(J=m.m,J==3||J==0&&m.X>0||!(M==1&&ai(c,m)||M==2&&ya(c)))switch(v&&v.length>0&&(m=c.h,m.i=m.i.concat(v)),J){case 1:Cs(c,5);break;case 4:Cs(c,10);break;case 3:Cs(c,6);break;default:Cs(c,2)}}}function Uo(c,m){let v=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(v*=2),v*m}function Cs(c,m){if(c.j.info("Error code "+m),m==2){var v=b(c.bb,c),M=c.Ua;const J=!M;M=new wn(M||"//www.google.com/images/cleardot.gif"),g.location&&g.location.protocol=="http"||Ft(M,"https"),ua(M),J?Qn(M.toString(),v):rl(M.toString(),v)}else Mt(2);c.I=0,c.l&&c.l.pa(m),Bo(c),ri(c)}a.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function Bo(c){if(c.I=0,c.ja=[],c.l){const m=Zi(c.h);(m.length!=0||c.i.length!=0)&&(L(c.ja,m),L(c.ja,c.i),c.h.i.length=0,I(c.i),c.i.length=0),c.l.oa()}}function zo(c,m,v){var M=v instanceof wn?It(v):new wn(v);if(M.g!="")m&&(M.g=m+"."+M.g),yr(M,M.u);else{var J=g.location;M=J.protocol,m=m?m+"."+J.hostname:J.hostname,J=+J.port;const re=new wn(null);M&&Ft(re,M),m&&(re.g=m),J&&yr(re,J),v&&(re.h=v),M=re}return v=c.G,m=c.wa,v&&m&&at(M,v,m),at(M,"VER",c.ka),xa(c,M),M}function Po(c,m,v){if(m&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Aa&&!c.ma?new ht(new Ns({ab:v})):new ht(c.ma),m.Fa(c.L),m}a.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ho(){}a=Ho.prototype,a.ra=function(){},a.qa=function(){},a.pa=function(){},a.oa=function(){},a.isActive=function(){return!0},a.Ka=function(){};function nn(c,m){Ce.call(this),this.g=new _r(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(c?c["X-WebChannel-Client-Profile"]=m.sa:c={"X-WebChannel-Client-Profile":m.sa}),this.g.U=c,(c=m&&m.Qb)&&!O(c)&&(this.g.u=c),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!O(m)&&(this.g.G=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new Sr(this)}j(nn,Ce),nn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},nn.prototype.close=function(){ll(this.g)},nn.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.v&&(v={},v.__data__=Ze(c),c=v);m.i.push(new Ot(m.Ya++,c)),m.I==3&&Ss(m)},nn.prototype.N=function(){this.g.l=null,delete this.j,ll(this.g),delete this.g,nn.Z.N.call(this)};function Go(c){Yt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){e:{for(const v in m){c=v;break e}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}j(Go,Yt);function Vo(){Ln.call(this),this.status=1}j(Vo,Ln);function Sr(c){this.g=c}j(Sr,Ho),Sr.prototype.ra=function(){Be(this.g,"a")},Sr.prototype.qa=function(c){Be(this.g,new Go(c))},Sr.prototype.pa=function(c){Be(this.g,new Vo)},Sr.prototype.oa=function(){Be(this.g,"b")},nn.prototype.send=nn.prototype.o,nn.prototype.open=nn.prototype.m,nn.prototype.close=nn.prototype.close,Xa.NO_ERROR=0,Xa.TIMEOUT=8,Xa.HTTP_ERROR=6,_o.COMPLETE="complete",rt.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",Ce.prototype.listen=Ce.prototype.J,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa}).apply(typeof Jc<"u"?Jc:typeof self<"u"?self:typeof window<"u"?window:{});const cx="@firebase/firestore",dx="4.9.3";class cn{constructor(n){this.uid=n}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(n){return n.uid===this.uid}}cn.UNAUTHENTICATED=new cn(null),cn.GOOGLE_CREDENTIALS=new cn("google-credentials-uid"),cn.FIRST_PARTY=new cn("first-party-uid"),cn.MOCK_USER=new cn("mock-user");let bo="12.7.0";const Vi=new xf("@firebase/firestore");function os(a,...n){if(Vi.logLevel<=st.DEBUG){const i=n.map(Df);Vi.debug(`Firestore (${bo}): ${a}`,...i)}}function sb(a,...n){if(Vi.logLevel<=st.ERROR){const i=n.map(Df);Vi.error(`Firestore (${bo}): ${a}`,...i)}}function K5(a,...n){if(Vi.logLevel<=st.WARN){const i=n.map(Df);Vi.warn(`Firestore (${bo}): ${a}`,...i)}}function Df(a){if(typeof a=="string")return a;try{return(function(i){return JSON.stringify(i)})(a)}catch{return a}}function oo(a,n,i){let o="Unexpected state";typeof n=="string"?o=n:i=n,rb(a,o,i)}function rb(a,n,i){let o=`FIRESTORE (${bo}) INTERNAL ASSERTION FAILED: ${n} (ID: ${a.toString(16)})`;if(i!==void 0)try{o+=" CONTEXT: "+JSON.stringify(i)}catch{o+=" CONTEXT: "+i}throw sb(o),new Error(o)}function to(a,n,i,o){let d="Unexpected state";typeof i=="string"?d=i:o=i,a||rb(n,d,o)}const Je={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class Qe extends Ps{constructor(n,i){super(n,i),this.code=n,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class no{constructor(){this.promise=new Promise(((n,i)=>{this.resolve=n,this.reject=i}))}}class ab{constructor(n,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${n}`)}}class X5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(n,i){n.enqueueRetryable((()=>i(cn.UNAUTHENTICATED)))}shutdown(){}}class J5{constructor(n){this.token=n,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(n,i){this.changeListener=i,n.enqueueRetryable((()=>i(this.token.user)))}shutdown(){this.changeListener=null}}class Q5{constructor(n){this.t=n,this.currentUser=cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(n,i){to(this.o===void 0,42304);let o=this.i;const d=x=>this.i!==o?(o=this.i,i(x)):Promise.resolve();let h=new no;this.o=()=>{this.i++,this.currentUser=this.u(),h.resolve(),h=new no,n.enqueueRetryable((()=>d(this.currentUser)))};const g=()=>{const x=h;n.enqueueRetryable((async()=>{await x.promise,await d(this.currentUser)}))},p=x=>{os("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),g())};this.t.onInit((x=>p(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?p(x):(os("FirebaseAuthCredentialsProvider","Auth not yet detected"),h.resolve(),h=new no)}}),0),g()}getToken(){const n=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then((o=>this.i!==n?(os("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(to(typeof o.accessToken=="string",31837,{l:o}),new ab(o.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const n=this.auth&&this.auth.getUid();return to(n===null||typeof n=="string",2055,{h:n}),new cn(n)}}class Z5{constructor(n,i,o){this.P=n,this.T=i,this.I=o,this.type="FirstParty",this.user=cn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const n=this.R();return n&&this.A.set("Authorization",n),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class e_{constructor(n,i,o){this.P=n,this.T=i,this.I=o}getToken(){return Promise.resolve(new Z5(this.P,this.T,this.I))}start(n,i){n.enqueueRetryable((()=>i(cn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ux{constructor(n){this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t_{constructor(n,i){this.V=i,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yn(n)&&n.settings.appCheckToken&&(this.p=n.settings.appCheckToken)}start(n,i){to(this.o===void 0,3512);const o=h=>{h.error!=null&&os("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${h.error.message}`);const g=h.token!==this.m;return this.m=h.token,os("FirebaseAppCheckTokenProvider",`Received ${g?"new":"existing"} token.`),g?i(h.token):Promise.resolve()};this.o=h=>{n.enqueueRetryable((()=>o(h)))};const d=h=>{os("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=h,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((h=>d(h))),setTimeout((()=>{if(!this.appCheck){const h=this.V.getImmediate({optional:!0});h?d(h):os("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ux(this.p));const n=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(n).then((i=>i?(to(typeof i.token=="string",44558,{tokenResult:i}),this.m=i.token,new ux(i.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function n_(a){const n=typeof self<"u"&&(self.crypto||self.msCrypto),i=new Uint8Array(a);if(n&&typeof n.getRandomValues=="function")n.getRandomValues(i);else for(let o=0;o<a;o++)i[o]=Math.floor(256*Math.random());return i}class s_{static newId(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=62*Math.floor(4.129032258064516);let o="";for(;o.length<20;){const d=n_(40);for(let h=0;h<d.length;++h)o.length<20&&d[h]<i&&(o+=n.charAt(d[h]%62))}return o}}function ra(a,n){return a<n?-1:a>n?1:0}function r_(a,n){const i=Math.min(a.length,n.length);for(let o=0;o<i;o++){const d=a.charAt(o),h=n.charAt(o);if(d!==h)return Hh(d)===Hh(h)?ra(d,h):Hh(d)?1:-1}return ra(a.length,n.length)}const a_=55296,i_=57343;function Hh(a){const n=a.charCodeAt(0);return n>=a_&&n<=i_}const hx="__name__";class Ms{constructor(n,i,o){i===void 0?i=0:i>n.length&&oo(637,{offset:i,range:n.length}),o===void 0?o=n.length-i:o>n.length-i&&oo(1746,{length:o,range:n.length-i}),this.segments=n,this.offset=i,this.len=o}get length(){return this.len}isEqual(n){return Ms.comparator(this,n)===0}child(n){const i=this.segments.slice(this.offset,this.limit());return n instanceof Ms?n.forEach((o=>{i.push(o)})):i.push(n),this.construct(i)}limit(){return this.offset+this.length}popFirst(n){return n=n===void 0?1:n,this.construct(this.segments,this.offset+n,this.length-n)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(n){return this.segments[this.offset+n]}isEmpty(){return this.length===0}isPrefixOf(n){if(n.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==n.get(i))return!1;return!0}isImmediateParentOf(n){if(this.length+1!==n.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==n.get(i))return!1;return!0}forEach(n){for(let i=this.offset,o=this.limit();i<o;i++)n(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(n,i){const o=Math.min(n.length,i.length);for(let d=0;d<o;d++){const h=Ms.compareSegments(n.get(d),i.get(d));if(h!==0)return h}return ra(n.length,i.length)}static compareSegments(n,i){const o=Ms.isNumericId(n),d=Ms.isNumericId(i);return o&&!d?-1:!o&&d?1:o&&d?Ms.extractNumericId(n).compare(Ms.extractNumericId(i)):r_(n,i)}static isNumericId(n){return n.startsWith("__id")&&n.endsWith("__")}static extractNumericId(n){return If.fromString(n.substring(4,n.length-2))}}class is extends Ms{construct(n,i,o){return new is(n,i,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...n){const i=[];for(const o of n){if(o.indexOf("//")>=0)throw new Qe(Je.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);i.push(...o.split("/").filter((d=>d.length>0)))}return new is(i)}static emptyPath(){return new is([])}}const l_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Da extends Ms{construct(n,i,o){return new Da(n,i,o)}static isValidIdentifier(n){return l_.test(n)}canonicalString(){return this.toArray().map((n=>(n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Da.isValidIdentifier(n)||(n="`"+n+"`"),n))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hx}static keyField(){return new Da([hx])}static fromServerFormat(n){const i=[];let o="",d=0;const h=()=>{if(o.length===0)throw new Qe(Je.INVALID_ARGUMENT,`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(o),o=""};let g=!1;for(;d<n.length;){const p=n[d];if(p==="\\"){if(d+1===n.length)throw new Qe(Je.INVALID_ARGUMENT,"Path has trailing escape character: "+n);const x=n[d+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new Qe(Je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);o+=x,d+=2}else p==="`"?(g=!g,d++):p!=="."||g?(o+=p,d++):(h(),d++)}if(h(),g)throw new Qe(Je.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new Da(i)}static emptyPath(){return new Da([])}}class Ba{constructor(n){this.path=n}static fromPath(n){return new Ba(is.fromString(n))}static fromName(n){return new Ba(is.fromString(n).popFirst(5))}static empty(){return new Ba(is.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(n){return this.path.length>=2&&this.path.get(this.path.length-2)===n}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(n){return n!==null&&is.comparator(this.path,n.path)===0}toString(){return this.path.toString()}static comparator(n,i){return is.comparator(n.path,i.path)}static isDocumentKey(n){return n.length%2==0}static fromSegments(n){return new Ba(new is(n.slice()))}}function o_(a,n,i,o){if(n===!0&&o===!0)throw new Qe(Je.INVALID_ARGUMENT,`${a} and ${i} cannot be used together.`)}function c_(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}function d_(a){if(a===void 0)return"undefined";if(a===null)return"null";if(typeof a=="string")return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if(typeof a=="number"||typeof a=="boolean")return""+a;if(typeof a=="object"){if(a instanceof Array)return"an array";{const n=(function(o){return o.constructor?o.constructor.name:null})(a);return n?`a custom ${n} object`:"an object"}}return typeof a=="function"?"a function":oo(12329,{type:typeof a})}function u_(a,n){if("_delegate"in a&&(a=a._delegate),!(a instanceof n)){if(n.name===a.constructor.name)throw new Qe(Je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=d_(a);throw new Qe(Je.INVALID_ARGUMENT,`Expected type '${n.name}', but it was: ${i}`)}}return a}function Pt(a,n){const i={typeString:a};return n&&(i.value=n),i}function vo(a,n){if(!c_(a))throw new Qe(Je.INVALID_ARGUMENT,"JSON must be an object");let i;for(const o in n)if(n[o]){const d=n[o].typeString,h="value"in n[o]?{value:n[o].value}:void 0;if(!(o in a)){i=`JSON missing required field: '${o}'`;break}const g=a[o];if(d&&typeof g!==d){i=`JSON field '${o}' must be a ${d}.`;break}if(h!==void 0&&g!==h.value){i=`Expected '${o}' field to equal '${h.value}'`;break}}if(i)throw new Qe(Je.INVALID_ARGUMENT,i);return!0}const fx=-62135596800,gx=1e6;class Ls{static now(){return Ls.fromMillis(Date.now())}static fromDate(n){return Ls.fromMillis(n.getTime())}static fromMillis(n){const i=Math.floor(n/1e3),o=Math.floor((n-1e3*i)*gx);return new Ls(i,o)}constructor(n,i){if(this.seconds=n,this.nanoseconds=i,i<0)throw new Qe(Je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new Qe(Je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(n<fx)throw new Qe(Je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new Qe(Je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gx}_compareTo(n){return this.seconds===n.seconds?ra(this.nanoseconds,n.nanoseconds):ra(this.seconds,n.seconds)}isEqual(n){return n.seconds===this.seconds&&n.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ls._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(n){if(vo(n,Ls._jsonSchema))return new Ls(n.seconds,n.nanoseconds)}valueOf(){const n=this.seconds-fx;return String(n).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ls._jsonSchemaVersion="firestore/timestamp/1.0",Ls._jsonSchema={type:Pt("string",Ls._jsonSchemaVersion),seconds:Pt("number"),nanoseconds:Pt("number")};function h_(a){return a.name==="IndexedDbTransactionError"}class f_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class qa{constructor(n){this.binaryString=n}static fromBase64String(n){const i=(function(d){try{return atob(d)}catch(h){throw typeof DOMException<"u"&&h instanceof DOMException?new f_("Invalid base64 string: "+h):h}})(n);return new qa(i)}static fromUint8Array(n){const i=(function(d){let h="";for(let g=0;g<d.length;++g)h+=String.fromCharCode(d[g]);return h})(n);return new qa(i)}[Symbol.iterator](){let n=0;return{next:()=>n<this.binaryString.length?{value:this.binaryString.charCodeAt(n++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(i){return btoa(i)})(this.binaryString)}toUint8Array(){return(function(i){const o=new Uint8Array(i.length);for(let d=0;d<i.length;d++)o[d]=i.charCodeAt(d);return o})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(n){return ra(this.binaryString,n.binaryString)}isEqual(n){return this.binaryString===n.binaryString}}qa.EMPTY_BYTE_STRING=new qa("");const sf="(default)";class bd{constructor(n,i){this.projectId=n,this.database=i||sf}static empty(){return new bd("","")}get isDefaultDatabase(){return this.database===sf}isEqual(n){return n instanceof bd&&n.projectId===this.projectId&&n.database===this.database}}class g_{constructor(n,i=null,o=[],d=[],h=null,g="F",p=null,x=null){this.path=n,this.collectionGroup=i,this.explicitOrderBy=o,this.filters=d,this.limit=h,this.limitType=g,this.startAt=p,this.endAt=x,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function m_(a){return new g_(a)}var mx,Xe;(Xe=mx||(mx={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";new If([4294967295,4294967295],0);const p_=41943040;const x_=1048576;function Gh(){return typeof document<"u"?document:null}class y_{constructor(n,i,o=1e3,d=1.5,h=6e4){this.Mi=n,this.timerId=i,this.d_=o,this.A_=d,this.R_=h,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(n){this.cancel();const i=Math.floor(this.V_+this.y_()),o=Math.max(0,Date.now()-this.f_),d=Math.max(0,i-o);d>0&&os("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.V_} ms, delay with jitter: ${i} ms, last attempt: ${o} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,d,(()=>(this.f_=Date.now(),n()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}class Uf{constructor(n,i,o,d,h){this.asyncQueue=n,this.timerId=i,this.targetTimeMs=o,this.op=d,this.removalCallback=h,this.deferred=new no,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((g=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(n,i,o,d,h){const g=Date.now()+o,p=new Uf(n,i,g,d,h);return p.start(o),p}start(n){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),n)}skipDelay(){return this.handleDelayElapsed()}cancel(n){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Qe(Je.CANCELLED,"Operation cancelled"+(n?": "+n:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((n=>this.deferred.resolve(n)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var px,xx;(xx=px||(px={})).Ma="default",xx.Cache="cache";function b_(a){const n={};return a.timeoutSeconds!==void 0&&(n.timeoutSeconds=a.timeoutSeconds),n}const yx=new Map;const ib="firestore.googleapis.com",bx=!0;class vx{constructor(n){if(n.host===void 0){if(n.ssl!==void 0)throw new Qe(Je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ib,this.ssl=bx}else this.host=n.host,this.ssl=n.ssl??bx;if(this.isUsingEmulator=n.emulatorOptions!==void 0,this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,this.localCache=n.localCache,n.cacheSizeBytes===void 0)this.cacheSizeBytes=p_;else{if(n.cacheSizeBytes!==-1&&n.cacheSizeBytes<x_)throw new Qe(Je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}o_("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:n.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!n.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=b_(n.experimentalLongPollingOptions??{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Qe(Je.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Qe(Je.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Qe(Je.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!n.useFetchStreams}isEqual(n){return this.host===n.host&&this.ssl===n.ssl&&this.credentials===n.credentials&&this.cacheSizeBytes===n.cacheSizeBytes&&this.experimentalForceLongPolling===n.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===n.experimentalAutoDetectLongPolling&&(function(o,d){return o.timeoutSeconds===d.timeoutSeconds})(this.experimentalLongPollingOptions,n.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===n.ignoreUndefinedProperties&&this.useFetchStreams===n.useFetchStreams}}class lb{constructor(n,i,o,d){this._authCredentials=n,this._appCheckCredentials=i,this._databaseId=o,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Qe(Je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(n){if(this._settingsFrozen)throw new Qe(Je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vx(n),this._emulatorOptions=n.emulatorOptions||{},n.credentials!==void 0&&(this._authCredentials=(function(o){if(!o)return new X5;switch(o.type){case"firstParty":return new e_(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new Qe(Je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(n.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(i){const o=yx.get(i);o&&(os("ComponentProvider","Removing Datastore"),yx.delete(i),o.terminate())})(this),Promise.resolve()}}function v_(a,n,i,o={}){a=u_(a,lb);const d=Ya(n),h=a._getSettings(),g={...h,emulatorOptions:a._getEmulatorOptions()},p=`${n}:${i}`;d&&(mf(`https://${p}`),pf("Firestore",!0)),h.host!==ib&&h.host!==p&&K5("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...h,host:p,ssl:d,emulatorOptions:o};if(!Ga(x,g)&&(a._setSettings(x),o.mockUserToken)){let b,N;if(typeof o.mockUserToken=="string")b=o.mockUserToken,N=cn.MOCK_USER;else{b=ty(o.mockUserToken,a._app?.options.projectId);const j=o.mockUserToken.sub||o.mockUserToken.user_id;if(!j)throw new Qe(Je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new cn(j)}a._authCredentials=new J5(new ab(b,N))}}class Bf{constructor(n,i,o){this.converter=i,this._query=o,this.type="query",this.firestore=n}withConverter(n){return new Bf(this.firestore,n,this._query)}}class Is{constructor(n,i,o){this.converter=i,this._key=o,this.type="document",this.firestore=n}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zf(this.firestore,this.converter,this._key.path.popLast())}withConverter(n){return new Is(this.firestore,n,this._key)}toJSON(){return{type:Is._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(n,i,o){if(vo(i,Is._jsonSchema))return new Is(n,o||null,new Ba(is.fromString(i.referencePath)))}}Is._jsonSchemaVersion="firestore/documentReference/1.0",Is._jsonSchema={type:Pt("string",Is._jsonSchemaVersion),referencePath:Pt("string")};class zf extends Bf{constructor(n,i,o){super(n,i,m_(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const n=this._path.popLast();return n.isEmpty()?null:new Is(this.firestore,null,new Ba(n))}withConverter(n){return new zf(this.firestore,n,this._path)}}const wx="AsyncQueue";class jx{constructor(n=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new y_(this,"async_queue_retry"),this._c=()=>{const o=Gh();o&&os(wx,"Visibility state changed to "+o.visibilityState),this.M_.w_()},this.ac=n;const i=Gh();i&&typeof i.addEventListener=="function"&&i.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(n){this.enqueue(n)}enqueueAndForgetEvenWhileRestricted(n){this.uc(),this.cc(n)}enterRestrictedMode(n){if(!this.ec){this.ec=!0,this.sc=n||!1;const i=Gh();i&&typeof i.removeEventListener=="function"&&i.removeEventListener("visibilitychange",this._c)}}enqueue(n){if(this.uc(),this.ec)return new Promise((()=>{}));const i=new no;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(n().then(i.resolve,i.reject),i.promise))).then((()=>i.promise))}enqueueRetryable(n){this.enqueueAndForget((()=>(this.Xu.push(n),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(n){if(!h_(n))throw n;os(wx,"Operation failed with retryable error: "+n)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(n){const i=this.ac.then((()=>(this.rc=!0,n().catch((o=>{throw this.nc=o,this.rc=!1,sb("INTERNAL UNHANDLED ERROR: ",Nx(o)),o})).then((o=>(this.rc=!1,o))))));return this.ac=i,i}enqueueAfterDelay(n,i,o){this.uc(),this.oc.indexOf(n)>-1&&(i=0);const d=Uf.createAndSchedule(this,n,i,o,(h=>this.hc(h)));return this.tc.push(d),d}uc(){this.nc&&oo(47125,{Pc:Nx(this.nc)})}verifyOperationInProgress(){}async Tc(){let n;do n=this.ac,await n;while(n!==this.ac)}Ic(n){for(const i of this.tc)if(i.timerId===n)return!0;return!1}Ec(n){return this.Tc().then((()=>{this.tc.sort(((i,o)=>i.targetTimeMs-o.targetTimeMs));for(const i of this.tc)if(i.skipDelay(),n!=="all"&&i.timerId===n)break;return this.Tc()}))}dc(n){this.oc.push(n)}hc(n){const i=this.tc.indexOf(n);this.tc.splice(i,1)}}function Nx(a){let n=a.message||"";return a.stack&&(n=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),n}class w_ extends lb{constructor(n,i,o,d){super(n,i,o,d),this.type="firestore",this._queue=new jx,this._persistenceKey=d?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const n=this._firestoreClient.terminate();this._queue=new jx(n),this._firestoreClient=void 0,await n}}}function j_(a,n){const i=typeof a=="object"?a:bf(),o=typeof a=="string"?a:sf,d=Nd(i,"firestore").getImmediate({identifier:o});if(!d._initialized){const h=Qx("firestore");h&&v_(d,...h)}return d}class cr{constructor(n){this._byteString=n}static fromBase64String(n){try{return new cr(qa.fromBase64String(n))}catch(i){throw new Qe(Je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(n){return new cr(qa.fromUint8Array(n))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(n){return this._byteString.isEqual(n._byteString)}toJSON(){return{type:cr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(n){if(vo(n,cr._jsonSchema))return cr.fromBase64String(n.bytes)}}cr._jsonSchemaVersion="firestore/bytes/1.0",cr._jsonSchema={type:Pt("string",cr._jsonSchemaVersion),bytes:Pt("string")};class ob{constructor(...n){for(let i=0;i<n.length;++i)if(n[i].length===0)throw new Qe(Je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Da(n)}isEqual(n){return this._internalPath.isEqual(n._internalPath)}}class Pa{constructor(n,i){if(!isFinite(n)||n<-90||n>90)throw new Qe(Je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(i)||i<-180||i>180)throw new Qe(Je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=n,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(n){return this._lat===n._lat&&this._long===n._long}_compareTo(n){return ra(this._lat,n._lat)||ra(this._long,n._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pa._jsonSchemaVersion}}static fromJSON(n){if(vo(n,Pa._jsonSchema))return new Pa(n.latitude,n.longitude)}}Pa._jsonSchemaVersion="firestore/geoPoint/1.0",Pa._jsonSchema={type:Pt("string",Pa._jsonSchemaVersion),latitude:Pt("number"),longitude:Pt("number")};class Ha{constructor(n){this._values=(n||[]).map((i=>i))}toArray(){return this._values.map((n=>n))}isEqual(n){return(function(o,d){if(o.length!==d.length)return!1;for(let h=0;h<o.length;++h)if(o[h]!==d[h])return!1;return!0})(this._values,n._values)}toJSON(){return{type:Ha._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(n){if(vo(n,Ha._jsonSchema)){if(Array.isArray(n.vectorValues)&&n.vectorValues.every((i=>typeof i=="number")))return new Ha(n.vectorValues);throw new Qe(Je.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ha._jsonSchemaVersion="firestore/vectorValue/1.0",Ha._jsonSchema={type:Pt("string",Ha._jsonSchemaVersion),vectorValues:Pt("object")};const N_=new RegExp("[~\\*/\\[\\]]");function __(a,n,i){if(n.search(N_)>=0)throw _x(`Invalid field path (${n}). Paths must not contain '~', '*', '/', '[', or ']'`,a);try{return new ob(...n.split("."))._internalPath}catch{throw _x(`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a)}}function _x(a,n,i,o,d){let h=`Function ${n}() called with invalid data`;h+=". ";let g="";return new Qe(Je.INVALID_ARGUMENT,h+a+g)}class cb{constructor(n,i,o,d,h){this._firestore=n,this._userDataWriter=i,this._key=o,this._document=d,this._converter=h}get id(){return this._key.path.lastSegment()}get ref(){return new Is(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const n=new k_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(n)}return this._userDataWriter.convertValue(this._document.data.value)}}get(n){if(this._document){const i=this._document.data.field(db("DocumentSnapshot.get",n));if(i!==null)return this._userDataWriter.convertValue(i)}}}class k_ extends cb{data(){return super.data()}}function db(a,n){return typeof n=="string"?__(a,n):n instanceof ob?n._internalPath:n._delegate._internalPath}class Qc{constructor(n,i){this.hasPendingWrites=n,this.fromCache=i}isEqual(n){return this.hasPendingWrites===n.hasPendingWrites&&this.fromCache===n.fromCache}}class Hi extends cb{constructor(n,i,o,d,h,g){super(n,i,o,d,g),this._firestore=n,this._firestoreImpl=n,this.metadata=h}exists(){return super.exists()}data(n={}){if(this._document){if(this._converter){const i=new cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,n)}return this._userDataWriter.convertValue(this._document.data.value,n.serverTimestamps)}}get(n,i={}){if(this._document){const o=this._document.data.field(db("DocumentSnapshot.get",n));if(o!==null)return this._userDataWriter.convertValue(o,i.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Qe(Je.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const n=this._document,i={};return i.type=Hi._jsonSchemaVersion,i.bundle="",i.bundleSource="DocumentSnapshot",i.bundleName=this._key.toString(),!n||!n.isValidDocument()||!n.isFoundDocument()?i:(this._userDataWriter.convertObjectMap(n.data.value.mapValue.fields,"previous"),i.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),i)}}Hi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hi._jsonSchema={type:Pt("string",Hi._jsonSchemaVersion),bundleSource:Pt("string","DocumentSnapshot"),bundleName:Pt("string"),bundle:Pt("string")};class cd extends Hi{data(n={}){return super.data(n)}}class so{constructor(n,i,o,d){this._firestore=n,this._userDataWriter=i,this._snapshot=d,this.metadata=new Qc(d.hasPendingWrites,d.fromCache),this.query=o}get docs(){const n=[];return this.forEach((i=>n.push(i))),n}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(n,i){this._snapshot.docs.forEach((o=>{n.call(i,new cd(this._firestore,this._userDataWriter,o.key,o,new Qc(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(n={}){const i=!!n.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new Qe(Je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=(function(d,h){if(d._snapshot.oldDocs.isEmpty()){let g=0;return d._snapshot.docChanges.map((p=>{const x=new cd(d._firestore,d._userDataWriter,p.doc.key,p.doc,new Qc(d._snapshot.mutatedKeys.has(p.doc.key),d._snapshot.fromCache),d.query.converter);return p.doc,{type:"added",doc:x,oldIndex:-1,newIndex:g++}}))}{let g=d._snapshot.oldDocs;return d._snapshot.docChanges.filter((p=>h||p.type!==3)).map((p=>{const x=new cd(d._firestore,d._userDataWriter,p.doc.key,p.doc,new Qc(d._snapshot.mutatedKeys.has(p.doc.key),d._snapshot.fromCache),d.query.converter);let b=-1,N=-1;return p.type!==0&&(b=g.indexOf(p.doc.key),g=g.delete(p.doc.key)),p.type!==1&&(g=g.add(p.doc),N=g.indexOf(p.doc.key)),{type:S_(p.type),doc:x,oldIndex:b,newIndex:N}}))}})(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Qe(Je.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const n={};n.type=so._jsonSchemaVersion,n.bundleSource="QuerySnapshot",n.bundleName=s_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const i=[],o=[],d=[];return this.docs.forEach((h=>{h._document!==null&&(i.push(h._document),o.push(this._userDataWriter.convertObjectMap(h._document.data.value.mapValue.fields,"previous")),d.push(h.ref.path))})),n.bundle=(this._firestore,this.query._query,n.bundleName,"NOT SUPPORTED"),n}}function S_(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oo(61501,{type:a})}}so._jsonSchemaVersion="firestore/querySnapshot/1.0",so._jsonSchema={type:Pt("string",so._jsonSchemaVersion),bundleSource:Pt("string","QuerySnapshot"),bundleName:Pt("string"),bundle:Pt("string")};(function(n,i=!0){(function(d){bo=d})(Ka),Va(new sa("firestore",((o,{instanceIdentifier:d,options:h})=>{const g=o.getProvider("app").getImmediate(),p=new w_(new Q5(o.getProvider("auth-internal")),new t_(g,o.getProvider("app-check-internal")),(function(b,N){if(!Object.prototype.hasOwnProperty.apply(b.options,["projectId"]))throw new Qe(Je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bd(b.options.projectId,N)})(g,d),g);return h={useFetchStreams:i,...h},p._setSettings(h),p}),"PUBLIC").setMultipleInstances(!0)),Ds(cx,dx,n),Ds(cx,dx,"esm2020")})();const C_={apiKey:"AIzaSyAdqbFNjrB6y-8BrMEYYCT5ywiCgZVtMaE",authDomain:"mtglibrary-70b46.firebaseapp.com",projectId:"mtglibrary-70b46",storageBucket:"mtglibrary-70b46.firebasestorage.app",messagingSenderId:"602862103839",appId:"1:602862103839:web:23c64b7486c058c903d42a",measurementId:"G-EWELJJQ631"},Pf=ry(C_),Xr=R4(Pf);j_(Pf);const E_=V5(Pf),T_="";async function A_(){const a={"Content-Type":"application/json"};if(Xr.currentUser){const n=await Xr.currentUser.getIdToken();a.Authorization=`Bearer ${n}`}else console.warn("[API] No currentUser found, sending request without auth.");return a}async function Ui(a,n,i=null,o={}){let d=`${T_}${n}`;const h=new URL(d,window.location.origin);Object.keys(o).forEach(x=>{o[x]!==null&&o[x]!==void 0&&h.searchParams.append(x,o[x])});const g={method:a,headers:await A_()};i&&(g.body=JSON.stringify(i));const p=await fetch(h,g);if(!p.ok){let x=p.statusText;try{const b=await p.json();b.error&&(x=b.error)}catch{}throw new Error(`API Error (${p.status}): ${x}`)}return p.status===204?null:p.json()}const Ge={get:(a,n)=>Ui("GET",a,null,n),post:(a,n)=>Ui("POST",a,n),put:(a,n)=>Ui("PUT",a,n),delete:a=>Ui("DELETE",a),getBugs:()=>Ui("GET","/bugs").then(a=>a.content),updateUser:(a,n)=>Ui("PUT",`/users/${a}`,n)},ub=w.createContext(),vt=()=>w.useContext(ub),R_=({children:a})=>{const[n,i]=w.useState(null),[o,d]=w.useState(null),[h,g]=w.useState(!0),p=(T,U)=>fN(Xr,T,U),x=(T,U)=>gN(Xr,T,U),b=()=>{const T=new or;return PN(Xr,T)},N=()=>(d(null),vN(Xr)),j=async T=>{if(!n)throw new Error("No user logged in");if(!T.type.startsWith("image/"))throw new Error("File must be an image.");if(T.size>2*1024*1024)throw new Error("File size must be under 2MB.");try{const U=G5(E_,`users/${n.uid}/profile_${Date.now()}`);await P5(U,T);const P=await H5(U);return await pN(n,{photoURL:P}),i({...n,photoURL:P}),P}catch(U){throw console.error("Error uploading profile picture:",U),U}},_=async()=>{if(Xr.currentUser)try{const T=await Ge.get("/me");d(T)}catch(T){console.error("Failed to fetch user profile:",T)}};w.useEffect(()=>bN(Xr,async U=>{i(U),U?await _():d(null),g(!1)}),[]);const L={currentUser:n,user:n,userProfile:o,refreshUserProfile:_,updateSettings:async T=>{if(!o)return;const U={...o.settings||{},...T};console.log("[AuthContext] Updating settings:",U);try{await Ge.updateUser(o.id,{settings:U})&&d(z=>({...z,settings:U}))}catch(P){console.error("Failed to update settings:",P)}},signup:p,login:x,loginWithGoogle:b,logout:N,uploadProfilePicture:j};return s.jsx(ub.Provider,{value:L,children:!h&&a})};function M_(){const[a,n]=w.useState([]),[i,o]=w.useState(!1),[d,h]=w.useState(null),g=w.useCallback(async(x,b={})=>{const{set:N,cn:j,..._}=b,I=(x||"").trim();if(!(N||j||Object.keys(_).length>0)&&(!I||I.length<2)){n([]);return}o(!0),h(null);try{const T=await Ge.post("/cards/search",{query:I,set:N,cn:j,..._});n(T.data||[])}catch(T){console.error(T),h(T.message),n([])}finally{o(!1)}},[]),p=w.useCallback(async x=>{if(!x||x.trim().length<2)return[];try{return(await Ge.get("/cards/autocomplete",{q:x})).data||[]}catch(b){return console.error("[useScryfall] Autocomplete error:",b),[]}},[]);return{results:a,loading:i,error:d,searchCards:g,getSuggestions:p,setResults:n}}const hb=w.createContext();function Rn(){return w.useContext(hb)}function L_({children:a}){const[n,i]=w.useState([]),o=w.useCallback((h,g="info",p=3e3)=>{const x=Date.now();i(b=>[...b,{id:x,message:h,type:g}]),p>0&&setTimeout(()=>{i(b=>b.filter(N=>N.id!==x))},p)},[]),d=w.useCallback(h=>{i(g=>g.filter(p=>p.id!==h))},[]);return s.jsxs(hb.Provider,{value:{addToast:o},children:[a,aa.createPortal(s.jsx("div",{className:"fixed bottom-4 right-4 z-[9999] flex flex-col gap-2 pointer-events-none",children:n.map(h=>s.jsx("div",{className:`
                                px-4 py-3 rounded-lg shadow-lg text-sm font-medium transition-all transform animate-fade-in-up pointer-events-auto cursor-pointer
                                ${h.type==="success"?"bg-green-600 text-white":""}
                                ${h.type==="error"?"bg-red-600 text-white":""}
                                ${h.type==="info"?"bg-gray-800 text-white border border-gray-700":""}
                                ${h.type==="warning"?"bg-yellow-500 text-black":""}
                            `,onClick:()=>d(h.id),children:h.message},h.id))}),document.body)]})}function Yn(a={}){const{wishlist:n}=a,[i,o]=w.useState([]),[d,h]=w.useState(!0),[g,p]=w.useState(null),{currentUser:x}=vt(),b=async()=>{if(x){h(!0);try{let _="/collection";n!==void 0?_+=`?wishlist=${n}&ts=${Date.now()}`:_+=`?ts=${Date.now()}`;const L=(await Ge.get(_)).map(T=>({...T.data,...T,deckId:T.deck_id,quantity:T.count,firestoreId:T.firestore_id,id:T.id,scryfall_id:T.scryfall_id}));o(L),p(null)}catch(_){console.error("Error fetching collection:",_),p(_)}finally{h(!1)}}};return w.useEffect(()=>{if(!x){o([]),h(!1);return}b()},[x]),{cards:i,loading:d,error:g,refresh:b,removeCard:async _=>{try{await Ge.delete(`/collection/${_}`),await b()}catch(I){throw console.error("Error removing card:",I),I}},updateCard:async(_,I)=>{try{await Ge.put(`/collection/${_}`,I),await b()}catch(L){throw console.error("Error updating card:",L),L}}}}function O_(a,n){const[i,o]=w.useState(a);return w.useEffect(()=>{const d=setTimeout(()=>{o(a)},n);return()=>{clearTimeout(d)}},[a,n]),i}const en={async addCardToCollection(a,n,i=1,o,d=!1){return Ge.post("/collection",{scryfall_id:n.id,name:n.name,set_code:n.set||n.set_code,collector_number:n.collector_number,finish:o||n.finish||"nonfoil",count:i,data:n,deck_id:null,is_wishlist:d})},async updateCard(a,n){return Ge.put(`/collection/${a}`,n)},async removeCard(a){return Ge.delete(`/collection/${a}`)},async importBatch(a,n,i="merge"){return Ge.post("/collection/batch",{cards:n,mode:i})}},fb=w.createContext();function Hf(){return w.useContext(fb)}function I_({children:a}){const[n,i]=w.useState(null),[o,d]=w.useState(!1),h=w.useCallback(p=>{i(p),d(!0)},[]),g=w.useCallback(()=>{d(!1),setTimeout(()=>i(null),300)},[]);return s.jsx(fb.Provider,{value:{selectedCard:n,isOpen:o,openCardModal:h,closeCardModal:g},children:a})}const gb=({card:a,normalCount:n=0,foilCount:i=0,wishlistCount:o=0,onUpdateCount:d,onUpdateWishlistCount:h})=>{const{openCardModal:g}=Hf(),[p,x]=w.useState(!1),b=(G,X=0)=>{if(!G)return"https://placehold.co/250x350?text=No+Image";const se=G.data||G;return se.card_faces&&se.card_faces.length>1?se.card_faces[X]?.image_uris?.normal||"https://placehold.co/250x350?text=No+Image":se.image_uris?.normal||G.image_uri||"https://placehold.co/250x350?text=No+Image"},N=a.data?.card_faces||a.card_faces,j=N?.length>1&&!!N[1].image_uris,_=b(a,0),I=j?b(a,1):null,L=G=>{G.stopPropagation(),g(a)},T=(G,X,se)=>{G.stopPropagation(),d&&d(a,X,se)},U=n+i>0,P=!U&&o>0,z=a.prices?.usd||a.prices?.usd_foil||"---";return s.jsxs("div",{className:`group relative flex bg-gray-900/60 backdrop-blur-md rounded-xl overflow-hidden shadow-2xl border transition-all duration-300 hover:shadow-[0_0_30px_rgba(79,70,229,0.15)] aspect-[3.2/3.5] perspective-1000 ${U?"border-indigo-500/30":"border-white/5 grayscale-[0.8] opacity-70 hover:grayscale-0 hover:opacity-100"}`,children:[s.jsxs("div",{className:"relative aspect-[2.5/3.5] h-full cursor-pointer overflow-hidden bg-gray-950 shrink-0",onClick:L,children:[s.jsxs("div",{className:`relative w-full h-full transition-all duration-700 transform-style-3d ${p?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 backface-hidden",children:[s.jsx("img",{src:_,alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-t from-indigo-500/20 to-transparent transition-opacity duration-500"})]}),j&&s.jsx("div",{className:"absolute inset-0 backface-hidden rotate-y-180",children:s.jsx("img",{src:I||_,alt:`${a.name} Back`,className:"w-full h-full object-cover"})})]}),j&&s.jsx("button",{onClick:G=>{G.stopPropagation(),x(!p)},className:"absolute top-2 left-2 p-2 bg-black/60 hover:bg-indigo-600 text-white rounded-full backdrop-blur-md transition-all z-30 shadow-lg border border-white/10",title:"Flip Card",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),P&&s.jsx("div",{className:`absolute top-2 ${j?"left-12":"left-2"} z-20 bg-orange-500 text-white p-1 rounded-md shadow-lg animate-pulse`,children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),s.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:s.jsx("div",{className:"bg-black/70 backdrop-blur-md px-2 py-1 rounded-lg border border-white/10 text-center",children:s.jsxs("span",{className:"text-[10px] font-bold text-green-400 tabular-nums",children:["$",z]})})})]}),s.jsxs("div",{className:"flex-1 bg-black/40 flex flex-col justify-between py-1 border-l border-white/5 relative",children:[s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-white/5 transition-colors group/sec",children:[s.jsx("button",{onClick:G=>T(G,"normal",1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-white tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:n}),s.jsx("span",{className:"text-[8px] font-black uppercase text-gray-600 tracking-[0.2em] -mt-1",children:"Normal"})]}),s.jsx("button",{onClick:G=>T(G,"normal",-1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125 disabled:opacity-0",disabled:n<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-indigo-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:G=>T(G,"foil",1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-indigo-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:i}),s.jsx("span",{className:"text-[8px] font-black uppercase text-indigo-600 tracking-[0.2em] -mt-1",children:"Foil"})]}),s.jsx("button",{onClick:G=>T(G,"foil",-1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:i<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-orange-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:G=>{G.stopPropagation(),h&&h(a,1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-orange-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:o}),s.jsx("span",{className:"text-[8px] font-black uppercase text-orange-600 tracking-[0.2em] -mt-1",children:"Wish"})]}),s.jsx("button",{onClick:G=>{G.stopPropagation(),h&&h(a,-1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:o<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]})]})]})};function D_({title:a,titleId:n,...i},o){return w.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":n},i),a?w.createElement("title",{id:n},a):null,w.createElement("path",{fillRule:"evenodd",d:"M3.792 2.938A49.069 49.069 0 0 1 12 2.25c2.797 0 5.54.236 8.209.688a1.857 1.857 0 0 1 1.541 1.836v1.044a3 3 0 0 1-.879 2.121l-6.182 6.182a1.5 1.5 0 0 0-.439 1.061v2.927a3 3 0 0 1-1.658 2.684l-1.757.878A.75.75 0 0 1 9.75 21v-5.818a1.5 1.5 0 0 0-.44-1.06L3.13 7.938a3 3 0 0 1-.879-2.121V4.774c0-.897.64-1.683 1.542-1.836Z",clipRule:"evenodd"}))}const mb=w.forwardRef(D_),U_=({value:a,onChange:n})=>{const[i,o]=w.useState(!1),d=w.useRef(null),h=[{label:"=",value:"="},{label:"",value:">="},{label:"",value:"<="}];w.useEffect(()=>{const p=x=>{d.current&&!d.current.contains(x.target)&&o(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const g=h.find(p=>p.value===a)||h[0];return s.jsxs("div",{className:"relative",ref:d,children:[s.jsxs("button",{type:"button",onClick:()=>o(!i),className:"flex items-center gap-2 px-3 py-3 bg-gray-900/50 hover:bg-gray-800 text-indigo-400 font-bold rounded-l-xl border-r border-white/10 transition-colors min-w-[50px] justify-center",children:[g.label,s.jsx("svg",{className:`w-3 h-3 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&s.jsx("div",{className:"absolute top-full left-0 mt-1 w-20 bg-gray-900 border border-white/10 rounded-lg shadow-2xl z-[70] overflow-hidden backdrop-blur-xl",children:h.map(p=>s.jsx("button",{type:"button",onClick:()=>{n(p.value),o(!1)},className:`w-full px-4 py-2 text-left text-sm font-bold transition-colors ${a===p.value?"bg-indigo-600 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:p.label},p.value))})]})},pb=({isOpen:a,onClose:n,onAddCard:i})=>{const[o,d]=w.useState(""),[h,g]=w.useState(!1),[p,x]=w.useState(""),[b,N]=w.useState(""),[j,_]=w.useState(!1),[I,L]=w.useState([]),[T,U]=w.useState(!1),[P,z]=w.useState([]),[G,X]=w.useState("or"),[se,te]=w.useState(!1),[R,k]=w.useState(!1),[E,S]=w.useState([]),[A,B]=w.useState(""),[O,ye]=w.useState(""),[ue,V]=w.useState({operator:"=",value:""}),[ie,K]=w.useState({operator:"=",value:""}),[oe,me]=w.useState({operator:"=",value:""}),[D,F]=w.useState(""),[W,q]=w.useState(""),{results:Q,loading:xe,error:pe,searchCards:_e,getSuggestions:Te}=M_(),{currentUser:Ve}=vt(),{addToast:Ie}=Rn(),{cards:Ye,refresh:xt}=Yn(),we=w.useRef(null),je=w.useRef(null),Ee=O_(o,300);w.useEffect(()=>{Ee.length>=2&&h?ke(Ee):Ee.length<2&&L([])},[Ee]);const ke=async de=>{const De=await Te(de);L(De),U(De.length>0)},Ae=w.useMemo(()=>{const de=new Map;return Ye&&Ye.forEach(De=>{const Ze=De.scryfall_id||De.id;de.has(Ze)||de.set(Ze,[]),de.get(Ze).push(De)}),de},[Ye]);w.useEffect(()=>{a&&we.current&&we.current.focus()},[a]);const Ce=de=>{de&&de.preventDefault(),U(!1);const De={set:p,cn:b,colors:P.length>0?P:void 0,colorLogic:G,colorIdentity:se,colorExcluded:R,rarity:E.length>0?E:void 0,type:A,text:O,flavor:D,artist:W,mv:ue.value!==""?{operator:ue.operator,value:Number(ue.value)}:void 0,power:ie.value!==""?{operator:ie.operator,value:Number(ie.value)}:void 0,toughness:oe.value!==""?{operator:oe.operator,value:Number(oe.value)}:void 0};_e(o,De)},Be=()=>{d(""),x(""),N(""),z([]),k(!1),S([]),B(""),ye(""),V({operator:"=",value:""}),K({operator:"=",value:""}),me({operator:"=",value:""}),F(""),q("")},Vt=de=>{z(De=>De.includes(de)?De.filter(Ze=>Ze!==de):[...De,de])},ge=de=>{S(De=>De.includes(de)?De.filter(Ze=>Ze!==de):[...De,de])},fe=async(de,De,Ze)=>{if(!Ve)return Ie("Please log in","error");try{const Mn=de.id,qt=Ae.get(Mn)||[],tn=De==="foil"?"foil":"nonfoil",rt=qt.find(Ct=>Ct.finish===tn&&!Ct.deck_id&&!Ct.is_wishlist);Ze>0?rt?(await en.updateCard(rt.id,{count:rt.count+1}),Ie(`Added ${tn} ${de.name}`,"success")):(await en.addCardToCollection(Ve.uid,de,1,tn),Ie(`Added new ${tn} ${de.name}`,"success")):rt&&(rt.count>1?(await en.updateCard(rt.id,{count:rt.count-1}),Ie(`Removed ${tn} ${de.name}`,"info")):(await en.removeCard(rt.id),Ie(`Removed last ${tn} ${de.name}`,"info"))),xt()}catch(Mn){console.error("Update failed",Mn),Ie("Failed to update collection","error")}},ve=async(de,De)=>{if(!Ve)return Ie("Please log in","error");try{const Ze=de.id,qt=(Ae.get(Ze)||[]).find(tn=>tn.is_wishlist&&!tn.deck_id);De>0?qt?(await en.updateCard(qt.id,{count:qt.count+1}),Ie(`Increased ${de.name} in wishlist`,"success")):(await en.addCardToCollection(Ve.uid,de,1,"nonfoil",!0),Ie(`Added ${de.name} to wishlist`,"success")):qt&&(qt.count>1?(await en.updateCard(qt.id,{count:qt.count-1}),Ie(`Decreased ${de.name} in wishlist`,"info")):(await en.removeCard(qt.id),Ie(`Removed ${de.name} from wishlist`,"info"))),xt()}catch(Ze){console.error("Wishlist update failed",Ze),Ie("Failed to update wishlist","error")}};if(!a)return null;const Me={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"},C:{bg:"bg-gray-400",text:"text-gray-900",border:"border-gray-500",symbol:"https://svgs.scryfall.io/card-symbols/C.svg"}};return aa.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-fade-in",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md transition-opacity",onClick:n}),s.jsxs("div",{className:"relative bg-gray-900 border border-white/10 rounded-3xl shadow-2xl w-full max-w-7xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-white/5",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-gray-950/50 flex-shrink-0",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-indigo-400",children:"Card Library"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-500/20 text-indigo-300 uppercase tracking-wider border border-indigo-500/30",children:"Database"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search the entire Scryfall database to grow your collection."})]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-xl",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar",children:[s.jsx("div",{className:"p-6 bg-gray-900 space-y-4 relative z-[60] border-b border-white/5",children:s.jsxs("form",{onSubmit:Ce,className:"relative flex flex-col gap-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative flex-1 group",children:[s.jsx("input",{ref:we,type:"text",placeholder:"Search cards...",className:"w-full bg-gray-950 text-white border border-white/10 rounded-2xl py-4 px-6 pl-14 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all placeholder-gray-600 shadow-inner",value:o,onChange:de=>{d(de.target.value),g(!0),U(!0)},onFocus:()=>o.length>=2&&U(!0)}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),T&&I.length>0&&s.jsx("div",{ref:je,className:"absolute top-full left-0 right-0 mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[100] py-2 max-h-60 overflow-y-auto custom-scrollbar",children:I.map((de,De)=>s.jsx("button",{type:"button",onClick:()=>{d(de),g(!1),U(!1),_e(de,{set:p,cn:b})},className:"w-full text-left px-6 py-3 hover:bg-white/5 text-gray-400 hover:text-white transition-colors border-b border-white/5 last:border-0",children:de},De))})]}),s.jsxs("button",{type:"button",onClick:()=>_(!j),className:`px-6 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${j?"bg-indigo-600 text-white border-indigo-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(mb,{className:"w-5 h-5"}),"Advanced Search"]}),s.jsx("button",{type:"submit",disabled:xe,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-2xl text-lg font-bold transition-all disabled:opacity-50 min-w-[120px] shadow-lg shadow-indigo-500/20",children:xe?"...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${j?"max-h-[800px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 space-y-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Advanced Configuration"}),s.jsx("button",{onClick:Be,className:"text-orange-500 hover:text-orange-400 text-[10px] font-black uppercase tracking-widest hover:underline",children:"Reset Filters"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Colors"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex gap-2",children:Object.entries(Me).map(([de,De])=>s.jsx("button",{type:"button",onClick:()=>Vt(de),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${P.includes(de)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:P.includes(de)?"transparent":""},children:s.jsx("img",{src:De.symbol,alt:de,className:`w-full h-full ${P.includes(de)?"drop-shadow-md":"grayscale"}`})},de))}),s.jsx("div",{className:"flex items-center gap-2 text-sm bg-gray-900 border border-white/10 rounded-lg p-1",children:["or","and"].map(de=>s.jsx("button",{type:"button",onClick:()=>X(de),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${G===de?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:de},de))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Rarity"}),s.jsx("div",{className:"flex gap-3",children:["common","uncommon","rare","mythic"].map(de=>s.jsx("button",{type:"button",onClick:()=>ge(de),className:`px-3 py-1.5 rounded-lg border text-xs font-bold uppercase transition-all ${E.includes(de)?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-gray-900 border-white/10 text-gray-500 hover:text-gray-300"}`,children:de.charAt(0)},de))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Type"}),s.jsx("input",{type:"text",placeholder:"Creature, Artifact...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:A,onChange:de=>B(de.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Text"}),s.jsx("input",{type:"text",placeholder:"Rules text...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:O,onChange:de=>ye(de.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Mana Value"}),s.jsxs("div",{className:"flex items-center bg-gray-900 border border-white/10 rounded-xl overflow-hidden",children:[s.jsx(U_,{value:ue.operator,onChange:de=>V({...ue,operator:de})}),s.jsx("input",{type:"number",className:"w-full bg-transparent p-2 text-sm outline-none",value:ue.value,onChange:de=>V({...ue,value:de.target.value})})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Set"}),s.jsx("input",{type:"text",placeholder:"ABC",maxLength:5,className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none uppercase",value:p,onChange:de=>x(de.target.value)})]}),s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"CN"}),s.jsx("input",{type:"text",placeholder:"#",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:b,onChange:de=>N(de.target.value)})]})]})]})]})})]})}),s.jsxs("div",{className:"p-6",children:[pe&&s.jsx("div",{className:"flex items-center justify-center p-8 text-red-400 bg-red-500/10 rounded-2xl border border-red-500/20",children:s.jsx("p",{className:"font-bold",children:pe})}),!xe&&Q.length===0&&(o||j)&&!pe&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("p",{className:"text-lg font-bold",children:"No matches found"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Q.map((de,De)=>{const Ze=Ae.get(de.id)||[],Mn=Ze.filter(rt=>rt.finish==="nonfoil"&&!rt.deck_id&&!rt.is_wishlist).reduce((rt,Ct)=>rt+(Ct.count||1),0),qt=Ze.filter(rt=>rt.finish==="foil"&&!rt.deck_id&&!rt.is_wishlist).reduce((rt,Ct)=>rt+(Ct.count||1),0),tn=Ze.filter(rt=>rt.is_wishlist&&!rt.deck_id).reduce((rt,Ct)=>rt+(Ct.count||1),0);return s.jsx(gb,{card:de,normalCount:Mn,foilCount:qt,wishlistCount:tn,onUpdateCount:fe,onUpdateWishlistCount:ve},de.id||De)})})]})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]}),document.body)},Fn={async sendMessage(a,n,i,o="",d=null){if(!a)throw new Error("API Key is missing. Please add it in Settings.");const h=d?.name||"MTG Forge",g=d?.personality?`Personality: ${d.personality}`:"Personality: Knowledgeable, friendly, and concise.",x=[{role:"user",parts:[{text:`
You are ${h}, an elite Magic: The Gathering AI assistant.
Your goal is to provide accurate, strategic, and engaging advice to players.

**Persona & Style:**
- ${g}
- Use emojis to add flair (e.g., , , , , , , ).
- Format responses using **Tailwind CSS** classes within HTML tags for a premium look.
- Do NOT use Markdown. Output raw HTML that can be injected directly into a <div>.

**Formatting Rules:**
- Use <p class="mb-2 text-gray-300"> for paragraphs.
- Use <strong class="text-indigo-400"> for key terms or card names.
- Use <ul class="list-disc pl-5 mb-2 space-y-1 text-gray-300"> for lists.
- Use <div class="bg-gray-700/50 p-3 rounded-lg border-l-4 border-indigo-500 mb-2"> for important notes or rules citations.
- Use <code class="bg-gray-900 px-1 py-0.5 rounded text-indigo-300 font-mono text-sm"> for mana costs (e.g., {1}{U}{B}) or keywords.

**Content Guidance:**
- If asked about rules, cite the Comprehensive Rules if possible.
- If asked about deck building, consider mana curve, synergy, and format staples.
- If asked about lore, be descriptive and immersive.

Context from User's Current View:
${o}
`.trim()}]},...n.map(j=>({role:j.role==="user"?"user":"model",parts:[{text:j.content}]})),{role:"user",parts:[{text:i}]}],b=["gemini-2.5-flash","gemini-2.0-flash","gemini-flash-latest","gemini-2.5-flash-lite","gemini-2.0-flash-lite","gemini-flash-lite-latest","gemini-exp-1206","gemini-pro-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-pro","gemini-1.5-pro-latest"];let N=null;for(const j of b)try{const _=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${j}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:x})});if(!_.ok){const T=await _.json();if(_.status===404||_.status===429){console.warn(`Model ${j} failed (${_.status}). Trying next...`),N=T;continue}throw new Error(T.error?.message||`Gemini API Error: ${_.statusText}`)}return(await _.json()).candidates?.[0]?.content?.parts?.[0]?.text||"I couldn't generate a response."}catch(_){console.warn(`Error with model ${j}:`,_),N=_}throw console.error("All Gemini models failed. Last error:",N),N||new Error("Failed to connect to any Gemini model.")},async getDeckStrategy(a,n,i=null,o=[],d=null){if(!a)throw new Error("API Key is missing.");const h=d?.name||"The Oracle",g=d?.personality?`Adopt the persona of ${h}: ${d.personality}`:"Act as a Magic: The Gathering expert.",p=o&&o.length>0,x=p?`Existing Deck List Analysis:
${o.map(j=>`- ${j.name} (${j.type_line||"Unknown"})`).join(`
`)}`:"This is a NEW deck build.";let b="";i&&(b=`
                User Playstyle Profile:
                - Archetypes: ${i.archetypes?.join(", ")||"N/A"}
                - Summary: ${i.summary||"N/A"}
                - Aggression: ${i.scores?.aggression||0}
                - Combo Affinity: ${i.scores?.comboAffinity||0}
                - Interaction: ${i.scores?.interaction||0}
                Tailor the deck's theme and card suggestions to align with this playstyle.
            `);const N=`
            ${g} I have chosen "${n}" as my Commander.
            
            ${x}
            
            ${p?"Analyze the PROVIDED deck list. Identify the specific game plan, key synergies between these cards, and how to pilot THIS build.":"Suggest a competitive yet fun deck strategy tailored to the following playstyle."}
            
            ${b}

            **Deck Composition Goals:**
            - Lands: 35-38
            - Mana Ramp: 10-12
            - Card Draw: 10
            - Targeted Removal: 8-10
            - Board Wipes: 2-4
            - Synergy / Strategy: 25-30

            **Mana Curve Goal (Bell Curve):**
            - 1-2 Mana: High volume for setup.
            - 3-4 Mana: Moderate volume for utility/threats.
            - 5+ Mana: Low volume for finishers.

            **Formatting Instructions:**
            - Use **HTML** for the 'strategy' field.
            - The 'theme' field should be a **short, punchy title** (e.g., "Elemental Mastery", "Shadow Infiltration").
            - The 'strategy' field should start with a **Theme Summary**: 2-3 sentences providing high-level context, styled with a distinct, prominent look.
            - Focus on a structured breakdown:
              1. **Welcome/Theme Summary**: A few sentences on why this commander and theme work.
              2. **Commander Context**: What are the assumed or key abilities that drive the build?
              3. **Early Game (Turns 1-3)**: Focus on setup, ramp, and disruption. Use a  emoji.
              4. **Mid Game (Turns 4-6)**: Focus on value engines and commander deployment. Use a  emoji.
              5. **Late Game (Turns 7+)**: Focus on finishers and storming off. Use a  emoji.
              6. **Key Synergies & Combos**: Highlight 3-4 specific card combinations. Use a  emoji.
            - Use **Tailwind CSS** classes (e.g., <span class="text-indigo-400 font-bold">Key Card</span>) to highlight important terms.
            - Use headers for each phase (e.g., <h4 class="text-indigo-400 font-black uppercase mb-2"> Early Game</h4>).
            5. **CRITICAL: Deck Composition Numbers**:
                - You MUST calculate specific counts for this specific commander strategies.
                - Do NOT use generic numbers (like 10/10/10). Tailor them! (e.g., A spellslinger deck might want 25 Instants and only 5 Creatures).
                - The 'functional' categories MUST sum to exactly **99** cards (assuming 1 commander).
                - The 'types' categories MUST sum to exactly **99** cards.
                - Ensure 'Lands' concept matches in both sections (e.g. if Functional Lands is 36, Type Lands should be 36).

            You MUST respond with VALID JSON strictly matching this format:
            {
                "layout": {
                    "functional": {
                        "Lands": 36, 
                        "Mana Ramp": 10,
                        "Card Draw": 10,
                        "Targeted Removal": 10,
                        "Board Wipes": 3,
                        "Synergy / Strategy": 30
                    },
                    "types": {
                        "Creatures": 30,
                        "Instants": 10,
                        "Sorceries": 10,
                        "Artifacts": 10,
                        "Enchantments": 5,
                        "Planeswalkers": 0,
                        "Lands": 34
                    }
                },
                "suggestedName": "...",
                "theme": "...",
                "strategy": "<div>...Structured HTML Content...</div>"
            }
            CRITICAL: 
            1. 'layout' is the MOST IMPORTANT field. It MUST be populated.
            2. 'functional' counts must sum to exactly 99.
            3. 'types' counts must sum to exactly 99. 
            4. Do NOT refer to yourself as "The Oracle" unless your name is explicitly "The Oracle". Use ONLY your assigned name: ${h}.
            Do NOT use markdown code blocks. Return only the JSON string.
        `;try{const _=(await this.sendMessage(a,[],N)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(_)}catch(j){throw console.error("AI Strategy Error:",j),new Error("Failed to generate strategy. Please try again.")}},async generatePlaystyleQuestion(a,n){if(!a)throw new Error("API Key is missing.");const i="You are an expert survey designer for Magic: The Gathering (MTG) players. Your goal is to create the most informative question to understand a user's playstyle based on their previous answers. Questions should be clear and concise, with 3-5 distinct multiple-choice answers. Avoid repeating questions. Focus on different aspects of MTG playstyles, such as deck preferences, game strategies, social interaction styles, and risk tolerance.";let o;n.length===0?o="Generate the very first question for an MTG playstyle questionnaire. This question should gauge the player's overall experience with the game, as this will help tailor subsequent questions.":n.length===1?o="Generate the second question for an MTG playstyle questionnaire. This question should build on the player's overall experience and delve into their specific preferences.":n.length===2?o="Generate the third question for an MTG playstyle questionnaire. This question should explore the player's fantasy or thematic preferences in deck building.":o=`Based on the user's previous answers, generate the next single best question to further refine their playstyle profile. Do not repeat questions.

Previous Answers:
${n.map(g=>`- ${g.question}: ${g.answer}`).join(`
`)}`;const d=`${i}

${o}

Respond with VALID JSON ONLY:
{ "question": "...", "choices": ["...", "..."] }`;try{const g=(await this.sendMessage(a,[],d)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(g)}catch(h){throw console.error("Gemini Question Error:",h),h}},async synthesizePlaystyle(a,n){if(!a)throw new Error("API Key is missing.");const i="You are an expert MTG coach and psychographic analyst. Your task is to analyze a player's answers and synthesize a detailed playstyle profile. The summary should be a concise paragraph. Scores must be 0-100.",o=`Analyze the following questionnaire answers and generate a detailed playstyle profile in JSON format.

${n.map(h=>`- ${h.question} -> ${h.answer}`).join(`
`)}`,d=`${i}

${o}

Respond with VALID JSON ONLY matching this schema:
        {
            "summary": "...",
            "tags": ["tag1", "tag2"],
            "scores": { "aggression": 50, "consistency": 50, "interaction": 50, "variance": 50, "comboAffinity": 50 },
            "archetypes": ["archetype1", "archetype2"]
        }`;try{const g=(await this.sendMessage(a,[],d)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(g)}catch(h){throw console.error("Gemini Synthesis Error:",h),new Error("Failed to synthesize profile.")}},async refinePlaystyleChat(a,n,i,o=null){if(!a)throw new Error("API Key is missing.");const d=o?.name||"The Oracle",h=o?.personality?`Personality: ${o.personality}`:"Personality: Wise, insightful, slightly magical.",g=n.length===0,p=`
            You are ${d}, an expert MTG coach conducting a "Deep Dive" interview to build a player's psychographic profile.
            ${h}

            Current Profile Summary: ${i?.summary||"New Profile"}
            Current Tags: ${i?.tags?.join(", ")||"None"}

            Instructions:
            ${g?`1. Introduce yourself as ${d}.
                   2. Explain that you want to understand their playstyle to help build better decks.
                   3. Ask the FIRST open-ended question to start the profile (e.g. "What draws you to magic?").`:`1. Analyze the user's latest input.
                   2. Formulate a conversational response (warm, insightful, matching your persona).
                   3. Ask ONE follow-up question to dig deeper into a missing or vague area.
                   4. Simultaneously, UPDATE the JSON profile based on the new information (merging with known info).`}
        `,x=n.slice(-6),b=[{role:"user",parts:[{text:p}]},...x.map(I=>({role:I.role==="user"?"user":"model",parts:[{text:I.content}]}))],N=`
            ${g?"Generate the initial greeting and first question.":"Based on the conversation, respond to the user and update the profile."}
            RETURN JSON ONLY.
        `;b.push({role:"user",parts:[{text:N}]});const j=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let _=[];for(const I of j){try{const L=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${I}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:b,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedProfile:{type:"OBJECT",properties:{summary:{type:"STRING"},tags:{type:"ARRAY",items:{type:"STRING"}},scores:{type:"OBJECT",properties:{aggression:{type:"NUMBER"},consistency:{type:"NUMBER"},interaction:{type:"NUMBER"},comboAffinity:{type:"NUMBER"}}},archetypes:{type:"ARRAY",items:{type:"STRING"}}},required:["summary","tags","scores","archetypes"]}},required:["aiResponse","updatedProfile"]}}})});if(L.ok){const U=(await L.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(U)return JSON.parse(U)}else{const T=await L.json();if(_.push(`${I} (Schema): ${L.status} ${T.error?.message||""}`),L.status===404||L.status===429)continue}}catch(L){_.push(`${I} (Schema Error): ${L.message}`)}try{const L=JSON.parse(JSON.stringify(b));L[L.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedProfile: object }`;const T=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${I}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:L})});if(T.ok){const P=(await T.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(P){const z=P.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(z)}}else{const U=await T.json();_.push(`${I} (Raw): ${T.status} ${U.error?.message||""}`)}}catch(L){_.push(`${I} (Raw Error): ${L.message}`)}}throw console.error("Gemini Chat Refine Exhausted:",_),new Error(`Oracle Exhausted: ${_[0]||"Unknown error"}`)},async forgeHelperChat(a,n,i){if(!a)throw new Error("API Key is missing.");const o=`
            You are an expert fantasy writer and character designer allowing a user to "Forge" their own AI companion for Magic: The Gathering.
            Your goal is to interview the user to define their Helper's Persona.
            
            Current Draft:
            - Name: ${i?.name||"Unknown"}
            - Type: ${i?.type||"Unknown"} (e.g., Spirit, Goblin, Construct, Wizard)
            - Personality: ${i?.personality||"Unknown"} (e.g., Snarky, Wise, Aggressive)

            Instructions:
            1. Analyze the user's input.
            2. If they provided new info (name, type, personality), UPDATE the JSON draft locally.
            3. Respond in a neutral, helpful "System" tone (like a character creation menu guide).
            4. Ask for the missing fields one by one.
            5. If all fields are present, ask for confirmation.
        `,d=n.slice(-6),h=[{role:"user",parts:[{text:o}]},...d.map(b=>({role:b.role==="user"?"user":"model",parts:[{text:b.content}]}))];h.push({role:"user",parts:[{text:`
            Based on the conversation, respond to the user and update the helper draft.
            RETURN JSON ONLY.
        `}]});const p=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let x=[];for(const b of p){try{const N=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:h,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedDraft:{type:"OBJECT",properties:{name:{type:"STRING"},type:{type:"STRING"},personality:{type:"STRING"}},required:["name","type","personality"]}},required:["aiResponse","updatedDraft"]}}})});if(N.ok){const _=(await N.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(_)return JSON.parse(_)}else{const j=await N.json();if(x.push(`${b}: ${N.status}`),N.status===404||N.status===429)continue}}catch(N){x.push(`${b}: ${N.message}`)}try{const N=JSON.parse(JSON.stringify(h));N[N.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedDraft: object }`;const j=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:N})});if(j.ok){const I=(await j.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(I){const L=I.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(L)}}}catch{}}throw new Error(`Forge Exhausted: ${x.join(" | ")}`)},async generateDeckSuggestions(a,n,i=null){if(!a)throw new Error("API Key is missing.");const{playstyle:o,targetRole:d}=n,h=i?.name||"Expert MTG Deck Builder",g=i?.personality?`Adopt the persona of ${h}: ${i.personality}`:"";let p="";o&&(p=`
                User Playstyle: ${o.archetypes?.join(", ")||"N/A"}. 
                Summary: ${o.summary||"N/A"}.
            `);const x=`
            You are ${h}. ${g}
            Analyze candidates for a ${d||"general"} role in the deck.
            ${p}
            
            **Mana Curve Priorities (Bell Curve):**
            Focus on CMC 1-2 for high volume, 3-4 for moderate, 5+ for finishers.
            
            **Basic Land Split Logic:**
            If targetRole is 'Lands', and you cannot fill the required count with provided candidates, suggest a 'Basic Land Split' at the END of the suggestions array.
        `,b=["gemini-2.0-flash","gemini-flash-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-flash-001","gemini-1.5-flash-002","gemini-1.5-pro","gemini-1.5-pro-latest"],N={role:"system",parts:[{text:x}]},j=[{role:"user",parts:[{text:`Task: ${n.instructions}

Candidates: ${JSON.stringify(n.candidates)}

IMPORTANT: You MUST respond with a VALID JSON object containing a "suggestions" array. Each suggestion needs "rating" (1-10) and "reason" (string).`}]}];let _=[];for(const I of b){try{const L=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${I}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:N,contents:j,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},name:{type:"STRING"},count:{type:"NUMBER"},rating:{type:"NUMBER"},reason:{type:"STRING"},isBasicLand:{type:"BOOLEAN"}},required:["rating","reason"]}}},required:["suggestions"]}}})});if(L.ok){const U=(await L.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(U)return JSON.parse(U)}else{const T=await L.json();if(_.push(`${I} (Schema): ${L.status} ${T.error?.message||""}`),L.status===404||L.status===429)continue}}catch(L){_.push(`${I} (Schema Error): ${L.message}`)}try{const L=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${I}:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:N,contents:[{role:"user",parts:[{text:`${j[0].parts[0].text}

You MUST respond with VALID RAW JSON format ONLY. Do not use markdown blocks.`}]}]})});if(L.ok){const U=(await L.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(U){const P=U.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(P)}}else{const T=await L.json();_.push(`${I} (Raw): ${L.status} ${T.error?.message||""}`)}}catch(L){_.push(`${I} (Raw Error): ${L.message}`)}}throw console.error("[Gemini] All models failed. Summary:",_),new Error(`Oracle Exhausted: ${_.join(" | ")}`)}},Zc=10,xb=({isOpen:a,onClose:n,onComplete:i})=>{const{userProfile:o}=vt(),[d,h]=w.useState("selection"),[g,p]=w.useState("intro"),[x,b]=w.useState([]),[N,j]=w.useState([]),[_,I]=w.useState(null),[L,T]=w.useState(null),[U,P]=w.useState([]),[z,G]=w.useState(null),[X,se]=w.useState(""),te=w.useRef(null),[R,k]=w.useState(!1),[E,S]=w.useState(null),A=o?.settings?.helper?.name||"The Oracle";w.useEffect(()=>{a&&B()},[a]),w.useEffect(()=>{te.current?.scrollIntoView({behavior:"smooth"})},[U]);const B=()=>{h("selection"),p("intro"),j([]),P([]),G(null),S(null),T(null),se("")},O=()=>{h("quick"),p("loading"),ye([])},ye=async D=>{p("loading"),k(!0),S(null),T(null);try{const F=o?.settings?.geminiApiKey;if(!F)throw new Error("Gemini API Key is missing.");const W=await Fn.generatePlaystyleQuestion(F,D);I(W),p("question")}catch(F){console.error("Quick Wizard Error:",F),S(F.message||"Failed to summon the oracle."),h("error")}finally{k(!1)}},ue=async D=>{T(D),await new Promise(q=>setTimeout(q,600));const F={question:_.question,answer:D},W=[...N,F];j(W),W.length>=Zc?V(W):ye(W)},V=async D=>{h("synthesis");try{const F=o?.settings?.geminiApiKey,W=await Fn.synthesizePlaystyle(F,D);i&&await i(W),n()}catch{S("Failed to synthesize your profile."),h("error")}},ie=async()=>{h("advanced"),p("chat"),k(!0),G({summary:"Pending analysis...",tags:[],scores:{}});try{const D=o?.settings?.geminiApiKey;if(!D)throw new Error("API Key missing.");const F=await Fn.refinePlaystyleChat(D,[],z,o.settings.helper);P([{role:"model",content:F.aiResponse}])}catch(D){console.error("Intro Error:",D),P([{role:"model",content:`Greetings. I am ${A}. Let us begin our analysis.`}])}finally{k(!1)}},K=async()=>{if(!X.trim())return;const D={role:"user",content:X},F=[...U,D];P(F),se(""),k(!0);try{const W=o?.settings?.geminiApiKey;if(!W)throw new Error("API Key missing.");const q=await Fn.refinePlaystyleChat(W,F,z,o.settings.helper);G(q.updatedProfile),P(Q=>[...Q,{role:"model",content:q.aiResponse}])}catch(W){console.error("Chat Error:",W),P(q=>[...q,{role:"model",content:"My connection to the leyline flickered. Please repeat that."}])}finally{k(!1)}},oe=async()=>{h("synthesis"),z&&i&&await i(z),n()},me=D=>{D.key==="Enter"&&!D.shiftKey&&(D.preventDefault(),K())};return a?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl h-[85vh] bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[s.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-20 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),d==="selection"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 space-y-12 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"How shall we determine your magical signature?"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl",children:[s.jsxs("button",{onClick:O,className:"group relative bg-gray-800/50 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13 2L3 14h9v8l10-12h-9l9-8z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Quick Setup"}),s.jsxs("p",{className:"text-gray-400 group-hover:text-gray-300",children:["Answer ",Zc," rapid-fire questions to generate a baseline profile. Best for getting started quickly."]}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-indigo-400 uppercase tracking-wider",children:["Start Assessment ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]}),s.jsxs("button",{onClick:ie,className:"group relative bg-gray-800/50 hover:bg-purple-900/20 border border-gray-700 hover:border-purple-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-purple-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-purple-300 transition-colors",children:"Deep Dive"}),s.jsx("p",{className:"text-gray-400 group-hover:text-gray-300",children:"Have a conversation with the Oracle. Iterate on your preferences in real-time for a highly tailored profile."}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-purple-400 uppercase tracking-wider",children:["Enter The Sanctum ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]})]}),s.jsx("div",{className:"text-gray-500 text-sm",children:"You can always retake this assessment later from your profile settings."})]}),d==="quick"&&s.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gray-900",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-8 bg-gray-900/50",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500 mr-3"}),"Quick Assessment"]}),s.jsxs("div",{className:"text-sm font-mono text-indigo-400",children:["Q",N.length+1," / ",Zc]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-8 flex flex-col items-center justify-center",children:g==="loading"?s.jsxs("div",{className:"flex flex-col items-center space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-indigo-300 font-medium",children:"Consulting the archives..."})]}):_&&s.jsxs("div",{className:"max-w-2xl w-full space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-500 ease-out",style:{width:`${N.length/Zc*100}%`}})}),s.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white leading-relaxed text-center",children:_.question}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:_.choices.map((D,F)=>{const W=L===D;return s.jsxs("button",{onClick:()=>ue(D),disabled:L!==null,className:`
                                                            group flex items-center p-4 rounded-xl border transition-all duration-200 text-left
                                                            ${W?"bg-indigo-600/20 border-indigo-500 shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-gray-800 border-gray-700 hover:bg-gray-750 hover:border-gray-600"}
                                                            ${L&&!W?"opacity-50":""}
                                                        `,children:[s.jsx("span",{className:`
                                                            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-4 transition-colors
                                                            ${W?"bg-indigo-500 text-white":"bg-gray-700 text-gray-400 group-hover:bg-gray-600"}
                                                        `,children:String.fromCharCode(65+F)}),s.jsx("span",{className:`text-lg transition-colors ${W?"text-white":"text-gray-300 group-hover:text-white"}`,children:D})]},F)})})]})})]}),d==="advanced"&&s.jsxs("div",{className:"flex-1 flex h-full",children:[s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 border-r border-gray-800 w-2/3",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center px-6 bg-gray-900/80 backdrop-blur-sm z-10",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold",children:A}),s.jsx("p",{className:"text-xs text-purple-400",children:"Deep Dive Analysis"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[U.map((D,F)=>s.jsx("div",{className:`flex ${D.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`
                                            max-w-[80%] rounded-2xl p-4 text-sm leading-relaxed
                                            ${D.role==="user"?"bg-purple-600 text-white rounded-br-none":"bg-gray-800 text-gray-200 border border-gray-700 rounded-bl-none"}
                                        `,children:D.content})},F)),R&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 border border-gray-700 rounded-bl-none flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-100"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-200"})]})}),s.jsx("div",{ref:te})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:X,onChange:D=>se(D.target.value),onKeyDown:me,placeholder:"Describe your playstyle...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500",disabled:R}),s.jsx("button",{onClick:K,disabled:R||!X.trim(),className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 rounded-xl font-bold transition-colors",children:"Send"})]})})]}),s.jsxs("div",{className:"w-1/3 bg-gray-950 p-6 overflow-y-auto border-l border-gray-800 hidden md:block",children:[s.jsxs("h3",{className:"text-white font-bold mb-6 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Live Profile Summary"]}),z?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Analysis"}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:z.summary||"Gathering data..."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Dominant Traits"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:z.tags?.length>0?z.tags.map((D,F)=>s.jsx("span",{className:"px-2 py-1 rounded bg-purple-500/10 text-purple-400 border border-purple-500/20 text-xs font-medium",children:D},F)):s.jsx("span",{className:"text-gray-600 text-xs italic",children:"Pending..."})})]}),z.scores&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Psychographics"}),Object.entries(z.scores).map(([D,F])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1 capitalize",children:[s.jsx("span",{children:D.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{children:[F,"%"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-indigo-500",style:{width:`${F}%`}})})]},D))]}),s.jsxs("div",{className:"pt-6 border-t border-gray-800",children:[s.jsx("button",{onClick:oe,className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold shadow-lg hover:shadow-green-500/20 transition-all",children:"Finalize Profile"}),s.jsx("p",{className:"text-center text-xs text-gray-500 mt-2",children:"Click whenever you feel the profile is accurate."})]})]}):s.jsxs("div",{className:"text-center py-10 text-gray-600",children:[s.jsx("div",{className:"animate-pulse mb-2 text-4xl",children:""}),s.jsx("p",{className:"text-sm",children:"The Oracle is listening..."})]})]})]}),d==="synthesis"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6 bg-gray-900 p-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-t-2 border-b-2 border-green-500"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"h-10 w-10 bg-green-500/20 rounded-full animate-pulse"})})]}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Finalizing your Grimoire..."}),s.jsx("p",{className:"text-gray-400",children:"Saving your magical identity to the archives."})]}),d==="error"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4 bg-gray-900 text-center p-8",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Something went wrong"}),s.jsx("p",{className:"text-red-300 max-w-md mx-auto",children:E}),s.jsx("button",{onClick:B,className:"mt-6 bg-gray-800 hover:bg-gray-700 text-white py-3 px-8 rounded-lg transition-colors border border-gray-600",children:"Try Again"})]})]})}):null},B_=({isOpen:a,onClose:n,profile:i,onRetake:o,userImage:d})=>{if(!a)return null;if(!i)return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-md bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col p-8 text-center space-y-6",children:[s.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:d?s.jsx("img",{src:d,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Playstyle Found"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"You haven't taken the assessment yet. Discover your magical identity and get better recommendations!"})]}),s.jsx("button",{onClick:o,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-0.5",children:"Start Assessment"})]})});const{summary:h,tags:g,scores:p,archetypes:x}=i;return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[s.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-800/50 p-8 border-b md:border-b-0 md:border-r border-gray-700 flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-6 ring-4 ring-gray-800 overflow-hidden",children:d?s.jsx("img",{src:d,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Playstyle"}),s.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:g&&g.map((b,N)=>s.jsx("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase rounded-full border border-indigo-500/30",children:b},N))}),s.jsx("button",{onClick:o,className:"mt-auto w-full py-3 px-4 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg text-sm font-bold transition-all border border-gray-600 hover:border-gray-500",children:"Retake Assessment"})]}),s.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Analysis Summary"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed text-lg font-serif italic border-l-4 border-indigo-500 pl-4 bg-gray-800/30 py-4 pr-4 rounded-r",children:['"',h,'"']})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Psychographic Profile"}),s.jsx("div",{className:"space-y-4",children:p&&Object.entries(p).map(([b,N])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-400 capitalize",children:b.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{className:"text-white font-mono",children:[N,"/100"]})]}),s.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${z_(N)}`,style:{width:`${N}%`}})})]},b))})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Recommended Archetypes"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:x&&x.map((b,N)=>s.jsxs("div",{className:"bg-gray-800/80 p-4 rounded-lg border border-gray-700 flex items-center gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.5)]"}),s.jsx("span",{className:"text-gray-200 font-medium",children:b})]},N))})]})]})]})]})]})})};function z_(a){return a>75?"bg-green-500":a>50?"bg-blue-500":a>25?"bg-yellow-500":"bg-red-500"}const P_=[{id:"alpha_tester",label:"Alpha Tester",icon:"",description:"Restoring balance to the multiverse."},{id:"bug_hunter",label:"Bug Hunter",icon:"",description:"Tracking down pests in the code."},{id:"architect",label:"Architect",icon:"",description:"Building the foundation of the future."},{id:"spark_ignited",label:"Spark Ignited",icon:"",description:"First to walk the planes."},{id:"data_scryer",label:"Data Scryer",icon:"",description:"Analyzing the meta streams."},{id:"stress_tester",label:"Stress Tester",icon:"",description:"Breaking things so we can fix them."},{id:"feedback_loop",label:"Feedback Loop",icon:"",description:"Iterating towards perfection."},{id:"void_gazer",label:"Void Gazer",icon:"",description:"Staring into the console logs."}],H_=({isOpen:a,onClose:n,currentBadgeId:i,onSelect:o,isMaster:d})=>a?s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto w-full h-full flex items-center justify-center pl-[250px]",children:[s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:n}),s.jsxs("div",{className:"relative bg-gray-900 rounded-2xl border border-gray-700 shadow-2xl w-full max-w-2xl mx-4 overflow-hidden animate-scale-in",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-500",children:""})," Customize Your Badge"]}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a badge to display next to your profile."})]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto custom-scrollbar",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:P_.filter(h=>h.id!=="architect"||d).map(h=>s.jsxs("button",{onClick:()=>o(h),className:`flex items-center gap-4 p-4 rounded-xl border text-left transition-all ${i===h.id?"bg-indigo-900/30 border-indigo-500 ring-1 ring-indigo-500/50":"bg-gray-800/30 border-gray-700 hover:bg-gray-800 hover:border-gray-600"}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-2xl shadow-inner border border-gray-700",children:h.icon}),s.jsxs("div",{children:[s.jsx("h3",{className:`font-bold ${i===h.id?"text-indigo-300":"text-white"}`,children:h.label}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.description})]})]},h.id))})}),s.jsx("div",{className:"p-4 bg-gray-800/50 border-t border-gray-800 text-center text-xs text-gray-500",children:"Thank you for being an early supporter of MTG-Forge."})]})]}):null,G_=()=>{const a=zs(),{currentUser:n,userProfile:i,logout:o,updateSettings:d,refreshUserProfile:h,uploadProfilePicture:g}=vt(),p=a.pathname==="/",[x,b]=w.useState(!1),[N,j]=w.useState(!1),[_,I]=w.useState(!1),[L,T]=w.useState(!1),[U,P]=w.useState(!1),[z,G]=w.useState(!1),X=Tn.useRef(null);Tn.useEffect(()=>{const B=O=>{U&&!O.target.closest("#user-menu-button")&&!O.target.closest("#user-menu-dropdown")&&P(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[U]);const se=async B=>{console.log("Saving new playstyle:",B),await d({playstyle:B}),await h(),I(!0)},te=async B=>{const O=B.target.files[0];if(O)try{G(!0),await g(O)}catch(ye){alert(ye.message)}finally{G(!1),P(!1)}},R=()=>{X.current?.click()},k=n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",E=k?"FORGE MASTER":n?.email||"",S=k?{icon:""}:i?.settings?.badge||{icon:""},A=async()=>{try{await o(),window.location.href="/"}catch(B){console.error("Logout failed",B)}};return s.jsxs(s.Fragment,{children:[s.jsx("nav",{className:"bg-gray-950/30 backdrop-blur-2xl border-b border-white/5 sticky top-0 z-50",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-between h-16",children:s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsx("div",{className:"flex-shrink-0 flex items-center gap-3",children:s.jsxs(yt,{to:"/",className:"flex items-center gap-2 transform hover:scale-105 transition-transform",children:[s.jsx("img",{src:"/logo.png",alt:"MTG Forge Logo",className:"h-10 w-auto"}),s.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent hidden sm:inline-block",children:"MTG-Forge"}),s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded ml-1 animate-pulse",children:"ALPHA"})]})}),s.jsx("div",{className:"hidden lg:ml-10 lg:flex lg:items-baseline lg:space-x-4",children:p?s.jsxs(s.Fragment,{children:[s.jsx("a",{href:"#features",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Features"}),s.jsx(yt,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})]}):s.jsxs(s.Fragment,{children:[s.jsx(yt,{to:"/dashboard",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Dashboard"}),s.jsx(yt,{to:"/collection",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Collection"}),s.jsx(yt,{to:"/wishlist",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Wishlist"}),s.jsx(yt,{to:"/decks",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Decks"}),s.jsx(yt,{to:"/sets",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Sets"})]})}),s.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[n&&s.jsxs("button",{onClick:()=>b(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20 flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"inline",children:"Add Card"})]}),n?s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[(i?.settings?.subscription_tier==="alpha_tester"||!i?.settings?.subscription_tier||k)&&s.jsxs("button",{onClick:()=>T(!0),className:`flex items-center justify-center w-8 h-8 rounded-full border transition-all group relative ${k?"bg-amber-500/20 border-amber-500/50 hover:bg-amber-500/30 shadow-[0_0_10px_rgba(245,158,11,0.3)]":"bg-indigo-900/30 border-indigo-500/30 hover:bg-indigo-900/50"}`,title:k?"Data Architect":"Click to change badge",children:[s.jsx("span",{className:"text-base",children:S.icon}),k&&s.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-amber-500"})]})]}),s.jsx("span",{className:`text-sm font-medium ${k?"text-amber-400 font-bold tracking-wider":"text-gray-300 max-w-[150px] truncate"}`,children:E}),s.jsx("button",{id:"user-menu-button",onClick:()=>P(!U),className:"text-gray-400 hover:text-white transition-colors focus:outline-none",children:n.photoURL?s.jsx("img",{src:n.photoURL,alt:"Profile",className:"h-8 w-8 rounded-full object-cover ring-2 ring-transparent hover:ring-indigo-500 transition-all border border-gray-600"}):s.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-500/20 border border-indigo-500/50 flex items-center justify-center ring-2 ring-transparent hover:ring-indigo-500 transition-all",children:s.jsx("span",{className:"text-xs font-bold text-indigo-300",children:n.email?n.email[0].toUpperCase():"U"})})})]}),U&&s.jsxs("div",{id:"user-menu-dropdown",className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 border border-gray-700 ring-1 ring-black ring-opacity-5 animate-fade-in-up",children:[s.jsxs("div",{className:"px-4 py-2 border-b border-gray-700",children:[s.jsx("p",{className:"text-sm text-white font-bold",children:"Account"}),s.jsx("p",{className:"text-xs text-gray-400 truncate",children:n.email})]}),s.jsx("button",{onClick:R,disabled:z,className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:z?"Uploading...":"Upload Photo"}),s.jsx("input",{type:"file",ref:X,onChange:te,className:"hidden",accept:"image/*"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{P(!1),I(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Playstyle Profile"}),s.jsx(yt,{to:"/settings",onClick:()=>P(!1),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Settings"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{P(!1),A()},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 hover:text-red-300",children:"Sign Out"})]})]}):s.jsx(yt,{to:"/login",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Sign In"})]})]})})})}),s.jsx(pb,{isOpen:x,onClose:()=>b(!1)}),s.jsx(xb,{isOpen:N,onClose:()=>j(!1),onComplete:se}),s.jsx(B_,{isOpen:_,onClose:()=>I(!1),profile:i?.settings?.playstyle,userImage:n?.photoURL,onRetake:()=>{I(!1),j(!0)}}),s.jsx(H_,{isOpen:L,onClose:()=>T(!1),currentBadgeId:i?.settings?.badge?.id||"alpha_tester",isMaster:n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",onSelect:async B=>{await d({badge:B}),await h(),T(!1)}}),!p&&s.jsx("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-gray-900 border-t border-gray-800 z-50 pb-safe",children:s.jsxs("div",{className:"flex justify-around items-center h-16",children:[s.jsxs(yt,{to:"/dashboard",className:`flex flex-col items-center justify-center w-full h-full ${a.pathname==="/dashboard"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Home"})]}),s.jsxs(yt,{to:"/collection",className:`flex flex-col items-center justify-center w-full h-full ${a.pathname==="/collection"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Collection"})]}),s.jsxs(yt,{to:"/wishlist",className:`flex flex-col items-center justify-center w-full h-full ${a.pathname==="/wishlist"?"text-orange-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Wishlist"})]}),s.jsxs(yt,{to:"/decks",className:`flex flex-col items-center justify-center w-full h-full ${a.pathname.startsWith("/decks")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Decks"})]}),s.jsxs(yt,{to:"/sets",className:`flex flex-col items-center justify-center w-full h-full ${a.pathname.startsWith("/sets")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Sets"})]}),s.jsxs(yt,{to:"/settings",className:`flex flex-col items-center justify-center w-full h-full ${a.pathname==="/settings"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Settings"})]})]})})]})},V_=()=>s.jsx("section",{id:"features",className:"py-20 bg-gray-900 relative",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-20 animate-fade-in-up",children:[s.jsx("span",{className:"text-indigo-400 font-bold tracking-widest uppercase text-sm mb-2 block",children:"Why Choose The Forge?"}),s.jsx("h2",{className:"text-3xl md:text-5xl font-black text-white mb-6",children:"More Than Just A Deck Builder"}),s.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto text-lg",children:"Experience the next generation of Magic: The Gathering tools. Powered by AI, designed for Commander players."})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-12 mb-24",children:[s.jsxs("div",{className:"flex-1 space-y-6 animate-fade-in-left",children:[s.jsx("div",{className:"w-16 h-16 bg-purple-500/20 rounded-2xl flex items-center justify-center mb-4 text-purple-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-3xl font-bold text-white",children:"AI-Powered Strategy"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Don't just build listsbuild strategies. Our Gemini-integrated AI analyzes your commander and suggests synergies, mana curves, and win conditions tailored to your playstyle."}),s.jsxs("ul",{className:"space-y-3 text-gray-300",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Automated Theme Suggestions"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Intelligent Land Base Generation"]})]})]}),s.jsx("div",{className:"flex-1 rounded-2xl overflow-hidden shadow-2xl border border-gray-800 group animate-fade-in-right",children:s.jsx("div",{className:"aspect-video bg-gray-800 relative flex items-center justify-center",children:s.jsx("img",{src:"/images/features/ai-strategy-modal.png",alt:"AI Strategy Modal showing detailed deck analysis",className:"w-full h-full object-cover rounded-2xl opacity-90 group-hover:opacity-100 transition-opacity"})})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-12 mb-24",children:[s.jsxs("div",{className:"flex-1 space-y-6 animate-fade-in-right",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center mb-4 text-blue-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-3xl font-bold text-white",children:"Advanced Collection Tracking"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:'Track every card you own, from foils to promos. Filter by set, rarity, color identity, and price. Manage your "Wishlist" separate from your main binder.'}),s.jsxs("ul",{className:"space-y-3 text-gray-300",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Real-time TCGPlayer Pricing"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"CSV Export & Import"]})]})]}),s.jsx("div",{className:"flex-1 rounded-2xl overflow-hidden shadow-2xl border border-gray-800 animate-fade-in-left",children:s.jsx("div",{className:"aspect-video bg-gray-800 relative flex items-center justify-center",children:s.jsx("img",{src:"/images/features/collection-dashboard.jpg",alt:"Collection Dashboard showing card grid",className:"w-full h-full object-cover rounded-2xl opacity-90 hover:opacity-100 transition-opacity"})})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-12 mb-24",children:[s.jsxs("div",{className:"flex-1 space-y-6 animate-fade-in-left",children:[s.jsx("div",{className:"w-16 h-16 bg-orange-500/20 rounded-2xl flex items-center justify-center mb-4 text-orange-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),s.jsx("h3",{className:"text-3xl font-bold text-white",children:"Commander-Centric Design"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Built specially for EDH. Browse legends by guild, shard, or wedge. Filter by color identity rules. Manage partners and backgrounds seamlessly."})]}),s.jsx("div",{className:"flex-1 rounded-2xl overflow-hidden shadow-2xl border border-gray-800 animate-fade-in-right",children:s.jsx("div",{className:"aspect-video bg-gray-800 relative flex items-center justify-center",children:s.jsx("img",{src:"/images/features/commander-centric-design.png",alt:"My Decks view showing commanders",className:"w-full h-full object-cover rounded-2xl opacity-90 hover:opacity-100 transition-opacity"})})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-12",children:[s.jsxs("div",{className:"flex-1 space-y-6 animate-fade-in-right",children:[s.jsx("div",{className:"w-16 h-16 bg-pink-500/20 rounded-2xl flex items-center justify-center mb-4 text-pink-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h3",{className:"text-3xl font-bold text-white",children:"Custom AI Personas"}),s.jsxs("p",{className:"text-gray-400 text-lg leading-relaxed",children:['Forge your own assistant. Define their personality, tone, and expertise. Whether you need a ruthless "Deity" to optimize your curve or a chaotic "Goblin" to suggest fun jank, your AI companion adapts to ',s.jsx("em",{children:"your"})," goals."]})]}),s.jsx("div",{className:"flex-1 rounded-2xl overflow-hidden shadow-2xl border border-gray-800 animate-fade-in-left",children:s.jsx("div",{className:"aspect-video bg-gray-800 relative flex items-center justify-center",children:s.jsx("img",{src:"/images/features/custom-ai-persona.png",alt:"Custom AI Persona creation interface",className:"w-full h-full object-cover rounded-2xl opacity-90 hover:opacity-100 transition-opacity"})})})]})]})}),$_=()=>s.jsxs("div",{className:"flex flex-col min-h-screen",children:[s.jsx("div",{className:"bg-gradient-to-r from-orange-600 via-red-600 to-orange-600 text-white text-center py-2 px-4 shadow-lg z-50 relative animate-pulse-slow",children:s.jsxs("p",{className:"font-bold text-sm tracking-wide flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-lg",children:""}),"ALPHA TEST - Feature Complete but Experimental",s.jsx("span",{className:"text-lg",children:""})]})}),s.jsxs("div",{className:"relative bg-gray-900 border-b border-gray-800",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 z-10"}),s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover object-center absolute inset-0 z-0 opacity-80"})]}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 md:py-32 flex flex-col items-center text-center",children:[s.jsxs("h1",{className:"text-4xl md:text-6xl font-extrabold tracking-tight text-white mb-6",children:[s.jsx("span",{className:"block",children:"Master Your Collection"}),s.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-500",children:"Build Powerful Decks"})]}),s.jsx("p",{className:"mt-4 max-w-2xl text-xl text-gray-300 mx-auto",children:"The ultimate tool for Magic: The Gathering players. Organize your cards, analyze your mana curves, and playtest your strategies in one modern interface."}),s.jsxs("div",{className:"mt-10 flex gap-4 justify-center",children:[s.jsx(yt,{to:"/dashboard",className:"px-8 py-3 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-lg transition-all shadow-lg shadow-indigo-500/30 transform hover:-translate-y-1",children:"Get Started"}),s.jsx("button",{className:"px-8 py-3 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-200 font-semibold text-lg border border-gray-700 transition-all",children:"Learn More"})]})]})]}),s.jsx(V_,{}),s.jsx("footer",{className:"bg-black py-12 border-t border-gray-900 mt-auto",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center",children:s.jsx("p",{className:"text-gray-500",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."})})})]}),F_=({isOpen:a,onClose:n})=>{const[i,o]=w.useState("Loading bugs...");return w.useEffect(()=>{a&&Ge.getBugs().then(d=>o(d)).catch(d=>o("Failed to load bug list: "+d.message))},[a]),a?s.jsx("div",{className:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-900/75 transition-opacity","aria-hidden":"true",onClick:n}),s.jsxs("div",{className:"inline-block align-bottom bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full border border-gray-700 relative z-10",children:[s.jsx("div",{className:"bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:s.jsx("div",{className:"sm:flex sm:items-start",children:s.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl leading-6 font-medium text-white",id:"modal-title",children:"Known Bugs & Tasks"}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"mt-2 bg-gray-900 rounded p-4 h-[60vh] overflow-y-auto font-mono text-sm text-gray-300 whitespace-pre-wrap",children:i})]})})}),s.jsxs("div",{className:"bg-gray-800 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-gray-700",children:[s.jsx("a",{href:"https://discord.gg/mtgforge",target:"_blank",rel:"noreferrer",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",children:"Report New Bug (Discord)"}),s.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-600 shadow-sm px-4 py-2 bg-gray-700 text-base font-medium text-gray-300 hover:bg-gray-600 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:n,children:"Close"})]})]})]})}):null};function Gf(){const[a,n]=w.useState([]),[i,o]=w.useState(!0),[d,h]=w.useState(null),{currentUser:g}=vt(),p=async()=>{if(g){o(!0);try{const x=await Ge.get("/decks");n(x),h(null)}catch(x){console.error("Error fetching decks:",x),h(x)}finally{o(!1)}}};return w.useEffect(()=>{if(!g){n([]),o(!1);return}p()},[g]),{decks:a,loading:i,error:d,refresh:p}}const Vh={W:{name:"White",flavor:"A single spark of light can banish a world of shadows.",theme:"Absolute Order",pips:["W"],bg:"bg-yellow-600"},U:{name:"Blue",flavor:"The mind is the only battlefield where victory is absolute.",theme:"Infinite Inquiry",pips:["U"],bg:"bg-blue-600"},B:{name:"Black",flavor:"Power at any cost, for greatness is written in blood.",theme:"Unrestricted Power",pips:["B"],bg:"bg-gray-800"},R:{name:"Red",flavor:"Do not fear the fire; fear the heart that commands it.",theme:"Chaotic Passion",pips:["R"],bg:"bg-red-600"},G:{name:"Green",flavor:"The forest does not ask for permission to grow.",theme:"Primal Growth",pips:["G"],bg:"bg-green-600"},C:{name:"Colorless",flavor:"Existence is a fleeting dream in the eyes of the silent.",theme:"The Great Void",pips:["C"],bg:"bg-gray-500"},WU:{name:"Azorius Senate",flavor:"Justice is blind, but she has a very long reach.",theme:"Bureaucratic Control",pips:["W","U"],bg:"bg-gradient-to-br from-yellow-300 to-blue-500"},UB:{name:"House Dimir",flavor:"The finest secrets are those that kill the ones who keep them.",theme:"Subterfuge & Infiltration",pips:["U","B"],bg:"bg-gradient-to-br from-blue-600 to-black"},BR:{name:"Cult of Rakdos",flavor:"Entertain us, or become the entertainment.",theme:"Carnival of Carnage",pips:["B","R"],bg:"bg-gradient-to-br from-black to-red-600"},RG:{name:"Gruul Clans",flavor:"Not for city-dwellers. Not for the weak. Only for the wild.",theme:"Primal Destruction",pips:["R","G"],bg:"bg-gradient-to-br from-red-500 to-green-600"},WG:{name:"Selesnya Conclave",flavor:"One voice is a whisper; the Conclave is a roar.",theme:"Collective Harmony",pips:["W","G"],bg:"bg-gradient-to-br from-green-500 to-yellow-200"},WB:{name:"Orzhov Syndicate",flavor:"Even death is no excuse for a breach of contract.",theme:"Indentured Eternity",pips:["W","B"],bg:"bg-gradient-to-br from-gray-200 to-gray-900"},BG:{name:"Golgari Swarm",flavor:"Every grave is a garden if you wait long enough.",theme:"Cycles of Rot",pips:["B","G"],bg:"bg-gradient-to-br from-gray-900 to-green-600"},UG:{name:"Simic Combine",flavor:"Nature is a rough draft; we are the final edit.",theme:"Biological Evolution",pips:["U","G"],bg:"bg-gradient-to-br from-green-400 to-blue-500"},UR:{name:"Izzet League",flavor:"If it doesn't explode, you aren't trying hard enough.",theme:"Volatile Genius",pips:["U","R"],bg:"bg-gradient-to-br from-blue-500 to-red-500"},WR:{name:"Boros Legion",flavor:"First to the fight, last to the fall.",theme:"Tactical Aggression",pips:["W","R"],bg:"bg-gradient-to-br from-red-600 to-yellow-200"},WUG:{name:"Bant",flavor:"The sigil of the sun protects those who stand together.",theme:"Knightly Order",pips:["W","U","G"],bg:"bg-gradient-to-r from-green-400 via-yellow-200 to-blue-400"},WUB:{name:"Esper",flavor:"Perfection is not a goal; it is a requirement.",theme:"Obsidian Logic",pips:["W","U","B"],bg:"bg-gradient-to-r from-yellow-200 via-blue-400 to-black"},UBR:{name:"Grixis",flavor:"A wasteland of power where only the cruelest thrive.",theme:"Ruthless Tyranny",pips:["U","B","R"],bg:"bg-gradient-to-r from-blue-600 via-black to-red-600"},BRG:{name:"Jund",flavor:"In this world, you are either the dragon or the meal.",theme:"Apex Predation",pips:["B","R","G"],bg:"bg-gradient-to-r from-black via-red-600 to-green-600"},WRG:{name:"Naya",flavor:"Where the mountains wake and the earth trembles.",theme:"Primal Majesty",pips:["W","R","G"],bg:"bg-gradient-to-r from-red-500 via-green-500 to-yellow-200"},WBG:{name:"Abzan",flavor:"We do not break; we simply outlast.",theme:"Eternal Endurance",pips:["W","B","G"],bg:"bg-gradient-to-r from-yellow-100 via-black to-green-600"},WUR:{name:"Jeskai",flavor:"The wind carries the strike; the mind guides the bolt.",theme:"Disciplined Spark",pips:["W","U","R"],bg:"bg-gradient-to-r from-blue-500 via-red-500 to-yellow-100"},UBG:{name:"Sultai",flavor:"Power is measured in gold and the bones of the fallen.",theme:"Opulent Decay",pips:["U","B","G"],bg:"bg-gradient-to-r from-black via-green-600 to-blue-600"},WBR:{name:"Mardu",flavor:"Victory is the only law worth following.",theme:"Relentless Conquest",pips:["W","B","R"],bg:"bg-gradient-to-r from-red-600 via-yellow-100 to-black"},URG:{name:"Temur",flavor:"The wild does not think; it reacts with ice and fire.",theme:"Elemental Instinct",pips:["U","R","G"],bg:"bg-gradient-to-r from-green-500 via-blue-500 to-red-500"},UBRG:{name:"Glint-Eye",flavor:"Order is a cage; we have chosen to break the locks.",theme:"Chaotic Adaptation",pips:["U","B","R","G"],bg:"bg-indigo-900"},WBRG:{name:"Dune-Brood",flavor:"When the logic of the mind fails, the instinct of the swarm prevails.",theme:"Sandless Conquest",pips:["W","B","R","G"],bg:"bg-orange-900"},WURG:{name:"Ink-Treader",flavor:"To touch one is to touch the whole of the world.",theme:"Radiant Reflection",pips:["W","U","R","G"],bg:"bg-sky-900"},WUBG:{name:"Witch-Maw",flavor:"There is a hunger beneath the earth that knows no fire.",theme:"Eldritch Growth",pips:["W","U","B","G"],bg:"bg-emerald-900"},WUBR:{name:"Yore-Tiller",flavor:"The past is a weapon we sharpen for the future.",theme:"Relentless History",pips:["W","U","B","R"],bg:"bg-slate-900"},WUBRG:{name:"WUBRG",flavor:"The full spectrum of power, bound in a single hand.",theme:"The Convergence",pips:["W","U","B","R","G"],bg:"bg-gradient-to-r from-yellow-500 via-blue-500 to-green-500"}},ro=a=>{if(!a)return Vh.C;const n={W:0,U:1,B:2,R:3,G:4,C:-1};let i=Array.isArray(a)?a:a.split("");const d=[...new Set(i)].filter(h=>n[h]!==void 0&&h!=="C").sort((h,g)=>n[h]-n[g]).join("");return Vh[d]||Vh.C},W_=()=>{const{currentUser:a,userProfile:n}=vt(),{cards:i,refresh:o}=Yn(),{decks:d,loading:h}=Gf(),[g,p]=w.useState(!1),[x,b]=w.useState(!1),N=us(),j=async()=>{b(!0);try{await Ge.post("/sync/prices"),await o()}catch(L){console.error("Sync failed",L)}finally{b(!1)}},_=w.useMemo(()=>{if(!i||!d)return{totalCards:0,uniqueDecks:0,value:0,topColor:"N/A"};const L=i.reduce((G,X)=>G+(X.count||1),0),T=i.reduce((G,X)=>{const se=parseFloat(X.prices?.usd||0);return G+se*(X.count||1)},0),U={};i.forEach(G=>{const X=G.color_identity||[],se={W:0,U:1,B:2,R:3,G:4},te=X.filter(k=>se[k]!==void 0).sort((k,E)=>se[k]-se[E]).join(""),R=te.length===0?"C":te;U[R]=(U[R]||0)+(G.count||1)});const P=Object.entries(U);let z=ro("C");if(P.length>0){const[G,X]=P.reduce((se,te)=>te[1]>se[1]?te:se);z=ro(G)}return{totalCards:L,uniqueDecks:d.length,value:T.toLocaleString("en-US",{style:"currency",currency:"USD"}),topColor:z}},[i,d]),I=w.useMemo(()=>d?[...d].reverse().slice(0,3):[],[d]);return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 space-y-12 animate-fade-in",children:[s.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"Dashboard"}),s.jsxs("p",{className:"text-gray-400",children:["Welcome back, ",s.jsx("span",{className:"text-indigo-400 font-bold",children:a?a.displayName||a.email:"Guest"}),"."]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx($h,{title:"Total Cards",value:_.totalCards,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"blue"}),s.jsx($h,{title:"Unique Decks",value:_.uniqueDecks,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"purple"}),s.jsx($h,{title:"Collection Value",value:_.value,icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"green",children:s.jsx("button",{onClick:j,disabled:x,className:`absolute top-4 right-4 p-1.5 rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-all ${x?"animate-spin":""}`,title:"Update Prices from Scryfall",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),s.jsxs("div",{className:"bg-gray-900/60 border border-gray-800 rounded-2xl p-5 backdrop-blur-sm hover:border-gray-700 transition-colors group relative overflow-hidden",children:[s.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 opacity-10 rounded-bl-full ${_.topColor.bg}`}),s.jsxs("div",{className:"flex flex-col h-full justify-between relative z-10",children:[s.jsx("div",{className:"flex gap-1 mb-2",children:_.topColor.pips?.map((L,T)=>s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center font-bold text-xs ring-1 ring-white/10 shadow-sm ${L==="W"?"bg-yellow-200 text-yellow-900":L==="U"?"bg-blue-300 text-blue-900":L==="B"?"bg-gray-800 text-gray-200":L==="R"?"bg-red-400 text-red-900":L==="G"?"bg-green-400 text-green-900":"bg-gray-400 text-gray-900"}`,children:L},T))}),s.jsxs("div",{children:[s.jsx("div",{className:`text-xl font-black tracking-tight ${_.topColor.color||"text-white"}`,children:_.topColor.name}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:"Top Color Identity"}),s.jsxs("div",{className:"text-[10px] text-gray-400 italic mt-2 line-clamp-2 opacity-70",children:['"',_.topColor.flavor,'"']})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(ed,{title:"New Deck",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),color:"from-indigo-600 to-purple-600",onClick:()=>N("/decks/new")}),s.jsx(ed,{title:"Add Cards",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-blue-600 to-cyan-600",onClick:()=>N("/collection")}),s.jsx(ed,{title:"Browse Sets",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-green-600 to-emerald-600",onClick:()=>N("/sets")}),s.jsx(ed,{title:"Wishlist",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),color:"from-pink-600 to-rose-600",onClick:()=>N("/collection?wishlist=true")})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-8 backdrop-blur-md shadow-xl",children:[s.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),"Recent Decks"]}),h?s.jsx("div",{className:"text-gray-400 text-center py-8",children:"Loading decks..."}):I.length>0?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map(L=>{const T=z=>z?z.image_uris?.art_crop?z.image_uris.art_crop:z.card_faces?.[0]?.image_uris?.art_crop?z.card_faces[0].image_uris.art_crop:null:null,U=T(L.commander),P=T(L.commander_partner);return s.jsxs("div",{onClick:()=>N(`/decks/${L.id}`),className:"group relative aspect-[63/88] rounded-2xl overflow-hidden cursor-pointer shadow-lg hover:shadow-indigo-500/30 transition-all hover:-translate-y-2 border border-white/5 bg-gray-900",children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950",children:L.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[s.jsx("img",{src:U||"https://placehold.co/400x600?text=?",alt:L.commander?.name,className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"})]}),s.jsxs("div",{className:"w-1/2 h-full relative",children:[s.jsx("img",{src:P||"https://placehold.co/400x600?text=?",alt:L.commander_partner?.name,className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"})]})]}):s.jsx("img",{src:U||"https://placehold.co/400x600?text=?",alt:L.name,className:"absolute inset-0 w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/40 to-transparent opacity-90"}),s.jsxs("div",{className:"absolute inset-0 p-5 flex flex-col justify-end",children:[s.jsxs("div",{className:"mb-1",children:[s.jsx("div",{className:"flex justify-between items-end mb-2",children:s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 rounded text-[10px] font-bold uppercase tracking-wider backdrop-blur-sm",children:L.format||"Commander"})}),s.jsx("h3",{className:"text-xl font-bold text-white leading-tight mb-1 group-hover:text-indigo-400 transition-colors line-clamp-2",children:L.name}),s.jsx("p",{className:"text-sm text-gray-400 line-clamp-1",children:L.commander_partner?`${L.commander.name} & ${L.commander_partner.name}`:L.commander?.name||"Unknown Commander"})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex justify-between items-center text-xs text-gray-500 font-mono",children:[s.jsxs("span",{children:[L.card_count||0," cards"]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-white transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]},L.id)})}):s.jsxs("div",{className:"text-center py-12 bg-gray-900/30 rounded-2xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500",children:"No decks forged yet."}),s.jsx(yt,{to:"/decks/new",className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 inline-block",children:"Create your first deck "})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-red-900/10 border border-red-500/20 rounded-3xl p-6 backdrop-blur-md",children:[s.jsxs("h2",{className:"font-bold text-white mb-2 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"System Status"]}),s.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Found a bug or have a feature request? Help us improve the Forge."}),s.jsxs("button",{onClick:()=>p(!0),className:"w-full py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl shadow-lg shadow-red-900/20 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Report Issue"]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-gray-700/50 rounded-3xl p-6 h-64",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"font-bold text-white",children:"Quick Notes"}),s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),s.jsx("textarea",{className:"w-full h-full bg-transparent resize-none text-gray-400 placeholder-gray-600 text-sm focus:outline-none",placeholder:"Jot down deck ideas or card combos here..."})]})]})]})]}),s.jsx(F_,{isOpen:g,onClose:()=>p(!1)})]})},$h=({title:a,value:n,icon:i,color:o,children:d})=>s.jsxs("div",{className:"bg-gray-900/60 border border-gray-800 rounded-2xl p-5 backdrop-blur-sm hover:border-gray-700 transition-colors group relative",children:[d,s.jsx("div",{className:"flex justify-between items-start mb-4",children:s.jsx("div",{className:`p-2.5 rounded-xl bg-gray-950 text-${o}-400 group-hover:scale-110 transition-transform shadow-inner`,children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:i})})})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-3xl font-black text-white tracking-tight",children:n}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:a})]})]}),ed=({title:a,icon:n,color:i,onClick:o})=>s.jsxs("button",{onClick:o,className:"group relative overflow-hidden rounded-2xl p-4 md:p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5",children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${i} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),s.jsx("div",{className:"absolute inset-0 bg-gray-800/50 group-hover:opacity-0 transition-opacity"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-3 text-gray-300 group-hover:text-white transition-colors",children:[s.jsx("div",{className:"p-3 bg-gray-900/50 rounded-full backdrop-blur-sm group-hover:scale-110 transition-transform group-hover:bg-white/20",children:n}),s.jsx("span",{className:"font-bold text-sm tracking-wide",children:a})]})]}),q_=()=>{const[a,n]=w.useState(!0),[i,o]=w.useState(""),[d,h]=w.useState(""),[g,p]=w.useState(""),[x,b]=w.useState(""),{login:N,signup:j,loginWithGoogle:_}=vt(),I=us(),L=async U=>{U.preventDefault();try{if(b(""),a)await N(i,d),I("/dashboard");else{if(d!==g)return b("Passwords do not match");if(d.length<6)return b("Password must be at least 6 characters");await j(i,d),I("/onboarding")}}catch(P){b("Failed to "+(a?"log in":"sign up")+": "+P.message)}},T=async()=>{try{b(""),await _(),I("/dashboard")}catch(U){b("Failed to log in with Google: "+U.message)}};return s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8 relative",children:[s.jsx("div",{className:"absolute inset-0 z-0",children:s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-50"})}),s.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10 bg-black/60 p-10 rounded-2xl backdrop-blur-md border border-white/10 shadow-2xl",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:a?"Sign in to MTG-Forge":"Create an Account"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-400",children:a?"Access your collection and decks anywhere":"Start your journey with MTG-Forge"})]}),x&&s.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 p-3 rounded text-sm text-center",children:x}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:L,children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:i,onChange:U=>o(U.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:a?"current-password":"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:d,onChange:U=>h(U.target.value)})]}),!a&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),s.jsx("input",{id:"confirm-password",name:"confirmConnectPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:g,onChange:U=>p(U.target.value)})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:a?"Sign in with Email":"Sign Up with Email"})})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"button",onClick:()=>{n(!a),b("")},className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",children:a?"Don't have an account? Sign Up":"Already have an account? Sign In"})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-600"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-transparent text-gray-400 uppercase font-bold bg-[#1a1c23]",children:"Or continue with"})})]}),s.jsxs("button",{onClick:T,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),s.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),s.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),s.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),a?"Sign in with Google":"Sign up with Google"]})]})]})},rf=({options:a=[],selected:n=[],onChange:i,placeholder:o="Select...",label:d})=>{const[h,g]=w.useState(!1),[p,x]=w.useState(""),b=w.useRef(null);w.useEffect(()=>{const _=I=>{b.current&&!b.current.contains(I.target)&&g(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const N=a.filter(_=>_.label.toLowerCase().includes(p.toLowerCase())),j=_=>{const I=n.includes(_)?n.filter(L=>L!==_):[...n,_];i(I)};return s.jsxs("div",{className:"relative",ref:b,children:[d&&s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:d}),s.jsxs("button",{type:"button",onClick:()=>g(!h),className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 px-3 text-left text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent flex justify-between items-center",children:[s.jsx("span",{className:"truncate",children:n.length===0?o:`${n.length} selected`}),s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&s.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-gray-800 border border-gray-700 rounded-lg shadow-xl max-h-60 flex flex-col",children:[s.jsx("div",{className:"p-2 border-b border-gray-700",children:s.jsx("input",{type:"text",placeholder:"Search...",className:"w-full bg-gray-900 border border-gray-600 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",value:p,onChange:_=>x(_.target.value),autoFocus:!0})}),s.jsx("div",{className:"overflow-y-auto flex-1 p-1",children:N.length===0?s.jsx("div",{className:"text-gray-500 text-xs p-2 text-center",children:"No results"}):N.map(_=>s.jsxs("div",{onClick:()=>j(_.value),className:`
                                        flex items-center gap-2 px-2 py-1.5 rounded cursor-pointer text-sm
                                        ${n.includes(_.value)?"bg-indigo-600 text-white":"text-gray-300 hover:bg-gray-700"}
                                    `,children:[s.jsx("div",{className:`w-3 h-3 rounded-sm border ${n.includes(_.value)?"bg-white border-white":"border-gray-500"}`,children:n.includes(_.value)&&s.jsx("svg",{className:"w-full h-full text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:"truncate",children:_.label})]},_.value))})]})]})},Vf=()=>s.jsx("div",{className:"relative aspect-[2.5/3.5] bg-gray-800 rounded-lg overflow-hidden border border-gray-700 animate-pulse",children:s.jsx("div",{className:"absolute inset-0 bg-gray-700/50"})}),vd=({card:a,availableFoils:n,onRemove:i,showQuantity:o=!0,onClick:d})=>{const[h,g]=w.useState(!1),{openCardModal:p}=Hf(),x=(L,T=0)=>{if(!L)return"https://placehold.co/250x350?text=No+Image";const U=L.data||L;return U.card_faces&&U.card_faces.length>1?U.card_faces[T]?.image_uris?.normal||"https://placehold.co/250x350?text=No+Image":U.image_uris?.normal||L.image_uri||"https://placehold.co/250x350?text=No+Image"},b=a.data?.card_faces?.length>1||a.card_faces?.length>1,N=x(a,0),j=b?x(a,1):null,_=a.countInDeck||a.quantity||a.count||1,I=L=>{L.stopPropagation(),d?d(a):p(a)};return s.jsx("div",{className:"relative group perspective-1000 h-full w-full aspect-[2.5/3.5] min-h-[200px] cursor-pointer",onClick:I,children:s.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${h?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx("img",{src:N,alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}),o&&_>1&&s.jsxs("div",{className:"absolute top-1.5 right-1.5 bg-black/80 text-white text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-sm z-20",children:["x",_]}),a.finish==="foil"?s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-yellow-500/80 text-yellow-100 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-300/50",children:""}):a.is_wishlist?s.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-orange-600/90 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-orange-400/50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"WISH"]}):n?.has(a.name)&&s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-gray-700/90 text-yellow-400 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-500/30 cursor-help",title:"Foil copy available in collection",children:""}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-200 flex flex-col justify-center items-center gap-2 p-2 backdrop-blur-sm z-30",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"font-bold text-xs text-white line-clamp-2",children:a.name}),s.jsxs("p",{className:"text-green-400 text-xs font-mono mt-1",children:["$",(parseFloat(a.prices?.usd)||0).toFixed(2)]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"text-indigo-300 text-xs font-bold uppercase tracking-wider bg-indigo-900/50 px-2 py-1 rounded border border-indigo-500/30",children:"View Details"}),b&&s.jsx("button",{onClick:L=>{L.stopPropagation(),g(!h)},className:"text-indigo-300 hover:text-white bg-indigo-900/50 hover:bg-indigo-700 p-1 rounded-full border border-indigo-500/30 transition-colors",title:"Quick Flip",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),i&&s.jsx("button",{onClick:L=>{L.stopPropagation(),i(a.firestoreId||a.id,a.name)},className:"text-red-400 hover:text-white hover:bg-red-600 p-2 rounded-full transition-colors",title:"Remove card",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]}),b&&s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx("img",{src:j,alt:`${a.name} (Back)`,className:"w-full h-full object-cover",loading:"lazy"}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-200 flex flex-col justify-center items-center gap-2 p-2 backdrop-blur-sm z-30",children:[s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"font-bold text-xs text-white line-clamp-2",children:a.name})}),s.jsx("div",{className:"text-indigo-300 text-xs font-bold uppercase tracking-wider bg-indigo-900/50 px-2 py-1 rounded border border-indigo-500/30",children:"Click to Flip"})]})]})]})})},lr={async addCardToDeck(a,n,i){return Ge.post("/collection",{scryfall_id:i.id,name:i.name,set_code:i.set||i.set_code,collector_number:i.collector_number,finish:i.finish||"nonfoil",data:i,deck_id:n,count:1})},async removeCardFromDeck(a,n,i){return Ge.put(`/collection/${i}`,{deck_id:null})},async updateCardQuantity(a,n,i,o){return o<=0?this.removeCardFromDeck(a,n,i):Ge.put(`/collection/${i}`,{count:o})},async setCommander(a,n,i){return Ge.put(`/decks/${n}`,{commander:i})},async importDeck(a,n,i,o){return Ge.post("/decks/import",{deck:n,cards:i,options:o})},async updateDeck(a,n,i){return Ge.put(`/decks/${n}`,i)},async deleteDeck(a,n){return Ge.delete(`/decks/${n}`)}},Y_=(a,n)=>{if(!a||a.length===0)return!0;const i=new Set(n||[]);return a.every(o=>i.has(o))},yb=({isOpen:a,onClose:n,deck:i,deckCards:o=[]})=>{const{cards:d,loading:h}=Yn(),{currentUser:g}=vt(),{addToast:p}=Rn(),[x,b]=w.useState(""),[N,j]=w.useState("All"),_=w.useMemo(()=>{if(!d||!i)return[];const T=i.commander?.color_identity||[];new Set(o.map(P=>P.name));const U=x.toLowerCase();return d.filter(P=>{if(P.deckId)return!1;const z=i.format?.toLowerCase()==="standard",G=P.type_line?.toLowerCase().includes("basic land");if(!z&&!Y_(P.color_identity,T))return!1;const X=o.filter(te=>te.name===P.name).reduce((te,R)=>te+(R.countInDeck||1),0);return!(!G&&X>=(z?4:1)||U&&!P.name.toLowerCase().includes(U)&&!P.type_line?.toLowerCase().includes(U)||N!=="All"&&!P.type_line?.toLowerCase().includes(N.toLowerCase()))})},[d,i,o,x,N]),I=async T=>{try{await lr.addCardToDeck(g.uid,i.id,T),p(`Added ${T.name} to deck`,"success")}catch(U){console.error(U),p("Failed to add card","error")}};if(!a)return null;const L=["All","Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"];return aa.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl h-[90vh] flex flex-col border border-gray-700",children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50 rounded-t-xl",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"Add from Collection"}),s.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["(",_.length," available)"]})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Showing unassigned cards compatible with this deck."})]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 hover:bg-gray-700 p-2 rounded-lg",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700 space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name, type, or text...",className:"w-full bg-gray-900 text-white border border-gray-700 rounded-lg py-3 px-4 pl-12 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-inner",value:x,onChange:T=>b(T.target.value),autoFocus:!0}),s.jsx("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(T=>s.jsx("button",{onClick:()=>j(T),className:`px-3 py-1 text-xs font-bold rounded-full transition-colors border ${N===T?"bg-indigo-600 text-white border-indigo-500 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-gray-200"}`,children:T},T))})]}),s.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-900/30 p-2 custom-scrollbar",children:h?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):_.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 space-y-2",children:[s.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),s.jsx("p",{children:"No cards found matching your criteria."})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:_.map(T=>{const U=T.image_uris?.art_crop||T.image_uris?.normal||"https://placehold.co/100x100?text=No+Img";return s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-800/80 rounded-lg border border-gray-700/50 hover:bg-gray-700 hover:border-indigo-500/50 transition-all group",children:[s.jsxs("div",{className:"relative w-16 h-12 rounded overflow-hidden shrink-0 shadow-sm",children:[s.jsx("img",{src:U,className:"w-full h-full object-cover",alt:T.name,loading:"lazy"}),T.finish==="foil"&&s.jsx("div",{className:"absolute top-0 right-0 w-3 h-3 bg-yellow-400 rounded-bl-md shadow-sm",title:"Foil"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-bold text-gray-200 text-sm truncate",children:T.name}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[s.jsx("span",{className:"truncate max-w-[120px]",children:T.type_line}),s.jsx("span",{className:"bg-gray-700 px-1 rounded text-[10px]",children:T.set?.toUpperCase()})]})]}),s.jsx("button",{onClick:()=>I(T),className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg shadow-md transition-transform active:scale-95 shrink-0 flex items-center gap-1 text-xs font-bold",children:"Add"})]},T.firestoreId||T.id)})})})]})}),document.body)},K_=({cards:a})=>{const[n,i]=w.useState({key:"name",direction:"asc"}),o=w.useMemo(()=>{let p=[...a];return n.key&&p.sort((x,b)=>{let N=x[n.key],j=b[n.key];return n.key==="price"?(N=parseFloat(x.prices?.usd||0),j=parseFloat(b.prices?.usd||0)):n.key==="type"?(N=x.type_line||"",j=b.type_line||""):n.key==="set"&&(N=x.set_name||"",j=b.set_name||""),N<j?n.direction==="asc"?-1:1:N>j?n.direction==="asc"?1:-1:0}),p},[a,n]),d=p=>{let x="asc";n.key===p&&n.direction==="asc"&&(x="desc"),i({key:p,direction:x})},h=p=>n.key!==p?s.jsx("svg",{className:"w-3 h-3 text-gray-700 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):n.direction==="asc"?s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),g=({label:p,sortKey:x,className:b=""})=>s.jsx("th",{className:`px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group hover:text-white transition-colors select-none ${b}`,onClick:()=>d(x),children:s.jsxs("div",{className:"flex items-center gap-2",children:[p,h(x)]})});return s.jsx("div",{className:"w-full overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[1000px] border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-800",children:[s.jsx(g,{label:"Card Name",sortKey:"name"}),s.jsx(g,{label:"Set",sortKey:"set"}),s.jsx(g,{label:"Type",sortKey:"type"}),s.jsx(g,{label:"Rarity",sortKey:"rarity"}),s.jsx(g,{label:"Market Price",sortKey:"price"}),s.jsx(g,{label:"Paid",sortKey:"price_bought"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800/50",children:o.map(p=>s.jsxs("tr",{className:"group hover:bg-gray-800/30 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-10 w-10 flex-shrink-0 relative rounded overflow-hidden mr-4 border border-gray-700 bg-gray-900 group-hover:scale-150 group-hover:z-10 transition-all origin-left",children:s.jsx("img",{className:"h-full w-full object-cover",src:p.image_uri||p.image_uris?.small,alt:""})}),s.jsxs("div",{className:"ml-0",children:[s.jsx("div",{className:"text-sm font-bold text-white group-hover:text-indigo-300 transition-colors",children:p.name}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:["x",p.count]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300 border border-gray-700",children:[s.jsx("svg",{className:"mr-1.5 h-3 w-3 text-indigo-400",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),p.set_name]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 truncate max-w-[200px]",title:p.type_line,children:p.type_line}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`
                                    inline-flex items-center px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide
                                    ${p.rarity==="mythic"?"text-orange-400 bg-orange-900/10 border border-orange-500/20":p.rarity==="rare"?"text-yellow-400 bg-yellow-900/10 border border-yellow-500/20":p.rarity==="uncommon"?"text-blue-400 bg-blue-900/10 border border-blue-500/20":"text-gray-400 bg-gray-800 border border-gray-700"}
                                `,children:p.rarity})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-mono",children:["$",parseFloat(p.prices?.usd||0).toFixed(2)]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 font-mono",children:p.price_bought?`$${parseFloat(p.price_bought).toFixed(2)}`:"-"}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-wrap gap-1",children:[(p.tags&&typeof p.tags=="string"?JSON.parse(p.tags):p.tags||[]).map((x,b)=>s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:x},b)),(!p.tags||Array.isArray(p.tags)&&p.tags.length===0)&&s.jsx("span",{className:"text-gray-600 text-xs italic",children:"No tags"})]})})]},p.id||p.firestoreId))})]})})},X_=({mode:a,onChange:n})=>s.jsxs("div",{className:"bg-gray-900 p-1 rounded-xl flex border border-gray-800",children:[s.jsx("button",{onClick:()=>n("folder"),className:`p-2 rounded-lg transition-all ${a==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Folder Group View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),s.jsx("button",{onClick:()=>n("grid"),className:`p-2 rounded-lg transition-all ${a==="grid"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>n("table"),className:`p-2 rounded-lg transition-all ${a==="table"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Table List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]}),kx=({isOpen:a,onClose:n})=>{const{currentUser:i}=vt(),{addToast:o}=Rn(),{refreshCollection:d}=Yn(),[h,g]=w.useState(""),[p,x]=w.useState([]),[b,N]=w.useState(!1),[j,_]=w.useState("input"),[I,L]=w.useState([]),[T,U]=w.useState(""),[P,z]=w.useState(!1),[G,X]=w.useState([]),se=w.useRef(null),te=A=>{const B=A.trim();if(!B)return null;const O=B.split(/[,\t]/).map(K=>K.trim());if(O.length<1)return null;const ye=O[0],ue=O[1]||null,V=O[2]||null,ie=O[3]||null;return{count:1,name:ye,set:ue,collector_number:V,tag:ie,mode:"unified"}},R=async()=>{if(h.trim()){N(!0);try{const B=h.split(`
`).map(te).filter(Boolean),O=await Promise.all(B.map(async ye=>{try{let ue="";if(ye.set&&ye.collector_number)ue=`https://api.scryfall.com/cards/${ye.set.toLowerCase()}/${ye.collector_number}`;else{let ie=ye.name;ye.set&&(ie+=` set:${ye.set}`),ue=`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(ie)}`}const V=await fetch(ue);if(V.ok){const ie=await V.json();return{...ye,valid:!0,scryfallId:ie.id,data:ie,image:ie.image_uris?.small||ie.card_faces?.[0]?.image_uris?.small}}else{if(ye.set&&ye.collector_number){const ie=await fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(ye.name)}`);if(ie.ok){const K=await ie.json();return{...ye,valid:!0,scryfallId:K.id,data:K,image:K.image_uris?.small||K.card_faces?.[0]?.image_uris?.small,warning:"Exact match failed, found by name."}}}return{...ye,valid:!1}}}catch{return{...ye,valid:!1}}}));x(O),_("preview")}catch{o("Failed to parse cards","error")}finally{N(!1)}}},k=A=>{const B=A.target.files[0];if(!B)return;const O=new FileReader;O.onload=ye=>{g(ye.target.result)},O.readAsText(B)},E=async()=>{z(!0);const A=p.filter(B=>B.valid);try{const B=A.map(ue=>{const V=[...I];return ue.tag&&!V.includes(ue.tag)&&V.push(ue.tag),{name:ue.data.name,scryfall_id:ue.scryfallId,set_code:ue.data.set,collector_number:ue.data.collector_number,image_uri:ue.data.image_uris?.normal||ue.data.card_faces?.[0]?.image_uris?.normal,count:ue.count,data:ue.data,tags:JSON.stringify(V)}}),O=await i.getIdToken();if(!(await fetch("http://localhost:3000/api/collection/batch",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`},body:JSON.stringify({cards:B,mode:"merge"})})).ok)throw new Error("Import failed");X(B),_("success"),d(),o(`Successfully imported ${A.length} cards!`,"success")}catch(B){console.error(B),o("Import failed. Check console.","error")}finally{z(!1)}},S=A=>{A.key==="Enter"&&T.trim()&&(I.includes(T.trim())||L([...I,T.trim()]),U(""))};return a?aa.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:j==="success"?"Import Complete":"Bulk Import"}),s.jsx("p",{className:"text-gray-400",children:j==="success"?`Successfully added ${G.length} cards to your collection.`:"Import cards from CSV or text list."})]}),s.jsx("button",{onClick:n,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[j==="input"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl text-blue-200 text-sm",children:[s.jsx("p",{className:"font-bold mb-2",children:"Supported Formats:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"CSV (Recommended)"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Black Lotus, LEA, 1, Power 9"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"Text List"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Command Tower, CMD, , Base"]})]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>se.current.click(),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-lg text-sm font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Upload CSV / Text File"]}),s.jsx("input",{type:"file",ref:se,onChange:k,accept:".csv,.txt",className:"hidden"})]}),s.jsx("textarea",{value:h,onChange:A=>g(A.target.value),placeholder:"Paste your list here...",className:"w-full h-80 bg-gray-800/50 border border-gray-700 text-gray-200 p-4 rounded-xl font-mono focus:ring-2 focus:ring-indigo-500 outline-none resize-none text-sm"})]}),j==="preview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Apply Tags to Batch"}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[I.map(A=>s.jsxs("span",{className:"bg-indigo-600 text-white px-2 py-1 rounded text-sm flex items-center gap-1",children:[A,s.jsx("button",{onClick:()=>L(I.filter(B=>B!==A)),className:"hover:text-red-300",children:""})]},A)),s.jsx("input",{type:"text",placeholder:"Type tag & Enter...",value:T,onChange:A=>U(A.target.value),onKeyDown:S,className:"bg-transparent border-none focus:ring-0 text-white placeholder-gray-600 text-sm min-w-[120px]"})]})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Matched Tag"}),s.jsx("th",{className:"p-3 text-right",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:p.map((A,B)=>s.jsxs("tr",{className:A.valid?"":"bg-red-900/10",children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[A.image?s.jsx("img",{src:A.image,className:"w-8 h-8 rounded object-cover",alt:""}):s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded flex items-center justify-center text-xs",children:"?"}),s.jsxs("div",{children:[s.jsx("div",{className:A.valid?"text-white font-bold":"text-red-400 line-through",children:A.name}),A.warning&&s.jsx("div",{className:"text-[10px] text-yellow-500",children:A.warning})]})]}),s.jsx("td",{className:"p-3",children:A.data?.set_name||A.set||"-"}),s.jsx("td",{className:"p-3 text-center font-mono",children:A.count}),s.jsx("td",{className:"p-3",children:A.tag&&s.jsx("span",{className:"text-xs bg-gray-700 px-1 rounded text-gray-300",children:A.tag})}),s.jsx("td",{className:"p-3 text-right",children:A.valid?s.jsx("span",{className:"text-green-400",children:"Ready"}):s.jsx("span",{className:"text-red-500",children:"Not Found"})})]},B))})]})})]}),j==="success"&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 p-4 rounded-xl text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-2",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Import Successful!"}),s.jsx("p",{className:"text-green-200 text-sm",children:"Your new cards have been added to the collection."})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800 max-h-[50vh] overflow-y-auto",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold sticky top-0 bg-gray-900 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Applied Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:G.map((A,B)=>s.jsxs("tr",{children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[s.jsx("img",{src:A.image_uri,className:"w-8 h-8 rounded object-cover",alt:""}),s.jsx("span",{className:"text-white font-bold",children:A.name})]}),s.jsx("td",{className:"p-3",children:A.set_code?.toUpperCase()}),s.jsx("td",{className:"p-3 text-center font-mono",children:A.count}),s.jsx("td",{className:"p-3",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:JSON.parse(A.tags).map(O=>s.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:O},O))})})]},B))})]})})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-800 flex justify-between bg-gray-900/50 rounded-b-2xl",children:j==="input"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:n,className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Cancel"}),s.jsx("button",{onClick:R,disabled:b||!h.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:b?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Review Cards"]}):"Review Cards"})]}):j==="preview"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>_("input"),className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Back to Edit"}),s.jsx("button",{onClick:E,disabled:P||p.filter(A=>A.valid).length===0,className:"bg-green-600 hover:bg-green-500 disabled:opacity-50 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:P?"Importing...":`Import ${p.filter(A=>A.valid).length} Cards`})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{}),s.jsx("button",{onClick:n,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg",children:"Done"})]})})]})}),document.body):null},Gt={METHOD:1,CONFIG:2,CARDS:3,REVIEW:4},J_=({isOpen:a,onClose:n,selectedCards:i=[]})=>{const{addToast:o}=Rn(),{cards:d}=Yn(),[h,g]=w.useState(Gt.METHOD),[p,x]=w.useState(!1),[b,N]=w.useState(""),[j,_]=w.useState("collection"),[I,L]=w.useState("emoji"),[T,U]=w.useState(""),[P,z]=w.useState("blue"),[G,X]=w.useState([]),[se,te]=w.useState([]),[R,k]=w.useState(!1);w.useEffect(()=>{a&&(g(Gt.METHOD),N(""),_("collection"),L("emoji"),U(""),z("blue"),X(i||[]),te([]))},[a]);const E=()=>{k(!0),setTimeout(()=>{const ue=[],V=d.filter(me=>parseFloat(me.prices?.usd||0)>5);V.length>0&&ue.push({id:"high-value",name:"High Value Vault",description:`${V.length} cards worth > $5`,icon:"",color:"purple",cards:V});const ie=d.filter(me=>me.rarity==="rare"||me.rarity==="mythic");ie.length>10&&ue.push({id:"rares",name:"Trade Binder",description:`Collection of ${ie.length} Rares & Mythics`,icon:"",color:"green",cards:ie});const K={};d.forEach(me=>{me.set_name&&(K[me.set_name]||(K[me.set_name]=[]),K[me.set_name].push(me))}),Object.entries(K).forEach(([me,D])=>{D.length>15&&ue.push({id:`set-${me}`,name:`${me} Set`,description:`Complete set progress (${D.length} cards)`,icon:"",color:"blue",cards:D})});const oe=d.filter(me=>me.type_line&&me.type_line.includes("Legendary Creature"));oe.length>5&&ue.push({id:"commanders",name:"Potential Commanders",description:`${oe.length} Legendary Creatures`,icon:"",color:"red",cards:oe}),te(ue),k(!1)},800)},S=ue=>{N(ue.name),U(ue.icon),z(ue.color),X(ue.cards),g(Gt.CONFIG)},A=async()=>{x(!0);try{const ue={name:b,type:j,icon_type:I,icon_value:T,color_preference:P},ie=(await Ge.post("/api/binders",ue)).id;if(G.length>0){const K=G.map(oe=>oe.firestoreId||oe.id);await Ge.put("/api/collection/batch-update",{cardIds:K,binderId:ie})}o("Binder created successfully!","success"),n(),window.location.reload()}catch(ue){console.error(ue),o("Failed to create binder","error")}finally{x(!1)}},B=()=>s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>g(Gt.CONFIG),className:"p-6 bg-gray-800 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl text-left transition-all group",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition-transform",children:""}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Start Fresh"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Create an empty binder and customize it exactly how you want."})]}),s.jsxs("button",{onClick:()=>{g(Gt.METHOD),E()},className:"p-6 bg-gray-800 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl text-left transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-600/20 text-indigo-400 rounded-full flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition-transform",children:""}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Smart Organize"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Let AI scan your collection and suggest logical binders."})]}),(R||se.length>0)&&s.jsxs("div",{className:"col-span-1 md:col-span-2 mt-4 space-y-4 animate-fade-in-down",children:[s.jsx("div",{className:"h-px bg-gray-800 w-full"}),R?s.jsxs("div",{className:"flex flex-col items-center py-8",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full mb-4"}),s.jsxs("p",{className:"text-indigo-400 font-mono text-sm",children:["Analyzing ",d.length," cards..."]})]}):s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[se.map(ue=>s.jsxs("button",{onClick:()=>S(ue),className:"p-4 bg-gray-800/50 hover:bg-gray-700 border border-gray-700 hover:border-white/20 rounded-xl flex items-center gap-4 transition-all text-left",children:[s.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center text-2xl bg-${ue.color}-900/20`,children:ue.icon}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:ue.name}),s.jsx("div",{className:"text-xs text-gray-400",children:ue.description})]})]},ue.id)),se.length===0&&s.jsx("div",{className:"col-span-full text-center text-gray-500 italic py-4",children:"No obvious groups found. Try creating a custom binder!"})]})]})]}),O=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Binder Name"}),s.jsx("input",{type:"text",value:b,onChange:ue=>N(ue.target.value),placeholder:"e.g., Rare Trade Binder",autoFocus:!0,className:"w-full bg-gray-800 border-2 border-gray-700 focus:border-indigo-500 text-white px-4 py-3 rounded-xl focus:outline-none font-bold text-lg transition-all"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Icon"}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:[s.jsxs("div",{className:"flex gap-2 mb-4 border-b border-gray-700 pb-2",children:[s.jsx("button",{onClick:()=>L("emoji"),className:`px-3 py-1 text-xs font-bold rounded-lg transition-colors ${I==="emoji"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Emojis"}),s.jsx("button",{onClick:()=>L("mtg"),className:`px-3 py-1 text-xs font-bold rounded-lg transition-colors ${I==="mtg"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"MTG Symbols"})]}),s.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 gap-2 h-32 overflow-y-auto custom-scrollbar p-1",children:I==="emoji"?["","","","","","","","","","","","","","","","","","","",""].map(ue=>s.jsx("button",{onClick:()=>U(ue),className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition-all ${T===ue?"bg-indigo-600 text-white scale-110 shadow-lg":"hover:bg-gray-700 text-gray-300"}`,children:ue},ue)):["ms-w","ms-u","ms-b","ms-r","ms-g","ms-c","ms-planeswalker","ms-land","ms-artifact","ms-enchantment"].map(ue=>s.jsx("button",{onClick:()=>U(ue),className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition-all ${T===ue?"bg-indigo-600 text-white scale-110 shadow-lg":"hover:bg-gray-700 text-gray-300"}`,children:s.jsx("i",{className:`ms ${ue} ms-cost`})},ue))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Color Theme"}),s.jsx("div",{className:"flex gap-4",children:["blue","red","green","purple","orange","gray"].map(ue=>s.jsx("button",{onClick:()=>z(ue),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all ${P===ue?"ring-2 ring-offset-2 ring-offset-gray-900 ring-white scale-110":"opacity-50 hover:opacity-100"}`,style:{backgroundColor:ue==="blue"?"#3B82F6":ue==="red"?"#EF4444":ue==="green"?"#10B981":ue==="purple"?"#8B5CF6":ue==="orange"?"#F59E0B":"#6B7280"},children:P===ue&&s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})},ue))})]})]}),ye=()=>s.jsxs("div",{className:"text-center py-6",children:[s.jsx("div",{className:`w-24 h-24 mx-auto bg-${P}-500/20 rounded-3xl flex items-center justify-center text-5xl mb-6 border-2 border-${P}-500 shadow-[0_0_30px_rgba(0,0,0,0.3)]`,children:T.startsWith("ms")?s.jsx("i",{className:`ms ${T} ms-2x`}):T}),s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:b}),s.jsx("p",{className:"text-gray-400 mb-8",children:"Ready to create your new binder!"}),G.length>0&&s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 max-w-sm mx-auto border border-gray-700",children:[s.jsxs("div",{className:"font-bold text-white mb-1",children:[G.length," Cards Selected"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"These cards will be automatically moved to this binder."}),s.jsxs("div",{className:"flex justify-center -space-x-2 mt-4",children:[G.slice(0,5).map((ue,V)=>s.jsx("div",{className:"w-8 h-10 bg-gray-700 rounded border border-gray-600 relative",style:{transform:`rotate(${(V-2)*5}deg)`},children:ue.image_uris?.small?s.jsx("img",{src:ue.image_uris.small,className:"w-full h-full object-cover rounded",alt:""}):null},V)),G.length>5&&s.jsxs("div",{className:"w-8 h-10 bg-gray-800 rounded border border-gray-600 flex items-center justify-center text-[8px] text-gray-400 z-10",children:["+",G.length-5]})]})]})]});return a?aa.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-md p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl w-full max-w-2xl flex flex-col border border-gray-700/50 max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h2",{className:"text-2xl font-black text-white",children:[h===Gt.METHOD&&"Create New Binder",h===Gt.CONFIG&&"Customize Binder",h===Gt.CARDS&&"Select Cards",h===Gt.REVIEW&&"Confirm Creation"]}),s.jsx("button",{onClick:n,className:"w-8 h-8 rounded-full bg-gray-800 hover:bg-gray-700 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"flex gap-2",children:[1,2,3,4].map(ue=>s.jsx("div",{className:`h-1.5 rounded-full flex-1 transition-all duration-500 ${ue<=h?"bg-indigo-500":"bg-gray-800"}`},ue))})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[h===Gt.METHOD&&B(),h===Gt.CONFIG&&O(),h===Gt.CARDS&&s.jsxs("div",{className:"text-center py-10 text-gray-500",children:["Currently, card selection is handled via Smart Organize or Bulk Select on the table.",s.jsx("br",{}),s.jsx("button",{onClick:()=>g(Gt.REVIEW),className:"text-indigo-400 underline mt-2",children:"Skip to Confirmation"})]}),h===Gt.REVIEW&&ye()]}),s.jsxs("div",{className:"p-6 border-t border-gray-800 flex justify-between bg-gray-950/30 rounded-b-3xl",children:[s.jsx("button",{onClick:()=>h>1?g(h-1):n(),className:"px-6 py-2.5 font-bold text-gray-400 hover:text-white transition-colors",children:h===1?"Cancel":"Back"}),s.jsx("button",{onClick:()=>{h===Gt.REVIEW?A():h===Gt.CONFIG?g(Gt.REVIEW):g(h+1)},disabled:p||h===Gt.CONFIG&&!b,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-2.5 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:p?s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):h===Gt.REVIEW?"Create Binder":"Continue"})]})]})}),document.body):null},Q_=()=>{const a=zs(),n=new URLSearchParams(a.search).get("wishlist")==="true",{cards:i,loading:o,error:d,refresh:h}=Yn({wishlist:n}),{decks:g}=Gf(),[p,x]=w.useState(""),[b,N]=w.useState(!1),[j,_]=w.useState(!1),I=async()=>{_(!0);try{await Ge.post("/sync/prices"),await h()}catch(K){console.error("Sync failed",K)}finally{_(!1)}},[L,T]=w.useState(()=>localStorage.getItem("collection_viewMode")||"folder"),[U,P]=w.useState("smart"),[z,G]=w.useState(null),[X,se]=w.useState(!1),[te,R]=w.useState(!1),[k,E]=w.useState(!1),[S,A]=w.useState(()=>{const K=localStorage.getItem("collection_filters");return K?JSON.parse(K):{colors:[],rarity:[],types:[],sets:[],decks:[]}});Tn.useEffect(()=>{localStorage.setItem("collection_viewMode",L)},[L]),Tn.useEffect(()=>{localStorage.setItem("collection_filters",JSON.stringify(S))},[S]);const B=w.useMemo(()=>{const K=new Set;return i.forEach(oe=>{oe.set&&oe.set_name&&K.add(JSON.stringify({value:oe.set,label:oe.set_name}))}),Array.from(K).map(oe=>JSON.parse(oe)).sort((oe,me)=>oe.label.localeCompare(me.label))},[i]),O=w.useMemo(()=>g.map(K=>({value:K.id,label:K.name})),[g]),ye=w.useMemo(()=>i.filter(K=>{const oe=K.name||"";if(p&&!oe.toLowerCase().includes(p.toLowerCase()))return!1;if(S.colors.length>0){const me=K.color_identity||[],D=me.length>1,F=me.length===0;if(!S.colors.some(q=>q==="C"?F:q==="M"?D:me.includes(q)))return!1}if(S.rarity.length>0&&!S.rarity.includes(K.rarity))return!1;if(S.types.length>0){const me=(K.type_line||"").toLowerCase();if(!S.types.some(F=>me.includes(F.toLowerCase())))return!1}return!(S.sets.length>0&&!S.sets.includes(K.set)||S.decks.length>0&&!S.decks.includes(K.deckId))}),[i,p,S]),ue=w.useMemo(()=>{if(L!=="folder")return[];if(U==="custom"){const F={},W=[];ye.forEach(Q=>{const xe=typeof Q.tags=="string"?JSON.parse(Q.tags):Q.tags||[];xe.length===0?W.push(Q):xe.forEach(pe=>{F[pe]||(F[pe]=[]),F[pe].push(Q)})});const q=Object.entries(F).map(([Q,xe])=>({id:`tag-${Q}`,label:Q,type:"tag",cards:xe,icon:"",color:"indigo"}));return W.length>0&&q.push({id:"unsorted",label:"Unsorted",type:"tag",cards:W,icon:"",color:"gray"}),q.sort((Q,xe)=>Q.label.localeCompare(xe.label))}const K={},oe={},me={};ye.forEach(F=>{if(F.set_name&&(K[F.set_name]||(K[F.set_name]=[]),K[F.set_name].push(F)),F.deck_id){const _e=g.find(Te=>Te.id===F.deck_id)?.name||"Unknown Deck";oe[_e]||(oe[_e]=[]),oe[_e].push(F)}let W=F.color_identity;if(typeof W=="string")try{W=JSON.parse(W)}catch{W=[]}Array.isArray(W)||(W=[]);const q={W:0,U:1,B:2,R:3,G:4},xe=W.filter(_e=>q[_e]!==void 0).sort((_e,Te)=>q[_e]-q[Te]).join(""),pe=xe.length===0?"C":xe;me[pe]||(me[pe]=[]),me[pe].push(F)});const D=[];return Object.entries(oe).forEach(([F,W])=>{D.push({id:`deck-${F}`,label:F,type:"deck",cards:W,icon:"",color:"purple",sub:"Deck"})}),Object.entries(me).sort(([F],[W])=>{const q=F==="C"?0:F.length,Q=W==="C"?0:W.length;if(q!==Q)return q-Q;const xe=ro(F),pe=ro(W);return(xe.name||"").localeCompare(pe.name||"")}).forEach(([F,W])=>{if(W.length>0){const q=ro(F);D.push({id:`color-${F}`,label:q.name,type:"color",cards:W,icon:"",pips:q.pips,flavor:q.flavor,theme:q.theme,color:q.bg?.replace("bg-","")?.split(" ")[0]||"blue",sub:"Color Identity"})}}),Object.entries(K).sort(([F],[W])=>F.localeCompare(W)).forEach(([F,W])=>{D.push({id:`set-${F}`,label:F,type:"set",cards:W,icon:"",color:"emerald",sub:"Set"})}),D},[ye,U,L,g]),V=(K,oe)=>{A(me=>{const D=me[K],F=D.includes(oe)?D.filter(W=>W!==oe):[...D,oe];return{...me,[K]:F}})},ie=w.useMemo(()=>ue.find(K=>K.id===z),[ue,z]);return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto px-6 py-8 space-y-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 bg-gray-950/40 p-6 rounded-3xl backdrop-blur-md border border-white/5 shadow-xl",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:n?"My Wishlist":"My Collection"}),s.jsxs("p",{className:"text-gray-400 font-medium",children:[ye.length," ",ye.length===1?"card":"cards"," found  ",s.jsxs("span",{className:"text-indigo-400",children:["$",ye.reduce((K,oe)=>K+parseFloat(oe.prices?.usd||0)*(oe.count||1),0).toFixed(2)]})," total value",s.jsxs("button",{onClick:I,disabled:j,className:`ml-3 inline-flex items-center gap-1 px-2 py-1 rounded-lg bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 text-xs font-bold transition-all ${j?"opacity-70 cursor-wait":""}`,title:"Update prices from Scryfall",children:[s.jsx("svg",{className:`w-3 h-3 ${j?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),j?"Updating...":"Update Prices"]})]})]}),s.jsxs("div",{className:"flex gap-3 w-full md:w-auto items-center",children:[s.jsx(X_,{mode:L,onChange:K=>{T(K),G(null)}}),s.jsx("div",{className:"h-8 w-px bg-gray-700 mx-2"}),s.jsxs("button",{onClick:()=>E(!0),className:"bg-gray-800 hover:bg-gray-700 text-indigo-400 hover:text-white px-4 py-3 rounded-xl transition-all border border-gray-700 hover:border-indigo-500/50 flex items-center justify-center gap-2 group mr-2",title:"Create New Binder",children:[s.jsx("svg",{className:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest hidden xl:inline-block",children:"New Binder"})]}),s.jsx("button",{onClick:()=>R(!0),className:"text-gray-400 hover:text-white font-bold py-3 px-4 rounded-xl hover:bg-gray-800 transition-all flex items-center gap-2 text-xs uppercase tracking-widest",title:"Bulk Paste",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),s.jsxs("button",{onClick:()=>se(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-indigo-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-xs",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Cards"]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-6 backdrop-blur-md shadow-2xl",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6 justify-between",children:[s.jsxs("div",{className:"flex gap-4 flex-1",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",placeholder:"Search cards...",value:p,onChange:K=>x(K.target.value),className:"w-full bg-gray-900/50 border border-gray-700 text-white px-5 py-3 pl-12 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all placeholder-gray-500 font-medium"}),s.jsx("svg",{className:"w-5 h-5 text-gray-500 absolute left-4 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("button",{onClick:()=>N(!b),className:`px-5 py-3 rounded-xl border font-bold text-sm flex items-center gap-2 transition-all ${b?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]}),L==="folder"&&!z&&s.jsxs("div",{className:"bg-gray-900/50 p-1 rounded-xl flex border border-gray-700 self-start",children:[s.jsx("button",{onClick:()=>P("smart"),className:`px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${U==="smart"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Smart Groups"}),s.jsx("button",{onClick:()=>P("custom"),className:`px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${U==="custom"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"My Tags"})]})]}),b&&s.jsx("div",{className:"mb-8 p-6 bg-gray-900/50 rounded-2xl border border-gray-800 space-y-6 animate-fade-in-down",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(K=>s.jsxs("button",{onClick:()=>V("colors",K),className:`
                                                    w-8 h-8 rounded-full border flex items-center justify-center transition-all transform hover:scale-110
                                                    ${S.colors.includes(K)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 shadow-lg scale-110":"opacity-60 hover:opacity-100"}
                                                    ${K==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                                    ${K==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                                    ${K==="B"?"bg-[#1F2937] text-white border-gray-600":""}
                                                    ${K==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                                    ${K==="G"?"bg-[#10B981] text-white border-green-600":""}
                                                    ${K==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                                    ${K==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
                                                `,title:K==="C"?"Colorless":K==="M"?"Multicolor":K,children:[K!=="M"&&K!=="C"&&s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${K}.svg`,alt:K,className:"w-4 h-4"}),K==="M"&&s.jsx("span",{className:"font-bold text-xs",children:"M"}),K==="C"&&s.jsx("span",{className:"font-bold text-xs",children:"C"})]},K))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(K=>s.jsx("button",{onClick:()=>V("rarity",K),className:`
                                                    px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                    ${S.rarity.includes(K)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                `,children:K},K))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(K=>s.jsx("button",{onClick:()=>V("types",K),className:`
                                                     px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                     ${S.types.includes(K)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                 `,children:K},K))})]}),s.jsxs("div",{className:"col-span-1 space-y-4",children:[s.jsx(rf,{label:"Filter by Set",options:B,selected:S.sets,onChange:K=>A(oe=>({...oe,sets:K})),placeholder:"All Sets"}),s.jsx(rf,{label:"Filter by Deck",options:O,selected:S.decks,onChange:K=>A(oe=>({...oe,decks:K})),placeholder:"All Decks"})]})]})}),o?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:Array.from({length:12}).map((K,oe)=>s.jsx(Vf,{},oe))}):d?s.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-8 rounded-2xl text-center",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Collection"}),s.jsx("p",{children:d.message})]}):s.jsxs(s.Fragment,{children:[L==="folder"&&!ie&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[ue.map(K=>s.jsxs("div",{onClick:()=>G(K.id),className:"bg-gray-900/40 hover:bg-gray-800/60 border border-white/5 hover:border-indigo-500/30 rounded-2xl p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-3 backdrop-blur-sm relative overflow-hidden",children:[s.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 bg-${K.color}-500/10 rounded-full blur-3xl`}),s.jsx("div",{className:"flex gap-1 mb-2 group-hover:scale-110 transition-transform",children:K.pips?K.pips.map((oe,me)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${oe}.svg`,alt:oe,className:"w-8 h-8 drop-shadow-md transition-transform group-hover:scale-110"},me)):s.jsx("div",{className:`w-12 h-12 bg-${K.color}-900/30 text-${K.color}-400 rounded-xl flex items-center justify-center text-2xl`,children:K.icon})}),s.jsxs("div",{className:"z-10 px-2 mt-4",children:[s.jsx("div",{className:"text-[10px] uppercase tracking-tighter text-indigo-400 font-black mb-1",children:K.theme||K.sub}),s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors leading-tight",children:K.label}),K.flavor&&s.jsxs("p",{className:"text-[10px] text-gray-500 italic mt-2 font-serif px-2 leading-relaxed opacity-80 group-hover:opacity-100 transition-opacity",children:['"',K.flavor,'"']})]}),s.jsxs("span",{className:"mt-4 px-3 py-1 bg-black/30 rounded-full text-xs font-mono text-gray-400 border border-white/5",children:[K.cards.length," cards"]})]},K.id)),ue.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards match your filter criteria."})]}),L==="folder"&&ie&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>G(null),className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[ie.icon," ",ie.label]})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:ie.cards.map(K=>s.jsx("div",{className:"h-full",children:s.jsx(vd,{card:K})},K.firestoreId||K.id))})]}),L==="grid"&&s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 animate-fade-in",children:[ye.map(K=>s.jsx("div",{className:"h-full",children:s.jsx(vd,{card:K})},K.firestoreId||K.id)),ye.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards found."})]}),L==="table"&&s.jsx("div",{className:"animate-fade-in",children:s.jsx(K_,{cards:ye})})]})]})]}),s.jsx(yb,{isOpen:X,onClose:()=>se(!1)}),s.jsx(kx,{isOpen:te,onClose:()=>R(!1)}),s.jsx(J_,{isOpen:k,onClose:()=>E(!1)}),s.jsx(kx,{isOpen:te,onClose:()=>R(!1)})]})},Z_=[{badge:"White",colors:["W"]},{badge:"Blue",colors:["U"]},{badge:"Black",colors:["B"]},{badge:"Red",colors:["R"]},{badge:"Green",colors:["G"]},{badge:"Azorius",colors:["W","U"]},{badge:"Dimir",colors:["U","B"]},{badge:"Rakdos",colors:["B","R"]},{badge:"Gruul",colors:["R","G"]},{badge:"Selesnya",colors:["G","W"]},{badge:"Orzhov",colors:["W","B"]},{badge:"Izzet",colors:["U","R"]},{badge:"Golgari",colors:["B","G"]},{badge:"Boros",colors:["R","W"]},{badge:"Simic",colors:["G","U"]},{badge:"Esper",colors:["W","U","B"]},{badge:"Grixis",colors:["U","B","R"]},{badge:"Jund",colors:["B","R","G"]},{badge:"Naya",colors:["R","G","W"]},{badge:"Bant",colors:["G","W","U"]},{badge:"Abzan",colors:["W","B","G"]},{badge:"Jeskai",colors:["U","R","W"]},{badge:"Sultai",colors:["B","G","U"]},{badge:"Mardu",colors:["R","W","B"]},{badge:"Temur",colors:["G","U","R"]},{badge:"Glint-Eye",colors:["U","B","R","G"]},{badge:"Dune-Brood",colors:["W","B","R","G"]},{badge:"Ink-Treader",colors:["W","U","R","G"]},{badge:"Witch-Maw",colors:["W","U","B","G"]},{badge:"Yore-Tiller",colors:["W","U","B","R"]},{badge:"WUBRG",colors:["W","U","B","R","G"]},{badge:"Colorless",colors:["C"]}],ek=()=>{const{decks:a,loading:n,error:i}=Gf();us();const{addToast:o}=Rn(),d=p=>{if(!p)return null;const x=p.data||p;return x.image_uris?.art_crop?x.image_uris.art_crop:x.card_faces?.[0]?.image_uris?.art_crop?x.card_faces[0].image_uris.art_crop:x.image_uris?.normal?x.image_uris.normal:null},h=p=>{const x=p?.commander?.color_identity||[],b=p?.commander_partner?.color_identity||[],N=[...new Set([...x,...b])];return N.length>0?N:["C"]},g=p=>{const x=Z_.find(b=>b.badge==="Colorless"&&(p.length===0||p.length===1&&p[0]==="C")?!0:b.colors.length!==p.length?!1:b.colors.every(N=>p.includes(N)));return x?x.badge:"Commander"};return n?s.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-950",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}):i?s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:s.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-6 rounded-2xl backdrop-blur-md",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Decks"}),s.jsx("p",{children:i.message})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-950 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/10 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-10 relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-10 border-b border-white/5 pb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"My Decks"}),s.jsx("p",{className:"text-gray-400 font-medium",children:"Manage your collection of strategies"})]}),s.jsxs(yt,{to:"/decks/new",className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center gap-2 border border-indigo-400/20 hover:border-indigo-400",children:[s.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"Create New Deck"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-8",children:[a.map(p=>{const x=h(p),b=g(x),N=Object.keys(p.cards||{}).length,j=d(p.commander),_=d(p.commander_partner);return s.jsx(yt,{to:`/decks/${p.id}`,className:"group relative flex flex-col h-[420px] rounded-3xl transition-all duration-300 hover:-translate-y-2",children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden",children:[s.jsxs("div",{className:"h-[60%] w-full relative overflow-hidden bg-gray-950",children:[p.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[s.jsx("img",{src:j||"https://placehold.co/400x600?text=?",alt:p.commander?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]}),s.jsxs("div",{className:"w-1/2 h-full relative",children:[s.jsx("img",{src:_||"https://placehold.co/400x600?text=?",alt:p.commander_partner?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]})]}):j?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:j,alt:p.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("svg",{className:"w-16 h-16 text-gray-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),p.is_mockup&&s.jsx("div",{className:"absolute top-3 left-3 px-2 py-1 bg-orange-500/20 text-orange-400 border border-orange-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg",children:"Mockup"})]}),s.jsxs("div",{className:"h-[40%] p-5 flex flex-col justify-between relative",children:[s.jsx("div",{className:"absolute -top-3 left-5 flex gap-1 bg-gray-900/80 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:(p.format?.toLowerCase()==="standard"?p.colors||[]:x).map(I=>{const L=`https://svgs.scryfall.io/card-symbols/${I}.svg`;return s.jsx("img",{src:L,alt:I,className:"w-4 h-4 shadow-sm"},I)})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-1 opacity-80",children:b}),s.jsx("h3",{className:"text-xl font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:p.name||"Untitled Deck"}),s.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:p.commander_partner?`${p.commander?.name} & ${p.commander_partner?.name}`:p.commander?.name||"No Commander"})]}),s.jsxs("div",{className:"flex justify-between items-center border-t border-white/5 pt-4 mt-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Format"}),s.jsx("span",{className:"text-xs text-gray-300 font-medium",children:p.format||"Commander"})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Cards"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${N>=(p.format?.toLowerCase()==="standard"?60:100)?"text-green-500":"text-indigo-400"}`,children:[N,s.jsxs("span",{className:"text-gray-600 text-[10px]",children:["/",p.format?.toLowerCase()==="standard"?"60":"100"]})]})]})]})]})]})},p.id)}),a.length===0&&s.jsxs("div",{className:"col-span-full py-32 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800/50 rounded-full flex items-center justify-center mb-6",children:s.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 4v16m8-8H4"})})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-300 mb-2",children:"Start Your Journey"}),s.jsx("p",{className:"text-gray-500 mb-8 max-w-md",children:"You haven't built any decks yet. Create your first commander deck to get started."}),s.jsx(yt,{to:"/decks/new",className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all shadow-lg shadow-indigo-500/20",children:"Create Deck"})]})]})]})]})},tk=[{badge:"White",colors:["W"],flavor:"Order, protection, and the light of law."},{badge:"Blue",colors:["U"],flavor:"Knowledge, manipulation, and the perfection of mind."},{badge:"Black",colors:["B"],flavor:"Power, ambition, and death at any cost."},{badge:"Red",colors:["R"],flavor:"Freedom, emotion, and the fire of impulse."},{badge:"Green",colors:["G"],flavor:"Nature, instinct, and the strength of the wild."},{badge:"Colorless",colors:["C"],flavor:"The void between, pure and unyielding."},{badge:"Azorius",colors:["W","U"],flavor:"The law is the shield of the just."},{badge:"Dimir",colors:["U","B"],flavor:"Knowledge is power, and we know everything."},{badge:"Rakdos",colors:["B","R"],flavor:"Entertainment is a serious business."},{badge:"Gruul",colors:["R","G"],flavor:"Not Gruul? Then die!"},{badge:"Selesnya",colors:["G","W"],flavor:"Together, we are the world's soul."},{badge:"Orzhov",colors:["W","B"],flavor:"Wealth is power, and spirit is currency."},{badge:"Izzet",colors:["U","R"],flavor:"Genius and madness are two sides of the same coin."},{badge:"Golgari",colors:["B","G"],flavor:"Life and death are a continuous circle."},{badge:"Boros",colors:["R","W"],flavor:"Strike fast, strike hard, strike true."},{badge:"Simic",colors:["G","U"],flavor:"Nature, perfected by design."},{badge:"Esper",colors:["W","U","B"],flavor:"Perfection through etherium and discipline."},{badge:"Grixis",colors:["U","B","R"],flavor:"Life is short, death is forever."},{badge:"Jund",colors:["B","R","G"],flavor:"Only the strongest survive the feeding frenzy."},{badge:"Naya",colors:["R","G","W"],flavor:"Where giant beasts roam and the wild reigns."},{badge:"Bant",colors:["G","W","U"],flavor:"Honor, valor, and the righteousness of caste."},{badge:"Abzan",colors:["W","B","G"],flavor:"Family is the only fortress that matters."},{badge:"Jeskai",colors:["U","R","W"],flavor:"Cunning strategies and swift strikes."},{badge:"Sultai",colors:["B","G","U"],flavor:"Ruthlessness is a virtue in the opulent dark."},{badge:"Mardu",colors:["R","W","B"],flavor:"Speed of the horse, edge of the blade."},{badge:"Temur",colors:["G","U","R"],flavor:"Savagery concealed by ice and snow."},{badge:"Glint-Eye",colors:["U","B","R","G"],flavor:"Chaos without order."},{badge:"Dune-Brood",colors:["W","B","R","G"],flavor:"Growth through conflict."},{badge:"Ink-Treader",colors:["W","U","R","G"],flavor:"Motion without purpose."},{badge:"Witch-Maw",colors:["W","U","B","G"],flavor:"Life without death."},{badge:"Yore-Tiller",colors:["W","U","B","R"],flavor:"Artifice without nature."},{badge:"WUBRG",colors:["W","U","B","R","G"],flavor:"All five colors in perfect harmony."}],nk=a=>{const n=a||[],i=n.length;return tk.find(d=>d.badge==="Colorless"&&(i===0||i===1&&n[0]==="C")?!0:d.colors.length!==i?!1:d.colors.every(h=>n.includes(h)))||{badge:"Commander",colors:n,flavor:"A unique combination of powers."}},sk=({isOpen:a,onClose:n,onAdd:i})=>{const{addToast:o}=Rn(),[d,h]=w.useState(""),[g,p]=w.useState(!1),[x,b]=w.useState([]),[N,j]=w.useState(null),[_,I]=w.useState(!1),[L,T]=w.useState([]),[U,P]=w.useState("and"),[z,G]=w.useState(""),[X,se]=w.useState(""),te=S=>{T(A=>A.includes(S)?A.filter(B=>B!==S):[...A,S])},R=async S=>{S.preventDefault();const A=L.length>0||z.trim()||X.trim();if(!(!d.trim()&&!A)){p(!0);try{let B=null;if(X.trim()){const ue=X.trim().match(/^([<>]=?|=)?\s*(\d+)$/);ue&&(B={operator:ue[1]||"=",value:parseInt(ue[2],10)})}const O={query:d,type:"legendary creature",text:z,colors:L.length>0?L:void 0,colorIdentity:!0,colorLogic:U,mv:B},ye=await Ge.post("/cards/search",O);b(ye.data||[])}catch(B){console.error(B),o("Search failed. The Oracle is unreachable.","error")}finally{p(!1)}}},k=async S=>{j({id:S.id,name:S.name});try{const A={scryfall_id:S.id,name:S.name,set_code:S.set,collector_number:S.collector_number,finish:"nonfoil",count:1,data:S,is_wishlist:!0};await Ge.post("/collection",A),o(`"${S.name}" added to Wishlist!`,"success"),i&&i(),n()}catch(A){console.error(A),o("Failed to add to wishlist.","error")}finally{j(null)}};if(!a)return null;const E={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"}};return aa.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] flex flex-col border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gray-950/50 flex justify-between items-center shrink-0",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-purple-400",children:"Summon Legend"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/20 text-purple-300 uppercase tracking-wider border border-purple-500/30",children:"Wishlist"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search the multiverse for a commander you don't own yet."})]}),s.jsx("button",{onClick:n,className:"p-2 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"bg-gray-900 border-b border-white/5 flex flex-col shrink-0",children:s.jsxs("form",{onSubmit:R,className:"p-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"Search by name...",className:"w-full bg-gray-950 border border-white/10 rounded-2xl py-4 pl-14 pr-4 text-lg text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all shadow-inner",autoFocus:!_}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("button",{type:"button",onClick:()=>I(!_),className:`px-4 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${_?"bg-purple-600 text-white border-purple-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(mb,{className:"w-5 h-5"}),"Filters"]}),s.jsx("button",{type:"submit",disabled:g,className:"px-8 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-2xl transition-all disabled:opacity-50 shadow-lg shadow-purple-500/20",children:g?"Searching...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${_?"max-h-96 opacity-100 mt-6":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Color Identity"}),s.jsx("div",{className:"flex gap-2",children:Object.entries(E).map(([S,A])=>s.jsx("button",{type:"button",onClick:()=>te(S),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${L.includes(S)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:L.includes(S)?"transparent":""},children:s.jsx("img",{src:A.symbol,alt:S,className:`w-full h-full ${L.includes(S)?"drop-shadow-md":"grayscale"}`})},S))}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[s.jsx("span",{className:`cursor-pointer ${U==="or"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>P("or"),children:"Includes any (OR)"}),s.jsx("div",{className:"w-10 h-5 bg-gray-800 rounded-full relative cursor-pointer border border-white/10",onClick:()=>P(S=>S==="or"?"and":"or"),children:s.jsx("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-purple-500 transition-all ${U==="and"?"left-5.5":"left-0.5"}`})}),s.jsx("span",{className:`cursor-pointer ${U==="and"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>P("and"),children:"Exact match (AND)"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Oracle Text"}),s.jsx("input",{type:"text",value:z,onChange:S=>G(S.target.value),placeholder:"e.g. 'draw cards', 'counter'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm"}),s.jsx("p",{className:"text-[10px] text-gray-600",children:"Searches abilities and rules text."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Mana Value (CMC)"}),s.jsx("input",{type:"text",value:X,onChange:S=>se(S.target.value),placeholder:"e.g. '4' or '<= 3'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm font-mono"})]})]})})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-950/30 custom-scrollbar",children:[!g&&x.length===0&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40",children:[s.jsx("svg",{className:"w-24 h-24 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),s.jsx("p",{className:"text-xl font-bold text-gray-400",children:"No legends found."}),s.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.map(S=>{const A=S.image_uris?.art_crop||S.image_uris?.normal||S.data?.image_uris?.art_crop||S.data?.image_uris?.normal,B=N?.id===S.id;return s.jsxs("div",{className:"group relative bg-gray-900 rounded-2xl border border-white/5 overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-2xl hover:shadow-purple-500/10 hover:-translate-y-1",children:[s.jsxs("div",{className:"h-60 w-full bg-black relative",children:[A?s.jsx("img",{src:A,alt:S.name,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-500"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-700 font-bold",children:"No Art"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent"})]}),s.jsxs("div",{className:"p-4 relative",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-300 transition-colors line-clamp-1",children:S.name}),s.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-1",children:S.type_line}),s.jsx("button",{onClick:()=>k(S),disabled:B,className:"w-full py-2 bg-white/5 hover:bg-purple-600 text-gray-300 hover:text-white rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 group-hover:bg-purple-600 group-hover:text-white",children:B?s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add to Wishlist"]})})]})]},S.id)})})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(168, 85, 247, 0.4); }
            `}})]}),document.body)},_t={BASICS:1,COMMANDER:2,PARTNER:2.5,AI_STRATEGY:3,REVIEW:4},rk=()=>{const a=us(),{userProfile:n}=vt(),{addToast:i}=Rn(),[o,d]=w.useState(_t.BASICS),[h,g]=w.useState(!1),[p,x]=w.useState("folder"),[b,N]=w.useState({}),[j,_]=w.useState(null),[I,L]=w.useState(""),[T,U]=w.useState("Commander"),[P,z]=w.useState([]),[G,X]=w.useState(null),[se,te]=w.useState(null),[R,k]=w.useState(""),[E,S]=w.useState(""),[A,B]=w.useState(null),[O,ye]=w.useState("Consulting the Oracle..."),[ue,V]=w.useState(!1),[ie,K]=w.useState(!1);w.useEffect(()=>{window.scrollTo(0,0)},[o]);const oe=we=>{if(!we)return null;const je=we.data||we;return je.image_uris?.art_crop?je.image_uris.art_crop:je.card_faces?.[0]?.image_uris?.art_crop?je.card_faces[0].image_uris.art_crop:je.image_uris?.normal?je.image_uris.normal:null},me=we=>{const Ee=(we.data||we).color_identity||[];return Ee.length>0?Ee:["C"]},D=(we,je)=>{we==="Commander"||we==="Standard"?F(we,je):console.warn("Unknown format selected")},F=async(we,je)=>{g(!0);try{const Ee={unused:!0};we==="Commander"&&(Ee.type_line="legendary creature"),je||(Ee.wishlist="false");const ke=await Ge.get("/collection",Ee);z(ke),d(_t.COMMANDER)}catch(Ee){console.error(Ee),i("Failed to load cards","error")}finally{g(!1)}},W=we=>{if(X(we),T==="Standard"){i("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info"),d(_t.REVIEW);return}const je=we.data||we,Ee=je.keywords||[],ke=je.oracle_text||"",Ae=Ee.includes("Partner")||ke.includes("Partner");d(Ae?_t.PARTNER:_t.AI_STRATEGY)},q=we=>{te(we),d(_t.AI_STRATEGY)},Q=async()=>{if(T==="Standard")return;const we=n?.settings?.geminiApiKey,je=n?.settings?.helper?.name||"The Oracle";if(!we){i("AI Key missing. Skipping strategy.","warning"),d(_t.REVIEW);return}g(!0),ye(`${je} is analyzing ${se?"your commanders":"your commander"}...`);try{const Ee=se?`${G.name} & ${se.name}`:G.name,ke=await Fn.getDeckStrategy(we,Ee,n.playstyle,[],n?.settings?.helper);ke.layout||(ke.layout={functional:{Lands:36,"Mana Ramp":10,"Card Draw":10,Removal:10,"Board Wipes":3,Synergy:30},types:{Creatures:30,Instants:10,Sorceries:10,Artifacts:10,Enchantments:4,Planeswalkers:0,Lands:36}}),B(ke),!I.trim()&&ke.suggestedName&&L(ke.suggestedName),d(_t.REVIEW)}catch(Ee){console.error(Ee),i("AI Generation Failed. Proceeding manually.","error"),B({theme:"",strategy:"Manual strategy required.",layout:{functional:{Lands:36,Creatures:63},types:{Lands:36,Creatures:63}}}),d(_t.REVIEW)}finally{g(!1)}},xe=async()=>{g(!0);try{const we={name:I||(se?`${G.name} & ${se.name}`:G?.name)||"New Commander Deck",format:T,commander:G?.data||G||null,commanderPartner:se?.data||se||null,aiBlueprint:A?{theme:A.theme,strategy:A.strategy,suggestedCounts:A.layout?.functional||A.layout,typeCounts:A.layout?.types}:null,isMockup:ue},je=await Ge.post("/decks",we);i("Deck created successfully!","success"),a(`/decks/${je.id}`)}catch(we){console.error(we),i("Failed to create deck","error")}finally{g(!1)}};w.useEffect(()=>{o===_t.AI_STRATEGY&&G&&!A&&Q()},[o]);const pe=({card:we,onClick:je,isSelected:Ee})=>{const ke=oe(we),Ae=me(we),Ce=we.data||we;return s.jsx("div",{onClick:()=>je(we),className:`group relative h-[480px] rounded-3xl cursor-pointer transition-all duration-300 hover:-translate-y-2 ${Ee?"ring-4 ring-indigo-500 scale-105":""}`,children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[55%] w-full relative overflow-hidden bg-gray-950",children:[ke?s.jsx("img",{src:ke,alt:we.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("span",{className:"text-gray-700 font-bold",children:"No Art"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}),s.jsxs("div",{className:"h-[45%] p-5 flex flex-col relative",children:[s.jsxs("div",{className:"absolute -top-3 left-5 flex gap-2 z-10",children:[s.jsx("div",{className:"flex gap-1 bg-gray-900/90 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:Ae.map((Be,Vt)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Be}.svg`,alt:Be,className:"w-4 h-4 shadow-sm"},Vt))}),we.finish==="foil"&&s.jsx("div",{className:"flex items-center justify-center w-8 h-8 -mt-1 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full shadow-[0_0_15px_rgba(250,204,21,0.6)] animate-pulse",title:"Foil",children:s.jsx("svg",{className:"w-5 h-5 text-white drop-shadow-sm",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),s.jsxs("div",{className:"mt-4 flex-1 flex flex-col gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:we.name}),s.jsx("p",{className:"text-xs text-gray-400 font-medium line-clamp-1 border-b border-white/5 pb-2 mb-2",children:Ce.type_line})]}),s.jsx("p",{className:"text-[10px] text-gray-300 leading-relaxed font-serif opacity-80 line-clamp-4",children:Ce.oracle_text})]}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[Ce.power&&Ce.toughness&&s.jsxs("div",{className:"bg-gray-800/80 px-2 py-1 rounded text-xs font-bold text-white border border-white/10 shadow-inner",children:[Ce.power," / ",Ce.toughness]}),s.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select"})]})]})]})})},_e=w.useMemo(()=>{if(!P.length)return{};const we={};return P.filter(Ee=>Ee.name.toLowerCase().includes(R.toLowerCase())||(Ee.data?.type_line||"").toLowerCase().includes(R.toLowerCase())).forEach(Ee=>{const ke=me(Ee),Ae=nk(ke);we[Ae.badge]||(we[Ae.badge]={identity:Ae,cards:[]}),we[Ae.badge].cards.push(Ee)}),we},[P,R]),Te=()=>{const we=R.trim().length>0,je=Object.entries(_e).sort((ke,Ae)=>{const Ce=ke[1].identity.colors.length-Ae[1].identity.colors.length;return Ce!==0?Ce:Ae[1].cards.length-ke[1].cards.length}),Ee=(ke,Ae,Ce)=>s.jsxs("div",{onClick:Ce,className:"w-full bg-gray-900/60 hover:bg-gray-800/60 backdrop-blur-md border border-white/5 rounded-2xl p-6 cursor-pointer transition-all flex items-center justify-between group mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-1.5 border border-white/5",children:ke.identity.colors.map(Be=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Be}.svg`,alt:Be,className:"w-5 h-5 shadow-sm"},Be))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:ke.identity.badge}),s.jsxs("p",{className:"text-sm text-gray-400 italic line-clamp-1",children:['"',ke.identity.flavor,'"']})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[ke.cards.length," ",T==="Commander"?"Legends":"Cards"]}),s.jsx("svg",{className:`w-6 h-6 text-gray-400 transform transition-transform ${Ae?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]});return s.jsxs("div",{className:"animate-fade-in space-y-6 h-full flex flex-col",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-4 gap-4 shrink-0",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:T==="Commander"?"Choose Commander":"Choose Spotlight Card"}),s.jsx("p",{className:"text-gray-400",children:T==="Commander"?"Select the legend who will lead your deck.":"Select a card to feature as the face of your deck."})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:()=>K(!0),className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-purple-500/20 flex items-center gap-2 transition-all hover:-translate-y-0.5",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Database"]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-1 flex border border-white/10",children:[s.jsx("button",{onClick:()=>x("list"),className:`p-2 rounded-lg transition-all ${p==="list"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),s.jsx("button",{onClick:()=>x("folder"),className:`p-2 rounded-lg transition-all ${p==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"Folder View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:T==="Commander"?"Search legends...":"Search cards...",value:R,onChange:ke=>k(ke.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute right-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:[p==="folder"&&!j&&s.jsx(s.Fragment,{children:je.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mb-6 border border-gray-700",children:s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Cards Found"}),s.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:R?"No cards match your search filters.":"We couldn't find any qualifying cards in your collection."}),s.jsxs("button",{onClick:()=>K(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-500/20 hover:-translate-y-1 transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Full Database"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:je.map(([ke,Ae])=>s.jsxs("div",{onClick:()=>_(ke),className:"bg-gray-800/40 hover:bg-gray-700/50 border border-white/5 rounded-2xl p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-3 backdrop-blur-sm",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-2 border border-white/5",children:Ae.identity.colors.map(Ce=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Ce}.svg`,alt:Ce,className:"w-6 h-6"},Ce))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white group-hover:text-indigo-300 transition-colors uppercase tracking-wide",children:Ae.identity.badge}),s.jsx("div",{className:"h-0.5 w-8 bg-indigo-500/50 mx-auto my-2"}),s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',Ae.identity.flavor,'"']})]}),s.jsxs("span",{className:"text-sm font-mono font-bold text-gray-500 bg-black/20 px-3 py-1 rounded-full mt-2",children:[Ae.cards.length," ",T==="Commander"?"Legends":"Cards"]})]},ke))})}),p==="folder"&&j&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:()=>_(null),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors font-bold uppercase text-xs tracking-widest mb-4",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Groups"]}),s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("h3",{className:"text-3xl font-black text-white",children:_e[j].identity.badge}),s.jsx("div",{className:"flex gap-1",children:_e[j].identity.colors.map(ke=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ke}.svg`,alt:ke,className:"w-6 h-6"},ke))})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:_e[j].cards.map(ke=>s.jsx(pe,{card:ke,onClick:W},ke.id))})]}),p==="list"&&s.jsx("div",{className:"space-y-4",children:je.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in border border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-400",children:"No cards found in your collection matching criteria."}),s.jsx("button",{onClick:()=>K(!0),className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 hover:underline",children:"Search Scryfall Database"})]}):je.map(([ke,Ae])=>{const Ce=b[ke]||we;return s.jsxs("div",{children:[Ee(Ae,Ce,()=>N(Be=>({...Be,[ke]:!Be[ke]}))),Ce&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8 pl-4 border-l-2 border-white/5 animate-fade-in",children:Ae.cards.map(Be=>s.jsx(pe,{card:Be,onClick:W},Be.id))})]},ke)})})]})]})},Ve=()=>{const we=P.filter(je=>{const Ee=je.data||je,ke=Ee.keywords||[],Ae=Ee.oracle_text||"",Ce=ke.includes("Partner")||Ae.includes("Partner");return je.id===G?.id||!Ce?!1:je.name.toLowerCase().includes(E.toLowerCase())});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Choose Partner"}),s.jsxs("p",{className:"text-gray-400",children:["Select a partner for ",G?.name,"."]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"relative",children:s.jsx("input",{type:"text",placeholder:"Search partners...",value:E,onChange:je=>S(je.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"})}),s.jsx("button",{onClick:()=>{te(null),d(_t.AI_STRATEGY)},className:"text-sm font-bold text-gray-400 hover:text-white underline self-center",children:"Skip / Solo Commander"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 max-h-[65vh] overflow-y-auto pr-2 custom-scrollbar",children:[we.map(je=>s.jsx(pe,{card:je,onClick:q},je.id)),we.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500",children:"No valid partners found matching your search."})]})]})},Ie=()=>s.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in text-center",children:[s.jsxs("div",{className:"relative mb-8",children:[s.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full animate-ping absolute inset-0"}),s.jsx("div",{className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center relative shadow-[0_0_50px_rgba(79,70,229,0.5)]",children:s.jsx("svg",{className:"w-10 h-10 text-white animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})]}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:O}),s.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Brewing a perfect strategy tailored to your playstyle."})]}),Ye=()=>{const we=A?.layout?.functional||{},je=A?.layout?.types||{};return s.jsxs("div",{className:"animate-fade-in space-y-8 max-h-[70vh] overflow-y-auto pr-2 custom-scrollbar",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deck Name"}),s.jsx("input",{type:"text",value:I,onChange:Ee=>L(Ee.target.value),className:"w-full text-4xl font-black bg-transparent border-b-2 border-white/10 focus:border-indigo-500 text-white placeholder-gray-600 outline-none pb-2 transition-colors",placeholder:"Name your deck..."})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md",children:[s.jsx("h3",{className:"text-xl font-bold text-indigo-300 mb-4",children:"Theme & Strategy"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Theme"}),s.jsx("p",{className:"text-lg text-white font-medium",children:A?.theme})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Gameplan"}),s.jsx("div",{className:"text-sm text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:A?.strategy}})]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Composition Preview"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Functional Needs"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(we).map(([Ee,ke])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:Ee}),s.jsx("span",{className:"font-mono font-bold text-indigo-400",children:ke})]},Ee))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Type Balance"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(je).map(([Ee,ke])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:Ee}),s.jsx("span",{className:"font-mono font-bold text-emerald-400",children:ke})]},Ee))})]})]})]})]})},xt=G?oe(G):null;return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative overflow-hidden flex flex-col",children:[xt&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-cover bg-center transition-all duration-1000 transform scale-105",style:{backgroundImage:`url(${xt})`}}),s.jsx("div",{className:"fixed inset-0 bg-gray-950/60 backdrop-blur-2xl transition-all duration-1000"}),s.jsx("div",{className:"fixed inset-0 bg-gradient-to-t from-gray-950 via-gray-950/50 to-transparent"})]}),!xt&&s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/20 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"relative z-10 flex-1 flex flex-col max-w-[1600px] mx-auto w-full px-6 py-8",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx("button",{onClick:()=>a("/decks"),className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m-7 7h18"})})}),s.jsx("div",{className:"h-8 w-[1px] bg-white/10 mx-2"}),s.jsx("div",{className:"flex gap-2",children:[_t.BASICS,_t.COMMANDER,_t.AI_STRATEGY,_t.REVIEW].map((we,je)=>s.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${o>=we?"w-12 bg-indigo-500":"w-4 bg-gray-700"}`},we))})]}),s.jsxs("div",{className:"flex-1 bg-gray-950/40 border border-white/5 rounded-3xl p-8 shadow-2xl backdrop-blur-xl animate-fade-in-up flex flex-col overflow-hidden",children:[h&&o!==_t.AI_STRATEGY&&s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}),!h&&o===_t.BASICS&&s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-full space-y-12 animate-fade-in py-8",children:[s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tight text-center",children:["Let's build something ",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"legendary."})]}),s.jsxs("div",{className:"w-full max-w-5xl px-4 space-y-12",children:[G&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-white/5 backdrop-blur-sm animate-fade-in-down",children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:T==="Commander"?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"flex gap-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl opacity-50 group-hover:opacity-75 blur transition duration-500"}),s.jsx("img",{src:G.image_uris?.normal||G.image_uris?.large,alt:G.name,className:"relative w-64 rounded-xl shadow-2xl transform group-hover:scale-[1.02] transition-all duration-500"})]}),s.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-3xl font-black text-white mb-2",children:G.name}),s.jsx("p",{className:"text-gray-400 text-sm",children:G.type_line}),s.jsx("p",{className:"text-gray-300 mt-4 text-base leading-relaxed",children:G.oracle_text})]}),s.jsxs("button",{onClick:()=>X(null),className:"self-start text-sm font-bold text-red-400 hover:text-red-300 underline mt-4",children:["Change ",T==="Commander"?"Commander":"Spotlight Card"]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Commander"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{V(!1),U("Commander"),D("Commander",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-indigo-900/20 border border-white/10 hover:border-indigo-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-indigo-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-indigo-300 transition-colors",children:"From Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build using only cards you own.",s.jsx("br",{}),"Oracle verifies your binder."]})]})]}),s.jsxs("div",{onClick:()=>{V(!0),U("Commander"),D("Commander",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-purple-900/20 border border-white/10 hover:border-purple-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-purple-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-purple-300 transition-colors",children:"Theorycraft Mockup"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Design without limits.",s.jsx("br",{}),"Missing cards added to wishlist."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Standard"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{V(!1),U("Standard"),D("Standard",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-emerald-900/20 border border-white/10 hover:border-emerald-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-emerald-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-emerald-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-emerald-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-emerald-300 transition-colors",children:"Standard Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build a 60-card Standard deck.",s.jsx("br",{}),"Using your own cards."]})]})]}),s.jsxs("div",{onClick:()=>{V(!0),U("Standard"),D("Standard",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-cyan-900/20 border border-white/10 hover:border-cyan-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-cyan-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-cyan-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-cyan-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-cyan-300 transition-colors",children:"Standard Theorycraft"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Test new Standard meta decks.",s.jsx("br",{}),"Without owning every card."]})]})]})]})]})]})]}),!h&&o===_t.COMMANDER&&Te(),!h&&o===_t.PARTNER&&Ve(),o===_t.AI_STRATEGY&&Ie(),!h&&o===_t.REVIEW&&Ye()]}),!h&&o===_t.REVIEW&&s.jsx("div",{className:"mt-6 flex justify-end animate-fade-in-up",children:s.jsxs("button",{onClick:xe,disabled:h,className:"bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 px-12 rounded-2xl shadow-lg shadow-indigo-500/20 transform hover:-translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3",children:[h?"Forging Deck...":"Create Deck",!h&&s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]}),s.jsx(sk,{isOpen:ie,onClose:()=>K(!1),onAdd:()=>F()})]})};function bb(a){const[n,i]=w.useState(null),[o,d]=w.useState([]),[h,g]=w.useState(!0),[p,x]=w.useState(null),{currentUser:b}=vt(),N=async()=>{if(!(!b||!a||a==="new")){g(!0);try{const{deck:j,items:_}=await Ge.get(`/decks/${a}`);i(j),d(_.map(I=>({...I,countInDeck:I.count||1,managedId:I.id}))),x(null)}catch(j){console.error("Error fetching deck:",j),x(j)}finally{g(!1)}}};return w.useEffect(()=>{if(!b||!a){g(!1);return}N()},[b,a]),{deck:n,cards:o,loading:h,error:p,refresh:N}}const ak=({isOpen:a,onClose:n,onConfirm:i,title:o,message:d,confirmText:h="Confirm",cancelText:g="Cancel",isDanger:p=!1})=>a?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-fade-in",children:s.jsx("div",{className:"bg-gray-800 rounded-xl shadow-2xl border border-gray-700 w-full max-w-md transform transition-all scale-100 animate-scale-in",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",id:"modal-title",children:o}),s.jsx("p",{className:"text-gray-300 mb-6",children:d}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-gray-700 transition-colors font-medium",children:g}),s.jsx("button",{onClick:()=>{i(),n()},className:`px-4 py-2 rounded-lg text-white font-bold shadow-lg transition-transform transform hover:-translate-y-0.5 ${p?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:h})]})]})})}):null,td=[{key:"W",name:"White",color:"bg-yellow-100",text:"text-yellow-600",border:"border-yellow-200/50",bg:"bg-yellow-500/10",pip:""},{key:"U",name:"Blue",color:"bg-blue-400",text:"text-blue-400",border:"border-blue-500/30",bg:"bg-blue-500/10",pip:""},{key:"B",name:"Black",color:"bg-gray-600",text:"text-gray-400",border:"border-gray-500/30",bg:"bg-gray-500/10",pip:""},{key:"R",name:"Red",color:"bg-red-500",text:"text-red-400",border:"border-red-500/30",bg:"bg-red-500/10",pip:""},{key:"G",name:"Green",color:"bg-green-500",text:"text-green-400",border:"border-green-500/30",bg:"bg-green-500/10",pip:""},{key:"C",name:"Colorless",color:"bg-gray-400",text:"text-gray-500",border:"border-gray-600/30",bg:"bg-gray-600/10",pip:""}],ik=({cards:a=[]})=>{const n=w.useMemo(()=>{const o={pips:{W:0,U:0,B:0,R:0,G:0,C:0},production:{W:0,U:0,B:0,R:0,G:0,C:0},curve:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0},colorCurve:{W:[0,0,0,0,0,0,0,0],U:[0,0,0,0,0,0,0,0],B:[0,0,0,0,0,0,0,0],R:[0,0,0,0,0,0,0,0],G:[0,0,0,0,0,0,0,0],C:[0,0,0,0,0,0,0,0]},totalPips:0,totalProduction:0,nonLandCount:0,avgCMC:0};let d=0;return a.forEach(h=>{const g=h.data||h,p=(g.type_line||"").toLowerCase(),x=p.includes("land"),b=g.mana_cost||"",N=(g.oracle_text||"").toLowerCase();if(!x){o.nonLandCount+=h.countInDeck||1;const I=g.cmc??0;d+=I*(h.countInDeck||1),(b.match(/\{([^}]+)\}/g)||[]).forEach(U=>{U.slice(1,-1).split("/").forEach(G=>{if(["W","U","B","R","G","C"].includes(G)){o.pips[G]+=h.countInDeck||1,o.totalPips+=h.countInDeck||1;const X=Math.min(Math.floor(I),7);o.colorCurve[G][X]+=h.countInDeck||1}})});const T=I>=7?"7+":Math.floor(I);o.curve[T]+=h.countInDeck||1}let j=g.produced_mana||[];(N.includes("any color")||N.includes("mana of any color"))&&(j=["W","U","B","R","G"]),j.length===0&&x&&(p.includes("plains")&&j.push("W"),p.includes("island")&&j.push("U"),p.includes("swamp")&&j.push("B"),p.includes("mountain")&&j.push("R"),p.includes("forest")&&j.push("G")),!x&&N.includes("add {")&&["w","u","b","r","g","c"].forEach(I=>{N.includes(`add {${I}}`)&&j.push(I.toUpperCase())}),[...new Set(j)].forEach(I=>{o.production[I]!==void 0&&(o.production[I]+=h.countInDeck||1,o.totalProduction+=h.countInDeck||1)})}),o.avgCMC=o.nonLandCount>0?(d/o.nonLandCount).toFixed(2):0,o},[a]),i=(o,d="bg-indigo-500",h="h-48")=>{const g=Object.entries(o),p=Math.max(...g.map(x=>x[1]),1);return s.jsx("div",{className:`flex items-end gap-1 ${h} w-full px-2`,children:g.map(([x,b])=>s.jsxs("div",{className:"flex-1 flex flex-col items-center group relative",children:[b>0&&s.jsx("div",{className:`w-full ${d} rounded-t transition-all duration-500 group-hover:brightness-125`,style:{height:`${b/p*100}%`},children:s.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-bold text-white opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 px-1 rounded",children:b})}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 mt-2",children:x})]},x))})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Cost (Pips)"}),s.jsxs("span",{children:[n.totalPips," Total"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800",children:td.filter(o=>n.pips[o.key]>0).map(o=>s.jsx("div",{className:`${o.color} h-full transition-all duration-700`,style:{width:`${n.pips[o.key]/n.totalPips*100}%`},title:`${o.name}: ${n.pips[o.key]}`},o.key))})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Production"}),s.jsxs("span",{children:[n.totalProduction," Sources"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800 shadow-inner",children:td.filter(o=>n.production[o.key]>0).map(o=>s.jsx("div",{className:`${o.color} h-full transition-all duration-700 opacity-80`,style:{width:`${n.production[o.key]/n.totalProduction*100}%`},title:`${o.name}: ${n.production[o.key]}`},o.key))})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:td.map(o=>{const d=n.pips[o.key],h=n.production[o.key],g=n.totalPips>0?Math.round(d/n.totalPips*100):0,p=n.totalProduction>0?Math.round(h/n.totalProduction*100):0,x=d>0||h>0;return s.jsxs("div",{className:`p-4 rounded-2xl border transition-all duration-300 ${x?`${o.bg} ${o.border}`:"bg-gray-800/10 border-gray-800/50 opacity-40"}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("span",{className:"text-2xl",children:o.pip}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:`text-[10px] font-black uppercase tracking-tighter ${o.text}`,children:o.name})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Cost"}),s.jsxs("span",{className:"text-white",children:[g,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${o.color} transition-all duration-1000`,style:{width:`${g}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[d," pips"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Prod"}),s.jsxs("span",{className:"text-white",children:[p,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${o.color} opacity-60 transition-all duration-1000`,style:{width:`${p}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[h," mana"]})]})]})]},o.key)})}),s.jsxs("div",{className:"bg-gray-950/40 p-6 rounded-2xl border border-gray-800/50",children:[s.jsx("div",{className:"flex justify-between items-end mb-8",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"Mana Curve"}),s.jsxs("p",{className:"text-xs text-gray-500 font-medium",children:["Average Mana Value (Non-lands): ",s.jsx("span",{className:"text-indigo-400",children:n.avgCMC})]})]})}),i(n.curve,"bg-indigo-500","h-40")]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:td.filter(o=>n.pips[o.key]>0).map(o=>s.jsxs("div",{className:"bg-gray-900/30 p-4 rounded-xl border border-gray-800/50",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-lg",children:o.pip}),s.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${o.text}`,children:[o.name," Spells"]})]}),i(Object.fromEntries(n.colorCurve[o.key].map((d,h)=>[h===7?"7+":h,d])),o.color,"h-24")]},o.key))})]})},lk=({isOpen:a,onClose:n,cards:i,deckName:o})=>{const{userProfile:d}=vt(),h=d?.settings?.helper?.name||"The Oracle";return a?qx.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-6xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/5 shrink-0",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[10px] font-black font-mono text-indigo-400 uppercase tracking-widest bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20",children:"Analytics"}),s.jsx("span",{className:"text-[10px] font-black font-mono text-gray-400 uppercase tracking-widest bg-white/5 px-2 py-0.5 rounded border border-white/5",children:h})]}),s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Deck Performance"})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-8 custom-scrollbar",children:s.jsx(ik,{cards:i})}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0",children:s.jsx("button",{onClick:n,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Analytics"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body):null},ok=({isOpen:a,onClose:n,deck:i,cards:o=[]})=>{const{userProfile:d,currentUser:h}=vt(),{addToast:g}=Rn(),p=d?.settings?.helper?.name||"The Oracle",[x,b]=Tn.useState(!1),[N,j]=Tn.useState(0),[_,I]=Tn.useState(!1);if(Tn.useEffect(()=>(a?(j(0),I(!1),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]),!a||!i)return null;const L=i.aiBlueprint||{},T=L.strategy||'<p class="text-gray-400 italic">No strategy generated for this deck yet. Ask the Oracle to analyze it.</p>',U=L.theme||"Uncharted Strategy",P=[i.commander];i.commander_partner&&P.push(i.commander_partner);const z=P[N]||P[0],G=z?.card_faces?.length>1,X=()=>{if(!z)return"https://placehold.co/480x680?text=Commander";if(G){const k=z.card_faces[_?1:0];return k.image_uris?.art_crop||k.image_uris?.large||k.image_uris?.normal}return z.image_uris?.art_crop||z.image_uris?.large||z.image_uris?.normal||z.image_uri},se=L.layout?.functional||L.suggestedCounts||{},te=L.layout?.types||L.typeCounts||{},R=async()=>{if(!d?.settings?.geminiApiKey){g("Gemini API Key missing in settings.","error");return}b(!0);try{const k=await Fn.getDeckStrategy(d.settings.geminiApiKey,i.commander?.name||"Unknown Commander",d.playstyle,o,i.commander_partner?.name);await lr.updateDeck(h.uid,i.id,{aiBlueprint:{...L,theme:k.theme,strategy:k.strategy,layout:k.layout}}),g("Strategy updated based on your current build!","success"),window.location.reload()}catch(k){console.error(k),g("Failed to rerun strategy analysis.","error")}finally{b(!1)}};return qx.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-5xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"absolute -top-[20%] -right-[10%] w-[500px] h-[500px] bg-indigo-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("div",{className:"absolute -bottom-[20%] -left-[10%] w-[500px] h-[500px] bg-purple-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"px-10 py-8 border-b border-white/5 flex justify-between items-center bg-white/5 shrink-0 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm",children:s.jsx("span",{className:"text-3xl",children:""})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter uppercase leading-none mb-1",dangerouslySetInnerHTML:{__html:U}}),s.jsxs("p",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.3em]",children:[p," Strategic Blueprint"]})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:R,disabled:x,className:`flex items-center gap-3 px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all border ${x?"bg-white/5 text-gray-500 border-white/5 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white border-white/20 shadow-[0_0_20px_rgba(79,70,229,0.3)] hover:shadow-[0_0_30px_rgba(79,70,229,0.5)] active:scale-95"}`,children:[x?s.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),x?"Consulting Oracle...":`Have ${p} Recreate Strategy`]}),s.jsx("div",{className:"w-px h-8 bg-white/10 mx-2"}),s.jsx("button",{onClick:n,className:"p-3 bg-white/5 hover:bg-white/10 rounded-2xl transition-all text-gray-400 hover:text-white border border-white/5 hover:border-white/10 group",children:s.jsx("svg",{className:"w-6 h-6 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-10 py-10 custom-scrollbar space-y-12 relative z-10 overscroll-contain",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-12",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"sticky top-0 space-y-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl rounded-[2rem] group-hover:bg-indigo-500/30 transition-all duration-700"}),s.jsxs("div",{className:"relative aspect-[4/5] rounded-[2rem] overflow-hidden shadow-2xl border border-white/10 z-10 bg-black/40",children:[s.jsx("img",{src:X(),className:"w-full h-full object-cover transition-transform duration-700 active:scale-95",alt:z?.name}),G&&s.jsx("button",{onClick:()=>I(!_),className:"absolute top-4 right-4 p-3 bg-black/60 hover:bg-indigo-600 backdrop-blur-md rounded-full text-white border border-white/20 shadow-lg transition-all group/flip z-30",title:"Flip Card",children:s.jsx("svg",{className:`w-5 h-5 transition-transform duration-500 ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),s.jsx("div",{className:"absolute bottom-0 inset-x-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent",children:s.jsxs("div",{className:"text-white font-bold text-center text-sm leading-tight drop-shadow-md",children:[z.name,G&&s.jsx("span",{className:"block text-[9px] text-gray-400 font-normal mt-0.5 uppercase tracking-widest",children:_?"Back Face":"Front Face"})]})})]}),s.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20",children:s.jsxs("div",{className:"bg-black/80 text-white px-5 py-2 rounded-full border border-white/10 shadow-xl backdrop-blur-md flex items-center gap-2 whitespace-nowrap",children:[s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Cards"}),s.jsx("div",{className:"w-px h-3 bg-white/20"}),s.jsxs("span",{className:"text-sm font-black font-mono",children:[(o||[]).length,"/100"]})]})})]}),s.jsxs("div",{className:"text-center pt-4 space-y-4",children:[s.jsxs("div",{onClick:()=>{j(0),I(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${N===0?"bg-indigo-500/10 border-indigo-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${N===0?"text-indigo-400":"text-gray-600"}`,children:"Lead Commander"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${N===0?"text-white":"text-gray-400"}`,children:P[0]?.name})]}),P[1]&&s.jsxs("div",{onClick:()=>{j(1),I(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${N===1?"bg-purple-500/10 border-purple-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${N===1?"text-purple-400":"text-gray-600"}`,children:"Partnered With"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${N===1?"text-white":"text-gray-400"}`,children:P[1].name})]})]})]})}),s.jsxs("div",{className:"space-y-10",children:[s.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-9xl",children:""})}),s.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-px bg-gray-700"}),"Tactical Overview"]}),s.jsx("div",{className:"text-gray-300 leading-relaxed strategy-content-refined font-medium text-lg/8",dangerouslySetInnerHTML:{__html:T}})]}),s.jsxs("div",{className:"space-y-8",children:[Object.keys(se).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"}),"Target Functional Needs"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(se).map(([k,E])=>s.jsxs("div",{className:"bg-white/5 p-5 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-indigo-400 transition-colors h-8 flex items-center justify-center",children:k}),s.jsx("div",{className:"text-3xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:E})]},k))})]}),Object.keys(te).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-purple-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),"Target Type Distribution"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries(te).map(([k,E])=>s.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-purple-400 transition-colors h-8 flex items-center justify-center",children:k}),s.jsx("div",{className:"text-2xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:E})]},k))})]})]})]})]})}),s.jsx("div",{className:"px-10 py-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0 relative z-10",children:s.jsx("button",{onClick:n,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Blueprint"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .strategy-content-refined h4 {
                    font-size: 1.1rem;
                    font-weight: 800;
                    color: white;
                    margin-top: 1.5rem;
                    margin-bottom: 0.5rem;
                }
                .strategy-content-refined p {
                    margin-bottom: 1rem;
                }
                .strategy-content-refined strong {
                    color: #a5b4fc; /* Indigo 300 */
                }
                .strategy-content-refined ul {
                    list-style-type: disc;
                    padding-left: 1.5rem;
                    margin-bottom: 1rem;
                    color: #9ca3af;
                }
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body)},nd=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],ck=()=>{const{deckId:a}=cf(),n=us(),{currentUser:i,userProfile:o,updateSettings:d}=vt(),{addToast:h}=Rn(),g=o?.settings?.helper?.name||"The Oracle",[p,x]=w.useState(!1),[b,N]=w.useState(!1),[j,_]=w.useState(!1),[I,L]=w.useState(""),[T,U]=w.useState(0),[P,z]=w.useState({}),[G,X]=w.useState(!1),[se,te]=w.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[R,k]=w.useState(!1),[E,S]=w.useState(!1),[A,B]=w.useState(!0),[O,ye]=w.useState(o?.settings?.deckViewMode||"grid"),ue=ge=>{ye(ge),d({deckViewMode:ge})},{deck:V,cards:ie,loading:K,error:oe}=bb(a),{cards:me}=Yn(),D=w.useMemo(()=>{if(V?.format?.toLowerCase()==="standard"){const de=V.colors||V.commander?.color_identity||[];return nd.find(Ze=>Ze.colors.length!==de.length?!1:Ze.colors.every(Mn=>de.includes(Mn)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const ge=V?.commander?.color_identity||[],fe=V?.commander_partner?.color_identity||[],ve=[...new Set([...ge,...fe])];return!V||ve.length===0?nd.find(de=>de.badge==="Colorless"):nd.find(de=>de.colors.length!==ve.length?!1:de.colors.every(De=>ve.includes(De)))||nd.find(de=>de.badge==="Colorless")},[V]),F=w.useMemo(()=>{if(!me)return new Set;const ge=new Set;return me.forEach(fe=>{fe.finish==="foil"&&!fe.deckId&&ge.add(fe.name)}),ge},[me]),W=ge=>ie?ie.reduce((fe,ve)=>(ve.data?.type_line||ve.type_line||"").includes(ge)?fe+(ve.countInDeck||1):fe,0):0,q=w.useMemo(()=>ie?ie.reduce((ge,fe)=>ge+(fe.countInDeck||1),0):0,[ie]),Q=w.useMemo(()=>ie?ie.filter(ge=>!ge.is_wishlist).reduce((ge,fe)=>ge+(fe.countInDeck||1),0):0,[ie]),xe=w.useMemo(()=>ie?ie.reduce((ge,fe)=>{const ve=parseFloat(fe.prices?.[fe.finish==="foil"?"usd_foil":"usd"])||parseFloat(fe.data?.prices?.[fe.finish==="foil"?"usd_foil":"usd"])||0;return ge+ve*(fe.countInDeck||1)},0):0,[ie]),pe=w.useMemo(()=>{const ge=V?.aiBlueprint||{},fe=ge.layout?.types||ge.suggestedCounts||{};return[{label:"Total",current:q,target:V?.format?.toLowerCase()==="standard"||V?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:W("Creature"),target:fe.Creatures||fe.Creature||30},{label:"Lands",current:W("Land"),target:fe.Lands||fe.Land||36},{label:"Instants",current:W("Instant"),target:fe.Instants||fe.Instant||10},{label:"Sorceries",current:W("Sorcery"),target:fe.Sorceries||fe.Sorcery||10},{label:"Enchantments",current:W("Enchantment"),target:fe.Enchantments||fe.Enchantment||5},{label:"Artifacts",current:W("Artifact"),target:fe.Artifacts||fe.Artifact||10},{label:"Planeswalkers",current:W("Planeswalker"),target:fe.Planeswalkers||fe.Planeswalker||0}].filter(Me=>Me.target>0)},[V,q,ie]),_e=w.useMemo(()=>{if(!ie)return{};const ge={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]},fe=V?.commander?.id;return ie.forEach(ve=>{const Me=ve,de=(Me.data?.type_line||Me.type_line||"").toLowerCase();if(fe&&(Me.id===fe||Me.oracle_id===V?.commander?.oracle_id)){ge.Commander.push(Me);return}de.includes("creature")?ge.Creature.push(Me):de.includes("planeswalker")?ge.Planeswalker.push(Me):de.includes("instant")?ge.Instant.push(Me):de.includes("sorcery")?ge.Sorcery.push(Me):de.includes("artifact")?ge.Artifact.push(Me):de.includes("enchantment")?ge.Enchantment.push(Me):de.includes("land")?ge.Land.push(Me):ge.Other.push(Me)}),Object.fromEntries(Object.entries(ge).filter(([ve,Me])=>Me.length>0))},[ie,V]),Te=()=>{if(!V||!ie)return;const ge={deck:{name:V.name,commander:V.commander},cards:ie,exported_at:new Date},fe=JSON.stringify(ge,null,2),ve=new Blob([fe],{type:"application/json"}),Me=URL.createObjectURL(ve),de=document.createElement("a");de.href=Me,de.download=`${V.name.replace(/[^a-z0-9]/yi,"_")}_backup.json`,document.body.appendChild(de),de.click(),document.body.removeChild(de)},Ve=async ge=>{try{await lr.addCardToDeck(i.uid,a,ge),h(`Added ${ge.name} to deck`,"success")}catch(fe){console.error(fe),h("Failed to add card to deck","error")}},Ie=async(ge,fe)=>{te({isOpen:!0,title:"Remove Card",message:`Are you sure you want to remove ${fe} from this deck?`,onConfirm:async()=>{try{await lr.removeCardFromDeck(i.uid,a,ge),h(`Removed ${fe} from deck`,"success")}catch(ve){console.error(ve),h("Failed to remove card","error")}}})},Ye=ge=>{if(!ge)return"https://placehold.co/250x350?text=No+Image";const fe=ge.data||ge;return P[fe.id]&&fe.card_faces&&fe.card_faces[1]&&fe.card_faces[1].image_uris?.normal?fe.card_faces[1].image_uris.normal:fe.image_uris?.normal?fe.image_uris.normal:fe.card_faces?.[0]?.image_uris?.normal?fe.card_faces[0].image_uris.normal:ge.image_uri?ge.image_uri:"https://placehold.co/250x350?text=No+Image"},xt=async(ge,fe,ve)=>{if(ge.stopPropagation(),V.commander_partner&&T!==ve){U(ve);return}const Me=fe.data||fe;if(!(!Me.card_faces||Me.card_faces.length<2)){if(!P[Me.id]&&!Me.card_faces[1].image_uris){X(!0);try{h("Fetching back face data...","info");const de=await fetch(`https://api.scryfall.com/cards/${Me.id}`);if(!de.ok)throw new Error("Fetch failed");const De=await de.json(),Ze=ve===0?{commander:De}:{commanderPartner:De};await lr.updateDeck(i.uid,a,Ze),ve===0?V.commander=De:V.commander_partner=De,h("Commander data updated.","success")}catch(de){console.error("Flip fix failed",de),h("Could not load card back.","error")}finally{X(!1)}}z(de=>({...de,[Me.id]:!de[Me.id]}))}},we=()=>{L(V.name),_(!0)},je=async()=>{try{await lr.updateDeck(i.uid,a,{name:I}),h("Deck renamed successfully","success"),_(!1),window.location.reload()}catch(ge){console.error(ge),h("Failed to rename deck","error")}},Ee=async()=>{try{await lr.updateDeck(i.uid,a,{is_mockup:!V.is_mockup}),h(`Deck set to ${V.is_mockup?"Collection":"Mockup"} mode`,"info"),window.location.reload()}catch(ge){console.error(ge),h("Failed to update deck mode","error")}},ke=()=>{te({isOpen:!0,title:"Delete Deck",message:"Are you sure you want to delete this deck? Cards inside will be returned to your collection binder.",onConfirm:async()=>{try{await lr.deleteDeck(i.uid,a),h("Deck deleted successfully","success"),n("/decks")}catch(ge){console.error(ge),h("Failed to delete deck","error")}}})},Ae=ge=>{if(!ge)return"";const fe=ge.data||ge;return P[fe.id]&&fe.card_faces&&fe.card_faces[1]&&fe.card_faces[1].image_uris?.art_crop?fe.card_faces[1].image_uris.art_crop:fe.image_uris?.art_crop?fe.image_uris.art_crop:fe.card_faces?.[0]?.image_uris?.art_crop?fe.card_faces[0].image_uris.art_crop:fe.image_uris?.normal?fe.image_uris.normal:ge.image_uri?ge.image_uri:""};if(K)return s.jsx("div",{className:"flex justify-center p-20",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(oe)return s.jsxs("div",{className:"p-20 text-center text-red-500 text-xl font-bold",children:["Error loading deck: ",oe.message]});if(!V)return null;const Ce=T===0?V.commander:V.commander_partner||V.commander,Be=Ae(Ce),Vt={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"};return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${Be})`,backgroundSize:"cover",backgroundPosition:"center"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"})}),s.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 md:p-6 space-y-6 animate-fade-in pb-24 relative z-10",children:[s.jsx("div",{className:"sticky top-16 z-40 px-4 md:px-8 py-3 bg-gray-950/40 backdrop-blur-3xl border-b border-white/5 shadow-2xl transition-all duration-300 rounded-b-3xl mx-2",children:s.jsxs("div",{className:"max-w-[1600px] mx-auto flex flex-col lg:flex-row justify-between items-center gap-6",children:[s.jsxs("div",{className:"flex items-center gap-6 w-full lg:w-auto",children:[s.jsx("button",{onClick:()=>n("/decks"),className:"p-2.5 bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white rounded-xl border border-white/5 transition-all shrink-0 group",title:"Back to Decks",children:s.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[j?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:I,onChange:ge=>L(ge.target.value),className:"bg-black/50 text-2xl font-black text-white border-b-2 border-indigo-500 outline-none px-2 py-1 w-full max-w-md backdrop-blur-sm rounded",autoFocus:!0}),s.jsx("button",{onClick:je,className:"p-2 bg-green-600 rounded-lg hover:bg-green-500 text-white shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}):s.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.jsxs("div",{className:"flex items-center gap-3 group",children:[s.jsx("h2",{className:"text-4xl font-black text-white tracking-tighter uppercase truncate leading-none",children:V.name}),s.jsx("button",{onClick:we,className:"opacity-0 group-hover:opacity-100 transition-opacity text-gray-500 hover:text-white",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),s.jsxs("div",{className:"flex items-center gap-3 pl-0.5",children:[s.jsxs("div",{className:"text-[11px] text-indigo-300 font-black uppercase tracking-[0.2em] opacity-80",children:[D.badge,"  ",D.theme]}),s.jsx("div",{className:"flex items-center gap-1",children:(()=>{const ge=V?.commander?.color_identity||[],fe=V?.commander_partner?.color_identity||[];return[...new Set([...ge,...fe])].map(Me=>s.jsx("img",{src:Vt[Me],alt:Me,className:"w-4 h-4 shadow-sm"},Me))})()})]})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[s.jsxs("div",{className:"flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-xl border border-white/5 backdrop-blur-md shadow-2xl",children:[s.jsx("span",{className:"bg-orange-600/20 text-orange-400 px-2.5 py-0.5 rounded-full text-[10px] font-black uppercase tracking-widest border border-orange-500/30",children:V.format||"Commander"}),V.is_mockup&&s.jsx("span",{className:"bg-red-600/20 text-red-400 px-2.5 py-0.5 rounded-full text-[10px] font-black uppercase tracking-widest border border-red-500/30",children:"Mockup"}),s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-xs font-bold font-mono",children:["$",xe.toFixed(2)]})]}),s.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 text-indigo-300 hover:text-white transition-all text-xs font-black uppercase tracking-widest bg-indigo-500/20 hover:bg-indigo-500/30 px-5 py-2 rounded-2xl border border-indigo-500/30 shadow-xl shadow-indigo-500/10 active:scale-95",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"View Strategy"]}),s.jsxs("div",{className:"text-[13px] text-white/30 italic font-medium tracking-tight border-l border-white/5 pl-4 ml-2",title:D.flavor_text,children:['"',D.flavor_text,'"']})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 bg-gray-950/50 p-1.5 rounded-2xl border border-gray-800 backdrop-blur shadow-inner",children:[s.jsxs("button",{onClick:()=>N(!0),className:"bg-green-600 hover:bg-green-500 text-white font-black py-2.5 px-6 rounded-xl shadow-lg shadow-green-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-xs",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Collection"]}),s.jsx("button",{onClick:()=>x(!0),className:"p-2.5 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shadow-md",title:"Quick Search",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("div",{className:"w-px h-6 bg-gray-800 mx-1"}),s.jsx("button",{onClick:Te,className:"p-2.5 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shadow-md",title:"Export JSON",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),s.jsxs("div",{className:"relative group",children:[s.jsx("button",{className:"p-2.5 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shadow-md",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),s.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-gray-900 rounded-xl shadow-2xl border border-gray-800 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto transition-all z-50 overflow-hidden",children:[s.jsxs("button",{onClick:Ee,className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-800 flex items-center gap-2 transition-colors border-b border-gray-800 text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),V.is_mockup?"Switch to Collection":"Switch to Mockup"]}),s.jsxs("button",{onClick:ke,className:"w-full text-left px-4 py-3 text-sm hover:bg-red-900/30 text-red-400 flex items-center gap-2 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Deck"]})]})]})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:pe.map((ge,fe)=>{const ve=ge.target>0?Math.min(ge.current/ge.target*100,100):0,Me=ge.target>0&&ge.current===ge.target,de=ge.target>0&&ge.current>ge.target;return s.jsxs("div",{className:"bg-gray-950/30 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg group hover:border-indigo-500/30 transition-all hover:bg-gray-950/50",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:ge.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${Me?"text-green-400":de?"text-orange-400":"text-indigo-300"}`,children:[ge.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),ge.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${Me?"bg-green-500":de?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${ve||0}%`}})})]},fe)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsxs("div",{className:"flex-1 min-w-0 bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl border border-white/10 order-2 lg:order-1 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/5 bg-white/5 rounded-t-xl backdrop-blur-sm",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),q>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 px-3 py-1 rounded-full border border-gray-700",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Acquired"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${Q===q?"text-green-400":"text-orange-400"}`,children:[Q,"/",q]}),s.jsx("div",{className:"w-20 h-1.5 bg-gray-700 rounded-full overflow-hidden ml-1",children:s.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${Q/q*100}%`}})})]})]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>ue("grid"),className:`p-1.5 rounded-md transition-all ${O==="grid"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>ue("table"),className:`p-1.5 rounded-md transition-all ${O==="table"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Table View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsxs("div",{className:"p-4 space-y-8 min-h-[500px]",children:[Object.entries(_e).length===0&&s.jsx("div",{className:"text-center py-20 text-gray-500 italic",children:'Use the "Add Cards" button to start building your deck.'}),Object.entries(_e).map(([ge,fe])=>s.jsxs("div",{className:"animate-fade-in text-left",children:[s.jsxs("h4",{className:"text-sm font-bold text-indigo-300 border-b border-white/5 mb-4 pb-2 sticky top-0 bg-gray-950/60 backdrop-blur-md z-10 flex justify-between uppercase tracking-wider pl-1",children:[s.jsx("span",{children:ge}),s.jsx("span",{className:"text-gray-500 text-xs bg-gray-900 px-2 py-0.5 rounded-full border border-gray-700",children:fe.reduce((ve,Me)=>ve+(Me.countInDeck||1),0)})]}),O==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4 px-1",children:fe.map(ve=>s.jsx(vd,{card:ve,availableFoils:F,onRemove:Ie},ve.firestoreId||ve.id))}):s.jsx("div",{className:"space-y-1",children:fe.map((ve,Me)=>s.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm group border border-transparent hover:border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"font-mono text-gray-500 w-6 text-center bg-gray-900 rounded py-0.5 text-xs",children:ve.countInDeck}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`font-medium ${ve.finish==="foil"?"text-yellow-200":"text-gray-200"}`,children:ve.name}),ve.finish!=="foil"&&F.has(ve.name)&&s.jsx("span",{className:"text-yellow-500 text-xs cursor-help",title:"Foil copy available in collection",children:""})]}),ve.finish==="foil"&&s.jsx("span",{className:"text-[10px] bg-yellow-900/40 text-yellow-500 px-1 rounded uppercase tracking-wider border border-yellow-800",children:"Foil"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-gray-400",children:[s.jsx("span",{className:"hidden md:inline-block text-xs text-gray-500",children:ve.data?.type_line||ve.type_line||""}),s.jsx("span",{className:"font-mono w-16 text-right text-xs",children:ve.mana_cost||""}),s.jsxs("span",{className:"font-mono w-16 text-right text-green-400/80 text-xs",children:["$",(parseFloat(ve.prices?.[ve.finish==="foil"?"usd_foil":"usd"])||0).toFixed(2)]}),s.jsx("button",{onClick:()=>Ie(ve.firestoreId||ve.id,ve.name),className:"text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]},ve.id+Me))})]},ge))]})]}),s.jsxs("div",{className:"w-full lg:w-80 space-y-6 shrink-0 order-1 lg:order-2",children:[V.commander&&s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:V.format?.toLowerCase()==="standard"?"Spotlight Card":V.commander_partner?"Partners":"Commander"}),V.commander_partner&&s.jsx("button",{onClick:()=>U(ge=>ge===0?1:0),className:"text-indigo-400 hover:text-indigo-300 text-xs font-bold uppercase tracking-wider transition-colors",children:"Swap View "})]}),s.jsxs("div",{className:"p-4 flex justify-center relative min-h-[350px]",children:[V.commander_partner&&s.jsx("div",{className:`transition-all duration-500 ease-out transform absolute top-4 
                                            ${T===0?"scale-90 opacity-60 translate-x-4 -rotate-3 z-0 blur-[1px] hover:blur-0":"scale-100 opacity-100 z-10 translate-x-0 rotate-0"}
                                            cursor-pointer`,onClick:ge=>xt(ge,V.commander_partner,1),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:Ye(V.commander_partner),className:"w-full max-w-[250px] rounded-lg shadow-2xl skew-y-1",alt:V.commander_partner.name}),(V.commander_partner.card_faces||V.commander_partner.data?.card_faces)&&T===1&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${G?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),s.jsx("div",{className:`transition-all duration-500 ease-out transform relative 
                                        ${V.commander_partner&&T===1?"scale-90 opacity-60 -translate-x-4 rotate-3 z-0 blur-[1px] hover:blur-0 cursor-pointer":"scale-100 opacity-100 z-10"}
                                        `,onClick:ge=>xt(ge,V.commander,0),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:Ye(V.commander),className:"w-full max-w-[250px] rounded-lg shadow-2xl hover:shadow-indigo-500/30 transition-shadow duration-300",alt:V.commander.name}),(V.commander.card_faces||V.commander.data?.card_faces)&&T===0&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${G?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl p-6 border border-white/10 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),g," Tools"]}),s.jsxs("div",{className:"space-y-3 relative z-10",children:[s.jsxs("button",{onClick:()=>{V.format?.toLowerCase()==="standard"?h("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info",0):n(`/decks/${a}/build`)},className:"w-full py-4 bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-300 rounded-xl border border-indigo-500/20 hover:border-indigo-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),g,"'s Deck Builder"]}),s.jsxs("button",{onClick:()=>S(!0),className:"w-full py-4 bg-indigo-900/10 hover:bg-indigo-900/20 text-indigo-400 rounded-xl border border-indigo-500/10 hover:border-indigo-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Full Deck Stats"]})]})]})]})]}),s.jsx(pb,{isOpen:p,onClose:()=>x(!1),onAddCard:Ve}),s.jsx(ak,{isOpen:se.isOpen,onClose:()=>te({...se,isOpen:!1}),onConfirm:se.onConfirm,title:se.title,message:se.message,isDanger:!0,confirmText:"Remove"}),s.jsx(ok,{isOpen:R,onClose:()=>k(!1),deck:V,cards:ie}),s.jsx(yb,{isOpen:b,onClose:()=>N(!1),deck:V,deckCards:ie}),s.jsx(lk,{isOpen:E,onClose:()=>S(!1),cards:ie,deckName:V.name})]})]})};function dk(){const[a,n]=w.useState([]),[i,o]=w.useState(!0),[d,h]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const x=(await Ge.get("/sets")).data||[];n(x),o(!1)}catch(p){console.error("Error fetching sets:",p),h(p),o(!1)}})()},[]),{sets:a,loading:i,error:d}}const uk=()=>{const{sets:a,loading:n,error:i}=dk(),{cards:o}=Yn(),[d,h]=w.useState(""),[g,p]=w.useState(!1),x=us(),b=w.useMemo(()=>{const I=new Map;o&&o.forEach(T=>{if(T.is_wishlist||T.deck_id)return;const U=(T.set||T.set_code)?.toLowerCase(),P=T.name;I.has(U)||I.set(U,new Set),P&&I.get(U).add(P)});const L={};return I.forEach((T,U)=>{L[U]=T.size}),L},[o]),N=w.useMemo(()=>{if(!a)return{};const I={Expansion:[],Core:[],Commander:[],Masters:[],"Draft Innovation":[],Other:[]},L={expansion:"Expansion",core:"Core",commander:"Commander",masters:"Masters",draft_innovation:"Draft Innovation"};return a.forEach(T=>{const U=b[T.code.toLowerCase()]||0,P=U>0;if(!(!d||T.name.toLowerCase().includes(d.toLowerCase())||T.code.toLowerCase().includes(d.toLowerCase()))||!(!g||P))return;const X=L[T.set_type]||"Other";I[X]?I[X].push({...T,ownedCount:U}):I.Other.push({...T,ownedCount:U})}),Object.keys(I).forEach(T=>{I[T].sort((U,P)=>new Date(P.released_at)-new Date(U.released_at))}),I},[a,d,g,b]),j=I=>{x(`/sets/${I}`)};if(n)return s.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(i)return s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-red-500 bg-red-500/10 p-8 rounded-2xl border border-red-500/20 max-w-md",children:[s.jsx("p",{className:"font-bold text-xl mb-2",children:"Error loading sets"}),s.jsx("p",{className:"text-sm opacity-80",children:i.message})]})});const _=["Expansion","Core","Commander","Masters","Draft Innovation","Other"];return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-gray-950/50 backdrop-blur-xl border-b border-white/5 sticky top-0 z-30 py-6",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:["Set ",s.jsx("span",{className:"text-indigo-500",children:"Library"})]}),s.jsx("p",{className:"text-gray-500 text-xs font-medium uppercase tracking-[0.2em] mt-1",children:"Browse and track your collections"})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4 w-full md:w-auto",children:[s.jsxs("div",{className:"relative flex-grow md:w-80",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-4 py-2 bg-gray-900/50 border border-white/5 rounded-xl text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none",placeholder:"Search expansions...",value:d,onChange:I=>h(I.target.value)})]}),s.jsx("button",{onClick:()=>p(!g),className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${g?"bg-indigo-600 text-white shadow-[0_0_15px_rgba(79,70,229,0.3)]":"bg-gray-800 text-gray-400 border border-white/5 hover:bg-gray-700"}`,children:g?"Owned Only":"Show All"})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:_.map(I=>N[I]&&N[I].length>0&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-3",children:[I,s.jsx("div",{className:"h-[2px] w-12 bg-indigo-500/50"})]}),s.jsxs("span",{className:"text-[10px] font-black text-gray-500 bg-gray-800/50 border border-white/5 px-3 py-1 rounded-full uppercase tracking-widest",children:[N[I].length," Sets"]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:N[I].map(L=>{const T=Math.min(100,Math.round(L.ownedCount/L.card_count*100)),U=T>=100;return s.jsxs("div",{onClick:()=>j(L.code),className:"relative bg-gray-800/40 backdrop-blur-md rounded-2xl border border-white/5 p-5 group cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:border-indigo-500/30 overflow-hidden min-h-[160px] flex flex-col justify-between",children:[s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-1000 ease-out z-0",style:{height:`${T}%`,background:U?"linear-gradient(to top, rgba(34, 197, 94, 0.15) 0%, transparent 100%)":"linear-gradient(to top, rgba(79, 70, 229, 0.15) 0%, transparent 100%)"}}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-900/80 rounded-xl flex items-center justify-center border border-white/5 shadow-inner",children:L.icon_svg_uri?s.jsx("img",{src:L.icon_svg_uri,alt:L.name,className:"w-6 h-6 filter invert opacity-60 group-hover:opacity-100 transition-opacity"}):s.jsx("span",{className:"text-xs font-black text-gray-500",children:L.code.toUpperCase()})}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Release"}),s.jsx("span",{className:"text-xs font-bold text-gray-400",children:L.released_at?.split("-")[0]})]})]}),s.jsx("h3",{className:"text-sm font-black text-white leading-snug group-hover:text-indigo-400 transition-colors",children:L.name})]}),s.jsxs("div",{className:"relative z-10 pt-4 mt-4 border-t border-white/5 flex items-end justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:`text-lg font-black tabular-nums ${U?"text-green-400":"text-indigo-400"}`,children:L.ownedCount}),s.jsxs("span",{className:"text-gray-600 text-[10px] font-bold",children:["/ ",L.card_count]})]})]}),s.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-[10px] font-black ${U?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-gray-950/80 text-gray-400 border border-white/5"}`,children:[T,"%"]})]})]},L.id)})})]},I))})]})},hk=()=>{const{setCode:a}=cf(),[n,i]=w.useState([]),[o,d]=w.useState(!0),[h,g]=w.useState(null),[p,x]=w.useState("all"),{currentUser:b}=vt(),{addToast:N}=Rn(),{cards:j,refresh:_}=Yn(),I=w.useMemo(()=>{const z=new Map;return j&&j.forEach(G=>{const X=G.scryfall_id||G.data&&(G.data.scryfall_id||G.data.id)||G.id;z.has(X)||z.set(X,[]),z.get(X).push(G)}),z},[j]),L=w.useMemo(()=>{const z=new Set(n.map(se=>se.name)),G=new Set;let X=0;return n.forEach(se=>{const te=I.get(se.id)||[],R=te.filter(E=>E.finish==="nonfoil"&&!E.deck_id&&!E.is_wishlist).reduce((E,S)=>E+(S.count||1),0),k=te.filter(E=>E.finish==="foil"&&!E.deck_id&&!E.is_wishlist).reduce((E,S)=>E+(S.count||1),0);if(R>0||k>0){G.add(se.name);const E=parseFloat(se.prices?.usd||0)*R,S=parseFloat(se.prices?.usd_foil||0)*k;X+=E+S}}),{collected:G.size,total:z.size,value:X.toFixed(2)}},[n,I]),T=w.useMemo(()=>p==="all"?n:n.filter(z=>{const X=(I.get(z.id)||[]).some(se=>!se.is_wishlist&&(se.count||0)>0);return p==="owned"?X:!X}),[n,I,p]);w.useEffect(()=>{(async()=>{if(a){d(!0);try{const G=await Ge.get(`/sets/${a}/cards`);i(G.data||[]),g(null)}catch(G){console.error("Failed to load set cards",G),g(G.message)}finally{d(!1)}}})()},[a]);const U=async(z,G,X)=>{if(!b)return N("Please log in","error");try{const se=z.id,te=I.get(se)||[],R=G==="foil"?"foil":"nonfoil",k=te.find(E=>E.finish===R&&!E.deck_id&&!E.is_wishlist);X>0?k?(await en.updateCard(k.id,{count:(k.count||1)+1}),N(`Added ${R} ${z.name}`,"success")):(await en.addCardToCollection(b.uid,z,1,R),N(`Added new ${R} ${z.name}`,"success")):k&&((k.count||1)>1?(await en.updateCard(k.id,{count:k.count-1}),N(`Removed ${R} ${z.name}`,"info")):(await en.removeCard(k.id),N(`Removed last ${R} ${z.name}`,"info"))),await _()}catch(se){console.error("Update failed",se),N("Failed to update collection","error")}},P=async(z,G)=>{if(!b)return N("Please log in","error");try{const X=z.id,te=(I.get(X)||[]).find(R=>R.is_wishlist&&!R.deck_id);G>0?te?(await en.updateCard(te.id,{count:(te.count||1)+1}),N(`Increased wishlist for ${z.name}`,"success")):(await en.addCardToCollection(b.uid,z,1,"nonfoil",!0),N(`Added ${z.name} to wishlist`,"success")):te&&((te.count||1)>1?(await en.updateCard(te.id,{count:te.count-1}),N(`Decreased wishlist for ${z.name}`,"info")):(await en.removeCard(te.id),N(`Removed ${z.name} from wishlist`,"info"))),await _()}catch(X){console.error("Wishlist update failed",X),N("Failed to update wishlist","error")}};return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-950/50 pt-16 pb-8 border-b border-white/5",children:[s.jsx("div",{className:"absolute inset-0 z-0",children:s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-indigo-500/5 via-transparent to-transparent"})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[s.jsxs(yt,{to:"/sets",className:"inline-flex items-center text-gray-400 hover:text-white transition-colors mb-6 group",children:[s.jsx("svg",{className:"w-5 h-5 mr-1 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sets"]}),s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-8",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl md:text-5xl font-black text-white uppercase tracking-tighter mb-2",children:[a," ",s.jsx("span",{className:"text-gray-500",children:"Details"})]}),s.jsx("p",{className:"text-gray-400 font-medium",children:"Manage and track your collection for this expansion"})]}),s.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-xl rounded-2xl border border-white/5 p-4 md:p-6 flex items-center gap-8 shadow-xl",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-gray-500 tracking-[0.2em] mb-1",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-3xl font-black text-indigo-400",children:L.collected}),s.jsxs("span",{className:"text-gray-600 font-bold text-sm",children:["/ ",L.total]})]})]}),s.jsx("div",{className:"w-[1px] h-12 bg-white/5"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-gray-500 tracking-[0.2em] mb-1",children:"Value"}),s.jsxs("span",{className:"text-3xl font-black text-emerald-400 tabular-nums",children:["$",L.value]})]})]})]})]})]}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-4",children:s.jsx("div",{className:"flex bg-gray-950/50 backdrop-blur-md rounded-xl p-1 border border-white/5 self-start",children:["all","owned","missing"].map(z=>s.jsx("button",{onClick:()=>x(z),className:`px-6 py-2 rounded-lg text-xs font-black uppercase tracking-widest transition-all duration-300 ${p===z?"bg-indigo-600 text-white shadow-[0_0_15px_rgba(79,70,229,0.4)]":"text-gray-500 hover:text-white hover:bg-white/5"}`,children:z},z))})}),o?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6",children:Array.from({length:12}).map((z,G)=>s.jsx(Vf,{},G))}):h?s.jsxs("div",{className:"text-center text-red-500 py-12 bg-red-500/10 rounded-2xl border border-red-500/20",children:["Error loading set: ",h]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:T.map((z,G)=>{const X=I.get(z.id)||[],se=X.filter(k=>k.finish==="nonfoil"&&!k.deck_id&&!k.is_wishlist).reduce((k,E)=>k+(E.count||1),0),te=X.filter(k=>k.finish==="foil"&&!k.deck_id&&!k.is_wishlist).reduce((k,E)=>k+(E.count||1),0),R=X.filter(k=>k.is_wishlist&&!k.deck_id).reduce((k,E)=>k+(E.count||1),0);return s.jsx(gb,{card:z,normalCount:se,foilCount:te,wishlistCount:R,onUpdateCount:U,onUpdateWishlistCount:P},z.id||G)})})]})]})},fk=({isOpen:a,onClose:n,mode:i="global"})=>{const{currentUser:o}=vt(),{addToast:d}=Rn(),h=w.useRef(null),[g,p]=w.useState(null),[x,b]=w.useState(!1),[N,j]=w.useState("cards"),[_,I]=w.useState("merge"),[L,T]=w.useState({checkCollection:!0,addToCollection:!0}),U=z=>{const G=z.target.files[0];if(!G)return;const X=new FileReader;X.onload=se=>{try{const te=JSON.parse(se.target.result);if(te.deck&&te.cards)j("deck"),p(te);else if(te.collection&&typeof te.collection=="object"&&!Array.isArray(te.collection)){const R=Object.values(te.collection);j("cards"),p({cards:R})}else if(Array.isArray(te))j("cards"),p({cards:te});else if(te.cards&&Array.isArray(te.cards))j("cards"),p(te);else if(typeof te=="object"){const R=Object.values(te).find(k=>Array.isArray(k)&&k.length>0&&(k[0].name||k[0].id));R?(j("cards"),p({cards:R})):(console.error("Invalid JSON structure",te),d("Invalid JSON: Could not find card data","error"))}else d("Invalid JSON format","error")}catch(te){console.error(te),d("Failed to parse JSON","error")}},X.readAsText(G)},P=async()=>{if(g){b(!0);try{if(N==="cards")await en.importBatch(o.uid,g.cards,_),d(`Successfully imported ${g.cards.length} cards`,"success"),n();else if(N==="deck"){const z=await lr.importDeck(o.uid,g.deck,g.cards,L);z.missingCards?.length>0?d(`Imported deck with ${z.missingCards.length} missing cards`,"warning"):d("Deck imported successfully","success"),n()}}catch(z){console.error(z),d("Import failed","error")}finally{b(!1)}}};return a?aa.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import Data"]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 space-y-6",children:g?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg border border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detected Content"}),s.jsx("p",{className:"text-white font-bold text-lg",children:N==="cards"?`Collection (${g.cards?.length||0} cards)`:`Deck: ${g.deck?.name} (${g.cards?.length||0} cards)`})]}),s.jsx("button",{onClick:()=>p(null),className:"text-sm text-red-400 hover:text-red-300 underline",children:"Change File"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-700 pb-2",children:"Import Options"}),N==="cards"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-700 hover:bg-gray-700/50 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:_==="merge",onChange:()=>I("merge"),className:"mt-1 bg-gray-900 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Merge (Recommended)"}),s.jsx("span",{className:"block text-gray-400 text-sm",children:"Add records to your existing collection. Updates if exists."})]})]}),s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-red-900/30 hover:bg-red-900/10 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:_==="replace",onChange:()=>I("replace"),className:"mt-1 bg-gray-900 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Replace (Use with Caution)"}),s.jsx("span",{className:"block text-red-300 text-sm",children:"Delete your ENTIRE current collection and replace it with this file."})]})]})]}),N==="deck"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:L.checkCollection,onChange:z=>T(G=>({...G,checkCollection:z.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Use existing unassigned copies from collection"})]}),s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:L.addToCollection,onChange:z=>T(G=>({...G,addToCollection:z.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Add missing cards to collection automatically"})]})]})]})]}):s.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500 hover:bg-gray-700/30 transition-all group",onClick:()=>h.current?.click(),children:[s.jsx("svg",{className:"w-12 h-12 text-gray-500 group-hover:text-indigo-400 mb-4 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s.jsx("p",{className:"text-gray-300 font-medium",children:"Click to select backup JSON"}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Supports Collection exports and Deck exports"}),s.jsx("input",{type:"file",ref:h,onChange:U,accept:".json",className:"hidden"})]})}),s.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-900/50 flex justify-end gap-3",children:[s.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800 transition-colors",disabled:x,children:"Cancel"}),s.jsx("button",{onClick:P,disabled:!g||x,className:`px-6 py-2 rounded-lg font-bold text-white transition-all shadow-lg ${x?"bg-indigo-800 cursor-wait":_==="replace"&&N==="cards"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:x?"Importing...":"Start Import"})]})]})}),document.body):null},gk=({isOpen:a,onClose:n})=>{const{userProfile:i,refreshUserProfile:o}=vt(),[d,h]=w.useState(!1),[g,p]=w.useState(i?.settings?.helper?.name||""),[x,b]=w.useState(i?.settings?.helper?.type||""),[N,j]=w.useState(i?.settings?.helper?.personality||""),[_,I]=w.useState(!1),[L,T]=w.useState([]),[U,P]=w.useState(""),[z,G]=w.useState(!1),[X,se]=w.useState({});Tn.useEffect(()=>{if(a){const S=i?.settings?.helper||{};p(S.name||""),b(S.type||""),j(S.personality||""),h(!1),T([]),se({})}},[a,i]);const te=async()=>{I(!0);try{const A={...i?.settings||{},helper:{name:g,type:x,personality:N}};await Ge.updateUser(i.id,{settings:A}),await o(),n()}catch(S){console.error(S),alert("Failed to save helper.")}finally{I(!1)}},R=async()=>{h(!0),G(!0),se({}),T([]);try{const S=i?.settings?.geminiApiKey;if(!S)throw new Error("API Key missing");const A=await Fn.forgeHelperChat(S,[],{});T([{role:"model",content:A.aiResponse}])}catch(S){console.error(S),T([{role:"model",content:"Error connecting to the Forge. Please try again."}])}finally{G(!1)}},k=async()=>{if(!U.trim())return;const S=U;P(""),T(A=>[...A,{role:"user",content:S}]),G(!0);try{const A=i?.settings?.geminiApiKey,B=L.map(ye=>({role:ye.role,content:ye.content}));B.push({role:"user",content:S});const O=await Fn.forgeHelperChat(A,B,X);se(O.updatedDraft||{}),T(ye=>[...ye,{role:"model",content:O.aiResponse}])}catch(A){console.error(A),T(B=>[...B,{role:"model",content:"Reviewing the blueprints... (Error, try again)"}])}finally{G(!1)}},E=()=>{X.name&&p(X.name),X.type&&b(X.type),X.personality&&j(X.personality),h(!1)};return a?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-500",children:"Helper Settings"}),s.jsx("span",{className:"text-xs bg-gray-800 text-gray-500 px-2 py-1 rounded border border-gray-700",children:"Beta"})]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:d?s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-lg mb-4 text-sm text-gray-400 flex justify-between items-center",children:[s.jsx("span",{children:"Forging new identity..."}),s.jsx("button",{onClick:()=>h(!1),className:"text-white hover:underline",children:"Cancel"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 p-2 bg-gray-950/30 rounded-lg border border-gray-800",children:[L.map((S,A)=>s.jsx("div",{className:`flex ${S.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-xl text-sm ${S.role==="user"?"bg-emerald-600 text-white":"bg-gray-800 text-gray-200"}`,children:S.content})},A)),z&&s.jsx("div",{className:"flex justify-start",children:s.jsx("span",{className:"animate-pulse text-emerald-500",children:"..."})})]}),(X.name||X.type)&&s.jsxs("div",{className:"bg-black/40 p-3 rounded border border-emerald-500/30 mb-4 flex gap-4 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"})," ",s.jsx("span",{className:"text-white",children:X.name||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Type:"})," ",s.jsx("span",{className:"text-white",children:X.type||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Personality:"})," ",s.jsx("span",{className:"text-white",children:X.personality||"-"})]}),s.jsx("button",{onClick:E,className:"ml-auto bg-emerald-600 text-white px-3 py-1 rounded hover:bg-emerald-500",children:"Apply This"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:U,onChange:S=>P(S.target.value),onKeyDown:S=>S.key==="Enter"&&k(),placeholder:"Describe your helper...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-emerald-500 outline-none"}),s.jsx("button",{onClick:k,disabled:z,className:"bg-emerald-600 p-2 rounded-lg text-white",children:""})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 flex gap-4 items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-teal-500 to-emerald-700 rounded-full flex items-center justify-center text-2xl shadow-lg",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:g||"Unknown Helper"}),s.jsx("p",{className:"text-emerald-400 text-sm font-medium",children:x||"Generic Construct"}),s.jsxs("p",{className:"text-gray-400 text-sm italic mt-1",children:['"',N||"Standard protocol.",'"']})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Name"}),s.jsx("input",{type:"text",value:g,onChange:S=>p(S.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Type"}),s.jsx("input",{type:"text",value:x,onChange:S=>b(S.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Personality"}),s.jsx("input",{type:"text",value:N,onChange:S=>j(S.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-800",children:[s.jsxs("button",{onClick:R,className:"text-emerald-400 hover:text-emerald-300 font-bold flex items-center gap-2 px-4 py-2 hover:bg-emerald-900/20 rounded-lg transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Re-Forge Persona"]}),s.jsx("button",{onClick:te,disabled:_,className:"bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-6 rounded-lg transition-all shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:_?"Saving...":"Save Changes"})]})]})})]})}):null},mk=()=>{const{user:a,userProfile:n,refreshUserProfile:i}=vt(),o=us(),[d,h]=w.useState("general"),[g,p]=w.useState(!1),[x,b]=w.useState(!1),[N,j]=w.useState(!1),[_,I]=w.useState(!1),[L,T]=w.useState(""),[U,P]=w.useState("grid"),[z,G]=w.useState("md");w.useEffect(()=>{n?.settings&&(n.settings.geminiApiKey&&T(n.settings.geminiApiKey),n.settings.viewMode&&P(n.settings.viewMode),n.settings.gridSize&&G(n.settings.gridSize))},[n]);const X=async()=>{if(!n?.id){alert("User profile not ready. Please try again.");return}b(!0);try{const R={...n?.settings||{},geminiApiKey:L,viewMode:U,gridSize:z};await Ge.updateUser(n.id,{settings:R}),await i(),alert("Settings saved!")}catch(te){console.error("Failed to save settings:",te),alert("Error saving settings: "+(te.message||"Unknown error"))}finally{b(!1)}},se=async()=>{try{const te=await Ge.get("/collection/export");if(!te||te.length===0){alert("No cards to export.");return}const R=JSON.stringify({cards:te,exported_at:new Date},null,2),k=new Blob([R],{type:"application/json"}),E=URL.createObjectURL(k),S=document.createElement("a");S.href=E,S.download=`mtg_collection_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S)}catch(te){console.error("Export failed:",te),alert("Failed to export collection.")}};return a?s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Settings"}),s.jsx("div",{className:"flex border-b border-gray-700",children:["general","ai","display","data",...a?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"?["admin"]:[]].map(te=>s.jsx("button",{onClick:()=>h(te),className:`px-6 py-3 font-medium transition-colors border-b-2 ${d===te?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:te.charAt(0).toUpperCase()+te.slice(1)},te))}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg min-h-[400px]",children:[d==="general"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Account Information"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Email"}),s.jsx("div",{className:"bg-gray-900 p-3 rounded-lg text-gray-200",children:a.email})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"User ID"}),s.jsx("div",{className:"bg-gray-900 p-3 rounded-lg text-gray-200 font-mono text-xs",children:a.uid})]}),s.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Account Actions"}),s.jsx("button",{onClick:async()=>{window.confirm("This will restart the welcome tour. Continue?")&&(await Ge.updateUser(n.id,{settings:{...n.settings,onboarding_complete:!1,onboarding_step:0}}),await i(),o("/onboarding"))},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg border border-gray-600 transition-colors text-sm font-medium",children:"Reset Onboarding Tour"})]})]}),d==="ai"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Integrations"}),s.jsx("span",{className:"bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded border border-indigo-700/50",children:"Gemini"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"To enable the AI Assistant and Deck Suggestions, you need a Google Gemini API Key. Keys are stored securely in your user profile."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Gemini API Key"}),s.jsx("input",{type:"password",value:L,onChange:te=>T(te.target.value),placeholder:"Enter AI Key...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"}),s.jsxs("div",{className:"text-xs text-gray-500 flex justify-between",children:[s.jsx("span",{children:"Never share your API key."}),s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 hover:underline",children:"Get a key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Personalization"}),s.jsx("div",{className:"flex flex-wrap gap-4",children:s.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-3 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-5 py-3 rounded-xl transition-all hover:shadow-lg hover:border-emerald-500 group",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center text-xl group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold text-sm",children:"Helper Settings"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Customize your AI companion"})]})]})})]})]}),d==="display"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Display Preferences"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Default View "}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${U==="grid"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"grid",checked:U==="grid",onChange:()=>P("grid"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Grid View"})]}),s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${U==="table"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"table",checked:U==="table",onChange:()=>P("table"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Table View"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Grid Size"}),s.jsxs("select",{value:z,onChange:te=>G(te.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 w-full sm:w-48",children:[s.jsx("option",{value:"sm",children:"Small"}),s.jsx("option",{value:"md",children:"Medium"}),s.jsx("option",{value:"lg",children:"Large"})]})]})]})]}),d==="data"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Data Management"}),s.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/50 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"text-yellow-500 font-bold mb-1 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Important Note"]}),s.jsx("p",{className:"text-yellow-200/80 text-sm",children:"Backups include your collection data. Deck exports can be done from individual deck pages."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Export Collection"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Download a JSON backup of your entire card collection."})]}),s.jsx("button",{onClick:se,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Export JSON"})]}),s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Import Data"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Restore from a backup or import cards. Supports Merge and Replace."})]}),s.jsx("button",{onClick:()=>j(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors border border-gray-600",children:"Import..."})]})]})]}),d==="admin"&&a?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"&&s.jsx(pk,{})]}),s.jsx(fk,{isOpen:N,onClose:()=>j(!1),mode:"global"}),s.jsx(gk,{isOpen:_,onClose:()=>I(!1)}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:X,disabled:x,className:`bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-lg shadow-lg shadow-indigo-500/20 transition-all transform hover:-translate-y-0.5 ${x?"opacity-50 cursor-not-allowed":""}`,children:x?"Saving...":"Save Settings"})})]}):s.jsx("div",{className:"p-8 text-center text-gray-500",children:"Please log in to view settings."})},pk=()=>{const[a,n]=w.useState([]),[i,o]=w.useState(""),[d,h]=w.useState([]),[g,p]=w.useState(!1),x=Tn.useRef(!1),[b,N]=w.useState({current:0,total:0}),[j,_]=w.useState({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),[I,L]=w.useState({updatePrices:!0,updateInfo:!0}),[T,U]=w.useState(null);w.useEffect(()=>{P();const E=localStorage.getItem("admin_last_sync");if(E)try{U(JSON.parse(E))}catch(S){console.error("Failed to parse last sync",S)}},[]);const P=async()=>{try{const E=await Ge.get("/admin/sets");n(E.data||[])}catch(E){console.error("Failed to fetch sets",E)}},z=E=>h(S=>[...S,`${new Date().toLocaleTimeString()} - ${E}`]),G=(E,S)=>{_(A=>{const B={...A};return B.totalCards+=E,S&&Object.keys(S).forEach(O=>{B.types[O]=(B.types[O]||0)+(S[O]||0)}),B})},X=E=>{const S={date:new Date().toISOString(),stats:E};U(S),localStorage.setItem("admin_last_sync",JSON.stringify(S))},se=async(E,S=!1)=>{if(E)try{z(`Starting sync for ${E}...`);const B=await(await fetch("http://localhost:3000/admin/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({setCode:E,...I})})).json();B.success?(z(`Success: ${E}. Processed ${B.count} cards.`),G(B.count,B.typeStats),S&&N(O=>({...O,current:O.current+1}))):z(`Error: ${B.error}`)}catch(A){z(`Request Failed: ${A.message}`)}},te=()=>{window.confirm("Are you sure you want to cancel the sync?")&&(x.current=!0,z("Cancelling operation..."))},R=async()=>{if(!window.confirm("This will sync ALL sets. It may take a long time. Continue?"))return;p(!0),x.current=!1,z("Starting Mass Sync..."),_({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),N({current:0,total:a.length});for(const S of a){if(x.current){z("Mass Sync Cancelled by User.");break}await se(S.code,!0)}x.current||z("Mass Sync Complete!")};w.useEffect(()=>{!g&&j.totalCards>0&&X(j)},[g]);const k=async()=>{i&&(p(!0),_({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),await se(i),p(!1))};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Admin Scryfall Sync"}),T&&s.jsxs("div",{className:"text-right text-xs text-gray-400",children:[s.jsxs("p",{children:["Last Sync: ",new Date(T.date).toLocaleString()]}),s.jsxs("p",{children:[T.stats.totalCards," cards processed"]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-indigo-900/40 p-4 rounded-lg border border-indigo-700/50",children:[s.jsx("p",{className:"text-xs text-indigo-300 uppercase font-bold",children:"Total Cards"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:j.totalCards})]}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg border border-gray-700",children:[s.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Progress"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:b.total>0?`${b.current} / ${b.total}`:"-"}),b.total>0&&s.jsx("div",{className:"w-full bg-gray-700 h-1.5 mt-2 rounded-full overflow-hidden",children:s.jsx("div",{className:"bg-green-500 h-full transition-all duration-300",style:{width:`${b.current/b.total*100}%`}})})]})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.entries(j.types).map(([E,S])=>s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded border border-gray-700/50 flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-400 capitalize",children:E}),s.jsx("span",{className:"text-sm font-bold text-gray-200",children:S})]},E))}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-lg border border-gray-700/50 flex flex-wrap gap-6 items-center",children:[s.jsx("span",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest",children:"Configuration"}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-900 px-3 py-1.5 rounded-lg border border-gray-700 hover:border-indigo-500 transition-colors",children:[s.jsx("input",{type:"checkbox",checked:I.updatePrices,onChange:E=>L(S=>({...S,updatePrices:E.target.checked})),className:"form-checkbox text-indigo-500 rounded bg-gray-800 border-gray-600 focus:ring-0 focus:ring-offset-0"}),s.jsx("span",{className:"text-gray-200 text-sm font-medium",children:"Update Prices"})]}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-900 px-3 py-1.5 rounded-lg border border-gray-700 hover:border-indigo-500 transition-colors",children:[s.jsx("input",{type:"checkbox",checked:I.updateInfo,onChange:E=>L(S=>({...S,updateInfo:E.target.checked})),className:"form-checkbox text-indigo-500 rounded bg-gray-800 border-gray-600 focus:ring-0 focus:ring-offset-0"}),s.jsx("span",{className:"text-gray-200 text-sm font-medium",children:"Update Card Info"})]}),s.jsx("span",{className:"text-xs text-gray-500 italic ml-auto hidden sm:block",children:"Propagates price updates to all user collections."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Single Set Sync"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white flex-1 min-w-0",value:i,onChange:E=>o(E.target.value),children:[s.jsx("option",{value:"",children:"Select a Set..."}),a.map(E=>s.jsxs("option",{value:E.code,children:[E.name," (",E.code.toUpperCase(),")"]},E.code))]}),s.jsx("button",{onClick:k,disabled:g||!i,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg whitespace-nowrap",children:g?"Syncing...":"Sync Set"})]})]}),s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600 flex flex-col justify-between",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Mass Operations"}),g?s.jsx("button",{onClick:te,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg w-full font-bold animate-pulse",children:"CANCEL OPERATION"}):s.jsx("button",{onClick:R,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg w-full font-bold",children:"SYNC ALL SETS"}),s.jsxs("p",{className:"text-gray-400 text-xs mt-2 text-center",children:["Iterates ",a.length," sets."]})]})]}),s.jsx("div",{className:"bg-black/50 p-4 rounded-lg font-mono text-xs text-green-400 h-64 overflow-y-auto border border-white/10",children:d.length===0?s.jsx("span",{className:"text-gray-600",children:"Ready to sync..."}):d.map((E,S)=>s.jsx("div",{children:E},S))})]})]})},xk=()=>{const{cards:a,loading:n,error:i}=Yn({wishlist:!0}),[o,d]=w.useState(""),[h,g]=w.useState(!1),[p,x]=w.useState({colors:[],rarity:[],types:[],sets:[]}),b=w.useMemo(()=>{const _=new Set;return a.forEach(I=>{I.set&&I.set_name&&_.add(JSON.stringify({value:I.set,label:I.set_name}))}),Array.from(_).map(I=>JSON.parse(I)).sort((I,L)=>I.label.localeCompare(L.label))},[a]),N=w.useMemo(()=>a.filter(_=>{const I=_.name||"";if(o&&!I.toLowerCase().includes(o.toLowerCase()))return!1;if(p.colors.length>0){const L=_.color_identity||[],T=L.length>1,U=L.length===0;if(!p.colors.some(z=>z==="C"?U:z==="M"?T:L.includes(z)))return!1}if(p.rarity.length>0&&!p.rarity.includes(_.rarity))return!1;if(p.types.length>0){const L=(_.type_line||"").toLowerCase();if(!p.types.some(U=>L.includes(U.toLowerCase())))return!1}return!(p.sets.length>0&&!p.sets.includes(_.set))}),[a,o,p]),j=(_,I)=>{x(L=>{const T=L[_],U=T.includes(I)?T.filter(P=>P!==I):[...T,I];return{...L,[_]:U}})};return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-orange-500/10 rounded-xl",children:s.jsx("svg",{className:"w-8 h-8 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),"Wishlist"]}),s.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Manage cards you want to acquire"})]}),s.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"relative w-full md:w-80",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-700 rounded-md leading-5 bg-gray-800 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-700 focus:border-orange-500 transition duration-150 ease-in-out sm:text-sm",placeholder:"Search wishlist...",value:o,onChange:_=>d(_.target.value)})]}),s.jsxs("button",{onClick:()=>g(!h),className:`px-3 py-2 rounded-md border transition-colors flex items-center gap-2 ${h?"bg-orange-600 border-orange-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:text-white"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]})]}),h&&s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-8 border border-gray-700 gap-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 animate-fade-in-down",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(_=>s.jsx("button",{onClick:()=>j("colors",_),className:`
                                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border shadow-sm transition-transform hover:scale-105
                                        ${p.colors.includes(_)?"ring-2 ring-orange-500 ring-offset-2 ring-offset-gray-800":"opacity-70 hover:opacity-100"}
                                        ${_==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                        ${_==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                        ${_==="B"?"bg-[#1F2937] text-white border-gray-900":""}
                                        ${_==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                        ${_==="G"?"bg-[#10B981] text-white border-green-600":""}
                                        ${_==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                        ${_==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
                                    `,children:_},_))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(_=>s.jsx("button",{onClick:()=>j("rarity",_),className:`
                                        px-3 py-1 rounded text-xs font-bold uppercase border transition-colors
                                        ${p.rarity.includes(_)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                    `,children:_},_))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(_=>s.jsx("button",{onClick:()=>j("types",_),className:`
                                         px-2 py-1 rounded text-xs border transition-colors
                                         ${p.types.includes(_)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                     `,children:_},_))})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(rf,{label:"Filter by Set",options:b,selected:p.sets,onChange:_=>x(I=>({...I,sets:_})),placeholder:"All Sets"})})]}),n?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:Array.from({length:12}).map((_,I)=>s.jsx(Vf,{},I))}):i?s.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-4 rounded-lg",children:["Error loading wishlist: ",i.message]}):s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:[N.map(_=>s.jsx("div",{className:"h-full",children:s.jsx(vd,{card:_})},_.id)),N.length===0&&s.jsxs("div",{className:"col-span-full text-center text-gray-500 py-12 flex flex-col items-center",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("p",{className:"text-xl",children:"Your wishlist is empty"}),s.jsx("p",{className:"text-sm mt-2 font-medium",children:"Add cards to your wishlist from the search modal!"})]})]})]})},ir={ANALYSIS:1,ARCHITECT:2,DEPLOY:3},yk=()=>{const{deckId:a}=cf(),n=us(),{userProfile:i,currentUser:o}=vt(),{addToast:d}=Rn(),{deck:h,cards:g,loading:p}=bb(a),{cards:x}=Yn(),[b,N]=w.useState(ir.ANALYSIS),[j,_]=w.useState(`Initializing ${i?.settings?.helper?.name||"Oracle"}...`),[I,L]=w.useState([]),[T,U]=w.useState(!1),[P,z]=w.useState({}),[G,X]=w.useState(new Set),[se,te]=w.useState("All"),[R,k]=w.useState("grid"),E=w.useRef(null);w.useEffect(()=>{E.current?.scrollIntoView({behavior:"smooth"})},[I]);const S=W=>{L(q=>[...q,`[${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}] ${W}`])},A=i?.settings?.helper?.name||"The Oracle",B=W=>{if(!W)return null;const q=W.data||W;return q.image_uris?.art_crop?q.image_uris.art_crop:q.card_faces?.[0]?.image_uris?.art_crop?q.card_faces[0].image_uris.art_crop:q.image_uris?.normal?q.image_uris.normal:null},O=(W,q)=>{const Q={W:0,U:0,B:0,R:0,G:0,total:0},xe=pe=>{pe&&(Q.W+=(pe.match(/\{W\}/g)||[]).length,Q.U+=(pe.match(/\{U\}/g)||[]).length,Q.B+=(pe.match(/\{B\}/g)||[]).length,Q.R+=(pe.match(/\{R\}/g)||[]).length,Q.G+=(pe.match(/\{G\}/g)||[]).length)};return W.forEach(pe=>xe(pe.mana_cost||pe.data?.mana_cost)),Object.values(q).forEach(pe=>xe(pe.data?.mana_cost||pe.type_line)),Q.total=Q.W+Q.U+Q.B+Q.R+Q.G,Q},ye=(W,q,Q)=>{if(W<=0)return{};if(q.total===0)return{};const xe={W:{name:"Plains",type:"Basic Land  Plains"},U:{name:"Island",type:"Basic Land  Island"},B:{name:"Swamp",type:"Basic Land  Swamp"},R:{name:"Mountain",type:"Basic Land  Mountain"},G:{name:"Forest",type:"Basic Land  Forest"}},pe={};let _e=0;const Te={};if(["W","U","B","R","G"].forEach(Ve=>{if(q[Ve]>0){const Ie=q[Ve]/q.total,Ye=Math.round(W*Ie);Te[Ve]=Ye,_e+=Ye}}),_e>0){const Ve=Object.keys(Te).filter(Ie=>Te[Ie]>0);Ve.sort((Ie,Ye)=>Te[Ye]-Te[Ie]),_e<W?Te[Ve[0]]+=W-_e:_e>W&&(Te[Ve[0]]-=_e-W)}return Object.entries(Te).forEach(([Ve,Ie])=>{if(Ie>0){const Ye=xe[Ve],xt=Q.find(we=>we.name===Ye.name)||{name:Ye.name,type_line:Ye.type,image_uris:{normal:`https://api.scryfall.com/cards/named?exact=${Ye.name}&format=image`}};for(let we=0;we<Ie;we++){const je=`basic-${Ve}-${we}-${Date.now()}`;pe[je]={firestoreId:je,name:Ye.name,type_line:Ye.type,rating:10,reason:`Auto-filled to match ${Math.round(q[Ve]/q.total*100)}% ${Ve} pip density.`,suggestedType:"Land",data:xt.data||xt,isVirtual:!0}}}}),pe},ue=(W,q)=>{if(!W||W.length===0)return!0;if(!q||q.length===0)return W.length===0;const Q=new Set(q);return W.every(xe=>Q.has(xe))},V=async()=>{if(!i?.settings?.geminiApiKey){d("Gemini API Key missing in settings.","error"),n("/settings");return}U(!0),_("Scanning Collection..."),S("Starting deck architecture analysis...");try{const W=[...new Set([...h.commander?.color_identity||[],...h.commander_partner?.color_identity||[]])],q=h.aiBlueprint||{},Q=["Synergy / Strategy","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Land"],xe=new Set(g.map(je=>je.name));h.commander?.name&&xe.add(h.commander.name),h.commander_partner?.name&&xe.add(h.commander_partner.name);const pe={Land:36,"Mana Ramp":10,"Card Draw":10,"Targeted Removal":10,"Board Wipes":3,"Synergy / Strategy":30,...q.suggestedCounts||{}},_e={},Te=new Set;for(const je of Q){const Ee=g.filter(fe=>(fe.data?.type_line||fe.type_line||"").includes(je)).reduce((fe,ve)=>fe+(ve.countInDeck||1),0),ke=pe[je]||0;let Ae=Math.max(0,ke-Ee);if(Ae<=0){S(`${je}: Current count (${Ee}) meets target (${ke}). Skipping.`);continue}S(`Identifying potential ${je} candidates...`);const Ce=[],Be=new Set;for(const fe of x){if(Be.has(fe.name))continue;const ve=fe.data?.color_identity||fe.data?.colors||[];ue(ve,W)&&(xe.has(fe.name)||(Ce.push({firestoreId:fe.id,name:fe.name,type_line:fe.data?.type_line||fe.type_line}),Be.add(fe.name)))}if(Ce.length===0)continue;const Vt={blueprint:q,instructions:`Select EXACTLY ${Ae} best "${je}" cards for a ${h.format||"Commander"} deck. Commander: ${h.commander?.name}${h.commander_partner?" & "+h.commander_partner.name:""}. Prioritize theme synergy.`,candidates:Ce.slice(0,150),playstyle:i?.playstyle,targetRole:je};let ge=0;for(;ge<2;)try{S(`Consulting ${A} for ${je}s (Need ${Ae})${ge>0?" [Retry]":""}...`);const fe=await Fn.generateDeckSuggestions(i.settings.geminiApiKey,Vt);fe?.suggestions&&(fe.suggestions.forEach(ve=>{const Me=Ce.find(de=>de.firestoreId===ve.firestoreId);if(Me){const de=x.find(Ze=>Ze.id===ve.firestoreId),De=ve.firestoreId;_e[De]={...ve,firestoreId:De,name:de?.name||Me.name,type_line:de?.data?.type_line||Me.type_line,data:de?.data||de,rating:ve.rating,reason:ve.reason,suggestedType:je},Te.add(De)}}),S(`${A} provided ${fe.suggestions.length} suggestions for ${je}.`));break}catch(fe){ge++,ge>=2?(console.error(`[Wizard] Oracle failed for ${je} after 2 tries:`,fe),S(`Notice: ${A} failed for ${je}: ${fe.message}. Continuing...`)):(S(`Notice: ${A} encountered an issue with ${je}. Retrying in 2s...`),await new Promise(ve=>setTimeout(ve,2e3)))}}const Ve=g.filter(je=>(je.data?.type_line||je.type_line||"").includes("Land")).length,Ie=Object.values(_e).filter(je=>je.suggestedType==="Land").length,Ye=Ve+Ie,xt=pe.Land||36,we=Math.max(0,xt-Ye);if(we>0){S(`Calculating mana base for ${we} remaining land slots...`);const je=O(g,_e),Ee=ye(we,je,x);Object.assign(_e,Ee),Object.keys(Ee).forEach(ke=>Te.add(ke)),S(`Added ${Object.keys(Ee).length} Basic Lands to balance mana curve.`)}z(_e),X(Te),S("Architecture complete. Proceeding to Architect view."),N(ir.ARCHITECT)}catch(W){console.error(W),d("Architecture failed. Please check your AI key.","error")}finally{U(!1),_("Ready.")}},ie=()=>{if(!(o?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||i?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"))return;S("Dev Mode: Skipping Analysis...");const q=[...new Set([...h.commander?.color_identity||[],...h.commander_partner?.color_identity||[]])],Q=h.aiBlueprint||{},xe=["Land","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"],pe={Land:36,"Mana Ramp":10,"Card Draw":10,"Targeted Removal":10,"Board Wipes":3,"Synergy / Strategy":30,...Q.suggestedCounts||{}},_e={},Te=new Set,Ve=new Set;let Ie=0;for(const Ye of xe){const xt=g.filter(Ae=>(Ae.data?.type_line||Ae.type_line||"").includes(Ye)).reduce((Ae,Ce)=>Ae+(Ce.countInDeck||1),0),we=pe[Ye]||0,je=Math.max(0,we-xt);if(je<=0)continue;x.filter(Ae=>{if(!Ae.id||Ve.has(Ae.id)||g.some(Vt=>Vt.name===Ae.name))return!1;const Ce=Ae.color_identity||Ae.data?.color_identity||[];if(!ue(Ce,q))return!1;const Be=(Ae.type_line||"").includes("Land");return Ye==="Land"?Be:!Be}).sort(()=>.5-Math.random()).slice(0,je).forEach(Ae=>{const Ce=Ae.id;_e[Ce]={firestoreId:Ce,name:Ae.name,type_line:Ae.type_line,rating:Math.floor(Math.random()*5)+5,reason:`[Dev-Skipped] Auto-filled to satisfy ${Ye} quota.`,suggestedType:Ye,data:Ae},Te.add(Ce),Ve.add(Ce),Ie++})}if(Ie===0){d("Dev Skip: No valid cards found to fill any buckets.","warning");return}z(_e),X(Te),S(`Dev Mode: Populated ${Ie} cards across categories. Proceeding.`),N(ir.ARCHITECT)},K=W=>{const q=new Set(G);q.has(W)?q.delete(W):q.add(W),X(q)},oe=()=>s.jsxs("div",{className:"max-w-4xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"inline-block p-4 rounded-3xl bg-indigo-500/10 border border-indigo-500/20 mb-4 animate-bounce",children:s.jsx("span",{className:"text-4xl",children:""})}),s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase italic",children:[A," Deck Architect"]}),s.jsxs("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:[A," will analyze your collection and current deck composition to architect the perfect additions for ",s.jsx("span",{className:"text-indigo-400 font-bold",children:h?.name}),"."]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-[2.5rem] border border-white/10 overflow-hidden shadow-2xl",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 bg-white/5 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${T?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500",children:j})]}),s.jsxs("div",{className:"flex gap-4",children:[(o?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||i?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&s.jsx("button",{onClick:ie,className:"bg-amber-600/20 hover:bg-amber-600/40 text-amber-500 font-black px-6 py-3 rounded-2xl transition-all uppercase tracking-widest text-[10px] border border-amber-500/20",children:"Quick Skip (Dev)"}),!T&&s.jsx("button",{onClick:V,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black px-8 py-3 rounded-2xl transition-all shadow-lg shadow-indigo-500/20 uppercase tracking-widest text-xs border border-white/10",children:"Start Architecture"})]})]}),s.jsxs("div",{className:"p-8 h-[400px] overflow-y-auto font-mono text-xs space-y-3 custom-scrollbar bg-black/40 backdrop-blur-inner shadow-inner box-shadow-inner border-t border-white/5 font-medium leading-relaxed",children:[I.length===0?s.jsx("div",{className:"text-gray-600 italic animate-pulse",children:"Waiting for architecture to start..."}):I.map((W,q)=>s.jsx("div",{className:"text-gray-300 animate-fade-in pl-4 border-l-2 border-indigo-500/40 py-1 hover:bg-white/5 transition-colors rounded-r",children:W},q)),s.jsx("div",{ref:E})]})]})]}),me=()=>{const W=Object.values(P).filter(Q=>se==="All"||Q.suggestedType===se),q=["All","Land","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"];return s.jsxs("div",{className:"h-full flex flex-col gap-6 py-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-6 px-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Selection Phase"}),s.jsxs("p",{className:"text-gray-500 text-sm font-medium",children:["Review ",A,"'s suggestions and select the ones you want to draft into your deck."]})]}),s.jsx("div",{className:"flex items-center gap-3 bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md",children:[{mode:"grid",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{mode:"table",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"list",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}].map(({mode:Q,icon:xe})=>s.jsx("button",{onClick:()=>k(Q),className:`p-2 rounded-xl transition-all ${R===Q?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,title:`${Q.charAt(0).toUpperCase()+Q.slice(1)} View`,children:xe},Q))})]}),s.jsx("div",{className:"flex bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md overflow-x-auto no-scrollbar mx-4",children:q.map(Q=>{const xe=Object.values(P).filter(pe=>Q==="All"||pe.suggestedType===Q).length;return Q!=="All"&&xe===0?null:s.jsxs("button",{onClick:()=>te(Q),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${se===Q?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[Q," ",s.jsx("span",{className:"ml-1 opacity-40 font-mono",children:xe})]},Q)})}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 custom-scrollbar",children:[R==="list"&&s.jsx("div",{className:"space-y-4",children:W.map(Q=>s.jsxs("div",{onClick:()=>K(Q.firestoreId),className:`grid grid-cols-[auto_1fr_auto_auto] gap-8 items-center p-6 rounded-[2rem] border transition-all cursor-pointer group ${G.has(Q.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${G.has(Q.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10 group-hover:border-white/30"}`,children:G.has(Q.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"block text-xl font-black text-white uppercase italic tracking-tight group-hover:text-indigo-300 transition-colors",children:Q.name}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.2em] uppercase",children:Q.type_line})]}),s.jsxs("div",{className:"text-center font-mono text-indigo-400 font-bold bg-white/5 px-4 py-2 rounded-2xl border border-white/5",children:[Q.rating,"/10"]}),s.jsxs("div",{className:"max-w-md bg-black/30 p-4 rounded-2xl border border-white/5 text-sm text-gray-400 font-medium italic leading-relaxed",children:['"',Q.reason,'"']})]},Q.firestoreId))}),R==="grid"&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-6",children:W.map(Q=>s.jsxs("div",{onClick:()=>K(Q.firestoreId),className:`flex flex-col rounded-[2rem] border transition-all cursor-pointer group overflow-hidden ${G.has(Q.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden",children:[s.jsx("img",{src:Q.data?.image_uris?.normal||`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(Q.name)}&format=image`,alt:Q.name,className:"w-full h-full object-cover transition-transform group-hover:scale-110",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"}),s.jsx("div",{className:`absolute top-4 right-4 w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${G.has(Q.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"bg-black/40 border-white/20 group-hover:border-white/40"}`,children:G.has(Q.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[s.jsx("span",{className:"block text-lg font-black text-white uppercase italic tracking-tight line-clamp-1",children:Q.name}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-300 tracking-[0.2em] uppercase truncate max-w-[70%]",children:Q.type_line}),s.jsxs("span",{className:"text-xs font-mono text-indigo-400 font-bold bg-black/60 px-2 py-0.5 rounded-lg border border-white/10",children:[Q.rating,"/10"]})]})]})]}),s.jsx("div",{className:"p-4 flex-1 flex flex-col justify-between",children:s.jsxs("div",{className:"text-xs text-gray-400 font-medium italic leading-relaxed line-clamp-3",children:['"',Q.reason,'"']})})]},Q.firestoreId))}),R==="table"&&s.jsx("div",{className:"bg-gray-950/30 rounded-[2rem] border border-white/5 overflow-hidden",children:s.jsxs("table",{className:"w-full text-left",children:[s.jsx("thead",{className:"bg-white/5 font-black text-[10px] uppercase tracking-[0.2em] text-gray-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 w-16",children:"Select"}),s.jsx("th",{className:"px-6 py-4",children:"Card Name"}),s.jsx("th",{className:"px-6 py-4",children:"Type"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"Rating"}),s.jsx("th",{className:"px-6 py-4",children:"Reasoning"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:W.map(Q=>s.jsxs("tr",{onClick:()=>K(Q.firestoreId),className:`hover:bg-white/5 cursor-pointer transition-colors ${G.has(Q.firestoreId)?"bg-indigo-500/5":""}`,children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${G.has(Q.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10"}`,children:G.has(Q.firestoreId)&&s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"font-bold text-white uppercase italic tracking-tight",children:Q.name})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.1em] uppercase",children:Q.type_line})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"font-mono text-indigo-400 font-bold bg-white/5 px-3 py-1 rounded-lg border border-white/5",children:Q.rating})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-xs text-gray-400 italic line-clamp-1",children:['"',Q.reason,'"']})})]},Q.firestoreId))})]})})]}),s.jsxs("div",{className:"p-8 bg-gray-950/40 backdrop-blur-3xl rounded-3xl border border-white/10 flex justify-between items-center shadow-2xl mx-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.4em]",children:"Draft Progress"}),s.jsxs("span",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:[G.size," Cards Selected"]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>N(ir.ANALYSIS),className:"px-8 py-3.5 bg-white/5 hover:bg-white/10 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-[11px] transition-all",children:"Re-Analyze"}),s.jsx("button",{onClick:()=>N(ir.DEPLOY),className:"px-10 py-3.5 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-xl shadow-indigo-500/20 uppercase tracking-widest text-[11px] border border-white/10 transition-all",children:"Review & Deploy"})]})]})]})},D=()=>{const W=Array.from(G).map(Q=>P[Q]),q=async()=>{if(!T){U(!0);try{const Q=[],xe=new Map;x.forEach(pe=>{const _e=pe.scryfall_id||pe.data?.scryfall_id;_e&&!pe.deck_id&&xe.set(_e,(xe.get(_e)||0)+1)});for(const pe of W){const _e=pe.data||pe,Te=_e.scryfall_id||_e.id||(pe.isVirtual?null:pe.firestoreId);let Ve=!1;if(Te&&xe.has(Te)){const Ie=xe.get(Te);Ie>0&&(Ve=!0,xe.set(Te,Ie-1))}if(Ve)Q.push({scryfall_id:Te,finish:"nonfoil"});else{const Ie=pe.type_line&&pe.type_line.includes("Basic Land");if(h.is_mockup===!1&&!Ie)throw new Error(`Cannot add unowned card "${pe.name}" to a Collection Deck.`);Q.push({scryfall_id:Te,name:pe.name,finish:"nonfoil",data:_e,count:1,is_wishlist:!Ie})}}await Ge.post(`/decks/${a}/cards/batch`,{cards:Q}),d(`Successfully added ${Q.length} cards to ${h.name}!`,"success"),n(`/decks/${a}`)}catch(Q){console.error("Deployment failed:",Q),d("Failed to deploy cards. Please try again.","error")}finally{U(!1)}}};return s.jsxs("div",{className:"max-w-5xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase",children:"Final Deployment"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"Review your selected additions before applying them to your deck."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:W.map(Q=>s.jsxs("div",{className:"bg-gray-950/30 p-6 rounded-[2rem] border border-white/10 space-y-4",children:[s.jsx("span",{className:"font-black text-white uppercase italic text-lg truncate block",children:Q.name}),s.jsxs("div",{className:"text-xs text-gray-400 leading-relaxed italic",children:['"',Q.reason,'"']})]},Q.firestoreId))}),s.jsxs("div",{className:"flex gap-6 justify-center",children:[s.jsx("button",{onClick:()=>N(ir.ARCHITECT),className:"px-12 py-4 bg-gray-900 hover:bg-gray-800 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-xs transition-all",children:"Back to Architect"}),s.jsxs("button",{onClick:q,disabled:T,className:"px-16 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-2xl shadow-indigo-500/40 uppercase tracking-widest text-xs border border-white/10 transition-all",children:['Apply to "',h?.name,'"']})]})]})};if(p)return s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-indigo-500 border-t-transparent rounded-full"})});const F=B(h?.commander)||B(h?.commander_partner);return s.jsxs("div",{className:"min-h-screen bg-gray-950 text-gray-200 font-sans relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${F})`,backgroundSize:"cover",backgroundPosition:"center"},children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/80 to-gray-950/40"})]}),s.jsxs("div",{className:"sticky top-0 z-50 px-6 py-4 flex justify-between items-center bg-gray-950 border-b border-white/5",children:[s.jsxs("button",{onClick:()=>n(`/decks/${a}`),className:"text-gray-500 hover:text-white flex items-center gap-2 group transition-all",children:[s.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:"Exit Wizard"})]}),s.jsx("div",{className:"flex gap-12",children:[1,2,3].map(W=>s.jsxs("div",{className:`flex items-center gap-3 transition-all ${b===W?"scale-110":"opacity-40"}`,children:[s.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${b>=W?"bg-indigo-500 text-white":"bg-gray-800 text-gray-600"}`,children:W}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em]",children:W===1?"Analysis":W===2?"Architect":"Deploy"})]},W))}),s.jsx("div",{className:"w-32"})," "]}),s.jsxs("main",{className:"flex-1 relative z-10 px-4 max-w-7xl mx-auto w-full",children:[b===ir.ANALYSIS&&oe(),b===ir.ARCHITECT&&me(),b===ir.DEPLOY&&D()]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .animate-pulse-slow { animation: pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
                @keyframes pulse { 0%, 100% { opacity: 0.2; transform: scale(1.05); } 50% { opacity: 0.4; transform: scale(1); } }
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]})},bk=({onNext:a})=>s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-indigo-500/20 rounded-full flex items-center justify-center ring-1 ring-indigo-500/50 shadow-[0_0_30px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-extrabold text-white mb-4",children:"Welcome to MTG-Forge"}),s.jsxs("p",{className:"text-xl text-gray-300 leading-relaxed",children:["Your ultimate companion for deck building, collection management, and magical optimization.",s.jsx("br",{}),"Let's get everything set up in just a few clicks."]})]}),s.jsx("button",{onClick:a,className:"px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-1",children:"Let's Go"})]}),vk=({onNext:a,onBack:n})=>{const[i,o]=w.useState("alpha"),d=[{id:"scout",name:"Scout",price:"Free",features:["Collection Management","Basic Deck Stats","Limited AI Suggestions"],disabled:!0,tag:"Coming Soon"},{id:"alpha",name:"Alpha Tester",price:"$0/mo",originalPrice:"Priceless",features:["Unlimited Collections","Full AI Architect Access","Priority Support","Founder Badge"],disabled:!1,recommended:!0,tag:"Limited Time"},{id:"planeswalker",name:"Planeswalker",price:"$TBD/mo",features:["Pro Analytics","Meta Game Insights","Secure Offline Backups","Custom AI Architect Personas"],disabled:!0,tag:"Coming Soon"}];return s.jsxs("div",{className:"max-w-5xl w-full space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 max-w-lg mx-auto",children:"Select your access level. During our Alpha phase, all features are unlocked for testers."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:d.map(h=>s.jsxs("div",{onClick:()=>!h.disabled&&o(h.id),className:`relative rounded-2xl border p-6 transition-all duration-300 flex flex-col ${h.disabled?"bg-gray-800/20 border-gray-800 opacity-60 cursor-not-allowed grayscale-[0.5]":i===h.id?"bg-indigo-900/40 border-indigo-500 shadow-[0_0_30px_rgba(99,102,241,0.2)] transform scale-105 z-10":"bg-gray-800/40 border-gray-700 hover:border-gray-600 cursor-pointer hover:bg-gray-800/60"}`,children:[h.recommended&&s.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-amber-500 to-orange-500 text-white px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-lg",children:"Recommended"}),h.tag&&!h.recommended&&s.jsx("div",{className:"absolute top-4 right-4 text-xs font-mono text-gray-500 border border-gray-700 px-2 py-1 rounded",children:h.tag}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:`text-xl font-bold mb-1 ${h.id==="alpha"?"text-amber-400":"text-white"}`,children:h.name}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-3xl font-extrabold text-white",children:h.price}),h.originalPrice&&s.jsx("span",{className:"text-sm text-gray-500 line-through decoration-red-500/50",children:h.originalPrice})]})]}),s.jsx("ul",{className:"space-y-3 mb-8 flex-grow",children:h.features.map((g,p)=>s.jsxs("li",{className:"flex items-start gap-3 text-sm text-gray-300",children:[s.jsx("svg",{className:`w-5 h-5 flex-shrink-0 ${h.disabled?"text-gray-600":"text-green-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),g]},p))}),s.jsx("button",{disabled:h.disabled,className:`w-full py-3 rounded-xl font-bold transition-all ${h.disabled?"bg-gray-800 text-gray-500 cursor-not-allowed":i===h.id?"bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:h.disabled?"Unavailable":i===h.id?"Selected":"Select Plan"}),h.id==="alpha"&&s.jsxs("div",{className:"mt-4 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg text-center animate-fade-in",children:[s.jsx("p",{className:"text-amber-400 text-xs font-bold uppercase tracking-wide mb-1",children:"We Need Your Voice"}),s.jsxs("p",{className:"text-gray-300 text-xs leading-relaxed",children:["Help us define the future! ",s.jsx("br",{}),s.jsx("span",{className:"text-amber-200",children:"What should be free? What's worth paying for?"}),s.jsx("br",{}),"Your feedback shapes our pricing models."]})]})]},h.id))}),s.jsxs("div",{className:"flex justify-center pt-8 gap-4",children:[n&&s.jsx("button",{onClick:n,className:"px-8 py-4 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded-xl font-bold text-lg transition-colors border border-gray-700",children:"Back"}),s.jsx("button",{onClick:()=>a(i),className:"px-12 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-indigo-500/30 transition-all transform hover:-translate-y-1",children:"Confirm Selection"})]})]})},wk=({onNext:a,onBack:n})=>{const[i,o]=w.useState("");return s.jsxs("div",{className:"max-w-3xl w-full space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Enable AI Architect"}),s.jsx("p",{className:"text-gray-400 max-w-lg mx-auto",children:"Our AI analyzes your cards to suggest synergies, optimal mana curves, and complete deck strategies."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Automated Building"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Generate entire commander decks from a single prompt or theme using your own collection."})]}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Synergy Scouting"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Find hidden gems in your binder that perfectly match your commander's strategy."})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Why do I need my own API Key?"}),s.jsx("p",{className:"text-sm text-blue-100/80 leading-relaxed",children:"MTG-Forge connects directly to Google's Gemini AI to power its deck architect features. To ensure usage, privacy, and zero rampingsubscription fees, we ask users to provide their own free API key. Your key is stored locally on your device and is never shared with us."}),s.jsxs("div",{className:"mt-4 p-3 bg-indigo-900/40 border border-indigo-500/30 rounded-lg",children:[s.jsxs("h4",{className:"font-bold text-indigo-200 mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-400",children:""})," AI is Experimental"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["Our AI Architect is a powerful assistant, but ",s.jsx("strong",{children:"YOU"})," are the true deck builder. AI can suggest amazing synergies, but it can also make mistakes or suggest suboptimal cards. Always review and refine the suggestions to match your personal playstyle and meta."]})]})]})]})}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700 space-y-4 text-left",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Enter your Gemini API Key"}),s.jsx("input",{type:"password",value:i,onChange:d=>o(d.target.value),placeholder:"AIzaSy...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors"}),s.jsxs("div",{className:"text-sm text-gray-400",children:["Don't have a key? ",s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:text-purple-300 underline",children:"Get a free key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 pt-4",children:[n&&s.jsx("button",{onClick:n,className:"nav-button px-10 py-3 rounded-lg font-bold transition-all border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-800/50",children:"Back"}),s.jsx("button",{onClick:()=>a(i),disabled:!i,className:`nav-button px-10 py-3 rounded-lg font-bold transition-all shadow-lg transform hover:-translate-y-0.5 ${i?"bg-purple-600 hover:bg-purple-500 text-white hover:shadow-purple-500/25":"bg-gray-700 text-gray-400 cursor-not-allowed shadow-none"}`,children:"Save & Enable AI"}),s.jsx("button",{onClick:()=>a(null),className:"text-gray-500 text-sm hover:text-gray-300 underline transition-colors",children:"Skip (Features Disabled)"})]})]})},jk=({onNext:a,onBack:n})=>{const[i,o]=Tn.useState(0),[d,h]=Tn.useState(!1),g=[{title:"Manage Your Collection",desc:"Import cards, track values, and organize your entire library in one place.",details:["Navigate to the 'Collection' page via the top navigation bar.","Click the 'Add Cards' button to bulk add cards from CSV, text, or card scanner.","Use the 'Binder' view to visually organize your cards by Set, Color, or Rarity.","More organizational features coming soon, as in folders and custom groupings."],icon:s.jsx("svg",{className:"w-16 h-16 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{title:"Build & Analyze Decks",desc:"Use the Architect Wizard to construct powerful decks with real-time stats and mana analysis.",details:["Go to 'Decks' and click 'Create New Deck'.","Choose your format: 'Commander' or 'Standard'.","Select a Commander or Spotlight Card to anchor your strategy.","Use the 'AI Architect' to generate suggested cards based on your themes.","Review mana curves, color distribution, and type breakdowns in the 'Stats' tab."],icon:s.jsx("svg",{className:"w-16 h-16 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{title:"Wishlist & Tracking",desc:"Keep track of cards you need and plan your next purchases directly from deck builds.",details:["Search for any card in the database, even ones you don't own.","Click the 'Heart' icon to add it to your Wishlist.","When building decks, enable 'Theorycraft Mode' to include wishlist cards.","View your shopping list in the 'Wishlist' tab of your Collection."],icon:s.jsx("svg",{className:"w-16 h-16 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}],p=g[i],x=()=>{i<g.length-1?(o(i+1),h(!1)):a()};return s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-10 animate-fade-in relative",children:[s.jsxs("div",{className:"h-80 flex flex-col items-center justify-center bg-gray-800/30 rounded-2xl border border-gray-700/50 p-8 relative overflow-hidden group",children:[s.jsxs("div",{className:`absolute inset-0 bg-gray-900/95 backdrop-blur-md z-20 flex flex-col items-center justify-center p-8 transition-all duration-300 ${d?"opacity-100 translate-y-0":"opacity-0 translate-y-full pointer-events-none"}`,children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx("span",{children:""})," How it Works"]}),s.jsx("ul",{className:"space-y-4 text-left w-full max-w-md",children:p.details.map((b,N)=>s.jsxs("li",{className:"flex gap-3 text-gray-300 text-sm",children:[s.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-indigo-500/20 text-indigo-400 flex items-center justify-center font-bold text-xs border border-indigo-500/30",children:N+1}),s.jsx("span",{className:"leading-relaxed",children:b})]},N))}),s.jsx("button",{onClick:()=>h(!1),className:"mt-8 text-sm text-gray-500 hover:text-white underline",children:"Close Details"})]}),s.jsxs("div",{className:"animate-fade-in-up flex flex-col items-center",children:[s.jsx("div",{className:"mb-6 opacity-90 transform group-hover:scale-110 transition-transform duration-500",children:p.icon}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:p.title}),s.jsx("p",{className:"text-lg text-gray-400 max-w-md mb-6",children:p.desc}),s.jsxs("button",{onClick:()=>h(!0),className:"text-sm font-bold text-indigo-400 hover:text-indigo-300 flex items-center gap-1 transition-colors px-4 py-2 rounded-lg hover:bg-indigo-500/10",children:[s.jsx("span",{children:"View Walkthrough"}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]},i)]}),s.jsxs("div",{className:"flex flex-col items-center gap-6",children:[s.jsx("div",{className:"flex gap-2",children:g.map((b,N)=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${N===i?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},N))}),s.jsxs("div",{className:"flex gap-4 w-full sm:w-auto",children:[n&&s.jsx("button",{onClick:()=>{i>0?(o(i-1),h(!1)):n()},className:"px-6 py-3 bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white rounded-lg font-bold transition-colors w-full sm:w-auto",children:"Back"}),s.jsx("button",{onClick:x,className:"px-10 py-3 bg-white text-gray-900 hover:bg-gray-100 rounded-lg font-bold transition-colors w-full sm:w-auto",children:i===g.length-1?"Finish Setup":"Next Feature"})]})]})]})},Nk=({onNext:a,onBack:n})=>{const{userProfile:i}=vt(),[o,d]=w.useState("selection"),[h,g]=w.useState({name:"",type:"",personality:""}),[p,x]=w.useState([]),[b,N]=w.useState(""),[j,_]=w.useState(!1),I=w.useRef(null),L={name:"Oracle",type:"Mystic Construct",personality:"Wise, Efficient, Slightly Mystical"};w.useEffect(()=>{I.current?.scrollIntoView({behavior:"smooth"})},[p]);const T=()=>{a(L)},U=async()=>{d("forge"),_(!0),x([{role:"model",content:"Booting Forge System... I am the construct builder. Let's create your companion. First, does your helper have a name, or shall we define their personality first?"}]),_(!1)},P=async()=>{if(!b.trim())return;const X={role:"user",content:b},se=[...p,X];x(se),N(""),_(!0);try{const te=i?.settings?.geminiApiKey;if(!te)throw new Error("API Key missing.");const R=await Fn.forgeHelperChat(te,se,h);g(k=>({...k,...R.updatedDraft})),x(k=>[...k,{role:"model",content:R.aiResponse}])}catch(te){console.error("Forge Error:",te),x(R=>[...R,{role:"model",content:"System Glitch. Please repeat."}])}finally{_(!1)}},z=()=>{const X={name:h.name||"Companion",type:h.type||"Construct",personality:h.personality||"Helpful"};a(X)},G=X=>{X.key==="Enter"&&!X.shiftKey&&(X.preventDefault(),P())};return s.jsxs("div",{className:"w-full max-w-5xl animate-fade-in mx-auto",children:[o==="selection"&&s.jsxs("div",{className:"text-center space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-amber-500/20 rounded-full flex items-center justify-center ring-1 ring-amber-500/50 shadow-[0_0_30px_rgba(245,158,11,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Forge Your Helper"}),s.jsx("p",{className:"text-gray-300 max-w-2xl mx-auto",children:'Who will guide you through the multiverse? You can use our standard "Oracle" construct, or forge a completely custom AI companion with its own name and personality.'})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[n&&s.jsx("button",{onClick:n,className:"col-span-1 md:col-span-2 mx-auto text-gray-500 hover:text-white mb-2 underline",children:" Go Back"}),s.jsxs("button",{onClick:T,className:"p-6 bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-gray-500 rounded-xl transition-all group text-left",children:[s.jsx("div",{className:"text-xl font-bold text-white mb-2 group-hover:text-amber-400",children:"Default: The Oracle"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"A wise, mystical construct focused on efficient and accurate advice."}),s.jsx("span",{className:"text-xs font-bold uppercase text-gray-500 group-hover:text-white tracking-wider",children:"Select Oracle "})]}),s.jsxs("button",{onClick:U,className:"p-6 bg-amber-900/20 hover:bg-amber-900/30 border border-amber-500/30 hover:border-amber-500 rounded-xl transition-all group text-left relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-50",children:s.jsx("svg",{className:"w-16 h-16 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xl font-bold text-white mb-2 group-hover:text-amber-400",children:"Forge Custom Helper"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Create a unique companion. Define their name, species, and personality via chat."}),s.jsx("span",{className:"text-xs font-bold uppercase text-amber-500 group-hover:text-white tracking-wider",children:"Start Forging "})]})]})]})]}),o==="forge"&&s.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border border-gray-700 rounded-2xl overflow-hidden bg-gray-900",children:[s.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-800",children:[s.jsx("div",{className:"p-4 border-b border-gray-800 bg-gray-800/50 flex justify-between items-center",children:s.jsx("span",{className:"font-mono text-amber-400 text-sm",children:"SYSTEM: FORGE PROTOCOL ENGAGED"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[p.map((X,se)=>s.jsx("div",{className:`flex ${X.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] p-3 rounded-lg text-sm ${X.role==="user"?"bg-amber-600 text-white":"bg-gray-800 text-gray-300"}`,children:X.content})},se)),j&&s.jsx("div",{className:"text-gray-500 text-xs animate-pulse ml-2",children:" Processing..."}),s.jsx("div",{ref:I})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:b,onChange:X=>N(X.target.value),onKeyDown:G,placeholder:"Ex: Name him 'Gobbo', make him a goblin...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-amber-500 focus:outline-none",disabled:j}),s.jsx("button",{onClick:P,disabled:j||!b.trim(),className:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold",children:"Send"})]})})]}),s.jsxs("div",{className:"w-full md:w-80 bg-gray-950 p-6 flex flex-col",children:[s.jsx("h3",{className:"text-gray-400 font-bold uppercase tracking-wider text-xs mb-6",children:"Blueprint Status"}),s.jsxs("div",{className:"space-y-6 flex-1",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"DESIGNATION (NAME)"}),s.jsx("div",{className:`text-lg font-bold ${h.name?"text-amber-400":"text-gray-700 italic"}`,children:h.name||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"CLASSIFICATION (TYPE)"}),s.jsx("div",{className:`text-sm font-medium ${h.type?"text-white":"text-gray-700 italic"}`,children:h.type||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"PARAMETERS (PERSONALITY)"}),s.jsx("div",{className:`text-sm font-medium ${h.personality?"text-white":"text-gray-700 italic"}`,children:h.personality||"Undefined"})]})]}),s.jsx("button",{onClick:z,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg shadow-lg hover:shadow-green-500/20 transition-all mt-4",children:"Complete Forge Protocol"})]})]})]})},_k=()=>{const a=us(),{userProfile:n,updateSettings:i,refreshUserProfile:o}=vt(),[d,h]=w.useState(n?.settings?.onboarding_step||0),[g,p]=w.useState(!1),x=async()=>{const P=d+1;h(P),await i({onboarding_step:P})},b=async()=>{const P=Math.max(0,d-1);h(P),await i({onboarding_step:P})},N=async P=>{const z=d+1;h(z),await i({helper:P,onboarding_step:z})},j=async P=>{const z=d+1;h(z),await i({subscription_tier:"alpha_tester",onboarding_step:z})},_=async P=>{const z=d+1;h(z),await i({ai_enabled:!!P,geminiApiKey:P||void 0,onboarding_step:z})},I=()=>{p(!0)},L=async P=>{const z=d+1;h(z),await i({playstyle:P,onboarding_step:z}),await o(),p(!1)},T=async()=>{const P=d+1;h(P),await i({onboarding_step:P})},U=async()=>{await i({onboarding_complete:!0,onboarding_step:6}),a("/dashboard")};return s.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-30"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900/90 to-black/80"})]}),s.jsxs("div",{className:"relative z-10 flex-grow flex items-center justify-center p-4",children:[d===0&&s.jsx(bk,{onNext:x}),d===1&&s.jsx(vk,{onNext:j,onBack:b}),d===2&&s.jsx(wk,{onNext:_,onBack:b}),d===3&&s.jsx(Nk,{onNext:N,onBack:b}),d===4&&s.jsxs("div",{className:"text-center max-w-2xl animate-fade-in-up space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-green-500/20 rounded-full flex items-center justify-center ring-1 ring-green-500/50 shadow-[0_0_30px_rgba(34,197,94,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Define Your Playstyle"}),s.jsxs("p",{className:"text-gray-300",children:["Let us get to know what kind of mage you are.",s.jsx("br",{}),"We'll tailor card suggestions and deck strategies to your personal taste."]})]}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsx("button",{onClick:b,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Back"}),s.jsx("button",{onClick:I,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"Start Quiz"}),s.jsx("button",{onClick:T,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Skip for Now"})]})]}),d===5&&s.jsx(jk,{onNext:U,onBack:b})]}),s.jsx("div",{className:"relative z-10 py-8 flex justify-center gap-3",children:[0,1,2,3,4,5].map(P=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${P===d?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},P))}),s.jsx(xb,{isOpen:g,onClose:()=>p(!1),onComplete:L})]})},kk=()=>s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsxs("div",{className:"relative py-20 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-900/10"}),s.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto px-6 text-center",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white mb-6 tracking-tight",children:"About The Forge"}),s.jsx("p",{className:"text-xl text-gray-400 leading-relaxed",children:"Built by players, for players. The Forge is designed to be the ultimate companion for Magic: The Gathering deck building and collection management."})]})]}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 space-y-16",children:[s.jsxs("section",{className:"space-y-6 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-amber-500 rounded-full"}),"The Human Factor"]}),s.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-3xl border border-amber-500/10 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 pointer-events-none",children:s.jsx("svg",{className:"w-64 h-64 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"AI is a Tool, Not a Replacement"}),s.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[s.jsx("p",{children:"At The Forge, we believe AI can be an incredible creative partner. It can scan thousands of cards in seconds, find obscure combos, and suggest perfectly curved land bases."}),s.jsxs("p",{children:[s.jsx("strong",{className:"text-amber-400",children:"However, AI is still a work in progress."}),' It can hallucinate interactions, suggest banned cards, or miss the subtle "fun factor" that makes a Commander deck truly special.']}),s.jsx("p",{children:"We built these tools to get you 80% of the way there. The final 20%the soul of the deckcomes from you. Use our suggestions as a starting point, but trust your intuition and knowledge to build something truly unique."})]})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-indigo-500 rounded-full"}),"Powered By"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("a",{href:"https://scryfall.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-indigo-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Scryfall"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"The best MTG card database in the world. All card data and imagery is provided by their incredible API."})]}),s.jsxs("a",{href:"https://tcgplayer.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-green-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-green-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"TCGPlayer"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Real-time pricing data for card values. Keeping your collection valuation accurate and up to date."})]}),s.jsxs("a",{href:"https://magic.wizards.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-orange-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-orange-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Wizards of the Coast"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Creators of Magic: The Gathering. All mana symbols, card names, and art are copyright WotC."})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up delay-100",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-purple-500 rounded-full"}),"Get in Touch"]}),s.jsx("div",{className:"bg-gradient-to-br from-indigo-900/20 to-purple-900/20 p-8 rounded-3xl border border-white/5 relative overflow-hidden",children:s.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[s.jsxs("div",{className:"space-y-4 text-center md:text-left",children:[s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Join the Community"}),s.jsx("p",{className:"text-gray-400 max-w-md",children:"Have a feature request? Found a bug? Or just want to show off your latest brew? Come chat with us on Discord."})]}),s.jsxs("a",{href:"https://discord.gg/your-discord-link",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-4 bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-indigo-500/25 flex items-center gap-3 transform hover:-translate-y-1",children:[s.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]})]})})]}),s.jsx("div",{className:"text-center text-gray-600 text-xs pt-20",children:s.jsx("p",{children:"The Forge is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. Wizards of the Coast LLC."})})]})]}),Sk=()=>{const{userProfile:a}=vt(),[n,i]=w.useState(!1),[o,d]=w.useState(!1),h=a?.settings?.helper,g=h?.name||"MTG Forge",[p,x]=w.useState([]),[b,N]=w.useState(""),[j,_]=w.useState(!1),[I,L]=w.useState(!1),T=w.useRef(null),U=()=>{T.current?.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{U()},[p]),w.useEffect(()=>{if(!n)return;(async()=>{const te=a?.settings?.geminiApiKey;if(!te||I){!te&&p.length===0&&x([{role:"model",content:'<p class="text-gray-300">Please add your Gemini API Key in Settings to enable the chat.</p>'}]);return}if(L(!0),!(p.length>0))try{const R=`
                    You are about to have a conversation with a user.
                    your name is ${g}.
                    Your personality is: ${h?.personality||"Knowledgeable and friendly"}.
                    It is not their first time working with you, interact with them appropriately.
                    Use emojis. 
                `,k=await Fn.sendMessage(te,[],R,"",h);x([{role:"model",content:k}])}catch(R){console.error("Intro fetch failed",R),x([{role:"model",content:`<p>Greetings. I am ${g}. How may I assist?</p>`}])}})()},[n,a?.settings?.geminiApiKey,g,I]);const P=a?.settings?.playstyle,z=P?`
User's Playstyle Profile:
- Archetypes: ${P.archetypes?.join(", ")||"Unknown"}
- Summary: ${P.summary||"Unknown"}
- Combat Preference: ${P.scores?.aggression>50?"Aggressive":"Defensive"}
- Interaction Level: ${P.scores?.interaction>50?"High":"Low"}
    `.trim():"",G=async se=>{if(se.preventDefault(),!b.trim()||j)return;const te=b.trim();N(""),x(R=>[...R,{role:"user",content:te}]),_(!0);try{const R=a?.settings?.geminiApiKey;if(!R){x(S=>[...S,{role:"model",content:'<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Please add your Gemini API Key in <a href="/settings" class="underline font-bold">Settings</a> to use the chat.</div>'}]);return}const k=p.map(S=>({role:S.role,content:S.content})),E=await Fn.sendMessage(R,k,te,z,h);x(S=>[...S,{role:"model",content:E}])}catch(R){console.error(R),x(k=>[...k,{role:"model",content:`<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Error: ${R.message}</div>`}])}finally{_(!1)}},X=o?"fixed inset-0 top-16 z-40":`fixed bottom-0 right-0 z-50 transition-all duration-300 ${n?"":"w-16 h-16 mb-20 mr-4 md:mb-6 md:mr-6"}`;return s.jsxs("div",{className:`${X} ${!o&&n?"w-full md:w-96 h-[600px] mb-0 mr-0":""}`,children:[!n&&s.jsx("button",{onClick:()=>i(!0),className:"w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full shadow-lg shadow-purple-500/30 flex items-center justify-center hover:scale-110 transition-transform animate-bounce-slow",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),n&&s.jsxs("div",{className:`flex flex-col h-full bg-gray-800 border-t border-l border-gray-700 shadow-2xl overflow-hidden ${o?"w-full h-full":"rounded-tl-2xl md:rounded-tr-2xl md:border-r"}`,children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),s.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:g})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>d(!o),className:"text-gray-400 hover:text-white p-1 hover:bg-gray-800 rounded transition-colors",title:o?"Collapse":"Expand",children:o?s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6m-6 0v6M20 10h-6m6 0V4"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),s.jsx("button",{onClick:()=>{i(!1),d(!1)},className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-800/95 backdrop-blur",children:[p.length===0&&!j?s.jsxs("div",{className:"flex justify-center items-center h-full text-gray-500 italic",children:["Summoning ",g,"..."]}):p.map((se,te)=>s.jsx("div",{className:`flex ${se.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-2xl ${se.role==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-gray-700 text-gray-200 rounded-bl-none"} shadow-md`,children:se.role==="user"?se.content:s.jsx("div",{dangerouslySetInnerHTML:{__html:se.content}})})},te)),j&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-700 rounded-2xl rounded-bl-none p-3 flex gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-75"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-150"})]})}),s.jsx("div",{ref:T})]}),s.jsx("form",{onSubmit:G,className:"p-4 bg-gray-900 border-t border-gray-700",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:b,onChange:se=>N(se.target.value),placeholder:`Ask ${g}...`,className:"flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"}),s.jsx("button",{type:"submit",disabled:j,className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg hover:shadow-indigo-500/20 transition-all disabled:opacity-50",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})},Ck=()=>{const{isOpen:a,selectedCard:n,closeCardModal:i}=Hf(),{cards:o,removeCard:d,updateCard:h}=Yn(),{addToast:g}=Rn(),[p,x]=w.useState(!1),[b,N]=w.useState(!1),[j,_]=w.useState({quantity:1,finish:"nonfoil",deckId:"",price_bought:"",tags:[],currentTag:""}),[I,L]=w.useState([]);if(w.useEffect(()=>{a&&n&&(x(!1),N(!1),_({quantity:n.count||n.quantity||1,finish:n.finish||"nonfoil",deckId:n.deckId||n.deck_id||"",price_bought:n.price_bought||"",tags:typeof n.tags=="string"?JSON.parse(n.tags):n.tags||[],currentTag:""}),Ge.get("/decks").then(L).catch(oe=>console.error("Failed to load decks",oe)))},[a,n]),!a||!n)return null;const T=n.data||n,U=T.card_faces,P=U&&U.length>1&&!!U[1].image_uris,X=(oe=>P?T.card_faces[oe]:T)(p?1:0),se=oe=>oe.image_uris?.normal||oe.image_uris?.large||null,te=oe=>oe.image_uris?.art_crop||oe.image_uris?.large||oe.image_uris?.normal||null,R=P?se(T.card_faces[0]):T.image_uris?.normal||T.image_uris?.large||n.image_uri,k=P?se(T.card_faces[1]):null,E=P?te(T.card_faces[0]):T.image_uris?.art_crop||T.image_uris?.large||n.image_uri,S=P?te(T.card_faces[1]):null,A=p?k:R,B=(p?S:E)||"https://placehold.co/1000x800?text=No+Art",O=oe=>oe?oe.replace(/\{/g,"").replace(/\}/g," "):"",ye=(oe,me)=>{const D={legal:"bg-green-600 text-white border-green-700",not_legal:"bg-gray-700 text-gray-400 border-gray-600",banned:"bg-red-600 text-white border-red-700",restricted:"bg-yellow-600 text-white border-yellow-700"},F=D[me]||D.not_legal;return s.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase border ${F} flex justify-center items-center shadow-sm`,children:s.jsx("span",{children:oe})},oe)},ue=async()=>{if(window.confirm(`Are you sure you want to delete ${n.name} from your collection?`))try{await d(n.id||n.firestoreId),g("Card deleted","success"),i()}catch(oe){console.error(oe),g("Failed to delete card","error")}},V=async()=>{try{const oe={count:parseInt(j.quantity),finish:j.finish,deck_id:j.deckId?parseInt(j.deckId):null,price_bought:j.price_bought?parseFloat(j.price_bought):null,tags:j.tags};await h(n.id||n.firestoreId,oe),g("Card details updated","success"),N(!1)}catch(oe){console.error(oe),g("Failed to update details","error")}},ie=oe=>{oe.key==="Enter"&&j.currentTag.trim()&&(oe.preventDefault(),j.tags.includes(j.currentTag.trim())||_(me=>({...me,tags:[...me.tags,me.currentTag.trim()],currentTag:""})))},K=oe=>{_(me=>({...me,tags:me.tags.filter(D=>D!==oe)}))};return s.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center overflow-hidden animate-fade-in",role:"dialog",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:i}),s.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full md:h-[90vh] max-h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-y-auto md:overflow-hidden bg-gray-900/50 border border-gray-700",children:[s.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden rounded-2xl",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-700 ease-in-out transform scale-110 opacity-100",style:{backgroundImage:`url('${B}')`}}),s.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),s.jsx("button",{onClick:i,className:"absolute top-4 right-4 z-50 p-2 bg-black/30 hover:bg-black/60 rounded-full text-white/70 hover:text-white transition-colors backdrop-blur-md",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"w-full md:w-1/2 lg:w-5/12 p-8 flex flex-col items-center justify-center relative shrink-0 z-10",children:[s.jsxs("div",{className:"relative w-full max-w-xs md:max-w-md aspect-[2.5/3.5] perspective-1000 transition-transform duration-500",children:[s.jsx("img",{src:A||"https://placehold.co/250x350?text=No+Image",alt:n.name,className:"w-full h-full object-contain drop-shadow-2xl rounded-xl shadow-black/50"}),P&&s.jsx("button",{onClick:()=>x(!p),className:"absolute top-4 right-4 bg-black/60 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg border border-white/20 hover:border-indigo-400 transition-all group backdrop-blur-md",title:"Flip Card",children:s.jsx("svg",{className:`w-6 h-6 transform transition-transform duration-500 ${p?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),T.artist&&s.jsxs("div",{className:"mt-4 text-white/80 text-xs flex items-center gap-1 bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Illustrated by ",s.jsx("span",{className:"font-medium",children:T.artist})]})]}),s.jsxs("div",{className:"flex-1 flex flex-col md:h-full bg-gray-900/60 backdrop-blur-xl min-h-0 z-10 border-l border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 shrink-0 relative group",children:[s.jsx("button",{onClick:()=>N(!b),className:`absolute top-6 right-16 p-2 rounded-full transition-all ${b?"text-indigo-400 bg-indigo-500/20":"text-gray-500 hover:text-white hover:bg-gray-700"}`,title:b?"Cancel Editing":"Edit Card Details",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-1 pr-10",children:T.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-gray-400 text-sm mt-2",children:[s.jsx("span",{className:"font-medium text-gray-300",children:X.type_line}),X.mana_cost&&s.jsx("span",{className:"bg-gray-800 px-2 py-0.5 rounded border border-gray-700 text-gray-200 font-mono tracking-wider",children:O(X.mana_cost)}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-indigo-400 font-bold",children:T.set_name||T.set?.toUpperCase()}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsx("span",{className:"capitalize",children:T.rarity}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsxs("span",{children:["#",T.collector_number]})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-visible md:overflow-y-auto p-6 space-y-8 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Gameplay & Rules"]}),s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-5 border border-gray-700/50 shadow-inner",children:[X.oracle_text?s.jsx("div",{className:"text-gray-200 whitespace-pre-wrap font-serif leading-relaxed text-lg",children:X.oracle_text.split(`
`).map((oe,me)=>s.jsx("p",{className:"mb-2 last:mb-0",children:oe},me))}):s.jsx("span",{className:"text-gray-500 italic",children:"No rules text."}),X.flavor_text&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 text-gray-400 italic font-serif text-sm",children:['"',X.flavor_text,'"']})]}),(X.power||X.loyalty)&&s.jsx("div",{className:"flex justify-end",children:s.jsx("div",{className:"bg-gray-800 border border-gray-600 px-4 py-2 rounded-lg text-xl font-bold text-white shadow-lg",children:X.power?`${X.power} / ${X.toughness}`:`Loyalty: ${X.loyalty}`})})]}),T.legalities&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Legalities"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[ye("Commander",T.legalities.commander),ye("Standard",T.legalities.standard),ye("Modern",T.legalities.modern),ye("Pauper",T.legalities.pauper),ye("Legacy",T.legalities.legacy),ye("Vintage",T.legalities.vintage)]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Status & Ownership ",b&&s.jsx("span",{className:"text-indigo-400 text-[10px] ml-2 font-normal animate-pulse",children:"(Editing)"})]}),n.is_wishlist&&!b&&s.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-3 flex items-center gap-3 animate-pulse",children:[s.jsx("div",{className:"p-2 bg-orange-500 rounded-full text-white",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-orange-400 font-black text-xs uppercase tracking-wider",children:"In Wishlist"}),s.jsx("div",{className:"text-gray-400 text-[10px]",children:"This card is on your want list."})]})]}),(()=>{const oe=T.id,me=o.filter(q=>q.scryfall_id===oe||q.scryfallId===oe||q.id===oe),D=me.filter(q=>!q.is_wishlist&&q.finish==="nonfoil").reduce((q,Q)=>q+(Q.count||1),0),F=me.filter(q=>!q.is_wishlist&&q.finish==="foil").reduce((q,Q)=>q+(Q.count||1),0),W=me.filter(q=>q.is_wishlist).reduce((q,Q)=>q+(Q.count||1),0);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${D>0?"bg-indigo-500/10 border-indigo-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Normal"}),s.jsx("div",{className:"text-xl font-black text-white",children:D}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${F>0?"bg-purple-500/10 border-purple-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Foil"}),s.jsx("div",{className:"text-xl font-black text-indigo-400",children:F}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${W>0?"bg-orange-500/10 border-orange-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Wishlist"}),s.jsx("div",{className:"text-xl font-black text-orange-400",children:W}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Wanted"})]})]}),(b||n.firestoreId||n.firestore_id)&&s.jsxs("div",{className:"bg-gray-950/40 rounded-xl overflow-hidden border border-gray-700/50",children:[s.jsxs("div",{className:"px-3 py-2 bg-gray-800/40 border-b border-gray-700/50 flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-400",children:[s.jsx("span",{children:"Selected Item Details"}),n.is_wishlist&&s.jsx("span",{className:"text-orange-500",children:"Wishlist Copy"})]}),s.jsxs("table",{className:"w-full text-xs text-left",children:[s.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2",children:"Location"}),s.jsx("th",{className:"px-3 py-2 text-center",children:"Foil"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Added"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700/30 text-gray-300",children:s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2",children:b?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("select",{value:j.deckId,onChange:q=>_({...j,deckId:q.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full",children:[s.jsx("option",{value:"",children:"Binder"}),I.map(q=>s.jsxs("option",{value:q.id,children:["Deck: ",q.name]},q.id))]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-500 text-[9px]",children:"PAID $"}),s.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:j.price_bought,onChange:q=>_({...j,price_bought:q.target.value}),className:"bg-gray-800 border-none rounded px-2 py-0.5 text-[10px] text-white w-20 focus:ring-1 focus:ring-indigo-500"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:j.tags&&j.tags.map(q=>s.jsxs("span",{className:"bg-indigo-600/50 text-white px-1.5 rounded text-[9px] flex items-center gap-1 border border-indigo-500/30",children:[q,s.jsx("button",{onClick:()=>K(q),className:"hover:text-red-300",children:""})]},q))}),s.jsx("input",{type:"text",placeholder:"+ Tag...",value:j.currentTag,onChange:q=>_({...j,currentTag:q.target.value}),onKeyDown:ie,className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full focus:ring-1 focus:ring-indigo-500"})]})]}):s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{children:n.deckId?`Deck #${n.deckId}`:"Binder"}),n.tags&&(typeof n.tags=="string"?JSON.parse(n.tags):n.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(typeof n.tags=="string"?JSON.parse(n.tags):n.tags).map(q=>s.jsx("span",{className:"text-[9px] bg-gray-700 px-1 rounded text-gray-300",children:q},q))})]})}),s.jsx("td",{className:"px-3 py-2 text-center align-top",children:b?s.jsx("input",{type:"checkbox",checked:j.finish==="foil",onChange:q=>_({...j,finish:q.target.checked?"foil":"nonfoil"}),className:"rounded bg-gray-700 border-gray-600 text-indigo-600",title:"Is Foil?"}):n.finish==="foil"?"Yes":"-"}),s.jsx("td",{className:"px-3 py-2 text-right font-black align-top",children:b?s.jsx("input",{type:"number",min:"1",value:j.quantity,onChange:q=>_({...j,quantity:q.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-[10px] text-white w-12 text-center"}):n.count||n.quantity||1}),s.jsxs("td",{className:"px-3 py-2 text-right text-gray-500 font-mono text-[10px] align-top",children:[s.jsx("div",{children:n.added_at?new Date(n.added_at).toLocaleDateString():"N/A"}),n.price_bought&&s.jsxs("div",{className:"text-green-500/70 mt-1",title:"Price Paid",children:["$",parseFloat(n.price_bought).toFixed(2)]})]})]})})]})]}),n.is_wishlist&&!b&&s.jsxs("button",{onClick:async()=>{try{await h(n.id||n.firestoreId,{is_wishlist:!1}),g("Card moved to collection!","success")}catch{g("Failed to move card","error")}},className:"w-full py-2.5 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-lg shadow-lg shadow-orange-900/30 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})}),"I Got This Copy!"]})]})})()]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Art & Aesthetics"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Artist"}),s.jsx("span",{className:"text-white font-medium",children:T.artist||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Frame"}),s.jsx("span",{className:"text-white",children:T.frame||"2015"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Border Color"}),s.jsx("span",{className:"text-white capitalize",children:T.border_color||"Black"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Finishes"}),s.jsx("span",{className:"text-white capitalize",children:T.finishes?.join(", ")})]}),T.watermark&&s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Watermark"}),s.jsx("span",{className:"text-white capitalize",children:T.watermark})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Illustration ID"}),s.jsxs("span",{className:"text-gray-400 font-mono text-xs",children:[T.illustration_id?.slice(0,8),"..."]})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Developer / Metadata"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 space-y-2 text-sm font-mono",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"External Links"}),s.jsx("a",{href:T.scryfall_uri,target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"View on Scryfall"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Scryfall ID"}),s.jsx("span",{className:"text-gray-400",children:T.id})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Oracle ID"}),s.jsx("span",{className:"text-gray-400",children:T.oracle_id})]}),n.firestoreId&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Database ID"}),s.jsx("span",{className:"text-gray-400",children:n.firestoreId})]}),s.jsxs("div",{className:"border-t border-gray-800 pt-2 mt-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Released At"}),s.jsx("span",{className:"text-gray-300",children:T.released_at})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Reserved List"}),s.jsx("span",{className:T.reserved?"text-red-400":"text-gray-400",children:T.reserved?"true":"false"})]})]})]})]}),b&&s.jsxs("div",{className:"pt-6 mt-6 border-t border-gray-700 flex gap-4 animate-fade-in-up",children:[s.jsx("button",{onClick:()=>N(!1),className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg border border-gray-500 transition-all font-bold tracking-wide uppercase text-sm",children:"Cancel"}),s.jsx("button",{onClick:ue,className:"flex-1 bg-red-600/80 hover:bg-red-600 text-white py-3 rounded-lg shadow-md transition-all font-bold tracking-wide uppercase text-sm",children:"Delete Card"}),s.jsx("button",{onClick:V,className:"flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg shadow-lg shadow-green-900/20 transition-all font-bold tracking-wide uppercase text-sm",children:"Save Changes"})]})]})]})]})]})},Ek=({children:a})=>{const{currentUser:n,userProfile:i,loading:o}=vt(),d=zs(),h=us(),[g,p]=w.useState(!1);return w.useEffect(()=>{if(!n&&!o){p(!1);return}if(!(o||g)&&n&&i){const b=["/","/login","/about"].includes(d.pathname),N=d.pathname==="/onboarding";!i.settings?.onboarding_complete&&!N&&!b&&h("/onboarding"),p(!0)}},[n,i,o,d,h,g]),o?s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-indigo-500",children:"Loading..."}):a};function Tk(){return s.jsx(L_,{children:s.jsx(R_,{children:s.jsx(I_,{children:s.jsxs("div",{className:"bg-gray-900 text-gray-200 font-sans min-h-screen flex flex-col",children:[s.jsx(G_,{}),s.jsx(Ek,{children:s.jsx("div",{className:"flex-grow",children:s.jsxs(n1,{children:[s.jsx(on,{path:"/",element:s.jsx($_,{})}),s.jsx(on,{path:"/about",element:s.jsx(kk,{})}),s.jsx(on,{path:"/dashboard",element:s.jsx(W_,{})}),s.jsx(on,{path:"/login",element:s.jsx(q_,{})}),s.jsx(on,{path:"/onboarding",element:s.jsx(_k,{})}),s.jsx(on,{path:"/collection",element:s.jsx(Q_,{})}),s.jsx(on,{path:"/decks",element:s.jsx(ek,{})}),s.jsx(on,{path:"/decks/new",element:s.jsx(rk,{})}),s.jsx(on,{path:"/decks/:deckId",element:s.jsx(ck,{})}),s.jsx(on,{path:"/decks/:deckId/build",element:s.jsx(yk,{})}),s.jsx(on,{path:"/sets",element:s.jsx(uk,{})}),s.jsx(on,{path:"/sets/:setCode",element:s.jsx(hk,{})}),s.jsx(on,{path:"/wishlist",element:s.jsx(xk,{})}),s.jsx(on,{path:"/settings",element:s.jsx(mk,{})})]})})}),s.jsx(Sk,{}),s.jsx(Ck,{})]})})})})}a2.createRoot(document.getElementById("root")).render(s.jsx(Tn.StrictMode,{children:s.jsx(S1,{children:s.jsx(Tk,{})})}));
