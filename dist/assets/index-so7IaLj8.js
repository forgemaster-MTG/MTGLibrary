var Rq=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var T5e=Rq((pi,mi)=>{function Pq(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ms(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r1={exports:{}},sf={};var E3;function Iq(){if(E3)return sf;E3=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var d in i)d!=="key"&&(a[d]=i[d])}else a=i;return i=a.ref,{$$typeof:t,type:n,key:l,ref:i!==void 0?i:null,props:a}}return sf.Fragment=e,sf.jsx=r,sf.jsxs=r,sf}var A3;function Dq(){return A3||(A3=1,r1.exports=Iq()),r1.exports}var s=Dq(),n1={exports:{}},Ot={};var T3;function Bq(){if(T3)return Ot;T3=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),x=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=x&&F[x]||F["@@iterator"],typeof F=="function"?F:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,k={};function _(F,Y,ne){this.props=F,this.context=Y,this.refs=k,this.updater=ne||v}_.prototype.isReactComponent={},_.prototype.setState=function(F,Y){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Y,"setState")},_.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function T(){}T.prototype=_.prototype;function A(F,Y,ne){this.props=F,this.context=Y,this.refs=k,this.updater=ne||v}var I=A.prototype=new T;I.constructor=A,w(I,_.prototype),I.isPureReactComponent=!0;var O=Array.isArray;function M(){}var E={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function $(F,Y,ne){var re=ne.ref;return{$$typeof:t,type:F,key:Y,ref:re!==void 0?re:null,props:ne}}function B(F,Y){return $(F.type,Y,F.props)}function C(F){return typeof F=="object"&&F!==null&&F.$$typeof===t}function U(F){var Y={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(ne){return Y[ne]})}var L=/\/+/g;function q(F,Y){return typeof F=="object"&&F!==null&&F.key!=null?U(""+F.key):Y.toString(36)}function K(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(M,M):(F.status="pending",F.then(function(Y){F.status==="pending"&&(F.status="fulfilled",F.value=Y)},function(Y){F.status==="pending"&&(F.status="rejected",F.reason=Y)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function W(F,Y,ne,re,ue){var Le=typeof F;(Le==="undefined"||Le==="boolean")&&(F=null);var de=!1;if(F===null)de=!0;else switch(Le){case"bigint":case"string":case"number":de=!0;break;case"object":switch(F.$$typeof){case t:case e:de=!0;break;case p:return de=F._init,W(de(F._payload),Y,ne,re,ue)}}if(de)return ue=ue(F),de=re===""?"."+q(F,0):re,O(ue)?(ne="",de!=null&&(ne=de.replace(L,"$&/")+"/"),W(ue,Y,ne,"",function(ge){return ge})):ue!=null&&(C(ue)&&(ue=B(ue,ne+(ue.key==null||F&&F.key===ue.key?"":(""+ue.key).replace(L,"$&/")+"/")+de)),Y.push(ue)),1;de=0;var ve=re===""?".":re+":";if(O(F))for(var te=0;te<F.length;te++)re=F[te],Le=ve+q(re,te),de+=W(re,Y,ne,Le,ue);else if(te=b(F),typeof te=="function")for(F=te.call(F),te=0;!(re=F.next()).done;)re=re.value,Le=ve+q(re,te++),de+=W(re,Y,ne,Le,ue);else if(Le==="object"){if(typeof F.then=="function")return W(K(F),Y,ne,re,ue);throw Y=String(F),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return de}function V(F,Y,ne){if(F==null)return F;var re=[],ue=0;return W(F,re,"","",function(Le){return Y.call(ne,Le,ue++)}),re}function X(F){if(F._status===-1){var Y=F._result;Y=Y(),Y.then(function(ne){(F._status===0||F._status===-1)&&(F._status=1,F._result=ne)},function(ne){(F._status===0||F._status===-1)&&(F._status=2,F._result=ne)}),F._status===-1&&(F._status=0,F._result=Y)}if(F._status===1)return F._result.default;throw F._result}var Z=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},G={map:V,forEach:function(F,Y,ne){V(F,function(){Y.apply(this,arguments)},ne)},count:function(F){var Y=0;return V(F,function(){Y++}),Y},toArray:function(F){return V(F,function(Y){return Y})||[]},only:function(F){if(!C(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return Ot.Activity=m,Ot.Children=G,Ot.Component=_,Ot.Fragment=r,Ot.Profiler=i,Ot.PureComponent=A,Ot.StrictMode=n,Ot.Suspense=u,Ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,Ot.__COMPILER_RUNTIME={__proto__:null,c:function(F){return E.H.useMemoCache(F)}},Ot.cache=function(F){return function(){return F.apply(null,arguments)}},Ot.cacheSignal=function(){return null},Ot.cloneElement=function(F,Y,ne){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var re=w({},F.props),ue=F.key;if(Y!=null)for(Le in Y.key!==void 0&&(ue=""+Y.key),Y)!R.call(Y,Le)||Le==="key"||Le==="__self"||Le==="__source"||Le==="ref"&&Y.ref===void 0||(re[Le]=Y[Le]);var Le=arguments.length-2;if(Le===1)re.children=ne;else if(1<Le){for(var de=Array(Le),ve=0;ve<Le;ve++)de[ve]=arguments[ve+2];re.children=de}return $(F.type,ue,re)},Ot.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},Ot.createElement=function(F,Y,ne){var re,ue={},Le=null;if(Y!=null)for(re in Y.key!==void 0&&(Le=""+Y.key),Y)R.call(Y,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(ue[re]=Y[re]);var de=arguments.length-2;if(de===1)ue.children=ne;else if(1<de){for(var ve=Array(de),te=0;te<de;te++)ve[te]=arguments[te+2];ue.children=ve}if(F&&F.defaultProps)for(re in de=F.defaultProps,de)ue[re]===void 0&&(ue[re]=de[re]);return $(F,Le,ue)},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(F){return{$$typeof:d,render:F}},Ot.isValidElement=C,Ot.lazy=function(F){return{$$typeof:p,_payload:{_status:-1,_result:F},_init:X}},Ot.memo=function(F,Y){return{$$typeof:h,type:F,compare:Y===void 0?null:Y}},Ot.startTransition=function(F){var Y=E.T,ne={};E.T=ne;try{var re=F(),ue=E.S;ue!==null&&ue(ne,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(M,Z)}catch(Le){Z(Le)}finally{Y!==null&&ne.types!==null&&(Y.types=ne.types),E.T=Y}},Ot.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},Ot.use=function(F){return E.H.use(F)},Ot.useActionState=function(F,Y,ne){return E.H.useActionState(F,Y,ne)},Ot.useCallback=function(F,Y){return E.H.useCallback(F,Y)},Ot.useContext=function(F){return E.H.useContext(F)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(F,Y){return E.H.useDeferredValue(F,Y)},Ot.useEffect=function(F,Y){return E.H.useEffect(F,Y)},Ot.useEffectEvent=function(F){return E.H.useEffectEvent(F)},Ot.useId=function(){return E.H.useId()},Ot.useImperativeHandle=function(F,Y,ne){return E.H.useImperativeHandle(F,Y,ne)},Ot.useInsertionEffect=function(F,Y){return E.H.useInsertionEffect(F,Y)},Ot.useLayoutEffect=function(F,Y){return E.H.useLayoutEffect(F,Y)},Ot.useMemo=function(F,Y){return E.H.useMemo(F,Y)},Ot.useOptimistic=function(F,Y){return E.H.useOptimistic(F,Y)},Ot.useReducer=function(F,Y,ne){return E.H.useReducer(F,Y,ne)},Ot.useRef=function(F){return E.H.useRef(F)},Ot.useState=function(F){return E.H.useState(F)},Ot.useSyncExternalStore=function(F,Y,ne){return E.H.useSyncExternalStore(F,Y,ne)},Ot.useTransition=function(){return E.H.useTransition()},Ot.version="19.2.3",Ot}var O3;function al(){return O3||(O3=1,n1.exports=Bq()),n1.exports}var y=al();const Ge=Ms(y),$q=Pq({__proto__:null,default:Ge},[y]);var s1={exports:{}},af={},i1={exports:{}},a1={};var M3;function Uq(){return M3||(M3=1,(function(t){function e(W,V){var X=W.length;W.push(V);e:for(;0<X;){var Z=X-1>>>1,G=W[Z];if(0<i(G,V))W[Z]=V,W[X]=G,X=Z;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var V=W[0],X=W.pop();if(X!==V){W[0]=X;e:for(var Z=0,G=W.length,F=G>>>1;Z<F;){var Y=2*(Z+1)-1,ne=W[Y],re=Y+1,ue=W[re];if(0>i(ne,X))re<G&&0>i(ue,ne)?(W[Z]=ue,W[re]=X,Z=re):(W[Z]=ne,W[Y]=X,Z=Y);else if(re<G&&0>i(ue,X))W[Z]=ue,W[re]=X,Z=re;else break e}}return V}function i(W,V){var X=W.sortIndex-V.sortIndex;return X!==0?X:W.id-V.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();t.unstable_now=function(){return l.now()-d}}var u=[],h=[],p=1,m=null,x=3,b=!1,v=!1,w=!1,k=!1,_=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function I(W){for(var V=r(h);V!==null;){if(V.callback===null)n(h);else if(V.startTime<=W)n(h),V.sortIndex=V.expirationTime,e(u,V);else break;V=r(h)}}function O(W){if(w=!1,I(W),!v)if(r(u)!==null)v=!0,M||(M=!0,U());else{var V=r(h);V!==null&&K(O,V.startTime-W)}}var M=!1,E=-1,R=5,$=-1;function B(){return k?!0:!(t.unstable_now()-$<R)}function C(){if(k=!1,M){var W=t.unstable_now();$=W;var V=!0;try{e:{v=!1,w&&(w=!1,T(E),E=-1),b=!0;var X=x;try{t:{for(I(W),m=r(u);m!==null&&!(m.expirationTime>W&&B());){var Z=m.callback;if(typeof Z=="function"){m.callback=null,x=m.priorityLevel;var G=Z(m.expirationTime<=W);if(W=t.unstable_now(),typeof G=="function"){m.callback=G,I(W),V=!0;break t}m===r(u)&&n(u),I(W)}else n(u);m=r(u)}if(m!==null)V=!0;else{var F=r(h);F!==null&&K(O,F.startTime-W),V=!1}}break e}finally{m=null,x=X,b=!1}V=void 0}}finally{V?U():M=!1}}}var U;if(typeof A=="function")U=function(){A(C)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,q=L.port2;L.port1.onmessage=C,U=function(){q.postMessage(null)}}else U=function(){_(C,0)};function K(W,V){E=_(function(){W(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(W){switch(x){case 1:case 2:case 3:var V=3;break;default:V=x}var X=x;x=V;try{return W()}finally{x=X}},t.unstable_requestPaint=function(){k=!0},t.unstable_runWithPriority=function(W,V){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var X=x;x=W;try{return V()}finally{x=X}},t.unstable_scheduleCallback=function(W,V,X){var Z=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Z+X:Z):X=Z,W){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=X+G,W={id:p++,callback:V,priorityLevel:W,startTime:X,expirationTime:G,sortIndex:-1},X>Z?(W.sortIndex=X,e(h,W),r(u)===null&&W===r(h)&&(w?(T(E),E=-1):w=!0,K(O,X-Z))):(W.sortIndex=G,e(u,W),v||b||(v=!0,M||(M=!0,U()))),W},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(W){var V=x;return function(){var X=x;x=V;try{return W.apply(this,arguments)}finally{x=X}}}})(a1)),a1}var L3;function zq(){return L3||(L3=1,i1.exports=Uq()),i1.exports}var o1={exports:{}},hs={};var R3;function qq(){if(R3)return hs;R3=1;var t=al();function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,h,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:m==null?null:""+m,children:u,containerInfo:h,implementation:p}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return hs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,hs.createPortal=function(u,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(u,h,null,p)},hs.flushSync=function(u){var h=l.T,p=n.p;try{if(l.T=null,n.p=2,u)return u()}finally{l.T=h,n.p=p,n.d.f()}},hs.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(u,h))},hs.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},hs.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var p=h.as,m=d(p,h.crossOrigin),x=typeof h.integrity=="string"?h.integrity:void 0,b=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:m,integrity:x,fetchPriority:b}):p==="script"&&n.d.X(u,{crossOrigin:m,integrity:x,fetchPriority:b,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},hs.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=d(h.as,h.crossOrigin);n.d.M(u,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(u)},hs.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,m=d(p,h.crossOrigin);n.d.L(u,p,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},hs.preloadModule=function(u,h){if(typeof u=="string")if(h){var p=d(h.as,h.crossOrigin);n.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(u)},hs.requestFormReset=function(u){n.d.r(u)},hs.unstable_batchedUpdates=function(u,h){return u(h)},hs.useFormState=function(u,h,p){return l.H.useFormState(u,h,p)},hs.useFormStatus=function(){return l.H.useHostTransitionStatus()},hs.version="19.2.3",hs}var P3;function XL(){if(P3)return o1.exports;P3=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),o1.exports=qq(),o1.exports}var I3;function Fq(){if(I3)return af;I3=1;var t=zq(),e=al(),r=XL();function n(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function a(o){var c=o,f=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(f=c.return),o=c.return;while(o)}return c.tag===3?f:null}function l(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function d(o){if(o.tag===31){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function u(o){if(a(o)!==o)throw Error(n(188))}function h(o){var c=o.alternate;if(!c){if(c=a(o),c===null)throw Error(n(188));return c!==o?null:o}for(var f=o,g=c;;){var N=f.return;if(N===null)break;var S=N.alternate;if(S===null){if(g=N.return,g!==null){f=g;continue}break}if(N.child===S.child){for(S=N.child;S;){if(S===f)return u(N),o;if(S===g)return u(N),c;S=S.sibling}throw Error(n(188))}if(f.return!==g.return)f=N,g=S;else{for(var z=!1,J=N.child;J;){if(J===f){z=!0,f=N,g=S;break}if(J===g){z=!0,g=N,f=S;break}J=J.sibling}if(!z){for(J=S.child;J;){if(J===f){z=!0,f=S,g=N;break}if(J===g){z=!0,g=S,f=N;break}J=J.sibling}if(!z)throw Error(n(189))}}if(f.alternate!==g)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?o:c}function p(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=p(o),c!==null)return c;o=o.sibling}return null}var m=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function U(o){return o===null||typeof o!="object"?null:(o=C&&o[C]||o["@@iterator"],typeof o=="function"?o:null)}var L=Symbol.for("react.client.reference");function q(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===L?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case w:return"Fragment";case _:return"Profiler";case k:return"StrictMode";case O:return"Suspense";case M:return"SuspenseList";case $:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case v:return"Portal";case A:return o.displayName||"Context";case T:return(o._context.displayName||"Context")+".Consumer";case I:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case E:return c=o.displayName||null,c!==null?c:q(o.type)||"Memo";case R:c=o._payload,o=o._init;try{return q(o(c))}catch{}}return null}var K=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},Z=[],G=-1;function F(o){return{current:o}}function Y(o){0>G||(o.current=Z[G],Z[G]=null,G--)}function ne(o,c){G++,Z[G]=o.current,o.current=c}var re=F(null),ue=F(null),Le=F(null),de=F(null);function ve(o,c){switch(ne(Le,c),ne(ue,o),ne(re,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?JC(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=JC(c),o=QC(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Y(re),ne(re,o)}function te(){Y(re),Y(ue),Y(Le)}function ge(o){o.memoizedState!==null&&ne(de,o);var c=re.current,f=QC(c,o.type);c!==f&&(ne(ue,o),ne(re,f))}function ke(o){ue.current===o&&(Y(re),Y(ue)),de.current===o&&(Y(de),ef._currentValue=X)}var oe,Ee;function Te(o){if(oe===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);oe=c&&c[1]||"",Ee=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+oe+o+Ee}var Ye=!1;function ze(o,c){if(!o||Ye)return"";Ye=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(c){var Ue=function(){throw Error()};if(Object.defineProperty(Ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ue,[])}catch(Ae){var Ne=Ae}Reflect.construct(o,[],Ue)}else{try{Ue.call()}catch(Ae){Ne=Ae}o.call(Ue.prototype)}}else{try{throw Error()}catch(Ae){Ne=Ae}(Ue=o())&&typeof Ue.catch=="function"&&Ue.catch(function(){})}}catch(Ae){if(Ae&&Ne&&typeof Ae.stack=="string")return[Ae.stack,Ne.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=g.DetermineComponentFrameRoot(),z=S[0],J=S[1];if(z&&J){var ie=z.split(`
`),be=J.split(`
`);for(N=g=0;g<ie.length&&!ie[g].includes("DetermineComponentFrameRoot");)g++;for(;N<be.length&&!be[N].includes("DetermineComponentFrameRoot");)N++;if(g===ie.length||N===be.length)for(g=ie.length-1,N=be.length-1;1<=g&&0<=N&&ie[g]!==be[N];)N--;for(;1<=g&&0<=N;g--,N--)if(ie[g]!==be[N]){if(g!==1||N!==1)do if(g--,N--,0>N||ie[g]!==be[N]){var Me=`
`+ie[g].replace(" at new "," at ");return o.displayName&&Me.includes("<anonymous>")&&(Me=Me.replace("<anonymous>",o.displayName)),Me}while(1<=g&&0<=N);break}}}finally{Ye=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?Te(f):""}function le(o,c){switch(o.tag){case 26:case 27:case 5:return Te(o.type);case 16:return Te("Lazy");case 13:return o.child!==c&&c!==null?Te("Suspense Fallback"):Te("Suspense");case 19:return Te("SuspenseList");case 0:case 15:return ze(o.type,!1);case 11:return ze(o.type.render,!1);case 1:return ze(o.type,!0);case 31:return Te("Activity");default:return""}}function pe(o){try{var c="",f=null;do c+=le(o,f),f=o,o=o.return;while(o);return c}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var me=Object.prototype.hasOwnProperty,Ie=t.unstable_scheduleCallback,Fe=t.unstable_cancelCallback,qe=t.unstable_shouldYield,Xe=t.unstable_requestPaint,He=t.unstable_now,ut=t.unstable_getCurrentPriorityLevel,Tt=t.unstable_ImmediatePriority,Ut=t.unstable_UserBlockingPriority,nt=t.unstable_NormalPriority,kt=t.unstable_LowPriority,mt=t.unstable_IdlePriority,Re=t.log,it=t.unstable_setDisableYieldValue,jt=null,yt=null;function Et(o){if(typeof Re=="function"&&it(o),yt&&typeof yt.setStrictMode=="function")try{yt.setStrictMode(jt,o)}catch{}}var ot=Math.clz32?Math.clz32:Qe,ae=Math.log,Be=Math.LN2;function Qe(o){return o>>>=0,o===0?32:31-(ae(o)/Be|0)|0}var et=256,bt=262144,Ve=4194304;function Je(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function pt(o,c,f){var g=o.pendingLanes;if(g===0)return 0;var N=0,S=o.suspendedLanes,z=o.pingedLanes;o=o.warmLanes;var J=g&134217727;return J!==0?(g=J&~S,g!==0?N=Je(g):(z&=J,z!==0?N=Je(z):f||(f=J&~o,f!==0&&(N=Je(f))))):(J=g&~S,J!==0?N=Je(J):z!==0?N=Je(z):f||(f=g&~o,f!==0&&(N=Je(f)))),N===0?0:c!==0&&c!==N&&(c&S)===0&&(S=N&-N,f=c&-c,S>=f||S===32&&(f&4194048)!==0)?c:N}function he(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function We(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vt(){var o=Ve;return Ve<<=1,(Ve&62914560)===0&&(Ve=4194304),o}function At(o){for(var c=[],f=0;31>f;f++)c.push(o);return c}function Jt(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function wr(o,c,f,g,N,S){var z=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var J=o.entanglements,ie=o.expirationTimes,be=o.hiddenUpdates;for(f=z&~f;0<f;){var Me=31-ot(f),Ue=1<<Me;J[Me]=0,ie[Me]=-1;var Ne=be[Me];if(Ne!==null)for(be[Me]=null,Me=0;Me<Ne.length;Me++){var Ae=Ne[Me];Ae!==null&&(Ae.lane&=-536870913)}f&=~Ue}g!==0&&Mn(o,g,0),S!==0&&N===0&&o.tag!==0&&(o.suspendedLanes|=S&~(z&~c))}function Mn(o,c,f){o.pendingLanes|=c,o.suspendedLanes&=~c;var g=31-ot(c);o.entangledLanes|=c,o.entanglements[g]=o.entanglements[g]|1073741824|f&261930}function ys(o,c){var f=o.entangledLanes|=c;for(o=o.entanglements;f;){var g=31-ot(f),N=1<<g;N&c|o[g]&c&&(o[g]|=c),f&=~N}}function Xs(o,c){var f=c&-c;return f=(f&42)!==0?1:je(f),(f&(o.suspendedLanes|c))!==0?0:f}function je(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Ce(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Oe(){var o=V.p;return o!==0?o:(o=window.event,o===void 0?32:w3(o.type))}function Ze(o,c){var f=V.p;try{return V.p=o,c()}finally{V.p=f}}var wt=Math.random().toString(36).slice(2),Lt="__reactFiber$"+wt,lr="__reactProps$"+wt,Ln="__reactContainer$"+wt,Qt="__reactEvents$"+wt,Sc="__reactListeners$"+wt,vl="__reactHandles$"+wt,wl="__reactResources$"+wt,Ls="__reactMarker$"+wt;function Oa(o){delete o[Lt],delete o[lr],delete o[Qt],delete o[Sc],delete o[vl]}function Mr(o){var c=o[Lt];if(c)return c;for(var f=o.parentNode;f;){if(c=f[Ln]||f[Lt]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(o=i3(o);o!==null;){if(f=o[Lt])return f;o=i3(o)}return c}o=f,f=o.parentNode}return null}function is(o){if(o=o[Lt]||o[Ln]){var c=o.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return o}return null}function Fn(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(n(33))}function Rs(o){var c=o[wl];return c||(c=o[wl]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Ur(o){o[Ls]=!0}var uo=new Set,wi={};function bs(o,c){Hn(o,c),Hn(o+"Capture",c)}function Hn(o,c){for(wi[o]=c,o=0;o<c.length;o++)uo.add(c[o])}var as=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zi={},ho={};function jl(o){return me.call(ho,o)?!0:me.call(Zi,o)?!1:as.test(o)?ho[o]=!0:(Zi[o]=!0,!1)}function Ma(o,c,f){if(jl(c))if(f===null)o.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var g=c.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+f)}}function Wn(o,c,f){if(f===null)o.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+f)}}function zr(o,c,f,g){if(g===null)o.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(c,f,""+g)}}function Lr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ps(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Js(o,c,f){var g=Object.getOwnPropertyDescriptor(o.constructor.prototype,c);if(!o.hasOwnProperty(c)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var N=g.get,S=g.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return N.call(this)},set:function(z){f=""+z,S.call(this,z)}}),Object.defineProperty(o,c,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(z){f=""+z},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Zt(o){if(!o._valueTracker){var c=Ps(o)?"checked":"value";o._valueTracker=Js(o,c,""+o[c])}}function ji(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var f=c.getValue(),g="";return o&&(g=Ps(o)?o.checked?"true":"false":o.value),o=g,o!==f?(c.setValue(o),!0):!1}function Is(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var ea=/[\n"\\]/g;function Rn(o){return o.replace(ea,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function La(o,c,f,g,N,S,z,J){o.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?o.type=z:o.removeAttribute("type"),c!=null?z==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+Lr(c)):o.value!==""+Lr(c)&&(o.value=""+Lr(c)):z!=="submit"&&z!=="reset"||o.removeAttribute("value"),c!=null?fo(o,z,Lr(c)):f!=null?fo(o,z,Lr(f)):g!=null&&o.removeAttribute("value"),N==null&&S!=null&&(o.defaultChecked=!!S),N!=null&&(o.checked=N&&typeof N!="function"&&typeof N!="symbol"),J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"?o.name=""+Lr(J):o.removeAttribute("name")}function Ra(o,c,f,g,N,S,z,J){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(o.type=S),c!=null||f!=null){if(!(S!=="submit"&&S!=="reset"||c!=null)){Zt(o);return}f=f!=null?""+Lr(f):"",c=c!=null?""+Lr(c):f,J||c===o.value||(o.value=c),o.defaultValue=c}g=g??N,g=typeof g!="function"&&typeof g!="symbol"&&!!g,o.checked=J?o.checked:!!g,o.defaultChecked=!!g,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(o.name=z),Zt(o)}function fo(o,c,f){c==="number"&&Is(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function Ni(o,c,f,g){if(o=o.options,c){c={};for(var N=0;N<f.length;N++)c["$"+f[N]]=!0;for(f=0;f<o.length;f++)N=c.hasOwnProperty("$"+o[f].value),o[f].selected!==N&&(o[f].selected=N),N&&g&&(o[f].defaultSelected=!0)}else{for(f=""+Lr(f),c=null,N=0;N<o.length;N++){if(o[N].value===f){o[N].selected=!0,g&&(o[N].defaultSelected=!0);return}c!==null||o[N].disabled||(c=o[N])}c!==null&&(c.selected=!0)}}function ki(o,c,f){if(c!=null&&(c=""+Lr(c),c!==o.value&&(o.value=c),f==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=f!=null?""+Lr(f):""}function mn(o,c,f,g){if(c==null){if(g!=null){if(f!=null)throw Error(n(92));if(K(g)){if(1<g.length)throw Error(n(93));g=g[0]}f=g}f==null&&(f=""),c=f}f=Lr(c),o.defaultValue=f,g=o.textContent,g===f&&g!==""&&g!==null&&(o.value=g),Zt(o)}function qr(o,c){if(c){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=c;return}}o.textContent=c}var Ds=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function po(o,c,f){var g=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":g?o.setProperty(c,f):typeof f!="number"||f===0||Ds.has(c)?c==="float"?o.cssFloat=f:o[c]=(""+f).trim():o[c]=f+"px"}function os(o,c,f){if(c!=null&&typeof c!="object")throw Error(n(62));if(o=o.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||c!=null&&c.hasOwnProperty(g)||(g.indexOf("--")===0?o.setProperty(g,""):g==="float"?o.cssFloat="":o[g]="");for(var N in c)g=c[N],c.hasOwnProperty(N)&&f[N]!==g&&po(o,N,g)}else for(var S in c)c.hasOwnProperty(S)&&po(o,S,c[S])}function Pa(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Si=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ia(o){return Si.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function ls(){}var cn=null;function Gn(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Qs=null,Vn=null;function Zs(o){var c=is(o);if(c&&(o=c.stateNode)){var f=o[lr]||null;e:switch(o=c.stateNode,c.type){case"input":if(La(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Rn(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var g=f[c];if(g!==o&&g.form===o.form){var N=g[lr]||null;if(!N)throw Error(n(90));La(g,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<f.length;c++)g=f[c],g.form===o.form&&ji(g)}break e;case"textarea":ki(o,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&Ni(o,!!f.multiple,c,!1)}}}var ei=!1;function _i(o,c,f){if(ei)return o(c,f);ei=!0;try{var g=o(c);return g}finally{if(ei=!1,(Qs!==null||Vn!==null)&&(Qp(),Qs&&(c=Qs,o=Vn,Vn=Qs=null,Zs(c),o)))for(c=0;c<o.length;c++)Zs(o[c])}}function cs(o,c){var f=o.stateNode;if(f===null)return null;var g=f[lr]||null;if(g===null)return null;f=g[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(n(231,c,typeof f));return f}var Pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ci=!1;if(Pn)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Ci=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch{Ci=!1}var vs=null,ta=null,ra=null;function mo(){if(ra)return ra;var o,c=ta,f=c.length,g,N="value"in vs?vs.value:vs.textContent,S=N.length;for(o=0;o<f&&c[o]===N[o];o++);var z=f-o;for(g=1;g<=z&&c[f-g]===N[S-g];g++);return ra=N.slice(o,1<g?1-g:void 0)}function D(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Q(){return!0}function se(){return!1}function Se(o){function c(f,g,N,S,z){this._reactName=f,this._targetInst=N,this.type=g,this.nativeEvent=S,this.target=z,this.currentTarget=null;for(var J in o)o.hasOwnProperty(J)&&(f=o[J],this[J]=f?f(S):S[J]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Q:se,this.isPropagationStopped=se,this}return m(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Q)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Q)},persist:function(){},isPersistent:Q}),c}var Nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rt=Se(Nt),It=m({},Nt,{view:0,detail:0}),$t=Se(It),dr,Ft,jr,dn=m({},It,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ds,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==jr&&(jr&&o.type==="mousemove"?(dr=o.screenX-jr.screenX,Ft=o.screenY-jr.screenY):Ft=dr=0,jr=o),dr)},movementY:function(o){return"movementY"in o?o.movementY:Ft}}),Rr=Se(dn),Fr=m({},dn,{dataTransfer:0}),Zr=Se(Fr),ti=m({},It,{relatedTarget:0}),Kn=Se(ti),ri=m({},Nt,{animationName:0,elapsedTime:0,pseudoElement:0}),_c=Se(ri),na=m({},Nt,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),go=Se(na),dp=m({},Nt,{data:0}),Da=Se(dp),up={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pp(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=fp[o])?!!c[o]:!1}function ds(){return pp}var mp=m({},It,{key:function(o){if(o.key){var c=up[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=D(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?hp[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ds,charCode:function(o){return o.type==="keypress"?D(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?D(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),gp=Se(mp),kl=m({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j=Se(kl),P=m({},It,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ds}),H=Se(P),ee=m({},Nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),xe=Se(ee),_e=m({},dn,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Ke=Se(_e),Rt=m({},Nt,{newState:0,oldState:0}),un=Se(Rt),ur=[9,13,27,32],en=Pn&&"CompositionEvent"in window,us=null;Pn&&"documentMode"in document&&(us=document.documentMode);var xo=Pn&&"TextEvent"in window&&!us,sa=Pn&&(!en||us&&8<us&&11>=us),ia=" ",Cc=!1;function zd(o,c){switch(o){case"keyup":return ur.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oS(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var qd=!1;function sz(o,c){switch(o){case"compositionend":return oS(c);case"keypress":return c.which!==32?null:(Cc=!0,ia);case"textInput":return o=c.data,o===ia&&Cc?null:o;default:return null}}function iz(o,c){if(qd)return o==="compositionend"||!en&&zd(o,c)?(o=mo(),ra=ta=vs=null,qd=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return sa&&c.locale!=="ko"?null:c.data;default:return null}}var az={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lS(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!az[o.type]:c==="textarea"}function cS(o,c,f,g){Qs?Vn?Vn.push(g):Vn=[g]:Qs=g,c=im(c,"onChange"),0<c.length&&(f=new rt("onChange","change",null,f,g),o.push({event:f,listeners:c}))}var jh=null,Nh=null;function oz(o){WC(o,0)}function xp(o){var c=Fn(o);if(ji(c))return o}function dS(o,c){if(o==="change")return c}var uS=!1;if(Pn){var cb;if(Pn){var db="oninput"in document;if(!db){var hS=document.createElement("div");hS.setAttribute("oninput","return;"),db=typeof hS.oninput=="function"}cb=db}else cb=!1;uS=cb&&(!document.documentMode||9<document.documentMode)}function fS(){jh&&(jh.detachEvent("onpropertychange",pS),Nh=jh=null)}function pS(o){if(o.propertyName==="value"&&xp(Nh)){var c=[];cS(c,Nh,o,Gn(o)),_i(oz,c)}}function lz(o,c,f){o==="focusin"?(fS(),jh=c,Nh=f,jh.attachEvent("onpropertychange",pS)):o==="focusout"&&fS()}function cz(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return xp(Nh)}function dz(o,c){if(o==="click")return xp(c)}function uz(o,c){if(o==="input"||o==="change")return xp(c)}function hz(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var ni=typeof Object.is=="function"?Object.is:hz;function kh(o,c){if(ni(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var f=Object.keys(o),g=Object.keys(c);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var N=f[g];if(!me.call(c,N)||!ni(o[N],c[N]))return!1}return!0}function mS(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function gS(o,c){var f=mS(o);o=0;for(var g;f;){if(f.nodeType===3){if(g=o+f.textContent.length,o<=c&&g>=c)return{node:f,offset:c-o};o=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=mS(f)}}function xS(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?xS(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function yS(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=Is(o.document);c instanceof o.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)o=c.contentWindow;else break;c=Is(o.document)}return c}function ub(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var fz=Pn&&"documentMode"in document&&11>=document.documentMode,Fd=null,hb=null,Sh=null,fb=!1;function bS(o,c,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;fb||Fd==null||Fd!==Is(g)||(g=Fd,"selectionStart"in g&&ub(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Sh&&kh(Sh,g)||(Sh=g,g=im(hb,"onSelect"),0<g.length&&(c=new rt("onSelect","select",null,c,f),o.push({event:c,listeners:g}),c.target=Fd)))}function Ec(o,c){var f={};return f[o.toLowerCase()]=c.toLowerCase(),f["Webkit"+o]="webkit"+c,f["Moz"+o]="moz"+c,f}var Hd={animationend:Ec("Animation","AnimationEnd"),animationiteration:Ec("Animation","AnimationIteration"),animationstart:Ec("Animation","AnimationStart"),transitionrun:Ec("Transition","TransitionRun"),transitionstart:Ec("Transition","TransitionStart"),transitioncancel:Ec("Transition","TransitionCancel"),transitionend:Ec("Transition","TransitionEnd")},pb={},vS={};Pn&&(vS=document.createElement("div").style,"AnimationEvent"in window||(delete Hd.animationend.animation,delete Hd.animationiteration.animation,delete Hd.animationstart.animation),"TransitionEvent"in window||delete Hd.transitionend.transition);function Ac(o){if(pb[o])return pb[o];if(!Hd[o])return o;var c=Hd[o],f;for(f in c)if(c.hasOwnProperty(f)&&f in vS)return pb[o]=c[f];return o}var wS=Ac("animationend"),jS=Ac("animationiteration"),NS=Ac("animationstart"),pz=Ac("transitionrun"),mz=Ac("transitionstart"),gz=Ac("transitioncancel"),kS=Ac("transitionend"),SS=new Map,mb="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mb.push("scrollEnd");function aa(o,c){SS.set(o,c),bs(c,[o])}var yp=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},Ei=[],Wd=0,gb=0;function bp(){for(var o=Wd,c=gb=Wd=0;c<o;){var f=Ei[c];Ei[c++]=null;var g=Ei[c];Ei[c++]=null;var N=Ei[c];Ei[c++]=null;var S=Ei[c];if(Ei[c++]=null,g!==null&&N!==null){var z=g.pending;z===null?N.next=N:(N.next=z.next,z.next=N),g.pending=N}S!==0&&_S(f,N,S)}}function vp(o,c,f,g){Ei[Wd++]=o,Ei[Wd++]=c,Ei[Wd++]=f,Ei[Wd++]=g,gb|=g,o.lanes|=g,o=o.alternate,o!==null&&(o.lanes|=g)}function xb(o,c,f,g){return vp(o,c,f,g),wp(o)}function Tc(o,c){return vp(o,null,null,c),wp(o)}function _S(o,c,f){o.lanes|=f;var g=o.alternate;g!==null&&(g.lanes|=f);for(var N=!1,S=o.return;S!==null;)S.childLanes|=f,g=S.alternate,g!==null&&(g.childLanes|=f),S.tag===22&&(o=S.stateNode,o===null||o._visibility&1||(N=!0)),o=S,S=S.return;return o.tag===3?(S=o.stateNode,N&&c!==null&&(N=31-ot(f),o=S.hiddenUpdates,g=o[N],g===null?o[N]=[c]:g.push(c),c.lane=f|536870912),S):null}function wp(o){if(50<Vh)throw Vh=0,_v=null,Error(n(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var Gd={};function xz(o,c,f,g){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(o,c,f,g){return new xz(o,c,f,g)}function yb(o){return o=o.prototype,!(!o||!o.isReactComponent)}function yo(o,c){var f=o.alternate;return f===null?(f=si(o.tag,c,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=c,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,c=o.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function CS(o,c){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,c=f.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function jp(o,c,f,g,N,S){var z=0;if(g=o,typeof o=="function")yb(o)&&(z=1);else if(typeof o=="string")z=jq(o,f,re.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case $:return o=si(31,f,c,N),o.elementType=$,o.lanes=S,o;case w:return Oc(f.children,N,S,c);case k:z=8,N|=24;break;case _:return o=si(12,f,c,N|2),o.elementType=_,o.lanes=S,o;case O:return o=si(13,f,c,N),o.elementType=O,o.lanes=S,o;case M:return o=si(19,f,c,N),o.elementType=M,o.lanes=S,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case A:z=10;break e;case T:z=9;break e;case I:z=11;break e;case E:z=14;break e;case R:z=16,g=null;break e}z=29,f=Error(n(130,o===null?"null":typeof o,"")),g=null}return c=si(z,f,c,N),c.elementType=o,c.type=g,c.lanes=S,c}function Oc(o,c,f,g){return o=si(7,o,g,c),o.lanes=f,o}function bb(o,c,f){return o=si(6,o,null,c),o.lanes=f,o}function ES(o){var c=si(18,null,null,0);return c.stateNode=o,c}function vb(o,c,f){return c=si(4,o.children!==null?o.children:[],o.key,c),c.lanes=f,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var AS=new WeakMap;function Ai(o,c){if(typeof o=="object"&&o!==null){var f=AS.get(o);return f!==void 0?f:(c={value:o,source:c,stack:pe(c)},AS.set(o,c),c)}return{value:o,source:c,stack:pe(c)}}var Vd=[],Kd=0,Np=null,_h=0,Ti=[],Oi=0,Sl=null,Ba=1,$a="";function bo(o,c){Vd[Kd++]=_h,Vd[Kd++]=Np,Np=o,_h=c}function TS(o,c,f){Ti[Oi++]=Ba,Ti[Oi++]=$a,Ti[Oi++]=Sl,Sl=o;var g=Ba;o=$a;var N=32-ot(g)-1;g&=~(1<<N),f+=1;var S=32-ot(c)+N;if(30<S){var z=N-N%5;S=(g&(1<<z)-1).toString(32),g>>=z,N-=z,Ba=1<<32-ot(c)+N|f<<N|g,$a=S+o}else Ba=1<<S|f<<N|g,$a=o}function wb(o){o.return!==null&&(bo(o,1),TS(o,1,0))}function jb(o){for(;o===Np;)Np=Vd[--Kd],Vd[Kd]=null,_h=Vd[--Kd],Vd[Kd]=null;for(;o===Sl;)Sl=Ti[--Oi],Ti[Oi]=null,$a=Ti[--Oi],Ti[Oi]=null,Ba=Ti[--Oi],Ti[Oi]=null}function OS(o,c){Ti[Oi++]=Ba,Ti[Oi++]=$a,Ti[Oi++]=Sl,Ba=c.id,$a=c.overflow,Sl=o}var Yn=null,Pr=null,Xt=!1,_l=null,Mi=!1,Nb=Error(n(519));function Cl(o){var c=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ch(Ai(c,o)),Nb}function MS(o){var c=o.stateNode,f=o.type,g=o.memoizedProps;switch(c[Lt]=o,c[lr]=g,f){case"dialog":Wt("cancel",c),Wt("close",c);break;case"iframe":case"object":case"embed":Wt("load",c);break;case"video":case"audio":for(f=0;f<Yh.length;f++)Wt(Yh[f],c);break;case"source":Wt("error",c);break;case"img":case"image":case"link":Wt("error",c),Wt("load",c);break;case"details":Wt("toggle",c);break;case"input":Wt("invalid",c),Ra(c,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Wt("invalid",c);break;case"textarea":Wt("invalid",c),mn(c,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||g.suppressHydrationWarning===!0||YC(c.textContent,f)?(g.popover!=null&&(Wt("beforetoggle",c),Wt("toggle",c)),g.onScroll!=null&&Wt("scroll",c),g.onScrollEnd!=null&&Wt("scrollend",c),g.onClick!=null&&(c.onclick=ls),c=!0):c=!1,c||Cl(o,!0)}function LS(o){for(Yn=o.return;Yn;)switch(Yn.tag){case 5:case 31:case 13:Mi=!1;return;case 27:case 3:Mi=!0;return;default:Yn=Yn.return}}function Yd(o){if(o!==Yn)return!1;if(!Xt)return LS(o),Xt=!0,!1;var c=o.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||zv(o.type,o.memoizedProps)),f=!f),f&&Pr&&Cl(o),LS(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));Pr=s3(o)}else if(c===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));Pr=s3(o)}else c===27?(c=Pr,zl(o.type)?(o=Gv,Gv=null,Pr=o):Pr=c):Pr=Yn?Ri(o.stateNode.nextSibling):null;return!0}function Mc(){Pr=Yn=null,Xt=!1}function kb(){var o=_l;return o!==null&&(zs===null?zs=o:zs.push.apply(zs,o),_l=null),o}function Ch(o){_l===null?_l=[o]:_l.push(o)}var Sb=F(null),Lc=null,vo=null;function El(o,c,f){ne(Sb,c._currentValue),c._currentValue=f}function wo(o){o._currentValue=Sb.current,Y(Sb)}function _b(o,c,f){for(;o!==null;){var g=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),o===f)break;o=o.return}}function Cb(o,c,f,g){var N=o.child;for(N!==null&&(N.return=o);N!==null;){var S=N.dependencies;if(S!==null){var z=N.child;S=S.firstContext;e:for(;S!==null;){var J=S;S=N;for(var ie=0;ie<c.length;ie++)if(J.context===c[ie]){S.lanes|=f,J=S.alternate,J!==null&&(J.lanes|=f),_b(S.return,f,o),g||(z=null);break e}S=J.next}}else if(N.tag===18){if(z=N.return,z===null)throw Error(n(341));z.lanes|=f,S=z.alternate,S!==null&&(S.lanes|=f),_b(z,f,o),z=null}else z=N.child;if(z!==null)z.return=N;else for(z=N;z!==null;){if(z===o){z=null;break}if(N=z.sibling,N!==null){N.return=z.return,z=N;break}z=z.return}N=z}}function Xd(o,c,f,g){o=null;for(var N=c,S=!1;N!==null;){if(!S){if((N.flags&524288)!==0)S=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var z=N.alternate;if(z===null)throw Error(n(387));if(z=z.memoizedProps,z!==null){var J=N.type;ni(N.pendingProps.value,z.value)||(o!==null?o.push(J):o=[J])}}else if(N===de.current){if(z=N.alternate,z===null)throw Error(n(387));z.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(o!==null?o.push(ef):o=[ef])}N=N.return}o!==null&&Cb(c,o,f,g),c.flags|=262144}function kp(o){for(o=o.firstContext;o!==null;){if(!ni(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Rc(o){Lc=o,vo=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Xn(o){return RS(Lc,o)}function Sp(o,c){return Lc===null&&Rc(o),RS(o,c)}function RS(o,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},vo===null){if(o===null)throw Error(n(308));vo=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else vo=vo.next=c;return f}var yz=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(f,g){o.push(g)}};this.abort=function(){c.aborted=!0,o.forEach(function(f){return f()})}},bz=t.unstable_scheduleCallback,vz=t.unstable_NormalPriority,gn={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Eb(){return{controller:new yz,data:new Map,refCount:0}}function Eh(o){o.refCount--,o.refCount===0&&bz(vz,function(){o.controller.abort()})}var Ah=null,Ab=0,Jd=0,Qd=null;function wz(o,c){if(Ah===null){var f=Ah=[];Ab=0,Jd=Mv(),Qd={status:"pending",value:void 0,then:function(g){f.push(g)}}}return Ab++,c.then(PS,PS),c}function PS(){if(--Ab===0&&Ah!==null){Qd!==null&&(Qd.status="fulfilled");var o=Ah;Ah=null,Jd=0,Qd=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function jz(o,c){var f=[],g={status:"pending",value:null,reason:null,then:function(N){f.push(N)}};return o.then(function(){g.status="fulfilled",g.value=c;for(var N=0;N<f.length;N++)(0,f[N])(c)},function(N){for(g.status="rejected",g.reason=N,N=0;N<f.length;N++)(0,f[N])(void 0)}),g}var IS=W.S;W.S=function(o,c){bC=He(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&wz(o,c),IS!==null&&IS(o,c)};var Pc=F(null);function Tb(){var o=Pc.current;return o!==null?o:Nr.pooledCache}function _p(o,c){c===null?ne(Pc,Pc.current):ne(Pc,c.pool)}function DS(){var o=Tb();return o===null?null:{parent:gn._currentValue,pool:o}}var Zd=Error(n(460)),Ob=Error(n(474)),Cp=Error(n(542)),Ep={then:function(){}};function BS(o){return o=o.status,o==="fulfilled"||o==="rejected"}function $S(o,c,f){switch(f=o[f],f===void 0?o.push(c):f!==c&&(c.then(ls,ls),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,zS(o),o;default:if(typeof c.status=="string")c.then(ls,ls);else{if(o=Nr,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=c,o.status="pending",o.then(function(g){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=g}},function(g){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=g}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,zS(o),o}throw Dc=c,Zd}}function Ic(o){try{var c=o._init;return c(o._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Dc=f,Zd):f}}var Dc=null;function US(){if(Dc===null)throw Error(n(459));var o=Dc;return Dc=null,o}function zS(o){if(o===Zd||o===Cp)throw Error(n(483))}var eu=null,Th=0;function Ap(o){var c=Th;return Th+=1,eu===null&&(eu=[]),$S(eu,o,c)}function Oh(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function Tp(o,c){throw c.$$typeof===x?Error(n(525)):(o=Object.prototype.toString.call(c),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function qS(o){function c(fe,ce){if(o){var ye=fe.deletions;ye===null?(fe.deletions=[ce],fe.flags|=16):ye.push(ce)}}function f(fe,ce){if(!o)return null;for(;ce!==null;)c(fe,ce),ce=ce.sibling;return null}function g(fe){for(var ce=new Map;fe!==null;)fe.key!==null?ce.set(fe.key,fe):ce.set(fe.index,fe),fe=fe.sibling;return ce}function N(fe,ce){return fe=yo(fe,ce),fe.index=0,fe.sibling=null,fe}function S(fe,ce,ye){return fe.index=ye,o?(ye=fe.alternate,ye!==null?(ye=ye.index,ye<ce?(fe.flags|=67108866,ce):ye):(fe.flags|=67108866,ce)):(fe.flags|=1048576,ce)}function z(fe){return o&&fe.alternate===null&&(fe.flags|=67108866),fe}function J(fe,ce,ye,De){return ce===null||ce.tag!==6?(ce=bb(ye,fe.mode,De),ce.return=fe,ce):(ce=N(ce,ye),ce.return=fe,ce)}function ie(fe,ce,ye,De){var xt=ye.type;return xt===w?Me(fe,ce,ye.props.children,De,ye.key):ce!==null&&(ce.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===R&&Ic(xt)===ce.type)?(ce=N(ce,ye.props),Oh(ce,ye),ce.return=fe,ce):(ce=jp(ye.type,ye.key,ye.props,null,fe.mode,De),Oh(ce,ye),ce.return=fe,ce)}function be(fe,ce,ye,De){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ye.containerInfo||ce.stateNode.implementation!==ye.implementation?(ce=vb(ye,fe.mode,De),ce.return=fe,ce):(ce=N(ce,ye.children||[]),ce.return=fe,ce)}function Me(fe,ce,ye,De,xt){return ce===null||ce.tag!==7?(ce=Oc(ye,fe.mode,De,xt),ce.return=fe,ce):(ce=N(ce,ye),ce.return=fe,ce)}function Ue(fe,ce,ye){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=bb(""+ce,fe.mode,ye),ce.return=fe,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return ye=jp(ce.type,ce.key,ce.props,null,fe.mode,ye),Oh(ye,ce),ye.return=fe,ye;case v:return ce=vb(ce,fe.mode,ye),ce.return=fe,ce;case R:return ce=Ic(ce),Ue(fe,ce,ye)}if(K(ce)||U(ce))return ce=Oc(ce,fe.mode,ye,null),ce.return=fe,ce;if(typeof ce.then=="function")return Ue(fe,Ap(ce),ye);if(ce.$$typeof===A)return Ue(fe,Sp(fe,ce),ye);Tp(fe,ce)}return null}function Ne(fe,ce,ye,De){var xt=ce!==null?ce.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return xt!==null?null:J(fe,ce,""+ye,De);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return ye.key===xt?ie(fe,ce,ye,De):null;case v:return ye.key===xt?be(fe,ce,ye,De):null;case R:return ye=Ic(ye),Ne(fe,ce,ye,De)}if(K(ye)||U(ye))return xt!==null?null:Me(fe,ce,ye,De,null);if(typeof ye.then=="function")return Ne(fe,ce,Ap(ye),De);if(ye.$$typeof===A)return Ne(fe,ce,Sp(fe,ye),De);Tp(fe,ye)}return null}function Ae(fe,ce,ye,De,xt){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return fe=fe.get(ye)||null,J(ce,fe,""+De,xt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case b:return fe=fe.get(De.key===null?ye:De.key)||null,ie(ce,fe,De,xt);case v:return fe=fe.get(De.key===null?ye:De.key)||null,be(ce,fe,De,xt);case R:return De=Ic(De),Ae(fe,ce,ye,De,xt)}if(K(De)||U(De))return fe=fe.get(ye)||null,Me(ce,fe,De,xt,null);if(typeof De.then=="function")return Ae(fe,ce,ye,Ap(De),xt);if(De.$$typeof===A)return Ae(fe,ce,ye,Sp(ce,De),xt);Tp(ce,De)}return null}function at(fe,ce,ye,De){for(var xt=null,nr=null,ct=ce,Dt=ce=0,Kt=null;ct!==null&&Dt<ye.length;Dt++){ct.index>Dt?(Kt=ct,ct=null):Kt=ct.sibling;var sr=Ne(fe,ct,ye[Dt],De);if(sr===null){ct===null&&(ct=Kt);break}o&&ct&&sr.alternate===null&&c(fe,ct),ce=S(sr,ce,Dt),nr===null?xt=sr:nr.sibling=sr,nr=sr,ct=Kt}if(Dt===ye.length)return f(fe,ct),Xt&&bo(fe,Dt),xt;if(ct===null){for(;Dt<ye.length;Dt++)ct=Ue(fe,ye[Dt],De),ct!==null&&(ce=S(ct,ce,Dt),nr===null?xt=ct:nr.sibling=ct,nr=ct);return Xt&&bo(fe,Dt),xt}for(ct=g(ct);Dt<ye.length;Dt++)Kt=Ae(ct,fe,Dt,ye[Dt],De),Kt!==null&&(o&&Kt.alternate!==null&&ct.delete(Kt.key===null?Dt:Kt.key),ce=S(Kt,ce,Dt),nr===null?xt=Kt:nr.sibling=Kt,nr=Kt);return o&&ct.forEach(function(Gl){return c(fe,Gl)}),Xt&&bo(fe,Dt),xt}function St(fe,ce,ye,De){if(ye==null)throw Error(n(151));for(var xt=null,nr=null,ct=ce,Dt=ce=0,Kt=null,sr=ye.next();ct!==null&&!sr.done;Dt++,sr=ye.next()){ct.index>Dt?(Kt=ct,ct=null):Kt=ct.sibling;var Gl=Ne(fe,ct,sr.value,De);if(Gl===null){ct===null&&(ct=Kt);break}o&&ct&&Gl.alternate===null&&c(fe,ct),ce=S(Gl,ce,Dt),nr===null?xt=Gl:nr.sibling=Gl,nr=Gl,ct=Kt}if(sr.done)return f(fe,ct),Xt&&bo(fe,Dt),xt;if(ct===null){for(;!sr.done;Dt++,sr=ye.next())sr=Ue(fe,sr.value,De),sr!==null&&(ce=S(sr,ce,Dt),nr===null?xt=sr:nr.sibling=sr,nr=sr);return Xt&&bo(fe,Dt),xt}for(ct=g(ct);!sr.done;Dt++,sr=ye.next())sr=Ae(ct,fe,Dt,sr.value,De),sr!==null&&(o&&sr.alternate!==null&&ct.delete(sr.key===null?Dt:sr.key),ce=S(sr,ce,Dt),nr===null?xt=sr:nr.sibling=sr,nr=sr);return o&&ct.forEach(function(Lq){return c(fe,Lq)}),Xt&&bo(fe,Dt),xt}function br(fe,ce,ye,De){if(typeof ye=="object"&&ye!==null&&ye.type===w&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:e:{for(var xt=ye.key;ce!==null;){if(ce.key===xt){if(xt=ye.type,xt===w){if(ce.tag===7){f(fe,ce.sibling),De=N(ce,ye.props.children),De.return=fe,fe=De;break e}}else if(ce.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===R&&Ic(xt)===ce.type){f(fe,ce.sibling),De=N(ce,ye.props),Oh(De,ye),De.return=fe,fe=De;break e}f(fe,ce);break}else c(fe,ce);ce=ce.sibling}ye.type===w?(De=Oc(ye.props.children,fe.mode,De,ye.key),De.return=fe,fe=De):(De=jp(ye.type,ye.key,ye.props,null,fe.mode,De),Oh(De,ye),De.return=fe,fe=De)}return z(fe);case v:e:{for(xt=ye.key;ce!==null;){if(ce.key===xt)if(ce.tag===4&&ce.stateNode.containerInfo===ye.containerInfo&&ce.stateNode.implementation===ye.implementation){f(fe,ce.sibling),De=N(ce,ye.children||[]),De.return=fe,fe=De;break e}else{f(fe,ce);break}else c(fe,ce);ce=ce.sibling}De=vb(ye,fe.mode,De),De.return=fe,fe=De}return z(fe);case R:return ye=Ic(ye),br(fe,ce,ye,De)}if(K(ye))return at(fe,ce,ye,De);if(U(ye)){if(xt=U(ye),typeof xt!="function")throw Error(n(150));return ye=xt.call(ye),St(fe,ce,ye,De)}if(typeof ye.then=="function")return br(fe,ce,Ap(ye),De);if(ye.$$typeof===A)return br(fe,ce,Sp(fe,ye),De);Tp(fe,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint"?(ye=""+ye,ce!==null&&ce.tag===6?(f(fe,ce.sibling),De=N(ce,ye),De.return=fe,fe=De):(f(fe,ce),De=bb(ye,fe.mode,De),De.return=fe,fe=De),z(fe)):f(fe,ce)}return function(fe,ce,ye,De){try{Th=0;var xt=br(fe,ce,ye,De);return eu=null,xt}catch(ct){if(ct===Zd||ct===Cp)throw ct;var nr=si(29,ct,null,fe.mode);return nr.lanes=De,nr.return=fe,nr}}}var Bc=qS(!0),FS=qS(!1),Al=!1;function Mb(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Lb(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Tl(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Ol(o,c,f){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(or&2)!==0){var N=g.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),g.pending=c,c=wp(o),_S(o,null,f),c}return vp(o,g,c,f),wp(o)}function Mh(o,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var g=c.lanes;g&=o.pendingLanes,f|=g,c.lanes=f,ys(o,f)}}function Rb(o,c){var f=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var N=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var z={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};S===null?N=S=z:S=S.next=z,f=f.next}while(f!==null);S===null?N=S=c:S=S.next=c}else N=S=c;f={baseState:g.baseState,firstBaseUpdate:N,lastBaseUpdate:S,shared:g.shared,callbacks:g.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=c}var Pb=!1;function Lh(){if(Pb){var o=Qd;if(o!==null)throw o}}function Rh(o,c,f,g){Pb=!1;var N=o.updateQueue;Al=!1;var S=N.firstBaseUpdate,z=N.lastBaseUpdate,J=N.shared.pending;if(J!==null){N.shared.pending=null;var ie=J,be=ie.next;ie.next=null,z===null?S=be:z.next=be,z=ie;var Me=o.alternate;Me!==null&&(Me=Me.updateQueue,J=Me.lastBaseUpdate,J!==z&&(J===null?Me.firstBaseUpdate=be:J.next=be,Me.lastBaseUpdate=ie))}if(S!==null){var Ue=N.baseState;z=0,Me=be=ie=null,J=S;do{var Ne=J.lane&-536870913,Ae=Ne!==J.lane;if(Ae?(Vt&Ne)===Ne:(g&Ne)===Ne){Ne!==0&&Ne===Jd&&(Pb=!0),Me!==null&&(Me=Me.next={lane:0,tag:J.tag,payload:J.payload,callback:null,next:null});e:{var at=o,St=J;Ne=c;var br=f;switch(St.tag){case 1:if(at=St.payload,typeof at=="function"){Ue=at.call(br,Ue,Ne);break e}Ue=at;break e;case 3:at.flags=at.flags&-65537|128;case 0:if(at=St.payload,Ne=typeof at=="function"?at.call(br,Ue,Ne):at,Ne==null)break e;Ue=m({},Ue,Ne);break e;case 2:Al=!0}}Ne=J.callback,Ne!==null&&(o.flags|=64,Ae&&(o.flags|=8192),Ae=N.callbacks,Ae===null?N.callbacks=[Ne]:Ae.push(Ne))}else Ae={lane:Ne,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Me===null?(be=Me=Ae,ie=Ue):Me=Me.next=Ae,z|=Ne;if(J=J.next,J===null){if(J=N.shared.pending,J===null)break;Ae=J,J=Ae.next,Ae.next=null,N.lastBaseUpdate=Ae,N.shared.pending=null}}while(!0);Me===null&&(ie=Ue),N.baseState=ie,N.firstBaseUpdate=be,N.lastBaseUpdate=Me,S===null&&(N.shared.lanes=0),Il|=z,o.lanes=z,o.memoizedState=Ue}}function HS(o,c){if(typeof o!="function")throw Error(n(191,o));o.call(c)}function WS(o,c){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)HS(f[o],c)}var tu=F(null),Op=F(0);function GS(o,c){o=To,ne(Op,o),ne(tu,c),To=o|c.baseLanes}function Ib(){ne(Op,To),ne(tu,tu.current)}function Db(){To=Op.current,Y(tu),Y(Op)}var ii=F(null),Li=null;function Ml(o){var c=o.alternate;ne(hn,hn.current&1),ne(ii,o),Li===null&&(c===null||tu.current!==null||c.memoizedState!==null)&&(Li=o)}function Bb(o){ne(hn,hn.current),ne(ii,o),Li===null&&(Li=o)}function VS(o){o.tag===22?(ne(hn,hn.current),ne(ii,o),Li===null&&(Li=o)):Ll()}function Ll(){ne(hn,hn.current),ne(ii,ii.current)}function ai(o){Y(ii),Li===o&&(Li=null),Y(hn)}var hn=F(0);function Mp(o){for(var c=o;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Hv(f)||Wv(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var jo=0,Pt=null,xr=null,xn=null,Lp=!1,ru=!1,$c=!1,Rp=0,Ph=0,nu=null,Nz=0;function tn(){throw Error(n(321))}function $b(o,c){if(c===null)return!1;for(var f=0;f<c.length&&f<o.length;f++)if(!ni(o[f],c[f]))return!1;return!0}function Ub(o,c,f,g,N,S){return jo=S,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,W.H=o===null||o.memoizedState===null?T_:tv,$c=!1,S=f(g,N),$c=!1,ru&&(S=YS(c,f,g,N)),KS(o),S}function KS(o){W.H=Bh;var c=xr!==null&&xr.next!==null;if(jo=0,xn=xr=Pt=null,Lp=!1,Ph=0,nu=null,c)throw Error(n(300));o===null||yn||(o=o.dependencies,o!==null&&kp(o)&&(yn=!0))}function YS(o,c,f,g){Pt=o;var N=0;do{if(ru&&(nu=null),Ph=0,ru=!1,25<=N)throw Error(n(301));if(N+=1,xn=xr=null,o.updateQueue!=null){var S=o.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}W.H=O_,S=c(f,g)}while(ru);return S}function kz(){var o=W.H,c=o.useState()[0];return c=typeof c.then=="function"?Ih(c):c,o=o.useState()[0],(xr!==null?xr.memoizedState:null)!==o&&(Pt.flags|=1024),c}function zb(){var o=Rp!==0;return Rp=0,o}function qb(o,c,f){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~f}function Fb(o){if(Lp){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Lp=!1}jo=0,xn=xr=Pt=null,ru=!1,Ph=Rp=0,nu=null}function ws(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?Pt.memoizedState=xn=o:xn=xn.next=o,xn}function fn(){if(xr===null){var o=Pt.alternate;o=o!==null?o.memoizedState:null}else o=xr.next;var c=xn===null?Pt.memoizedState:xn.next;if(c!==null)xn=c,xr=o;else{if(o===null)throw Pt.alternate===null?Error(n(467)):Error(n(310));xr=o,o={memoizedState:xr.memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},xn===null?Pt.memoizedState=xn=o:xn=xn.next=o}return xn}function Pp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ih(o){var c=Ph;return Ph+=1,nu===null&&(nu=[]),o=$S(nu,o,c),c=Pt,(xn===null?c.memoizedState:xn.next)===null&&(c=c.alternate,W.H=c===null||c.memoizedState===null?T_:tv),o}function Ip(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Ih(o);if(o.$$typeof===A)return Xn(o)}throw Error(n(438,String(o)))}function Hb(o){var c=null,f=Pt.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var g=Pt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(c={data:g.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=Pp(),Pt.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(o),g=0;g<o;g++)f[g]=B;return c.index++,f}function No(o,c){return typeof c=="function"?c(o):c}function Dp(o){var c=fn();return Wb(c,xr,o)}function Wb(o,c,f){var g=o.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=f;var N=o.baseQueue,S=g.pending;if(S!==null){if(N!==null){var z=N.next;N.next=S.next,S.next=z}c.baseQueue=N=S,g.pending=null}if(S=o.baseState,N===null)o.memoizedState=S;else{c=N.next;var J=z=null,ie=null,be=c,Me=!1;do{var Ue=be.lane&-536870913;if(Ue!==be.lane?(Vt&Ue)===Ue:(jo&Ue)===Ue){var Ne=be.revertLane;if(Ne===0)ie!==null&&(ie=ie.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Ue===Jd&&(Me=!0);else if((jo&Ne)===Ne){be=be.next,Ne===Jd&&(Me=!0);continue}else Ue={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},ie===null?(J=ie=Ue,z=S):ie=ie.next=Ue,Pt.lanes|=Ne,Il|=Ne;Ue=be.action,$c&&f(S,Ue),S=be.hasEagerState?be.eagerState:f(S,Ue)}else Ne={lane:Ue,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},ie===null?(J=ie=Ne,z=S):ie=ie.next=Ne,Pt.lanes|=Ue,Il|=Ue;be=be.next}while(be!==null&&be!==c);if(ie===null?z=S:ie.next=J,!ni(S,o.memoizedState)&&(yn=!0,Me&&(f=Qd,f!==null)))throw f;o.memoizedState=S,o.baseState=z,o.baseQueue=ie,g.lastRenderedState=S}return N===null&&(g.lanes=0),[o.memoizedState,g.dispatch]}function Gb(o){var c=fn(),f=c.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=o;var g=f.dispatch,N=f.pending,S=c.memoizedState;if(N!==null){f.pending=null;var z=N=N.next;do S=o(S,z.action),z=z.next;while(z!==N);ni(S,c.memoizedState)||(yn=!0),c.memoizedState=S,c.baseQueue===null&&(c.baseState=S),f.lastRenderedState=S}return[S,g]}function XS(o,c,f){var g=Pt,N=fn(),S=Xt;if(S){if(f===void 0)throw Error(n(407));f=f()}else f=c();var z=!ni((xr||N).memoizedState,f);if(z&&(N.memoizedState=f,yn=!0),N=N.queue,Yb(ZS.bind(null,g,N,o),[o]),N.getSnapshot!==c||z||xn!==null&&xn.memoizedState.tag&1){if(g.flags|=2048,su(9,{destroy:void 0},QS.bind(null,g,N,f,c),null),Nr===null)throw Error(n(349));S||(jo&127)!==0||JS(g,c,f)}return f}function JS(o,c,f){o.flags|=16384,o={getSnapshot:c,value:f},c=Pt.updateQueue,c===null?(c=Pp(),Pt.updateQueue=c,c.stores=[o]):(f=c.stores,f===null?c.stores=[o]:f.push(o))}function QS(o,c,f,g){c.value=f,c.getSnapshot=g,e_(c)&&t_(o)}function ZS(o,c,f){return f(function(){e_(c)&&t_(o)})}function e_(o){var c=o.getSnapshot;o=o.value;try{var f=c();return!ni(o,f)}catch{return!0}}function t_(o){var c=Tc(o,2);c!==null&&qs(c,o,2)}function Vb(o){var c=ws();if(typeof o=="function"){var f=o;if(o=f(),$c){Et(!0);try{f()}finally{Et(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:o},c}function r_(o,c,f,g){return o.baseState=f,Wb(o,xr,typeof g=="function"?g:No)}function Sz(o,c,f,g,N){if(Up(o))throw Error(n(485));if(o=c.action,o!==null){var S={payload:N,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){S.listeners.push(z)}};W.T!==null?f(!0):S.isTransition=!1,g(S),f=c.pending,f===null?(S.next=c.pending=S,n_(c,S)):(S.next=f.next,c.pending=f.next=S)}}function n_(o,c){var f=c.action,g=c.payload,N=o.state;if(c.isTransition){var S=W.T,z={};W.T=z;try{var J=f(N,g),ie=W.S;ie!==null&&ie(z,J),s_(o,c,J)}catch(be){Kb(o,c,be)}finally{S!==null&&z.types!==null&&(S.types=z.types),W.T=S}}else try{S=f(N,g),s_(o,c,S)}catch(be){Kb(o,c,be)}}function s_(o,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){i_(o,c,g)},function(g){return Kb(o,c,g)}):i_(o,c,f)}function i_(o,c,f){c.status="fulfilled",c.value=f,a_(c),o.state=f,c=o.pending,c!==null&&(f=c.next,f===c?o.pending=null:(f=f.next,c.next=f,n_(o,f)))}function Kb(o,c,f){var g=o.pending;if(o.pending=null,g!==null){g=g.next;do c.status="rejected",c.reason=f,a_(c),c=c.next;while(c!==g)}o.action=null}function a_(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function o_(o,c){return c}function l_(o,c){if(Xt){var f=Nr.formState;if(f!==null){e:{var g=Pt;if(Xt){if(Pr){t:{for(var N=Pr,S=Mi;N.nodeType!==8;){if(!S){N=null;break t}if(N=Ri(N.nextSibling),N===null){N=null;break t}}S=N.data,N=S==="F!"||S==="F"?N:null}if(N){Pr=Ri(N.nextSibling),g=N.data==="F!";break e}}Cl(g)}g=!1}g&&(c=f[0])}}return f=ws(),f.memoizedState=f.baseState=c,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o_,lastRenderedState:c},f.queue=g,f=C_.bind(null,Pt,g),g.dispatch=f,g=Vb(!1),S=ev.bind(null,Pt,!1,g.queue),g=ws(),N={state:c,dispatch:null,action:o,pending:null},g.queue=N,f=Sz.bind(null,Pt,N,S,f),N.dispatch=f,g.memoizedState=o,[c,f,!1]}function c_(o){var c=fn();return d_(c,xr,o)}function d_(o,c,f){if(c=Wb(o,c,o_)[0],o=Dp(No)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var g=Ih(c)}catch(z){throw z===Zd?Cp:z}else g=c;c=fn();var N=c.queue,S=N.dispatch;return f!==c.memoizedState&&(Pt.flags|=2048,su(9,{destroy:void 0},_z.bind(null,N,f),null)),[g,S,o]}function _z(o,c){o.action=c}function u_(o){var c=fn(),f=xr;if(f!==null)return d_(c,f,o);fn(),c=c.memoizedState,f=fn();var g=f.queue.dispatch;return f.memoizedState=o,[c,g,!1]}function su(o,c,f,g){return o={tag:o,create:f,deps:g,inst:c,next:null},c=Pt.updateQueue,c===null&&(c=Pp(),Pt.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=o.next=o:(g=f.next,f.next=o,o.next=g,c.lastEffect=o),o}function h_(){return fn().memoizedState}function Bp(o,c,f,g){var N=ws();Pt.flags|=o,N.memoizedState=su(1|c,{destroy:void 0},f,g===void 0?null:g)}function $p(o,c,f,g){var N=fn();g=g===void 0?null:g;var S=N.memoizedState.inst;xr!==null&&g!==null&&$b(g,xr.memoizedState.deps)?N.memoizedState=su(c,S,f,g):(Pt.flags|=o,N.memoizedState=su(1|c,S,f,g))}function f_(o,c){Bp(8390656,8,o,c)}function Yb(o,c){$p(2048,8,o,c)}function Cz(o){Pt.flags|=4;var c=Pt.updateQueue;if(c===null)c=Pp(),Pt.updateQueue=c,c.events=[o];else{var f=c.events;f===null?c.events=[o]:f.push(o)}}function p_(o){var c=fn().memoizedState;return Cz({ref:c,nextImpl:o}),function(){if((or&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}function m_(o,c){return $p(4,2,o,c)}function g_(o,c){return $p(4,4,o,c)}function x_(o,c){if(typeof c=="function"){o=o();var f=c(o);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function y_(o,c,f){f=f!=null?f.concat([o]):null,$p(4,4,x_.bind(null,c,o),f)}function Xb(){}function b_(o,c){var f=fn();c=c===void 0?null:c;var g=f.memoizedState;return c!==null&&$b(c,g[1])?g[0]:(f.memoizedState=[o,c],o)}function v_(o,c){var f=fn();c=c===void 0?null:c;var g=f.memoizedState;if(c!==null&&$b(c,g[1]))return g[0];if(g=o(),$c){Et(!0);try{o()}finally{Et(!1)}}return f.memoizedState=[g,c],g}function Jb(o,c,f){return f===void 0||(jo&1073741824)!==0&&(Vt&261930)===0?o.memoizedState=c:(o.memoizedState=f,o=wC(),Pt.lanes|=o,Il|=o,f)}function w_(o,c,f,g){return ni(f,c)?f:tu.current!==null?(o=Jb(o,f,g),ni(o,c)||(yn=!0),o):(jo&42)===0||(jo&1073741824)!==0&&(Vt&261930)===0?(yn=!0,o.memoizedState=f):(o=wC(),Pt.lanes|=o,Il|=o,c)}function j_(o,c,f,g,N){var S=V.p;V.p=S!==0&&8>S?S:8;var z=W.T,J={};W.T=J,ev(o,!1,c,f);try{var ie=N(),be=W.S;if(be!==null&&be(J,ie),ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var Me=jz(ie,g);Dh(o,c,Me,ci(o))}else Dh(o,c,g,ci(o))}catch(Ue){Dh(o,c,{then:function(){},status:"rejected",reason:Ue},ci())}finally{V.p=S,z!==null&&J.types!==null&&(z.types=J.types),W.T=z}}function Ez(){}function Qb(o,c,f,g){if(o.tag!==5)throw Error(n(476));var N=N_(o).queue;j_(o,N,c,X,f===null?Ez:function(){return k_(o),f(g)})}function N_(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:X},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:f},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function k_(o){var c=N_(o);c.next===null&&(c=o.alternate.memoizedState),Dh(o,c.next.queue,{},ci())}function Zb(){return Xn(ef)}function S_(){return fn().memoizedState}function __(){return fn().memoizedState}function Az(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var f=ci();o=Tl(f);var g=Ol(c,o,f);g!==null&&(qs(g,c,f),Mh(g,c,f)),c={cache:Eb()},o.payload=c;return}c=c.return}}function Tz(o,c,f){var g=ci();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Up(o)?E_(c,f):(f=xb(o,c,f,g),f!==null&&(qs(f,o,g),A_(f,c,g)))}function C_(o,c,f){var g=ci();Dh(o,c,f,g)}function Dh(o,c,f,g){var N={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Up(o))E_(c,N);else{var S=o.alternate;if(o.lanes===0&&(S===null||S.lanes===0)&&(S=c.lastRenderedReducer,S!==null))try{var z=c.lastRenderedState,J=S(z,f);if(N.hasEagerState=!0,N.eagerState=J,ni(J,z))return vp(o,c,N,0),Nr===null&&bp(),!1}catch{}if(f=xb(o,c,N,g),f!==null)return qs(f,o,g),A_(f,c,g),!0}return!1}function ev(o,c,f,g){if(g={lane:2,revertLane:Mv(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Up(o)){if(c)throw Error(n(479))}else c=xb(o,f,g,2),c!==null&&qs(c,o,2)}function Up(o){var c=o.alternate;return o===Pt||c!==null&&c===Pt}function E_(o,c){ru=Lp=!0;var f=o.pending;f===null?c.next=c:(c.next=f.next,f.next=c),o.pending=c}function A_(o,c,f){if((f&4194048)!==0){var g=c.lanes;g&=o.pendingLanes,f|=g,c.lanes=f,ys(o,f)}}var Bh={readContext:Xn,use:Ip,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn};Bh.useEffectEvent=tn;var T_={readContext:Xn,use:Ip,useCallback:function(o,c){return ws().memoizedState=[o,c===void 0?null:c],o},useContext:Xn,useEffect:f_,useImperativeHandle:function(o,c,f){f=f!=null?f.concat([o]):null,Bp(4194308,4,x_.bind(null,c,o),f)},useLayoutEffect:function(o,c){return Bp(4194308,4,o,c)},useInsertionEffect:function(o,c){Bp(4,2,o,c)},useMemo:function(o,c){var f=ws();c=c===void 0?null:c;var g=o();if($c){Et(!0);try{o()}finally{Et(!1)}}return f.memoizedState=[g,c],g},useReducer:function(o,c,f){var g=ws();if(f!==void 0){var N=f(c);if($c){Et(!0);try{f(c)}finally{Et(!1)}}}else N=c;return g.memoizedState=g.baseState=N,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:N},g.queue=o,o=o.dispatch=Tz.bind(null,Pt,o),[g.memoizedState,o]},useRef:function(o){var c=ws();return o={current:o},c.memoizedState=o},useState:function(o){o=Vb(o);var c=o.queue,f=C_.bind(null,Pt,c);return c.dispatch=f,[o.memoizedState,f]},useDebugValue:Xb,useDeferredValue:function(o,c){var f=ws();return Jb(f,o,c)},useTransition:function(){var o=Vb(!1);return o=j_.bind(null,Pt,o.queue,!0,!1),ws().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,f){var g=Pt,N=ws();if(Xt){if(f===void 0)throw Error(n(407));f=f()}else{if(f=c(),Nr===null)throw Error(n(349));(Vt&127)!==0||JS(g,c,f)}N.memoizedState=f;var S={value:f,getSnapshot:c};return N.queue=S,f_(ZS.bind(null,g,S,o),[o]),g.flags|=2048,su(9,{destroy:void 0},QS.bind(null,g,S,f,c),null),f},useId:function(){var o=ws(),c=Nr.identifierPrefix;if(Xt){var f=$a,g=Ba;f=(g&~(1<<32-ot(g)-1)).toString(32)+f,c="_"+c+"R_"+f,f=Rp++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=Nz++,c="_"+c+"r_"+f.toString(32)+"_";return o.memoizedState=c},useHostTransitionStatus:Zb,useFormState:l_,useActionState:l_,useOptimistic:function(o){var c=ws();c.memoizedState=c.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=ev.bind(null,Pt,!0,f),f.dispatch=c,[o,c]},useMemoCache:Hb,useCacheRefresh:function(){return ws().memoizedState=Az.bind(null,Pt)},useEffectEvent:function(o){var c=ws(),f={impl:o};return c.memoizedState=f,function(){if((or&2)!==0)throw Error(n(440));return f.impl.apply(void 0,arguments)}}},tv={readContext:Xn,use:Ip,useCallback:b_,useContext:Xn,useEffect:Yb,useImperativeHandle:y_,useInsertionEffect:m_,useLayoutEffect:g_,useMemo:v_,useReducer:Dp,useRef:h_,useState:function(){return Dp(No)},useDebugValue:Xb,useDeferredValue:function(o,c){var f=fn();return w_(f,xr.memoizedState,o,c)},useTransition:function(){var o=Dp(No)[0],c=fn().memoizedState;return[typeof o=="boolean"?o:Ih(o),c]},useSyncExternalStore:XS,useId:S_,useHostTransitionStatus:Zb,useFormState:c_,useActionState:c_,useOptimistic:function(o,c){var f=fn();return r_(f,xr,o,c)},useMemoCache:Hb,useCacheRefresh:__};tv.useEffectEvent=p_;var O_={readContext:Xn,use:Ip,useCallback:b_,useContext:Xn,useEffect:Yb,useImperativeHandle:y_,useInsertionEffect:m_,useLayoutEffect:g_,useMemo:v_,useReducer:Gb,useRef:h_,useState:function(){return Gb(No)},useDebugValue:Xb,useDeferredValue:function(o,c){var f=fn();return xr===null?Jb(f,o,c):w_(f,xr.memoizedState,o,c)},useTransition:function(){var o=Gb(No)[0],c=fn().memoizedState;return[typeof o=="boolean"?o:Ih(o),c]},useSyncExternalStore:XS,useId:S_,useHostTransitionStatus:Zb,useFormState:u_,useActionState:u_,useOptimistic:function(o,c){var f=fn();return xr!==null?r_(f,xr,o,c):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:Hb,useCacheRefresh:__};O_.useEffectEvent=p_;function rv(o,c,f,g){c=o.memoizedState,f=f(g,c),f=f==null?c:m({},c,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var nv={enqueueSetState:function(o,c,f){o=o._reactInternals;var g=ci(),N=Tl(g);N.payload=c,f!=null&&(N.callback=f),c=Ol(o,N,g),c!==null&&(qs(c,o,g),Mh(c,o,g))},enqueueReplaceState:function(o,c,f){o=o._reactInternals;var g=ci(),N=Tl(g);N.tag=1,N.payload=c,f!=null&&(N.callback=f),c=Ol(o,N,g),c!==null&&(qs(c,o,g),Mh(c,o,g))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var f=ci(),g=Tl(f);g.tag=2,c!=null&&(g.callback=c),c=Ol(o,g,f),c!==null&&(qs(c,o,f),Mh(c,o,f))}};function M_(o,c,f,g,N,S,z){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,S,z):c.prototype&&c.prototype.isPureReactComponent?!kh(f,g)||!kh(N,S):!0}function L_(o,c,f,g){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,g),c.state!==o&&nv.enqueueReplaceState(c,c.state,null)}function Uc(o,c){var f=c;if("ref"in c){f={};for(var g in c)g!=="ref"&&(f[g]=c[g])}if(o=o.defaultProps){f===c&&(f=m({},f));for(var N in o)f[N]===void 0&&(f[N]=o[N])}return f}function R_(o){yp(o)}function P_(o){console.error(o)}function I_(o){yp(o)}function zp(o,c){try{var f=o.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(g){setTimeout(function(){throw g})}}function D_(o,c,f){try{var g=o.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function sv(o,c,f){return f=Tl(f),f.tag=3,f.payload={element:null},f.callback=function(){zp(o,c)},f}function B_(o){return o=Tl(o),o.tag=3,o}function $_(o,c,f,g){var N=f.type.getDerivedStateFromError;if(typeof N=="function"){var S=g.value;o.payload=function(){return N(S)},o.callback=function(){D_(c,f,g)}}var z=f.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(o.callback=function(){D_(c,f,g),typeof N!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var J=g.stack;this.componentDidCatch(g.value,{componentStack:J!==null?J:""})})}function Oz(o,c,f,g,N){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(c=f.alternate,c!==null&&Xd(c,f,N,!0),f=ii.current,f!==null){switch(f.tag){case 31:case 13:return Li===null?Zp():f.alternate===null&&rn===0&&(rn=3),f.flags&=-257,f.flags|=65536,f.lanes=N,g===Ep?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([g]):c.add(g),Av(o,g,N)),!1;case 22:return f.flags|=65536,g===Ep?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([g]):f.add(g)),Av(o,g,N)),!1}throw Error(n(435,f.tag))}return Av(o,g,N),Zp(),!1}if(Xt)return c=ii.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,g!==Nb&&(o=Error(n(422),{cause:g}),Ch(Ai(o,f)))):(g!==Nb&&(c=Error(n(423),{cause:g}),Ch(Ai(c,f))),o=o.current.alternate,o.flags|=65536,N&=-N,o.lanes|=N,g=Ai(g,f),N=sv(o.stateNode,g,N),Rb(o,N),rn!==4&&(rn=2)),!1;var S=Error(n(520),{cause:g});if(S=Ai(S,f),Gh===null?Gh=[S]:Gh.push(S),rn!==4&&(rn=2),c===null)return!0;g=Ai(g,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,o=N&-N,f.lanes|=o,o=sv(f.stateNode,g,o),Rb(f,o),!1;case 1:if(c=f.type,S=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Dl===null||!Dl.has(S))))return f.flags|=65536,N&=-N,f.lanes|=N,N=B_(N),$_(N,o,f,g),Rb(f,N),!1}f=f.return}while(f!==null);return!1}var iv=Error(n(461)),yn=!1;function Jn(o,c,f,g){c.child=o===null?FS(c,null,f,g):Bc(c,o.child,f,g)}function U_(o,c,f,g,N){f=f.render;var S=c.ref;if("ref"in g){var z={};for(var J in g)J!=="ref"&&(z[J]=g[J])}else z=g;return Rc(c),g=Ub(o,c,f,z,S,N),J=zb(),o!==null&&!yn?(qb(o,c,N),ko(o,c,N)):(Xt&&J&&wb(c),c.flags|=1,Jn(o,c,g,N),c.child)}function z_(o,c,f,g,N){if(o===null){var S=f.type;return typeof S=="function"&&!yb(S)&&S.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=S,q_(o,c,S,g,N)):(o=jp(f.type,null,g,c,c.mode,N),o.ref=c.ref,o.return=c,c.child=o)}if(S=o.child,!fv(o,N)){var z=S.memoizedProps;if(f=f.compare,f=f!==null?f:kh,f(z,g)&&o.ref===c.ref)return ko(o,c,N)}return c.flags|=1,o=yo(S,g),o.ref=c.ref,o.return=c,c.child=o}function q_(o,c,f,g,N){if(o!==null){var S=o.memoizedProps;if(kh(S,g)&&o.ref===c.ref)if(yn=!1,c.pendingProps=g=S,fv(o,N))(o.flags&131072)!==0&&(yn=!0);else return c.lanes=o.lanes,ko(o,c,N)}return av(o,c,f,g,N)}function F_(o,c,f,g){var N=g.children,S=o!==null?o.memoizedState:null;if(o===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((c.flags&128)!==0){if(S=S!==null?S.baseLanes|f:f,o!==null){for(g=c.child=o.child,N=0;g!==null;)N=N|g.lanes|g.childLanes,g=g.sibling;g=N&~S}else g=0,c.child=null;return H_(o,c,S,f,g)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&_p(c,S!==null?S.cachePool:null),S!==null?GS(c,S):Ib(),VS(c);else return g=c.lanes=536870912,H_(o,c,S!==null?S.baseLanes|f:f,f,g)}else S!==null?(_p(c,S.cachePool),GS(c,S),Ll(),c.memoizedState=null):(o!==null&&_p(c,null),Ib(),Ll());return Jn(o,c,N,f),c.child}function $h(o,c){return o!==null&&o.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function H_(o,c,f,g,N){var S=Tb();return S=S===null?null:{parent:gn._currentValue,pool:S},c.memoizedState={baseLanes:f,cachePool:S},o!==null&&_p(c,null),Ib(),VS(c),o!==null&&Xd(o,c,g,!0),c.childLanes=N,null}function qp(o,c){return c=Hp({mode:c.mode,children:c.children},o.mode),c.ref=o.ref,o.child=c,c.return=o,c}function W_(o,c,f){return Bc(c,o.child,null,f),o=qp(c,c.pendingProps),o.flags|=2,ai(c),c.memoizedState=null,o}function Mz(o,c,f){var g=c.pendingProps,N=(c.flags&128)!==0;if(c.flags&=-129,o===null){if(Xt){if(g.mode==="hidden")return o=qp(c,g),c.lanes=536870912,$h(null,o);if(Bb(c),(o=Pr)?(o=n3(o,Mi),o=o!==null&&o.data==="&"?o:null,o!==null&&(c.memoizedState={dehydrated:o,treeContext:Sl!==null?{id:Ba,overflow:$a}:null,retryLane:536870912,hydrationErrors:null},f=ES(o),f.return=c,c.child=f,Yn=c,Pr=null)):o=null,o===null)throw Cl(c);return c.lanes=536870912,null}return qp(c,g)}var S=o.memoizedState;if(S!==null){var z=S.dehydrated;if(Bb(c),N)if(c.flags&256)c.flags&=-257,c=W_(o,c,f);else if(c.memoizedState!==null)c.child=o.child,c.flags|=128,c=null;else throw Error(n(558));else if(yn||Xd(o,c,f,!1),N=(f&o.childLanes)!==0,yn||N){if(g=Nr,g!==null&&(z=Xs(g,f),z!==0&&z!==S.retryLane))throw S.retryLane=z,Tc(o,z),qs(g,o,z),iv;Zp(),c=W_(o,c,f)}else o=S.treeContext,Pr=Ri(z.nextSibling),Yn=c,Xt=!0,_l=null,Mi=!1,o!==null&&OS(c,o),c=qp(c,g),c.flags|=4096;return c}return o=yo(o.child,{mode:g.mode,children:g.children}),o.ref=c.ref,c.child=o,o.return=c,o}function Fp(o,c){var f=c.ref;if(f===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(o===null||o.ref!==f)&&(c.flags|=4194816)}}function av(o,c,f,g,N){return Rc(c),f=Ub(o,c,f,g,void 0,N),g=zb(),o!==null&&!yn?(qb(o,c,N),ko(o,c,N)):(Xt&&g&&wb(c),c.flags|=1,Jn(o,c,f,N),c.child)}function G_(o,c,f,g,N,S){return Rc(c),c.updateQueue=null,f=YS(c,g,f,N),KS(o),g=zb(),o!==null&&!yn?(qb(o,c,S),ko(o,c,S)):(Xt&&g&&wb(c),c.flags|=1,Jn(o,c,f,S),c.child)}function V_(o,c,f,g,N){if(Rc(c),c.stateNode===null){var S=Gd,z=f.contextType;typeof z=="object"&&z!==null&&(S=Xn(z)),S=new f(g,S),c.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=nv,c.stateNode=S,S._reactInternals=c,S=c.stateNode,S.props=g,S.state=c.memoizedState,S.refs={},Mb(c),z=f.contextType,S.context=typeof z=="object"&&z!==null?Xn(z):Gd,S.state=c.memoizedState,z=f.getDerivedStateFromProps,typeof z=="function"&&(rv(c,f,z,g),S.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(z=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),z!==S.state&&nv.enqueueReplaceState(S,S.state,null),Rh(c,g,S,N),Lh(),S.state=c.memoizedState),typeof S.componentDidMount=="function"&&(c.flags|=4194308),g=!0}else if(o===null){S=c.stateNode;var J=c.memoizedProps,ie=Uc(f,J);S.props=ie;var be=S.context,Me=f.contextType;z=Gd,typeof Me=="object"&&Me!==null&&(z=Xn(Me));var Ue=f.getDerivedStateFromProps;Me=typeof Ue=="function"||typeof S.getSnapshotBeforeUpdate=="function",J=c.pendingProps!==J,Me||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(J||be!==z)&&L_(c,S,g,z),Al=!1;var Ne=c.memoizedState;S.state=Ne,Rh(c,g,S,N),Lh(),be=c.memoizedState,J||Ne!==be||Al?(typeof Ue=="function"&&(rv(c,f,Ue,g),be=c.memoizedState),(ie=Al||M_(c,f,ie,g,Ne,be,z))?(Me||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(c.flags|=4194308)):(typeof S.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=be),S.props=g,S.state=be,S.context=z,g=ie):(typeof S.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{S=c.stateNode,Lb(o,c),z=c.memoizedProps,Me=Uc(f,z),S.props=Me,Ue=c.pendingProps,Ne=S.context,be=f.contextType,ie=Gd,typeof be=="object"&&be!==null&&(ie=Xn(be)),J=f.getDerivedStateFromProps,(be=typeof J=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(z!==Ue||Ne!==ie)&&L_(c,S,g,ie),Al=!1,Ne=c.memoizedState,S.state=Ne,Rh(c,g,S,N),Lh();var Ae=c.memoizedState;z!==Ue||Ne!==Ae||Al||o!==null&&o.dependencies!==null&&kp(o.dependencies)?(typeof J=="function"&&(rv(c,f,J,g),Ae=c.memoizedState),(Me=Al||M_(c,f,Me,g,Ne,Ae,ie)||o!==null&&o.dependencies!==null&&kp(o.dependencies))?(be||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(g,Ae,ie),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(g,Ae,ie)),typeof S.componentDidUpdate=="function"&&(c.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof S.componentDidUpdate!="function"||z===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||z===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=Ae),S.props=g,S.state=Ae,S.context=ie,g=Me):(typeof S.componentDidUpdate!="function"||z===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||z===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=1024),g=!1)}return S=g,Fp(o,c),g=(c.flags&128)!==0,S||g?(S=c.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:S.render(),c.flags|=1,o!==null&&g?(c.child=Bc(c,o.child,null,N),c.child=Bc(c,null,f,N)):Jn(o,c,f,N),c.memoizedState=S.state,o=c.child):o=ko(o,c,N),o}function K_(o,c,f,g){return Mc(),c.flags|=256,Jn(o,c,f,g),c.child}var ov={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lv(o){return{baseLanes:o,cachePool:DS()}}function cv(o,c,f){return o=o!==null?o.childLanes&~f:0,c&&(o|=li),o}function Y_(o,c,f){var g=c.pendingProps,N=!1,S=(c.flags&128)!==0,z;if((z=S)||(z=o!==null&&o.memoizedState===null?!1:(hn.current&2)!==0),z&&(N=!0,c.flags&=-129),z=(c.flags&32)!==0,c.flags&=-33,o===null){if(Xt){if(N?Ml(c):Ll(),(o=Pr)?(o=n3(o,Mi),o=o!==null&&o.data!=="&"?o:null,o!==null&&(c.memoizedState={dehydrated:o,treeContext:Sl!==null?{id:Ba,overflow:$a}:null,retryLane:536870912,hydrationErrors:null},f=ES(o),f.return=c,c.child=f,Yn=c,Pr=null)):o=null,o===null)throw Cl(c);return Wv(o)?c.lanes=32:c.lanes=536870912,null}var J=g.children;return g=g.fallback,N?(Ll(),N=c.mode,J=Hp({mode:"hidden",children:J},N),g=Oc(g,N,f,null),J.return=c,g.return=c,J.sibling=g,c.child=J,g=c.child,g.memoizedState=lv(f),g.childLanes=cv(o,z,f),c.memoizedState=ov,$h(null,g)):(Ml(c),dv(c,J))}var ie=o.memoizedState;if(ie!==null&&(J=ie.dehydrated,J!==null)){if(S)c.flags&256?(Ml(c),c.flags&=-257,c=uv(o,c,f)):c.memoizedState!==null?(Ll(),c.child=o.child,c.flags|=128,c=null):(Ll(),J=g.fallback,N=c.mode,g=Hp({mode:"visible",children:g.children},N),J=Oc(J,N,f,null),J.flags|=2,g.return=c,J.return=c,g.sibling=J,c.child=g,Bc(c,o.child,null,f),g=c.child,g.memoizedState=lv(f),g.childLanes=cv(o,z,f),c.memoizedState=ov,c=$h(null,g));else if(Ml(c),Wv(J)){if(z=J.nextSibling&&J.nextSibling.dataset,z)var be=z.dgst;z=be,g=Error(n(419)),g.stack="",g.digest=z,Ch({value:g,source:null,stack:null}),c=uv(o,c,f)}else if(yn||Xd(o,c,f,!1),z=(f&o.childLanes)!==0,yn||z){if(z=Nr,z!==null&&(g=Xs(z,f),g!==0&&g!==ie.retryLane))throw ie.retryLane=g,Tc(o,g),qs(z,o,g),iv;Hv(J)||Zp(),c=uv(o,c,f)}else Hv(J)?(c.flags|=192,c.child=o.child,c=null):(o=ie.treeContext,Pr=Ri(J.nextSibling),Yn=c,Xt=!0,_l=null,Mi=!1,o!==null&&OS(c,o),c=dv(c,g.children),c.flags|=4096);return c}return N?(Ll(),J=g.fallback,N=c.mode,ie=o.child,be=ie.sibling,g=yo(ie,{mode:"hidden",children:g.children}),g.subtreeFlags=ie.subtreeFlags&65011712,be!==null?J=yo(be,J):(J=Oc(J,N,f,null),J.flags|=2),J.return=c,g.return=c,g.sibling=J,c.child=g,$h(null,g),g=c.child,J=o.child.memoizedState,J===null?J=lv(f):(N=J.cachePool,N!==null?(ie=gn._currentValue,N=N.parent!==ie?{parent:ie,pool:ie}:N):N=DS(),J={baseLanes:J.baseLanes|f,cachePool:N}),g.memoizedState=J,g.childLanes=cv(o,z,f),c.memoizedState=ov,$h(o.child,g)):(Ml(c),f=o.child,o=f.sibling,f=yo(f,{mode:"visible",children:g.children}),f.return=c,f.sibling=null,o!==null&&(z=c.deletions,z===null?(c.deletions=[o],c.flags|=16):z.push(o)),c.child=f,c.memoizedState=null,f)}function dv(o,c){return c=Hp({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function Hp(o,c){return o=si(22,o,null,c),o.lanes=0,o}function uv(o,c,f){return Bc(c,o.child,null,f),o=dv(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function X_(o,c,f){o.lanes|=c;var g=o.alternate;g!==null&&(g.lanes|=c),_b(o.return,c,f)}function hv(o,c,f,g,N,S){var z=o.memoizedState;z===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:N,treeForkCount:S}:(z.isBackwards=c,z.rendering=null,z.renderingStartTime=0,z.last=g,z.tail=f,z.tailMode=N,z.treeForkCount=S)}function J_(o,c,f){var g=c.pendingProps,N=g.revealOrder,S=g.tail;g=g.children;var z=hn.current,J=(z&2)!==0;if(J?(z=z&1|2,c.flags|=128):z&=1,ne(hn,z),Jn(o,c,g,f),g=Xt?_h:0,!J&&o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&X_(o,f,c);else if(o.tag===19)X_(o,f,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(N){case"forwards":for(f=c.child,N=null;f!==null;)o=f.alternate,o!==null&&Mp(o)===null&&(N=f),f=f.sibling;f=N,f===null?(N=c.child,c.child=null):(N=f.sibling,f.sibling=null),hv(c,!1,N,f,S,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,N=c.child,c.child=null;N!==null;){if(o=N.alternate,o!==null&&Mp(o)===null){c.child=N;break}o=N.sibling,N.sibling=f,f=N,N=o}hv(c,!0,f,null,S,g);break;case"together":hv(c,!1,null,null,void 0,g);break;default:c.memoizedState=null}return c.child}function ko(o,c,f){if(o!==null&&(c.dependencies=o.dependencies),Il|=c.lanes,(f&c.childLanes)===0)if(o!==null){if(Xd(o,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(n(153));if(c.child!==null){for(o=c.child,f=yo(o,o.pendingProps),c.child=f,f.return=c;o.sibling!==null;)o=o.sibling,f=f.sibling=yo(o,o.pendingProps),f.return=c;f.sibling=null}return c.child}function fv(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&kp(o)))}function Lz(o,c,f){switch(c.tag){case 3:ve(c,c.stateNode.containerInfo),El(c,gn,o.memoizedState.cache),Mc();break;case 27:case 5:ge(c);break;case 4:ve(c,c.stateNode.containerInfo);break;case 10:El(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,Bb(c),null;break;case 13:var g=c.memoizedState;if(g!==null)return g.dehydrated!==null?(Ml(c),c.flags|=128,null):(f&c.child.childLanes)!==0?Y_(o,c,f):(Ml(c),o=ko(o,c,f),o!==null?o.sibling:null);Ml(c);break;case 19:var N=(o.flags&128)!==0;if(g=(f&c.childLanes)!==0,g||(Xd(o,c,f,!1),g=(f&c.childLanes)!==0),N){if(g)return J_(o,c,f);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),ne(hn,hn.current),g)break;return null;case 22:return c.lanes=0,F_(o,c,f,c.pendingProps);case 24:El(c,gn,o.memoizedState.cache)}return ko(o,c,f)}function Q_(o,c,f){if(o!==null)if(o.memoizedProps!==c.pendingProps)yn=!0;else{if(!fv(o,f)&&(c.flags&128)===0)return yn=!1,Lz(o,c,f);yn=(o.flags&131072)!==0}else yn=!1,Xt&&(c.flags&1048576)!==0&&TS(c,_h,c.index);switch(c.lanes=0,c.tag){case 16:e:{var g=c.pendingProps;if(o=Ic(c.elementType),c.type=o,typeof o=="function")yb(o)?(g=Uc(o,g),c.tag=1,c=V_(null,c,o,g,f)):(c.tag=0,c=av(null,c,o,g,f));else{if(o!=null){var N=o.$$typeof;if(N===I){c.tag=11,c=U_(null,c,o,g,f);break e}else if(N===E){c.tag=14,c=z_(null,c,o,g,f);break e}}throw c=q(o)||o,Error(n(306,c,""))}}return c;case 0:return av(o,c,c.type,c.pendingProps,f);case 1:return g=c.type,N=Uc(g,c.pendingProps),V_(o,c,g,N,f);case 3:e:{if(ve(c,c.stateNode.containerInfo),o===null)throw Error(n(387));g=c.pendingProps;var S=c.memoizedState;N=S.element,Lb(o,c),Rh(c,g,null,f);var z=c.memoizedState;if(g=z.cache,El(c,gn,g),g!==S.cache&&Cb(c,[gn],f,!0),Lh(),g=z.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:z.cache},c.updateQueue.baseState=S,c.memoizedState=S,c.flags&256){c=K_(o,c,g,f);break e}else if(g!==N){N=Ai(Error(n(424)),c),Ch(N),c=K_(o,c,g,f);break e}else for(o=c.stateNode.containerInfo,o.nodeType===9?o=o.body:o=o.nodeName==="HTML"?o.ownerDocument.body:o,Pr=Ri(o.firstChild),Yn=c,Xt=!0,_l=null,Mi=!0,f=FS(c,null,g,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Mc(),g===N){c=ko(o,c,f);break e}Jn(o,c,g,f)}c=c.child}return c;case 26:return Fp(o,c),o===null?(f=c3(c.type,null,c.pendingProps,null))?c.memoizedState=f:Xt||(f=c.type,o=c.pendingProps,g=am(Le.current).createElement(f),g[Lt]=c,g[lr]=o,Qn(g,f,o),Ur(g),c.stateNode=g):c.memoizedState=c3(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return ge(c),o===null&&Xt&&(g=c.stateNode=a3(c.type,c.pendingProps,Le.current),Yn=c,Mi=!0,N=Pr,zl(c.type)?(Gv=N,Pr=Ri(g.firstChild)):Pr=N),Jn(o,c,c.pendingProps.children,f),Fp(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&Xt&&((N=g=Pr)&&(g=cq(g,c.type,c.pendingProps,Mi),g!==null?(c.stateNode=g,Yn=c,Pr=Ri(g.firstChild),Mi=!1,N=!0):N=!1),N||Cl(c)),ge(c),N=c.type,S=c.pendingProps,z=o!==null?o.memoizedProps:null,g=S.children,zv(N,S)?g=null:z!==null&&zv(N,z)&&(c.flags|=32),c.memoizedState!==null&&(N=Ub(o,c,kz,null,null,f),ef._currentValue=N),Fp(o,c),Jn(o,c,g,f),c.child;case 6:return o===null&&Xt&&((o=f=Pr)&&(f=dq(f,c.pendingProps,Mi),f!==null?(c.stateNode=f,Yn=c,Pr=null,o=!0):o=!1),o||Cl(c)),null;case 13:return Y_(o,c,f);case 4:return ve(c,c.stateNode.containerInfo),g=c.pendingProps,o===null?c.child=Bc(c,null,g,f):Jn(o,c,g,f),c.child;case 11:return U_(o,c,c.type,c.pendingProps,f);case 7:return Jn(o,c,c.pendingProps,f),c.child;case 8:return Jn(o,c,c.pendingProps.children,f),c.child;case 12:return Jn(o,c,c.pendingProps.children,f),c.child;case 10:return g=c.pendingProps,El(c,c.type,g.value),Jn(o,c,g.children,f),c.child;case 9:return N=c.type._context,g=c.pendingProps.children,Rc(c),N=Xn(N),g=g(N),c.flags|=1,Jn(o,c,g,f),c.child;case 14:return z_(o,c,c.type,c.pendingProps,f);case 15:return q_(o,c,c.type,c.pendingProps,f);case 19:return J_(o,c,f);case 31:return Mz(o,c,f);case 22:return F_(o,c,f,c.pendingProps);case 24:return Rc(c),g=Xn(gn),o===null?(N=Tb(),N===null&&(N=Nr,S=Eb(),N.pooledCache=S,S.refCount++,S!==null&&(N.pooledCacheLanes|=f),N=S),c.memoizedState={parent:g,cache:N},Mb(c),El(c,gn,N)):((o.lanes&f)!==0&&(Lb(o,c),Rh(c,null,null,f),Lh()),N=o.memoizedState,S=c.memoizedState,N.parent!==g?(N={parent:g,cache:g},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),El(c,gn,g)):(g=S.cache,El(c,gn,g),g!==N.cache&&Cb(c,[gn],f,!0))),Jn(o,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(n(156,c.tag))}function So(o){o.flags|=4}function pv(o,c,f,g,N){if((c=(o.mode&32)!==0)&&(c=!1),c){if(o.flags|=16777216,(N&335544128)===N)if(o.stateNode.complete)o.flags|=8192;else if(SC())o.flags|=8192;else throw Dc=Ep,Ob}else o.flags&=-16777217}function Z_(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!p3(c))if(SC())o.flags|=8192;else throw Dc=Ep,Ob}function Wp(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?vt():536870912,o.lanes|=c,lu|=c)}function Uh(o,c){if(!Xt)switch(o.tailMode){case"hidden":c=o.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Ir(o){var c=o.alternate!==null&&o.alternate.child===o.child,f=0,g=0;if(c)for(var N=o.child;N!==null;)f|=N.lanes|N.childLanes,g|=N.subtreeFlags&65011712,g|=N.flags&65011712,N.return=o,N=N.sibling;else for(N=o.child;N!==null;)f|=N.lanes|N.childLanes,g|=N.subtreeFlags,g|=N.flags,N.return=o,N=N.sibling;return o.subtreeFlags|=g,o.childLanes=f,c}function Rz(o,c,f){var g=c.pendingProps;switch(jb(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ir(c),null;case 1:return Ir(c),null;case 3:return f=c.stateNode,g=null,o!==null&&(g=o.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),wo(gn),te(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(Yd(c)?So(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,kb())),Ir(c),null;case 26:var N=c.type,S=c.memoizedState;return o===null?(So(c),S!==null?(Ir(c),Z_(c,S)):(Ir(c),pv(c,N,null,g,f))):S?S!==o.memoizedState?(So(c),Ir(c),Z_(c,S)):(Ir(c),c.flags&=-16777217):(o=o.memoizedProps,o!==g&&So(c),Ir(c),pv(c,N,o,g,f)),null;case 27:if(ke(c),f=Le.current,N=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==g&&So(c);else{if(!g){if(c.stateNode===null)throw Error(n(166));return Ir(c),null}o=re.current,Yd(c)?MS(c):(o=a3(N,g,f),c.stateNode=o,So(c))}return Ir(c),null;case 5:if(ke(c),N=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==g&&So(c);else{if(!g){if(c.stateNode===null)throw Error(n(166));return Ir(c),null}if(S=re.current,Yd(c))MS(c);else{var z=am(Le.current);switch(S){case 1:S=z.createElementNS("http://www.w3.org/2000/svg",N);break;case 2:S=z.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;default:switch(N){case"svg":S=z.createElementNS("http://www.w3.org/2000/svg",N);break;case"math":S=z.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;case"script":S=z.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof g.is=="string"?z.createElement("select",{is:g.is}):z.createElement("select"),g.multiple?S.multiple=!0:g.size&&(S.size=g.size);break;default:S=typeof g.is=="string"?z.createElement(N,{is:g.is}):z.createElement(N)}}S[Lt]=c,S[lr]=g;e:for(z=c.child;z!==null;){if(z.tag===5||z.tag===6)S.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===c)break e;for(;z.sibling===null;){if(z.return===null||z.return===c)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}c.stateNode=S;e:switch(Qn(S,N,g),N){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&So(c)}}return Ir(c),pv(c,c.type,o===null?null:o.memoizedProps,c.pendingProps,f),null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==g&&So(c);else{if(typeof g!="string"&&c.stateNode===null)throw Error(n(166));if(o=Le.current,Yd(c)){if(o=c.stateNode,f=c.memoizedProps,g=null,N=Yn,N!==null)switch(N.tag){case 27:case 5:g=N.memoizedProps}o[Lt]=c,o=!!(o.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||YC(o.nodeValue,f)),o||Cl(c,!0)}else o=am(o).createTextNode(g),o[Lt]=c,c.stateNode=o}return Ir(c),null;case 31:if(f=c.memoizedState,o===null||o.memoizedState!==null){if(g=Yd(c),f!==null){if(o===null){if(!g)throw Error(n(318));if(o=c.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(557));o[Lt]=c}else Mc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ir(c),o=!1}else f=kb(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=f),o=!0;if(!o)return c.flags&256?(ai(c),c):(ai(c),null);if((c.flags&128)!==0)throw Error(n(558))}return Ir(c),null;case 13:if(g=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(N=Yd(c),g!==null&&g.dehydrated!==null){if(o===null){if(!N)throw Error(n(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(n(317));N[Lt]=c}else Mc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ir(c),N=!1}else N=kb(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(ai(c),c):(ai(c),null)}return ai(c),(c.flags&128)!==0?(c.lanes=f,c):(f=g!==null,o=o!==null&&o.memoizedState!==null,f&&(g=c.child,N=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(N=g.alternate.memoizedState.cachePool.pool),S=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(S=g.memoizedState.cachePool.pool),S!==N&&(g.flags|=2048)),f!==o&&f&&(c.child.flags|=8192),Wp(c,c.updateQueue),Ir(c),null);case 4:return te(),o===null&&Iv(c.stateNode.containerInfo),Ir(c),null;case 10:return wo(c.type),Ir(c),null;case 19:if(Y(hn),g=c.memoizedState,g===null)return Ir(c),null;if(N=(c.flags&128)!==0,S=g.rendering,S===null)if(N)Uh(g,!1);else{if(rn!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(S=Mp(o),S!==null){for(c.flags|=128,Uh(g,!1),o=S.updateQueue,c.updateQueue=o,Wp(c,o),c.subtreeFlags=0,o=f,f=c.child;f!==null;)CS(f,o),f=f.sibling;return ne(hn,hn.current&1|2),Xt&&bo(c,g.treeForkCount),c.child}o=o.sibling}g.tail!==null&&He()>Xp&&(c.flags|=128,N=!0,Uh(g,!1),c.lanes=4194304)}else{if(!N)if(o=Mp(S),o!==null){if(c.flags|=128,N=!0,o=o.updateQueue,c.updateQueue=o,Wp(c,o),Uh(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!Xt)return Ir(c),null}else 2*He()-g.renderingStartTime>Xp&&f!==536870912&&(c.flags|=128,N=!0,Uh(g,!1),c.lanes=4194304);g.isBackwards?(S.sibling=c.child,c.child=S):(o=g.last,o!==null?o.sibling=S:c.child=S,g.last=S)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=He(),o.sibling=null,f=hn.current,ne(hn,N?f&1|2:f&1),Xt&&bo(c,g.treeForkCount),o):(Ir(c),null);case 22:case 23:return ai(c),Db(),g=c.memoizedState!==null,o!==null?o.memoizedState!==null!==g&&(c.flags|=8192):g&&(c.flags|=8192),g?(f&536870912)!==0&&(c.flags&128)===0&&(Ir(c),c.subtreeFlags&6&&(c.flags|=8192)):Ir(c),f=c.updateQueue,f!==null&&Wp(c,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==f&&(c.flags|=2048),o!==null&&Y(Pc),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),wo(gn),Ir(c),null;case 25:return null;case 30:return null}throw Error(n(156,c.tag))}function Pz(o,c){switch(jb(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return wo(gn),te(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return ke(c),null;case 31:if(c.memoizedState!==null){if(ai(c),c.alternate===null)throw Error(n(340));Mc()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 13:if(ai(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Mc()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return Y(hn),null;case 4:return te(),null;case 10:return wo(c.type),null;case 22:case 23:return ai(c),Db(),o!==null&&Y(Pc),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return wo(gn),null;case 25:return null;default:return null}}function eC(o,c){switch(jb(c),c.tag){case 3:wo(gn),te();break;case 26:case 27:case 5:ke(c);break;case 4:te();break;case 31:c.memoizedState!==null&&ai(c);break;case 13:ai(c);break;case 19:Y(hn);break;case 10:wo(c.type);break;case 22:case 23:ai(c),Db(),o!==null&&Y(Pc);break;case 24:wo(gn)}}function zh(o,c){try{var f=c.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var N=g.next;f=N;do{if((f.tag&o)===o){g=void 0;var S=f.create,z=f.inst;g=S(),z.destroy=g}f=f.next}while(f!==N)}}catch(J){fr(c,c.return,J)}}function Rl(o,c,f){try{var g=c.updateQueue,N=g!==null?g.lastEffect:null;if(N!==null){var S=N.next;g=S;do{if((g.tag&o)===o){var z=g.inst,J=z.destroy;if(J!==void 0){z.destroy=void 0,N=c;var ie=f,be=J;try{be()}catch(Me){fr(N,ie,Me)}}}g=g.next}while(g!==S)}}catch(Me){fr(c,c.return,Me)}}function tC(o){var c=o.updateQueue;if(c!==null){var f=o.stateNode;try{WS(c,f)}catch(g){fr(o,o.return,g)}}}function rC(o,c,f){f.props=Uc(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(g){fr(o,c,g)}}function qh(o,c){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var g=o.stateNode;break;case 30:g=o.stateNode;break;default:g=o.stateNode}typeof f=="function"?o.refCleanup=f(g):f.current=g}}catch(N){fr(o,c,N)}}function Ua(o,c){var f=o.ref,g=o.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(N){fr(o,c,N)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(N){fr(o,c,N)}else f.current=null}function nC(o){var c=o.type,f=o.memoizedProps,g=o.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(N){fr(o,o.return,N)}}function mv(o,c,f){try{var g=o.stateNode;nq(g,o.type,f,c),g[lr]=c}catch(N){fr(o,o.return,N)}}function sC(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&zl(o.type)||o.tag===4}function gv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||sC(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&zl(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function xv(o,c,f){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(o),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=ls));else if(g!==4&&(g===27&&zl(o.type)&&(f=o.stateNode,c=null),o=o.child,o!==null))for(xv(o,c,f),o=o.sibling;o!==null;)xv(o,c,f),o=o.sibling}function Gp(o,c,f){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?f.insertBefore(o,c):f.appendChild(o);else if(g!==4&&(g===27&&zl(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(Gp(o,c,f),o=o.sibling;o!==null;)Gp(o,c,f),o=o.sibling}function iC(o){var c=o.stateNode,f=o.memoizedProps;try{for(var g=o.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Qn(c,g,f),c[Lt]=o,c[lr]=f}catch(S){fr(o,o.return,S)}}var _o=!1,bn=!1,yv=!1,aC=typeof WeakSet=="function"?WeakSet:Set,In=null;function Iz(o,c){if(o=o.containerInfo,$v=fm,o=yS(o),ub(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else e:{f=(f=o.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var N=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var z=0,J=-1,ie=-1,be=0,Me=0,Ue=o,Ne=null;t:for(;;){for(var Ae;Ue!==f||N!==0&&Ue.nodeType!==3||(J=z+N),Ue!==S||g!==0&&Ue.nodeType!==3||(ie=z+g),Ue.nodeType===3&&(z+=Ue.nodeValue.length),(Ae=Ue.firstChild)!==null;)Ne=Ue,Ue=Ae;for(;;){if(Ue===o)break t;if(Ne===f&&++be===N&&(J=z),Ne===S&&++Me===g&&(ie=z),(Ae=Ue.nextSibling)!==null)break;Ue=Ne,Ne=Ue.parentNode}Ue=Ae}f=J===-1||ie===-1?null:{start:J,end:ie}}else f=null}f=f||{start:0,end:0}}else f=null;for(Uv={focusedElem:o,selectionRange:f},fm=!1,In=c;In!==null;)if(c=In,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,In=o;else for(;In!==null;){switch(c=In,S=c.alternate,o=c.flags,c.tag){case 0:if((o&4)!==0&&(o=c.updateQueue,o=o!==null?o.events:null,o!==null))for(f=0;f<o.length;f++)N=o[f],N.ref.impl=N.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&S!==null){o=void 0,f=c,N=S.memoizedProps,S=S.memoizedState,g=f.stateNode;try{var at=Uc(f.type,N);o=g.getSnapshotBeforeUpdate(at,S),g.__reactInternalSnapshotBeforeUpdate=o}catch(St){fr(f,f.return,St)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,f=o.nodeType,f===9)Fv(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Fv(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=c.sibling,o!==null){o.return=c.return,In=o;break}In=c.return}}function oC(o,c,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:Eo(o,f),g&4&&zh(5,f);break;case 1:if(Eo(o,f),g&4)if(o=f.stateNode,c===null)try{o.componentDidMount()}catch(z){fr(f,f.return,z)}else{var N=Uc(f.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(N,c,o.__reactInternalSnapshotBeforeUpdate)}catch(z){fr(f,f.return,z)}}g&64&&tC(f),g&512&&qh(f,f.return);break;case 3:if(Eo(o,f),g&64&&(o=f.updateQueue,o!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{WS(o,c)}catch(z){fr(f,f.return,z)}}break;case 27:c===null&&g&4&&iC(f);case 26:case 5:Eo(o,f),c===null&&g&4&&nC(f),g&512&&qh(f,f.return);break;case 12:Eo(o,f);break;case 31:Eo(o,f),g&4&&dC(o,f);break;case 13:Eo(o,f),g&4&&uC(o,f),g&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=Wz.bind(null,f),uq(o,f))));break;case 22:if(g=f.memoizedState!==null||_o,!g){c=c!==null&&c.memoizedState!==null||bn,N=_o;var S=bn;_o=g,(bn=c)&&!S?Ao(o,f,(f.subtreeFlags&8772)!==0):Eo(o,f),_o=N,bn=S}break;case 30:break;default:Eo(o,f)}}function lC(o){var c=o.alternate;c!==null&&(o.alternate=null,lC(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&Oa(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Hr=null,Bs=!1;function Co(o,c,f){for(f=f.child;f!==null;)cC(o,c,f),f=f.sibling}function cC(o,c,f){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(jt,f)}catch{}switch(f.tag){case 26:bn||Ua(f,c),Co(o,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:bn||Ua(f,c);var g=Hr,N=Bs;zl(f.type)&&(Hr=f.stateNode,Bs=!1),Co(o,c,f),Jh(f.stateNode),Hr=g,Bs=N;break;case 5:bn||Ua(f,c);case 6:if(g=Hr,N=Bs,Hr=null,Co(o,c,f),Hr=g,Bs=N,Hr!==null)if(Bs)try{(Hr.nodeType===9?Hr.body:Hr.nodeName==="HTML"?Hr.ownerDocument.body:Hr).removeChild(f.stateNode)}catch(S){fr(f,c,S)}else try{Hr.removeChild(f.stateNode)}catch(S){fr(f,c,S)}break;case 18:Hr!==null&&(Bs?(o=Hr,t3(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),gu(o)):t3(Hr,f.stateNode));break;case 4:g=Hr,N=Bs,Hr=f.stateNode.containerInfo,Bs=!0,Co(o,c,f),Hr=g,Bs=N;break;case 0:case 11:case 14:case 15:Rl(2,f,c),bn||Rl(4,f,c),Co(o,c,f);break;case 1:bn||(Ua(f,c),g=f.stateNode,typeof g.componentWillUnmount=="function"&&rC(f,c,g)),Co(o,c,f);break;case 21:Co(o,c,f);break;case 22:bn=(g=bn)||f.memoizedState!==null,Co(o,c,f),bn=g;break;default:Co(o,c,f)}}function dC(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{gu(o)}catch(f){fr(c,c.return,f)}}}function uC(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{gu(o)}catch(f){fr(c,c.return,f)}}function Dz(o){switch(o.tag){case 31:case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new aC),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new aC),c;default:throw Error(n(435,o.tag))}}function Vp(o,c){var f=Dz(o);c.forEach(function(g){if(!f.has(g)){f.add(g);var N=Gz.bind(null,o,g);g.then(N,N)}})}function $s(o,c){var f=c.deletions;if(f!==null)for(var g=0;g<f.length;g++){var N=f[g],S=o,z=c,J=z;e:for(;J!==null;){switch(J.tag){case 27:if(zl(J.type)){Hr=J.stateNode,Bs=!1;break e}break;case 5:Hr=J.stateNode,Bs=!1;break e;case 3:case 4:Hr=J.stateNode.containerInfo,Bs=!0;break e}J=J.return}if(Hr===null)throw Error(n(160));cC(S,z,N),Hr=null,Bs=!1,S=N.alternate,S!==null&&(S.return=null),N.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)hC(c,o),c=c.sibling}var oa=null;function hC(o,c){var f=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:$s(c,o),Us(o),g&4&&(Rl(3,o,o.return),zh(3,o),Rl(5,o,o.return));break;case 1:$s(c,o),Us(o),g&512&&(bn||f===null||Ua(f,f.return)),g&64&&_o&&(o=o.updateQueue,o!==null&&(g=o.callbacks,g!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var N=oa;if($s(c,o),Us(o),g&512&&(bn||f===null||Ua(f,f.return)),g&4){var S=f!==null?f.memoizedState:null;if(g=o.memoizedState,f===null)if(g===null)if(o.stateNode===null){e:{g=o.type,f=o.memoizedProps,N=N.ownerDocument||N;t:switch(g){case"title":S=N.getElementsByTagName("title")[0],(!S||S[Ls]||S[Lt]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=N.createElement(g),N.head.insertBefore(S,N.querySelector("head > title"))),Qn(S,g,f),S[Lt]=o,Ur(S),g=S;break e;case"link":var z=h3("link","href",N).get(g+(f.href||""));if(z){for(var J=0;J<z.length;J++)if(S=z[J],S.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&S.getAttribute("rel")===(f.rel==null?null:f.rel)&&S.getAttribute("title")===(f.title==null?null:f.title)&&S.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){z.splice(J,1);break t}}S=N.createElement(g),Qn(S,g,f),N.head.appendChild(S);break;case"meta":if(z=h3("meta","content",N).get(g+(f.content||""))){for(J=0;J<z.length;J++)if(S=z[J],S.getAttribute("content")===(f.content==null?null:""+f.content)&&S.getAttribute("name")===(f.name==null?null:f.name)&&S.getAttribute("property")===(f.property==null?null:f.property)&&S.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&S.getAttribute("charset")===(f.charSet==null?null:f.charSet)){z.splice(J,1);break t}}S=N.createElement(g),Qn(S,g,f),N.head.appendChild(S);break;default:throw Error(n(468,g))}S[Lt]=o,Ur(S),g=S}o.stateNode=g}else f3(N,o.type,o.stateNode);else o.stateNode=u3(N,g,o.memoizedProps);else S!==g?(S===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):S.count--,g===null?f3(N,o.type,o.stateNode):u3(N,g,o.memoizedProps)):g===null&&o.stateNode!==null&&mv(o,o.memoizedProps,f.memoizedProps)}break;case 27:$s(c,o),Us(o),g&512&&(bn||f===null||Ua(f,f.return)),f!==null&&g&4&&mv(o,o.memoizedProps,f.memoizedProps);break;case 5:if($s(c,o),Us(o),g&512&&(bn||f===null||Ua(f,f.return)),o.flags&32){N=o.stateNode;try{qr(N,"")}catch(at){fr(o,o.return,at)}}g&4&&o.stateNode!=null&&(N=o.memoizedProps,mv(o,N,f!==null?f.memoizedProps:N)),g&1024&&(yv=!0);break;case 6:if($s(c,o),Us(o),g&4){if(o.stateNode===null)throw Error(n(162));g=o.memoizedProps,f=o.stateNode;try{f.nodeValue=g}catch(at){fr(o,o.return,at)}}break;case 3:if(cm=null,N=oa,oa=om(c.containerInfo),$s(c,o),oa=N,Us(o),g&4&&f!==null&&f.memoizedState.isDehydrated)try{gu(c.containerInfo)}catch(at){fr(o,o.return,at)}yv&&(yv=!1,fC(o));break;case 4:g=oa,oa=om(o.stateNode.containerInfo),$s(c,o),Us(o),oa=g;break;case 12:$s(c,o),Us(o);break;case 31:$s(c,o),Us(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Vp(o,g)));break;case 13:$s(c,o),Us(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Yp=He()),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Vp(o,g)));break;case 22:N=o.memoizedState!==null;var ie=f!==null&&f.memoizedState!==null,be=_o,Me=bn;if(_o=be||N,bn=Me||ie,$s(c,o),bn=Me,_o=be,Us(o),g&8192)e:for(c=o.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(f===null||ie||_o||bn||zc(o)),f=null,c=o;;){if(c.tag===5||c.tag===26){if(f===null){ie=f=c;try{if(S=ie.stateNode,N)z=S.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{J=ie.stateNode;var Ue=ie.memoizedProps.style,Ne=Ue!=null&&Ue.hasOwnProperty("display")?Ue.display:null;J.style.display=Ne==null||typeof Ne=="boolean"?"":(""+Ne).trim()}}catch(at){fr(ie,ie.return,at)}}}else if(c.tag===6){if(f===null){ie=c;try{ie.stateNode.nodeValue=N?"":ie.memoizedProps}catch(at){fr(ie,ie.return,at)}}}else if(c.tag===18){if(f===null){ie=c;try{var Ae=ie.stateNode;N?r3(Ae,!0):r3(ie.stateNode,!1)}catch(at){fr(ie,ie.return,at)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break e;for(;c.sibling===null;){if(c.return===null||c.return===o)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}g&4&&(g=o.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Vp(o,f))));break;case 19:$s(c,o),Us(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Vp(o,g)));break;case 30:break;case 21:break;default:$s(c,o),Us(o)}}function Us(o){var c=o.flags;if(c&2){try{for(var f,g=o.return;g!==null;){if(sC(g)){f=g;break}g=g.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var N=f.stateNode,S=gv(o);Gp(o,S,N);break;case 5:var z=f.stateNode;f.flags&32&&(qr(z,""),f.flags&=-33);var J=gv(o);Gp(o,J,z);break;case 3:case 4:var ie=f.stateNode.containerInfo,be=gv(o);xv(o,be,ie);break;default:throw Error(n(161))}}catch(Me){fr(o,o.return,Me)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function fC(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;fC(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function Eo(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)oC(o,c.alternate,c),c=c.sibling}function zc(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:Rl(4,c,c.return),zc(c);break;case 1:Ua(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&rC(c,c.return,f),zc(c);break;case 27:Jh(c.stateNode);case 26:case 5:Ua(c,c.return),zc(c);break;case 22:c.memoizedState===null&&zc(c);break;case 30:zc(c);break;default:zc(c)}o=o.sibling}}function Ao(o,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var g=c.alternate,N=o,S=c,z=S.flags;switch(S.tag){case 0:case 11:case 15:Ao(N,S,f),zh(4,S);break;case 1:if(Ao(N,S,f),g=S,N=g.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(be){fr(g,g.return,be)}if(g=S,N=g.updateQueue,N!==null){var J=g.stateNode;try{var ie=N.shared.hiddenCallbacks;if(ie!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ie.length;N++)HS(ie[N],J)}catch(be){fr(g,g.return,be)}}f&&z&64&&tC(S),qh(S,S.return);break;case 27:iC(S);case 26:case 5:Ao(N,S,f),f&&g===null&&z&4&&nC(S),qh(S,S.return);break;case 12:Ao(N,S,f);break;case 31:Ao(N,S,f),f&&z&4&&dC(N,S);break;case 13:Ao(N,S,f),f&&z&4&&uC(N,S);break;case 22:S.memoizedState===null&&Ao(N,S,f),qh(S,S.return);break;case 30:break;default:Ao(N,S,f)}c=c.sibling}}function bv(o,c){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&Eh(f))}function vv(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Eh(o))}function la(o,c,f,g){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)pC(o,c,f,g),c=c.sibling}function pC(o,c,f,g){var N=c.flags;switch(c.tag){case 0:case 11:case 15:la(o,c,f,g),N&2048&&zh(9,c);break;case 1:la(o,c,f,g);break;case 3:la(o,c,f,g),N&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Eh(o)));break;case 12:if(N&2048){la(o,c,f,g),o=c.stateNode;try{var S=c.memoizedProps,z=S.id,J=S.onPostCommit;typeof J=="function"&&J(z,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(ie){fr(c,c.return,ie)}}else la(o,c,f,g);break;case 31:la(o,c,f,g);break;case 13:la(o,c,f,g);break;case 23:break;case 22:S=c.stateNode,z=c.alternate,c.memoizedState!==null?S._visibility&2?la(o,c,f,g):Fh(o,c):S._visibility&2?la(o,c,f,g):(S._visibility|=2,iu(o,c,f,g,(c.subtreeFlags&10256)!==0||!1)),N&2048&&bv(z,c);break;case 24:la(o,c,f,g),N&2048&&vv(c.alternate,c);break;default:la(o,c,f,g)}}function iu(o,c,f,g,N){for(N=N&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var S=o,z=c,J=f,ie=g,be=z.flags;switch(z.tag){case 0:case 11:case 15:iu(S,z,J,ie,N),zh(8,z);break;case 23:break;case 22:var Me=z.stateNode;z.memoizedState!==null?Me._visibility&2?iu(S,z,J,ie,N):Fh(S,z):(Me._visibility|=2,iu(S,z,J,ie,N)),N&&be&2048&&bv(z.alternate,z);break;case 24:iu(S,z,J,ie,N),N&&be&2048&&vv(z.alternate,z);break;default:iu(S,z,J,ie,N)}c=c.sibling}}function Fh(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=o,g=c,N=g.flags;switch(g.tag){case 22:Fh(f,g),N&2048&&bv(g.alternate,g);break;case 24:Fh(f,g),N&2048&&vv(g.alternate,g);break;default:Fh(f,g)}c=c.sibling}}var Hh=8192;function au(o,c,f){if(o.subtreeFlags&Hh)for(o=o.child;o!==null;)mC(o,c,f),o=o.sibling}function mC(o,c,f){switch(o.tag){case 26:au(o,c,f),o.flags&Hh&&o.memoizedState!==null&&Nq(f,oa,o.memoizedState,o.memoizedProps);break;case 5:au(o,c,f);break;case 3:case 4:var g=oa;oa=om(o.stateNode.containerInfo),au(o,c,f),oa=g;break;case 22:o.memoizedState===null&&(g=o.alternate,g!==null&&g.memoizedState!==null?(g=Hh,Hh=16777216,au(o,c,f),Hh=g):au(o,c,f));break;default:au(o,c,f)}}function gC(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function Wh(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var g=c[f];In=g,yC(g,o)}gC(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)xC(o),o=o.sibling}function xC(o){switch(o.tag){case 0:case 11:case 15:Wh(o),o.flags&2048&&Rl(9,o,o.return);break;case 3:Wh(o);break;case 12:Wh(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,Kp(o)):Wh(o);break;default:Wh(o)}}function Kp(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var g=c[f];In=g,yC(g,o)}gC(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:Rl(8,c,c.return),Kp(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,Kp(c));break;default:Kp(c)}o=o.sibling}}function yC(o,c){for(;In!==null;){var f=In;switch(f.tag){case 0:case 11:case 15:Rl(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Eh(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,In=g;else e:for(f=o;In!==null;){g=In;var N=g.sibling,S=g.return;if(lC(g),g===f){In=null;break e}if(N!==null){N.return=S,In=N;break e}In=S}}}var Bz={getCacheForType:function(o){var c=Xn(gn),f=c.data.get(o);return f===void 0&&(f=o(),c.data.set(o,f)),f},cacheSignal:function(){return Xn(gn).controller.signal}},$z=typeof WeakMap=="function"?WeakMap:Map,or=0,Nr=null,Ht=null,Vt=0,hr=0,oi=null,Pl=!1,ou=!1,wv=!1,To=0,rn=0,Il=0,qc=0,jv=0,li=0,lu=0,Gh=null,zs=null,Nv=!1,Yp=0,bC=0,Xp=1/0,Jp=null,Dl=null,Sn=0,Bl=null,cu=null,Oo=0,kv=0,Sv=null,vC=null,Vh=0,_v=null;function ci(){return(or&2)!==0&&Vt!==0?Vt&-Vt:W.T!==null?Mv():Oe()}function wC(){if(li===0)if((Vt&536870912)===0||Xt){var o=bt;bt<<=1,(bt&3932160)===0&&(bt=262144),li=o}else li=536870912;return o=ii.current,o!==null&&(o.flags|=32),li}function qs(o,c,f){(o===Nr&&(hr===2||hr===9)||o.cancelPendingCommit!==null)&&(du(o,0),$l(o,Vt,li,!1)),Jt(o,f),((or&2)===0||o!==Nr)&&(o===Nr&&((or&2)===0&&(qc|=f),rn===4&&$l(o,Vt,li,!1)),za(o))}function jC(o,c,f){if((or&6)!==0)throw Error(n(327));var g=!f&&(c&127)===0&&(c&o.expiredLanes)===0||he(o,c),N=g?qz(o,c):Ev(o,c,!0),S=g;do{if(N===0){ou&&!g&&$l(o,c,0,!1);break}else{if(f=o.current.alternate,S&&!Uz(f)){N=Ev(o,c,!1),S=!1;continue}if(N===2){if(S=c,o.errorRecoveryDisabledLanes&S)var z=0;else z=o.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){c=z;e:{var J=o;N=Gh;var ie=J.current.memoizedState.isDehydrated;if(ie&&(du(J,z).flags|=256),z=Ev(J,z,!1),z!==2){if(wv&&!ie){J.errorRecoveryDisabledLanes|=S,qc|=S,N=4;break e}S=zs,zs=N,S!==null&&(zs===null?zs=S:zs.push.apply(zs,S))}N=z}if(S=!1,N!==2)continue}}if(N===1){du(o,0),$l(o,c,0,!0);break}e:{switch(g=o,S=N,S){case 0:case 1:throw Error(n(345));case 4:if((c&4194048)!==c)break;case 6:$l(g,c,li,!Pl);break e;case 2:zs=null;break;case 3:case 5:break;default:throw Error(n(329))}if((c&62914560)===c&&(N=Yp+300-He(),10<N)){if($l(g,c,li,!Pl),pt(g,0,!0)!==0)break e;Oo=c,g.timeoutHandle=ZC(NC.bind(null,g,f,zs,Jp,Nv,c,li,qc,lu,Pl,S,"Throttled",-0,0),N);break e}NC(g,f,zs,Jp,Nv,c,li,qc,lu,Pl,S,null,-0,0)}}break}while(!0);za(o)}function NC(o,c,f,g,N,S,z,J,ie,be,Me,Ue,Ne,Ae){if(o.timeoutHandle=-1,Ue=c.subtreeFlags,Ue&8192||(Ue&16785408)===16785408){Ue={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ls},mC(c,S,Ue);var at=(S&62914560)===S?Yp-He():(S&4194048)===S?bC-He():0;if(at=kq(Ue,at),at!==null){Oo=S,o.cancelPendingCommit=at(OC.bind(null,o,c,S,f,g,N,z,J,ie,Me,Ue,null,Ne,Ae)),$l(o,S,z,!be);return}}OC(o,c,S,f,g,N,z,J,ie)}function Uz(o){for(var c=o;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var N=f[g],S=N.getSnapshot;N=N.value;try{if(!ni(S(),N))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function $l(o,c,f,g){c&=~jv,c&=~qc,o.suspendedLanes|=c,o.pingedLanes&=~c,g&&(o.warmLanes|=c),g=o.expirationTimes;for(var N=c;0<N;){var S=31-ot(N),z=1<<S;g[S]=-1,N&=~z}f!==0&&Mn(o,f,c)}function Qp(){return(or&6)===0?(Kh(0),!1):!0}function Cv(){if(Ht!==null){if(hr===0)var o=Ht.return;else o=Ht,vo=Lc=null,Fb(o),eu=null,Th=0,o=Ht;for(;o!==null;)eC(o.alternate,o),o=o.return;Ht=null}}function du(o,c){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,aq(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),Oo=0,Cv(),Nr=o,Ht=f=yo(o.current,null),Vt=c,hr=0,oi=null,Pl=!1,ou=he(o,c),wv=!1,lu=li=jv=qc=Il=rn=0,zs=Gh=null,Nv=!1,(c&8)!==0&&(c|=c&32);var g=o.entangledLanes;if(g!==0)for(o=o.entanglements,g&=c;0<g;){var N=31-ot(g),S=1<<N;c|=o[N],g&=~S}return To=c,bp(),f}function kC(o,c){Pt=null,W.H=Bh,c===Zd||c===Cp?(c=US(),hr=3):c===Ob?(c=US(),hr=4):hr=c===iv?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,oi=c,Ht===null&&(rn=1,zp(o,Ai(c,o.current)))}function SC(){var o=ii.current;return o===null?!0:(Vt&4194048)===Vt?Li===null:(Vt&62914560)===Vt||(Vt&536870912)!==0?o===Li:!1}function _C(){var o=W.H;return W.H=Bh,o===null?Bh:o}function CC(){var o=W.A;return W.A=Bz,o}function Zp(){rn=4,Pl||(Vt&4194048)!==Vt&&ii.current!==null||(ou=!0),(Il&134217727)===0&&(qc&134217727)===0||Nr===null||$l(Nr,Vt,li,!1)}function Ev(o,c,f){var g=or;or|=2;var N=_C(),S=CC();(Nr!==o||Vt!==c)&&(Jp=null,du(o,c)),c=!1;var z=rn;e:do try{if(hr!==0&&Ht!==null){var J=Ht,ie=oi;switch(hr){case 8:Cv(),z=6;break e;case 3:case 2:case 9:case 6:ii.current===null&&(c=!0);var be=hr;if(hr=0,oi=null,uu(o,J,ie,be),f&&ou){z=0;break e}break;default:be=hr,hr=0,oi=null,uu(o,J,ie,be)}}zz(),z=rn;break}catch(Me){kC(o,Me)}while(!0);return c&&o.shellSuspendCounter++,vo=Lc=null,or=g,W.H=N,W.A=S,Ht===null&&(Nr=null,Vt=0,bp()),z}function zz(){for(;Ht!==null;)EC(Ht)}function qz(o,c){var f=or;or|=2;var g=_C(),N=CC();Nr!==o||Vt!==c?(Jp=null,Xp=He()+500,du(o,c)):ou=he(o,c);e:do try{if(hr!==0&&Ht!==null){c=Ht;var S=oi;t:switch(hr){case 1:hr=0,oi=null,uu(o,c,S,1);break;case 2:case 9:if(BS(S)){hr=0,oi=null,AC(c);break}c=function(){hr!==2&&hr!==9||Nr!==o||(hr=7),za(o)},S.then(c,c);break e;case 3:hr=7;break e;case 4:hr=5;break e;case 7:BS(S)?(hr=0,oi=null,AC(c)):(hr=0,oi=null,uu(o,c,S,7));break;case 5:var z=null;switch(Ht.tag){case 26:z=Ht.memoizedState;case 5:case 27:var J=Ht;if(z?p3(z):J.stateNode.complete){hr=0,oi=null;var ie=J.sibling;if(ie!==null)Ht=ie;else{var be=J.return;be!==null?(Ht=be,em(be)):Ht=null}break t}}hr=0,oi=null,uu(o,c,S,5);break;case 6:hr=0,oi=null,uu(o,c,S,6);break;case 8:Cv(),rn=6;break e;default:throw Error(n(462))}}Fz();break}catch(Me){kC(o,Me)}while(!0);return vo=Lc=null,W.H=g,W.A=N,or=f,Ht!==null?0:(Nr=null,Vt=0,bp(),rn)}function Fz(){for(;Ht!==null&&!qe();)EC(Ht)}function EC(o){var c=Q_(o.alternate,o,To);o.memoizedProps=o.pendingProps,c===null?em(o):Ht=c}function AC(o){var c=o,f=c.alternate;switch(c.tag){case 15:case 0:c=G_(f,c,c.pendingProps,c.type,void 0,Vt);break;case 11:c=G_(f,c,c.pendingProps,c.type.render,c.ref,Vt);break;case 5:Fb(c);default:eC(f,c),c=Ht=CS(c,To),c=Q_(f,c,To)}o.memoizedProps=o.pendingProps,c===null?em(o):Ht=c}function uu(o,c,f,g){vo=Lc=null,Fb(c),eu=null,Th=0;var N=c.return;try{if(Oz(o,N,c,f,Vt)){rn=1,zp(o,Ai(f,o.current)),Ht=null;return}}catch(S){if(N!==null)throw Ht=N,S;rn=1,zp(o,Ai(f,o.current)),Ht=null;return}c.flags&32768?(Xt||g===1?o=!0:ou||(Vt&536870912)!==0?o=!1:(Pl=o=!0,(g===2||g===9||g===3||g===6)&&(g=ii.current,g!==null&&g.tag===13&&(g.flags|=16384))),TC(c,o)):em(c)}function em(o){var c=o;do{if((c.flags&32768)!==0){TC(c,Pl);return}o=c.return;var f=Rz(c.alternate,c,To);if(f!==null){Ht=f;return}if(c=c.sibling,c!==null){Ht=c;return}Ht=c=o}while(c!==null);rn===0&&(rn=5)}function TC(o,c){do{var f=Pz(o.alternate,o);if(f!==null){f.flags&=32767,Ht=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(o=o.sibling,o!==null)){Ht=o;return}Ht=o=f}while(o!==null);rn=6,Ht=null}function OC(o,c,f,g,N,S,z,J,ie){o.cancelPendingCommit=null;do tm();while(Sn!==0);if((or&6)!==0)throw Error(n(327));if(c!==null){if(c===o.current)throw Error(n(177));if(S=c.lanes|c.childLanes,S|=gb,wr(o,f,S,z,J,ie),o===Nr&&(Ht=Nr=null,Vt=0),cu=c,Bl=o,Oo=f,kv=S,Sv=N,vC=g,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Vz(nt,function(){return IC(),null})):(o.callbackNode=null,o.callbackPriority=0),g=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||g){g=W.T,W.T=null,N=V.p,V.p=2,z=or,or|=4;try{Iz(o,c,f)}finally{or=z,V.p=N,W.T=g}}Sn=1,MC(),LC(),RC()}}function MC(){if(Sn===1){Sn=0;var o=Bl,c=cu,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=W.T,W.T=null;var g=V.p;V.p=2;var N=or;or|=4;try{hC(c,o);var S=Uv,z=yS(o.containerInfo),J=S.focusedElem,ie=S.selectionRange;if(z!==J&&J&&J.ownerDocument&&xS(J.ownerDocument.documentElement,J)){if(ie!==null&&ub(J)){var be=ie.start,Me=ie.end;if(Me===void 0&&(Me=be),"selectionStart"in J)J.selectionStart=be,J.selectionEnd=Math.min(Me,J.value.length);else{var Ue=J.ownerDocument||document,Ne=Ue&&Ue.defaultView||window;if(Ne.getSelection){var Ae=Ne.getSelection(),at=J.textContent.length,St=Math.min(ie.start,at),br=ie.end===void 0?St:Math.min(ie.end,at);!Ae.extend&&St>br&&(z=br,br=St,St=z);var fe=gS(J,St),ce=gS(J,br);if(fe&&ce&&(Ae.rangeCount!==1||Ae.anchorNode!==fe.node||Ae.anchorOffset!==fe.offset||Ae.focusNode!==ce.node||Ae.focusOffset!==ce.offset)){var ye=Ue.createRange();ye.setStart(fe.node,fe.offset),Ae.removeAllRanges(),St>br?(Ae.addRange(ye),Ae.extend(ce.node,ce.offset)):(ye.setEnd(ce.node,ce.offset),Ae.addRange(ye))}}}}for(Ue=[],Ae=J;Ae=Ae.parentNode;)Ae.nodeType===1&&Ue.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof J.focus=="function"&&J.focus(),J=0;J<Ue.length;J++){var De=Ue[J];De.element.scrollLeft=De.left,De.element.scrollTop=De.top}}fm=!!$v,Uv=$v=null}finally{or=N,V.p=g,W.T=f}}o.current=c,Sn=2}}function LC(){if(Sn===2){Sn=0;var o=Bl,c=cu,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=W.T,W.T=null;var g=V.p;V.p=2;var N=or;or|=4;try{oC(o,c.alternate,c)}finally{or=N,V.p=g,W.T=f}}Sn=3}}function RC(){if(Sn===4||Sn===3){Sn=0,Xe();var o=Bl,c=cu,f=Oo,g=vC;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Sn=5:(Sn=0,cu=Bl=null,PC(o,o.pendingLanes));var N=o.pendingLanes;if(N===0&&(Dl=null),Ce(f),c=c.stateNode,yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(jt,c,void 0,(c.current.flags&128)===128)}catch{}if(g!==null){c=W.T,N=V.p,V.p=2,W.T=null;try{for(var S=o.onRecoverableError,z=0;z<g.length;z++){var J=g[z];S(J.value,{componentStack:J.stack})}}finally{W.T=c,V.p=N}}(Oo&3)!==0&&tm(),za(o),N=o.pendingLanes,(f&261930)!==0&&(N&42)!==0?o===_v?Vh++:(Vh=0,_v=o):Vh=0,Kh(0)}}function PC(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,Eh(c)))}function tm(){return MC(),LC(),RC(),IC()}function IC(){if(Sn!==5)return!1;var o=Bl,c=kv;kv=0;var f=Ce(Oo),g=W.T,N=V.p;try{V.p=32>f?32:f,W.T=null,f=Sv,Sv=null;var S=Bl,z=Oo;if(Sn=0,cu=Bl=null,Oo=0,(or&6)!==0)throw Error(n(331));var J=or;if(or|=4,xC(S.current),pC(S,S.current,z,f),or=J,Kh(0,!1),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(jt,S)}catch{}return!0}finally{V.p=N,W.T=g,PC(o,c)}}function DC(o,c,f){c=Ai(f,c),c=sv(o.stateNode,c,2),o=Ol(o,c,2),o!==null&&(Jt(o,2),za(o))}function fr(o,c,f){if(o.tag===3)DC(o,o,f);else for(;c!==null;){if(c.tag===3){DC(c,o,f);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Dl===null||!Dl.has(g))){o=Ai(f,o),f=B_(2),g=Ol(c,f,2),g!==null&&($_(f,g,c,o),Jt(g,2),za(g));break}}c=c.return}}function Av(o,c,f){var g=o.pingCache;if(g===null){g=o.pingCache=new $z;var N=new Set;g.set(c,N)}else N=g.get(c),N===void 0&&(N=new Set,g.set(c,N));N.has(f)||(wv=!0,N.add(f),o=Hz.bind(null,o,c,f),c.then(o,o))}function Hz(o,c,f){var g=o.pingCache;g!==null&&g.delete(c),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,Nr===o&&(Vt&f)===f&&(rn===4||rn===3&&(Vt&62914560)===Vt&&300>He()-Yp?(or&2)===0&&du(o,0):jv|=f,lu===Vt&&(lu=0)),za(o)}function BC(o,c){c===0&&(c=vt()),o=Tc(o,c),o!==null&&(Jt(o,c),za(o))}function Wz(o){var c=o.memoizedState,f=0;c!==null&&(f=c.retryLane),BC(o,f)}function Gz(o,c){var f=0;switch(o.tag){case 31:case 13:var g=o.stateNode,N=o.memoizedState;N!==null&&(f=N.retryLane);break;case 19:g=o.stateNode;break;case 22:g=o.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(c),BC(o,f)}function Vz(o,c){return Ie(o,c)}var rm=null,hu=null,Tv=!1,nm=!1,Ov=!1,Ul=0;function za(o){o!==hu&&o.next===null&&(hu===null?rm=hu=o:hu=hu.next=o),nm=!0,Tv||(Tv=!0,Yz())}function Kh(o,c){if(!Ov&&nm){Ov=!0;do for(var f=!1,g=rm;g!==null;){if(o!==0){var N=g.pendingLanes;if(N===0)var S=0;else{var z=g.suspendedLanes,J=g.pingedLanes;S=(1<<31-ot(42|o)+1)-1,S&=N&~(z&~J),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(f=!0,qC(g,S))}else S=Vt,S=pt(g,g===Nr?S:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(S&3)===0||he(g,S)||(f=!0,qC(g,S));g=g.next}while(f);Ov=!1}}function Kz(){$C()}function $C(){nm=Tv=!1;var o=0;Ul!==0&&iq()&&(o=Ul);for(var c=He(),f=null,g=rm;g!==null;){var N=g.next,S=UC(g,c);S===0?(g.next=null,f===null?rm=N:f.next=N,N===null&&(hu=f)):(f=g,(o!==0||(S&3)!==0)&&(nm=!0)),g=N}Sn!==0&&Sn!==5||Kh(o),Ul!==0&&(Ul=0)}function UC(o,c){for(var f=o.suspendedLanes,g=o.pingedLanes,N=o.expirationTimes,S=o.pendingLanes&-62914561;0<S;){var z=31-ot(S),J=1<<z,ie=N[z];ie===-1?((J&f)===0||(J&g)!==0)&&(N[z]=We(J,c)):ie<=c&&(o.expiredLanes|=J),S&=~J}if(c=Nr,f=Vt,f=pt(o,o===c?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g=o.callbackNode,f===0||o===c&&(hr===2||hr===9)||o.cancelPendingCommit!==null)return g!==null&&g!==null&&Fe(g),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||he(o,f)){if(c=f&-f,c===o.callbackPriority)return c;switch(g!==null&&Fe(g),Ce(f)){case 2:case 8:f=Ut;break;case 32:f=nt;break;case 268435456:f=mt;break;default:f=nt}return g=zC.bind(null,o),f=Ie(f,g),o.callbackPriority=c,o.callbackNode=f,c}return g!==null&&g!==null&&Fe(g),o.callbackPriority=2,o.callbackNode=null,2}function zC(o,c){if(Sn!==0&&Sn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(tm()&&o.callbackNode!==f)return null;var g=Vt;return g=pt(o,o===Nr?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g===0?null:(jC(o,g,c),UC(o,He()),o.callbackNode!=null&&o.callbackNode===f?zC.bind(null,o):null)}function qC(o,c){if(tm())return null;jC(o,c,!0)}function Yz(){oq(function(){(or&6)!==0?Ie(Tt,Kz):$C()})}function Mv(){if(Ul===0){var o=Jd;o===0&&(o=et,et<<=1,(et&261888)===0&&(et=256)),Ul=o}return Ul}function FC(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Ia(""+o)}function HC(o,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,o.id&&f.setAttribute("form",o.id),c.parentNode.insertBefore(f,c),o=new FormData(o),f.parentNode.removeChild(f),o}function Xz(o,c,f,g,N){if(c==="submit"&&f&&f.stateNode===N){var S=FC((N[lr]||null).action),z=g.submitter;z&&(c=(c=z[lr]||null)?FC(c.formAction):z.getAttribute("formAction"),c!==null&&(S=c,z=null));var J=new rt("action","action",null,g,N);o.push({event:J,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Ul!==0){var ie=z?HC(N,z):new FormData(N);Qb(f,{pending:!0,data:ie,method:N.method,action:S},null,ie)}}else typeof S=="function"&&(J.preventDefault(),ie=z?HC(N,z):new FormData(N),Qb(f,{pending:!0,data:ie,method:N.method,action:S},S,ie))},currentTarget:N}]})}}for(var Lv=0;Lv<mb.length;Lv++){var Rv=mb[Lv],Jz=Rv.toLowerCase(),Qz=Rv[0].toUpperCase()+Rv.slice(1);aa(Jz,"on"+Qz)}aa(wS,"onAnimationEnd"),aa(jS,"onAnimationIteration"),aa(NS,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(pz,"onTransitionRun"),aa(mz,"onTransitionStart"),aa(gz,"onTransitionCancel"),aa(kS,"onTransitionEnd"),Hn("onMouseEnter",["mouseout","mouseover"]),Hn("onMouseLeave",["mouseout","mouseover"]),Hn("onPointerEnter",["pointerout","pointerover"]),Hn("onPointerLeave",["pointerout","pointerover"]),bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bs("onBeforeInput",["compositionend","keypress","textInput","paste"]),bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zz=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yh));function WC(o,c){c=(c&4)!==0;for(var f=0;f<o.length;f++){var g=o[f],N=g.event;g=g.listeners;e:{var S=void 0;if(c)for(var z=g.length-1;0<=z;z--){var J=g[z],ie=J.instance,be=J.currentTarget;if(J=J.listener,ie!==S&&N.isPropagationStopped())break e;S=J,N.currentTarget=be;try{S(N)}catch(Me){yp(Me)}N.currentTarget=null,S=ie}else for(z=0;z<g.length;z++){if(J=g[z],ie=J.instance,be=J.currentTarget,J=J.listener,ie!==S&&N.isPropagationStopped())break e;S=J,N.currentTarget=be;try{S(N)}catch(Me){yp(Me)}N.currentTarget=null,S=ie}}}}function Wt(o,c){var f=c[Qt];f===void 0&&(f=c[Qt]=new Set);var g=o+"__bubble";f.has(g)||(GC(c,o,2,!1),f.add(g))}function Pv(o,c,f){var g=0;c&&(g|=4),GC(f,o,g,c)}var sm="_reactListening"+Math.random().toString(36).slice(2);function Iv(o){if(!o[sm]){o[sm]=!0,uo.forEach(function(f){f!=="selectionchange"&&(Zz.has(f)||Pv(f,!1,o),Pv(f,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[sm]||(c[sm]=!0,Pv("selectionchange",!1,c))}}function GC(o,c,f,g){switch(w3(c)){case 2:var N=Cq;break;case 8:N=Eq;break;default:N=Jv}f=N.bind(null,c,f,o),N=void 0,!Ci||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),g?N!==void 0?o.addEventListener(c,f,{capture:!0,passive:N}):o.addEventListener(c,f,!0):N!==void 0?o.addEventListener(c,f,{passive:N}):o.addEventListener(c,f,!1)}function Dv(o,c,f,g,N){var S=g;if((c&1)===0&&(c&2)===0&&g!==null)e:for(;;){if(g===null)return;var z=g.tag;if(z===3||z===4){var J=g.stateNode.containerInfo;if(J===N)break;if(z===4)for(z=g.return;z!==null;){var ie=z.tag;if((ie===3||ie===4)&&z.stateNode.containerInfo===N)return;z=z.return}for(;J!==null;){if(z=Mr(J),z===null)return;if(ie=z.tag,ie===5||ie===6||ie===26||ie===27){g=S=z;continue e}J=J.parentNode}}g=g.return}_i(function(){var be=S,Me=Gn(f),Ue=[];e:{var Ne=SS.get(o);if(Ne!==void 0){var Ae=rt,at=o;switch(o){case"keypress":if(D(f)===0)break e;case"keydown":case"keyup":Ae=gp;break;case"focusin":at="focus",Ae=Kn;break;case"focusout":at="blur",Ae=Kn;break;case"beforeblur":case"afterblur":Ae=Kn;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Rr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=Zr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=H;break;case wS:case jS:case NS:Ae=_c;break;case kS:Ae=xe;break;case"scroll":case"scrollend":Ae=$t;break;case"wheel":Ae=Ke;break;case"copy":case"cut":case"paste":Ae=go;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=j;break;case"toggle":case"beforetoggle":Ae=un}var St=(c&4)!==0,br=!St&&(o==="scroll"||o==="scrollend"),fe=St?Ne!==null?Ne+"Capture":null:Ne;St=[];for(var ce=be,ye;ce!==null;){var De=ce;if(ye=De.stateNode,De=De.tag,De!==5&&De!==26&&De!==27||ye===null||fe===null||(De=cs(ce,fe),De!=null&&St.push(Xh(ce,De,ye))),br)break;ce=ce.return}0<St.length&&(Ne=new Ae(Ne,at,null,f,Me),Ue.push({event:Ne,listeners:St}))}}if((c&7)===0){e:{if(Ne=o==="mouseover"||o==="pointerover",Ae=o==="mouseout"||o==="pointerout",Ne&&f!==cn&&(at=f.relatedTarget||f.fromElement)&&(Mr(at)||at[Ln]))break e;if((Ae||Ne)&&(Ne=Me.window===Me?Me:(Ne=Me.ownerDocument)?Ne.defaultView||Ne.parentWindow:window,Ae?(at=f.relatedTarget||f.toElement,Ae=be,at=at?Mr(at):null,at!==null&&(br=a(at),St=at.tag,at!==br||St!==5&&St!==27&&St!==6)&&(at=null)):(Ae=null,at=be),Ae!==at)){if(St=Rr,De="onMouseLeave",fe="onMouseEnter",ce="mouse",(o==="pointerout"||o==="pointerover")&&(St=j,De="onPointerLeave",fe="onPointerEnter",ce="pointer"),br=Ae==null?Ne:Fn(Ae),ye=at==null?Ne:Fn(at),Ne=new St(De,ce+"leave",Ae,f,Me),Ne.target=br,Ne.relatedTarget=ye,De=null,Mr(Me)===be&&(St=new St(fe,ce+"enter",at,f,Me),St.target=ye,St.relatedTarget=br,De=St),br=De,Ae&&at)t:{for(St=eq,fe=Ae,ce=at,ye=0,De=fe;De;De=St(De))ye++;De=0;for(var xt=ce;xt;xt=St(xt))De++;for(;0<ye-De;)fe=St(fe),ye--;for(;0<De-ye;)ce=St(ce),De--;for(;ye--;){if(fe===ce||ce!==null&&fe===ce.alternate){St=fe;break t}fe=St(fe),ce=St(ce)}St=null}else St=null;Ae!==null&&VC(Ue,Ne,Ae,St,!1),at!==null&&br!==null&&VC(Ue,br,at,St,!0)}}e:{if(Ne=be?Fn(be):window,Ae=Ne.nodeName&&Ne.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&Ne.type==="file")var nr=dS;else if(lS(Ne))if(uS)nr=uz;else{nr=cz;var ct=lz}else Ae=Ne.nodeName,!Ae||Ae.toLowerCase()!=="input"||Ne.type!=="checkbox"&&Ne.type!=="radio"?be&&Pa(be.elementType)&&(nr=dS):nr=dz;if(nr&&(nr=nr(o,be))){cS(Ue,nr,f,Me);break e}ct&&ct(o,Ne,be),o==="focusout"&&be&&Ne.type==="number"&&be.memoizedProps.value!=null&&fo(Ne,"number",Ne.value)}switch(ct=be?Fn(be):window,o){case"focusin":(lS(ct)||ct.contentEditable==="true")&&(Fd=ct,hb=be,Sh=null);break;case"focusout":Sh=hb=Fd=null;break;case"mousedown":fb=!0;break;case"contextmenu":case"mouseup":case"dragend":fb=!1,bS(Ue,f,Me);break;case"selectionchange":if(fz)break;case"keydown":case"keyup":bS(Ue,f,Me)}var Dt;if(en)e:{switch(o){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else qd?zd(o,f)&&(Kt="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(Kt="onCompositionStart");Kt&&(sa&&f.locale!=="ko"&&(qd||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&qd&&(Dt=mo()):(vs=Me,ta="value"in vs?vs.value:vs.textContent,qd=!0)),ct=im(be,Kt),0<ct.length&&(Kt=new Da(Kt,o,null,f,Me),Ue.push({event:Kt,listeners:ct}),Dt?Kt.data=Dt:(Dt=oS(f),Dt!==null&&(Kt.data=Dt)))),(Dt=xo?sz(o,f):iz(o,f))&&(Kt=im(be,"onBeforeInput"),0<Kt.length&&(ct=new Da("onBeforeInput","beforeinput",null,f,Me),Ue.push({event:ct,listeners:Kt}),ct.data=Dt)),Xz(Ue,o,be,f,Me)}WC(Ue,c)})}function Xh(o,c,f){return{instance:o,listener:c,currentTarget:f}}function im(o,c){for(var f=c+"Capture",g=[];o!==null;){var N=o,S=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||S===null||(N=cs(o,f),N!=null&&g.unshift(Xh(o,N,S)),N=cs(o,c),N!=null&&g.push(Xh(o,N,S))),o.tag===3)return g;o=o.return}return[]}function eq(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function VC(o,c,f,g,N){for(var S=c._reactName,z=[];f!==null&&f!==g;){var J=f,ie=J.alternate,be=J.stateNode;if(J=J.tag,ie!==null&&ie===g)break;J!==5&&J!==26&&J!==27||be===null||(ie=be,N?(be=cs(f,S),be!=null&&z.unshift(Xh(f,be,ie))):N||(be=cs(f,S),be!=null&&z.push(Xh(f,be,ie)))),f=f.return}z.length!==0&&o.push({event:c,listeners:z})}var tq=/\r\n?/g,rq=/\u0000|\uFFFD/g;function KC(o){return(typeof o=="string"?o:""+o).replace(tq,`
`).replace(rq,"")}function YC(o,c){return c=KC(c),KC(o)===c}function yr(o,c,f,g,N,S){switch(f){case"children":typeof g=="string"?c==="body"||c==="textarea"&&g===""||qr(o,g):(typeof g=="number"||typeof g=="bigint")&&c!=="body"&&qr(o,""+g);break;case"className":Wn(o,"class",g);break;case"tabIndex":Wn(o,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Wn(o,f,g);break;case"style":os(o,g,S);break;case"data":if(c!=="object"){Wn(o,"data",g);break}case"src":case"href":if(g===""&&(c!=="a"||f!=="href")){o.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(f);break}g=Ia(""+g),o.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(f==="formAction"?(c!=="input"&&yr(o,c,"name",N.name,N,null),yr(o,c,"formEncType",N.formEncType,N,null),yr(o,c,"formMethod",N.formMethod,N,null),yr(o,c,"formTarget",N.formTarget,N,null)):(yr(o,c,"encType",N.encType,N,null),yr(o,c,"method",N.method,N,null),yr(o,c,"target",N.target,N,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(f);break}g=Ia(""+g),o.setAttribute(f,g);break;case"onClick":g!=null&&(o.onclick=ls);break;case"onScroll":g!=null&&Wt("scroll",o);break;case"onScrollEnd":g!=null&&Wt("scrollend",o);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(f=g.__html,f!=null){if(N.children!=null)throw Error(n(60));o.innerHTML=f}}break;case"multiple":o.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":o.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){o.removeAttribute("xlink:href");break}f=Ia(""+g),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,""+g):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":g===!0?o.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,g):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?o.setAttribute(f,g):o.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?o.removeAttribute(f):o.setAttribute(f,g);break;case"popover":Wt("beforetoggle",o),Wt("toggle",o),Ma(o,"popover",g);break;case"xlinkActuate":zr(o,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":zr(o,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":zr(o,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":zr(o,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":zr(o,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":zr(o,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":zr(o,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":zr(o,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":zr(o,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Ma(o,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Nl.get(f)||f,Ma(o,f,g))}}function Bv(o,c,f,g,N,S){switch(f){case"style":os(o,g,S);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(f=g.__html,f!=null){if(N.children!=null)throw Error(n(60));o.innerHTML=f}}break;case"children":typeof g=="string"?qr(o,g):(typeof g=="number"||typeof g=="bigint")&&qr(o,""+g);break;case"onScroll":g!=null&&Wt("scroll",o);break;case"onScrollEnd":g!=null&&Wt("scrollend",o);break;case"onClick":g!=null&&(o.onclick=ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wi.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(N=f.endsWith("Capture"),c=f.slice(2,N?f.length-7:void 0),S=o[lr]||null,S=S!=null?S[f]:null,typeof S=="function"&&o.removeEventListener(c,S,N),typeof g=="function")){typeof S!="function"&&S!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(c,g,N);break e}f in o?o[f]=g:g===!0?o.setAttribute(f,""):Ma(o,f,g)}}}function Qn(o,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wt("error",o),Wt("load",o);var g=!1,N=!1,S;for(S in f)if(f.hasOwnProperty(S)){var z=f[S];if(z!=null)switch(S){case"src":g=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:yr(o,c,S,z,f,null)}}N&&yr(o,c,"srcSet",f.srcSet,f,null),g&&yr(o,c,"src",f.src,f,null);return;case"input":Wt("invalid",o);var J=S=z=N=null,ie=null,be=null;for(g in f)if(f.hasOwnProperty(g)){var Me=f[g];if(Me!=null)switch(g){case"name":N=Me;break;case"type":z=Me;break;case"checked":ie=Me;break;case"defaultChecked":be=Me;break;case"value":S=Me;break;case"defaultValue":J=Me;break;case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(n(137,c));break;default:yr(o,c,g,Me,f,null)}}Ra(o,S,J,ie,be,z,N,!1);return;case"select":Wt("invalid",o),g=z=S=null;for(N in f)if(f.hasOwnProperty(N)&&(J=f[N],J!=null))switch(N){case"value":S=J;break;case"defaultValue":z=J;break;case"multiple":g=J;default:yr(o,c,N,J,f,null)}c=S,f=z,o.multiple=!!g,c!=null?Ni(o,!!g,c,!1):f!=null&&Ni(o,!!g,f,!0);return;case"textarea":Wt("invalid",o),S=N=g=null;for(z in f)if(f.hasOwnProperty(z)&&(J=f[z],J!=null))switch(z){case"value":g=J;break;case"defaultValue":N=J;break;case"children":S=J;break;case"dangerouslySetInnerHTML":if(J!=null)throw Error(n(91));break;default:yr(o,c,z,J,f,null)}mn(o,g,N,S);return;case"option":for(ie in f)f.hasOwnProperty(ie)&&(g=f[ie],g!=null)&&(ie==="selected"?o.selected=g&&typeof g!="function"&&typeof g!="symbol":yr(o,c,ie,g,f,null));return;case"dialog":Wt("beforetoggle",o),Wt("toggle",o),Wt("cancel",o),Wt("close",o);break;case"iframe":case"object":Wt("load",o);break;case"video":case"audio":for(g=0;g<Yh.length;g++)Wt(Yh[g],o);break;case"image":Wt("error",o),Wt("load",o);break;case"details":Wt("toggle",o);break;case"embed":case"source":case"link":Wt("error",o),Wt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in f)if(f.hasOwnProperty(be)&&(g=f[be],g!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:yr(o,c,be,g,f,null)}return;default:if(Pa(c)){for(Me in f)f.hasOwnProperty(Me)&&(g=f[Me],g!==void 0&&Bv(o,c,Me,g,f,void 0));return}}for(J in f)f.hasOwnProperty(J)&&(g=f[J],g!=null&&yr(o,c,J,g,f,null))}function nq(o,c,f,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,S=null,z=null,J=null,ie=null,be=null,Me=null;for(Ae in f){var Ue=f[Ae];if(f.hasOwnProperty(Ae)&&Ue!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":ie=Ue;default:g.hasOwnProperty(Ae)||yr(o,c,Ae,null,g,Ue)}}for(var Ne in g){var Ae=g[Ne];if(Ue=f[Ne],g.hasOwnProperty(Ne)&&(Ae!=null||Ue!=null))switch(Ne){case"type":S=Ae;break;case"name":N=Ae;break;case"checked":be=Ae;break;case"defaultChecked":Me=Ae;break;case"value":z=Ae;break;case"defaultValue":J=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,c));break;default:Ae!==Ue&&yr(o,c,Ne,Ae,g,Ue)}}La(o,z,J,ie,be,Me,S,N);return;case"select":Ae=z=J=Ne=null;for(S in f)if(ie=f[S],f.hasOwnProperty(S)&&ie!=null)switch(S){case"value":break;case"multiple":Ae=ie;default:g.hasOwnProperty(S)||yr(o,c,S,null,g,ie)}for(N in g)if(S=g[N],ie=f[N],g.hasOwnProperty(N)&&(S!=null||ie!=null))switch(N){case"value":Ne=S;break;case"defaultValue":J=S;break;case"multiple":z=S;default:S!==ie&&yr(o,c,N,S,g,ie)}c=J,f=z,g=Ae,Ne!=null?Ni(o,!!f,Ne,!1):!!g!=!!f&&(c!=null?Ni(o,!!f,c,!0):Ni(o,!!f,f?[]:"",!1));return;case"textarea":Ae=Ne=null;for(J in f)if(N=f[J],f.hasOwnProperty(J)&&N!=null&&!g.hasOwnProperty(J))switch(J){case"value":break;case"children":break;default:yr(o,c,J,null,g,N)}for(z in g)if(N=g[z],S=f[z],g.hasOwnProperty(z)&&(N!=null||S!=null))switch(z){case"value":Ne=N;break;case"defaultValue":Ae=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(n(91));break;default:N!==S&&yr(o,c,z,N,g,S)}ki(o,Ne,Ae);return;case"option":for(var at in f)Ne=f[at],f.hasOwnProperty(at)&&Ne!=null&&!g.hasOwnProperty(at)&&(at==="selected"?o.selected=!1:yr(o,c,at,null,g,Ne));for(ie in g)Ne=g[ie],Ae=f[ie],g.hasOwnProperty(ie)&&Ne!==Ae&&(Ne!=null||Ae!=null)&&(ie==="selected"?o.selected=Ne&&typeof Ne!="function"&&typeof Ne!="symbol":yr(o,c,ie,Ne,g,Ae));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var St in f)Ne=f[St],f.hasOwnProperty(St)&&Ne!=null&&!g.hasOwnProperty(St)&&yr(o,c,St,null,g,Ne);for(be in g)if(Ne=g[be],Ae=f[be],g.hasOwnProperty(be)&&Ne!==Ae&&(Ne!=null||Ae!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,c));break;default:yr(o,c,be,Ne,g,Ae)}return;default:if(Pa(c)){for(var br in f)Ne=f[br],f.hasOwnProperty(br)&&Ne!==void 0&&!g.hasOwnProperty(br)&&Bv(o,c,br,void 0,g,Ne);for(Me in g)Ne=g[Me],Ae=f[Me],!g.hasOwnProperty(Me)||Ne===Ae||Ne===void 0&&Ae===void 0||Bv(o,c,Me,Ne,g,Ae);return}}for(var fe in f)Ne=f[fe],f.hasOwnProperty(fe)&&Ne!=null&&!g.hasOwnProperty(fe)&&yr(o,c,fe,null,g,Ne);for(Ue in g)Ne=g[Ue],Ae=f[Ue],!g.hasOwnProperty(Ue)||Ne===Ae||Ne==null&&Ae==null||yr(o,c,Ue,Ne,g,Ae)}function XC(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function sq(){if(typeof performance.getEntriesByType=="function"){for(var o=0,c=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var N=f[g],S=N.transferSize,z=N.initiatorType,J=N.duration;if(S&&J&&XC(z)){for(z=0,J=N.responseEnd,g+=1;g<f.length;g++){var ie=f[g],be=ie.startTime;if(be>J)break;var Me=ie.transferSize,Ue=ie.initiatorType;Me&&XC(Ue)&&(ie=ie.responseEnd,z+=Me*(ie<J?1:(J-be)/(ie-be)))}if(--g,c+=8*(S+z)/(N.duration/1e3),o++,10<o)break}}if(0<o)return c/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var $v=null,Uv=null;function am(o){return o.nodeType===9?o:o.ownerDocument}function JC(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QC(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function zv(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var qv=null;function iq(){var o=window.event;return o&&o.type==="popstate"?o===qv?!1:(qv=o,!0):(qv=null,!1)}var ZC=typeof setTimeout=="function"?setTimeout:void 0,aq=typeof clearTimeout=="function"?clearTimeout:void 0,e3=typeof Promise=="function"?Promise:void 0,oq=typeof queueMicrotask=="function"?queueMicrotask:typeof e3<"u"?function(o){return e3.resolve(null).then(o).catch(lq)}:ZC;function lq(o){setTimeout(function(){throw o})}function zl(o){return o==="head"}function t3(o,c){var f=c,g=0;do{var N=f.nextSibling;if(o.removeChild(f),N&&N.nodeType===8)if(f=N.data,f==="/$"||f==="/&"){if(g===0){o.removeChild(N),gu(c);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Jh(o.ownerDocument.documentElement);else if(f==="head"){f=o.ownerDocument.head,Jh(f);for(var S=f.firstChild;S;){var z=S.nextSibling,J=S.nodeName;S[Ls]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&S.rel.toLowerCase()==="stylesheet"||f.removeChild(S),S=z}}else f==="body"&&Jh(o.ownerDocument.body);f=N}while(f);gu(c)}function r3(o,c){var f=o;o=0;do{var g=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(o===0)break;o--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||o++;f=g}while(f)}function Fv(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Fv(f),Oa(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function cq(o,c,f,g){for(;o.nodeType===1;){var N=f;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!g&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(g){if(!o[Ls])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(S=o.getAttribute("rel"),S==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(S!==N.rel||o.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||o.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||o.getAttribute("title")!==(N.title==null?null:N.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(S=o.getAttribute("src"),(S!==(N.src==null?null:N.src)||o.getAttribute("type")!==(N.type==null?null:N.type)||o.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&S&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var S=N.name==null?null:""+N.name;if(N.type==="hidden"&&o.getAttribute("name")===S)return o}else return o;if(o=Ri(o.nextSibling),o===null)break}return null}function dq(o,c,f){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=Ri(o.nextSibling),o===null))return null;return o}function n3(o,c){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!c||(o=Ri(o.nextSibling),o===null))return null;return o}function Hv(o){return o.data==="$?"||o.data==="$~"}function Wv(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function uq(o,c){var f=o.ownerDocument;if(o.data==="$~")o._reactRetry=c;else if(o.data!=="$?"||f.readyState!=="loading")c();else{var g=function(){c(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),o._reactRetry=g}}function Ri(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return o}var Gv=null;function s3(o){o=o.nextSibling;for(var c=0;o;){if(o.nodeType===8){var f=o.data;if(f==="/$"||f==="/&"){if(c===0)return Ri(o.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}o=o.nextSibling}return null}function i3(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return o;c--}else f!=="/$"&&f!=="/&"||c++}o=o.previousSibling}return null}function a3(o,c,f){switch(c=am(f),o){case"html":if(o=c.documentElement,!o)throw Error(n(452));return o;case"head":if(o=c.head,!o)throw Error(n(453));return o;case"body":if(o=c.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function Jh(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);Oa(o)}var Pi=new Map,o3=new Set;function om(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Mo=V.d;V.d={f:hq,r:fq,D:pq,C:mq,L:gq,m:xq,X:bq,S:yq,M:vq};function hq(){var o=Mo.f(),c=Qp();return o||c}function fq(o){var c=is(o);c!==null&&c.tag===5&&c.type==="form"?k_(c):Mo.r(o)}var fu=typeof document>"u"?null:document;function l3(o,c,f){var g=fu;if(g&&typeof c=="string"&&c){var N=Rn(c);N='link[rel="'+o+'"][href="'+N+'"]',typeof f=="string"&&(N+='[crossorigin="'+f+'"]'),o3.has(N)||(o3.add(N),o={rel:o,crossOrigin:f,href:c},g.querySelector(N)===null&&(c=g.createElement("link"),Qn(c,"link",o),Ur(c),g.head.appendChild(c)))}}function pq(o){Mo.D(o),l3("dns-prefetch",o,null)}function mq(o,c){Mo.C(o,c),l3("preconnect",o,c)}function gq(o,c,f){Mo.L(o,c,f);var g=fu;if(g&&o&&c){var N='link[rel="preload"][as="'+Rn(c)+'"]';c==="image"&&f&&f.imageSrcSet?(N+='[imagesrcset="'+Rn(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(N+='[imagesizes="'+Rn(f.imageSizes)+'"]')):N+='[href="'+Rn(o)+'"]';var S=N;switch(c){case"style":S=pu(o);break;case"script":S=mu(o)}Pi.has(S)||(o=m({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:o,as:c},f),Pi.set(S,o),g.querySelector(N)!==null||c==="style"&&g.querySelector(Qh(S))||c==="script"&&g.querySelector(Zh(S))||(c=g.createElement("link"),Qn(c,"link",o),Ur(c),g.head.appendChild(c)))}}function xq(o,c){Mo.m(o,c);var f=fu;if(f&&o){var g=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Rn(g)+'"][href="'+Rn(o)+'"]',S=N;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=mu(o)}if(!Pi.has(S)&&(o=m({rel:"modulepreload",href:o},c),Pi.set(S,o),f.querySelector(N)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Zh(S)))return}g=f.createElement("link"),Qn(g,"link",o),Ur(g),f.head.appendChild(g)}}}function yq(o,c,f){Mo.S(o,c,f);var g=fu;if(g&&o){var N=Rs(g).hoistableStyles,S=pu(o);c=c||"default";var z=N.get(S);if(!z){var J={loading:0,preload:null};if(z=g.querySelector(Qh(S)))J.loading=5;else{o=m({rel:"stylesheet",href:o,"data-precedence":c},f),(f=Pi.get(S))&&Vv(o,f);var ie=z=g.createElement("link");Ur(ie),Qn(ie,"link",o),ie._p=new Promise(function(be,Me){ie.onload=be,ie.onerror=Me}),ie.addEventListener("load",function(){J.loading|=1}),ie.addEventListener("error",function(){J.loading|=2}),J.loading|=4,lm(z,c,g)}z={type:"stylesheet",instance:z,count:1,state:J},N.set(S,z)}}}function bq(o,c){Mo.X(o,c);var f=fu;if(f&&o){var g=Rs(f).hoistableScripts,N=mu(o),S=g.get(N);S||(S=f.querySelector(Zh(N)),S||(o=m({src:o,async:!0},c),(c=Pi.get(N))&&Kv(o,c),S=f.createElement("script"),Ur(S),Qn(S,"link",o),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(N,S))}}function vq(o,c){Mo.M(o,c);var f=fu;if(f&&o){var g=Rs(f).hoistableScripts,N=mu(o),S=g.get(N);S||(S=f.querySelector(Zh(N)),S||(o=m({src:o,async:!0,type:"module"},c),(c=Pi.get(N))&&Kv(o,c),S=f.createElement("script"),Ur(S),Qn(S,"link",o),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(N,S))}}function c3(o,c,f,g){var N=(N=Le.current)?om(N):null;if(!N)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=pu(f.href),f=Rs(N).hoistableStyles,g=f.get(c),g||(g={type:"style",instance:null,count:0,state:null},f.set(c,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=pu(f.href);var S=Rs(N).hoistableStyles,z=S.get(o);if(z||(N=N.ownerDocument||N,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(o,z),(S=N.querySelector(Qh(o)))&&!S._p&&(z.instance=S,z.state.loading=5),Pi.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Pi.set(o,f),S||wq(N,o,f,z.state))),c&&g===null)throw Error(n(528,""));return z}if(c&&g!==null)throw Error(n(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=mu(f),f=Rs(N).hoistableScripts,g=f.get(c),g||(g={type:"script",instance:null,count:0,state:null},f.set(c,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function pu(o){return'href="'+Rn(o)+'"'}function Qh(o){return'link[rel="stylesheet"]['+o+"]"}function d3(o){return m({},o,{"data-precedence":o.precedence,precedence:null})}function wq(o,c,f,g){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?g.loading=1:(c=o.createElement("link"),g.preload=c,c.addEventListener("load",function(){return g.loading|=1}),c.addEventListener("error",function(){return g.loading|=2}),Qn(c,"link",f),Ur(c),o.head.appendChild(c))}function mu(o){return'[src="'+Rn(o)+'"]'}function Zh(o){return"script[async]"+o}function u3(o,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var g=o.querySelector('style[data-href~="'+Rn(f.href)+'"]');if(g)return c.instance=g,Ur(g),g;var N=m({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(o.ownerDocument||o).createElement("style"),Ur(g),Qn(g,"style",N),lm(g,f.precedence,o),c.instance=g;case"stylesheet":N=pu(f.href);var S=o.querySelector(Qh(N));if(S)return c.state.loading|=4,c.instance=S,Ur(S),S;g=d3(f),(N=Pi.get(N))&&Vv(g,N),S=(o.ownerDocument||o).createElement("link"),Ur(S);var z=S;return z._p=new Promise(function(J,ie){z.onload=J,z.onerror=ie}),Qn(S,"link",g),c.state.loading|=4,lm(S,f.precedence,o),c.instance=S;case"script":return S=mu(f.src),(N=o.querySelector(Zh(S)))?(c.instance=N,Ur(N),N):(g=f,(N=Pi.get(S))&&(g=m({},f),Kv(g,N)),o=o.ownerDocument||o,N=o.createElement("script"),Ur(N),Qn(N,"link",g),o.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(n(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(g=c.instance,c.state.loading|=4,lm(g,f.precedence,o));return c.instance}function lm(o,c,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=g.length?g[g.length-1]:null,S=N,z=0;z<g.length;z++){var J=g[z];if(J.dataset.precedence===c)S=J;else if(S!==N)break}S?S.parentNode.insertBefore(o,S.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(o,c.firstChild))}function Vv(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function Kv(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var cm=null;function h3(o,c,f){if(cm===null){var g=new Map,N=cm=new Map;N.set(f,g)}else N=cm,g=N.get(f),g||(g=new Map,N.set(f,g));if(g.has(o))return g;for(g.set(o,null),f=f.getElementsByTagName(o),N=0;N<f.length;N++){var S=f[N];if(!(S[Ls]||S[Lt]||o==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var z=S.getAttribute(c)||"";z=o+z;var J=g.get(z);J?J.push(S):g.set(z,[S])}}return g}function f3(o,c,f){o=o.ownerDocument||o,o.head.insertBefore(f,c==="title"?o.querySelector("head > title"):null)}function jq(o,c,f){if(f===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(o=c.disabled,typeof c.precedence=="string"&&o==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function p3(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function Nq(o,c,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var N=pu(g.href),S=c.querySelector(Qh(N));if(S){c=S._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(o.count++,o=dm.bind(o),c.then(o,o)),f.state.loading|=4,f.instance=S,Ur(S);return}S=c.ownerDocument||c,g=d3(g),(N=Pi.get(N))&&Vv(g,N),S=S.createElement("link"),Ur(S);var z=S;z._p=new Promise(function(J,ie){z.onload=J,z.onerror=ie}),Qn(S,"link",g),f.instance=S}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(o.count++,f=dm.bind(o),c.addEventListener("load",f),c.addEventListener("error",f))}}var Yv=0;function kq(o,c){return o.stylesheets&&o.count===0&&hm(o,o.stylesheets),0<o.count||0<o.imgCount?function(f){var g=setTimeout(function(){if(o.stylesheets&&hm(o,o.stylesheets),o.unsuspend){var S=o.unsuspend;o.unsuspend=null,S()}},6e4+c);0<o.imgBytes&&Yv===0&&(Yv=62500*sq());var N=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&hm(o,o.stylesheets),o.unsuspend)){var S=o.unsuspend;o.unsuspend=null,S()}},(o.imgBytes>Yv?50:800)+c);return o.unsuspend=f,function(){o.unsuspend=null,clearTimeout(g),clearTimeout(N)}}:null}function dm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hm(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var um=null;function hm(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,um=new Map,c.forEach(Sq,o),um=null,dm.call(o))}function Sq(o,c){if(!(c.state.loading&4)){var f=um.get(o);if(f)var g=f.get(null);else{f=new Map,um.set(o,f);for(var N=o.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<N.length;S++){var z=N[S];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(f.set(z.dataset.precedence,z),g=z)}g&&f.set(null,g)}N=c.instance,z=N.getAttribute("data-precedence"),S=f.get(z)||g,S===g&&f.set(null,N),f.set(z,N),this.count++,g=dm.bind(this),N.addEventListener("load",g),N.addEventListener("error",g),S?S.parentNode.insertBefore(N,S.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(N,o.firstChild)),c.state.loading|=4}}var ef={$$typeof:A,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function _q(o,c,f,g,N,S,z,J,ie){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=At(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=At(0),this.hiddenUpdates=At(null),this.identifierPrefix=g,this.onUncaughtError=N,this.onCaughtError=S,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ie,this.incompleteTransitions=new Map}function m3(o,c,f,g,N,S,z,J,ie,be,Me,Ue){return o=new _q(o,c,f,z,ie,be,Me,Ue,J),c=1,S===!0&&(c|=24),S=si(3,null,null,c),o.current=S,S.stateNode=o,c=Eb(),c.refCount++,o.pooledCache=c,c.refCount++,S.memoizedState={element:g,isDehydrated:f,cache:c},Mb(S),o}function g3(o){return o?(o=Gd,o):Gd}function x3(o,c,f,g,N,S){N=g3(N),g.context===null?g.context=N:g.pendingContext=N,g=Tl(c),g.payload={element:f},S=S===void 0?null:S,S!==null&&(g.callback=S),f=Ol(o,g,c),f!==null&&(qs(f,o,c),Mh(f,o,c))}function y3(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<c?f:c}}function Xv(o,c){y3(o,c),(o=o.alternate)&&y3(o,c)}function b3(o){if(o.tag===13||o.tag===31){var c=Tc(o,67108864);c!==null&&qs(c,o,67108864),Xv(o,67108864)}}function v3(o){if(o.tag===13||o.tag===31){var c=ci();c=je(c);var f=Tc(o,c);f!==null&&qs(f,o,c),Xv(o,c)}}var fm=!0;function Cq(o,c,f,g){var N=W.T;W.T=null;var S=V.p;try{V.p=2,Jv(o,c,f,g)}finally{V.p=S,W.T=N}}function Eq(o,c,f,g){var N=W.T;W.T=null;var S=V.p;try{V.p=8,Jv(o,c,f,g)}finally{V.p=S,W.T=N}}function Jv(o,c,f,g){if(fm){var N=Qv(g);if(N===null)Dv(o,c,g,pm,f),j3(o,g);else if(Tq(N,o,c,f,g))g.stopPropagation();else if(j3(o,g),c&4&&-1<Aq.indexOf(o)){for(;N!==null;){var S=is(N);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var z=Je(S.pendingLanes);if(z!==0){var J=S;for(J.pendingLanes|=2,J.entangledLanes|=2;z;){var ie=1<<31-ot(z);J.entanglements[1]|=ie,z&=~ie}za(S),(or&6)===0&&(Xp=He()+500,Kh(0))}}break;case 31:case 13:J=Tc(S,2),J!==null&&qs(J,S,2),Qp(),Xv(S,2)}if(S=Qv(g),S===null&&Dv(o,c,g,pm,f),S===N)break;N=S}N!==null&&g.stopPropagation()}else Dv(o,c,g,null,f)}}function Qv(o){return o=Gn(o),Zv(o)}var pm=null;function Zv(o){if(pm=null,o=Mr(o),o!==null){var c=a(o);if(c===null)o=null;else{var f=c.tag;if(f===13){if(o=l(c),o!==null)return o;o=null}else if(f===31){if(o=d(c),o!==null)return o;o=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return pm=o,null}function w3(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ut()){case Tt:return 2;case Ut:return 8;case nt:case kt:return 32;case mt:return 268435456;default:return 32}default:return 32}}var e1=!1,ql=null,Fl=null,Hl=null,tf=new Map,rf=new Map,Wl=[],Aq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function j3(o,c){switch(o){case"focusin":case"focusout":ql=null;break;case"dragenter":case"dragleave":Fl=null;break;case"mouseover":case"mouseout":Hl=null;break;case"pointerover":case"pointerout":tf.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":rf.delete(c.pointerId)}}function nf(o,c,f,g,N,S){return o===null||o.nativeEvent!==S?(o={blockedOn:c,domEventName:f,eventSystemFlags:g,nativeEvent:S,targetContainers:[N]},c!==null&&(c=is(c),c!==null&&b3(c)),o):(o.eventSystemFlags|=g,c=o.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),o)}function Tq(o,c,f,g,N){switch(c){case"focusin":return ql=nf(ql,o,c,f,g,N),!0;case"dragenter":return Fl=nf(Fl,o,c,f,g,N),!0;case"mouseover":return Hl=nf(Hl,o,c,f,g,N),!0;case"pointerover":var S=N.pointerId;return tf.set(S,nf(tf.get(S)||null,o,c,f,g,N)),!0;case"gotpointercapture":return S=N.pointerId,rf.set(S,nf(rf.get(S)||null,o,c,f,g,N)),!0}return!1}function N3(o){var c=Mr(o.target);if(c!==null){var f=a(c);if(f!==null){if(c=f.tag,c===13){if(c=l(f),c!==null){o.blockedOn=c,Ze(o.priority,function(){v3(f)});return}}else if(c===31){if(c=d(f),c!==null){o.blockedOn=c,Ze(o.priority,function(){v3(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function mm(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var f=Qv(o.nativeEvent);if(f===null){f=o.nativeEvent;var g=new f.constructor(f.type,f);cn=g,f.target.dispatchEvent(g),cn=null}else return c=is(f),c!==null&&b3(c),o.blockedOn=f,!1;c.shift()}return!0}function k3(o,c,f){mm(o)&&f.delete(c)}function Oq(){e1=!1,ql!==null&&mm(ql)&&(ql=null),Fl!==null&&mm(Fl)&&(Fl=null),Hl!==null&&mm(Hl)&&(Hl=null),tf.forEach(k3),rf.forEach(k3)}function gm(o,c){o.blockedOn===c&&(o.blockedOn=null,e1||(e1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Oq)))}var xm=null;function S3(o){xm!==o&&(xm=o,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){xm===o&&(xm=null);for(var c=0;c<o.length;c+=3){var f=o[c],g=o[c+1],N=o[c+2];if(typeof g!="function"){if(Zv(g||f)===null)continue;break}var S=is(f);S!==null&&(o.splice(c,3),c-=3,Qb(S,{pending:!0,data:N,method:f.method,action:g},g,N))}}))}function gu(o){function c(ie){return gm(ie,o)}ql!==null&&gm(ql,o),Fl!==null&&gm(Fl,o),Hl!==null&&gm(Hl,o),tf.forEach(c),rf.forEach(c);for(var f=0;f<Wl.length;f++){var g=Wl[f];g.blockedOn===o&&(g.blockedOn=null)}for(;0<Wl.length&&(f=Wl[0],f.blockedOn===null);)N3(f),f.blockedOn===null&&Wl.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var N=f[g],S=f[g+1],z=N[lr]||null;if(typeof S=="function")z||S3(f);else if(z){var J=null;if(S&&S.hasAttribute("formAction")){if(N=S,z=S[lr]||null)J=z.formAction;else if(Zv(N)!==null)continue}else J=z.action;typeof J=="function"?f[g+1]=J:(f.splice(g,3),g-=3),S3(f)}}}function _3(){function o(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(z){return N=z})},focusReset:"manual",scroll:"manual"})}function c(){N!==null&&(N(),N=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,N=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),N!==null&&(N(),N=null)}}}function t1(o){this._internalRoot=o}ym.prototype.render=t1.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(n(409));var f=c.current,g=ci();x3(f,g,o,c,null,null)},ym.prototype.unmount=t1.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;x3(o.current,2,null,o,null,null),Qp(),c[Ln]=null}};function ym(o){this._internalRoot=o}ym.prototype.unstable_scheduleHydration=function(o){if(o){var c=Oe();o={blockedOn:null,target:o,priority:c};for(var f=0;f<Wl.length&&c!==0&&c<Wl[f].priority;f++);Wl.splice(f,0,o),f===0&&N3(o)}};var C3=e.version;if(C3!=="19.2.3")throw Error(n(527,C3,"19.2.3"));V.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=h(c),o=o!==null?p(o):null,o=o===null?null:o.stateNode,o};var Mq={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bm.isDisabled&&bm.supportsFiber)try{jt=bm.inject(Mq),yt=bm}catch{}}return af.createRoot=function(o,c){if(!i(o))throw Error(n(299));var f=!1,g="",N=R_,S=P_,z=I_;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(z=c.onRecoverableError)),c=m3(o,1,!1,null,null,f,g,null,N,S,z,_3),o[Ln]=c.current,Iv(o),new t1(c)},af.hydrateRoot=function(o,c,f){if(!i(o))throw Error(n(299));var g=!1,N="",S=R_,z=P_,J=I_,ie=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(N=f.identifierPrefix),f.onUncaughtError!==void 0&&(S=f.onUncaughtError),f.onCaughtError!==void 0&&(z=f.onCaughtError),f.onRecoverableError!==void 0&&(J=f.onRecoverableError),f.formState!==void 0&&(ie=f.formState)),c=m3(o,1,!0,c,f??null,g,N,ie,S,z,J,_3),c.context=g3(null),f=c.current,g=ci(),g=je(g),N=Tl(g),N.callback=null,Ol(f,N,g),f=g,c.current.lanes=f,Jt(c,f),za(c),o[Ln]=c.current,Iv(o),new ym(c)},af.version="19.2.3",af}var D3;function Hq(){if(D3)return s1.exports;D3=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),s1.exports=Fq(),s1.exports}var Wq=Hq();const Gq=Ms(Wq);var B3="popstate";function Vq(t={}){function e(n,i){let{pathname:a,search:l,hash:d}=n.location;return nj("",{pathname:a,search:l,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Hf(i)}return Yq(e,r,null,t)}function Xr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Gi(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Kq(){return Math.random().toString(36).substring(2,10)}function $3(t,e){return{usr:t.state,key:t.key,idx:e}}function nj(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ih(e):e,state:r,key:e&&e.key||n||Kq()}}function Hf({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ih(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function Yq(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,l=i.history,d="POP",u=null,h=p();h==null&&(h=0,l.replaceState({...l.state,idx:h},""));function p(){return(l.state||{idx:null}).idx}function m(){d="POP";let k=p(),_=k==null?null:k-h;h=k,u&&u({action:d,location:w.location,delta:_})}function x(k,_){d="PUSH";let T=nj(w.location,k,_);h=p()+1;let A=$3(T,h),I=w.createHref(T);try{l.pushState(A,"",I)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(I)}a&&u&&u({action:d,location:w.location,delta:1})}function b(k,_){d="REPLACE";let T=nj(w.location,k,_);h=p();let A=$3(T,h),I=w.createHref(T);l.replaceState(A,"",I),a&&u&&u({action:d,location:w.location,delta:0})}function v(k){return Xq(k)}let w={get action(){return d},get location(){return t(i,l)},listen(k){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(B3,m),u=k,()=>{i.removeEventListener(B3,m),u=null}},createHref(k){return e(i,k)},createURL:v,encodeLocation(k){let _=v(k);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:x,replace:b,go(k){return l.go(k)}};return w}function Xq(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Xr(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Hf(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function JL(t,e,r="/"){return Jq(t,e,r,!1)}function Jq(t,e,r,n){let i=typeof e=="string"?ih(e):e,a=Ko(i.pathname||"/",r);if(a==null)return null;let l=QL(t);Qq(l);let d=null;for(let u=0;d==null&&u<l.length;++u){let h=cF(a);d=oF(l[u],h,n)}return d}function QL(t,e=[],r=[],n="",i=!1){let a=(l,d,u=i,h)=>{let p={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&u)return;Xr(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let m=Wo([n,p.relativePath]),x=r.concat(p);l.children&&l.children.length>0&&(Xr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),QL(l.children,e,x,m,u)),!(l.path==null&&!l.index)&&e.push({path:m,score:iF(m,l.index),routesMeta:x})};return t.forEach((l,d)=>{if(l.path===""||!l.path?.includes("?"))a(l,d);else for(let u of ZL(l.path))a(l,d,!0,u)}),e}function ZL(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let l=ZL(n.join("/")),d=[];return d.push(...l.map(u=>u===""?a:[a,u].join("/"))),i&&d.push(...l),d.map(u=>t.startsWith("/")&&u===""?"/":u)}function Qq(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:aF(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var Zq=/^:[\w-]+$/,eF=3,tF=2,rF=1,nF=10,sF=-2,U3=t=>t==="*";function iF(t,e){let r=t.split("/"),n=r.length;return r.some(U3)&&(n+=sF),e&&(n+=tF),r.filter(i=>!U3(i)).reduce((i,a)=>i+(Zq.test(a)?eF:a===""?rF:nF),n)}function aF(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function oF(t,e,r=!1){let{routesMeta:n}=t,i={},a="/",l=[];for(let d=0;d<n.length;++d){let u=n[d],h=d===n.length-1,p=a==="/"?e:e.slice(a.length)||"/",m=Mg({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},p),x=u.route;if(!m&&h&&r&&!n[n.length-1].route.index&&(m=Mg({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},p)),!m)return null;Object.assign(i,m.params),l.push({params:i,pathname:Wo([a,m.pathname]),pathnameBase:fF(Wo([a,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(a=Wo([a,m.pathnameBase]))}return l}function Mg(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=lF(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),d=i.slice(1);return{params:n.reduce((h,{paramName:p,isOptional:m},x)=>{if(p==="*"){let v=d[x]||"";l=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const b=d[x];return m&&!b?h[p]=void 0:h[p]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:l,pattern:t}}function lF(t,e=!1,r=!0){Gi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,u)=>(n.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function cF(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ko(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var eR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dF=t=>eR.test(t);function uF(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ih(t):t,a;if(r)if(dF(r))a=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Gi(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${r}`)}r.startsWith("/")?a=z3(r.substring(1),"/"):a=z3(r,e)}else a=e;return{pathname:a,search:pF(n),hash:mF(i)}}function z3(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function l1(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hF(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function tR(t){let e=hF(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function rR(t,e,r,n=!1){let i;typeof t=="string"?i=ih(t):(i={...t},Xr(!i.pathname||!i.pathname.includes("?"),l1("?","pathname","search",i)),Xr(!i.pathname||!i.pathname.includes("#"),l1("#","pathname","hash",i)),Xr(!i.search||!i.search.includes("#"),l1("#","search","hash",i)));let a=t===""||i.pathname==="",l=a?"/":i.pathname,d;if(l==null)d=r;else{let m=e.length-1;if(!n&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),m-=1;i.pathname=x.join("/")}d=m>=0?e[m]:"/"}let u=uF(i,d),h=l&&l!=="/"&&l.endsWith("/"),p=(a||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||p)&&(u.pathname+="/"),u}var Wo=t=>t.join("/").replace(/\/\/+/g,"/"),fF=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),pF=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mF=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,gF=class{constructor(t,e,r,n=!1){this.status=t,this.statusText=e||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function xF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function yF(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var nR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function sR(t,e){let r=t;if(typeof r!="string"||!eR.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,i=!1;if(nR)try{let a=new URL(window.location.href),l=r.startsWith("//")?new URL(a.protocol+r):new URL(r),d=Ko(l.pathname,e);l.origin===a.origin&&d!=null?r=d+l.search+l.hash:i=!0}catch{Gi(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:i,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var iR=["POST","PUT","PATCH","DELETE"];new Set(iR);var bF=["GET",...iR];new Set(bF);var ah=y.createContext(null);ah.displayName="DataRouter";var Gx=y.createContext(null);Gx.displayName="DataRouterState";var vF=y.createContext(!1),aR=y.createContext({isTransitioning:!1});aR.displayName="ViewTransition";var wF=y.createContext(new Map);wF.displayName="Fetchers";var jF=y.createContext(null);jF.displayName="Await";var Ji=y.createContext(null);Ji.displayName="Navigation";var j0=y.createContext(null);j0.displayName="Location";var so=y.createContext({outlet:null,matches:[],isDataRoute:!1});so.displayName="Route";var QN=y.createContext(null);QN.displayName="RouteError";var oR="REACT_ROUTER_ERROR",NF="REDIRECT",kF="ROUTE_ERROR_RESPONSE";function SF(t){if(t.startsWith(`${oR}:${NF}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function _F(t){if(t.startsWith(`${oR}:${kF}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new gF(e.status,e.statusText,e.data)}catch{}}function CF(t,{relative:e}={}){Xr(N0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=y.useContext(Ji),{hash:i,pathname:a,search:l}=k0(t,{relative:e}),d=a;return r!=="/"&&(d=a==="/"?r:Wo([r,a])),n.createHref({pathname:d,search:l,hash:i})}function N0(){return y.useContext(j0)!=null}function yi(){return Xr(N0(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(j0).location}var lR="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cR(t){y.useContext(Ji).static||y.useLayoutEffect(t)}function on(){let{isDataRoute:t}=y.useContext(so);return t?UF():EF()}function EF(){Xr(N0(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(ah),{basename:e,navigator:r}=y.useContext(Ji),{matches:n}=y.useContext(so),{pathname:i}=yi(),a=JSON.stringify(tR(n)),l=y.useRef(!1);return cR(()=>{l.current=!0}),y.useCallback((u,h={})=>{if(Gi(l.current,lR),!l.current)return;if(typeof u=="number"){r.go(u);return}let p=rR(u,JSON.parse(a),i,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Wo([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,a,i,t])}y.createContext(null);function ol(){let{matches:t}=y.useContext(so),e=t[t.length-1];return e?e.params:{}}function k0(t,{relative:e}={}){let{matches:r}=y.useContext(so),{pathname:n}=yi(),i=JSON.stringify(tR(r));return y.useMemo(()=>rR(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function AF(t,e){return dR(t,e)}function dR(t,e,r,n,i){Xr(N0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=y.useContext(Ji),{matches:l}=y.useContext(so),d=l[l.length-1],u=d?d.params:{},h=d?d.pathname:"/",p=d?d.pathnameBase:"/",m=d&&d.route;{let T=m&&m.path||"";hR(h,!m||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let x=yi(),b;if(e){let T=typeof e=="string"?ih(e):e;Xr(p==="/"||T.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${T.pathname}" was given in the \`location\` prop.`),b=T}else b=x;let v=b.pathname||"/",w=v;if(p!=="/"){let T=p.replace(/^\//,"").split("/");w="/"+v.replace(/^\//,"").split("/").slice(T.length).join("/")}let k=JL(t,{pathname:w});Gi(m||k!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Gi(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=RF(k&&k.map(T=>Object.assign({},T,{params:Object.assign({},u,T.params),pathname:Wo([p,a.encodeLocation?a.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?p:Wo([p,a.encodeLocation?a.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),l,r,n,i);return e&&_?y.createElement(j0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},_):_}function TF(){let t=$F(),e=xF(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:a},"ErrorBoundary")," or"," ",y.createElement("code",{style:a},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),r?y.createElement("pre",{style:i},r):null,l)}var OF=y.createElement(TF,null),uR=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const r=_F(t.digest);r&&(t=r)}let e=t!==void 0?y.createElement(so.Provider,{value:this.props.routeContext},y.createElement(QN.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?y.createElement(MF,{error:t},e):e}};uR.contextType=vF;var c1=new WeakMap;function MF({children:t,error:e}){let{basename:r}=y.useContext(Ji);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=SF(e.digest);if(n){let i=c1.get(e);if(i)throw i;let a=sR(n.location,r);if(nR&&!c1.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw c1.set(e,l),l}return y.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function LF({routeContext:t,match:e,children:r}){let n=y.useContext(ah);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(so.Provider,{value:t},r)}function RF(t,e=[],r=null,n=null,i=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,l=r?.errors;if(l!=null){let p=a.findIndex(m=>m.route.id&&l?.[m.route.id]!==void 0);Xr(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,p+1))}let d=!1,u=-1;if(r)for(let p=0;p<a.length;p++){let m=a[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=p),m.route.id){let{loaderData:x,errors:b}=r,v=m.route.loader&&!x.hasOwnProperty(m.route.id)&&(!b||b[m.route.id]===void 0);if(m.route.lazy||v){d=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let h=r&&n?(p,m)=>{n(p,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:yF(r.matches),errorInfo:m})}:void 0;return a.reduceRight((p,m,x)=>{let b,v=!1,w=null,k=null;r&&(b=l&&m.route.id?l[m.route.id]:void 0,w=m.route.errorElement||OF,d&&(u<0&&x===0?(hR("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,k=null):u===x&&(v=!0,k=m.route.hydrateFallbackElement||null)));let _=e.concat(a.slice(0,x+1)),T=()=>{let A;return b?A=w:v?A=k:m.route.Component?A=y.createElement(m.route.Component,null):m.route.element?A=m.route.element:A=p,y.createElement(LF,{match:m,routeContext:{outlet:p,matches:_,isDataRoute:r!=null},children:A})};return r&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?y.createElement(uR,{location:r.location,revalidation:r.revalidation,component:w,error:b,children:T(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:h}):T()},null)}function ZN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function PF(t){let e=y.useContext(ah);return Xr(e,ZN(t)),e}function IF(t){let e=y.useContext(Gx);return Xr(e,ZN(t)),e}function DF(t){let e=y.useContext(so);return Xr(e,ZN(t)),e}function e4(t){let e=DF(t),r=e.matches[e.matches.length-1];return Xr(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function BF(){return e4("useRouteId")}function $F(){let t=y.useContext(QN),e=IF("useRouteError"),r=e4("useRouteError");return t!==void 0?t:e.errors?.[r]}function UF(){let{router:t}=PF("useNavigate"),e=e4("useNavigate"),r=y.useRef(!1);return cR(()=>{r.current=!0}),y.useCallback(async(i,a={})=>{Gi(r.current,lR),r.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var q3={};function hR(t,e,r){!e&&!q3[t]&&(q3[t]=!0,Gi(!1,r))}y.memo(zF);function zF({routes:t,future:e,state:r,onError:n}){return dR(t,void 0,r,n,e)}function Cr(t){Xr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function qF({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:a=!1,unstable_useTransitions:l}){Xr(!N0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=t.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:d,navigator:i,static:a,unstable_useTransitions:l,future:{}}),[d,i,a,l]);typeof r=="string"&&(r=ih(r));let{pathname:h="/",search:p="",hash:m="",state:x=null,key:b="default"}=r,v=y.useMemo(()=>{let w=Ko(h,d);return w==null?null:{location:{pathname:w,search:p,hash:m,state:x,key:b},navigationType:n}},[d,h,p,m,x,b,n]);return Gi(v!=null,`<Router basename="${d}"> is not able to match the URL "${h}${p}${m}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:y.createElement(Ji.Provider,{value:u},y.createElement(j0.Provider,{children:e,value:v}))}function FF({children:t,location:e}){return AF(sj(t),e)}function sj(t,e=[]){let r=[];return y.Children.forEach(t,(n,i)=>{if(!y.isValidElement(n))return;let a=[...e,i];if(n.type===y.Fragment){r.push.apply(r,sj(n.props.children,a));return}Xr(n.type===Cr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=sj(n.props.children,a)),r.push(l)}),r}var hg="get",fg="application/x-www-form-urlencoded";function Vx(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function HF(t){return Vx(t)&&t.tagName.toLowerCase()==="button"}function WF(t){return Vx(t)&&t.tagName.toLowerCase()==="form"}function GF(t){return Vx(t)&&t.tagName.toLowerCase()==="input"}function VF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function KF(t,e){return t.button===0&&(!e||e==="_self")&&!VF(t)}function ij(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function YF(t,e){let r=ij(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(a=>{r.append(i,a)})}),r}var vm=null;function XF(){if(vm===null)try{new FormData(document.createElement("form"),0),vm=!1}catch{vm=!0}return vm}var JF=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function d1(t){return t!=null&&!JF.has(t)?(Gi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${fg}"`),null):t}function QF(t,e){let r,n,i,a,l;if(WF(t)){let d=t.getAttribute("action");n=d?Ko(d,e):null,r=t.getAttribute("method")||hg,i=d1(t.getAttribute("enctype"))||fg,a=new FormData(t)}else if(HF(t)||GF(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||d.getAttribute("action");if(n=u?Ko(u,e):null,r=t.getAttribute("formmethod")||d.getAttribute("method")||hg,i=d1(t.getAttribute("formenctype"))||d1(d.getAttribute("enctype"))||fg,a=new FormData(d,t),!XF()){let{name:h,type:p,value:m}=t;if(p==="image"){let x=h?`${h}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else h&&a.append(h,m)}}else{if(Vx(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=hg,n=null,i=fg,l=t}return a&&i==="text/plain"&&(l=a,a=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function t4(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ZF(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Ko(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function eH(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function tH(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function rH(t,e,r){let n=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let l=await eH(a,r);return l.links?l.links():[]}return[]}));return aH(n.flat(1).filter(tH).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function F3(t,e,r,n,i,a){let l=(u,h)=>r[h]?u.route.id!==r[h].route.id:!0,d=(u,h)=>r[h].pathname!==u.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,h)=>l(u,h)||d(u,h)):a==="data"?e.filter((u,h)=>{let p=n.routes[u.route.id];if(!p||!p.hasLoader)return!1;if(l(u,h)||d(u,h))return!0;if(u.route.shouldRevalidate){let m=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function nH(t,e,{includeHydrateFallback:r}={}){return sH(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function sH(t){return[...new Set(t)]}function iH(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function aH(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let a=JSON.stringify(iH(i));return r.has(a)||(r.add(a),n.push({key:a,link:i})),n},[])}function fR(){let t=y.useContext(ah);return t4(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function oH(){let t=y.useContext(Gx);return t4(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var r4=y.createContext(void 0);r4.displayName="FrameworkContext";function pR(){let t=y.useContext(r4);return t4(t,"You must render this element inside a <HydratedRouter> element"),t}function lH(t,e){let r=y.useContext(r4),[n,i]=y.useState(!1),[a,l]=y.useState(!1),{onFocus:d,onBlur:u,onMouseEnter:h,onMouseLeave:p,onTouchStart:m}=e,x=y.useRef(null);y.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let w=_=>{_.forEach(T=>{l(T.isIntersecting)})},k=new IntersectionObserver(w,{threshold:.5});return x.current&&k.observe(x.current),()=>{k.disconnect()}}},[t]),y.useEffect(()=>{if(n){let w=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(w)}}},[n]);let b=()=>{i(!0)},v=()=>{i(!1),l(!1)};return r?t!=="intent"?[a,x,{}]:[a,x,{onFocus:of(d,b),onBlur:of(u,v),onMouseEnter:of(h,b),onMouseLeave:of(p,v),onTouchStart:of(m,b)}]:[!1,x,{}]}function of(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function cH({page:t,...e}){let{router:r}=fR(),n=y.useMemo(()=>JL(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?y.createElement(uH,{page:t,matches:n,...e}):null}function dH(t){let{manifest:e,routeModules:r}=pR(),[n,i]=y.useState([]);return y.useEffect(()=>{let a=!1;return rH(t,e,r).then(l=>{a||i(l)}),()=>{a=!0}},[t,e,r]),n}function uH({page:t,matches:e,...r}){let n=yi(),{manifest:i,routeModules:a}=pR(),{basename:l}=fR(),{loaderData:d,matches:u}=oH(),h=y.useMemo(()=>F3(t,e,u,i,n,"data"),[t,e,u,i,n]),p=y.useMemo(()=>F3(t,e,u,i,n,"assets"),[t,e,u,i,n]),m=y.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let v=new Set,w=!1;if(e.forEach(_=>{let T=i.routes[_.route.id];!T||!T.hasLoader||(!h.some(A=>A.route.id===_.route.id)&&_.route.id in d&&a[_.route.id]?.shouldRevalidate||T.hasClientLoader?w=!0:v.add(_.route.id))}),v.size===0)return[];let k=ZF(t,l,"data");return w&&v.size>0&&k.searchParams.set("_routes",e.filter(_=>v.has(_.route.id)).map(_=>_.route.id).join(",")),[k.pathname+k.search]},[l,d,n,i,h,e,t,a]),x=y.useMemo(()=>nH(p,i),[p,i]),b=dH(p);return y.createElement(y.Fragment,null,m.map(v=>y.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...r})),x.map(v=>y.createElement("link",{key:v,rel:"modulepreload",href:v,...r})),b.map(({key:v,link:w})=>y.createElement("link",{key:v,nonce:r.nonce,...w})))}function hH(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var fH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{fH&&(window.__reactRouterVersion="7.11.0")}catch{}function pH({basename:t,children:e,unstable_useTransitions:r,window:n}){let i=y.useRef();i.current==null&&(i.current=Vq({window:n,v5Compat:!0}));let a=i.current,[l,d]=y.useState({action:a.action,location:a.location}),u=y.useCallback(h=>{r===!1?d(h):y.startTransition(()=>d(h))},[r]);return y.useLayoutEffect(()=>a.listen(u),[a,u]),y.createElement(qF,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:r})}var mR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_t=y.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:a,replace:l,state:d,target:u,to:h,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:x,...b},v){let{basename:w,unstable_useTransitions:k}=y.useContext(Ji),_=typeof h=="string"&&mR.test(h),T=sR(h,w);h=T.to;let A=CF(h,{relative:i}),[I,O,M]=lH(n,b),E=yH(h,{replace:l,state:d,target:u,preventScrollReset:p,relative:i,viewTransition:m,unstable_defaultShouldRevalidate:x,unstable_useTransitions:k});function R(B){e&&e(B),B.defaultPrevented||E(B)}let $=y.createElement("a",{...b,...M,href:T.absoluteURL||A,onClick:T.isExternal||a?e:R,ref:hH(v,O),target:u,"data-discover":!_&&r==="render"?"true":void 0});return I&&!_?y.createElement(y.Fragment,null,$,y.createElement(cH,{page:A})):$});_t.displayName="Link";var mH=y.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:a,to:l,viewTransition:d,children:u,...h},p){let m=k0(l,{relative:h.relative}),x=yi(),b=y.useContext(Gx),{navigator:v,basename:w}=y.useContext(Ji),k=b!=null&&NH(m)&&d===!0,_=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,T=x.pathname,A=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(T=T.toLowerCase(),A=A?A.toLowerCase():null,_=_.toLowerCase()),A&&w&&(A=Ko(A,w)||A);const I=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let O=T===_||!i&&T.startsWith(_)&&T.charAt(I)==="/",M=A!=null&&(A===_||!i&&A.startsWith(_)&&A.charAt(_.length)==="/"),E={isActive:O,isPending:M,isTransitioning:k},R=O?e:void 0,$;typeof n=="function"?$=n(E):$=[n,O?"active":null,M?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let B=typeof a=="function"?a(E):a;return y.createElement(_t,{...h,"aria-current":R,className:$,ref:p,style:B,to:l,viewTransition:d},typeof u=="function"?u(E):u)});mH.displayName="NavLink";var gH=y.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:a,method:l=hg,action:d,onSubmit:u,relative:h,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:x,...b},v)=>{let{unstable_useTransitions:w}=y.useContext(Ji),k=wH(),_=jH(d,{relative:h}),T=l.toLowerCase()==="get"?"get":"post",A=typeof d=="string"&&mR.test(d),I=O=>{if(u&&u(O),O.defaultPrevented)return;O.preventDefault();let M=O.nativeEvent.submitter,E=M?.getAttribute("formmethod")||l,R=()=>k(M||O.currentTarget,{fetcherKey:e,method:E,navigate:r,replace:i,state:a,relative:h,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:x});w&&r!==!1?y.startTransition(()=>R()):R()};return y.createElement("form",{ref:v,method:T,action:_,onSubmit:n?u:I,...b,"data-discover":!A&&t==="render"?"true":void 0})});gH.displayName="Form";function xH(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gR(t){let e=y.useContext(ah);return Xr(e,xH(t)),e}function yH(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:a,viewTransition:l,unstable_defaultShouldRevalidate:d,unstable_useTransitions:u}={}){let h=on(),p=yi(),m=k0(t,{relative:a});return y.useCallback(x=>{if(KF(x,e)){x.preventDefault();let b=r!==void 0?r:Hf(p)===Hf(m),v=()=>h(t,{replace:b,state:n,preventScrollReset:i,relative:a,viewTransition:l,unstable_defaultShouldRevalidate:d});u?y.startTransition(()=>v()):v()}},[p,h,m,r,n,e,t,i,a,l,d,u])}function n4(t){Gi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=y.useRef(ij(t)),r=y.useRef(!1),n=yi(),i=y.useMemo(()=>YF(n.search,r.current?null:e.current),[n.search]),a=on(),l=y.useCallback((d,u)=>{const h=ij(typeof d=="function"?d(new URLSearchParams(i)):d);r.current=!0,a("?"+h,u)},[a,i]);return[i,l]}var bH=0,vH=()=>`__${String(++bH)}__`;function wH(){let{router:t}=gR("useSubmit"),{basename:e}=y.useContext(Ji),r=BF(),n=t.fetch,i=t.navigate;return y.useCallback(async(a,l={})=>{let{action:d,method:u,encType:h,formData:p,body:m}=QF(a,e);if(l.navigate===!1){let x=l.fetcherKey||vH();await n(x,r,l.action||d,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:p,body:m,formMethod:l.method||u,formEncType:l.encType||h,flushSync:l.flushSync})}else await i(l.action||d,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:p,body:m,formMethod:l.method||u,formEncType:l.encType||h,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[n,i,e,r])}function jH(t,{relative:e}={}){let{basename:r}=y.useContext(Ji),n=y.useContext(so);Xr(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...k0(t||".",{relative:e})},l=yi();if(t==null){a.search=l.search;let d=new URLSearchParams(a.search),u=d.getAll("index");if(u.some(p=>p==="")){d.delete("index"),u.filter(m=>m).forEach(m=>d.append("index",m));let p=d.toString();a.search=p?`?${p}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:Wo([r,a.pathname])),Hf(a)}function NH(t,{relative:e}={}){let r=y.useContext(aR);Xr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=gR("useViewTransitionState"),i=k0(t,{relative:e});if(!r.isTransitioning)return!1;let a=Ko(r.currentLocation.pathname,n)||r.currentLocation.pathname,l=Ko(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Mg(i.pathname,l)!=null||Mg(i.pathname,a)!=null}var ln=XL();const s4=Ms(ln);function kH(){const{pathname:t}=yi();return y.useEffect(()=>{window.scrollTo(0,0)},[t]),null}const SH=()=>{};var H3={};const xR=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},_H=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],l=t[r++],d=t[r++],u=((i&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=t[r++],l=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},yR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],l=i+1<t.length,d=l?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,p=a>>2,m=(a&3)<<4|d>>4;let x=(d&15)<<2|h>>6,b=h&63;u||(b=64,l||(x=64)),n.push(r[p],r[m],r[x],r[b])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xR(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):_H(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],d=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const m=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||d==null||h==null||m==null)throw new CH;const x=a<<2|d>>4;if(n.push(x),h!==64){const b=d<<4&240|h>>2;if(n.push(b),m!==64){const v=h<<6&192|m;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class CH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const EH=function(t){const e=xR(t);return yR.encodeByteArray(e,!0)},Lg=function(t){return EH(t).replace(/\./g,"")},bR=function(t){try{return yR.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function AH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const TH=()=>AH().__FIREBASE_DEFAULTS__,OH=()=>{if(typeof process>"u"||typeof H3>"u")return;const t=H3.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MH=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bR(t[1]);return e&&JSON.parse(e)},i4=()=>{try{return SH()||TH()||OH()||MH()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},vR=t=>i4()?.emulatorHosts?.[t],wR=t=>{const e=vR(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},jR=()=>i4()?.config,NR=t=>i4()?.[`_${t}`];class LH{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function oh(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function a4(t){return(await fetch(t,{credentials:"include"})).ok}function kR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Lg(JSON.stringify(r)),Lg(JSON.stringify(l)),""].join(".")}const Lf={};function RH(){const t={prod:[],emulator:[]};for(const e of Object.keys(Lf))Lf[e]?t.emulator.push(e):t.prod.push(e);return t}function PH(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let W3=!1;function o4(t,e){if(typeof window>"u"||typeof document>"u"||!oh(window.location.host)||Lf[t]===e||Lf[t]||W3)return;Lf[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",a=RH().prod.length>0;function l(){const x=document.getElementById(n);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function u(x,b){x.setAttribute("width","24"),x.setAttribute("id",b),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{W3=!0,l()},x}function p(x,b){x.setAttribute("id",b),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function m(){const x=PH(n),b=r("text"),v=document.getElementById(b)||document.createElement("span"),w=r("learnmore"),k=document.getElementById(w)||document.createElement("a"),_=r("preprendIcon"),T=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const A=x.element;d(A),p(k,w);const I=h();u(T,_),A.append(T,v,k,I),document.body.appendChild(A)}a?(v.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function As(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(As())}function DH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function $H(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UH(){const t=As();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function zH(){try{return typeof indexedDB=="object"}catch{return!1}}function qH(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}const FH="FirebaseError";class io extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=FH,Object.setPrototypeOf(this,io.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,S0.prototype.create)}}class S0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?HH(a,n):"Error",d=`${this.serviceName}: ${l} (${i}).`;return new io(i,d,n)}}function HH(t,e){return t.replace(WH,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const WH=/\{\$([^}]+)}/g;function GH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ld(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],l=e[i];if(G3(a)&&G3(l)){if(!ld(a,l))return!1}else if(a!==l)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function G3(t){return t!==null&&typeof t=="object"}function _0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Sf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function _f(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function VH(t,e){const r=new KH(t,e);return r.subscribe.bind(r)}class KH{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");YH(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=u1),i.error===void 0&&(i.error=u1),i.complete===void 0&&(i.complete=u1);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YH(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function u1(){}function _a(t){return t&&t._delegate?t._delegate:t}class fc{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Fc="[DEFAULT]";let XH=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new LH;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QH(e))try{this.getOrInitializeService({instanceIdentifier:Fc})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Fc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fc){return this.instances.has(e)}getOptions(e=Fc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);n===d&&l.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:JH(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Fc){return this.component?this.component.multipleInstances?e:Fc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function JH(t){return t===Fc?void 0:t}function QH(t){return t.instantiationMode==="EAGER"}class ZH{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new XH(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var cr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(cr||(cr={}));const eW={debug:cr.DEBUG,verbose:cr.VERBOSE,info:cr.INFO,warn:cr.WARN,error:cr.ERROR,silent:cr.SILENT},tW=cr.INFO,rW={[cr.DEBUG]:"log",[cr.VERBOSE]:"log",[cr.INFO]:"info",[cr.WARN]:"warn",[cr.ERROR]:"error"},nW=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=rW[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class l4{constructor(e){this.name=e,this._logLevel=tW,this._logHandler=nW,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in cr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,cr.DEBUG,...e),this._logHandler(this,cr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,cr.VERBOSE,...e),this._logHandler(this,cr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,cr.INFO,...e),this._logHandler(this,cr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,cr.WARN,...e),this._logHandler(this,cr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,cr.ERROR,...e),this._logHandler(this,cr.ERROR,...e)}}const sW=(t,e)=>e.some(r=>t instanceof r);let V3,K3;function iW(){return V3||(V3=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aW(){return K3||(K3=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const SR=new WeakMap,aj=new WeakMap,_R=new WeakMap,h1=new WeakMap,c4=new WeakMap;function oW(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",l)},a=()=>{r(ac(t.result)),i()},l=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&SR.set(r,t)}).catch(()=>{}),c4.set(e,t),e}function lW(t){if(aj.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",l),t.removeEventListener("abort",l)},a=()=>{r(),i()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",l),t.addEventListener("abort",l)});aj.set(t,e)}let oj={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return aj.get(t);if(e==="objectStoreNames")return t.objectStoreNames||_R.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ac(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cW(t){oj=t(oj)}function dW(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(f1(this),e,...r);return _R.set(n,e.sort?e.sort():[e]),ac(n)}:aW().includes(t)?function(...e){return t.apply(f1(this),e),ac(SR.get(this))}:function(...e){return ac(t.apply(f1(this),e))}}function uW(t){return typeof t=="function"?dW(t):(t instanceof IDBTransaction&&lW(t),sW(t,iW())?new Proxy(t,oj):t)}function ac(t){if(t instanceof IDBRequest)return oW(t);if(h1.has(t))return h1.get(t);const e=uW(t);return e!==t&&(h1.set(t,e),c4.set(e,t)),e}const f1=t=>c4.get(t);function hW(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const l=indexedDB.open(t,e),d=ac(l);return n&&l.addEventListener("upgradeneeded",u=>{n(ac(l.result),u.oldVersion,u.newVersion,ac(l.transaction),u)}),r&&l.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),d.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),d}const fW=["get","getKey","getAll","getAllKeys","count"],pW=["put","add","delete","clear"],p1=new Map;function Y3(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(p1.get(e))return p1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=pW.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||fW.includes(r)))return;const a=async function(l,...d){const u=this.transaction(l,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(d.shift())),(await Promise.all([h[r](...d),i&&u.done]))[0]};return p1.set(e,a),a}cW(t=>({...t,get:(e,r,n)=>Y3(e,r)||t.get(e,r,n),has:(e,r)=>!!Y3(e,r)||t.has(e,r)}));class mW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(gW(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function gW(t){return t.getComponent()?.type==="VERSION"}const lj="@firebase/app",X3="0.14.6";const Yo=new l4("@firebase/app"),xW="@firebase/app-compat",yW="@firebase/analytics-compat",bW="@firebase/analytics",vW="@firebase/app-check-compat",wW="@firebase/app-check",jW="@firebase/auth",NW="@firebase/auth-compat",kW="@firebase/database",SW="@firebase/data-connect",_W="@firebase/database-compat",CW="@firebase/functions",EW="@firebase/functions-compat",AW="@firebase/installations",TW="@firebase/installations-compat",OW="@firebase/messaging",MW="@firebase/messaging-compat",LW="@firebase/performance",RW="@firebase/performance-compat",PW="@firebase/remote-config",IW="@firebase/remote-config-compat",DW="@firebase/storage",BW="@firebase/storage-compat",$W="@firebase/firestore",UW="@firebase/ai",zW="@firebase/firestore-compat",qW="firebase",FW="12.6.0";const cj="[DEFAULT]",HW={[lj]:"fire-core",[xW]:"fire-core-compat",[bW]:"fire-analytics",[yW]:"fire-analytics-compat",[wW]:"fire-app-check",[vW]:"fire-app-check-compat",[jW]:"fire-auth",[NW]:"fire-auth-compat",[kW]:"fire-rtdb",[SW]:"fire-data-connect",[_W]:"fire-rtdb-compat",[CW]:"fire-fn",[EW]:"fire-fn-compat",[AW]:"fire-iid",[TW]:"fire-iid-compat",[OW]:"fire-fcm",[MW]:"fire-fcm-compat",[LW]:"fire-perf",[RW]:"fire-perf-compat",[PW]:"fire-rc",[IW]:"fire-rc-compat",[DW]:"fire-gcs",[BW]:"fire-gcs-compat",[$W]:"fire-fst",[zW]:"fire-fst-compat",[UW]:"fire-vertex","fire-js":"fire-js",[qW]:"fire-js-all"};const Rg=new Map,WW=new Map,dj=new Map;function J3(t,e){try{t.container.addComponent(e)}catch(r){Yo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function cd(t){const e=t.name;if(dj.has(e))return Yo.debug(`There were multiple attempts to register component ${e}.`),!1;dj.set(e,t);for(const r of Rg.values())J3(r,t);for(const r of WW.values())J3(r,t);return!0}function Kx(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Hs(t){return t==null?!1:t.settings!==void 0}const GW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oc=new S0("app","Firebase",GW);class VW{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new fc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oc.create("app-deleted",{appName:this._name})}}const Ed=FW;function CR(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:cj,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw oc.create("bad-app-name",{appName:String(i)});if(r||(r=jR()),!r)throw oc.create("no-options");const a=Rg.get(i);if(a){if(ld(r,a.options)&&ld(n,a.config))return a;throw oc.create("duplicate-app",{appName:i})}const l=new ZH(i);for(const u of dj.values())l.addComponent(u);const d=new VW(r,n,l);return Rg.set(i,d),d}function d4(t=cj){const e=Rg.get(t);if(!e&&t===cj&&jR())return CR();if(!e)throw oc.create("no-app",{appName:t});return e}function Va(t,e,r){let n=HW[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${n}" with version "${e}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yo.warn(l.join(" "));return}cd(new fc(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const KW="firebase-heartbeat-database",YW=1,Wf="firebase-heartbeat-store";let m1=null;function ER(){return m1||(m1=hW(KW,YW,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wf)}catch(r){console.warn(r)}}}}).catch(t=>{throw oc.create("idb-open",{originalErrorMessage:t.message})})),m1}async function XW(t){try{const r=(await ER()).transaction(Wf),n=await r.objectStore(Wf).get(AR(t));return await r.done,n}catch(e){if(e instanceof io)Yo.warn(e.message);else{const r=oc.create("idb-get",{originalErrorMessage:e?.message});Yo.warn(r.message)}}}async function Q3(t,e){try{const n=(await ER()).transaction(Wf,"readwrite");await n.objectStore(Wf).put(e,AR(t)),await n.done}catch(r){if(r instanceof io)Yo.warn(r.message);else{const n=oc.create("idb-set",{originalErrorMessage:r?.message});Yo.warn(n.message)}}}function AR(t){return`${t.name}!${t.options.appId}`}const JW=1024,QW=30;class ZW{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new tG(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Z3();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>QW){const i=rG(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Z3(),{heartbeatsToSend:r,unsentEntries:n}=eG(this._heartbeatsCache.heartbeats),i=Lg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Yo.warn(e),""}}}function Z3(){return new Date().toISOString().substring(0,10)}function eG(t,e=JW){const r=[];let n=t.slice();for(const i of t){const a=r.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),eE(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),eE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class tG{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zH()?qH().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await XW(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Q3(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Q3(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function eE(t){return Lg(JSON.stringify({version:2,heartbeats:t})).length}function rG(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function nG(t){cd(new fc("platform-logger",e=>new mW(e),"PRIVATE")),cd(new fc("heartbeat",e=>new ZW(e),"PRIVATE")),Va(lj,X3,t),Va(lj,X3,"esm2020"),Va("fire-js","")}nG("");function TR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sG=TR,OR=new S0("auth","Firebase",TR());const Pg=new l4("@firebase/auth");function iG(t,...e){Pg.logLevel<=cr.WARN&&Pg.warn(`Auth (${Ed}): ${t}`,...e)}function pg(t,...e){Pg.logLevel<=cr.ERROR&&Pg.error(`Auth (${Ed}): ${t}`,...e)}function Vi(t,...e){throw h4(t,...e)}function wa(t,...e){return h4(t,...e)}function u4(t,e,r){const n={...sG(),[e]:r};return new S0("auth","Firebase",n).create(e,{appName:t.name})}function Go(t){return u4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function aG(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Vi(t,"argument-error"),u4(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function h4(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return OR.create(t,...e)}function Ct(t,e,...r){if(!t)throw h4(e,...r)}function Uo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw pg(e),new Error(e)}function Xo(t,e){t||Uo(e)}function uj(){return typeof self<"u"&&self.location?.href||""}function oG(){return tE()==="http:"||tE()==="https:"}function tE(){return typeof self<"u"&&self.location?.protocol||null}function lG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(oG()||BH()||"connection"in navigator)?navigator.onLine:!0}function cG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class C0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Xo(r>e,"Short delay should be less than long delay!"),this.isMobile=IH()||$H()}get(){return lG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function f4(t,e){Xo(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class MR{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Uo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Uo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Uo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const uG=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],hG=new C0(3e4,6e4);function ll(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function cl(t,e,r,n,i={}){return LR(t,i,async()=>{let a={},l={};n&&(e==="GET"?l=n:a={body:JSON.stringify(n)});const d=_0({key:t.config.apiKey,...l}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...a};return DH()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&oh(t.emulatorConfig.host)&&(h.credentials="include"),MR.fetch()(await RR(t,t.config.apiHost,r,d),h)})}async function LR(t,e,r){t._canInitEmulator=!1;const n={...dG,...e};try{const i=new pG(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw wm(t,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[u,h]=d.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw wm(t,"credential-already-in-use",l);if(u==="EMAIL_EXISTS")throw wm(t,"email-already-in-use",l);if(u==="USER_DISABLED")throw wm(t,"user-disabled",l);const p=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw u4(t,p,h);Vi(t,p)}}catch(i){if(i instanceof io)throw i;Vi(t,"network-request-failed",{message:String(i)})}}async function E0(t,e,r,n,i={}){const a=await cl(t,e,r,n,i);return"mfaPendingCredential"in a&&Vi(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function RR(t,e,r,n){const i=`${e}${r}?${n}`,a=t,l=a.config.emulator?f4(t.config,i):`${t.config.apiScheme}://${i}`;return uG.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function fG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class pG{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(wa(this.auth,"network-request-failed")),hG.get())})}}function wm(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=wa(t,e,n);return i.customData._tokenResponse=r,i}function rE(t){return t!==void 0&&t.enterprise!==void 0}class mG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return fG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function gG(t,e){return cl(t,"GET","/v2/recaptchaConfig",ll(t,e))}async function xG(t,e){return cl(t,"POST","/v1/accounts:delete",e)}async function Ig(t,e){return cl(t,"POST","/v1/accounts:lookup",e)}function Rf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yG(t,e=!1){const r=_a(t),n=await r.getIdToken(e),i=p4(n);Ct(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a?.sign_in_provider;return{claims:i,token:n,authTime:Rf(g1(i.auth_time)),issuedAtTime:Rf(g1(i.iat)),expirationTime:Rf(g1(i.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function g1(t){return Number(t)*1e3}function p4(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return pg("JWT malformed, contained fewer than 3 sections"),null;try{const i=bR(r);return i?JSON.parse(i):(pg("Failed to decode base64 JWT payload"),null)}catch(i){return pg("Caught error parsing JWT payload as JSON",i?.toString()),null}}function nE(t){const e=p4(t);return Ct(e,"internal-error"),Ct(typeof e.exp<"u","internal-error"),Ct(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Gf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof io&&bG(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function bG({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class vG{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class hj{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rf(this.lastLoginAt),this.creationTime=Rf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Dg(t){const e=t.auth,r=await t.getIdToken(),n=await Gf(t,Ig(e,{idToken:r}));Ct(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?PR(i.providerUserInfo):[],l=jG(t.providerData,a),d=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!l?.length,h=d?u:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new hj(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function wG(t){const e=_a(t);await Dg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jG(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function PR(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function NG(t,e){const r=await LR(t,{},async()=>{const n=_0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,l=await RR(t,i,"/v1/token",`key=${a}`),d=await t._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:d,body:n};return t.emulatorConfig&&oh(t.emulatorConfig.host)&&(u.credentials="include"),MR.fetch()(l,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function kG(t,e){return cl(t,"POST","/v2/accounts:revokeToken",ll(t,e))}class Ru{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ct(e.idToken,"internal-error"),Ct(typeof e.idToken<"u","internal-error"),Ct(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ct(e.length!==0,"internal-error");const r=nE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ct(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await NG(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,l=new Ru;return n&&(Ct(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),i&&(Ct(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(Ct(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ru,this.toJSON())}_performRefresh(){return Uo("not implemented")}}function Vl(t,e){Ct(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ya{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new vG(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hj(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Gf(this,this.stsTokenManager.getToken(this.auth,e));return Ct(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return yG(this,e)}reload(){return wG(this)}_assign(e){this!==e&&(Ct(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ya({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Ct(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Dg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hs(this.auth.app))return Promise.reject(Go(this.auth));const e=await this.getIdToken();return await Gf(this,xG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,l=r.photoURL??void 0,d=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:m,emailVerified:x,isAnonymous:b,providerData:v,stsTokenManager:w}=r;Ct(m&&w,e,"internal-error");const k=Ru.fromJSON(this.name,w);Ct(typeof m=="string",e,"internal-error"),Vl(n,e.name),Vl(i,e.name),Ct(typeof x=="boolean",e,"internal-error"),Ct(typeof b=="boolean",e,"internal-error"),Vl(a,e.name),Vl(l,e.name),Vl(d,e.name),Vl(u,e.name),Vl(h,e.name),Vl(p,e.name);const _=new ya({uid:m,auth:e,email:i,emailVerified:x,displayName:n,isAnonymous:b,photoURL:l,phoneNumber:a,tenantId:d,stsTokenManager:k,createdAt:h,lastLoginAt:p});return v&&Array.isArray(v)&&(_.providerData=v.map(T=>({...T}))),u&&(_._redirectEventId=u),_}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ru;i.updateFromServerResponse(r);const a=new ya({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Dg(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Ct(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?PR(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!a?.length,d=new Ru;d.updateFromIdToken(n);const u=new ya({uid:i.localId,auth:e,stsTokenManager:d,isAnonymous:l}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new hj(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,h),u}}const sE=new Map;function zo(t){Xo(t instanceof Function,"Expected a class definition");let e=sE.get(t);return e?(Xo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sE.set(t,e),e)}class IR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}IR.type="NONE";const iE=IR;function mg(t,e,r){return`firebase:${t}:${e}:${r}`}class Pu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=mg(this.userKey,i.apiKey,a),this.fullPersistenceKey=mg("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Ig(this.auth,{idToken:e}).catch(()=>{});return r?ya._fromGetAccountInfoResponse(this.auth,r,e):null}return ya._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Pu(zo(iE),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=i[0]||zo(iE);const l=mg(n,e.config.apiKey,e.name);let d=null;for(const h of r)try{const p=await h._get(l);if(p){let m;if(typeof p=="string"){const x=await Ig(e,{idToken:p}).catch(()=>{});if(!x)break;m=await ya._fromGetAccountInfoResponse(e,x,p)}else m=ya._fromJSON(e,p);h!==a&&(d=m),a=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Pu(a,e,n):(a=u[0],d&&await a._set(l,d.toJSON()),await Promise.all(r.map(async h=>{if(h!==a)try{await h._remove(l)}catch{}})),new Pu(a,e,n))}}function aE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(UR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qR(e))return"Blackberry";if(FR(e))return"Webos";if(BR(e))return"Safari";if((e.includes("chrome/")||$R(e))&&!e.includes("edge/"))return"Chrome";if(zR(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function DR(t=As()){return/firefox\//i.test(t)}function BR(t=As()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $R(t=As()){return/crios\//i.test(t)}function UR(t=As()){return/iemobile/i.test(t)}function zR(t=As()){return/android/i.test(t)}function qR(t=As()){return/blackberry/i.test(t)}function FR(t=As()){return/webos/i.test(t)}function m4(t=As()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function SG(t=As()){return m4(t)&&!!window.navigator?.standalone}function _G(){return UH()&&document.documentMode===10}function HR(t=As()){return m4(t)||zR(t)||FR(t)||qR(t)||/windows phone/i.test(t)||UR(t)}function WR(t,e=[]){let r;switch(t){case"Browser":r=aE(As());break;case"Worker":r=`${aE(As())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ed}/${n}`}class CG{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((l,d)=>{try{const u=e(a);l(u)}catch(u){d(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function EG(t,e={}){return cl(t,"GET","/v2/passwordPolicy",ll(t,e))}const AG=6;class TG{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??AG,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class OG{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oE(this),this.idTokenSubscription=new oE(this),this.beforeStateQueue=new CG(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=OR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=zo(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Ig(this,{idToken:e}),n=await ya._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Hs(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=n?._redirectEventId,d=await this.tryRedirectSignIn(e);(!a||a===l)&&d?.user&&(n=d.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ct(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Dg(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hs(this.app))return Promise.reject(Go(this));const r=e?_a(e):null;return r&&Ct(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ct(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hs(this.app)?Promise.reject(Go(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hs(this.app)?Promise.reject(Go(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await EG(this),r=new TG(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new S0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await kG(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&zo(e)||this._popupRedirectResolver;Ct(r,this,"argument-error"),this.redirectPersistenceManager=await Pu.create(this,[zo(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ct(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{l=!0,u()}}else{const u=e.addObserver(r);return()=>{l=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ct(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=WR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&iG(`Error while retrieving App Check token: ${e.error}`),e?.token}}function dl(t){return _a(t)}class oE{constructor(e){this.auth=e,this.observer=null,this.addObserver=VH(r=>this.observer=r)}get next(){return Ct(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Yx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MG(t){Yx=t}function GR(t){return Yx.loadJS(t)}function LG(){return Yx.recaptchaEnterpriseScript}function RG(){return Yx.gapiScript}function PG(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class IG{constructor(){this.enterprise=new DG}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class DG{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const BG="recaptcha-enterprise",VR="NO_RECAPTCHA";class $G{constructor(e){this.type=BG,this.auth=dl(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,d)=>{gG(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const h=new mG(u);return a.tenantId==null?a._agentRecaptchaConfig=h:a._tenantRecaptchaConfigs[a.tenantId]=h,l(h.siteKey)}}).catch(u=>{d(u)})})}function i(a,l,d){const u=window.grecaptcha;rE(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(h=>{l(h)}).catch(()=>{l(VR)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new IG().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(d=>{if(!r&&rE(window.grecaptcha))i(d,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let u=LG();u.length!==0&&(u+=d),GR(u).then(()=>{i(d,a,l)}).catch(h=>{l(h)})}}).catch(d=>{l(d)})})}}async function lE(t,e,r,n=!1,i=!1){const a=new $G(t);let l;if(i)l=VR;else try{l=await a.verify(r)}catch{l=await a.verify(r,!0)}const d={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const u=d.phoneEnrollmentInfo.phoneNumber,h=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const u=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return n?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Bg(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await lE(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await lE(t,e,r,r==="getOobCode");return n(t,l)}else return Promise.reject(a)})}function UG(t,e){const r=Kx(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(ld(a,e??{}))return i;Vi(i,"already-initialized")}return r.initialize({options:e})}function zG(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(zo);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function qG(t,e,r){const n=dl(t);Ct(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=KR(e),{host:l,port:d}=FG(e),u=d===null?"":`:${d}`,h={url:`${a}//${l}${u}/`},p=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Ct(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ct(ld(h,n.config.emulator)&&ld(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,oh(l)?(a4(`${a}//${l}${u}`),o4("Auth",!0)):HG()}function KR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function FG(t){const e=KR(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:cE(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:cE(l)}}}function cE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function HG(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class g4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Uo("not implemented")}_getIdTokenResponse(e){return Uo("not implemented")}_linkToIdToken(e,r){return Uo("not implemented")}_getReauthenticationResolver(e){return Uo("not implemented")}}async function WG(t,e){return cl(t,"POST","/v1/accounts:signUp",e)}async function GG(t,e){return E0(t,"POST","/v1/accounts:signInWithPassword",ll(t,e))}async function YR(t,e){return cl(t,"POST","/v1/accounts:sendOobCode",ll(t,e))}async function VG(t,e){return YR(t,e)}async function KG(t,e){return YR(t,e)}async function YG(t,e){return E0(t,"POST","/v1/accounts:signInWithEmailLink",ll(t,e))}async function XG(t,e){return E0(t,"POST","/v1/accounts:signInWithEmailLink",ll(t,e))}class Vf extends g4{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Vf(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Vf(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bg(e,r,"signInWithPassword",GG);case"emailLink":return YG(e,{email:this._email,oobCode:this._password});default:Vi(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bg(e,n,"signUpPassword",WG);case"emailLink":return XG(e,{idToken:r,email:this._email,oobCode:this._password});default:Vi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Iu(t,e){return E0(t,"POST","/v1/accounts:signInWithIdp",ll(t,e))}const JG="http://localhost";class dd extends g4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new dd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Vi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const l=new dd(n,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return Iu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Iu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Iu(e,r)}buildRequest(){const e={requestUri:JG,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=_0(r)}return e}}function QG(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ZG(t){const e=Sf(_f(t)).link,r=e?Sf(_f(e)).deep_link_id:null,n=Sf(_f(t)).deep_link_id;return(n?Sf(_f(n)).link:null)||n||r||e||t}class x4{constructor(e){const r=Sf(_f(e)),n=r.apiKey??null,i=r.oobCode??null,a=QG(r.mode??null);Ct(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=ZG(e);try{return new x4(r)}catch{return null}}}class lh{constructor(){this.providerId=lh.PROVIDER_ID}static credential(e,r){return Vf._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=x4.parseLink(r);return Ct(n,"argument-error"),Vf._fromEmailAndCode(e,n.code,n.tenantId)}}lh.PROVIDER_ID="password";lh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class y4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class A0 extends y4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ql extends A0{constructor(){super("facebook.com")}static credential(e){return dd._fromParams({providerId:Ql.PROVIDER_ID,signInMethod:Ql.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ql.credentialFromTaggedObject(e)}static credentialFromError(e){return Ql.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ql.credential(e.oauthAccessToken)}catch{return null}}}Ql.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ql.PROVIDER_ID="facebook.com";class Io extends A0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return dd._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Io.credential(r,n)}catch{return null}}}Io.GOOGLE_SIGN_IN_METHOD="google.com";Io.PROVIDER_ID="google.com";class Zl extends A0{constructor(){super("github.com")}static credential(e){return dd._fromParams({providerId:Zl.PROVIDER_ID,signInMethod:Zl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zl.credentialFromTaggedObject(e)}static credentialFromError(e){return Zl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zl.credential(e.oauthAccessToken)}catch{return null}}}Zl.GITHUB_SIGN_IN_METHOD="github.com";Zl.PROVIDER_ID="github.com";class ec extends A0{constructor(){super("twitter.com")}static credential(e,r){return dd._fromParams({providerId:ec.PROVIDER_ID,signInMethod:ec.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ec.credentialFromTaggedObject(e)}static credentialFromError(e){return ec.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ec.credential(r,n)}catch{return null}}}ec.TWITTER_SIGN_IN_METHOD="twitter.com";ec.PROVIDER_ID="twitter.com";async function eV(t,e){return E0(t,"POST","/v1/accounts:signUp",ll(t,e))}class ud{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await ya._fromIdTokenResponse(e,n,i),l=dE(n);return new ud({user:a,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=dE(n);return new ud({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function dE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class $g extends io{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,$g.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new $g(e,r,n,i)}}function XR(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?$g._fromErrorAndOperation(t,a,e,n):a})}async function tV(t,e,r=!1){const n=await Gf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ud._forOperation(t,"link",n)}async function rV(t,e,r=!1){const{auth:n}=t;if(Hs(n.app))return Promise.reject(Go(n));const i="reauthenticate";try{const a=await Gf(t,XR(n,i,e,t),r);Ct(a.idToken,n,"internal-error");const l=p4(a.idToken);Ct(l,n,"internal-error");const{sub:d}=l;return Ct(t.uid===d,n,"user-mismatch"),ud._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Vi(n,"user-mismatch"),a}}async function JR(t,e,r=!1){if(Hs(t.app))return Promise.reject(Go(t));const n="signIn",i=await XR(t,n,e),a=await ud._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function nV(t,e){return JR(dl(t),e)}async function QR(t){const e=dl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sV(t,e,r){const n=dl(t);await Bg(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",KG)}async function iV(t,e,r){if(Hs(t.app))return Promise.reject(Go(t));const n=dl(t),l=await Bg(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eV).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&QR(t),u}),d=await ud._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(d.user),d}function aV(t,e,r){return Hs(t.app)?Promise.reject(Go(t)):nV(_a(t),lh.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&QR(t),n})}async function oV(t,e){const r=_a(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:a}=await VG(r.auth,i);a!==t.email&&await t.reload()}function lV(t,e,r,n){return _a(t).onIdTokenChanged(e,r,n)}function cV(t,e,r){return _a(t).beforeAuthStateChanged(e,r)}function dV(t,e,r,n){return _a(t).onAuthStateChanged(e,r,n)}function uV(t){return _a(t).signOut()}const Ug="__sak";class ZR{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ug,"1"),this.storage.removeItem(Ug),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const hV=1e3,fV=10;class eP extends ZR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,d,u)=>{this.notifyListeners(l,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);_G()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,fV):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},hV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}eP.type="LOCAL";const pV=eP;class tP extends ZR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}tP.type="SESSION";const rP=tP;function mV(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class Xx{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Xx(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,l=this.handlersMap[i];if(!l?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const d=Array.from(l).map(async h=>h(r.origin,a)),u=await mV(d);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xx.receivers=[];function b4(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class gV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((d,u)=>{const h=b4("",20);i.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(m){const x=m;if(x.data.eventId===h)switch(x.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(x.data.response);break;default:clearTimeout(p),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function Ka(){return window}function xV(t){Ka().location.href=t}function nP(){return typeof Ka().WorkerGlobalScope<"u"&&typeof Ka().importScripts=="function"}async function yV(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bV(){return navigator?.serviceWorker?.controller||null}function vV(){return nP()?self:null}const sP="firebaseLocalStorageDb",wV=1,zg="firebaseLocalStorage",iP="fbase_key";class T0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Jx(t,e){return t.transaction([zg],e?"readwrite":"readonly").objectStore(zg)}function jV(){const t=indexedDB.deleteDatabase(sP);return new T0(t).toPromise()}function fj(){const t=indexedDB.open(sP,wV);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(zg,{keyPath:iP})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(zg)?e(n):(n.close(),await jV(),e(await fj()))})})}async function uE(t,e,r){const n=Jx(t,!0).put({[iP]:e,value:r});return new T0(n).toPromise()}async function NV(t,e){const r=Jx(t,!1).get(e),n=await new T0(r).toPromise();return n===void 0?null:n.value}function hE(t,e){const r=Jx(t,!0).delete(e);return new T0(r).toPromise()}const kV=800,SV=3;class aP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fj(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>SV)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nP()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xx._getInstance(vV()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await yV(),!this.activeServiceWorker)return;this.sender=new gV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fj();return await uE(e,Ug,"1"),await hE(e,Ug),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>uE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>NV(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>hE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Jx(i,!1).getAll();return new T0(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aP.type="LOCAL";const _V=aP;new C0(3e4,6e4);function oP(t,e){return e?zo(e):(Ct(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class v4 extends g4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Iu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Iu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Iu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function CV(t){return JR(t.auth,new v4(t),t.bypassAuthState)}function EV(t){const{auth:e,user:r}=t;return Ct(r,e,"internal-error"),rV(r,new v4(t),t.bypassAuthState)}async function AV(t){const{auth:e,user:r}=t;return Ct(r,e,"internal-error"),tV(r,new v4(t),t.bypassAuthState)}class lP{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CV;case"linkViaPopup":case"linkViaRedirect":return AV;case"reauthViaPopup":case"reauthViaRedirect":return EV;default:Vi(this.auth,"internal-error")}}resolve(e){Xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const TV=new C0(2e3,1e4);async function OV(t,e,r){if(Hs(t.app))return Promise.reject(wa(t,"operation-not-supported-in-this-environment"));const n=dl(t);aG(t,e,y4);const i=oP(n,r);return new Xc(n,"signInViaPopup",e,i).executeNotNull()}class Xc extends lP{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Xc.currentPopupAction&&Xc.currentPopupAction.cancel(),Xc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ct(e,this.auth,"internal-error"),e}async onExecution(){Xo(this.filter.length===1,"Popup operations only handle one event");const e=b4();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(wa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(wa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,TV.get())};e()}}Xc.currentPopupAction=null;const MV="pendingRedirect",gg=new Map;class LV extends lP{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=gg.get(this.auth._key());if(!e){try{const n=await RV(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}gg.set(this.auth._key(),e)}return this.bypassAuthState||gg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RV(t,e){const r=DV(e),n=IV(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function PV(t,e){gg.set(t._key(),e)}function IV(t){return zo(t._redirectPersistence)}function DV(t){return mg(MV,t.config.apiKey,t.name)}async function BV(t,e,r=!1){if(Hs(t.app))return Promise.reject(Go(t));const n=dl(t),i=oP(n,e),l=await new LV(n,i,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const $V=600*1e3;class UV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zV(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!cP(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(wa(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$V&&this.cachedEventUids.clear(),this.cachedEventUids.has(fE(e))}saveEventToCache(e){this.cachedEventUids.add(fE(e)),this.lastProcessedEventTime=Date.now()}}function fE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cP({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function zV(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cP(t);default:return!1}}async function qV(t,e={}){return cl(t,"GET","/v1/projects",e)}const FV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HV=/^https?/;async function WV(t){if(t.config.emulator)return;const{authorizedDomains:e}=await qV(t);for(const r of e)try{if(GV(r))return}catch{}Vi(t,"unauthorized-domain")}function GV(t){const e=uj(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!HV.test(r))return!1;if(FV.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const VV=new C0(3e4,6e4);function pE(){const t=Ka().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function KV(t){return new Promise((e,r)=>{function n(){pE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pE(),r(wa(t,"network-request-failed"))},timeout:VV.get()})}if(Ka().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ka().gapi?.load)n();else{const i=PG("iframefcb");return Ka()[i]=()=>{gapi.load?n():r(wa(t,"network-request-failed"))},GR(`${RG()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw xg=null,e})}let xg=null;function YV(t){return xg=xg||KV(t),xg}const XV=new C0(5e3,15e3),JV="__/auth/iframe",QV="emulator/auth/iframe",ZV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tK(t){const e=t.config;Ct(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?f4(e,QV):`https://${t.config.authDomain}/${JV}`,n={apiKey:e.apiKey,appName:t.name,v:Ed},i=eK.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${_0(n).slice(1)}`}async function rK(t){const e=await YV(t),r=Ka().gapi;return Ct(r,t,"internal-error"),e.open({where:document.body,url:tK(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZV,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const l=wa(t,"network-request-failed"),d=Ka().setTimeout(()=>{a(l)},XV.get());function u(){Ka().clearTimeout(d),i(n)}n.ping(u).then(u,()=>{a(l)})}))}const nK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sK=500,iK=600,aK="_blank",oK="http://localhost";class mE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lK(t,e,r,n=sK,i=iK){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let d="";const u={...nK,width:n.toString(),height:i.toString(),top:a,left:l},h=As().toLowerCase();r&&(d=$R(h)?aK:r),DR(h)&&(e=e||oK,u.scrollbars="yes");const p=Object.entries(u).reduce((x,[b,v])=>`${x}${b}=${v},`,"");if(SG(h)&&d!=="_self")return cK(e||"",d),new mE(null);const m=window.open(e||"",d,p);Ct(m,t,"popup-blocked");try{m.focus()}catch{}return new mE(m)}function cK(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const dK="__/auth/handler",uK="emulator/auth/handler",hK=encodeURIComponent("fac");async function gE(t,e,r,n,i,a){Ct(t.config.authDomain,t,"auth-domain-config-required"),Ct(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ed,eventId:i};if(e instanceof y4){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",GH(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))l[p]=m}if(e instanceof A0){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(l.scopes=p.join(","))}t.tenantId&&(l.tid=t.tenantId);const d=l;for(const p of Object.keys(d))d[p]===void 0&&delete d[p];const u=await t._getAppCheckToken(),h=u?`#${hK}=${encodeURIComponent(u)}`:"";return`${fK(t)}?${_0(d).slice(1)}${h}`}function fK({config:t}){return t.emulator?f4(t,uK):`https://${t.authDomain}/${dK}`}const x1="webStorageSupport";class pK{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rP,this._completeRedirectFn=BV,this._overrideRedirectResult=PV}async _openPopup(e,r,n,i){Xo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await gE(e,r,n,uj(),i);return lK(e,a,b4())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await gE(e,r,n,uj(),i);return xV(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Xo(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await rK(e),n=new UV(e);return r.register("authEvent",i=>(Ct(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(x1,{type:x1},i=>{const a=i?.[0]?.[x1];a!==void 0&&r(!!a),Vi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=WV(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return HR()||BR()||m4()}}const mK=pK;var xE="@firebase/auth",yE="1.12.0";class gK{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ct(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function xK(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yK(t){cd(new fc("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=n.options;Ct(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:l,authDomain:d,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:WR(t)},h=new OG(n,i,a,u);return zG(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),cd(new fc("auth-internal",e=>{const r=dl(e.getProvider("auth").getImmediate());return(n=>new gK(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Va(xE,yE,xK(t)),Va(xE,yE,"esm2020")}const bK=300,vK=NR("authIdTokenMaxAge")||bK;let bE=null;const wK=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>vK)return;const i=r?.token;bE!==i&&(bE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function jK(t=d4()){const e=Kx(t,"auth");if(e.isInitialized())return e.getImmediate();const r=UG(t,{popupRedirectResolver:mK,persistence:[_V,pV,rP]}),n=NR("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=wK(a.toString());cV(r,l,()=>l(r.currentUser)),lV(r,d=>l(d))}}const i=vR("auth");return i&&qG(r,`http://${i}`),r}function NK(){return document.getElementsByTagName("head")?.[0]??document}MG({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=wa("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",NK().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yK("Browser");const dP="firebasestorage.googleapis.com",kK="storageBucket",SK=120*1e3,_K=600*1e3;class ao extends io{constructor(e,r,n=0){super(y1(e),`Firebase Storage: ${r} (${y1(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ao.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return y1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ja;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ja||(Ja={}));function y1(t){return"storage/"+t}function CK(){const t="An unknown error occurred, please check the error payload for server response.";return new ao(Ja.UNKNOWN,t)}function EK(){return new ao(Ja.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function AK(){return new ao(Ja.CANCELED,"User canceled the upload/download.")}function TK(t){return new ao(Ja.INVALID_URL,"Invalid URL '"+t+"'.")}function OK(t){return new ao(Ja.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function vE(t){return new ao(Ja.INVALID_ARGUMENT,t)}function uP(){return new ao(Ja.APP_DELETED,"The Firebase app was deleted.")}function MK(t){return new ao(Ja.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class ba{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=ba.makeFromUrl(e,r)}catch{return new ba(e,"")}if(n.path==="")return n;throw OK(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const l="(/(.*))?$",d=new RegExp("^gs://"+i+l,"i"),u={bucket:1,path:3};function h(I){I.path_=decodeURIComponent(I.path)}const p="v[A-Za-z0-9_]+",m=r.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",b=new RegExp(`^https?://${m}/${p}/b/${i}/o${x}`,"i"),v={bucket:1,path:3},w=r===dP?"(?:storage.googleapis.com|storage.cloud.google.com)":r,k="([^?#]*)",_=new RegExp(`^https?://${w}/${i}/${k}`,"i"),A=[{regex:d,indices:u,postModify:a},{regex:b,indices:v,postModify:h},{regex:_,indices:{bucket:1,path:2},postModify:h}];for(let I=0;I<A.length;I++){const O=A[I],M=O.regex.exec(e);if(M){const E=M[O.indices.bucket];let R=M[O.indices.path];R||(R=""),n=new ba(E,R),O.postModify(n);break}}if(n==null)throw TK(e);return n}}class LK{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function RK(t,e,r){let n=1,i=null,a=null,l=!1,d=0;function u(){return d===2}let h=!1;function p(...k){h||(h=!0,e.apply(null,k))}function m(k){i=setTimeout(()=>{i=null,t(b,u())},k)}function x(){a&&clearTimeout(a)}function b(k,..._){if(h){x();return}if(k){x(),p.call(null,k,..._);return}if(u()||l){x(),p.call(null,k,..._);return}n<64&&(n*=2);let A;d===1?(d=2,A=0):A=(n+Math.random())*1e3,m(A)}let v=!1;function w(k){v||(v=!0,x(),!h&&(i!==null?(k||(d=2),clearTimeout(i),m(0)):k||(d=1)))}return m(0),a=setTimeout(()=>{l=!0,w(!0)},r),w}function PK(t){t(!1)}function IK(t){return t!==void 0}function wE(t,e,r,n){if(n<e)throw vE(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw vE(`Invalid value for '${t}'. Expected ${r} or less.`)}function DK(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var qg;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(qg||(qg={}));function BK(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}class $K{constructor(e,r,n,i,a,l,d,u,h,p,m,x=!0,b=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=d,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=p,this.connectionFactory_=m,this.retry=x,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,w)=>{this.resolve_=v,this.reject_=w,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new jm(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=d=>{const u=d.loaded,h=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const d=a.getErrorCode()===qg.NO_ERROR,u=a.getStatus();if(!d||BK(u,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===qg.ABORT;n(!1,new jm(!1,null,p));return}const h=this.successCodes_.indexOf(u)!==-1;n(!0,new jm(h,a))})},r=(n,i)=>{const a=this.resolve_,l=this.reject_,d=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(d,d.getResponse());IK(u)?a(u):a()}catch(u){l(u)}else if(d!==null){const u=CK();u.serverResponse=d.getErrorText(),this.errorCallback_?l(this.errorCallback_(d,u)):l(u)}else if(i.canceled){const u=this.appDelete_?uP():AK();l(u)}else{const u=EK();l(u)}};this.canceled_?r(!1,new jm(!1,null,!0)):this.backoffId_=RK(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&PK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class jm{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function UK(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function zK(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function qK(t,e){e&&(t["X-Firebase-GMPID"]=e)}function FK(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function HK(t,e,r,n,i,a,l=!0,d=!1){const u=DK(t.urlParams),h=t.url+u,p=Object.assign({},t.headers);return qK(p,e),UK(p,r),zK(p,a),FK(p,n),new $K(h,t.method,p,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,l,d)}function WK(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function GK(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class Fg{constructor(e,r){this._service=e,r instanceof ba?this._location=r:this._location=ba.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Fg(e,r)}get root(){const e=new ba(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return GK(this._location.path)}get storage(){return this._service}get parent(){const e=WK(this._location.path);if(e===null)return null;const r=new ba(this._location.bucket,e);return new Fg(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw MK(e)}}function jE(t,e){const r=e?.[kK];return r==null?null:ba.makeFromBucketSpec(r,t)}function VK(t,e,r,n={}){t.host=`${e}:${r}`;const i=oh(e);i&&(a4(`https://${t.host}/b`),o4("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:kR(a,t.app.options.projectId))}class KK{constructor(e,r,n,i,a,l=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=dP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=SK,this._maxUploadRetryTime=_K,this._requests=new Set,i!=null?this._bucket=ba.makeFromBucketSpec(i,this._host):this._bucket=jE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ba.makeFromBucketSpec(this._url,e):this._bucket=jE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){wE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){wE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fg(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new LK(uP());{const l=HK(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const NE="@firebase/storage",kE="0.14.0";const hP="storage";function YK(t=d4(),e){t=_a(t);const n=Kx(t,hP).getImmediate({identifier:e}),i=wR("storage");return i&&XK(n,...i),n}function XK(t,e,r,n={}){VK(t,e,r,n)}function JK(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new KK(r,n,i,e,Ed)}function QK(){cd(new fc(hP,JK,"PUBLIC").setMultipleInstances(!0)),Va(NE,kE,""),Va(NE,kE,"esm2020")}QK();var ZK="firebase",eY="12.7.0";Va(ZK,eY,"app");var SE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var w4;(function(){var t;function e(E,R){function $(){}$.prototype=R.prototype,E.F=R.prototype,E.prototype=new $,E.prototype.constructor=E,E.D=function(B,C,U){for(var L=Array(arguments.length-2),q=2;q<arguments.length;q++)L[q-2]=arguments[q];return R.prototype[C].apply(B,L)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,R,$){$||($=0);const B=Array(16);if(typeof R=="string")for(var C=0;C<16;++C)B[C]=R.charCodeAt($++)|R.charCodeAt($++)<<8|R.charCodeAt($++)<<16|R.charCodeAt($++)<<24;else for(C=0;C<16;++C)B[C]=R[$++]|R[$++]<<8|R[$++]<<16|R[$++]<<24;R=E.g[0],$=E.g[1],C=E.g[2];let U=E.g[3],L;L=R+(U^$&(C^U))+B[0]+3614090360&4294967295,R=$+(L<<7&4294967295|L>>>25),L=U+(C^R&($^C))+B[1]+3905402710&4294967295,U=R+(L<<12&4294967295|L>>>20),L=C+($^U&(R^$))+B[2]+606105819&4294967295,C=U+(L<<17&4294967295|L>>>15),L=$+(R^C&(U^R))+B[3]+3250441966&4294967295,$=C+(L<<22&4294967295|L>>>10),L=R+(U^$&(C^U))+B[4]+4118548399&4294967295,R=$+(L<<7&4294967295|L>>>25),L=U+(C^R&($^C))+B[5]+1200080426&4294967295,U=R+(L<<12&4294967295|L>>>20),L=C+($^U&(R^$))+B[6]+2821735955&4294967295,C=U+(L<<17&4294967295|L>>>15),L=$+(R^C&(U^R))+B[7]+4249261313&4294967295,$=C+(L<<22&4294967295|L>>>10),L=R+(U^$&(C^U))+B[8]+1770035416&4294967295,R=$+(L<<7&4294967295|L>>>25),L=U+(C^R&($^C))+B[9]+2336552879&4294967295,U=R+(L<<12&4294967295|L>>>20),L=C+($^U&(R^$))+B[10]+4294925233&4294967295,C=U+(L<<17&4294967295|L>>>15),L=$+(R^C&(U^R))+B[11]+2304563134&4294967295,$=C+(L<<22&4294967295|L>>>10),L=R+(U^$&(C^U))+B[12]+1804603682&4294967295,R=$+(L<<7&4294967295|L>>>25),L=U+(C^R&($^C))+B[13]+4254626195&4294967295,U=R+(L<<12&4294967295|L>>>20),L=C+($^U&(R^$))+B[14]+2792965006&4294967295,C=U+(L<<17&4294967295|L>>>15),L=$+(R^C&(U^R))+B[15]+1236535329&4294967295,$=C+(L<<22&4294967295|L>>>10),L=R+(C^U&($^C))+B[1]+4129170786&4294967295,R=$+(L<<5&4294967295|L>>>27),L=U+($^C&(R^$))+B[6]+3225465664&4294967295,U=R+(L<<9&4294967295|L>>>23),L=C+(R^$&(U^R))+B[11]+643717713&4294967295,C=U+(L<<14&4294967295|L>>>18),L=$+(U^R&(C^U))+B[0]+3921069994&4294967295,$=C+(L<<20&4294967295|L>>>12),L=R+(C^U&($^C))+B[5]+3593408605&4294967295,R=$+(L<<5&4294967295|L>>>27),L=U+($^C&(R^$))+B[10]+38016083&4294967295,U=R+(L<<9&4294967295|L>>>23),L=C+(R^$&(U^R))+B[15]+3634488961&4294967295,C=U+(L<<14&4294967295|L>>>18),L=$+(U^R&(C^U))+B[4]+3889429448&4294967295,$=C+(L<<20&4294967295|L>>>12),L=R+(C^U&($^C))+B[9]+568446438&4294967295,R=$+(L<<5&4294967295|L>>>27),L=U+($^C&(R^$))+B[14]+3275163606&4294967295,U=R+(L<<9&4294967295|L>>>23),L=C+(R^$&(U^R))+B[3]+4107603335&4294967295,C=U+(L<<14&4294967295|L>>>18),L=$+(U^R&(C^U))+B[8]+1163531501&4294967295,$=C+(L<<20&4294967295|L>>>12),L=R+(C^U&($^C))+B[13]+2850285829&4294967295,R=$+(L<<5&4294967295|L>>>27),L=U+($^C&(R^$))+B[2]+4243563512&4294967295,U=R+(L<<9&4294967295|L>>>23),L=C+(R^$&(U^R))+B[7]+1735328473&4294967295,C=U+(L<<14&4294967295|L>>>18),L=$+(U^R&(C^U))+B[12]+2368359562&4294967295,$=C+(L<<20&4294967295|L>>>12),L=R+($^C^U)+B[5]+4294588738&4294967295,R=$+(L<<4&4294967295|L>>>28),L=U+(R^$^C)+B[8]+2272392833&4294967295,U=R+(L<<11&4294967295|L>>>21),L=C+(U^R^$)+B[11]+1839030562&4294967295,C=U+(L<<16&4294967295|L>>>16),L=$+(C^U^R)+B[14]+4259657740&4294967295,$=C+(L<<23&4294967295|L>>>9),L=R+($^C^U)+B[1]+2763975236&4294967295,R=$+(L<<4&4294967295|L>>>28),L=U+(R^$^C)+B[4]+1272893353&4294967295,U=R+(L<<11&4294967295|L>>>21),L=C+(U^R^$)+B[7]+4139469664&4294967295,C=U+(L<<16&4294967295|L>>>16),L=$+(C^U^R)+B[10]+3200236656&4294967295,$=C+(L<<23&4294967295|L>>>9),L=R+($^C^U)+B[13]+681279174&4294967295,R=$+(L<<4&4294967295|L>>>28),L=U+(R^$^C)+B[0]+3936430074&4294967295,U=R+(L<<11&4294967295|L>>>21),L=C+(U^R^$)+B[3]+3572445317&4294967295,C=U+(L<<16&4294967295|L>>>16),L=$+(C^U^R)+B[6]+76029189&4294967295,$=C+(L<<23&4294967295|L>>>9),L=R+($^C^U)+B[9]+3654602809&4294967295,R=$+(L<<4&4294967295|L>>>28),L=U+(R^$^C)+B[12]+3873151461&4294967295,U=R+(L<<11&4294967295|L>>>21),L=C+(U^R^$)+B[15]+530742520&4294967295,C=U+(L<<16&4294967295|L>>>16),L=$+(C^U^R)+B[2]+3299628645&4294967295,$=C+(L<<23&4294967295|L>>>9),L=R+(C^($|~U))+B[0]+4096336452&4294967295,R=$+(L<<6&4294967295|L>>>26),L=U+($^(R|~C))+B[7]+1126891415&4294967295,U=R+(L<<10&4294967295|L>>>22),L=C+(R^(U|~$))+B[14]+2878612391&4294967295,C=U+(L<<15&4294967295|L>>>17),L=$+(U^(C|~R))+B[5]+4237533241&4294967295,$=C+(L<<21&4294967295|L>>>11),L=R+(C^($|~U))+B[12]+1700485571&4294967295,R=$+(L<<6&4294967295|L>>>26),L=U+($^(R|~C))+B[3]+2399980690&4294967295,U=R+(L<<10&4294967295|L>>>22),L=C+(R^(U|~$))+B[10]+4293915773&4294967295,C=U+(L<<15&4294967295|L>>>17),L=$+(U^(C|~R))+B[1]+2240044497&4294967295,$=C+(L<<21&4294967295|L>>>11),L=R+(C^($|~U))+B[8]+1873313359&4294967295,R=$+(L<<6&4294967295|L>>>26),L=U+($^(R|~C))+B[15]+4264355552&4294967295,U=R+(L<<10&4294967295|L>>>22),L=C+(R^(U|~$))+B[6]+2734768916&4294967295,C=U+(L<<15&4294967295|L>>>17),L=$+(U^(C|~R))+B[13]+1309151649&4294967295,$=C+(L<<21&4294967295|L>>>11),L=R+(C^($|~U))+B[4]+4149444226&4294967295,R=$+(L<<6&4294967295|L>>>26),L=U+($^(R|~C))+B[11]+3174756917&4294967295,U=R+(L<<10&4294967295|L>>>22),L=C+(R^(U|~$))+B[2]+718787259&4294967295,C=U+(L<<15&4294967295|L>>>17),L=$+(U^(C|~R))+B[9]+3951481745&4294967295,E.g[0]=E.g[0]+R&4294967295,E.g[1]=E.g[1]+(C+(L<<21&4294967295|L>>>11))&4294967295,E.g[2]=E.g[2]+C&4294967295,E.g[3]=E.g[3]+U&4294967295}n.prototype.v=function(E,R){R===void 0&&(R=E.length);const $=R-this.blockSize,B=this.C;let C=this.h,U=0;for(;U<R;){if(C==0)for(;U<=$;)i(this,E,U),U+=this.blockSize;if(typeof E=="string"){for(;U<R;)if(B[C++]=E.charCodeAt(U++),C==this.blockSize){i(this,B),C=0;break}}else for(;U<R;)if(B[C++]=E[U++],C==this.blockSize){i(this,B),C=0;break}}this.h=C,this.o+=R},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var R=1;R<E.length-8;++R)E[R]=0;R=this.o*8;for(var $=E.length-8;$<E.length;++$)E[$]=R&255,R/=256;for(this.v(E),E=Array(16),R=0,$=0;$<4;++$)for(let B=0;B<32;B+=8)E[R++]=this.g[$]>>>B&255;return E};function a(E,R){var $=d;return Object.prototype.hasOwnProperty.call($,E)?$[E]:$[E]=R(E)}function l(E,R){this.h=R;const $=[];let B=!0;for(let C=E.length-1;C>=0;C--){const U=E[C]|0;B&&U==R||($[C]=U,B=!1)}this.g=$}var d={};function u(E){return-128<=E&&E<128?a(E,function(R){return new l([R|0],R<0?-1:0)}):new l([E|0],E<0?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return k(h(-E));const R=[];let $=1;for(let B=0;E>=$;B++)R[B]=E/$|0,$*=4294967296;return new l(R,0)}function p(E,R){if(E.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(E.charAt(0)=="-")return k(p(E.substring(1),R));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const $=h(Math.pow(R,8));let B=m;for(let U=0;U<E.length;U+=8){var C=Math.min(8,E.length-U);const L=parseInt(E.substring(U,U+C),R);C<8?(C=h(Math.pow(R,C)),B=B.j(C).add(h(L))):(B=B.j($),B=B.add(h(L)))}return B}var m=u(0),x=u(1),b=u(16777216);t=l.prototype,t.m=function(){if(w(this))return-k(this).m();let E=0,R=1;for(let $=0;$<this.g.length;$++){const B=this.i($);E+=(B>=0?B:4294967296+B)*R,R*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(v(this))return"0";if(w(this))return"-"+k(this).toString(E);const R=h(Math.pow(E,6));var $=this;let B="";for(;;){const C=I($,R).g;$=_($,C.j(R));let U=(($.g.length>0?$.g[0]:$.h)>>>0).toString(E);if($=C,v($))return U+B;for(;U.length<6;)U="0"+U;B=U+B}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function v(E){if(E.h!=0)return!1;for(let R=0;R<E.g.length;R++)if(E.g[R]!=0)return!1;return!0}function w(E){return E.h==-1}t.l=function(E){return E=_(this,E),w(E)?-1:v(E)?0:1};function k(E){const R=E.g.length,$=[];for(let B=0;B<R;B++)$[B]=~E.g[B];return new l($,~E.h).add(x)}t.abs=function(){return w(this)?k(this):this},t.add=function(E){const R=Math.max(this.g.length,E.g.length),$=[];let B=0;for(let C=0;C<=R;C++){let U=B+(this.i(C)&65535)+(E.i(C)&65535),L=(U>>>16)+(this.i(C)>>>16)+(E.i(C)>>>16);B=L>>>16,U&=65535,L&=65535,$[C]=L<<16|U}return new l($,$[$.length-1]&-2147483648?-1:0)};function _(E,R){return E.add(k(R))}t.j=function(E){if(v(this)||v(E))return m;if(w(this))return w(E)?k(this).j(k(E)):k(k(this).j(E));if(w(E))return k(this.j(k(E)));if(this.l(b)<0&&E.l(b)<0)return h(this.m()*E.m());const R=this.g.length+E.g.length,$=[];for(var B=0;B<2*R;B++)$[B]=0;for(B=0;B<this.g.length;B++)for(let C=0;C<E.g.length;C++){const U=this.i(B)>>>16,L=this.i(B)&65535,q=E.i(C)>>>16,K=E.i(C)&65535;$[2*B+2*C]+=L*K,T($,2*B+2*C),$[2*B+2*C+1]+=U*K,T($,2*B+2*C+1),$[2*B+2*C+1]+=L*q,T($,2*B+2*C+1),$[2*B+2*C+2]+=U*q,T($,2*B+2*C+2)}for(E=0;E<R;E++)$[E]=$[2*E+1]<<16|$[2*E];for(E=R;E<2*R;E++)$[E]=0;return new l($,0)};function T(E,R){for(;(E[R]&65535)!=E[R];)E[R+1]+=E[R]>>>16,E[R]&=65535,R++}function A(E,R){this.g=E,this.h=R}function I(E,R){if(v(R))throw Error("division by zero");if(v(E))return new A(m,m);if(w(E))return R=I(k(E),R),new A(k(R.g),k(R.h));if(w(R))return R=I(E,k(R)),new A(k(R.g),R.h);if(E.g.length>30){if(w(E)||w(R))throw Error("slowDivide_ only works with positive integers.");for(var $=x,B=R;B.l(E)<=0;)$=O($),B=O(B);var C=M($,1),U=M(B,1);for(B=M(B,2),$=M($,2);!v(B);){var L=U.add(B);L.l(E)<=0&&(C=C.add($),U=L),B=M(B,1),$=M($,1)}return R=_(E,C.j(R)),new A(C,R)}for(C=m;E.l(R)>=0;){for($=Math.max(1,Math.floor(E.m()/R.m())),B=Math.ceil(Math.log($)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),U=h($),L=U.j(R);w(L)||L.l(E)>0;)$-=B,U=h($),L=U.j(R);v(U)&&(U=x),C=C.add(U),E=_(E,L)}return new A(C,E)}t.B=function(E){return I(this,E).h},t.and=function(E){const R=Math.max(this.g.length,E.g.length),$=[];for(let B=0;B<R;B++)$[B]=this.i(B)&E.i(B);return new l($,this.h&E.h)},t.or=function(E){const R=Math.max(this.g.length,E.g.length),$=[];for(let B=0;B<R;B++)$[B]=this.i(B)|E.i(B);return new l($,this.h|E.h)},t.xor=function(E){const R=Math.max(this.g.length,E.g.length),$=[];for(let B=0;B<R;B++)$[B]=this.i(B)^E.i(B);return new l($,this.h^E.h)};function O(E){const R=E.g.length+1,$=[];for(let B=0;B<R;B++)$[B]=E.i(B)<<1|E.i(B-1)>>>31;return new l($,E.h)}function M(E,R){const $=R>>5;R%=32;const B=E.g.length-$,C=[];for(let U=0;U<B;U++)C[U]=R>0?E.i(U+$)>>>R|E.i(U+$+1)<<32-R:E.i(U+$);return new l(C,E.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=h,l.fromString=p,w4=l}).apply(typeof SE<"u"?SE:typeof self<"u"?self:typeof window<"u"?window:{});var Nm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var t,e=Object.defineProperty;function r(j){j=[typeof globalThis=="object"&&globalThis,j,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nm=="object"&&Nm];for(var P=0;P<j.length;++P){var H=j[P];if(H&&H.Math==Math)return H}throw Error("Cannot find global object")}var n=r(this);function i(j,P){if(P)e:{var H=n;j=j.split(".");for(var ee=0;ee<j.length-1;ee++){var xe=j[ee];if(!(xe in H))break e;H=H[xe]}j=j[j.length-1],ee=H[j],P=P(ee),P!=ee&&P!=null&&e(H,j,{configurable:!0,writable:!0,value:P})}}i("Symbol.dispose",function(j){return j||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(j){return j||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(j){return j||function(P){var H=[],ee;for(ee in P)Object.prototype.hasOwnProperty.call(P,ee)&&H.push([ee,P[ee]]);return H}});var a=a||{},l=this||self;function d(j){var P=typeof j;return P=="object"&&j!=null||P=="function"}function u(j,P,H){return j.call.apply(j.bind,arguments)}function h(j,P,H){return h=u,h.apply(null,arguments)}function p(j,P){var H=Array.prototype.slice.call(arguments,1);return function(){var ee=H.slice();return ee.push.apply(ee,arguments),j.apply(this,ee)}}function m(j,P){function H(){}H.prototype=P.prototype,j.Z=P.prototype,j.prototype=new H,j.prototype.constructor=j,j.Ob=function(ee,xe,_e){for(var Ke=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Ke[Rt-2]=arguments[Rt];return P.prototype[xe].apply(ee,Ke)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?j=>j&&AsyncContext.Snapshot.wrap(j):j=>j;function b(j){const P=j.length;if(P>0){const H=Array(P);for(let ee=0;ee<P;ee++)H[ee]=j[ee];return H}return[]}function v(j,P){for(let ee=1;ee<arguments.length;ee++){const xe=arguments[ee];var H=typeof xe;if(H=H!="object"?H:xe?Array.isArray(xe)?"array":H:"null",H=="array"||H=="object"&&typeof xe.length=="number"){H=j.length||0;const _e=xe.length||0;j.length=H+_e;for(let Ke=0;Ke<_e;Ke++)j[H+Ke]=xe[Ke]}else j.push(xe)}}class w{constructor(P,H){this.i=P,this.j=H,this.h=0,this.g=null}get(){let P;return this.h>0?(this.h--,P=this.g,this.g=P.next,P.next=null):P=this.i(),P}}function k(j){l.setTimeout(()=>{throw j},0)}function _(){var j=E;let P=null;return j.g&&(P=j.g,j.g=j.g.next,j.g||(j.h=null),P.next=null),P}class T{constructor(){this.h=this.g=null}add(P,H){const ee=A.get();ee.set(P,H),this.h?this.h.next=ee:this.g=ee,this.h=ee}}var A=new w(()=>new I,j=>j.reset());class I{constructor(){this.next=this.g=this.h=null}set(P,H){this.h=P,this.g=H,this.next=null}reset(){this.next=this.g=this.h=null}}let O,M=!1,E=new T,R=()=>{const j=Promise.resolve(void 0);O=()=>{j.then($)}};function $(){for(var j;j=_();){try{j.h.call(j.g)}catch(H){k(H)}var P=A;P.j(j),P.h<100&&(P.h++,j.next=P.g,P.g=j)}M=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(j,P){this.type=j,this.g=this.target=P,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var j=!1,P=Object.defineProperty({},"passive",{get:function(){j=!0}});try{const H=()=>{};l.addEventListener("test",H,P),l.removeEventListener("test",H,P)}catch{}return j})();function L(j){return/^[\s\xa0]*$/.test(j)}function q(j,P){C.call(this,j?j.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,j&&this.init(j,P)}m(q,C),q.prototype.init=function(j,P){const H=this.type=j.type,ee=j.changedTouches&&j.changedTouches.length?j.changedTouches[0]:null;this.target=j.target||j.srcElement,this.g=P,P=j.relatedTarget,P||(H=="mouseover"?P=j.fromElement:H=="mouseout"&&(P=j.toElement)),this.relatedTarget=P,ee?(this.clientX=ee.clientX!==void 0?ee.clientX:ee.pageX,this.clientY=ee.clientY!==void 0?ee.clientY:ee.pageY,this.screenX=ee.screenX||0,this.screenY=ee.screenY||0):(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0),this.button=j.button,this.key=j.key||"",this.ctrlKey=j.ctrlKey,this.altKey=j.altKey,this.shiftKey=j.shiftKey,this.metaKey=j.metaKey,this.pointerId=j.pointerId||0,this.pointerType=j.pointerType,this.state=j.state,this.i=j,j.defaultPrevented&&q.Z.h.call(this)},q.prototype.h=function(){q.Z.h.call(this);const j=this.i;j.preventDefault?j.preventDefault():j.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),W=0;function V(j,P,H,ee,xe){this.listener=j,this.proxy=null,this.src=P,this.type=H,this.capture=!!ee,this.ha=xe,this.key=++W,this.da=this.fa=!1}function X(j){j.da=!0,j.listener=null,j.proxy=null,j.src=null,j.ha=null}function Z(j,P,H){for(const ee in j)P.call(H,j[ee],ee,j)}function G(j,P){for(const H in j)P.call(void 0,j[H],H,j)}function F(j){const P={};for(const H in j)P[H]=j[H];return P}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(j,P){let H,ee;for(let xe=1;xe<arguments.length;xe++){ee=arguments[xe];for(H in ee)j[H]=ee[H];for(let _e=0;_e<Y.length;_e++)H=Y[_e],Object.prototype.hasOwnProperty.call(ee,H)&&(j[H]=ee[H])}}function re(j){this.src=j,this.g={},this.h=0}re.prototype.add=function(j,P,H,ee,xe){const _e=j.toString();j=this.g[_e],j||(j=this.g[_e]=[],this.h++);const Ke=Le(j,P,ee,xe);return Ke>-1?(P=j[Ke],H||(P.fa=!1)):(P=new V(P,this.src,_e,!!ee,xe),P.fa=H,j.push(P)),P};function ue(j,P){const H=P.type;if(H in j.g){var ee=j.g[H],xe=Array.prototype.indexOf.call(ee,P,void 0),_e;(_e=xe>=0)&&Array.prototype.splice.call(ee,xe,1),_e&&(X(P),j.g[H].length==0&&(delete j.g[H],j.h--))}}function Le(j,P,H,ee){for(let xe=0;xe<j.length;++xe){const _e=j[xe];if(!_e.da&&_e.listener==P&&_e.capture==!!H&&_e.ha==ee)return xe}return-1}var de="closure_lm_"+(Math.random()*1e6|0),ve={};function te(j,P,H,ee,xe){if(Array.isArray(P)){for(let _e=0;_e<P.length;_e++)te(j,P[_e],H,ee,xe);return null}return H=pe(H),j&&j[K]?j.J(P,H,d(ee)?!!ee.capture:!1,xe):ge(j,P,H,!1,ee,xe)}function ge(j,P,H,ee,xe,_e){if(!P)throw Error("Invalid event type");const Ke=d(xe)?!!xe.capture:!!xe;let Rt=ze(j);if(Rt||(j[de]=Rt=new re(j)),H=Rt.add(P,H,ee,Ke,_e),H.proxy)return H;if(ee=ke(),H.proxy=ee,ee.src=j,ee.listener=H,j.addEventListener)U||(xe=Ke),xe===void 0&&(xe=!1),j.addEventListener(P.toString(),ee,xe);else if(j.attachEvent)j.attachEvent(Te(P.toString()),ee);else if(j.addListener&&j.removeListener)j.addListener(ee);else throw Error("addEventListener and attachEvent are unavailable.");return H}function ke(){function j(H){return P.call(j.src,j.listener,H)}const P=Ye;return j}function oe(j,P,H,ee,xe){if(Array.isArray(P))for(var _e=0;_e<P.length;_e++)oe(j,P[_e],H,ee,xe);else ee=d(ee)?!!ee.capture:!!ee,H=pe(H),j&&j[K]?(j=j.i,_e=String(P).toString(),_e in j.g&&(P=j.g[_e],H=Le(P,H,ee,xe),H>-1&&(X(P[H]),Array.prototype.splice.call(P,H,1),P.length==0&&(delete j.g[_e],j.h--)))):j&&(j=ze(j))&&(P=j.g[P.toString()],j=-1,P&&(j=Le(P,H,ee,xe)),(H=j>-1?P[j]:null)&&Ee(H))}function Ee(j){if(typeof j!="number"&&j&&!j.da){var P=j.src;if(P&&P[K])ue(P.i,j);else{var H=j.type,ee=j.proxy;P.removeEventListener?P.removeEventListener(H,ee,j.capture):P.detachEvent?P.detachEvent(Te(H),ee):P.addListener&&P.removeListener&&P.removeListener(ee),(H=ze(P))?(ue(H,j),H.h==0&&(H.src=null,P[de]=null)):X(j)}}}function Te(j){return j in ve?ve[j]:ve[j]="on"+j}function Ye(j,P){if(j.da)j=!0;else{P=new q(P,this);const H=j.listener,ee=j.ha||j.src;j.fa&&Ee(j),j=H.call(ee,P)}return j}function ze(j){return j=j[de],j instanceof re?j:null}var le="__closure_events_fn_"+(Math.random()*1e9>>>0);function pe(j){return typeof j=="function"?j:(j[le]||(j[le]=function(P){return j.handleEvent(P)}),j[le])}function me(){B.call(this),this.i=new re(this),this.M=this,this.G=null}m(me,B),me.prototype[K]=!0,me.prototype.removeEventListener=function(j,P,H,ee){oe(this,j,P,H,ee)};function Ie(j,P){var H,ee=j.G;if(ee)for(H=[];ee;ee=ee.G)H.push(ee);if(j=j.M,ee=P.type||P,typeof P=="string")P=new C(P,j);else if(P instanceof C)P.target=P.target||j;else{var xe=P;P=new C(ee,j),ne(P,xe)}xe=!0;let _e,Ke;if(H)for(Ke=H.length-1;Ke>=0;Ke--)_e=P.g=H[Ke],xe=Fe(_e,ee,!0,P)&&xe;if(_e=P.g=j,xe=Fe(_e,ee,!0,P)&&xe,xe=Fe(_e,ee,!1,P)&&xe,H)for(Ke=0;Ke<H.length;Ke++)_e=P.g=H[Ke],xe=Fe(_e,ee,!1,P)&&xe}me.prototype.N=function(){if(me.Z.N.call(this),this.i){var j=this.i;for(const P in j.g){const H=j.g[P];for(let ee=0;ee<H.length;ee++)X(H[ee]);delete j.g[P],j.h--}}this.G=null},me.prototype.J=function(j,P,H,ee){return this.i.add(String(j),P,!1,H,ee)},me.prototype.K=function(j,P,H,ee){return this.i.add(String(j),P,!0,H,ee)};function Fe(j,P,H,ee){if(P=j.i.g[String(P)],!P)return!0;P=P.concat();let xe=!0;for(let _e=0;_e<P.length;++_e){const Ke=P[_e];if(Ke&&!Ke.da&&Ke.capture==H){const Rt=Ke.listener,un=Ke.ha||Ke.src;Ke.fa&&ue(j.i,Ke),xe=Rt.call(un,ee)!==!1&&xe}}return xe&&!ee.defaultPrevented}function qe(j,P){if(typeof j!="function")if(j&&typeof j.handleEvent=="function")j=h(j.handleEvent,j);else throw Error("Invalid listener argument");return Number(P)>2147483647?-1:l.setTimeout(j,P||0)}function Xe(j){j.g=qe(()=>{j.g=null,j.i&&(j.i=!1,Xe(j))},j.l);const P=j.h;j.h=null,j.m.apply(null,P)}class He extends B{constructor(P,H){super(),this.m=P,this.l=H,this.h=null,this.i=!1,this.g=null}j(P){this.h=arguments,this.g?this.i=!0:Xe(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ut(j){B.call(this),this.h=j,this.g={}}m(ut,B);var Tt=[];function Ut(j){Z(j.g,function(P,H){this.g.hasOwnProperty(H)&&Ee(P)},j),j.g={}}ut.prototype.N=function(){ut.Z.N.call(this),Ut(this)},ut.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nt=l.JSON.stringify,kt=l.JSON.parse,mt=class{stringify(j){return l.JSON.stringify(j,void 0)}parse(j){return l.JSON.parse(j,void 0)}};function Re(){}function it(){}var jt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function yt(){C.call(this,"d")}m(yt,C);function Et(){C.call(this,"c")}m(Et,C);var ot={},ae=null;function Be(){return ae=ae||new me}ot.Ia="serverreachability";function Qe(j){C.call(this,ot.Ia,j)}m(Qe,C);function et(j){const P=Be();Ie(P,new Qe(P))}ot.STAT_EVENT="statevent";function bt(j,P){C.call(this,ot.STAT_EVENT,j),this.stat=P}m(bt,C);function Ve(j){const P=Be();Ie(P,new bt(P,j))}ot.Ja="timingevent";function Je(j,P){C.call(this,ot.Ja,j),this.size=P}m(Je,C);function pt(j,P){if(typeof j!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){j()},P)}function he(){this.g=!0}he.prototype.ua=function(){this.g=!1};function We(j,P,H,ee,xe,_e){j.info(function(){if(j.g)if(_e){var Ke="",Rt=_e.split("&");for(let ur=0;ur<Rt.length;ur++){var un=Rt[ur].split("=");if(un.length>1){const en=un[0];un=un[1];const us=en.split("_");Ke=us.length>=2&&us[1]=="type"?Ke+(en+"="+un+"&"):Ke+(en+"=redacted&")}}}else Ke=null;else Ke=_e;return"XMLHTTP REQ ("+ee+") [attempt "+xe+"]: "+P+`
`+H+`
`+Ke})}function vt(j,P,H,ee,xe,_e,Ke){j.info(function(){return"XMLHTTP RESP ("+ee+") [ attempt "+xe+"]: "+P+`
`+H+`
`+_e+" "+Ke})}function At(j,P,H,ee){j.info(function(){return"XMLHTTP TEXT ("+P+"): "+wr(j,H)+(ee?" "+ee:"")})}function Jt(j,P){j.info(function(){return"TIMEOUT: "+P})}he.prototype.info=function(){};function wr(j,P){if(!j.g)return P;if(!P)return null;try{const _e=JSON.parse(P);if(_e){for(j=0;j<_e.length;j++)if(Array.isArray(_e[j])){var H=_e[j];if(!(H.length<2)){var ee=H[1];if(Array.isArray(ee)&&!(ee.length<1)){var xe=ee[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(let Ke=1;Ke<ee.length;Ke++)ee[Ke]=""}}}}return nt(_e)}catch{return P}}var Mn={NO_ERROR:0,TIMEOUT:8},ys={},Xs;function je(){}m(je,Re),je.prototype.g=function(){return new XMLHttpRequest},Xs=new je;function Ce(j){return encodeURIComponent(String(j))}function Oe(j){var P=1;j=j.split(":");const H=[];for(;P>0&&j.length;)H.push(j.shift()),P--;return j.length&&H.push(j.join(":")),H}function Ze(j,P,H,ee){this.j=j,this.i=P,this.l=H,this.S=ee||1,this.V=new ut(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new wt}function wt(){this.i=null,this.g="",this.h=!1}var Lt={},lr={};function Ln(j,P,H){j.M=1,j.A=ji(zr(P)),j.u=H,j.R=!0,Qt(j,null)}function Qt(j,P){j.F=Date.now(),Ls(j),j.B=zr(j.A);var H=j.B,ee=j.S;Array.isArray(ee)||(ee=[String(ee)]),Pa(H.i,"t",ee),j.C=0,H=j.j.L,j.h=new wt,j.g=fp(j.j,H?P:null,!j.u),j.P>0&&(j.O=new He(h(j.Y,j,j.g),j.P)),P=j.V,H=j.g,ee=j.ba;var xe="readystatechange";Array.isArray(xe)||(xe&&(Tt[0]=xe.toString()),xe=Tt);for(let _e=0;_e<xe.length;_e++){const Ke=te(H,xe[_e],ee||P.handleEvent,!1,P.h||P);if(!Ke)break;P.g[Ke.key]=Ke}P=j.J?F(j.J):{},j.u?(j.v||(j.v="POST"),P["Content-Type"]="application/x-www-form-urlencoded",j.g.ea(j.B,j.v,j.u,P)):(j.v="GET",j.g.ea(j.B,j.v,null,P)),et(),We(j.i,j.v,j.B,j.l,j.S,j.u)}Ze.prototype.ba=function(j){j=j.target;const P=this.O;P&&se(j)==3?P.j():this.Y(j)},Ze.prototype.Y=function(j){try{if(j==this.g)e:{const Rt=se(this.g),un=this.g.ya(),ur=this.g.ca();if(!(Rt<3)&&(Rt!=3||this.g&&(this.h.h||this.g.la()||Se(this.g)))){this.K||Rt!=4||un==7||(un==8||ur<=0?et(3):et(2)),Mr(this);var P=this.g.ca();this.X=P;var H=Sc(this);if(this.o=P==200,vt(this.i,this.v,this.B,this.l,this.S,Rt,P),this.o){if(this.U&&!this.L){t:{if(this.g){var ee,xe=this.g;if((ee=xe.g?xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(ee)){var _e=ee;break t}}_e=null}if(j=_e)At(this.i,this.l,j,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Rs(this,j);else{this.o=!1,this.m=3,Ve(12),Fn(this),is(this);break e}}if(this.R){j=!0;let en;for(;!this.K&&this.C<H.length;)if(en=wl(this,H),en==lr){Rt==4&&(this.m=4,Ve(14),j=!1),At(this.i,this.l,null,"[Incomplete Response]");break}else if(en==Lt){this.m=4,Ve(15),At(this.i,this.l,H,"[Invalid Chunk]"),j=!1;break}else At(this.i,this.l,en,null),Rs(this,en);if(vl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rt!=4||H.length!=0||this.h.h||(this.m=1,Ve(16),j=!1),this.o=this.o&&j,!j)At(this.i,this.l,H,"[Invalid Chunked Response]"),Fn(this),is(this);else if(H.length>0&&!this.W){this.W=!0;var Ke=this.j;Ke.g==this&&Ke.aa&&!Ke.P&&(Ke.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),ri(Ke),Ke.P=!0,Ve(11))}}else At(this.i,this.l,H,null),Rs(this,H);Rt==4&&Fn(this),this.o&&!this.K&&(Rt==4?go(this.j,this):(this.o=!1,Ls(this)))}else Nt(this.g),P==400&&H.indexOf("Unknown SID")>0?(this.m=3,Ve(12)):(this.m=0,Ve(13)),Fn(this),is(this)}}}catch{}};function Sc(j){if(!vl(j))return j.g.la();const P=Se(j.g);if(P==="")return"";let H="";const ee=P.length,xe=se(j.g)==4;if(!j.h.i){if(typeof TextDecoder>"u")return Fn(j),is(j),"";j.h.i=new l.TextDecoder}for(let _e=0;_e<ee;_e++)j.h.h=!0,H+=j.h.i.decode(P[_e],{stream:!(xe&&_e==ee-1)});return P.length=0,j.h.g+=H,j.C=0,j.h.g}function vl(j){return j.g?j.v=="GET"&&j.M!=2&&j.j.Aa:!1}function wl(j,P){var H=j.C,ee=P.indexOf(`
`,H);return ee==-1?lr:(H=Number(P.substring(H,ee)),isNaN(H)?Lt:(ee+=1,ee+H>P.length?lr:(P=P.slice(ee,ee+H),j.C=ee+H,P)))}Ze.prototype.cancel=function(){this.K=!0,Fn(this)};function Ls(j){j.T=Date.now()+j.H,Oa(j,j.H)}function Oa(j,P){if(j.D!=null)throw Error("WatchDog timer not null");j.D=pt(h(j.aa,j),P)}function Mr(j){j.D&&(l.clearTimeout(j.D),j.D=null)}Ze.prototype.aa=function(){this.D=null;const j=Date.now();j-this.T>=0?(Jt(this.i,this.B),this.M!=2&&(et(),Ve(17)),Fn(this),this.m=2,is(this)):Oa(this,this.T-j)};function is(j){j.j.I==0||j.K||go(j.j,j)}function Fn(j){Mr(j);var P=j.O;P&&typeof P.dispose=="function"&&P.dispose(),j.O=null,Ut(j.V),j.g&&(P=j.g,j.g=null,P.abort(),P.dispose())}function Rs(j,P){try{var H=j.j;if(H.I!=0&&(H.g==j||Hn(H.h,j))){if(!j.L&&Hn(H.h,j)&&H.I==3){try{var ee=H.Ba.g.parse(P)}catch{ee=null}if(Array.isArray(ee)&&ee.length==3){var xe=ee;if(xe[0]==0){e:if(!H.v){if(H.g)if(H.g.F+3e3<j.F)na(H),dr(H);else break e;Kn(H),Ve(18)}}else H.xa=xe[1],0<H.xa-H.K&&xe[2]<37500&&H.F&&H.A==0&&!H.C&&(H.C=pt(h(H.Va,H),6e3));bs(H.h)<=1&&H.ta&&(H.ta=void 0)}else Da(H,11)}else if((j.L||H.g==j)&&na(H),!L(P))for(xe=H.Ba.g.parse(P),P=0;P<xe.length;P++){let ur=xe[P];const en=ur[0];if(!(en<=H.K))if(H.K=en,ur=ur[1],H.I==2)if(ur[0]=="c"){H.M=ur[1],H.ba=ur[2];const us=ur[3];us!=null&&(H.ka=us,H.j.info("VER="+H.ka));const xo=ur[4];xo!=null&&(H.za=xo,H.j.info("SVER="+H.za));const sa=ur[5];sa!=null&&typeof sa=="number"&&sa>0&&(ee=1.5*sa,H.O=ee,H.j.info("backChannelRequestTimeoutMs_="+ee)),ee=H;const ia=j.g;if(ia){const Cc=ia.g?ia.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cc){var _e=ee.h;_e.g||Cc.indexOf("spdy")==-1&&Cc.indexOf("quic")==-1&&Cc.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(as(_e,_e.h),_e.h=null))}if(ee.G){const zd=ia.g?ia.g.getResponseHeader("X-HTTP-Session-Id"):null;zd&&(ee.wa=zd,Zt(ee.J,ee.G,zd))}}H.I=3,H.l&&H.l.ra(),H.aa&&(H.T=Date.now()-j.F,H.j.info("Handshake RTT: "+H.T+"ms")),ee=H;var Ke=j;if(ee.na=hp(ee,ee.L?ee.ba:null,ee.W),Ke.L){Zi(ee.h,Ke);var Rt=Ke,un=ee.O;un&&(Rt.H=un),Rt.D&&(Mr(Rt),Ls(Rt)),ee.g=Ke}else ti(ee);H.i.length>0&&jr(H)}else ur[0]!="stop"&&ur[0]!="close"||Da(H,7);else H.I==3&&(ur[0]=="stop"||ur[0]=="close"?ur[0]=="stop"?Da(H,7):$t(H):ur[0]!="noop"&&H.l&&H.l.qa(ur),H.A=0)}}et(4)}catch{}}var Ur=class{constructor(j,P){this.g=j,this.map=P}};function uo(j){this.l=j||10,l.PerformanceNavigationTiming?(j=l.performance.getEntriesByType("navigation"),j=j.length>0&&(j[0].nextHopProtocol=="hq"||j[0].nextHopProtocol=="h2")):j=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=j?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wi(j){return j.h?!0:j.g?j.g.size>=j.j:!1}function bs(j){return j.h?1:j.g?j.g.size:0}function Hn(j,P){return j.h?j.h==P:j.g?j.g.has(P):!1}function as(j,P){j.g?j.g.add(P):j.h=P}function Zi(j,P){j.h&&j.h==P?j.h=null:j.g&&j.g.has(P)&&j.g.delete(P)}uo.prototype.cancel=function(){if(this.i=ho(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const j of this.g.values())j.cancel();this.g.clear()}};function ho(j){if(j.h!=null)return j.i.concat(j.h.G);if(j.g!=null&&j.g.size!==0){let P=j.i;for(const H of j.g.values())P=P.concat(H.G);return P}return b(j.i)}var jl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ma(j,P){if(j){j=j.split("&");for(let H=0;H<j.length;H++){const ee=j[H].indexOf("=");let xe,_e=null;ee>=0?(xe=j[H].substring(0,ee),_e=j[H].substring(ee+1)):xe=j[H],P(xe,_e?decodeURIComponent(_e.replace(/\+/g," ")):"")}}}function Wn(j){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let P;j instanceof Wn?(this.l=j.l,Lr(this,j.j),this.o=j.o,this.g=j.g,Ps(this,j.u),this.h=j.h,Js(this,Nl(j.i)),this.m=j.m):j&&(P=String(j).match(jl))?(this.l=!1,Lr(this,P[1]||"",!0),this.o=Is(P[2]||""),this.g=Is(P[3]||"",!0),Ps(this,P[4]),this.h=Is(P[5]||"",!0),Js(this,P[6]||"",!0),this.m=Is(P[7]||"")):(this.l=!1,this.i=new mn(null,this.l))}Wn.prototype.toString=function(){const j=[];var P=this.j;P&&j.push(ea(P,La,!0),":");var H=this.g;return(H||P=="file")&&(j.push("//"),(P=this.o)&&j.push(ea(P,La,!0),"@"),j.push(Ce(H).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),H=this.u,H!=null&&j.push(":",String(H))),(H=this.h)&&(this.g&&H.charAt(0)!="/"&&j.push("/"),j.push(ea(H,H.charAt(0)=="/"?fo:Ra,!0))),(H=this.i.toString())&&j.push("?",H),(H=this.m)&&j.push("#",ea(H,ki)),j.join("")},Wn.prototype.resolve=function(j){const P=zr(this);let H=!!j.j;H?Lr(P,j.j):H=!!j.o,H?P.o=j.o:H=!!j.g,H?P.g=j.g:H=j.u!=null;var ee=j.h;if(H)Ps(P,j.u);else if(H=!!j.h){if(ee.charAt(0)!="/")if(this.g&&!this.h)ee="/"+ee;else{var xe=P.h.lastIndexOf("/");xe!=-1&&(ee=P.h.slice(0,xe+1)+ee)}if(xe=ee,xe==".."||xe==".")ee="";else if(xe.indexOf("./")!=-1||xe.indexOf("/.")!=-1){ee=xe.lastIndexOf("/",0)==0,xe=xe.split("/");const _e=[];for(let Ke=0;Ke<xe.length;){const Rt=xe[Ke++];Rt=="."?ee&&Ke==xe.length&&_e.push(""):Rt==".."?((_e.length>1||_e.length==1&&_e[0]!="")&&_e.pop(),ee&&Ke==xe.length&&_e.push("")):(_e.push(Rt),ee=!0)}ee=_e.join("/")}else ee=xe}return H?P.h=ee:H=j.i.toString()!=="",H?Js(P,Nl(j.i)):H=!!j.m,H&&(P.m=j.m),P};function zr(j){return new Wn(j)}function Lr(j,P,H){j.j=H?Is(P,!0):P,j.j&&(j.j=j.j.replace(/:$/,""))}function Ps(j,P){if(P){if(P=Number(P),isNaN(P)||P<0)throw Error("Bad port number "+P);j.u=P}else j.u=null}function Js(j,P,H){P instanceof mn?(j.i=P,Ia(j.i,j.l)):(H||(P=ea(P,Ni)),j.i=new mn(P,j.l))}function Zt(j,P,H){j.i.set(P,H)}function ji(j){return Zt(j,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),j}function Is(j,P){return j?P?decodeURI(j.replace(/%25/g,"%2525")):decodeURIComponent(j):""}function ea(j,P,H){return typeof j=="string"?(j=encodeURI(j).replace(P,Rn),H&&(j=j.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j):null}function Rn(j){return j=j.charCodeAt(0),"%"+(j>>4&15).toString(16)+(j&15).toString(16)}var La=/[#\/\?@]/g,Ra=/[#\?:]/g,fo=/[#\?]/g,Ni=/[#\?@]/g,ki=/#/g;function mn(j,P){this.h=this.g=null,this.i=j||null,this.j=!!P}function qr(j){j.g||(j.g=new Map,j.h=0,j.i&&Ma(j.i,function(P,H){j.add(decodeURIComponent(P.replace(/\+/g," ")),H)}))}t=mn.prototype,t.add=function(j,P){qr(this),this.i=null,j=Si(this,j);let H=this.g.get(j);return H||this.g.set(j,H=[]),H.push(P),this.h+=1,this};function Ds(j,P){qr(j),P=Si(j,P),j.g.has(P)&&(j.i=null,j.h-=j.g.get(P).length,j.g.delete(P))}function po(j,P){return qr(j),P=Si(j,P),j.g.has(P)}t.forEach=function(j,P){qr(this),this.g.forEach(function(H,ee){H.forEach(function(xe){j.call(P,xe,ee,this)},this)},this)};function os(j,P){qr(j);let H=[];if(typeof P=="string")po(j,P)&&(H=H.concat(j.g.get(Si(j,P))));else for(j=Array.from(j.g.values()),P=0;P<j.length;P++)H=H.concat(j[P]);return H}t.set=function(j,P){return qr(this),this.i=null,j=Si(this,j),po(this,j)&&(this.h-=this.g.get(j).length),this.g.set(j,[P]),this.h+=1,this},t.get=function(j,P){return j?(j=os(this,j),j.length>0?String(j[0]):P):P};function Pa(j,P,H){Ds(j,P),H.length>0&&(j.i=null,j.g.set(Si(j,P),b(H)),j.h+=H.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const j=[],P=Array.from(this.g.keys());for(let ee=0;ee<P.length;ee++){var H=P[ee];const xe=Ce(H);H=os(this,H);for(let _e=0;_e<H.length;_e++){let Ke=xe;H[_e]!==""&&(Ke+="="+Ce(H[_e])),j.push(Ke)}}return this.i=j.join("&")};function Nl(j){const P=new mn;return P.i=j.i,j.g&&(P.g=new Map(j.g),P.h=j.h),P}function Si(j,P){return P=String(P),j.j&&(P=P.toLowerCase()),P}function Ia(j,P){P&&!j.j&&(qr(j),j.i=null,j.g.forEach(function(H,ee){const xe=ee.toLowerCase();ee!=xe&&(Ds(this,ee),Pa(this,xe,H))},j)),j.j=P}function ls(j,P){const H=new he;if(l.Image){const ee=new Image;ee.onload=p(Gn,H,"TestLoadImage: loaded",!0,P,ee),ee.onerror=p(Gn,H,"TestLoadImage: error",!1,P,ee),ee.onabort=p(Gn,H,"TestLoadImage: abort",!1,P,ee),ee.ontimeout=p(Gn,H,"TestLoadImage: timeout",!1,P,ee),l.setTimeout(function(){ee.ontimeout&&ee.ontimeout()},1e4),ee.src=j}else P(!1)}function cn(j,P){const H=new he,ee=new AbortController,xe=setTimeout(()=>{ee.abort(),Gn(H,"TestPingServer: timeout",!1,P)},1e4);fetch(j,{signal:ee.signal}).then(_e=>{clearTimeout(xe),_e.ok?Gn(H,"TestPingServer: ok",!0,P):Gn(H,"TestPingServer: server error",!1,P)}).catch(()=>{clearTimeout(xe),Gn(H,"TestPingServer: error",!1,P)})}function Gn(j,P,H,ee,xe){try{xe&&(xe.onload=null,xe.onerror=null,xe.onabort=null,xe.ontimeout=null),ee(H)}catch{}}function Qs(){this.g=new mt}function Vn(j){this.i=j.Sb||null,this.h=j.ab||!1}m(Vn,Re),Vn.prototype.g=function(){return new Zs(this.i,this.h)};function Zs(j,P){me.call(this),this.H=j,this.o=P,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Zs,me),t=Zs.prototype,t.open=function(j,P){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=j,this.D=P,this.readyState=1,cs(this)},t.send=function(j){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const P={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};j&&(P.body=j),(this.H||l).fetch(new Request(this.D,P)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,_i(this)),this.readyState=0},t.Pa=function(j){if(this.g&&(this.l=j,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=j.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")j.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in j){if(this.j=j.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ei(this)}else j.text().then(this.Oa.bind(this),this.ga.bind(this))};function ei(j){j.j.read().then(j.Ma.bind(j)).catch(j.ga.bind(j))}t.Ma=function(j){if(this.g){if(this.o&&j.value)this.response.push(j.value);else if(!this.o){var P=j.value?j.value:new Uint8Array(0);(P=this.B.decode(P,{stream:!j.done}))&&(this.response=this.responseText+=P)}j.done?_i(this):cs(this),this.readyState==3&&ei(this)}},t.Oa=function(j){this.g&&(this.response=this.responseText=j,_i(this))},t.Na=function(j){this.g&&(this.response=j,_i(this))},t.ga=function(){this.g&&_i(this)};function _i(j){j.readyState=4,j.l=null,j.j=null,j.B=null,cs(j)}t.setRequestHeader=function(j,P){this.A.append(j,P)},t.getResponseHeader=function(j){return this.h&&this.h.get(j.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const j=[],P=this.h.entries();for(var H=P.next();!H.done;)H=H.value,j.push(H[0]+": "+H[1]),H=P.next();return j.join(`\r
`)};function cs(j){j.onreadystatechange&&j.onreadystatechange.call(j)}Object.defineProperty(Zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(j){this.m=j?"include":"same-origin"}});function Pn(j){let P="";return Z(j,function(H,ee){P+=ee,P+=":",P+=H,P+=`\r
`}),P}function Ci(j,P,H){e:{for(ee in H){var ee=!1;break e}ee=!0}ee||(H=Pn(H),typeof j=="string"?H!=null&&Ce(H):Zt(j,P,H))}function zt(j){me.call(this),this.headers=new Map,this.L=j||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(zt,me);var vs=/^https?$/i,ta=["POST","PUT"];t=zt.prototype,t.Fa=function(j){this.H=j},t.ea=function(j,P,H,ee){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+j);P=P?P.toUpperCase():"GET",this.D=j,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Xs.g(),this.g.onreadystatechange=x(h(this.Ca,this));try{this.B=!0,this.g.open(P,String(j),!0),this.B=!1}catch(_e){ra(this,_e);return}if(j=H||"",H=new Map(this.headers),ee)if(Object.getPrototypeOf(ee)===Object.prototype)for(var xe in ee)H.set(xe,ee[xe]);else if(typeof ee.keys=="function"&&typeof ee.get=="function")for(const _e of ee.keys())H.set(_e,ee.get(_e));else throw Error("Unknown input type for opt_headers: "+String(ee));ee=Array.from(H.keys()).find(_e=>_e.toLowerCase()=="content-type"),xe=l.FormData&&j instanceof l.FormData,!(Array.prototype.indexOf.call(ta,P,void 0)>=0)||ee||xe||H.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,Ke]of H)this.g.setRequestHeader(_e,Ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(j),this.v=!1}catch(_e){ra(this,_e)}};function ra(j,P){j.h=!1,j.g&&(j.j=!0,j.g.abort(),j.j=!1),j.l=P,j.o=5,mo(j),Q(j)}function mo(j){j.A||(j.A=!0,Ie(j,"complete"),Ie(j,"error"))}t.abort=function(j){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=j||7,Ie(this,"complete"),Ie(this,"abort"),Q(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Q(this,!0)),zt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?D(this):this.Xa())},t.Xa=function(){D(this)};function D(j){if(j.h&&typeof a<"u"){if(j.v&&se(j)==4)setTimeout(j.Ca.bind(j),0);else if(Ie(j,"readystatechange"),se(j)==4){j.h=!1;try{const _e=j.ca();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var P=!0;break e;default:P=!1}var H;if(!(H=P)){var ee;if(ee=_e===0){let Ke=String(j.D).match(jl)[1]||null;!Ke&&l.self&&l.self.location&&(Ke=l.self.location.protocol.slice(0,-1)),ee=!vs.test(Ke?Ke.toLowerCase():"")}H=ee}if(H)Ie(j,"complete"),Ie(j,"success");else{j.o=6;try{var xe=se(j)>2?j.g.statusText:""}catch{xe=""}j.l=xe+" ["+j.ca()+"]",mo(j)}}finally{Q(j)}}}}function Q(j,P){if(j.g){j.m&&(clearTimeout(j.m),j.m=null);const H=j.g;j.g=null,P||Ie(j,"ready");try{H.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function se(j){return j.g?j.g.readyState:0}t.ca=function(){try{return se(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(j){if(this.g){var P=this.g.responseText;return j&&P.indexOf(j)==0&&(P=P.substring(j.length)),kt(P)}};function Se(j){try{if(!j.g)return null;if("response"in j.g)return j.g.response;switch(j.F){case"":case"text":return j.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in j.g)return j.g.mozResponseArrayBuffer}return null}catch{return null}}function Nt(j){const P={};j=(j.g&&se(j)>=2&&j.g.getAllResponseHeaders()||"").split(`\r
`);for(let ee=0;ee<j.length;ee++){if(L(j[ee]))continue;var H=Oe(j[ee]);const xe=H[0];if(H=H[1],typeof H!="string")continue;H=H.trim();const _e=P[xe]||[];P[xe]=_e,_e.push(H)}G(P,function(ee){return ee.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function rt(j,P,H){return H&&H.internalChannelParams&&H.internalChannelParams[j]||P}function It(j){this.za=0,this.i=[],this.j=new he,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=rt("failFast",!1,j),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=rt("baseRetryDelayMs",5e3,j),this.Za=rt("retryDelaySeedMs",1e4,j),this.Ta=rt("forwardChannelMaxRetries",2,j),this.va=rt("forwardChannelRequestTimeoutMs",2e4,j),this.ma=j&&j.xmlHttpFactory||void 0,this.Ua=j&&j.Rb||void 0,this.Aa=j&&j.useFetchStreams||!1,this.O=void 0,this.L=j&&j.supportsCrossDomainXhr||!1,this.M="",this.h=new uo(j&&j.concurrentRequestLimit),this.Ba=new Qs,this.S=j&&j.fastHandshake||!1,this.R=j&&j.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=j&&j.Pb||!1,j&&j.ua&&this.j.ua(),j&&j.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&j&&j.detectBufferingProxy||!1,this.ia=void 0,j&&j.longPollingTimeout&&j.longPollingTimeout>0&&(this.ia=j.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=It.prototype,t.ka=8,t.I=1,t.connect=function(j,P,H,ee){Ve(0),this.W=j,this.H=P||{},H&&ee!==void 0&&(this.H.OSID=H,this.H.OAID=ee),this.F=this.X,this.J=hp(this,null,this.W),jr(this)};function $t(j){if(Ft(j),j.I==3){var P=j.V++,H=zr(j.J);if(Zt(H,"SID",j.M),Zt(H,"RID",P),Zt(H,"TYPE","terminate"),Fr(j,H),P=new Ze(j,j.j,P),P.M=2,P.A=ji(zr(H)),H=!1,l.navigator&&l.navigator.sendBeacon)try{H=l.navigator.sendBeacon(P.A.toString(),"")}catch{}!H&&l.Image&&(new Image().src=P.A,H=!0),H||(P.g=fp(P.j,null),P.g.ea(P.A)),P.F=Date.now(),Ls(P)}up(j)}function dr(j){j.g&&(ri(j),j.g.cancel(),j.g=null)}function Ft(j){dr(j),j.v&&(l.clearTimeout(j.v),j.v=null),na(j),j.h.cancel(),j.m&&(typeof j.m=="number"&&l.clearTimeout(j.m),j.m=null)}function jr(j){if(!wi(j.h)&&!j.m){j.m=!0;var P=j.Ea;O||R(),M||(O(),M=!0),E.add(P,j),j.D=0}}function dn(j,P){return bs(j.h)>=j.h.j-(j.m?1:0)?!1:j.m?(j.i=P.G.concat(j.i),!0):j.I==1||j.I==2||j.D>=(j.Sa?0:j.Ta)?!1:(j.m=pt(h(j.Ea,j,P),dp(j,j.D)),j.D++,!0)}t.Ea=function(j){if(this.m)if(this.m=null,this.I==1){if(!j){this.V=Math.floor(Math.random()*1e5),j=this.V++;const xe=new Ze(this,this.j,j);let _e=this.o;if(this.U&&(_e?(_e=F(_e),ne(_e,this.U)):_e=this.U),this.u!==null||this.R||(xe.J=_e,_e=null),this.S)e:{for(var P=0,H=0;H<this.i.length;H++){t:{var ee=this.i[H];if("__data__"in ee.map&&(ee=ee.map.__data__,typeof ee=="string")){ee=ee.length;break t}ee=void 0}if(ee===void 0)break;if(P+=ee,P>4096){P=H;break e}if(P===4096||H===this.i.length-1){P=H+1;break e}}P=1e3}else P=1e3;P=Zr(this,xe,P),H=zr(this.J),Zt(H,"RID",j),Zt(H,"CVER",22),this.G&&Zt(H,"X-HTTP-Session-Id",this.G),Fr(this,H),_e&&(this.R?P="headers="+Ce(Pn(_e))+"&"+P:this.u&&Ci(H,this.u,_e)),as(this.h,xe),this.Ra&&Zt(H,"TYPE","init"),this.S?(Zt(H,"$req",P),Zt(H,"SID","null"),xe.U=!0,Ln(xe,H,null)):Ln(xe,H,P),this.I=2}}else this.I==3&&(j?Rr(this,j):this.i.length==0||wi(this.h)||Rr(this))};function Rr(j,P){var H;P?H=P.l:H=j.V++;const ee=zr(j.J);Zt(ee,"SID",j.M),Zt(ee,"RID",H),Zt(ee,"AID",j.K),Fr(j,ee),j.u&&j.o&&Ci(ee,j.u,j.o),H=new Ze(j,j.j,H,j.D+1),j.u===null&&(H.J=j.o),P&&(j.i=P.G.concat(j.i)),P=Zr(j,H,1e3),H.H=Math.round(j.va*.5)+Math.round(j.va*.5*Math.random()),as(j.h,H),Ln(H,ee,P)}function Fr(j,P){j.H&&Z(j.H,function(H,ee){Zt(P,ee,H)}),j.l&&Z({},function(H,ee){Zt(P,ee,H)})}function Zr(j,P,H){H=Math.min(j.i.length,H);const ee=j.l?h(j.l.Ka,j.l,j):null;e:{var xe=j.i;let Rt=-1;for(;;){const un=["count="+H];Rt==-1?H>0?(Rt=xe[0].g,un.push("ofs="+Rt)):Rt=0:un.push("ofs="+Rt);let ur=!0;for(let en=0;en<H;en++){var _e=xe[en].g;const us=xe[en].map;if(_e-=Rt,_e<0)Rt=Math.max(0,xe[en].g-100),ur=!1;else try{_e="req"+_e+"_"||"";try{var Ke=us instanceof Map?us:Object.entries(us);for(const[xo,sa]of Ke){let ia=sa;d(sa)&&(ia=nt(sa)),un.push(_e+xo+"="+encodeURIComponent(ia))}}catch(xo){throw un.push(_e+"type="+encodeURIComponent("_badmap")),xo}}catch{ee&&ee(us)}}if(ur){Ke=un.join("&");break e}}Ke=void 0}return j=j.i.splice(0,H),P.G=j,Ke}function ti(j){if(!j.g&&!j.v){j.Y=1;var P=j.Da;O||R(),M||(O(),M=!0),E.add(P,j),j.A=0}}function Kn(j){return j.g||j.v||j.A>=3?!1:(j.Y++,j.v=pt(h(j.Da,j),dp(j,j.A)),j.A++,!0)}t.Da=function(){if(this.v=null,_c(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var j=4*this.T;this.j.info("BP detection timer enabled: "+j),this.B=pt(h(this.Wa,this),j)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ve(10),dr(this),_c(this))};function ri(j){j.B!=null&&(l.clearTimeout(j.B),j.B=null)}function _c(j){j.g=new Ze(j,j.j,"rpc",j.Y),j.u===null&&(j.g.J=j.o),j.g.P=0;var P=zr(j.na);Zt(P,"RID","rpc"),Zt(P,"SID",j.M),Zt(P,"AID",j.K),Zt(P,"CI",j.F?"0":"1"),!j.F&&j.ia&&Zt(P,"TO",j.ia),Zt(P,"TYPE","xmlhttp"),Fr(j,P),j.u&&j.o&&Ci(P,j.u,j.o),j.O&&(j.g.H=j.O);var H=j.g;j=j.ba,H.M=1,H.A=ji(zr(P)),H.u=null,H.R=!0,Qt(H,j)}t.Va=function(){this.C!=null&&(this.C=null,dr(this),Kn(this),Ve(19))};function na(j){j.C!=null&&(l.clearTimeout(j.C),j.C=null)}function go(j,P){var H=null;if(j.g==P){na(j),ri(j),j.g=null;var ee=2}else if(Hn(j.h,P))H=P.G,Zi(j.h,P),ee=1;else return;if(j.I!=0){if(P.o)if(ee==1){H=P.u?P.u.length:0,P=Date.now()-P.F;var xe=j.D;ee=Be(),Ie(ee,new Je(ee,H)),jr(j)}else ti(j);else if(xe=P.m,xe==3||xe==0&&P.X>0||!(ee==1&&dn(j,P)||ee==2&&Kn(j)))switch(H&&H.length>0&&(P=j.h,P.i=P.i.concat(H)),xe){case 1:Da(j,5);break;case 4:Da(j,10);break;case 3:Da(j,6);break;default:Da(j,2)}}}function dp(j,P){let H=j.Qa+Math.floor(Math.random()*j.Za);return j.isActive()||(H*=2),H*P}function Da(j,P){if(j.j.info("Error code "+P),P==2){var H=h(j.bb,j),ee=j.Ua;const xe=!ee;ee=new Wn(ee||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Lr(ee,"https"),ji(ee),xe?ls(ee.toString(),H):cn(ee.toString(),H)}else Ve(2);j.I=0,j.l&&j.l.pa(P),up(j),Ft(j)}t.bb=function(j){j?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function up(j){if(j.I=0,j.ja=[],j.l){const P=ho(j.h);(P.length!=0||j.i.length!=0)&&(v(j.ja,P),v(j.ja,j.i),j.h.i.length=0,b(j.i),j.i.length=0),j.l.oa()}}function hp(j,P,H){var ee=H instanceof Wn?zr(H):new Wn(H);if(ee.g!="")P&&(ee.g=P+"."+ee.g),Ps(ee,ee.u);else{var xe=l.location;ee=xe.protocol,P=P?P+"."+xe.hostname:xe.hostname,xe=+xe.port;const _e=new Wn(null);ee&&Lr(_e,ee),P&&(_e.g=P),xe&&Ps(_e,xe),H&&(_e.h=H),ee=_e}return H=j.G,P=j.wa,H&&P&&Zt(ee,H,P),Zt(ee,"VER",j.ka),Fr(j,ee),ee}function fp(j,P,H){if(P&&!j.L)throw Error("Can't create secondary domain capable XhrIo object.");return P=j.Aa&&!j.ma?new zt(new Vn({ab:H})):new zt(j.ma),P.Fa(j.L),P}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function pp(){}t=pp.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ds(j,P){me.call(this),this.g=new It(P),this.l=j,this.h=P&&P.messageUrlParams||null,j=P&&P.messageHeaders||null,P&&P.clientProtocolHeaderRequired&&(j?j["X-Client-Protocol"]="webchannel":j={"X-Client-Protocol":"webchannel"}),this.g.o=j,j=P&&P.initMessageHeaders||null,P&&P.messageContentType&&(j?j["X-WebChannel-Content-Type"]=P.messageContentType:j={"X-WebChannel-Content-Type":P.messageContentType}),P&&P.sa&&(j?j["X-WebChannel-Client-Profile"]=P.sa:j={"X-WebChannel-Client-Profile":P.sa}),this.g.U=j,(j=P&&P.Qb)&&!L(j)&&(this.g.u=j),this.A=P&&P.supportsCrossDomainXhr||!1,this.v=P&&P.sendRawJson||!1,(P=P&&P.httpSessionIdParam)&&!L(P)&&(this.g.G=P,j=this.h,j!==null&&P in j&&(j=this.h,P in j&&delete j[P])),this.j=new kl(this)}m(ds,me),ds.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ds.prototype.close=function(){$t(this.g)},ds.prototype.o=function(j){var P=this.g;if(typeof j=="string"){var H={};H.__data__=j,j=H}else this.v&&(H={},H.__data__=nt(j),j=H);P.i.push(new Ur(P.Ya++,j)),P.I==3&&jr(P)},ds.prototype.N=function(){this.g.l=null,delete this.j,$t(this.g),delete this.g,ds.Z.N.call(this)};function mp(j){yt.call(this),j.__headers__&&(this.headers=j.__headers__,this.statusCode=j.__status__,delete j.__headers__,delete j.__status__);var P=j.__sm__;if(P){e:{for(const H in P){j=H;break e}j=void 0}(this.i=j)&&(j=this.i,P=P!==null&&j in P?P[j]:void 0),this.data=P}else this.data=j}m(mp,yt);function gp(){Et.call(this),this.status=1}m(gp,Et);function kl(j){this.g=j}m(kl,pp),kl.prototype.ra=function(){Ie(this.g,"a")},kl.prototype.qa=function(j){Ie(this.g,new mp(j))},kl.prototype.pa=function(j){Ie(this.g,new gp)},kl.prototype.oa=function(){Ie(this.g,"b")},ds.prototype.send=ds.prototype.o,ds.prototype.open=ds.prototype.m,ds.prototype.close=ds.prototype.close,Mn.NO_ERROR=0,Mn.TIMEOUT=8,Mn.HTTP_ERROR=6,ys.COMPLETE="complete",it.EventType=jt,jt.OPEN="a",jt.CLOSE="b",jt.ERROR="c",jt.MESSAGE="d",me.prototype.listen=me.prototype.J,zt.prototype.listenOnce=zt.prototype.K,zt.prototype.getLastError=zt.prototype.Ha,zt.prototype.getLastErrorCode=zt.prototype.ya,zt.prototype.getStatus=zt.prototype.ca,zt.prototype.getResponseJson=zt.prototype.La,zt.prototype.getResponseText=zt.prototype.la,zt.prototype.send=zt.prototype.ea,zt.prototype.setWithCredentials=zt.prototype.Fa}).apply(typeof Nm<"u"?Nm:typeof self<"u"?self:typeof window<"u"?window:{});const _E="@firebase/firestore",CE="4.9.3";class Ns{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ns.UNAUTHENTICATED=new Ns(null),Ns.GOOGLE_CREDENTIALS=new Ns("google-credentials-uid"),Ns.FIRST_PARTY=new Ns("first-party-uid"),Ns.MOCK_USER=new Ns("mock-user");let O0="12.7.0";const Wu=new l4("@firebase/firestore");function va(t,...e){if(Wu.logLevel<=cr.DEBUG){const r=e.map(j4);Wu.debug(`Firestore (${O0}): ${t}`,...r)}}function fP(t,...e){if(Wu.logLevel<=cr.ERROR){const r=e.map(j4);Wu.error(`Firestore (${O0}): ${t}`,...r)}}function tY(t,...e){if(Wu.logLevel<=cr.WARN){const r=e.map(j4);Wu.warn(`Firestore (${O0}): ${t}`,...r)}}function j4(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function Kf(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,pP(t,n,r)}function pP(t,e,r){let n=`FIRESTORE (${O0}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw fP(n),new Error(n)}function Pf(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||pP(e,i,n)}const tr={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class rr extends io{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class If{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class mP{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rY{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Ns.UNAUTHENTICATED)))}shutdown(){}}class nY{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class sY{constructor(e){this.t=e,this.currentUser=Ns.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Pf(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let a=new If;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new If,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},d=u=>{va("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((u=>d(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?d(u):(va("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new If)}}),0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(va("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Pf(typeof n.accessToken=="string",31837,{l:n}),new mP(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pf(e===null||typeof e=="string",2055,{h:e}),new Ns(e)}}class iY{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Ns.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class aY{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new iY(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Ns.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class EE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oY{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Pf(this.o===void 0,3512);const n=a=>{a.error!=null&&va("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,va("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>n(a)))};const i=a=>{va("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):va("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new EE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Pf(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new EE(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function lY(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class cY{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=lY(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function pc(t,e){return t<e?-1:t>e?1:0}function dY(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return b1(i)===b1(a)?pc(i,a):b1(i)?1:-1}return pc(t.length,e.length)}const uY=55296,hY=57343;function b1(t){const e=t.charCodeAt(0);return e>=uY&&e<=hY}const AE="__name__";class Fa{constructor(e,r,n){r===void 0?r=0:r>e.length&&Kf(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Kf(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Fa.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Fa?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=Fa.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return pc(e.length,r.length)}static compareSegments(e,r){const n=Fa.isNumericId(e),i=Fa.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Fa.extractNumericId(e).compare(Fa.extractNumericId(r)):dY(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return w4.fromString(e.substring(4,e.length-2))}}class ha extends Fa{construct(e,r,n){return new ha(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new rr(tr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((i=>i.length>0)))}return new ha(r)}static emptyPath(){return new ha([])}}const fY=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yc extends Fa{construct(e,r,n){return new Yc(e,r,n)}static isValidIdentifier(e){return fY.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yc.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===AE}static keyField(){return new Yc([AE])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new rr(tr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;i<e.length;){const d=e[i];if(d==="\\"){if(i+1===e.length)throw new rr(tr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new rr(tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else d==="`"?(l=!l,i++):d!=="."||l?(n+=d,i++):(a(),i++)}if(a(),l)throw new rr(tr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Yc(r)}static emptyPath(){return new Yc([])}}class Jc{constructor(e){this.path=e}static fromPath(e){return new Jc(ha.fromString(e))}static fromName(e){return new Jc(ha.fromString(e).popFirst(5))}static empty(){return new Jc(ha.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ha.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ha.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Jc(new ha(e.slice()))}}function pY(t,e,r,n){if(e===!0&&n===!0)throw new rr(tr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function mY(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function gY(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Kf(12329,{type:typeof t})}function xY(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new rr(tr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=gY(t);throw new rr(tr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function wn(t,e){const r={typeString:t};return e&&(r.value=e),r}function M0(t,e){if(!mY(t))throw new rr(tr.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(i&&typeof l!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new rr(tr.INVALID_ARGUMENT,r);return!0}const TE=-62135596800,OE=1e6;class Ha{static now(){return Ha.fromMillis(Date.now())}static fromDate(e){return Ha.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*OE);return new Ha(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new rr(tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new rr(tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<TE)throw new rr(tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rr(tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OE}_compareTo(e){return this.seconds===e.seconds?pc(this.nanoseconds,e.nanoseconds):pc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ha._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(M0(e,Ha._jsonSchema))return new Ha(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-TE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ha._jsonSchemaVersion="firestore/timestamp/1.0",Ha._jsonSchema={type:wn("string",Ha._jsonSchemaVersion),seconds:wn("number"),nanoseconds:wn("number")};function yY(t){return t.name==="IndexedDbTransactionError"}class bY extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class hd{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new bY("Invalid base64 string: "+a):a}})(e);return new hd(r)}static fromUint8Array(e){const r=(function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a})(e);return new hd(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hd.EMPTY_BYTE_STRING=new hd("");const pj="(default)";class Hg{constructor(e,r){this.projectId=e,this.database=r||pj}static empty(){return new Hg("","")}get isDefaultDatabase(){return this.database===pj}isEqual(e){return e instanceof Hg&&e.projectId===this.projectId&&e.database===this.database}}class vY{constructor(e,r=null,n=[],i=[],a=null,l="F",d=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function wY(t){return new vY(t)}var ME,er;(er=ME||(ME={}))[er.OK=0]="OK",er[er.CANCELLED=1]="CANCELLED",er[er.UNKNOWN=2]="UNKNOWN",er[er.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",er[er.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",er[er.NOT_FOUND=5]="NOT_FOUND",er[er.ALREADY_EXISTS=6]="ALREADY_EXISTS",er[er.PERMISSION_DENIED=7]="PERMISSION_DENIED",er[er.UNAUTHENTICATED=16]="UNAUTHENTICATED",er[er.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",er[er.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",er[er.ABORTED=10]="ABORTED",er[er.OUT_OF_RANGE=11]="OUT_OF_RANGE",er[er.UNIMPLEMENTED=12]="UNIMPLEMENTED",er[er.INTERNAL=13]="INTERNAL",er[er.UNAVAILABLE=14]="UNAVAILABLE",er[er.DATA_LOSS=15]="DATA_LOSS";new w4([4294967295,4294967295],0);const jY=41943040;const NY=1048576;function v1(){return typeof document<"u"?document:null}class kY{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&va("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}class N4{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new If,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const l=Date.now()+n,d=new N4(e,r,l,i,a);return d.start(n),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rr(tr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var LE,RE;(RE=LE||(LE={})).Ma="default",RE.Cache="cache";function SY(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const PE=new Map;const gP="firestore.googleapis.com",IE=!0;class DE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new rr(tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gP,this.ssl=IE}else this.host=e.host,this.ssl=e.ssl??IE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jY;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<NY)throw new rr(tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pY("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=SY(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new rr(tr.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new rr(tr.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new rr(tr.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xP{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new DE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rr(tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rr(tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new DE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new rY;switch(n.type){case"firstParty":return new aY(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new rr(tr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=PE.get(r);n&&(va("ComponentProvider","Removing Datastore"),PE.delete(r),n.terminate())})(this),Promise.resolve()}}function _Y(t,e,r,n={}){t=xY(t,xP);const i=oh(e),a=t._getSettings(),l={...a,emulatorOptions:t._getEmulatorOptions()},d=`${e}:${r}`;i&&(a4(`https://${d}`),o4("Firestore",!0)),a.host!==gP&&a.host!==d&&tY("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:d,ssl:i,emulatorOptions:n};if(!ld(u,l)&&(t._setSettings(u),n.mockUserToken)){let h,p;if(typeof n.mockUserToken=="string")h=n.mockUserToken,p=Ns.MOCK_USER;else{h=kR(n.mockUserToken,t._app?.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new rr(tr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ns(m)}t._authCredentials=new nY(new mP(h,p))}}class k4{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new k4(this.firestore,e,this._query)}}class Wa{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new S4(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wa(this.firestore,e,this._key)}toJSON(){return{type:Wa._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(M0(r,Wa._jsonSchema))return new Wa(e,n||null,new Jc(ha.fromString(r.referencePath)))}}Wa._jsonSchemaVersion="firestore/documentReference/1.0",Wa._jsonSchema={type:wn("string",Wa._jsonSchemaVersion),referencePath:wn("string")};class S4 extends k4{constructor(e,r,n){super(e,r,wY(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wa(this.firestore,null,new Jc(e))}withConverter(e){return new S4(this.firestore,e,this._path)}}const BE="AsyncQueue";class $E{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new kY(this,"async_queue_retry"),this._c=()=>{const n=v1();n&&va(BE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=v1();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=v1();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new If;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!yY(e))throw e;va(BE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,fP("INTERNAL UNHANDLED ERROR: ",UE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=N4.createAndSchedule(this,e,r,n,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Kf(47125,{Pc:UE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function UE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class CY extends xP{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new $E,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $E(e),this._firestoreClient=void 0,await e}}}function EY(t,e){const r=typeof t=="object"?t:d4(),n=typeof t=="string"?t:pj,i=Kx(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=wR("firestore");a&&_Y(i,...a)}return i}class Do{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Do(hd.fromBase64String(e))}catch(r){throw new rr(tr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Do(hd.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Do._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(M0(e,Do._jsonSchema))return Do.fromBase64String(e.bytes)}}Do._jsonSchemaVersion="firestore/bytes/1.0",Do._jsonSchema={type:wn("string",Do._jsonSchemaVersion),bytes:wn("string")};class yP{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new rr(tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class rd{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new rr(tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new rr(tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pc(this._lat,e._lat)||pc(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rd._jsonSchemaVersion}}static fromJSON(e){if(M0(e,rd._jsonSchema))return new rd(e.latitude,e.longitude)}}rd._jsonSchemaVersion="firestore/geoPoint/1.0",rd._jsonSchema={type:wn("string",rd._jsonSchemaVersion),latitude:wn("number"),longitude:wn("number")};class nd{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:nd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(M0(e,nd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new nd(e.vectorValues);throw new rr(tr.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}nd._jsonSchemaVersion="firestore/vectorValue/1.0",nd._jsonSchema={type:wn("string",nd._jsonSchemaVersion),vectorValues:wn("object")};const AY=new RegExp("[~\\*/\\[\\]]");function TY(t,e,r){if(e.search(AY)>=0)throw zE(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new yP(...e.split("."))._internalPath}catch{throw zE(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function zE(t,e,r,n,i){let a=`Function ${e}() called with invalid data`;a+=". ";let l="";return new rr(tr.INVALID_ARGUMENT,a+t+l)}class bP{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Wa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new OY(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(vP("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class OY extends bP{data(){return super.data()}}function vP(t,e){return typeof e=="string"?TY(t,e):e instanceof yP?e._internalPath:e._delegate._internalPath}class km{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Du extends bP{constructor(e,r,n,i,a,l){super(e,r,n,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new yg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(vP("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new rr(tr.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Du._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Du._jsonSchemaVersion="firestore/documentSnapshot/1.0",Du._jsonSchema={type:wn("string",Du._jsonSchemaVersion),bundleSource:wn("string","DocumentSnapshot"),bundleName:wn("string"),bundle:wn("string")};class yg extends Du{data(e={}){return super.data(e)}}class Df{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new km(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new yg(this._firestore,this._userDataWriter,n.key,n,new km(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new rr(tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((d=>{const u=new yg(i._firestore,i._userDataWriter,d.doc.key,d.doc,new km(i._snapshot.mutatedKeys.has(d.doc.key),i._snapshot.fromCache),i.query.converter);return d.doc,{type:"added",doc:u,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const u=new yg(i._firestore,i._userDataWriter,d.doc.key,d.doc,new km(i._snapshot.mutatedKeys.has(d.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return d.type!==0&&(h=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),p=l.indexOf(d.doc.key)),{type:MY(d.type),doc:u,oldIndex:h,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new rr(tr.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Df._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cY.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function MY(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Kf(61501,{type:t})}}Df._jsonSchemaVersion="firestore/querySnapshot/1.0",Df._jsonSchema={type:wn("string",Df._jsonSchemaVersion),bundleSource:wn("string","QuerySnapshot"),bundleName:wn("string"),bundle:wn("string")};(function(e,r=!0){(function(i){O0=i})(Ed),cd(new fc("firestore",((n,{instanceIdentifier:i,options:a})=>{const l=n.getProvider("app").getImmediate(),d=new CY(new sY(n.getProvider("auth-internal")),new oY(l,n.getProvider("app-check-internal")),(function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new rr(tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hg(h.options.projectId,p)})(l,i),l);return a={useFetchStreams:r,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Va(_E,CE,e),Va(_E,CE,"esm2020")})();const LY={apiKey:"AIzaSyAdqbFNjrB6y-8BrMEYYCT5ywiCgZVtMaE",authDomain:"mtglibrary-70b46.firebaseapp.com",projectId:"mtglibrary-70b46",storageBucket:"mtglibrary-70b46.firebasestorage.app",messagingSenderId:"602862103839",appId:"1:602862103839:web:23c64b7486c058c903d42a",measurementId:"G-EWELJJQ631"},_4=CR(LY),da=jK(_4);EY(_4);YK(_4);const RY="";async function PY(){const t={"Content-Type":"application/json"};if(da.currentUser){const r=await da.currentUser.getIdToken();t.Authorization=`Bearer ${r}`}else console.warn("[API] No currentUser found, sending request without auth.");const e=localStorage.getItem("mtg_forge_ref");return e&&(t["X-Referral-Code"]=e),t}let mj=null;const qE=t=>{mj=t};async function qt(t,e,r=null,n={}){let i=`${RY}${e}`;const a=new URL(i,window.location.origin);Object.keys(n).forEach(u=>{n[u]!==null&&n[u]!==void 0&&a.searchParams.append(u,n[u])});const l={method:t,headers:await PY()};r&&(l.body=JSON.stringify(r));const d=await fetch(a,l);if(!d.ok){let u=d.statusText,h=null,p=null;try{p=await d.json(),p.error&&(u=p.error),p.code&&(h=p.code)}catch{}d.status===403&&h==="LIMIT_REACHED"&&mj&&mj(`Subscription Limit Reached: ${u}`,"error",5e3);const m=new Error(`API Error (${d.status}): ${u}`);throw m.response={status:d.status,data:p},m.code=h,m}return d.status===204?null:d.json()}const Pe={get:(t,e)=>qt("GET",t,null,e),post:(t,e)=>qt("POST",t,e),put:(t,e)=>qt("PUT",t,e),delete:(t,e)=>qt("DELETE",t,e),batchAddToCollection:(t,e="merge")=>qt("POST","/api/collection/batch",{cards:t,mode:e}),getBugs:()=>qt("GET","/bugs").then(t=>t.content),updateUser:(t,e)=>qt("PUT",`/api/users/${t}`,e),getBinders:()=>qt("GET","/api/binders"),getBinderCards:t=>qt("GET",`/api/binders/${t}/cards`),createBinder:t=>qt("POST","/api/binders",t),updateBinder:(t,e)=>qt("PUT",`/api/binders/${t}`,e),deleteBinder:t=>qt("DELETE",`/api/binders/${t}`),getEpics:()=>qt("GET","/api/epics"),createEpic:t=>qt("POST","/api/epics",t),updateEpic:(t,e)=>qt("PUT",`/api/epics/${t}`,e),reorderEpics:t=>qt("PUT","/api/epics/reorder/batch",{order:t}),deleteEpic:t=>qt("DELETE",`/api/epics/${t}`),getTickets:t=>qt("GET","/api/tickets",null,t),getTicketReport:t=>qt("GET","/api/tickets/report",null,t),createTicket:t=>qt("POST","/api/tickets",t),updateTicket:(t,e)=>qt("PUT",`/api/tickets/${t}`,e),deleteTicket:t=>qt("DELETE",`/api/tickets/${t}`),voteTicket:t=>qt("POST",`/api/tickets/${t}/vote`),getAssignees:()=>qt("GET","/api/tickets/meta/assignees"),getTicketNotes:t=>qt("GET",`/api/tickets/${t}/notes`),addTicketNote:(t,e)=>qt("POST",`/api/tickets/${t}/notes`,{note:e}),updateUserPermissions:(t,e,r,n={})=>qt("PUT",`/api/users/${t}/permissions`,{permissions:e,isAdmin:r,...n}),getUsers:()=>qt("GET","/api/users"),getReleases:()=>qt("GET","/api/releases"),publishRelease:t=>qt("POST","/api/releases",t),getActiveAudit:()=>qt("GET","/api/audit/active"),startAudit:t=>qt("POST","/api/audit/start",t),getAuditItems:(t,e)=>qt("GET",`/api/audit/${t}/items`,null,e),updateAuditItem:(t,e,r,n=null)=>{const i={quantity:r};return n!==null&&(i.reviewed=n),qt("PUT",`/api/audit/${t}/item/${e}`,i)},swapFoilAuditItem:(t,e)=>qt("POST",`/api/audit/${t}/item/${e}/swap-foil`),cancelAudit:t=>qt("POST",`/api/audit/${t}/cancel`),finalizeAudit:t=>qt("POST",`/api/audit/${t}/finalize`),reviewAuditSection:(t,e)=>qt("POST",`/api/audit/${t}/section/review`,e)},wP=y.createContext(),Mt=()=>y.useContext(wP),IY=({children:t})=>{const[e,r]=y.useState(null),[n,i]=y.useState(null),[a,l]=y.useState(!0),d=async(T,A,I={})=>{const O=await iV(da,T,A);if(O.user,Object.keys(I).length>0)try{await w();const M=await Pe.get("/api/users/me");M?.id&&(await Pe.updateUser(M.id,I),await w())}catch(M){console.error("Failed to save profile data during signup",M)}return O},u=(T,A)=>aV(da,T,A),h=()=>{const T=new Io;return OV(da,T)},p=()=>(i(null),uV(da)),m=T=>sV(da,T),x=()=>{if(!da.currentUser)throw new Error("No user logged in");return oV(da.currentUser)},b=async T=>{if(n?.id||(console.warn("[AuthContext] Profile missing ID, attempting re-fetch before update..."),await w()),!n?.id)throw new Error(`User profile not ready. (User: ${e?.email}, Profile: ${!!n})`);try{await Pe.updateUser(n.id,T),await w()}catch(A){throw console.error("Failed to update profile fields:",A),A}},v=async T=>{if(console.log("[AuthContext] uploadProfilePicture called",{file:T.name,currentUser:!!e}),!e)throw console.error("[AuthContext] No user logged in"),new Error("No user logged in");if(!T.type.startsWith("image/"))throw console.error("[AuthContext] Invalid file type:",T.type),new Error("File must be an image.");if(T.size>10*1024*1024)throw console.error("[AuthContext] File too large:",T.size),new Error("File size must be under 10MB.");try{console.log("[AuthContext] Converting image to base64...");const A=new FileReader,O=await new Promise((M,E)=>{A.onload=()=>M(A.result),A.onerror=E,A.readAsDataURL(T)});if(console.log("[AuthContext] Image converted to base64, size:",O.length),console.log("[AuthContext] Saving to database..."),!n?.id)throw new Error("User profile not ready");return await Pe.updateUser(n.id,{photo_url:O}),console.log("[AuthContext] Saved to database"),await w(),console.log("[AuthContext] Profile refreshed"),O}catch(A){throw console.error("[AuthContext] Error uploading profile picture:",A),console.error("[AuthContext] Error code:",A.code),console.error("[AuthContext] Error message:",A.message),A}},w=async()=>{if(!da.currentUser){console.warn("[AuthContext] refreshUserProfile: No currentUser found in Firebase Auth");return}try{console.log("[AuthContext] Fetching user profile from /api/users/me...");const T=await Pe.get("/api/users/me");!T||!T.id?console.error("[AuthContext] Profile fetch returned invalid data:",T):console.log("[AuthContext] Profile loaded successfully:",T.username||T.email),i(T)}catch(T){console.error("[AuthContext] Failed to fetch user profile:",T.message)}};y.useEffect(()=>dV(da,async A=>{r(A),A?await w():i(null),l(!1)}),[]);const _={currentUser:e,user:e,userProfile:n,refreshUserProfile:w,updateSettings:async T=>{if(!n)return;const A={...n.settings||{},...T};console.log("[AuthContext] Updating settings:",A);try{await Pe.updateUser(n.id,{settings:A})&&i(O=>({...O,settings:A}))}catch(I){console.error("Failed to update settings:",I)}},signup:d,login:u,loginWithGoogle:h,logout:p,resetPassword:m,sendVerification:x,updateProfileFields:b,uploadProfilePicture:v};return s.jsx(wP.Provider,{value:_,children:!a&&t})};function DY(){const[t,e]=y.useState([]),[r,n]=y.useState(!1),[i,a]=y.useState(null),l=y.useCallback(async(u,h={})=>{const{set:p,cn:m,...x}=h,b=(u||"").trim();if(!(p||m||Object.keys(x).length>0)&&(!b||b.length<2)){e([]);return}n(!0),a(null);try{const w=await Pe.post("/api/cards/search",{query:b,set:p,cn:m,...x});e(w.data||[])}catch(w){console.error(w),a(w.message),e([])}finally{n(!1)}},[]),d=y.useCallback(async u=>{if(!u||u.trim().length<2)return[];try{return(await Pe.get("/api/cards/autocomplete",{q:u})).data||[]}catch(h){return console.error("[useScryfall] Autocomplete error:",h),[]}},[]);return{results:t,loading:r,error:i,searchCards:l,getSuggestions:d,setResults:e}}const jP=y.createContext();function _r(){return y.useContext(jP)}function BY({children:t}){const[e,r]=y.useState([]),n=y.useCallback((a,l="info",d=3e3)=>{const u=Date.now();r(h=>[...h,{id:u,message:a,type:l}]),d>0&&setTimeout(()=>{r(h=>h.filter(p=>p.id!==u))},d)},[]),i=y.useCallback(a=>{r(l=>l.filter(d=>d.id!==a))},[]);return s.jsxs(jP.Provider,{value:{addToast:n},children:[t,ln.createPortal(s.jsx("div",{className:"fixed bottom-4 right-4 z-[99999] flex flex-col gap-2 pointer-events-none",children:e.map(a=>s.jsx("div",{className:`
                                px-4 py-3 rounded-lg shadow-lg text-sm font-medium transition-all transform animate-fade-in-up pointer-events-auto cursor-pointer
                                ${a.type==="success"?"bg-green-600 text-white":""}
                                ${a.type==="error"?"bg-red-600 text-white":""}
                                ${a.type==="info"?"bg-gray-800 text-white border border-gray-700":""}
                                ${a.type==="warning"?"bg-yellow-500 text-black":""}
                            `,onClick:()=>i(a.id),children:a.message},a.id))}),document.body)]})}function Gs(t={}){const{wishlist:e,userId:r}=t,[n,i]=y.useState([]),[a,l]=y.useState(!0),[d,u]=y.useState(null),{currentUser:h}=Mt(),p=async()=>{if(h){l(!0);try{const b=new URLSearchParams;e!==void 0&&b.append("wishlist",e),r&&b.append("userId",r),b.append("ts",Date.now());const w=(await Pe.get(`/api/collection?${b.toString()}`)).map(k=>({...k.data,...k,deckId:k.deck_id,quantity:k.count,firestoreId:k.firestore_id,id:k.id,scryfall_id:k.scryfall_id}));i(w),u(null)}catch(b){console.error("Error fetching collection:",b),u(b)}finally{l(!1)}}};return y.useEffect(()=>{if(!h){i([]),l(!1);return}p()},[h,r,e]),{cards:n,loading:a,error:d,refresh:p,removeCard:async b=>{try{await Pe.delete(`/api/collection/${b}`),await p()}catch(v){throw console.error("Error removing card:",v),v}},updateCard:async(b,v)=>{try{await Pe.put(`/api/collection/${b}`,v),await p()}catch(w){throw console.error("Error updating card:",w),w}}}}function $Y(t,e){const[r,n]=y.useState(t);return y.useEffect(()=>{const i=setTimeout(()=>{n(t)},e);return()=>{clearTimeout(i)}},[t,e]),r}const Un={async addCardToCollection(t,e,r=1,n,i=!1,a=null){return Pe.post("/api/collection",{scryfall_id:e.id,name:e.name,set_code:e.set||e.set_code,collector_number:e.collector_number,finish:n||e.finish||"nonfoil",count:r,data:e,deck_id:null,is_wishlist:i,targetUserId:a})},async updateCard(t,e){return Pe.put(`/api/collection/${t}`,e)},async removeCard(t){return Pe.delete(`/api/collection/${t}`)},async importBatch(t,e,r="merge",n=null){return Pe.post("/api/collection/batch",{cards:e,mode:r,decks:n})},async batchRemoveCards(t){return Pe.delete("/api/collection/batch/delete",{cardIds:t})}},ts={fetchRelationships:async()=>Pe.get("/api/community/relationships"),sendRequest:async(t,e="pod")=>Pe.post("/api/community/relationships/request",{targetEmail:t,type:e}),respondToRequest:async(t,e)=>Pe.put(`/api/community/relationships/${t}`,{status:e}),deleteRelationship:async t=>Pe.delete(`/api/community/relationships/${t}`),fetchPermissions:async(t=null)=>Pe.get(`/api/community/permissions${t?`?deckId=${t}`:""}`),fetchIncomingPermissions:async()=>Pe.get("/api/community/permissions?direction=incoming"),grantPermission:async(t,e,r=null)=>Pe.post("/api/community/permissions",{granteeId:t,permissionLevel:e,deckId:r}),revokePermission:async t=>Pe.delete(`/api/community/permissions/${t}`),updateDeckPublicStatus:async(t,e,r)=>Pe.put(`/api/decks/${t}`,{isPublic:e,shareSlug:r})},NP=y.createContext();function L0(){return y.useContext(NP)}function UY({children:t}){const[e,r]=y.useState(null),[n,i]=y.useState(!1),a=y.useCallback(d=>{r(d),i(!0)},[]),l=y.useCallback(()=>{i(!1),setTimeout(()=>r(null),300)},[]);return s.jsx(NP.Provider,{value:{selectedCard:e,isOpen:n,openCardModal:a,closeCardModal:l},children:t})}const kP=({card:t,normalCount:e=0,foilCount:r=0,wishlistCount:n=0,onUpdateCount:i,onUpdateWishlistCount:a,ownerName:l,currentUser:d,showOwnerTag:u=!1})=>{const{openCardModal:h}=L0(),[p,m]=y.useState(!1),x=l||t.owner_username||(d&&(t.owner_id===d.id||t.user_id===d.id)?d.username||"ME":null),b=(M,E=0)=>{if(!M)return"https://placehold.co/250x350?text=No+Image";const R=M.data||M;return R.card_faces&&R.card_faces.length>1?R.card_faces[E]?.image_uris?.normal||M.image_uri||"https://placehold.co/250x350?text=No+Image":R.image_uris?.normal||M.image_uri||"https://placehold.co/250x350?text=No+Image"},v=t.data?.card_faces||t.card_faces,w=v?.length>1&&!!v[1].image_uris,k=b(t,0),_=w?b(t,1):null,T=M=>{M.stopPropagation(),h(t)},A=(M,E,R)=>{M.stopPropagation(),i&&i(t,E,R)},I=e+r>0,O=!I&&n>0;return t.finish==="foil"?t.prices?.usd_foil||t.prices?.usd:t.prices?.usd||t.prices?.usd_foil,s.jsxs("div",{className:`group relative flex bg-gray-900/60 backdrop-blur-md rounded-xl overflow-hidden shadow-2xl border transition-all duration-300 hover:shadow-[0_0_30px_rgba(79,70,229,0.15)] aspect-[3.2/3.5] perspective-1000 ${I?"border-indigo-500/30":"border-white/5 grayscale-[0.8] opacity-70 hover:grayscale-0 hover:opacity-100"}`,children:[s.jsxs("div",{className:"relative aspect-[2.5/3.5] h-full cursor-pointer overflow-hidden bg-gray-950 shrink-0",onClick:T,children:[s.jsxs("div",{className:`relative w-full h-full transition-all duration-700 transform-style-3d ${p?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 backface-hidden",children:[s.jsx("img",{src:k,alt:t.name,className:"w-full h-full object-cover",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-t from-indigo-500/20 to-transparent transition-opacity duration-500"})]}),w&&s.jsx("div",{className:"absolute inset-0 backface-hidden rotate-y-180",children:s.jsx("img",{src:_||k,alt:`${t.name} Back`,className:"w-full h-full object-cover"})})]}),w&&s.jsx("button",{onClick:M=>{M.stopPropagation(),m(!p)},className:"absolute top-2 left-2 p-2 bg-black/60 hover:bg-indigo-600 text-white rounded-full backdrop-blur-md transition-all z-30 shadow-lg border border-white/10",title:"Flip Card",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),O&&s.jsx("div",{className:`absolute top-2 ${w?"left-12":"left-2"} z-20 bg-orange-500 text-white p-1 rounded-md shadow-lg animate-pulse`,children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),u&&x&&I&&s.jsxs("div",{className:`absolute ${w||O?"top-16":"top-12"} left-2 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-30 backdrop-blur-md uppercase tracking-wider`,children:[" ",x]}),s.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:s.jsxs("div",{className:"bg-black/70 backdrop-blur-md px-2 py-1 rounded-lg border border-white/10 flex items-center justify-around text-[10px] font-mono",children:[s.jsxs("span",{className:"text-gray-400",children:["$",(parseFloat(t.prices?.usd)||0).toFixed(2)]}),s.jsx("div",{className:"h-2 w-[1px] bg-white/20"}),s.jsxs("span",{className:"text-yellow-400",children:["$",(parseFloat(t.prices?.usd_foil)||0).toFixed(2)," "]})]})})]}),s.jsxs("div",{className:"flex-1 bg-black/40 flex flex-col justify-between py-1 border-l border-white/5 relative",children:[s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-white/5 transition-colors group/sec",children:[s.jsx("button",{onClick:M=>A(M,"normal",1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-white tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:e}),s.jsx("span",{className:"text-[8px] font-black uppercase text-gray-600 tracking-[0.2em] -mt-1",children:"Normal"})]}),s.jsx("button",{onClick:M=>A(M,"normal",-1),className:"p-1.5 text-gray-500 hover:text-white transition-all transform hover:scale-125 disabled:opacity-0",disabled:e<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-indigo-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:M=>A(M,"foil",1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-indigo-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:r}),s.jsx("span",{className:"text-[8px] font-black uppercase text-indigo-600 tracking-[0.2em] -mt-1",children:"Foil"})]}),s.jsx("button",{onClick:M=>A(M,"foil",-1),className:"p-1.5 text-indigo-400/60 hover:text-indigo-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:r<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"h-[1px] bg-white/5 mx-2"}),s.jsxs("div",{className:"flex flex-col items-center flex-1 justify-center relative hover:bg-orange-500/5 transition-colors group/sec",children:[s.jsx("button",{onClick:M=>{M.stopPropagation(),a&&a(t,1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 15l7-7 7 7"})})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-lg font-black text-orange-400 tabular-nums drop-shadow-[0_2px_4px_rgba(0,0,0,1)]",children:n}),s.jsx("span",{className:"text-[8px] font-black uppercase text-orange-600 tracking-[0.2em] -mt-1",children:"Wish"})]}),s.jsx("button",{onClick:M=>{M.stopPropagation(),a&&a(t,-1)},className:"p-1.5 text-orange-400/60 hover:text-orange-300 transition-all transform hover:scale-125 disabled:opacity-0",disabled:n<=0,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M19 9l-7 7-7-7"})})})]})]})]})};function zY({title:t,titleId:e,...r},n){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?y.createElement("title",{id:e},t):null,y.createElement("path",{fillRule:"evenodd",d:"M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const qY=y.forwardRef(zY);function FY({title:t,titleId:e,...r},n){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?y.createElement("title",{id:e},t):null,y.createElement("path",{fillRule:"evenodd",d:"M3.792 2.938A49.069 49.069 0 0 1 12 2.25c2.797 0 5.54.236 8.209.688a1.857 1.857 0 0 1 1.541 1.836v1.044a3 3 0 0 1-.879 2.121l-6.182 6.182a1.5 1.5 0 0 0-.439 1.061v2.927a3 3 0 0 1-1.658 2.684l-1.757.878A.75.75 0 0 1 9.75 21v-5.818a1.5 1.5 0 0 0-.44-1.06L3.13 7.938a3 3 0 0 1-.879-2.121V4.774c0-.897.64-1.683 1.542-1.836Z",clipRule:"evenodd"}))}const SP=y.forwardRef(FY),HY=({value:t,onChange:e})=>{const[r,n]=y.useState(!1),i=y.useRef(null),a=[{label:"=",value:"="},{label:"",value:">="},{label:"",value:"<="}];y.useEffect(()=>{const d=u=>{i.current&&!i.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const l=a.find(d=>d.value===t)||a[0];return s.jsxs("div",{className:"relative",ref:i,children:[s.jsxs("button",{type:"button",onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-3 bg-gray-900/50 hover:bg-gray-800 text-indigo-400 font-bold rounded-l-xl border-r border-white/10 transition-colors min-w-[50px] justify-center",children:[l.label,s.jsx("svg",{className:`w-3 h-3 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&s.jsx("div",{className:"absolute top-full left-0 mt-1 w-20 bg-gray-900 border border-white/10 rounded-lg shadow-2xl z-[70] overflow-hidden backdrop-blur-xl",children:a.map(d=>s.jsx("button",{type:"button",onClick:()=>{e(d.value),n(!1)},className:`w-full px-4 py-2 text-left text-sm font-bold transition-colors ${t===d.value?"bg-indigo-600 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:d.label},d.value))})]})},C4=({isOpen:t,onClose:e,onAddCard:r,onOpenForgeLens:n})=>{const[i,a]=y.useState(""),[l,d]=y.useState(!1),[u,h]=y.useState(""),[p,m]=y.useState(""),[x,b]=y.useState(null),[v,w]=y.useState([]),[k,_]=y.useState(!1),[T,A]=y.useState([]),[I,O]=y.useState(!1),[M,E]=y.useState([]),[R,$]=y.useState("or"),[B,C]=y.useState(!1),[U,L]=y.useState(!1),[q,K]=y.useState([]),[W,V]=y.useState(""),[X,Z]=y.useState(""),[G,F]=y.useState({operator:"=",value:""}),[Y,ne]=y.useState({operator:"=",value:""}),[re,ue]=y.useState({operator:"=",value:""}),[Le,de]=y.useState(""),[ve,te]=y.useState(""),{results:ge,loading:ke,error:oe,searchCards:Ee,getSuggestions:Te}=DY(),{currentUser:Ye}=Mt(),{addToast:ze}=_r(),{cards:le,refresh:pe}=Gs({userId:x||void 0}),me=y.useRef(null),Ie=y.useRef(null),Fe=$Y(i,300);y.useEffect(()=>{Fe.length>=2&&l?qe(Fe):Fe.length<2&&A([])},[Fe]);const qe=async Re=>{const it=await Te(Re);A(it),O(it.length>0)};y.useEffect(()=>{t&&(async()=>{try{const jt=(await ts.fetchIncomingPermissions()).filter(yt=>["editor","admin","contributor"].includes(yt.permission_level)&&!yt.target_deck_id);w(jt)}catch(it){console.error("Failed to load writable collections",it)}})()},[t]);const Xe=y.useMemo(()=>{const Re=new Map;return le&&le.forEach(it=>{const jt=it.scryfall_id||it.id;Re.has(jt)||Re.set(jt,[]),Re.get(jt).push(it)}),Re},[le]);y.useEffect(()=>{t&&me.current&&me.current.focus()},[t]);const He=Re=>{Re&&Re.preventDefault(),O(!1);const it={set:u,cn:p,colors:M.length>0?M:void 0,colorLogic:R,colorIdentity:B,colorExcluded:U,rarity:q.length>0?q:void 0,type:W,text:X,flavor:Le,artist:ve,mv:G.value!==""?{operator:G.operator,value:Number(G.value)}:void 0,power:Y.value!==""?{operator:Y.operator,value:Number(Y.value)}:void 0,toughness:re.value!==""?{operator:re.operator,value:Number(re.value)}:void 0};Ee(i,it)},ut=()=>{a(""),h(""),m(""),E([]),L(!1),K([]),V(""),Z(""),F({operator:"=",value:""}),ne({operator:"=",value:""}),ue({operator:"=",value:""}),de(""),te("")},Tt=Re=>{E(it=>it.includes(Re)?it.filter(jt=>jt!==Re):[...it,Re])},Ut=Re=>{K(it=>it.includes(Re)?it.filter(jt=>jt!==Re):[...it,Re])},nt=async(Re,it,jt)=>{if(!Ye)return ze("Please log in","error");try{const yt=Re.id,Et=Xe.get(yt)||[],ot=it==="foil"?"foil":"nonfoil",ae=Et.find(Be=>Be.finish===ot&&!Be.deck_id&&!Be.is_wishlist);jt>0?ae?(await Un.updateCard(ae.id,{count:ae.count+1}),ze(`Added ${ot} ${Re.name}`,"success")):(await Un.addCardToCollection(Ye.uid,Re,1,ot,!1,x),ze(`Added new ${ot} ${Re.name}`,"success")):ae&&(ae.count>1?(await Un.updateCard(ae.id,{count:ae.count-1}),ze(`Removed ${ot} ${Re.name}`,"info")):(await Un.removeCard(ae.id),ze(`Removed last ${ot} ${Re.name}`,"info"))),pe()}catch(yt){console.error("Update failed",yt),ze("Failed to update collection","error")}},kt=async(Re,it)=>{if(!Ye)return ze("Please log in","error");try{const jt=Re.id,Et=(Xe.get(jt)||[]).find(ot=>ot.is_wishlist&&!ot.deck_id);it>0?Et?(await Un.updateCard(Et.id,{count:Et.count+1}),ze(`Increased ${Re.name} in wishlist`,"success")):(await Un.addCardToCollection(Ye.uid,Re,1,"nonfoil",!0,x),ze(`Added ${Re.name} to wishlist`,"success")):Et&&(Et.count>1?(await Un.updateCard(Et.id,{count:Et.count-1}),ze(`Decreased ${Re.name} in wishlist`,"info")):(await Un.removeCard(Et.id),ze(`Removed ${Re.name} from wishlist`,"info"))),pe()}catch(jt){console.error("Wishlist update failed",jt),ze("Failed to update wishlist","error")}};if(!t)return null;const mt={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"},C:{bg:"bg-gray-400",text:"text-gray-900",border:"border-gray-500",symbol:"https://svgs.scryfall.io/card-symbols/C.svg"}};return ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-fade-in group",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900/40 backdrop-blur-2xl border border-white/10 rounded-3xl shadow-2xl w-full max-w-7xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-white/5",children:[s.jsxs("div",{className:"px-6 py-5 border-b border-white/5 flex justify-between items-center bg-white/5 flex-shrink-0",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Card Library"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-500/10 text-indigo-300 uppercase tracking-wider border border-indigo-500/20 shadow-[0_0_10px_rgba(99,102,241,0.2)]",children:"Database"})]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[v.length>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-black/20 rounded-lg p-1 border border-white/5",children:[s.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-2",children:"Target:"}),s.jsxs("select",{value:x||"",onChange:Re=>b(Re.target.value||null),className:"bg-transparent text-xs text-white focus:outline-none font-bold cursor-pointer hover:text-indigo-300 transition-colors",children:[s.jsx("option",{value:"",className:"bg-gray-900",children:"My Collection"}),v.map(Re=>s.jsxs("option",{value:Re.owner_id,className:"bg-gray-900",children:[Re.owner_username,"'s Collection (",Re.permission_level,")"]},Re.owner_id))]})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-xl",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),n&&s.jsxs("div",{className:"relative overflow-hidden group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 via-purple-600/20 to-indigo-600/20 opacity-50 blur-xl group-hover:opacity-75 transition-opacity"}),s.jsxs("div",{className:"relative px-6 py-2 border-b border-white/5 flex items-center justify-between bg-white/5 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center text-indigo-300 shadow-[0_0_15px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-bold text-white",children:"Have the physical card?"}),s.jsx("span",{className:"hidden sm:inline-block h-1 w-1 rounded-full bg-gray-600"}),s.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider hidden sm:block",children:"Scan instantly with Forge Lens AI"})]})]}),s.jsxs("button",{onClick:n,className:"px-5 py-1.5 bg-indigo-500/20 hover:bg-indigo-500/30 hover:text-white text-indigo-300 border border-indigo-500/30 rounded-lg font-bold text-[10px] uppercase tracking-wider transition-all shadow-[0_0_20px_rgba(99,102,241,0.1)] hover:shadow-[0_0_20px_rgba(99,102,241,0.3)] flex items-center gap-2",children:[s.jsx("span",{children:"Launch Scanner"}),s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar bg-black/20",children:[s.jsx("div",{className:"p-6 space-y-4 relative z-[60]",children:s.jsxs("form",{onSubmit:He,className:"relative flex flex-col gap-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1 group",children:[s.jsx("input",{ref:me,type:"text",placeholder:"Search cards...",className:"w-full bg-white/5 text-white border border-white/10 rounded-xl py-4 px-6 pl-14 pr-12 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all placeholder-gray-500 backdrop-blur-sm",value:i,onChange:Re=>{a(Re.target.value),d(!0),O(!0)},onFocus:()=>i.length>=2&&O(!0)}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&s.jsx("button",{type:"button",onClick:()=>{a(""),A([]),me.current?.focus()},className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white p-1 rounded-full hover:bg-white/10 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),I&&T.length>0&&s.jsx("div",{ref:Ie,className:"absolute top-full left-0 right-0 mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl z-[100] py-2 max-h-60 overflow-y-auto custom-scrollbar",children:T.map((Re,it)=>s.jsx("button",{type:"button",onClick:()=>{a(Re),d(!1),O(!1),Ee(Re,{set:u,cn:p})},className:"w-full text-left px-6 py-3 hover:bg-white/5 text-gray-400 hover:text-white transition-colors border-b border-white/5 last:border-0",children:Re},it))})]}),s.jsxs("button",{type:"button",onClick:()=>_(!k),className:`px-6 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${k?"bg-indigo-600 text-white border-indigo-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(SP,{className:"w-5 h-5"}),"Advanced Search"]}),s.jsx("button",{type:"submit",disabled:ke,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-2xl text-lg font-bold transition-all disabled:opacity-50 min-w-[120px] shadow-lg shadow-indigo-500/20",children:ke?"...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${k?"max-h-[800px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 space-y-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Advanced Configuration"}),s.jsx("button",{onClick:ut,className:"text-orange-500 hover:text-orange-400 text-[10px] font-black uppercase tracking-widest hover:underline",children:"Reset Filters"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Colors"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex gap-2",children:Object.entries(mt).map(([Re,it])=>s.jsx("button",{type:"button",onClick:()=>Tt(Re),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${M.includes(Re)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:M.includes(Re)?"transparent":""},children:s.jsx("img",{src:it.symbol,alt:Re,className:`w-full h-full ${M.includes(Re)?"drop-shadow-md":"grayscale"}`})},Re))}),s.jsx("div",{className:"flex items-center gap-2 text-sm bg-gray-900 border border-white/10 rounded-lg p-1",children:["or","and"].map(Re=>s.jsx("button",{type:"button",onClick:()=>$(Re),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${R===Re?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:Re},Re))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Rarity"}),s.jsx("div",{className:"flex gap-3",children:["common","uncommon","rare","mythic"].map(Re=>s.jsx("button",{type:"button",onClick:()=>Ut(Re),className:`px-3 py-1.5 rounded-lg border text-xs font-bold uppercase transition-all ${q.includes(Re)?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-gray-900 border-white/10 text-gray-500 hover:text-gray-300"}`,children:Re.charAt(0)},Re))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Type"}),s.jsx("input",{type:"text",placeholder:"Creature, Artifact...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:W,onChange:Re=>V(Re.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Text"}),s.jsx("input",{type:"text",placeholder:"Rules text...",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:X,onChange:Re=>Z(Re.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Mana Value"}),s.jsxs("div",{className:"flex items-center bg-gray-900 border border-white/10 rounded-xl overflow-hidden",children:[s.jsx(HY,{value:G.operator,onChange:Re=>F({...G,operator:Re})}),s.jsx("input",{type:"number",className:"w-full bg-transparent p-2 text-sm outline-none",value:G.value,onChange:Re=>F({...G,value:Re.target.value})})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Set"}),s.jsx("input",{type:"text",placeholder:"ABC",maxLength:5,className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none uppercase",value:u,onChange:Re=>h(Re.target.value)})]}),s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider ml-1",children:"CN"}),s.jsx("input",{type:"text",placeholder:"#",className:"w-full bg-gray-900 border border-white/10 rounded-xl px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none",value:p,onChange:Re=>m(Re.target.value)})]})]})]})]})})]})}),s.jsxs("div",{className:"p-6",children:[oe&&s.jsx("div",{className:"flex items-center justify-center p-8 text-red-400 bg-red-500/10 rounded-2xl border border-red-500/20",children:s.jsx("p",{className:"font-bold",children:oe})}),!ke&&ge.length===0&&(i||k)&&!oe&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("p",{className:"text-lg font-bold",children:"No matches found"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:ge.map((Re,it)=>{const jt=Xe.get(Re.id)||[],yt=jt.filter(ae=>ae.finish==="nonfoil"&&!ae.deck_id&&!ae.is_wishlist).reduce((ae,Be)=>ae+(Be.count||1),0),Et=jt.filter(ae=>ae.finish==="foil"&&!ae.deck_id&&!ae.is_wishlist).reduce((ae,Be)=>ae+(Be.count||1),0),ot=jt.filter(ae=>ae.is_wishlist&&!ae.deck_id).reduce((ae,Be)=>ae+(Be.count||1),0);return s.jsx(kP,{card:Re,normalCount:yt,foilCount:Et,wishlistCount:ot,onUpdateCount:nt,onUpdateWishlistCount:kt},Re.id||it)})})]})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]}),document.body)},WY="gemini-2.5-flash-preview-09-2025",_s={generateDeckSuggestions:async(t,e)=>{const{deckName:r,commander:n,playerProfile:i,strategyGuide:a,helperPersona:l,targetRole:d,candidates:u,currentContext:h,neededCount:p,experienceLevel:m="Advanced"}=e,x=`https://generativelanguage.googleapis.com/v1beta/models/${WY}:generateContent?key=${t||""}`,b=l?.name||"The Oracle",v=l?.type||"AI",w=l?.personality||"Professional and helpful",k=`You are ${b}, a ${v}. 
        Your personality is: ${w}.

        VOICE GUIDELINES:
        - When writing the 'reason' for a card, strictly adhere to your personality.
        - Address the user as an equal (or however your personality dictates).
        - If you are snarky or high-minded, use that tone to explain why a card is mathematically or strategically superior to the "garbage" others play.

        YOUR CORE MISSION:
        - You specialize in "Psychographic Profiling"matching a deck's mechanical soul to a player's specific psychological needs.
        - Analyze the PLAYER PROFILE: ${i}
        - Analyze the STRATEGY GUIDE: ${a}
        - Select EXACTLY ${p} cards from the CANDIDATE LIST for the role of '${d}'.
        
        CRITICAL SELECTION CRITERIA:
        - SYNERGY OVER STAPLES: Prefer cards that enable the specific loops in the Strategy Guide.
        - PLAYER SATISFACTION: Align card mechanics with the player's desire for "inescapable defeat" or "meticulous engineering."`,A={contents:[{parts:[{text:`
            DECK: ${r}
            COMMANDER: ${n}
            
            [PLAYER PSYCHOGRAPHIC PROFILE]
            ${i}
            
            [GUIDING STRATEGY & ASSUMED ABILITIES]
            ${a}
            
            [CURRENT DECK CONTEXT]
            ${h?.length>0?h.join(", "):"No cards added yet."}
            
            [CATEGORY TO FILL]
            I need exactly ${p} cards for the '${d}' slot.
            
            [CANDIDATE POOL]
            ${u.map(E=>`ID: ${E.firestoreId} | Name: ${E.name} | Type: ${E.type_line}`).join(`
`)}
            
            OUTPUT REQUIREMENTS:
            Return a JSON object with 'suggestions'. 
            In the 'reason' field, speak as ${b} (${w}). Explain why the card is a perfect choice for the user's style, perhaps mocking the inadequacy of alternative cards.
        `}]}],systemInstruction:{parts:[{text:k}]},generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},rating:{type:"NUMBER"},reason:{type:"STRING",description:"Justification written in the voice of the custom helper persona."}},required:["firestoreId","rating","reason"]}}}}}};let I=0;const O=5,M=[1e3,2e3,4e3,8e3,16e3];for(;I<O;)try{const E=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!E.ok){const B=await E.json();throw new Error(B.error?.message||`HTTP error! status: ${E.status}`)}const $=(await E.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(!$)throw new Error("The Oracle returned an empty vision.");return JSON.parse($)}catch(E){if(I++,I===O)throw new Error(`The Oracle (${b}) is currently silent. Details: ${E.message}`);await new Promise(R=>setTimeout(R,M[I-1]))}},async sendMessage(t,e,r,n="",i=null){if(!t)throw new Error("API Key is missing. Please add it in Settings.");const a=i?.name||"MTG Forge",l=i?.personality?`Personality: ${i.personality}`:"Personality: Knowledgeable, friendly, and concise.",u=[{role:"user",parts:[{text:`
You are ${a}, an elite Magic: The Gathering AI assistant.
Your goal is to provide accurate, strategic, and engaging advice to players.

**Persona & Style:**
- ${l}
- Use emojis to add flair (e.g., , , , , , , ).
- Format responses using **Tailwind CSS** classes within HTML tags for a premium look.
- Do NOT use Markdown. Output raw HTML that can be injected directly into a <div>.

**Formatting Rules:**
- Use <p class="mb-2 text-gray-300"> for paragraphs.
- Use <strong class="text-indigo-400"> for key terms or card names.
- Use <ul class="list-disc pl-5 mb-2 space-y-1 text-gray-300"> for lists.
- Use <div class="bg-gray-700/50 p-3 rounded-lg border-l-4 border-indigo-500 mb-2"> for important notes or rules citations.
- Use <code class="bg-gray-900 px-1 py-0.5 rounded text-indigo-300 font-mono text-sm"> for mana costs (e.g., {1}{U}{B}) or keywords.

**Content Guidance:**
- If asked about rules, cite the Comprehensive Rules if possible.
- If asked about deck building, consider mana curve, synergy, and format staples.
- If asked about lore, be descriptive and immersive.

Context from User's Current View:
${n}
`.trim()}]},...e.map(m=>({role:m.role==="user"?"user":"model",parts:[{text:m.content}]})),{role:"user",parts:[{text:r}]}],h=["gemini-2.5-flash","gemini-2.0-flash","gemini-flash-latest","gemini-2.5-flash-lite","gemini-2.0-flash-lite","gemini-flash-lite-latest","gemini-exp-1206","gemini-pro-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-pro","gemini-1.5-pro-latest"];let p=null;for(const m of h)try{const x=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${m}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:u})});if(!x.ok){const w=await x.json();if(x.status===404||x.status===429){console.warn(`Model ${m} failed (${x.status}). Trying next...`),p=w;continue}throw new Error(w.error?.message||`Gemini API Error: ${x.statusText}`)}return(await x.json()).candidates?.[0]?.content?.parts?.[0]?.text||"I couldn't generate a response."}catch(x){console.warn(`Error with model ${m}:`,x),p=x}throw console.error("All Gemini models failed. Last error:",p),p||new Error("Failed to connect to any Gemini model.")},async spruceUpText(t,e,r="General"){const n=`
            You are an expert project manager and communications specialist.
            Please rewrite the following ${r} description to be more professional, clear, and structured.
            
            - Use **HTML** formatting (<b>, <ul>, <li>, <p>, <br>).
            - Keep it concise but detailed enough.
            - Correct any grammar or spelling mistakes.
            - If it's a bug report, ensure steps are clear.
            - If it's a feature request (Epic), ensure the value/goal is clear.
            - Do NOT wrap the output in markdown code blocks or quotes. Just return the raw HTML string.
            
            Original Text:
            "${e}"
        `;try{let a=(await this.sendMessage(t,[],n)).trim();return a.startsWith("```html")?a=a.replace("```html","").replace("```",""):a.startsWith("```")&&(a=a.replace("```","").replace("```","")),a.trim()}catch(i){throw console.error("AI Spruce Up Error:",i),new Error("Failed to spruce up text.")}},async getDeckStrategy(t,e,r=null,n=[],i=null){if(!t)throw new Error("API Key is missing.");const a=i?.name||"The Oracle",l=i?.personality?`Adopt the persona of ${a}: ${i.personality}`:"Act as a Magic: The Gathering expert.",d=n&&n.length>0,u=d?`Existing Deck List Analysis:
${n.map(m=>`- ${m.countInDeck||1}x ${m.name} (${m.type_line||"Unknown"})`).join(`
`)}

Total Lands: ${n.reduce((m,x)=>x.type_line?.toLowerCase().includes("land")?m+(x.countInDeck||1):m,0)}`:"This is a NEW deck build.";let h="";r&&(h=`
                User Playstyle Profile:
                - Archetypes: ${r.archetypes?.join(", ")||"N/A"}
                - Summary: ${r.summary||"N/A"}
                - Aggression: ${r.scores?.aggression||0}
                - Combo Affinity: ${r.scores?.comboAffinity||0}
                - Interaction: ${r.scores?.interaction||0}
                Tailor the deck's theme and card suggestions to align with this playstyle.
            `);const p=`
            ${l} I have chosen "${e}" as my Commander.
            
            ${u}
            
            ${d?"Analyze the PROVIDED deck list. Identify the specific game plan, key synergies between these cards, and how to pilot THIS build.":"Suggest a competitive yet fun deck strategy tailored to the following playstyle."}
            
            ${h}

            **Deck Composition Goals:**
            - Lands: 35-38
            - Mana Ramp: 10-12
            - Card Draw: 10
            - Targeted Removal: 8-10
            - Board Wipes: 2-4
            - Synergy / Strategy: 25-30

            **Mana Curve Goal (Bell Curve):**
            - 1-2 Mana: High volume for setup.
            - 3-4 Mana: Moderate volume for utility/threats.
            - 5+ Mana: Low volume for finishers.

            **Formatting Instructions:**
            - Use **HTML** for the 'strategy' field.
            - The 'theme' field should be a **short, punchy title** (e.g., "Elemental Mastery", "Shadow Infiltration").
            - The 'strategy' field should start with a **Theme Summary**: 2-3 sentences providing high-level context, styled with a distinct, prominent look.
            - Focus on a structured breakdown:
              1. **Welcome/Theme Summary**: A few sentences on why this commander and theme work.
              2. **Commander Context**: What are the assumed or key abilities that drive the build?
              3. **Early Game (Turns 1-3)**: Focus on setup, ramp, and disruption. Use a  emoji.
              4. **Mid Game (Turns 4-6)**: Focus on value engines and commander deployment. Use a  emoji.
              5. **Late Game (Turns 7+)**: Focus on finishers and storming off. Use a  emoji.
              6. **Key Synergies & Combos**: Highlight 3-4 specific card combinations. Use a  emoji.
            - Use **Tailwind CSS** classes (e.g., <span class="text-indigo-400 font-bold">Key Card</span>) to highlight important terms.
            - Use headers for each phase (e.g., <h4 class="text-indigo-400 font-black uppercase mb-2"> Early Game</h4>).
            5. **CRITICAL: Deck Composition Numbers**:
                - You MUST calculate specific counts for this specific commander strategies.
                - Do NOT use generic numbers (like 10/10/10). Tailor them! (e.g., A spellslinger deck might want 25 Instants and only 5 Creatures).
                - The 'functional' categories MUST sum to exactly **99** cards (assuming 1 commander).
                - The 'types' categories MUST sum to exactly **99** cards.
                - Ensure 'Lands' concept matches in both sections (e.g. if Functional Lands is 36, Type Lands should be 36).

            You MUST respond with VALID JSON strictly matching this format:
            {
                "layout": {
                    "functional": {
                        "Lands": 36, 
                        "Mana Ramp": 10,
                        "Card Draw": 10,
                        "Targeted Removal": 10,
                        "Board Wipes": 3,
                        "Synergy / Strategy": 30
                    },
                    "types": {
                        "Creatures": 30,
                        "Instants": 10,
                        "Sorceries": 10,
                        "Artifacts": 10,
                        "Enchantments": 5,
                        "Planeswalkers": 0,
                        "Lands": 34
                    }
                },
                "suggestedName": "...",
                "theme": "...",
                "strategy": "<div>...Structured HTML Content...</div>"
            }
            CRITICAL: 
            1. 'layout' is the MOST IMPORTANT field. It MUST be populated.
            2. 'functional' counts must sum to exactly 99.
            3. 'types' counts must sum to exactly 99. 
            4. Do NOT refer to yourself as "The Oracle" unless your name is explicitly "The Oracle". Use ONLY your assigned name: ${a}.
            Do NOT use markdown code blocks. Return only the JSON string.
        `;try{console.log("[GeminiService] sending prompt to Gemini...");const m=await this.sendMessage(t,[],p);console.log("[GeminiService] raw response length:",m?.length);const x=m.replace(/```json/g,"").replace(/```/g,"").trim(),b=JSON.parse(x);return console.log("[GeminiService] parsed strategy:",b),b}catch(m){throw console.error("AI Strategy Error:",m),new Error("Failed to generate strategy. Please try again.")}},async generatePlaystyleQuestion(t,e){if(!t)throw new Error("API Key is missing.");const r="You are an expert survey designer for Magic: The Gathering (MTG) players. Your goal is to create the most informative question to understand a user's playstyle based on their previous answers. Questions should be clear and concise, with 3-5 distinct multiple-choice answers. Avoid repeating questions. Focus on different aspects of MTG playstyles, such as deck preferences, game strategies, social interaction styles, and risk tolerance.";let n;e.length===0?n="Generate the very first question for an MTG playstyle questionnaire. This question should gauge the player's overall experience with the game, as this will help tailor subsequent questions.":e.length===1?n="Generate the second question for an MTG playstyle questionnaire. This question should build on the player's overall experience and delve into their specific preferences.":e.length===2?n="Generate the third question for an MTG playstyle questionnaire. This question should explore the player's fantasy or thematic preferences in deck building.":n=`Based on the user's previous answers, generate the next single best question to further refine their playstyle profile. Do not repeat questions.

Previous Answers:
${e.map(l=>`- ${l.question}: ${l.answer}`).join(`
`)}`;const i=`${r}

${n}

Respond with VALID JSON ONLY:
{ "question": "...", "choices": ["...", "..."] }`;try{const l=(await this.sendMessage(t,[],i)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(l)}catch(a){throw console.error("Gemini Question Error:",a),a}},async synthesizePlaystyle(t,e){if(!t)throw new Error("API Key is missing.");const r="You are an expert MTG coach and psychographic analyst. Your task is to analyze a player's answers and synthesize a detailed playstyle profile. The summary should be a concise paragraph. Scores must be 0-100.",n=`Analyze the following questionnaire answers and generate a detailed playstyle profile in JSON format.

${e.map(a=>`- ${a.question} -> ${a.answer}`).join(`
`)}`,i=`${r}

${n}

Respond with VALID JSON ONLY matching this schema:
        {
            "summary": "...",
            "tags": ["tag1", "tag2"],
            "scores": { "aggression": 50, "consistency": 50, "interaction": 50, "variance": 50, "comboAffinity": 50 },
            "archetypes": ["archetype1", "archetype2"]
        }`;try{const l=(await this.sendMessage(t,[],i)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(l)}catch(a){throw console.error("Gemini Synthesis Error:",a),new Error("Failed to synthesize profile.")}},async refinePlaystyleChat(t,e,r,n=null){if(!t)throw new Error("API Key is missing.");const i=n?.name||"The Oracle",a=n?.personality?`Personality: ${n.personality}`:"Personality: Wise, insightful, slightly magical.",l=e.length===0,d=`
            You are ${i}, an expert MTG coach conducting a "Deep Dive" interview to build a player's psychographic profile.
            ${a}

            Current Profile Summary: ${r?.summary||"New Profile"}
            Current Tags: ${r?.tags?.join(", ")||"None"}

            Instructions:
            ${l?`1. Introduce yourself as ${i}.
                   2. Explain that you want to understand their playstyle to help build better decks.
                   3. Ask the FIRST open-ended question to start the profile (e.g. "What draws you to magic?").`:`1. Analyze the user's latest input.
                   2. Formulate a conversational response (warm, insightful, matching your persona).
                   3. Ask ONE follow-up question to dig deeper into a missing or vague area.
                   4. Simultaneously, UPDATE the JSON profile based on the new information (merging with known info).`}
        `,u=e.slice(-6),h=[{role:"user",parts:[{text:d}]},...u.map(b=>({role:b.role==="user"?"user":"model",parts:[{text:b.content}]}))],p=`
            ${l?"Generate the initial greeting and first question.":"Based on the conversation, respond to the user and update the profile."}
            RETURN JSON ONLY.
        `;h.push({role:"user",parts:[{text:p}]});const m=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let x=[];for(const b of m){try{const v=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:h,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedProfile:{type:"OBJECT",properties:{summary:{type:"STRING"},tags:{type:"ARRAY",items:{type:"STRING"}},scores:{type:"OBJECT",properties:{aggression:{type:"NUMBER"},consistency:{type:"NUMBER"},interaction:{type:"NUMBER"},comboAffinity:{type:"NUMBER"}}},archetypes:{type:"ARRAY",items:{type:"STRING"}}},required:["summary","tags","scores","archetypes"]}},required:["aiResponse","updatedProfile"]}}})});if(v.ok){const k=(await v.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(k)return JSON.parse(k)}else{const w=await v.json();if(x.push(`${b} (Schema): ${v.status} ${w.error?.message||""}`),v.status===404||v.status===429)continue}}catch(v){x.push(`${b} (Schema Error): ${v.message}`)}try{const v=JSON.parse(JSON.stringify(h));v[v.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedProfile: object }`;const w=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:v})});if(w.ok){const _=(await w.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(_){const T=_.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(T)}}else{const k=await w.json();x.push(`${b} (Raw): ${w.status} ${k.error?.message||""}`)}}catch(v){x.push(`${b} (Raw Error): ${v.message}`)}}throw console.error("Gemini Chat Refine Exhausted:",x),new Error(`Oracle Exhausted: ${x[0]||"Unknown error"}`)},async forgeHelperChat(t,e,r){if(!t)throw new Error("API Key is missing.");const n=`
            You are an expert fantasy writer and character designer allowing a user to "Forge" their own AI companion for Magic: The Gathering.
            Your goal is to interview the user to define their Helper's Persona.
            
            Current Draft:
            - Name: ${r?.name||"Unknown"}
            - Type: ${r?.type||"Unknown"} (e.g., Spirit, Goblin, Construct, Wizard)
            - Personality: ${r?.personality||"Unknown"} (e.g., Snarky, Wise, Aggressive)

            Instructions:
            1. Analyze the user's input.
            2. If they provided new info (name, type, personality), UPDATE the JSON draft locally.
            3. Respond in a neutral, helpful "System" tone (like a character creation menu guide).
            4. Ask for the missing fields one by one.
            5. If all fields are present, ask for confirmation.
        `,i=e.slice(-6),a=[{role:"user",parts:[{text:n}]},...i.map(h=>({role:h.role==="user"?"user":"model",parts:[{text:h.content}]}))];a.push({role:"user",parts:[{text:`
            Based on the conversation, respond to the user and update the helper draft.
            RETURN JSON ONLY.
        `}]});const d=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash-latest","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-pro-latest"];let u=[];for(const h of d){try{const p=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${h}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:a,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{aiResponse:{type:"STRING"},updatedDraft:{type:"OBJECT",properties:{name:{type:"STRING"},type:{type:"STRING"},personality:{type:"STRING"}},required:["name","type","personality"]}},required:["aiResponse","updatedDraft"]}}})});if(p.ok){const x=(await p.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(x)return JSON.parse(x)}else{const m=await p.json();if(u.push(`${h}: ${p.status}`),p.status===404||p.status===429)continue}}catch(p){u.push(`${h}: ${p.message}`)}try{const p=JSON.parse(JSON.stringify(a));p[p.length-1].parts[0].text+=`

CRITICAL: Respond with VALID JSON only. No markdown. Format: { aiResponse: string, updatedDraft: object }`;const m=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${h}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:p})});if(m.ok){const b=(await m.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(b){const v=b.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(v)}}}catch{}}throw new Error(`Forge Exhausted: ${u.join(" | ")}`)},async generateDeckSuggestions(t,e,r=null){if(!t)throw new Error("API Key is missing.");const{playstyle:n,targetRole:i,deckRequirements:a}=e,l=r?.name||"Expert MTG Deck Builder",d=r?.personality?`Adopt the persona of ${l}: ${r.personality}`:"";let u="";n&&(u=`
                User Playstyle: ${n.archetypes?.join(", ")||"N/A"}. 
                Summary: ${n.summary||"N/A"}.
            `);const h=`
            You are ${l}. ${d}
            Analyze the provided candidates to build a well-balanced deck.
            ${u}
            
            **Mana Curve Priorities (Bell Curve):**
            Focus on CMC 1-2 for high volume, 3-4 for moderate, 5+ for finishers.

            **Multi-Role Fulfillment:**
            You will be given a list of "Requirements" (Target Counts per Role).
            Select the best cards from the candidates to fill these specific roles.
            Ensure you meet the target counts for each role as best as possible.
            Assign a specific "role" string to each suggestion matching the Requirement key.
        `,p=["gemini-2.0-flash","gemini-flash-latest","gemini-1.5-flash","gemini-1.5-flash-latest","gemini-1.5-flash-001","gemini-1.5-flash-002","gemini-1.5-pro","gemini-1.5-pro-latest"],m={role:"system",parts:[{text:h}]},x=[{role:"user",parts:[{text:`Task: ${e.instructions}

Requirements: ${JSON.stringify(a||{})}

Candidates: ${JSON.stringify(e.candidates)}

IMPORTANT: You MUST respond with a VALID JSON object containing a "suggestions" array. Each suggestion needs "rating" (1-10), "reason", and "role".`}]}];let b=[];for(const v of p){try{const w=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${v}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:m,contents:x,generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{suggestions:{type:"ARRAY",items:{type:"OBJECT",properties:{firestoreId:{type:"STRING"},name:{type:"STRING"},count:{type:"NUMBER"},rating:{type:"NUMBER"},reason:{type:"STRING"},role:{type:"STRING"},isBasicLand:{type:"BOOLEAN"}},required:["rating","reason","role"]}}},required:["suggestions"]}}})});if(w.ok){const _=(await w.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(_)return JSON.parse(_)}else{const k=await w.json();if(b.push(`${v} (Schema): ${w.status} ${k.error?.message||""}`),w.status===404||w.status===429)continue}}catch(w){b.push(`${v} (Schema Error): ${w.message}`)}try{const w=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${v}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:m,contents:[{role:"user",parts:[{text:`${x[0].parts[0].text}

You MUST respond with VALID RAW JSON format ONLY. Do not use markdown blocks.`}]}]})});if(w.ok){const _=(await w.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(_){const T=_.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(T)}}else{const k=await w.json();b.push(`${v} (Raw): ${w.status} ${k.error?.message||""}`)}}catch(w){b.push(`${v} (Raw Error): ${w.message}`)}}throw console.error("[Gemini] All models failed. Summary:",b),new Error(`Oracle Exhausted: ${b.join(" | ")}`)},async analyzeDeck(t,e,r,n=null){if(!t)throw new Error("API Key is missing.");const i=n?.name||"The Deck Doctor",a=n?.personality?`Adopt the persona of ${i}: ${n.personality}`:"Personality: Clinical, precise, but encouraging.",l=e.map(m=>`- ${m.countInDeck||1}x ${m.name} (${m.type_line})`).join(`
`)+`

Total Lands: ${e.reduce((m,x)=>x.type_line?.toLowerCase().includes("land")?m+(x.countInDeck||1):m,0)}`,d=`
            You are ${i}, an expert Magic: The Gathering deck consultant.
            ${a}
            Your goal is to Grade a deck on a scale of 0-100 and identify critical flaws.
        `,u=`
            Analyze this Commander deck for "${r}":
            
            ${l}

            **Rubric:**
            - **Synergy**: Do cards support the commander?
            - **Speed**: Is there enough ramp? Is the curve too high?
            - **Interaction**: Is there enough removal/protection?
            - **Consistency**: Is there enough card draw/tutors?

            **Task:**
            1. Calculate a Score (0-100).
            2. Rate Synergy, Speed, Interaction (0-100).
            3. List 3-5 critical "Issues" (strings).
            4. Propose up to 5 specific "Changes". For each change:
                - "remove": Exact card name to cut.
                - "add": Exact card name to add.
                - "reason": Why?

            **Response Format (VALID JSON ONLY):**
            {
                "score": 85,
                "metrics": { "synergy": 80, "speed": 70, "interaction": 60 },
                "issues": ["Not enough lands (32)", "Lack of board wipes"],
                "changes": [
                    { "remove": "Bad Card", "add": "Good Card", "reason": "Strict upgrade for mana cost." }
                ]
            }
        `,h=[{role:"user",parts:[{text:d}]},{role:"user",parts:[{text:u}]}],p=["gemini-2.0-flash","gemini-2.5-flash","gemini-flash-latest","gemini-1.5-flash"];for(const m of p)try{const x=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${m}:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:h,generationConfig:{responseMimeType:"application/json"}})});if(x.ok){const v=(await x.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(v)return JSON.parse(v)}}catch(x){console.warn(`Deck Doctor (${m}) failed:`,x)}throw new Error("Deck Doctor failed to diagnose.")},async generateReleaseNotes(t,e){if(!t)throw new Error("API Key is missing.");if(!e||e.length===0)throw new Error("No tickets provided for release notes.");const n=`
            You are a professional software release manager and technical writer for "MTG-Forge". 
            Generate a Development Update in HTML using Tailwind CSS. 
            Strictly follow the structure and styling below.

            **TICKETS DATA:**
            ${e.map(i=>{const a=i.type==="bug"&&i.created_by_username?` [Submitted by: ${i.created_by_username}]`:"";return`- [${i.type.toUpperCase()}] [Status: ${i.status}] ${i.title}${i.epic_title?` (Project: ${i.epic_title})`:""}${a}: ${i.description?.replace(/<[^>]*>?/gm,"").substring(0,200)}...`}).join(`
`)}

            **STRICT LAYOUT RULES:**
            1. **Title**: A large, bold title like "MTG-Forge Development Update! ".
            2. **Intro**: A warm greeting for "Planeswalkers" with a globe emoji .
            3. **Sections**: Group items into:
               - " New Features" (Completed features)
               - " Bug Fixes" (Completed bugs)
               - " In Progress" (Everything else)
            4. **Section Cards**: Each section should have ONE large card containing its list of items.
               - Card Style: <div class="bg-gray-800/40 border-l-4 p-4 rounded-lg mb-6 ...">
               - Border Colors: green-500 for Features, red-500 for Bugs, gray-500 for In Progress.
            5. **Feature/Bug items**: Use <strong> for titles. For bugs, include a subtle "@username" shoutout for the report.
            6. **Highlights**: Use <span class="text-indigo-400 font-bold"> for important keywords or project names.
            7. **Sign-off**: A final warm closing message to Planeswalkers, ending with "see you in the next patch! ".

            **TECHNICAL CONSTRAINTS:**
            - Use only Tailwind CSS classes.
            - Do NOT use markdown code blocks (\`\`\`html).
            - Output ONLY the clean HTML string.
        `;try{let a=(await this.sendMessage(t,[],n)).trim();return a.startsWith("```html")?a=a.replace("```html","").replace("```",""):a.startsWith("```")&&(a=a.replace("```","").replace("```","")),a.trim()}catch(i){throw console.error("AI Release Notes Error:",i),new Error("Failed to generate release notes.")}},gradeDeck:async(t,e)=>{const{deckName:r,commander:n,cards:i,playerProfile:a,strategyGuide:l,helperPersona:d}=e;d?.name;const m={contents:[{parts:[{text:`
            Analyze this deck: "${r}"
            Commander: ${n}
            
            [DECK LIST]
            ${i.map(v=>`${v.countInDeck||1}x ${v.name} (${v.type_line})`).join(`
`)}
            
            Return JSON only.
        `}]}],systemInstruction:{parts:[{text:`You are a Magic: The Gathering usage analytics engine and professional deck consultant.
        Your task is to classify a Commander deck into the "Commander Brackets" (1-5), calculate a precise "Power Level" (1.0 - 10.0), and provide deep surgical analysis.
        
        DEFINITIONS:
        - **Bracket 1 (Exhibition)**: Ultra-casual. No Mass Land Denial (MLD), no extra turns, no 2-card infinite combos, few tutors. "Few game changers."
        - **Bracket 2 (Core)**: Average current preconstructed deck. No MLD, no chaining extra turns, no 2-card infinite combos, few tutors.
        - **Bracket 3 (Upgraded)**: Beyond the strength of an average precon. Late game 2-card infinite combos allowed, up to 3 "game changers".
        - **Bracket 4 (Optimized)**: High power commander. No restrictions (other than the banned list). Highly efficient.
        - **Bracket 5 (cEDH)**: Maximum power, very competitive and metagame focused mindset. No restrictions.

        METRICS:
        - **Efficiency** (0-10): Speed of mana curve and ramp.
        - **Interaction** (0-10): Count and efficiency of removal/protection.
        - **Win_Turn** (Attempted Win Turn): Average turn the deck threatens a win.
        
        DIAGNOSTICS:
        - Provide a "Critique" (The overall state of the deck).
        - Provide "Mechanical Improvements" (General strategic advice).
        - Provide "Recommended Swaps" (Specific card-for-card replacements from the meta).
        
        OUTPUT: Return a JSON object with the calculated metrics and diagnostics.`}]},generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{powerLevel:{type:"NUMBER",description:"Precise Power Level float (1.0 to 10.0). e.g. 6.13"},commanderBracket:{type:"INTEGER",description:"Bracket ID: 1, 2, 3, 4, or 5"},metrics:{type:"OBJECT",properties:{efficiency:{type:"NUMBER",description:"0-10 score"},interaction:{type:"NUMBER",description:"0-10 score"},winTurn:{type:"NUMBER",description:"Estimated average win turn"}}},bracketJustification:{type:"STRING",description:"Short explanation of why it falls in this bracket."},critique:{type:"STRING",description:"Deep analysis of the deck's current state."},mechanicalImprovements:{type:"ARRAY",items:{type:"STRING"},description:"List of general strategic improvements."},recommendedSwaps:{type:"ARRAY",items:{type:"OBJECT",properties:{remove:{type:"STRING",description:"Card to remove"},add:{type:"STRING",description:"Card to add"},reason:{type:"STRING",description:"Why this swap is better"}},required:["remove","add","reason"]}},pros:{type:"ARRAY",items:{type:"STRING"}},cons:{type:"ARRAY",items:{type:"STRING"}}},required:["powerLevel","commanderBracket","metrics","bracketJustification","critique","mechanicalImprovements","recommendedSwaps"]}}};let x=0,b="gemini-3-flash-preview";for(;x<4;)try{const v=`https://generativelanguage.googleapis.com/v1beta/models/${b}:generateContent?key=${t||""}`,w=await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(w.status===429){if(console.warn(`Deck Doctor: Rate Limited (429) on ${b}. Switching to backup...`),b==="gemini-3-flash-preview")b="gemini-2.0-flash-exp";else if(b==="gemini-2.0-flash-exp")b="gemini-1.5-flash";else throw new Error("All models exhausted");await new Promise(T=>setTimeout(T,1e3));continue}if(!w.ok)throw new Error(`API Error: ${w.status}`);const _=(await w.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(_)return JSON.parse(_);throw new Error("Empty response from AI")}catch(v){console.warn(`Deck Grade Attempt ${x+1} failed:`,v),x++,await new Promise(w=>setTimeout(w,1e3*x))}throw new Error("Failed to Grade Deck. The Oracle is currently overwhelmed.")}},Sm=10,_P=({isOpen:t,onClose:e,onComplete:r})=>{const{userProfile:n}=Mt(),[i,a]=y.useState("selection"),[l,d]=y.useState("intro"),[u,h]=y.useState([]),[p,m]=y.useState([]),[x,b]=y.useState(null),[v,w]=y.useState(null),[k,_]=y.useState([]),[T,A]=y.useState(null),[I,O]=y.useState(""),M=y.useRef(null),[E,R]=y.useState(!1),[$,B]=y.useState(null),C=n?.settings?.helper?.name||"The Oracle";y.useEffect(()=>{t&&U()},[t]),y.useEffect(()=>{M.current?.scrollIntoView({behavior:"smooth"})},[k]);const U=()=>{a("selection"),d("intro"),m([]),_([]),A(null),B(null),w(null),O("")},L=()=>{a("quick"),d("loading"),q([])},q=async F=>{d("loading"),R(!0),B(null),w(null);try{const Y=n?.settings?.geminiApiKey;if(!Y)throw new Error("Gemini API Key is missing.");const ne=await _s.generatePlaystyleQuestion(Y,F);b(ne),d("question")}catch(Y){console.error("Quick Wizard Error:",Y),B(Y.message||"Failed to summon the oracle."),a("error")}finally{R(!1)}},K=async F=>{w(F),await new Promise(re=>setTimeout(re,600));const Y={question:x.question,answer:F},ne=[...p,Y];m(ne),ne.length>=Sm?W(ne):q(ne)},W=async F=>{a("synthesis");try{const Y=n?.settings?.geminiApiKey,ne=await _s.synthesizePlaystyle(Y,F);r&&await r(ne),e()}catch{B("Failed to synthesize your profile."),a("error")}},V=async()=>{a("advanced"),d("chat"),R(!0),A({summary:"Pending analysis...",tags:[],scores:{}});try{const F=n?.settings?.geminiApiKey;if(!F)throw new Error("API Key missing.");const Y=await _s.refinePlaystyleChat(F,[],T,n.settings.helper);_([{role:"model",content:Y.aiResponse}])}catch(F){console.error("Intro Error:",F),_([{role:"model",content:`Greetings. I am ${C}. Let us begin our analysis.`}])}finally{R(!1)}},X=async()=>{if(!I.trim())return;const F={role:"user",content:I},Y=[...k,F];_(Y),O(""),R(!0);try{const ne=n?.settings?.geminiApiKey;if(!ne)throw new Error("API Key missing.");const re=await _s.refinePlaystyleChat(ne,Y,T,n.settings.helper);A(re.updatedProfile),_(ue=>[...ue,{role:"model",content:re.aiResponse}])}catch(ne){console.error("Chat Error:",ne),_(re=>[...re,{role:"model",content:"My connection to the leyline flickered. Please repeat that."}])}finally{R(!1)}},Z=async()=>{a("synthesis"),T&&r&&await r(T),e()},G=F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),X())};return t?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl h-[85vh] bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-20 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i==="selection"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 space-y-12 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl",children:"How shall we determine your magical signature?"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl",children:[s.jsxs("button",{onClick:L,className:"group relative bg-gray-800/50 hover:bg-indigo-900/20 border border-gray-700 hover:border-indigo-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13 2L3 14h9v8l10-12h-9l9-8z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:"Quick Setup"}),s.jsxs("p",{className:"text-gray-400 group-hover:text-gray-300",children:["Answer ",Sm," rapid-fire questions to generate a baseline profile. Best for getting started quickly."]}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-indigo-400 uppercase tracking-wider",children:["Start Assessment ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]}),s.jsxs("button",{onClick:V,className:"group relative bg-gray-800/50 hover:bg-purple-900/20 border border-gray-700 hover:border-purple-500 rounded-2xl p-8 text-left transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-32 h-32 text-purple-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-purple-300 transition-colors",children:"Deep Dive"}),s.jsx("p",{className:"text-gray-400 group-hover:text-gray-300",children:"Have a conversation with the Oracle. Iterate on your preferences in real-time for a highly tailored profile."}),s.jsxs("div",{className:"pt-4 flex items-center text-sm font-bold text-purple-400 uppercase tracking-wider",children:["Enter The Sanctum ",s.jsx("span",{className:"ml-2 group-hover:ml-3 transition-all",children:""})]})]})]})]}),s.jsx("div",{className:"text-gray-500 text-sm",children:"You can always retake this assessment later from your profile settings."})]}),i==="quick"&&s.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gray-900",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-8 bg-gray-900/50",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500 mr-3"}),"Quick Assessment"]}),s.jsxs("div",{className:"text-sm font-mono text-indigo-400",children:["Q",p.length+1," / ",Sm]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-8 flex flex-col items-center justify-center",children:l==="loading"?s.jsxs("div",{className:"flex flex-col items-center space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-indigo-300 font-medium",children:"Consulting the archives..."})]}):x&&s.jsxs("div",{className:"max-w-2xl w-full space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-500 ease-out",style:{width:`${p.length/Sm*100}%`}})}),s.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white leading-relaxed text-center",children:x.question}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:x.choices.map((F,Y)=>{const ne=v===F;return s.jsxs("button",{onClick:()=>K(F),disabled:v!==null,className:`
                                                            group flex items-center p-4 rounded-xl border transition-all duration-200 text-left
                                                            ${ne?"bg-indigo-600/20 border-indigo-500 shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-gray-800 border-gray-700 hover:bg-gray-750 hover:border-gray-600"}
                                                            ${v&&!ne?"opacity-50":""}
                                                        `,children:[s.jsx("span",{className:`
                                                            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-4 transition-colors
                                                            ${ne?"bg-indigo-500 text-white":"bg-gray-700 text-gray-400 group-hover:bg-gray-600"}
                                                        `,children:String.fromCharCode(65+Y)}),s.jsx("span",{className:`text-lg transition-colors ${ne?"text-white":"text-gray-300 group-hover:text-white"}`,dangerouslySetInnerHTML:{__html:F}})]},Y)})})]})})]}),i==="advanced"&&s.jsxs("div",{className:"flex-1 flex h-full",children:[s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-900 border-r border-gray-800 w-2/3",children:[s.jsxs("div",{className:"h-16 border-b border-gray-800 flex items-center px-6 bg-gray-900/80 backdrop-blur-sm z-10",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold",children:C}),s.jsx("p",{className:"text-xs text-purple-400",children:"Deep Dive Analysis"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[k.map((F,Y)=>s.jsx("div",{className:`flex ${F.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`
                                            max-w-[80%] rounded-2xl p-4 text-sm leading-relaxed
                                            ${F.role==="user"?"bg-purple-600 text-white rounded-br-none":"bg-gray-800 text-gray-200 border border-gray-700 rounded-bl-none"}
                                        `,children:F.content})},Y)),E&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 border border-gray-700 rounded-bl-none flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-100"}),s.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce delay-200"})]})}),s.jsx("div",{ref:M})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:I,onChange:F=>O(F.target.value),onKeyDown:G,placeholder:"Describe your playstyle...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500",disabled:E}),s.jsx("button",{onClick:X,disabled:E||!I.trim(),className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 rounded-xl font-bold transition-colors",children:"Send"})]})})]}),s.jsxs("div",{className:"w-1/3 bg-gray-950 p-6 overflow-y-auto border-l border-gray-800 hidden md:block",children:[s.jsxs("h3",{className:"text-white font-bold mb-6 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Live Profile Summary"]}),T?s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Analysis"}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:T.summary||"Gathering data..."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Dominant Traits"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:T.tags?.length>0?T.tags.map((F,Y)=>s.jsx("span",{className:"px-2 py-1 rounded bg-purple-500/10 text-purple-400 border border-purple-500/20 text-xs font-medium",children:F},Y)):s.jsx("span",{className:"text-gray-600 text-xs italic",children:"Pending..."})})]}),T.scores&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Psychographics"}),Object.entries(T.scores).map(([F,Y])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1 capitalize",children:[s.jsx("span",{children:F.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{children:[Y,"%"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-indigo-500",style:{width:`${Y}%`}})})]},F))]}),s.jsxs("div",{className:"pt-6 border-t border-gray-800",children:[s.jsx("button",{onClick:Z,className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold shadow-lg hover:shadow-green-500/20 transition-all",children:"Finalize Profile"}),s.jsx("p",{className:"text-center text-xs text-gray-500 mt-2",children:"Click whenever you feel the profile is accurate."})]})]}):s.jsxs("div",{className:"text-center py-10 text-gray-600",children:[s.jsx("div",{className:"animate-pulse mb-2 text-4xl",children:""}),s.jsx("p",{className:"text-sm",children:"The Oracle is listening..."})]})]})]}),i==="synthesis"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-6 bg-gray-900 p-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-t-2 border-b-2 border-green-500"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"h-10 w-10 bg-green-500/20 rounded-full animate-pulse"})})]}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Finalizing your Grimoire..."}),s.jsx("p",{className:"text-gray-400",children:"Saving your magical identity to the archives."})]}),i==="error"&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4 bg-gray-900 text-center p-8",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Something went wrong"}),s.jsx("p",{className:"text-red-300 max-w-md mx-auto",children:$}),s.jsx("button",{onClick:U,className:"mt-6 bg-gray-800 hover:bg-gray-700 text-white py-3 px-8 rounded-lg transition-colors border border-gray-600",children:"Try Again"})]})]})}):null},GY=({isOpen:t,onClose:e,profile:r,onRetake:n,userImage:i})=>{if(!t)return null;if(!r)return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-md bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col p-8 text-center space-y-6",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:i?s.jsx("img",{src:i,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Playstyle Found"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"You haven't taken the assessment yet. Discover your magical identity and get better recommendations!"})]}),s.jsx("button",{onClick:n,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-0.5",children:"Start Assessment"})]})});const{summary:a,tags:l,scores:d,archetypes:u}=r;return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"relative w-full max-w-6xl bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white z-10 p-2 bg-black/20 rounded-full hover:bg-black/40 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[s.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-800/50 p-8 border-b md:border-b-0 md:border-r border-gray-700 flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-6 ring-4 ring-gray-800 overflow-hidden",children:i?s.jsx("img",{src:i,alt:"User",className:"w-full h-full object-cover"}):s.jsx("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Your Playstyle"}),s.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:l&&l.map((h,p)=>s.jsx("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase rounded-full border border-indigo-500/30",children:h},p))}),s.jsx("button",{onClick:n,className:"mt-auto w-full py-3 px-4 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg text-sm font-bold transition-all border border-gray-600 hover:border-gray-500",children:"Retake Assessment"})]}),s.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Analysis Summary"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed text-lg font-serif italic border-l-4 border-indigo-500 pl-4 bg-gray-800/30 py-4 pr-4 rounded-r",children:['"',a,'"']})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Psychographic Profile"}),s.jsx("div",{className:"space-y-4",children:d&&Object.entries(d).map(([h,p])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-400 capitalize",children:h.replace(/([A-Z])/g," $1").trim()}),s.jsxs("span",{className:"text-white font-mono",children:[p,"/100"]})]}),s.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${VY(p)}`,style:{width:`${p}%`}})})]},h))})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Recommended Archetypes"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:u&&u.map((h,p)=>s.jsxs("div",{className:"bg-gray-800/80 p-4 rounded-lg border border-gray-700 flex items-center gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.5)]"}),s.jsx("span",{className:"text-gray-200 font-medium",children:h})]},p))})]})]})]})]})]})})};function VY(t){return t>75?"bg-green-500":t>50?"bg-blue-500":t>25?"bg-yellow-500":"bg-red-500"}const KY=[{id:"alpha_tester",label:"Alpha Tester",icon:"",description:"Restoring balance to the multiverse."},{id:"bug_hunter",label:"Bug Hunter",icon:"",description:"Tracking down pests in the code."},{id:"architect",label:"Architect",icon:"",description:"Building the foundation of the future."},{id:"spark_ignited",label:"Spark Ignited",icon:"",description:"First to walk the planes."},{id:"data_scryer",label:"Data Scryer",icon:"",description:"Analyzing the meta streams."},{id:"stress_tester",label:"Stress Tester",icon:"",description:"Breaking things so we can fix them."},{id:"feedback_loop",label:"Feedback Loop",icon:"",description:"Iterating towards perfection."},{id:"void_gazer",label:"Void Gazer",icon:"",description:"Staring into the console logs."}],YY=({isOpen:t,onClose:e,currentBadgeId:r,onSelect:n,isMaster:i})=>t?s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto w-full h-full flex items-center justify-center md:pl-[250px]",children:[s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 rounded-2xl border border-gray-700 shadow-2xl w-full max-w-2xl mx-4 overflow-hidden animate-scale-in",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900/50",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-500",children:""})," Customize Your Badge"]}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a badge to display next to your profile."})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto custom-scrollbar",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:KY.filter(a=>a.id!=="architect"||i).map(a=>s.jsxs("button",{onClick:()=>n(a),className:`flex items-center gap-4 p-4 rounded-xl border text-left transition-all ${r===a.id?"bg-indigo-900/30 border-indigo-500 ring-1 ring-indigo-500/50":"bg-gray-800/30 border-gray-700 hover:bg-gray-800 hover:border-gray-600"}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-2xl shadow-inner border border-gray-700",children:a.icon}),s.jsxs("div",{children:[s.jsx("h3",{className:`font-bold ${r===a.id?"text-indigo-300":"text-white"}`,children:a.label}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.description})]})]},a.id))})}),s.jsx("div",{className:"p-4 bg-gray-800/50 border-t border-gray-800 text-center text-xs text-gray-500",children:"Thank you for being an early supporter of MTG-Forge."})]})]}):null,tt={FREE:"free",TIER_1:"tier_1",TIER_2:"tier_2",TIER_3:"tier_3",TIER_4:"tier_4",TIER_5:"tier_5"},Gr={[tt.FREE]:{name:"Initiate",prices:{monthly:null,biannual:null,yearly:null},description:"The journey begins. Track up to 3 decks and 300 cards.",limits:{collection:300,wishlist:105,decks:3,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[tt.TIER_1]:{name:"Apprentice",prices:{monthly:"price_1SnxT7RZLrZbIKATICyA3jfB",biannual:"price_1SnxUeRZLrZbIKATlErTgHtz",yearly:"price_1SnxUuRZLrZbIKATm6nmPnUr"},description:"Perfect for new potential. Store up to 10 decks and 1,000 cards.",limits:{collection:1e3,wishlist:300,decks:10,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!1,collectionAudit:!1,mockupDeck:!1,aiStrategy:!1,deckSuggestions:!1,deckAudit:!1,setAudit:!1,collectionBackup:!1,deckBackup:!1,deckDoctor:!1,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!1,pods:!1}},[tt.TIER_2]:{name:"Magician",prices:{monthly:"price_1SnvK5DBKqoK8H1Rj7uSTSfw",biannual:"price_1SnvVSDBKqoK8H1RFAqc0iIH",yearly:"price_1SnvVfDBKqoK8H1RryOTO2p8"},description:"Unlock the power of organization. 25 decks, 2,000 cards, and advanced tools.",limits:{collection:2e3,wishlist:1e3,decks:25,pods:0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!1,customAiPersona:!1,snapScan:!0,batchScan:!0,pods:!1}},[tt.TIER_3]:{name:"Wizard",prices:{monthly:"price_1SnvKxDBKqoK8H1RXvh1VsT3",biannual:"price_1SnvUkDBKqoK8H1RgX9mlcxs",yearly:"price_1SnvUwDBKqoK8H1RAUVYJtmM"},description:"Master your craft. 55 decks, 5,000 cards, Pods, and the AI Deck Doctor.",limits:{collection:5e3,wishlist:2500,decks:55,pods:3},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[tt.TIER_4]:{name:"Archmage",prices:{monthly:"price_1SnvMxDBKqoK8H1RVcOon0kC",biannual:"price_1SnvUSDBKqoK8H1RRAXjFJ1h",yearly:"price_1SnvUSDBKqoK8H1RBMhvTUZA"},description:"Command a vast library. 100 decks, 10,000 cards, and advanced management.",limits:{collection:1e4,wishlist:5e3,decks:100,pods:5},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}},[tt.TIER_5]:{name:"Planeswalker",prices:{monthly:"price_1SnvSmDBKqoK8H1RCezHNZSu",biannual:"price_1SnvTcDBKqoK8H1RAmz1kB1d",yearly:"price_1SnvTcDBKqoK8H1Rn1rFWAws"},description:"Rule the multiverse. Unlimited access to all features and storage.",limits:{collection:1/0,wishlist:1/0,decks:1/0,pods:1/0},features:{aiChatbot:!0,smartBinders:!0,binders:!0,collectionAudit:!0,mockupDeck:!0,aiStrategy:!0,deckSuggestions:!0,deckAudit:!0,setAudit:!0,collectionBackup:!0,deckBackup:!0,deckDoctor:!0,sharedEdit:!0,customAiPersona:!0,snapScan:!0,batchScan:!0,pods:!0}}};function Yt(t){return Gr[t]||Gr[tt.FREE]}var bg={exports:{}},XY=bg.exports,FE;function JY(){return FE||(FE=1,(function(t,e){(function(n,i){t.exports=i(al())})(XY,function(r){return(function(n){var i={};function a(l){if(i[l])return i[l].exports;var d=i[l]={i:l,l:!1,exports:{}};return n[l].call(d.exports,d,d.exports,a),d.l=!0,d.exports}return a.m=n,a.c=i,a.d=function(l,d,u){a.o(l,d)||Object.defineProperty(l,d,{enumerable:!0,get:u})},a.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},a.t=function(l,d){if(d&1&&(l=a(l)),d&8||d&4&&typeof l=="object"&&l&&l.__esModule)return l;var u=Object.create(null);if(a.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:l}),d&2&&typeof l!="string")for(var h in l)a.d(u,h,(function(p){return l[p]}).bind(null,h));return u},a.n=function(l){var d=l&&l.__esModule?function(){return l.default}:function(){return l};return a.d(d,"a",d),d},a.o=function(l,d){return Object.prototype.hasOwnProperty.call(l,d)},a.p="",a(a.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(n,i,a){a.r(i);var l=a("react"),d=(function(){var x=function(b,v){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,k){w.__proto__=k}||function(w,k){for(var _ in k)k.hasOwnProperty(_)&&(w[_]=k[_])},x(b,v)};return function(b,v){x(b,v);function w(){this.constructor=b}b.prototype=v===null?Object.create(v):(w.prototype=v.prototype,new w)}})(),u=function(){return u=Object.assign||function(x){for(var b,v=1,w=arguments.length;v<w;v++){b=arguments[v];for(var k in b)Object.prototype.hasOwnProperty.call(b,k)&&(x[k]=b[k])}return x},u.apply(this,arguments)},h=function(x,b){var v={};for(var w in x)Object.prototype.hasOwnProperty.call(x,w)&&b.indexOf(w)<0&&(v[w]=x[w]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var k=0,w=Object.getOwnPropertySymbols(x);k<w.length;k++)b.indexOf(w[k])<0&&Object.prototype.propertyIsEnumerable.call(x,w[k])&&(v[w[k]]=x[w[k]]);return v};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(b){var v=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return v?new Promise(function(w,k){v.call(navigator,b,w,k)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function p(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var m=(function(x){d(b,x);function b(v){var w=x.call(this,v)||this;return w.canvas=null,w.ctx=null,w.requestUserMediaId=0,w.unmounted=!1,w.state={hasUserMedia:!1},w}return b.prototype.componentDidMount=function(){var v=this,w=v.state,k=v.props;if(this.unmounted=!1,!p()){k.onUserMediaError("getUserMedia not supported");return}w.hasUserMedia||this.requestUserMedia(),k.children&&typeof k.children!="function"&&console.warn("children must be a function")},b.prototype.componentDidUpdate=function(v){var w=this.props;if(!p()){w.onUserMediaError("getUserMedia not supported");return}var k=JSON.stringify(v.audioConstraints)!==JSON.stringify(w.audioConstraints),_=JSON.stringify(v.videoConstraints)!==JSON.stringify(w.videoConstraints),T=v.minScreenshotWidth!==w.minScreenshotWidth,A=v.minScreenshotHeight!==w.minScreenshotHeight;(_||T||A)&&(this.canvas=null,this.ctx=null),(k||_)&&(this.stopAndCleanup(),this.requestUserMedia())},b.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},b.stopMediaStream=function(v){v&&(v.getVideoTracks&&v.getAudioTracks?(v.getVideoTracks().map(function(w){v.removeTrack(w),w.stop()}),v.getAudioTracks().map(function(w){v.removeTrack(w),w.stop()})):v.stop())},b.prototype.stopAndCleanup=function(){var v=this.state;v.hasUserMedia&&(b.stopMediaStream(this.stream),v.src&&window.URL.revokeObjectURL(v.src))},b.prototype.getScreenshot=function(v){var w=this,k=w.state,_=w.props;if(!k.hasUserMedia)return null;var T=this.getCanvas(v);return T&&T.toDataURL(_.screenshotFormat,_.screenshotQuality)},b.prototype.getCanvas=function(v){var w=this,k=w.state,_=w.props;if(!this.video||!k.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var T=this.video.videoWidth,A=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var I=T/A;T=_.minScreenshotWidth||this.video.clientWidth,A=T/I,_.minScreenshotHeight&&A<_.minScreenshotHeight&&(A=_.minScreenshotHeight,T=A*I)}this.canvas=document.createElement("canvas"),this.canvas.width=v?.width||T,this.canvas.height=v?.height||A,this.ctx=this.canvas.getContext("2d")}var O=this,M=O.ctx,E=O.canvas;return M&&E&&(E.width=v?.width||E.width,E.height=v?.height||E.height,_.mirrored&&(M.translate(E.width,0),M.scale(-1,1)),M.imageSmoothingEnabled=_.imageSmoothing,M.drawImage(this.video,0,0,v?.width||E.width,v?.height||E.height),_.mirrored&&(M.scale(-1,1),M.translate(-E.width,0))),E},b.prototype.requestUserMedia=function(){var v=this,w=this.props,k=function(A,I){var O={video:typeof I<"u"?I:!0};w.audio&&(O.audio=typeof A<"u"?A:!0),v.requestUserMediaId++;var M=v.requestUserMediaId;navigator.mediaDevices.getUserMedia(O).then(function(E){v.unmounted||M!==v.requestUserMediaId?b.stopMediaStream(E):v.handleUserMedia(null,E)}).catch(function(E){v.handleUserMedia(E)})};if("mediaDevices"in navigator)k(w.audioConstraints,w.videoConstraints);else{var _=function(A){return{optional:[{sourceId:A}]}},T=function(A){var I=A.deviceId;return typeof I=="string"?I:Array.isArray(I)&&I.length>0?I[0]:typeof I=="object"&&I.ideal?I.ideal:null};MediaStreamTrack.getSources(function(A){var I=null,O=null;A.forEach(function(R){R.kind==="audio"?I=R.id:R.kind==="video"&&(O=R.id)});var M=T(w.audioConstraints);M&&(I=M);var E=T(w.videoConstraints);E&&(O=E),k(_(I),_(O))})}},b.prototype.handleUserMedia=function(v,w){var k=this.props;if(v||!w){this.setState({hasUserMedia:!1}),k.onUserMediaError(v);return}this.stream=w;try{this.video&&(this.video.srcObject=w),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(w)})}k.onUserMedia(w)},b.prototype.render=function(){var v=this,w=this,k=w.state,_=w.props,T=_.audio;_.forceScreenshotSourceSize;var A=_.disablePictureInPicture;_.onUserMedia,_.onUserMediaError,_.screenshotFormat,_.screenshotQuality,_.minScreenshotWidth,_.minScreenshotHeight,_.audioConstraints,_.videoConstraints,_.imageSmoothing;var I=_.mirrored,O=_.style,M=O===void 0?{}:O,E=_.children,R=h(_,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),$=I?u(u({},M),{transform:(M.transform||"")+" scaleX(-1)"}):M,B={getScreenshot:this.getScreenshot.bind(this)};return l.createElement(l.Fragment,null,l.createElement("video",u({autoPlay:!0,disablePictureInPicture:A,src:k.src,muted:!T,playsInline:!0,ref:function(C){v.video=C},style:$},R)),E&&E(B))},b.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},b})(l.Component);i.default=m}),react:(function(n,i){n.exports=r})}).default})})(bg)),bg.exports}var QY=JY();const CP=Ms(QY);var w1={exports:{}},HE;function ZY(){return HE||(HE=1,(function(t){var e=(function(r){var n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(Z,G,F){Z[G]=F.value},l,d=typeof Symbol=="function"?Symbol:{},u=d.iterator||"@@iterator",h=d.asyncIterator||"@@asyncIterator",p=d.toStringTag||"@@toStringTag";function m(Z,G,F){return Object.defineProperty(Z,G,{value:F,enumerable:!0,configurable:!0,writable:!0}),Z[G]}try{m({},"")}catch{m=function(G,F,Y){return G[F]=Y}}function x(Z,G,F,Y){var ne=G&&G.prototype instanceof A?G:A,re=Object.create(ne.prototype),ue=new W(Y||[]);return a(re,"_invoke",{value:U(Z,F,ue)}),re}r.wrap=x;function b(Z,G,F){try{return{type:"normal",arg:Z.call(G,F)}}catch(Y){return{type:"throw",arg:Y}}}var v="suspendedStart",w="suspendedYield",k="executing",_="completed",T={};function A(){}function I(){}function O(){}var M={};m(M,u,function(){return this});var E=Object.getPrototypeOf,R=E&&E(E(V([])));R&&R!==n&&i.call(R,u)&&(M=R);var $=O.prototype=A.prototype=Object.create(M);I.prototype=O,a($,"constructor",{value:O,configurable:!0}),a(O,"constructor",{value:I,configurable:!0}),I.displayName=m(O,p,"GeneratorFunction");function B(Z){["next","throw","return"].forEach(function(G){m(Z,G,function(F){return this._invoke(G,F)})})}r.isGeneratorFunction=function(Z){var G=typeof Z=="function"&&Z.constructor;return G?G===I||(G.displayName||G.name)==="GeneratorFunction":!1},r.mark=function(Z){return Object.setPrototypeOf?Object.setPrototypeOf(Z,O):(Z.__proto__=O,m(Z,p,"GeneratorFunction")),Z.prototype=Object.create($),Z},r.awrap=function(Z){return{__await:Z}};function C(Z,G){function F(re,ue,Le,de){var ve=b(Z[re],Z,ue);if(ve.type==="throw")de(ve.arg);else{var te=ve.arg,ge=te.value;return ge&&typeof ge=="object"&&i.call(ge,"__await")?G.resolve(ge.__await).then(function(ke){F("next",ke,Le,de)},function(ke){F("throw",ke,Le,de)}):G.resolve(ge).then(function(ke){te.value=ke,Le(te)},function(ke){return F("throw",ke,Le,de)})}}var Y;function ne(re,ue){function Le(){return new G(function(de,ve){F(re,ue,de,ve)})}return Y=Y?Y.then(Le,Le):Le()}a(this,"_invoke",{value:ne})}B(C.prototype),m(C.prototype,h,function(){return this}),r.AsyncIterator=C,r.async=function(Z,G,F,Y,ne){ne===void 0&&(ne=Promise);var re=new C(x(Z,G,F,Y),ne);return r.isGeneratorFunction(G)?re:re.next().then(function(ue){return ue.done?ue.value:re.next()})};function U(Z,G,F){var Y=v;return function(re,ue){if(Y===k)throw new Error("Generator is already running");if(Y===_){if(re==="throw")throw ue;return X()}for(F.method=re,F.arg=ue;;){var Le=F.delegate;if(Le){var de=L(Le,F);if(de){if(de===T)continue;return de}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(Y===v)throw Y=_,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);Y=k;var ve=b(Z,G,F);if(ve.type==="normal"){if(Y=F.done?_:w,ve.arg===T)continue;return{value:ve.arg,done:F.done}}else ve.type==="throw"&&(Y=_,F.method="throw",F.arg=ve.arg)}}}function L(Z,G){var F=G.method,Y=Z.iterator[F];if(Y===l)return G.delegate=null,F==="throw"&&Z.iterator.return&&(G.method="return",G.arg=l,L(Z,G),G.method==="throw")||F!=="return"&&(G.method="throw",G.arg=new TypeError("The iterator does not provide a '"+F+"' method")),T;var ne=b(Y,Z.iterator,G.arg);if(ne.type==="throw")return G.method="throw",G.arg=ne.arg,G.delegate=null,T;var re=ne.arg;if(!re)return G.method="throw",G.arg=new TypeError("iterator result is not an object"),G.delegate=null,T;if(re.done)G[Z.resultName]=re.value,G.next=Z.nextLoc,G.method!=="return"&&(G.method="next",G.arg=l);else return re;return G.delegate=null,T}B($),m($,p,"Generator"),m($,u,function(){return this}),m($,"toString",function(){return"[object Generator]"});function q(Z){var G={tryLoc:Z[0]};1 in Z&&(G.catchLoc=Z[1]),2 in Z&&(G.finallyLoc=Z[2],G.afterLoc=Z[3]),this.tryEntries.push(G)}function K(Z){var G=Z.completion||{};G.type="normal",delete G.arg,Z.completion=G}function W(Z){this.tryEntries=[{tryLoc:"root"}],Z.forEach(q,this),this.reset(!0)}r.keys=function(Z){var G=Object(Z),F=[];for(var Y in G)F.push(Y);return F.reverse(),function ne(){for(;F.length;){var re=F.pop();if(re in G)return ne.value=re,ne.done=!1,ne}return ne.done=!0,ne}};function V(Z){if(Z){var G=Z[u];if(G)return G.call(Z);if(typeof Z.next=="function")return Z;if(!isNaN(Z.length)){var F=-1,Y=function ne(){for(;++F<Z.length;)if(i.call(Z,F))return ne.value=Z[F],ne.done=!1,ne;return ne.value=l,ne.done=!0,ne};return Y.next=Y}}return{next:X}}r.values=V;function X(){return{value:l,done:!0}}return W.prototype={constructor:W,reset:function(Z){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(K),!Z)for(var G in this)G.charAt(0)==="t"&&i.call(this,G)&&!isNaN(+G.slice(1))&&(this[G]=l)},stop:function(){this.done=!0;var Z=this.tryEntries[0],G=Z.completion;if(G.type==="throw")throw G.arg;return this.rval},dispatchException:function(Z){if(this.done)throw Z;var G=this;function F(de,ve){return re.type="throw",re.arg=Z,G.next=de,ve&&(G.method="next",G.arg=l),!!ve}for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ne=this.tryEntries[Y],re=ne.completion;if(ne.tryLoc==="root")return F("end");if(ne.tryLoc<=this.prev){var ue=i.call(ne,"catchLoc"),Le=i.call(ne,"finallyLoc");if(ue&&Le){if(this.prev<ne.catchLoc)return F(ne.catchLoc,!0);if(this.prev<ne.finallyLoc)return F(ne.finallyLoc)}else if(ue){if(this.prev<ne.catchLoc)return F(ne.catchLoc,!0)}else if(Le){if(this.prev<ne.finallyLoc)return F(ne.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(Z,G){for(var F=this.tryEntries.length-1;F>=0;--F){var Y=this.tryEntries[F];if(Y.tryLoc<=this.prev&&i.call(Y,"finallyLoc")&&this.prev<Y.finallyLoc){var ne=Y;break}}ne&&(Z==="break"||Z==="continue")&&ne.tryLoc<=G&&G<=ne.finallyLoc&&(ne=null);var re=ne?ne.completion:{};return re.type=Z,re.arg=G,ne?(this.method="next",this.next=ne.finallyLoc,T):this.complete(re)},complete:function(Z,G){if(Z.type==="throw")throw Z.arg;return Z.type==="break"||Z.type==="continue"?this.next=Z.arg:Z.type==="return"?(this.rval=this.arg=Z.arg,this.method="return",this.next="end"):Z.type==="normal"&&G&&(this.next=G),T},finish:function(Z){for(var G=this.tryEntries.length-1;G>=0;--G){var F=this.tryEntries[G];if(F.finallyLoc===Z)return this.complete(F.completion,F.afterLoc),K(F),T}},catch:function(Z){for(var G=this.tryEntries.length-1;G>=0;--G){var F=this.tryEntries[G];if(F.tryLoc===Z){var Y=F.completion;if(Y.type==="throw"){var ne=Y.arg;K(F)}return ne}}throw new Error("illegal catch attempt")},delegateYield:function(Z,G,F){return this.delegate={iterator:V(Z),resultName:G,nextLoc:F},this.method==="next"&&(this.arg=l),T}},r})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(w1)),w1.exports}var j1,WE;function E4(){return WE||(WE=1,j1=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),j1}var N1,GE;function EP(){if(GE)return N1;GE=1;const t=E4();let e=0;return N1=({id:r,action:n,payload:i={}})=>{let a=r;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:n,payload:i}},N1}var lf={},VE;function A4(){if(VE)return lf;VE=1;let t=!1;return lf.logging=t,lf.setLogging=e=>{t=e},lf.log=(...e)=>t?console.log.apply(this,e):null,lf}var k1,KE;function eX(){if(KE)return k1;KE=1;const t=EP(),{log:e}=A4(),r=E4();let n=0;return k1=()=>{const i=r("Scheduler",n),a={},l={};let d=[];n+=1;const u=()=>d.length,h=()=>Object.keys(a).length,p=()=>{if(d.length!==0){const w=Object.keys(a);for(let k=0;k<w.length;k+=1)if(typeof l[w[k]]>"u"){d[0](a[w[k]]);break}}},m=(w,k)=>new Promise((_,T)=>{const A=t({action:w,payload:k});d.push(async I=>{d.shift(),l[I.id]=A;try{_(await I[w].apply(this,[...k,A.id]))}catch(O){T(O)}finally{delete l[I.id],p()}}),e(`[${i}]: Add ${A.id} to JobQueue`),e(`[${i}]: JobQueue length=${d.length}`),p()});return{addWorker:w=>(a[w.id]=w,e(`[${i}]: Add ${w.id}`),e(`[${i}]: Number of workers=${h()}`),p(),w.id),addJob:async(w,...k)=>{if(h()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return m(w,k)},terminate:async()=>{Object.keys(a).forEach(async w=>{await a[w].terminate()}),d=[]},getQueueLen:u,getNumWorkers:h}},k1}function tX(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var S1,YE;function rX(){return YE||(YE=1,S1=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof tX=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),S1}var _1,XE;function nX(){if(XE)return _1;XE=1;const e=rX()("type")==="browser"?r=>new URL(r,window.location.href).href:r=>r;return _1=r=>{const n={...r};return["corePath","workerPath","langPath"].forEach(i=>{r[i]&&(n[i]=e(n[i]))}),n},_1}var C1,JE;function AP(){return JE||(JE=1,C1={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),C1}const sX="7.0.0",iX={version:sX};var E1,QE;function aX(){return QE||(QE=1,E1={workerBlobURL:!0,logger:()=>{}}),E1}var A1,ZE;function oX(){if(ZE)return A1;ZE=1;const t=iX.version;return A1={...aX(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},A1}var T1,eA;function lX(){return eA||(eA=1,T1=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const n=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(n))}else r=new Worker(t);return r}),T1}var O1,tA;function cX(){return tA||(tA=1,O1=t=>{t.terminate()}),O1}var M1,rA;function dX(){return rA||(rA=1,M1=(t,e)=>{t.onmessage=({data:r})=>{e(r)}}),M1}var L1,nA;function uX(){return nA||(nA=1,L1=async(t,e)=>{t.postMessage(e)}),L1}var R1,sA;function hX(){if(sA)return R1;sA=1;const t=r=>new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=({target:{error:{code:l}}})=>{i(Error(`File could not be read! Code=${l}`))},a.readAsArrayBuffer(r)}),e=async r=>{let n=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?n=atob(r.split(",")[1]).split("").map(i=>i.charCodeAt(0)):n=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(n=await e(r.src)),r.tagName==="VIDEO"&&(n=await e(r.poster)),r.tagName==="CANVAS"&&await new Promise(i=>{r.toBlob(async a=>{n=await t(a),i()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){const i=await r.convertToBlob();n=await t(i)}else(r instanceof File||r instanceof Blob)&&(n=await t(r));return new Uint8Array(n)};return R1=e,R1}var P1,iA;function fX(){if(iA)return P1;iA=1;const t=oX(),e=lX(),r=cX(),n=dX(),i=uX(),a=hX();return P1={defaultOptions:t,spawnWorker:e,terminateWorker:r,onMessage:n,send:i,loadImage:a},P1}var I1,aA;function TP(){if(aA)return I1;aA=1;const t=nX(),e=EP(),{log:r}=A4(),n=E4(),i=AP(),{defaultOptions:a,spawnWorker:l,terminateWorker:d,onMessage:u,loadImage:h,send:p}=fX();let m=0;return I1=async(x="eng",b=i.LSTM_ONLY,v={},w={})=>{const k=n("Worker",m),{logger:_,errorHandler:T,...A}=t({...a,...v}),I={},O=typeof x=="string"?x.split("+"):x;let M=b,E=w;const R=[i.DEFAULT,i.LSTM_ONLY].includes(b)&&!A.legacyCore;let $,B;const C=new Promise((te,ge)=>{B=te,$=ge}),U=te=>{$(te.message)};let L=l(A);L.onerror=U,m+=1;const q=({id:te,action:ge,payload:ke})=>new Promise((oe,Ee)=>{r(`[${k}]: Start ${te}, action=${ge}`);const Te=`${ge}-${te}`;I[Te]={resolve:oe,reject:Ee},p(L,{workerId:k,jobId:te,action:ge,payload:ke})}),K=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),W=te=>q(e({id:te,action:"load",payload:{options:{lstmOnly:R,corePath:A.corePath,logging:A.logging}}})),V=(te,ge,ke)=>q(e({id:ke,action:"FS",payload:{method:"writeFile",args:[te,ge]}})),X=(te,ge)=>q(e({id:ge,action:"FS",payload:{method:"readFile",args:[te,{encoding:"utf8"}]}})),Z=(te,ge)=>q(e({id:ge,action:"FS",payload:{method:"unlink",args:[te]}})),G=(te,ge,ke)=>q(e({id:ke,action:"FS",payload:{method:te,args:ge}})),F=(te,ge)=>q(e({id:ge,action:"loadLanguage",payload:{langs:te,options:{langPath:A.langPath,dataPath:A.dataPath,cachePath:A.cachePath,cacheMethod:A.cacheMethod,gzip:A.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(M)&&!A.legacyLang}}})),Y=(te,ge,ke,oe)=>q(e({id:oe,action:"initialize",payload:{langs:te,oem:ge,config:ke}})),ne=(te="eng",ge,ke,oe)=>{if(R&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(ge))throw Error("Legacy model requested but code missing.");const Ee=ge||M;M=Ee;const Te=ke||E;E=Te;const ze=(typeof te=="string"?te.split("+"):te).filter(le=>!O.includes(le));return O.push(...ze),ze.length>0?F(ze,oe).then(()=>Y(te,Ee,Te,oe)):Y(te,Ee,Te,oe)},re=(te={},ge)=>q(e({id:ge,action:"setParameters",payload:{params:te}})),ue=async(te,ge={},ke={text:!0},oe)=>q(e({id:oe,action:"recognize",payload:{image:await h(te),options:ge,output:ke}})),Le=async(te,ge)=>{if(R)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return q(e({id:ge,action:"detect",payload:{image:await h(te)}}))},de=async()=>(L!==null&&(d(L),L=null),Promise.resolve());u(L,({workerId:te,jobId:ge,status:ke,action:oe,data:Ee})=>{const Te=`${oe}-${ge}`;if(ke==="resolve")r(`[${te}]: Complete ${ge}`),I[Te].resolve({jobId:ge,data:Ee}),delete I[Te];else if(ke==="reject")if(I[Te].reject(Ee),delete I[Te],oe==="load"&&$(Ee),T)T(Ee);else throw Error(Ee);else ke==="progress"&&_({...Ee,userJobId:ge})});const ve={id:k,worker:L,load:K,writeText:V,readText:X,removeFile:Z,FS:G,reinitialize:ne,setParameters:re,recognize:ue,detect:Le,terminate:de};return W().then(()=>F(x)).then(()=>Y(x,b,w)).then(()=>B(ve)).catch(()=>{}),C},I1}var D1,oA;function pX(){if(oA)return D1;oA=1;const t=TP();return D1={recognize:async(n,i,a)=>{const l=await t(i,1,a);return l.recognize(n).finally(async()=>{await l.terminate()})},detect:async(n,i)=>{const a=await t("osd",0,i);return a.detect(n).finally(async()=>{await a.terminate()})}},D1}var B1,lA;function mX(){return lA||(lA=1,B1={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),B1}var $1,cA;function gX(){return cA||(cA=1,$1={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),$1}var U1,dA;function xX(){if(dA)return U1;dA=1,ZY();const t=eX(),e=TP(),r=pX(),n=mX(),i=AP(),a=gX(),{setLogging:l}=A4();return U1={languages:n,OEM:i,PSM:a,createScheduler:t,createWorker:e,setLogging:l,...r},U1}var OP=xX();const yX=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bX=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),uA=t=>{const e=bX(t);return e.charAt(0).toUpperCase()+e.slice(1)},MP=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),vX=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var wX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const jX=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...d},u)=>y.createElement("svg",{ref:u,...wX,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:MP("lucide",i),...!a&&!vX(d)&&{"aria-hidden":"true"},...d},[...l.map(([h,p])=>y.createElement(h,p)),...Array.isArray(a)?a:[a]]));const Tr=(t,e)=>{const r=y.forwardRef(({className:n,...i},a)=>y.createElement(jX,{ref:a,iconNode:e,className:MP(`lucide-${yX(uA(t))}`,`lucide-${t}`,n),...i}));return r.displayName=uA(t),r};const NX=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],kX=Tr("arrow-left",NX);const SX=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],hA=Tr("brain",SX);const _X=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],LP=Tr("camera",_X);const CX=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],EX=Tr("chart-column",CX);const AX=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],lc=Tr("check",AX);const TX=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],z1=Tr("circle-alert",TX);const OX=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],MX=Tr("credit-card",OX);const LX=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],q1=Tr("crown",LX);const RX=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],PX=Tr("grid-3x3",RX);const IX=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],DX=Tr("heart",IX);const BX=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],$X=Tr("layers",BX);const UX=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],zX=Tr("list",UX);const qX=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],FX=Tr("lock",qX);const HX=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],gj=Tr("refresh-cw",HX);const WX=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],fA=Tr("shield",WX);const GX=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],RP=Tr("smartphone",GX);const VX=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],pA=Tr("sparkles",VX);const KX=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],YX=Tr("star",KX);const XX=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],JX=Tr("target",XX);const QX=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ZX=Tr("trash-2",QX);const eJ=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],tJ=Tr("upload",eJ);const rJ=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],nJ=Tr("users",rJ);const sJ=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],iJ=Tr("wifi-off",sJ);const aJ=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],oJ=Tr("wifi",aJ);const lJ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Yf=Tr("x",lJ);const cJ=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],xj=Tr("zap",cJ),Qa=Object.create(null);Qa.open="0";Qa.close="1";Qa.ping="2";Qa.pong="3";Qa.message="4";Qa.upgrade="5";Qa.noop="6";const vg=Object.create(null);Object.keys(Qa).forEach(t=>{vg[Qa[t]]=t});const yj={type:"error",data:"parser error"},PP=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",IP=typeof ArrayBuffer=="function",DP=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,T4=({type:t,data:e},r,n)=>PP&&e instanceof Blob?r?n(e):mA(e,n):IP&&(e instanceof ArrayBuffer||DP(e))?r?n(e):mA(new Blob([e]),n):n(Qa[t]+(e||"")),mA=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function gA(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let F1;function dJ(t,e){if(PP&&t.data instanceof Blob)return t.data.arrayBuffer().then(gA).then(e);if(IP&&(t.data instanceof ArrayBuffer||DP(t.data)))return e(gA(t.data));T4(t,!1,r=>{F1||(F1=new TextEncoder),e(F1.encode(r))})}const xA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Cf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<xA.length;t++)Cf[xA.charCodeAt(t)]=t;const uJ=t=>{let e=t.length*.75,r=t.length,n,i=0,a,l,d,u;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const h=new ArrayBuffer(e),p=new Uint8Array(h);for(n=0;n<r;n+=4)a=Cf[t.charCodeAt(n)],l=Cf[t.charCodeAt(n+1)],d=Cf[t.charCodeAt(n+2)],u=Cf[t.charCodeAt(n+3)],p[i++]=a<<2|l>>4,p[i++]=(l&15)<<4|d>>2,p[i++]=(d&3)<<6|u&63;return h},hJ=typeof ArrayBuffer=="function",O4=(t,e)=>{if(typeof t!="string")return{type:"message",data:BP(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:fJ(t.substring(1),e)}:vg[r]?t.length>1?{type:vg[r],data:t.substring(1)}:{type:vg[r]}:yj},fJ=(t,e)=>{if(hJ){const r=uJ(t);return BP(r,e)}else return{base64:!0,data:t}},BP=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,$P="",pJ=(t,e)=>{const r=t.length,n=new Array(r);let i=0;t.forEach((a,l)=>{T4(a,!1,d=>{n[l]=d,++i===r&&e(n.join($P))})})},mJ=(t,e)=>{const r=t.split($P),n=[];for(let i=0;i<r.length;i++){const a=O4(r[i],e);if(n.push(a),a.type==="error")break}return n};function gJ(){return new TransformStream({transform(t,e){dJ(t,r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(r)})}})}let H1;function _m(t){return t.reduce((e,r)=>e+r.length,0)}function Cm(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function xJ(t,e){H1||(H1=new TextDecoder);const r=[];let n=0,i=-1,a=!1;return new TransformStream({transform(l,d){for(r.push(l);;){if(n===0){if(_m(r)<1)break;const u=Cm(r,1);a=(u[0]&128)===128,i=u[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(_m(r)<2)break;const u=Cm(r,2);i=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(_m(r)<8)break;const u=Cm(r,8),h=new DataView(u.buffer,u.byteOffset,u.length),p=h.getUint32(0);if(p>Math.pow(2,21)-1){d.enqueue(yj);break}i=p*Math.pow(2,32)+h.getUint32(4),n=3}else{if(_m(r)<i)break;const u=Cm(r,i);d.enqueue(O4(a?u:H1.decode(u),e)),n=0}if(i===0||i>t){d.enqueue(yj);break}}}})}const UP=4;function jn(t){if(t)return yJ(t)}function yJ(t){for(var e in jn.prototype)t[e]=jn.prototype[e];return t}jn.prototype.on=jn.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};jn.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};jn.prototype.off=jn.prototype.removeListener=jn.prototype.removeAllListeners=jn.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};jn.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};jn.prototype.emitReserved=jn.prototype.emit;jn.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};jn.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Qx=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),Ui=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),bJ="arraybuffer";function zP(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const vJ=Ui.setTimeout,wJ=Ui.clearTimeout;function Zx(t,e){e.useNativeTimers?(t.setTimeoutFn=vJ.bind(Ui),t.clearTimeoutFn=wJ.bind(Ui)):(t.setTimeoutFn=Ui.setTimeout.bind(Ui),t.clearTimeoutFn=Ui.clearTimeout.bind(Ui))}const jJ=1.33;function NJ(t){return typeof t=="string"?kJ(t):Math.ceil((t.byteLength||t.size)*jJ)}function kJ(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function qP(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function SJ(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function _J(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class CJ extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class M4 extends jn{constructor(e){super(),this.writable=!1,Zx(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new CJ(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=O4(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=SJ(e);return r.length?"?"+r:""}}class EJ extends M4{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};mJ(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,pJ(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=qP()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let FP=!1;try{FP=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const AJ=FP;function TJ(){}class OJ extends EJ{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}let Bu=class wg extends jn{constructor(e,r,n){super(),this.createRequest=e,Zx(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=zP(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=wg.requestsCount++,wg.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=TJ,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete wg.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Bu.requestsCount=0;Bu.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",yA);else if(typeof addEventListener=="function"){const t="onpagehide"in Ui?"pagehide":"unload";addEventListener(t,yA,!1)}}function yA(){for(let t in Bu.requests)Bu.requests.hasOwnProperty(t)&&Bu.requests[t].abort()}const MJ=(function(){const t=HP({xdomain:!1});return t&&t.responseType!==null})();class LJ extends OJ{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=MJ&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Bu(HP,this.uri(),e)}}function HP(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||AJ))return new XMLHttpRequest}catch{}if(!e)try{return new Ui[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const WP=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class RJ extends M4{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=WP?{}:zP(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;T4(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}i&&Qx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=qP()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const W1=Ui.WebSocket||Ui.MozWebSocket;class PJ extends RJ{createSocket(e,r,n){return WP?new W1(e,r,n):r?new W1(e,r):new W1(e)}doWrite(e,r){this.ws.send(r)}}class IJ extends M4{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=xJ(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),i=gJ();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const a=()=>{n.read().then(({done:d,value:u})=>{d||(this.onPacket(u),a())}).catch(d=>{})};a();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;this._writer.write(n).then(()=>{i&&Qx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const DJ={websocket:PJ,webtransport:IJ,polling:LJ},BJ=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,$J=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function bj(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=BJ.exec(t||""),a={},l=14;for(;l--;)a[$J[l]]=i[l]||"";return r!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=UJ(a,a.path),a.queryKey=zJ(a,a.query),a}function UJ(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function zJ(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,a){i&&(r[i]=a)}),r}const vj=typeof addEventListener=="function"&&typeof removeEventListener=="function",jg=[];vj&&addEventListener("offline",()=>{jg.forEach(t=>t())},!1);class cc extends jn{constructor(e,r){if(super(),this.binaryType=bJ,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=bj(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=bj(r.host).host);Zx(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=_J(this.opts.query)),vj&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},jg.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=UP,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&cc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",cc.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(r+=NJ(i)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Qx(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:e,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(cc.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),vj&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=jg.indexOf(this._offlineEventListener);n!==-1&&jg.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}cc.protocol=UP;class qJ extends cc{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;cc.priorWebsocketSuccess=!1;const i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",m=>{if(!n)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;cc.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(p(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=r.name,this.emitReserved("upgradeError",x)}}))};function a(){n||(n=!0,p(),r.close(),r=null)}const l=m=>{const x=new Error("probe error: "+m);x.transport=r.name,a(),this.emitReserved("upgradeError",x)};function d(){l("transport closed")}function u(){l("socket closed")}function h(m){r&&m.name!==r.name&&a()}const p=()=>{r.removeListener("open",i),r.removeListener("error",l),r.removeListener("close",d),this.off("close",u),this.off("upgrading",h)};r.once("open",i),r.once("error",l),r.once("close",d),this.once("close",u),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let FJ=class extends qJ{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>DJ[i]).filter(i=>!!i)),super(e,n)}};function HJ(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=bj(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const WJ=typeof ArrayBuffer=="function",GJ=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,GP=Object.prototype.toString,VJ=typeof Blob=="function"||typeof Blob<"u"&&GP.call(Blob)==="[object BlobConstructor]",KJ=typeof File=="function"||typeof File<"u"&&GP.call(File)==="[object FileConstructor]";function L4(t){return WJ&&(t instanceof ArrayBuffer||GJ(t))||VJ&&t instanceof Blob||KJ&&t instanceof File}function Ng(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(Ng(t[r]))return!0;return!1}if(L4(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ng(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Ng(t[r]))return!0;return!1}function YJ(t){const e=[],r=t.data,n=t;return n.data=wj(r,e),n.attachments=e.length,{packet:n,buffers:e}}function wj(t,e){if(!t)return t;if(L4(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=wj(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=wj(t[n],e));return r}return t}function XJ(t,e){return t.data=jj(t.data,e),delete t.attachments,t}function jj(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=jj(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=jj(t[r],e));return t}const VP=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],JJ=5;var Bt;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Bt||(Bt={}));class QJ{constructor(e){this.replacer=e}encode(e){return(e.type===Bt.EVENT||e.type===Bt.ACK)&&Ng(e)?this.encodeAsBinary({type:e.type===Bt.EVENT?Bt.BINARY_EVENT:Bt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===Bt.BINARY_EVENT||e.type===Bt.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=YJ(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}}class R4 extends jn{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===Bt.BINARY_EVENT;n||r.type===Bt.BINARY_ACK?(r.type=n?Bt.EVENT:Bt.ACK,this.reconstructor=new ZJ(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(L4(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(Bt[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Bt.BINARY_EVENT||n.type===Bt.BINARY_ACK){const a=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const l=e.substring(a,r);if(l!=Number(l)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(l)}if(e.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(a,r)}else n.nsp="/";const i=e.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const l=e.charAt(r);if(l==null||Number(l)!=l){--r;break}if(r===e.length)break}n.id=Number(e.substring(a,r+1))}if(e.charAt(++r)){const a=this.tryParse(e.substr(r));if(R4.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case Bt.CONNECT:return Wg(r);case Bt.DISCONNECT:return r===void 0;case Bt.CONNECT_ERROR:return typeof r=="string"||Wg(r);case Bt.EVENT:case Bt.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&VP.indexOf(r[0])===-1);case Bt.ACK:case Bt.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ZJ{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=XJ(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function eQ(t){return typeof t=="string"}const tQ=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function rQ(t){return t===void 0||tQ(t)}function Wg(t){return Object.prototype.toString.call(t)==="[object Object]"}function nQ(t,e){switch(t){case Bt.CONNECT:return e===void 0||Wg(e);case Bt.DISCONNECT:return e===void 0;case Bt.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&VP.indexOf(e[0])===-1);case Bt.ACK:return Array.isArray(e);case Bt.CONNECT_ERROR:return typeof e=="string"||Wg(e);default:return!1}}function sQ(t){return eQ(t.nsp)&&rQ(t.id)&&nQ(t.type,t.data)}const iQ=Object.freeze(Object.defineProperty({__proto__:null,Decoder:R4,Encoder:QJ,get PacketType(){return Bt},isPacketValid:sQ,protocol:JJ},Symbol.toStringTag,{value:"Module"}));function ua(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const aQ=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class KP extends jn{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ua(e,"open",this.onopen.bind(this)),ua(e,"packet",this.onpacket.bind(this)),ua(e,"error",this.onerror.bind(this)),ua(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,i,a;if(aQ.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const l={type:Bt.EVENT,data:r};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const p=this.ids++,m=r.pop();this._registerAckCallback(p,m),l.id=p}const d=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,u=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!d||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(e,r){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let d=0;d<this.sendBuffer.length;d++)this.sendBuffer[d].id===e&&this.sendBuffer.splice(d,1);r.call(this,new Error("operation has timed out"))},i),l=(...d)=>{this.io.clearTimeoutFn(a),r.apply(this,d)};l.withError=!0,this.acks[e]=l}emitWithAck(e,...r){return new Promise((n,i)=>{const a=(l,d)=>l?i(l):n(d);a.withError=!0,r.push(a),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...a)=>(this._queue[0],i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Bt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Bt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Bt.EVENT:case Bt.BINARY_EVENT:this.onevent(e);break;case Bt.ACK:case Bt.BINARY_ACK:this.onack(e);break;case Bt.DISCONNECT:this.ondisconnect();break;case Bt.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...i){n||(n=!0,r.packet({type:Bt.ACK,id:e,data:i}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Bt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function ch(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ch.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};ch.prototype.reset=function(){this.attempts=0};ch.prototype.setMin=function(t){this.ms=t};ch.prototype.setMax=function(t){this.max=t};ch.prototype.setJitter=function(t){this.jitter=t};class Nj extends jn{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Zx(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ch({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const i=r.parser||iQ;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new FJ(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=ua(r,"open",function(){n.onopen(),e&&e()}),a=d=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",d),e?e(d):this.maybeReconnectOnOpen()},l=ua(r,"error",a);if(this._timeout!==!1){const d=this._timeout,u=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},d);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(i),this.subs.push(l),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ua(e,"ping",this.onping.bind(this)),ua(e,"data",this.ondata.bind(this)),ua(e,"error",this.onerror.bind(this)),ua(e,"close",this.onclose.bind(this)),ua(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){Qx(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new KP(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const cf={};function Bf(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=HJ(t,e.path||"/socket.io"),n=r.source,i=r.id,a=r.path,l=cf[i]&&a in cf[i].nsps,d=e.forceNew||e["force new connection"]||e.multiplex===!1||l;let u;return d?u=new Nj(n,e):(cf[i]||(cf[i]=new Nj(n,e)),u=cf[i]),r.query&&!e.query&&(e.query=r.queryKey),u.socket(r.path,e)}Object.assign(Bf,{Manager:Nj,Socket:KP,io:Bf,connect:Bf});var xu={},G1={exports:{}},V1,bA;function oQ(){if(bA)return V1;bA=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return V1=t,V1}var K1,vA;function lQ(){if(vA)return K1;vA=1;var t=oQ();function e(){}function r(){}return r.resetWarningCache=e,K1=function(){function n(l,d,u,h,p,m){if(m!==t){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},K1}var wA;function P4(){return wA||(wA=1,G1.exports=lQ()()),G1.exports}var Y1,jA;function YP(){return jA||(jA=1,Y1={L:1,M:0,Q:3,H:2}),Y1}var X1,NA;function XP(){return NA||(NA=1,X1={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),X1}var J1,kA;function cQ(){if(kA)return J1;kA=1;var t=XP();function e(r){this.mode=t.MODE_8BIT_BYTE,this.data=r}return e.prototype={getLength:function(r){return this.data.length},write:function(r){for(var n=0;n<this.data.length;n++)r.put(this.data.charCodeAt(n),8)}},J1=e,J1}var Q1,SA;function dQ(){if(SA)return Q1;SA=1;var t=YP();function e(r,n){this.totalCount=r,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(r,n){var i=e.getRsBlockTable(r,n);if(i==null)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+n);for(var a=i.length/3,l=new Array,d=0;d<a;d++)for(var u=i[d*3+0],h=i[d*3+1],p=i[d*3+2],m=0;m<u;m++)l.push(new e(h,p));return l},e.getRsBlockTable=function(r,n){switch(n){case t.L:return e.RS_BLOCK_TABLE[(r-1)*4+0];case t.M:return e.RS_BLOCK_TABLE[(r-1)*4+1];case t.Q:return e.RS_BLOCK_TABLE[(r-1)*4+2];case t.H:return e.RS_BLOCK_TABLE[(r-1)*4+3];default:return}},Q1=e,Q1}var Z1,_A;function uQ(){if(_A)return Z1;_A=1;function t(){this.buffer=new Array,this.length=0}return t.prototype={get:function(e){var r=Math.floor(e/8);return(this.buffer[r]>>>7-e%8&1)==1},put:function(e,r){for(var n=0;n<r;n++)this.putBit((e>>>r-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),e&&(this.buffer[r]|=128>>>this.length%8),this.length++}},Z1=t,Z1}var ew,CA;function JP(){if(CA)return ew;CA=1;for(var t={glog:function(r){if(r<1)throw new Error("glog("+r+")");return t.LOG_TABLE[r]},gexp:function(r){for(;r<0;)r+=255;for(;r>=256;)r-=255;return t.EXP_TABLE[r]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;e<255;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e;return ew=t,ew}var tw,EA;function QP(){if(EA)return tw;EA=1;var t=JP();function e(r,n){if(r.length==null)throw new Error(r.length+"/"+n);for(var i=0;i<r.length&&r[i]==0;)i++;this.num=new Array(r.length-i+n);for(var a=0;a<r.length-i;a++)this.num[a]=r[a+i]}return e.prototype={get:function(r){return this.num[r]},getLength:function(){return this.num.length},multiply:function(r){for(var n=new Array(this.getLength()+r.getLength()-1),i=0;i<this.getLength();i++)for(var a=0;a<r.getLength();a++)n[i+a]^=t.gexp(t.glog(this.get(i))+t.glog(r.get(a)));return new e(n,0)},mod:function(r){if(this.getLength()-r.getLength()<0)return this;for(var n=t.glog(this.get(0))-t.glog(r.get(0)),i=new Array(this.getLength()),a=0;a<this.getLength();a++)i[a]=this.get(a);for(var a=0;a<r.getLength();a++)i[a]^=t.gexp(t.glog(r.get(a))+n);return new e(i,0).mod(r)}},tw=e,tw}var rw,AA;function hQ(){if(AA)return rw;AA=1;var t=XP(),e=QP(),r=JP(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var l=a<<10;i.getBCHDigit(l)-i.getBCHDigit(i.G15)>=0;)l^=i.G15<<i.getBCHDigit(l)-i.getBCHDigit(i.G15);return(a<<10|l)^i.G15_MASK},getBCHTypeNumber:function(a){for(var l=a<<12;i.getBCHDigit(l)-i.getBCHDigit(i.G18)>=0;)l^=i.G18<<i.getBCHDigit(l)-i.getBCHDigit(i.G18);return a<<12|l},getBCHDigit:function(a){for(var l=0;a!=0;)l++,a>>>=1;return l},getPatternPosition:function(a){return i.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,l,d){switch(a){case n.PATTERN000:return(l+d)%2==0;case n.PATTERN001:return l%2==0;case n.PATTERN010:return d%3==0;case n.PATTERN011:return(l+d)%3==0;case n.PATTERN100:return(Math.floor(l/2)+Math.floor(d/3))%2==0;case n.PATTERN101:return l*d%2+l*d%3==0;case n.PATTERN110:return(l*d%2+l*d%3)%2==0;case n.PATTERN111:return(l*d%3+(l+d)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var l=new e([1],0),d=0;d<a;d++)l=l.multiply(new e([1,r.gexp(d)],0));return l},getLengthInBits:function(a,l){if(1<=l&&l<10)switch(a){case t.MODE_NUMBER:return 10;case t.MODE_ALPHA_NUM:return 9;case t.MODE_8BIT_BYTE:return 8;case t.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(l<27)switch(a){case t.MODE_NUMBER:return 12;case t.MODE_ALPHA_NUM:return 11;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else if(l<41)switch(a){case t.MODE_NUMBER:return 14;case t.MODE_ALPHA_NUM:return 13;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}else throw new Error("type:"+l)},getLostPoint:function(a){for(var l=a.getModuleCount(),d=0,u=0;u<l;u++)for(var h=0;h<l;h++){for(var p=0,m=a.isDark(u,h),x=-1;x<=1;x++)if(!(u+x<0||l<=u+x))for(var b=-1;b<=1;b++)h+b<0||l<=h+b||x==0&&b==0||m==a.isDark(u+x,h+b)&&p++;p>5&&(d+=3+p-5)}for(var u=0;u<l-1;u++)for(var h=0;h<l-1;h++){var v=0;a.isDark(u,h)&&v++,a.isDark(u+1,h)&&v++,a.isDark(u,h+1)&&v++,a.isDark(u+1,h+1)&&v++,(v==0||v==4)&&(d+=3)}for(var u=0;u<l;u++)for(var h=0;h<l-6;h++)a.isDark(u,h)&&!a.isDark(u,h+1)&&a.isDark(u,h+2)&&a.isDark(u,h+3)&&a.isDark(u,h+4)&&!a.isDark(u,h+5)&&a.isDark(u,h+6)&&(d+=40);for(var h=0;h<l;h++)for(var u=0;u<l-6;u++)a.isDark(u,h)&&!a.isDark(u+1,h)&&a.isDark(u+2,h)&&a.isDark(u+3,h)&&a.isDark(u+4,h)&&!a.isDark(u+5,h)&&a.isDark(u+6,h)&&(d+=40);for(var w=0,h=0;h<l;h++)for(var u=0;u<l;u++)a.isDark(u,h)&&w++;var k=Math.abs(100*w/l/l-50)/5;return d+=k*10,d}};return rw=i,rw}var nw,TA;function fQ(){if(TA)return nw;TA=1;var t=cQ(),e=dQ(),r=uQ(),n=hQ(),i=QP();function a(d,u){this.typeNumber=d,this.errorCorrectLevel=u,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var l=a.prototype;return l.addData=function(d){var u=new t(d);this.dataList.push(u),this.dataCache=null},l.isDark=function(d,u){if(d<0||this.moduleCount<=d||u<0||this.moduleCount<=u)throw new Error(d+","+u);return this.modules[d][u]},l.getModuleCount=function(){return this.moduleCount},l.make=function(){if(this.typeNumber<1){var d=1;for(d=1;d<40;d++){for(var u=e.getRSBlocks(d,this.errorCorrectLevel),h=new r,p=0,m=0;m<u.length;m++)p+=u[m].dataCount;for(var m=0;m<this.dataList.length;m++){var x=this.dataList[m];h.put(x.mode,4),h.put(x.getLength(),n.getLengthInBits(x.mode,d)),x.write(h)}if(h.getLengthInBits()<=p*8)break}this.typeNumber=d}this.makeImpl(!1,this.getBestMaskPattern())},l.makeImpl=function(d,u){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var h=0;h<this.moduleCount;h++){this.modules[h]=new Array(this.moduleCount);for(var p=0;p<this.moduleCount;p++)this.modules[h][p]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(d,u),this.typeNumber>=7&&this.setupTypeNumber(d),this.dataCache==null&&(this.dataCache=a.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,u)},l.setupPositionProbePattern=function(d,u){for(var h=-1;h<=7;h++)if(!(d+h<=-1||this.moduleCount<=d+h))for(var p=-1;p<=7;p++)u+p<=-1||this.moduleCount<=u+p||(0<=h&&h<=6&&(p==0||p==6)||0<=p&&p<=6&&(h==0||h==6)||2<=h&&h<=4&&2<=p&&p<=4?this.modules[d+h][u+p]=!0:this.modules[d+h][u+p]=!1)},l.getBestMaskPattern=function(){for(var d=0,u=0,h=0;h<8;h++){this.makeImpl(!0,h);var p=n.getLostPoint(this);(h==0||d>p)&&(d=p,u=h)}return u},l.createMovieClip=function(d,u,h){var p=d.createEmptyMovieClip(u,h),m=1;this.make();for(var x=0;x<this.modules.length;x++)for(var b=x*m,v=0;v<this.modules[x].length;v++){var w=v*m,k=this.modules[x][v];k&&(p.beginFill(0,100),p.moveTo(w,b),p.lineTo(w+m,b),p.lineTo(w+m,b+m),p.lineTo(w,b+m),p.endFill())}return p},l.setupTimingPattern=function(){for(var d=8;d<this.moduleCount-8;d++)this.modules[d][6]==null&&(this.modules[d][6]=d%2==0);for(var u=8;u<this.moduleCount-8;u++)this.modules[6][u]==null&&(this.modules[6][u]=u%2==0)},l.setupPositionAdjustPattern=function(){for(var d=n.getPatternPosition(this.typeNumber),u=0;u<d.length;u++)for(var h=0;h<d.length;h++){var p=d[u],m=d[h];if(this.modules[p][m]==null)for(var x=-2;x<=2;x++)for(var b=-2;b<=2;b++)x==-2||x==2||b==-2||b==2||x==0&&b==0?this.modules[p+x][m+b]=!0:this.modules[p+x][m+b]=!1}},l.setupTypeNumber=function(d){for(var u=n.getBCHTypeNumber(this.typeNumber),h=0;h<18;h++){var p=!d&&(u>>h&1)==1;this.modules[Math.floor(h/3)][h%3+this.moduleCount-8-3]=p}for(var h=0;h<18;h++){var p=!d&&(u>>h&1)==1;this.modules[h%3+this.moduleCount-8-3][Math.floor(h/3)]=p}},l.setupTypeInfo=function(d,u){for(var h=this.errorCorrectLevel<<3|u,p=n.getBCHTypeInfo(h),m=0;m<15;m++){var x=!d&&(p>>m&1)==1;m<6?this.modules[m][8]=x:m<8?this.modules[m+1][8]=x:this.modules[this.moduleCount-15+m][8]=x}for(var m=0;m<15;m++){var x=!d&&(p>>m&1)==1;m<8?this.modules[8][this.moduleCount-m-1]=x:m<9?this.modules[8][15-m-1+1]=x:this.modules[8][15-m-1]=x}this.modules[this.moduleCount-8][8]=!d},l.mapData=function(d,u){for(var h=-1,p=this.moduleCount-1,m=7,x=0,b=this.moduleCount-1;b>0;b-=2)for(b==6&&b--;;){for(var v=0;v<2;v++)if(this.modules[p][b-v]==null){var w=!1;x<d.length&&(w=(d[x]>>>m&1)==1);var k=n.getMask(u,p,b-v);k&&(w=!w),this.modules[p][b-v]=w,m--,m==-1&&(x++,m=7)}if(p+=h,p<0||this.moduleCount<=p){p-=h,h=-h;break}}},a.PAD0=236,a.PAD1=17,a.createData=function(d,u,h){for(var p=e.getRSBlocks(d,u),m=new r,x=0;x<h.length;x++){var b=h[x];m.put(b.mode,4),m.put(b.getLength(),n.getLengthInBits(b.mode,d)),b.write(m)}for(var v=0,x=0;x<p.length;x++)v+=p[x].dataCount;if(m.getLengthInBits()>v*8)throw new Error("code length overflow. ("+m.getLengthInBits()+">"+v*8+")");for(m.getLengthInBits()+4<=v*8&&m.put(0,4);m.getLengthInBits()%8!=0;)m.putBit(!1);for(;!(m.getLengthInBits()>=v*8||(m.put(a.PAD0,8),m.getLengthInBits()>=v*8));)m.put(a.PAD1,8);return a.createBytes(m,p)},a.createBytes=function(d,u){for(var h=0,p=0,m=0,x=new Array(u.length),b=new Array(u.length),v=0;v<u.length;v++){var w=u[v].dataCount,k=u[v].totalCount-w;p=Math.max(p,w),m=Math.max(m,k),x[v]=new Array(w);for(var _=0;_<x[v].length;_++)x[v][_]=255&d.buffer[_+h];h+=w;var T=n.getErrorCorrectPolynomial(k),A=new i(x[v],T.getLength()-1),I=A.mod(T);b[v]=new Array(T.getLength()-1);for(var _=0;_<b[v].length;_++){var O=_+I.getLength()-b[v].length;b[v][_]=O>=0?I.get(O):0}}for(var M=0,_=0;_<u.length;_++)M+=u[_].totalCount;for(var E=new Array(M),R=0,_=0;_<p;_++)for(var v=0;v<u.length;v++)_<x[v].length&&(E[R++]=x[v][_]);for(var _=0;_<m;_++)for(var v=0;v<u.length;v++)_<b[v].length&&(E[R++]=b[v][_]);return E},nw=a,nw}var Em={},OA;function pQ(){if(OA)return Em;OA=1,Object.defineProperty(Em,"__esModule",{value:!0});var t=Object.assign||function(h){for(var p=1;p<arguments.length;p++){var m=arguments[p];for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(h[x]=m[x])}return h},e=P4(),r=a(e),n=al(),i=a(n);function a(h){return h&&h.__esModule?h:{default:h}}function l(h,p){var m={};for(var x in h)p.indexOf(x)>=0||Object.prototype.hasOwnProperty.call(h,x)&&(m[x]=h[x]);return m}var d={bgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,bgD:r.default.string.isRequired,fgColor:r.default.oneOfType([r.default.object,r.default.string]).isRequired,fgD:r.default.string.isRequired,size:r.default.number.isRequired,title:r.default.string,viewBoxSize:r.default.number.isRequired,xmlns:r.default.string},u=(0,n.forwardRef)(function(h,p){var m=h.bgColor,x=h.bgD,b=h.fgD,v=h.fgColor,w=h.size,k=h.title,_=h.viewBoxSize,T=h.xmlns,A=T===void 0?"http://www.w3.org/2000/svg":T,I=l(h,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",t({},I,{height:w,ref:p,viewBox:"0 0 "+_+" "+_,width:w,xmlns:A}),k?i.default.createElement("title",null,k):null,i.default.createElement("path",{d:x,fill:m}),i.default.createElement("path",{d:b,fill:v}))});return u.displayName="QRCodeSvg",u.propTypes=d,Em.default=u,Em}var MA;function mQ(){if(MA)return xu;MA=1,Object.defineProperty(xu,"__esModule",{value:!0}),xu.QRCode=void 0;var t=Object.assign||function(w){for(var k=1;k<arguments.length;k++){var _=arguments[k];for(var T in _)Object.prototype.hasOwnProperty.call(_,T)&&(w[T]=_[T])}return w},e=P4(),r=m(e),n=YP(),i=m(n),a=fQ(),l=m(a),d=al(),u=m(d),h=pQ(),p=m(h);function m(w){return w&&w.__esModule?w:{default:w}}function x(w,k){var _={};for(var T in w)k.indexOf(T)>=0||Object.prototype.hasOwnProperty.call(w,T)&&(_[T]=w[T]);return _}var b={bgColor:r.default.oneOfType([r.default.object,r.default.string]),fgColor:r.default.oneOfType([r.default.object,r.default.string]),level:r.default.string,size:r.default.number,value:r.default.string.isRequired},v=(0,d.forwardRef)(function(w,k){var _=w.bgColor,T=_===void 0?"#FFFFFF":_,A=w.fgColor,I=A===void 0?"#000000":A,O=w.level,M=O===void 0?"L":O,E=w.size,R=E===void 0?256:E,$=w.value,B=x(w,["bgColor","fgColor","level","size","value"]),C=new l.default(-1,i.default[M]);C.addData($),C.make();var U=C.modules;return u.default.createElement(p.default,t({},B,{bgColor:T,bgD:U.map(function(L,q){return L.map(function(K,W){return K?"":"M "+W+" "+q+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:I,fgD:U.map(function(L,q){return L.map(function(K,W){return K?"M "+W+" "+q+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:k,size:R,viewBoxSize:U.length}))});return xu.QRCode=v,v.displayName="QRCode",v.propTypes=b,xu.default=v,xu}var gQ=mQ();const ZP=Ms(gQ),xQ=()=>{const[t,e]=y.useState([]);return y.useEffect(()=>{const r=console.log,n=console.warn,i=console.error,a=(l,d)=>{const u=d.map(h=>typeof h=="object"?JSON.stringify(h):String(h)).join(" ");e(h=>[`[${l}] ${u}`,...h].slice(0,8))};return console.log=(...l)=>{r(...l),a("LOG",l)},console.warn=(...l)=>{n(...l),a("WARN",l)},console.error=(...l)=>{i(...l),a("ERR",l)},()=>{console.log=r,console.warn=n,console.error=i}},[]),s.jsx("div",{className:"absolute top-24 left-4 right-4 h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border border-green-500/20 rounded-xl backdrop-blur-md",children:t.map((r,n)=>s.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5 break-all",children:r},n))})},ey=({isOpen:t,onClose:e,onFinish:r,mode:n="collection"})=>{const{addToast:i}=_r(),{userProfile:a,currentUser:l}=Mt(),d=Yt(a?.subscription_tier),[u,h]=y.useState("scanning"),[p,m]=y.useState(window.innerWidth>768),x=y.useRef(null),b=y.useRef(null),v=y.useRef(null),[w,k]=y.useState(null),[_,T]=y.useState(!1),[A,I]=y.useState(!1),[O,M]=y.useState([]),[E,R]=y.useState(null),[$,B]=y.useState(!1),[C]=y.useState(()=>Math.random().toString(36).substr(2,9)),[U,L]=y.useState(!1),[q,K]=y.useState("nonfoil"),[W,V]=y.useState(null),[X,Z]=y.useState("new"),[G,F]=y.useState([]),[Y,ne]=y.useState(!1);y.useEffect(()=>{t&&l&&Pe.get("/api/decks").then(F).catch(console.error)},[t,l]);const[re,ue]=y.useState(!1),[Le,de]=y.useState({name:null,footer:null});y.useEffect(()=>{let pe=null;return t&&(async()=>{try{if(!$){console.log("[OCR] Initializing Tesseract Worker...");const Ie=await OP.createWorker("eng",1,{logger:Fe=>console.log(Fe),workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),pe=Ie,k(Ie),I(!0)}}catch(Ie){console.error("OCR Worker Init Failed",Ie||"Unknown Error"),i("Failed to initialize OCR engine. Check console.","error")}})(),()=>{pe&&pe.terminate()}},[t,$]),y.useEffect(()=>{if(!t)return;const pe=Bf();return pe.emit("join-pairing",C),pe.on("remote-card",me=>{console.log("Card received from remote:",me.name),M(Ie=>[...Ie,me]),R({success:!0,name:me.name}),L(!0),setTimeout(()=>R(null),2e3)}),()=>pe.disconnect()},[t,C]),y.useEffect(()=>{const pe=()=>m(window.innerWidth>768);return window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const ve=async pe=>{if(!(!A||_)){console.log("[ForgeLens] Processing new image source..."),T(!0);try{if(!pe){console.warn("[ForgeLens] No image source provided.");return}const me=new Image;me.src=pe,await new Promise(Fe=>me.onload=Fe),console.log(`[ForgeLens] Image loaded: ${me.width}x${me.height}`);const Ie=await oe(me);console.log("[ForgeLens] Region extraction complete:",Ie),await Ee(Ie)}catch(me){console.error("[ForgeLens] Processing error",me),R({error:"Processing failed. Invalid image format?"})}finally{T(!1),setTimeout(()=>R(null),3e3)}}},te=async()=>{if(!x.current)return;const pe=x.current.getScreenshot();await ve(pe)},ge=async pe=>{const me=pe.target.files?.[0];if(!me)return;const Ie=new FileReader;Ie.onload=async Fe=>{const qe=Fe.target.result;await ve(qe),pe.target.value=""},Ie.readAsDataURL(me)},ke=y.useCallback((pe,me,Ie)=>{const Fe={id:Math.random().toString(36).substr(2,9),scryfall_id:pe.scryfall_id||pe.uuid,name:pe.name,set_name:pe.set_name||pe.setcode,set_code:pe.set||pe.setcode,collector_number:pe.collector_number||pe.number,image:pe.image_uri||pe.image_uris?.small||pe.card_faces?.[0]?.image_uris?.small,finish:q,quantity:1,data:pe,variants:me,raw_ocr:Ie,is_wishlist:!1};M(qe=>d.features.batchScan?[...qe,Fe]:[Fe]),R({success:!0,name:pe.name})},[d.features.batchScan,q]),oe=async pe=>{const me=b.current,Ie=me.getContext("2d",{willReadFrequently:!0}),Fe=async(yt,Et,ot,ae)=>{let Be=250/ae;Be=Math.max(.1,Math.min(Be,4));let Qe=Math.floor(ot*Be),et=Math.floor(ae*Be);Qe>4e3&&(Be=4e3/ot,Qe=4e3,et=Math.floor(ae*Be)),console.log(`[ForgeLens] OCR Crop: ${Qe}x${et} (Src: ${Math.floor(ot)}x${Math.floor(ae)}, Scale: ${Be.toFixed(2)})`),me.width=Qe,me.height=et,Ie.imageSmoothingEnabled=!0,Ie.imageSmoothingQuality="high",Ie.drawImage(pe,yt,Et,ot,ae,0,0,Qe,et);const bt=Ie.getImageData(0,0,me.width,me.height),Ve=bt.data;for(let We=0;We<Ve.length;We+=4){const vt=(Ve[We]+Ve[We+1]+Ve[We+2])/3;Ve[We]=Ve[We+1]=Ve[We+2]=vt}Ie.putImageData(bt,0,0);const{data:{text:Je}}=await w.recognize(me),pt=Je.split(`
`).map(We=>We.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(We=>We.length>=1),he=me.toDataURL("image/png");return{lines:pt,preview:he}},qe=pe.width,Xe=pe.height,He=Math.min(qe,Xe),ut=(qe-He)/2,Tt=(Xe-He)/2;console.log(`[ForgeLens] Precision Mode: ${qe}x${Xe}, Crop: ${He}x${He} @ (${ut}, ${Tt})`);const Ut=await Fe(ut+He*.1,Tt+He*.35,He*.8,He*.3);de({footer:Ut.preview});let nt="",kt="";const mt=Ut.lines.join(" ").toUpperCase();console.log(`[ForgeLens] Raw Scan: "${mt}"`);const it=(mt.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(yt=>!/^(19|20)\d{2}$/.test(yt));it.length>0&&(kt=it[0]);const jt=mt.match(/\b[A-Z0-9]{3,4}\b/g);if(jt){const yt=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],Et=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],ot=jt.find(ae=>!Et.includes(ae)&&!yt.includes(ae)&&!/^\d+$/.test(ae));ot&&(nt=ot)}return{name:"",set:nt,cn:kt,raw_footer:mt}},Ee=async({name:pe,set:me,cn:Ie,raw_footer:Fe})=>{if(console.log(`[ForgeLens] Resolving: Name="${pe}", Set="${me}", CN="${Ie}" (Footer: "${Fe}")`),me&&Ie){console.log(`[ForgeLens] Attempting Set/CN match: ${me} #${Ie}`);try{const qe=await Pe.post("/api/cards/search",{set:me,cn:Ie});if(qe.data&&qe.data.length>0){const Xe=qe.data[0];console.log(`[ForgeLens] Match found by Set/CN: ${Xe.name}`);const He=qe.data.length>1?qe.data:[Xe];ke(Xe,He,{name:pe,set:me,cn:Ie});return}else{R({error:`Not Found: ${me} #${Ie}`,raw:Fe});return}}catch(qe){console.warn("[ForgeLens] Set/CN search failed",qe)}}if(!pe||pe.length<3){R({error:"Try scanning Set Code & Number again.",raw:Fe});return}console.log(`[ForgeLens] Attempting Name search: "${pe}"`);try{const Xe=(await Pe.post("/api/cards/search",{query:pe})).data||[];if(Xe.length>0){const He=Xe[0],ut=Xe.length>1?Xe:[He];ke(He,ut,{name:pe,set:me,cn:Ie});return}else{console.log(`[ForgeLens] No direct match for "${pe}". Trying fuzzy fallback...`);const He=pe.split(/\s+/).filter(Tt=>Tt.length>3);let ut=null;if(He.length>0&&He[0].length<pe.length?ut=He[0]:pe.length>8&&(ut=pe.substring(0,8)),ut){console.log(`[ForgeLens] Fuzzy fallback attempt with: "${ut}"`);const Tt=await Pe.post("/api/cards/search",{query:ut});if(Tt.data?.length>0){const Ut=Tt.data[0];console.log(`[ForgeLens] Fuzzy match found: "${Ut.name}"`);const nt=pe.toLowerCase().includes(Ut.name.toLowerCase()),kt=Ut.name.toLowerCase().includes(ut.toLowerCase());if(nt||kt){console.log(`[ForgeLens] Fallback match accepted: "${Ut.name}"`);const mt=Tt.data.length>1?Tt.data:[Ut];ke(Ut,mt,{name:pe,set:me,cn:Ie});return}}}R({error:`Not found: ${pe}`})}}catch(qe){console.error("[ForgeLens] Resolution failed",qe),R({error:"Search failed"})}},Te=pe=>{M(me=>me.filter(Ie=>Ie.id!==pe))},Ye=(pe,me)=>{M(Ie=>Ie.map(Fe=>Fe.id===pe?{...Fe,...me}:Fe))},ze=(pe,me)=>{M(Ie=>Ie.map(Fe=>{if(Fe.id===pe){const qe=Fe.variants.find(Xe=>Xe.id===me);if(qe)return{...Fe,scryfall_id:qe.id,set_name:qe.set_name,set_code:qe.set,collector_number:qe.collector_number,image:qe.image_uris?.small||qe.card_faces?.[0]?.image_uris?.small,data:qe}}return Fe}))},le=()=>{r&&r(O,{targetDeckId:W,additionMode:X,defaultFinish:q}),e()};return t?ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/95 backdrop-blur-md p-0 md:p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 w-full h-full md:max-w-5xl md:max-h-[85vh] md:rounded-3xl shadow-2xl flex flex-col border border-white/10 overflow-hidden relative",children:[s.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center pointer-events-none opacity-[0.05] saturate-[1.2] brightness-125",children:s.jsx("img",{src:"/icons/forge_lense.png",alt:"",className:"w-[60%] h-[60%] object-contain"})}),s.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-[1010] p-2 bg-black/50 text-white rounded-full hover:bg-red-500/50 transition-all",children:s.jsx(Yf,{className:"w-6 h-6"})}),s.jsxs("div",{className:"px-4 py-4 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[s.jsx("div",{className:"flex items-center gap-4 w-full md:w-auto",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-black text-white tracking-tight italic uppercase",children:"Forge Lens"}),s.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest leading-none",children:"AI Card Scanner"})]})}),s.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>h("scanning"),className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${u==="scanning"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:"Scan"}),s.jsxs("button",{onClick:()=>{d.features.batchScan||O.length<=1?h("review"):i("Batch Review is a Magician+ feature. Upgrade to review all at once!","info")},className:`px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all relative ${u==="review"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 text-gray-400"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[!d.features.batchScan&&s.jsx(FX,{className:"w-3 h-3 text-orange-400"}),"Review"]}),O.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center animate-bounce",children:O.length})]})]}),s.jsxs("button",{onClick:()=>B(!$),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${$?"bg-indigo-600/20 text-indigo-400 border border-indigo-500/30":"bg-gray-800 text-gray-400"}`,title:"Remote Camera",children:[s.jsx(RP,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:$?"Remote Lens Active":"Use Remote Camera"})]}),s.jsxs("button",{onClick:()=>ue(!re),className:`flex items-center gap-2 px-3 md:px-4 py-2 md:py-1.5 rounded-full text-xs font-bold transition-all ${re?"bg-orange-600/20 text-orange-400 border border-orange-500/30":"bg-gray-800 text-gray-400"}`,title:"Debug Regions",children:[s.jsx(z1,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:"Debug Regions"})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[u==="scanning"&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 relative",children:[p&&!$&&s.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-20 w-fit",children:s.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-500 px-4 py-2 rounded-2xl flex items-center gap-2 text-xs shadow-xl backdrop-blur-md animate-pulse",children:[s.jsx(z1,{className:"w-4 h-4"}),s.jsx("span",{children:"Desktop detected. For best focus, use the mobile app."})]})}),$?s.jsxs("div",{className:"flex flex-col items-center gap-6 animate-in fade-in zoom-in duration-500 bg-black/40 p-12 rounded-[3rem] border border-white/5 backdrop-blur-xl shadow-2xl",children:[s.jsx("div",{className:"bg-white p-6 rounded-[2rem] shadow-[0_0_50px_rgba(255,255,255,0.1)] ring-8 ring-white/5",children:s.jsx(ZP,{value:`${window.location.origin}/remote/${C}`,size:220,level:"H"})}),s.jsxs("div",{className:"text-center max-w-xs",children:[s.jsx("h3",{className:"text-xl font-black text-white mb-2 italic uppercase",children:"Remote Scan Mode"}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] leading-relaxed",children:"Scan this QR on your phone to link your camera. Direct sync is active."})]}),s.jsxs("div",{className:`flex items-center gap-2 px-5 py-2.5 rounded-full text-[10px] font-black uppercase border transition-all duration-500 ${U?"bg-green-500/10 text-green-400 border-green-500/30 shadow-[0_0_20px_rgba(34,197,94,0.1)]":"bg-orange-500/10 text-orange-400 border-orange-500/30"}`,children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${U?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,1)]":"bg-orange-500 border border-orange-300 animate-pulse"}`}),U?"Remote Link Established":"Waiting for Remote Link..."]})]}):s.jsxs("div",{className:"relative w-full max-w-sm aspect-[3/4] rounded-3xl overflow-hidden border-2 border-dashed border-white/20 shadow-2xl bg-black group transition-all",children:[s.jsx(CP,{ref:x,audio:!1,screenshotFormat:"image/webp",videoConstraints:{width:1280,height:720,facingMode:"environment"},className:"w-full h-full object-cover grayscale brightness-110 contrast-125"}),s.jsx("div",{className:"absolute inset-0 pointer-events-none flex flex-col items-center justify-center",children:s.jsxs("div",{className:"w-[80%] h-[30%] border-2 border-white/10 rounded-2xl relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),s.jsx("div",{className:"absolute -bottom-16 left-1/2 -translate-x-1/2 w-[120%] text-center",children:A?_?s.jsx("div",{className:"bg-indigo-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg animate-pulse uppercase font-black",children:"Analyzing Image..."}):E?.success?s.jsxs("div",{className:"bg-green-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black flex items-center gap-2",children:[s.jsx(lc,{className:"w-3 h-3"})," Found: ",E.name]}):E?.error?s.jsx("div",{className:"bg-red-600 text-white text-[10px] px-4 py-1.5 rounded-full shadow-lg uppercase font-black",children:E.error}):s.jsx("p",{className:"text-white/60 text-[10px] px-3 py-1 bg-black/40 rounded-full backdrop-blur-sm",children:"Align Set Code & Number"}):s.jsxs("div",{className:"bg-black/80 text-white text-[10px] px-3 py-1 rounded-full border border-white/10 flex items-center gap-2",children:[s.jsx(gj,{className:"w-3 h-3 animate-spin"})," Wake up AI engine..."]})})]})})]}),s.jsxs("div",{className:"mt-8 flex items-center gap-6",children:[!$&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:te,disabled:_||!A,className:"w-20 h-20 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-800 disabled:text-gray-600 text-white rounded-full flex items-center justify-center shadow-2xl shadow-indigo-500/30 transition-all active:scale-90 relative group ring-4 ring-white/5",children:[_?s.jsx(gj,{className:"w-8 h-8 animate-spin"}):s.jsx(LP,{className:"w-8 h-8"}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-500 group-hover:text-indigo-400 transition-colors",children:"Capture Card"})]}),re&&Le.footer&&s.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-black/40 rounded-2xl border border-orange-500/20 max-w-[200px]",children:[s.jsxs("div",{className:"text-[10px] font-black uppercase text-orange-400 tracking-widest flex items-center gap-2",children:[s.jsx(z1,{className:"w-3 h-3"})," ROI Crops"]}),s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:Le.footer,className:"h-8 w-full object-contain bg-white rounded border border-white/10",alt:"Footer"}),s.jsx("div",{className:"absolute top-0 right-0 bg-black/60 text-white text-[8px] px-1 rounded-bl",children:"Footer"})]}),E?.error&&s.jsx("div",{className:"mt-2 pt-2 border-t border-white/10",children:s.jsxs("p",{className:"text-[8px] text-gray-400 font-mono break-all leading-tight",children:["RAW: ",E.raw||"---"]})})]}),s.jsxs("button",{onClick:()=>v.current?.click(),disabled:_||!A,className:"w-14 h-14 bg-gray-800 hover:bg-gray-700 disabled:text-gray-600 text-gray-400 rounded-2xl flex items-center justify-center border border-white/5 transition-all active:scale-90 relative group",title:"Upload Image",children:[s.jsx(tJ,{className:"w-6 h-6"}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest text-gray-600 group-hover:text-indigo-400 transition-colors",children:"Upload File"})]}),s.jsxs("button",{onClick:()=>K(q==="foil"?"nonfoil":"foil"),className:`w-14 h-14 rounded-2xl flex flex-col items-center justify-center border transition-all active:scale-95 group relative ${q==="foil"?"bg-yellow-500/10 border-yellow-500/50 text-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"bg-gray-800 border-white/5 text-gray-500 hover:text-gray-300"}`,children:[s.jsx("span",{className:`text-xl transition-transform ${q==="foil"?"scale-110":"scale-90 grayscale"}`,children:""}),s.jsx("span",{className:"absolute -bottom-10 whitespace-nowrap text-[10px] font-black uppercase tracking-widest group-hover:text-indigo-400 transition-colors",children:q==="foil"?"Foil":"Normal"})]})]}),s.jsx("input",{type:"file",ref:v,onChange:ge,accept:"image/*",className:"hidden"}),re&&s.jsx(xQ,{})]})]}),u==="review"&&s.jsx("div",{className:"h-full flex flex-col bg-gray-950/50",children:O.length===0?s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-3xl flex items-center justify-center text-gray-600 mb-4",children:s.jsx($X,{className:"w-10 h-10"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Cards Scanned"}),s.jsx("p",{className:"text-gray-500 text-sm max-w-xs",children:"Return to the scan view and aim your camera at a card to get started."}),s.jsx("button",{onClick:()=>h("scanning"),className:"mt-6 px-6 py-2 bg-indigo-600 text-white rounded-xl font-bold",children:"Go Back to Scan"})]}):s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0 md:p-6",children:s.jsxs("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[s.jsx("thead",{className:"hidden md:table-header-group",children:s.jsxs("tr",{className:"text-[10px] uppercase font-bold tracking-[0.2em] text-gray-500",children:[s.jsx("th",{className:"px-6 py-2",children:"Card Detail"}),s.jsx("th",{className:"px-6 py-2",children:"Set / #"}),s.jsx("th",{className:"px-6 py-2",children:"Finish"}),s.jsx("th",{className:"px-6 py-2",children:"Qty"}),s.jsx("th",{className:"px-6 py-2 text-right",children:"Action"})]})}),s.jsx("tbody",{className:"space-y-4",children:O.map(pe=>s.jsxs("tr",{className:"bg-gray-900 border border-white/5 md:border-none rounded-2xl md:rounded-none group hover:bg-white/5 transition-colors",children:[s.jsxs("td",{className:"px-4 py-3 md:px-6 md:py-4 flex items-center gap-4",children:[s.jsx("img",{src:pe.image,className:"w-12 h-16 object-cover rounded shadow-lg",alt:pe.name}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-white leading-tight",children:pe.name}),s.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5",children:pe.set_name})]})]}),s.jsx("td",{className:"hidden md:table-cell px-6 py-4",children:s.jsxs("div",{className:"flex flex-col max-w-[200px]",children:[s.jsxs("select",{value:pe.scryfall_id,onChange:me=>ze(pe.id,me.target.value),className:"bg-gray-800 border border-white/10 rounded-lg px-2 py-1 text-xs text-white outline-none focus:ring-1 focus:ring-indigo-500 truncate",children:[pe.variants?.map(me=>s.jsxs("option",{value:me.id,children:[me.set.toUpperCase()," #",me.collector_number," (",me.set_name,")"]},me.id)),!pe.variants?.length&&s.jsxs("option",{value:pe.scryfall_id,children:[pe.set_code.toUpperCase()," #",pe.collector_number]})]}),s.jsx("span",{className:"text-[9px] text-gray-600 mt-1 uppercase tracking-tighter",children:"Tap to change version"})]})}),s.jsx("td",{className:"px-4 md:px-6 py-4",children:s.jsx("button",{onClick:()=>Ye(pe.id,{finish:pe.finish==="foil"?"nonfoil":"foil"}),className:`text-[10px] px-2 py-1 rounded border transition-all ${pe.finish==="foil"?"bg-yellow-500/10 border-yellow-500/50 text-yellow-500 font-bold shadow-[0_0_10px_rgba(234,179,8,0.2)]":"bg-gray-800 border-white/5 text-gray-500"}`,children:pe.finish==="foil"?" FOIL":"NON-FOIL"})}),s.jsx("td",{className:"px-4 md:px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>Ye(pe.id,{quantity:Math.max(1,pe.quantity-1)}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"-"}),s.jsx("span",{className:"text-sm font-bold text-white w-4 text-center",children:pe.quantity}),s.jsx("button",{onClick:()=>Ye(pe.id,{quantity:pe.quantity+1}),className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center text-gray-400 hover:text-white",children:"+"})]})}),s.jsx("td",{className:"px-4 md:px-6 py-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>Ye(pe.id,{is_wishlist:!pe.is_wishlist}),className:`p-1.5 rounded-lg transition-all ${pe.is_wishlist?"bg-red-500/10 text-red-500":"bg-gray-800/50 text-gray-500 hover:text-red-400"}`,children:s.jsx(DX,{className:`w-4 h-4 ${pe.is_wishlist?"fill-current":""}`})}),s.jsx("button",{onClick:()=>Te(pe.id),className:"p-1.5 text-gray-600 hover:text-red-500 transition-colors",children:s.jsx(ZX,{className:"w-4 h-4"})})]})})]},pe.id))})]})})})]}),s.jsxs("div",{className:"p-6 border-t border-white/5 bg-gray-900/80 flex justify-between items-center relative z-10",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[s.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-[0.2em] whitespace-nowrap",children:[O.length," Cards in Batch"]}),s.jsx("div",{className:"h-4 w-px bg-white/10 hidden md:block"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 bg-gray-800/50 p-1 rounded-lg border border-white/5",children:[s.jsx("button",{onClick:()=>Z("new"),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${X==="new"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"New"}),s.jsx("button",{onClick:()=>Z("transfer"),className:`px-3 py-1 rounded-md text-[10px] font-black uppercase transition-all ${X==="transfer"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Transfer"})]}),s.jsxs("select",{value:W||"",onChange:pe=>V(pe.target.value||null),className:"bg-gray-800 border border-white/10 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:ring-1 focus:ring-indigo-500 max-w-[150px] md:max-w-[200px]",children:[s.jsx("option",{value:"",children:"No Deck (Binder)"}),s.jsx("optgroup",{label:"My Decks",children:G.map(pe=>s.jsx("option",{value:pe.id,children:pe.name},pe.id))})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[O.length>0&&u==="scanning"&&s.jsx("button",{onClick:()=>h("review"),className:"px-6 py-2 text-gray-400 hover:text-white font-bold text-xs",children:"Review All"}),s.jsxs("button",{onClick:le,disabled:O.length===0,className:`px-10 py-3 rounded-2xl font-black text-sm transition-all shadow-xl active:scale-95 flex items-center gap-2 ${O.length>0?"bg-indigo-600 text-white shadow-indigo-900/40":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:[s.jsx(lc,{className:"w-4 h-4"})," ",n==="audit"?"Apply to Audit":"Add to Collection"]})]})]}),s.jsx("canvas",{ref:b,style:{display:"none"}})]})}),document.body):null},yQ=()=>{const t=yi(),{currentUser:e,userProfile:r,logout:n,updateSettings:i,refreshUserProfile:a,uploadProfilePicture:l}=Mt(),{addToast:d}=_r(),u=t.pathname==="/",[h,p]=y.useState(!1),[m,x]=y.useState(!1),[b,v]=y.useState(!1),[w,k]=y.useState(!1),[_,T]=y.useState(!1),[A,I]=y.useState(!1),[O,M]=y.useState(!1),E=Ge.useRef(null);Ge.useEffect(()=>{const V=X=>{A&&!X.target.closest("#user-menu-button")&&!X.target.closest("#user-menu-dropdown")&&I(!1)};return document.addEventListener("mousedown",V),()=>document.removeEventListener("mousedown",V)},[A]);const R=async V=>{console.log("Saving new playstyle:",V),await i({playstyle:V}),await a(),k(!0)},$=async V=>{const X=V.target.files[0];if(X){console.log("[Navbar] Starting file upload:",X.name,X.size,X.type);try{M(!0),console.log("[Navbar] Calling uploadProfilePicture...");const Z=await l(X);console.log("[Navbar] Upload successful! Photo URL:",Z),alert("Profile picture updated successfully!")}catch(Z){console.error("[Navbar] Upload failed:",Z),alert(`Upload failed: ${Z.message}`)}finally{console.log("[Navbar] Upload complete, resetting state"),M(!1),I(!1)}}},B=()=>{E.current?.click()},C=e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",U=C?"FORGE MASTER":e?.email||"";let L=null;const q=r?.subscription_tier;if(q&&q!=="free"){const V=Gr[q];V&&(L={icon:"",label:V.name,color:"text-blue-400 border-blue-500/30 bg-blue-500/10"},q===tt.TIER_1&&(L={icon:"",label:"Apprentice",color:"text-blue-400 border-blue-500/30 bg-blue-500/10"}),q===tt.TIER_2&&(L={icon:"",label:"Magician",color:"text-purple-400 border-purple-500/30 bg-purple-500/10"}),q===tt.TIER_3&&(L={icon:"",label:"Wizard",color:"text-yellow-400 border-yellow-500/30 bg-yellow-500/10"}),q===tt.TIER_4&&(L={icon:"",label:"Archmage",color:"text-orange-400 border-orange-500/30 bg-orange-500/10"}),q===tt.TIER_5&&(L={icon:"",label:"Planeswalker",color:"text-red-400 border-red-500/30 bg-red-500/10"}))}const K=C?{icon:"",label:"Architect",color:"text-amber-500 bg-amber-500/20 border-amber-500/50"}:L||r?.settings?.badge||{icon:"",label:"Alpha Tester",color:"text-gray-400 bg-gray-800 border-gray-700"},W=async()=>{try{await n(),window.location.href="/"}catch(V){console.error("Logout failed",V)}};return s.jsxs(s.Fragment,{children:[s.jsx("nav",{className:"bg-gray-950/30 backdrop-blur-2xl border-b border-white/5 sticky top-0 z-50",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-between h-16",children:s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsx("div",{className:"flex-shrink-0 flex items-center gap-3",children:s.jsxs(_t,{to:"/",className:"flex items-center gap-3 transform hover:scale-105 transition-transform",children:[s.jsx("img",{src:"/logo.png",alt:"MTG Forge Logo",className:"h-10 w-auto"}),s.jsxs("div",{className:"flex flex-col gap-1 sm:hidden",children:[s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse w-fit leading-none",children:"ALPHA"}),q&&q!=="free"&&(()=>{const V=Gr[q];let X="text-gray-400 border-gray-600 bg-gray-800";return q===tt.TIER_1&&(X="text-blue-400 border-blue-500/30 bg-blue-500/10"),q===tt.TIER_2&&(X="text-purple-400 border-purple-500/30 bg-purple-500/10"),q===tt.TIER_3&&(X="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),q===tt.TIER_4&&(X="text-orange-400 border-orange-500/30 bg-orange-500/10"),q===tt.TIER_5&&(X="text-red-400 border-red-500/30 bg-red-500/10"),s.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase w-fit ${X}`,children:V?.name||"MEMBER"})})()]}),s.jsxs("div",{className:"hidden sm:flex flex-col justify-center",children:[s.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent leading-none pb-1",children:"MTG-Forge"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"bg-orange-500/10 border border-orange-500/30 text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded animate-pulse leading-none",children:"ALPHA"}),q&&q!=="free"&&(()=>{const V=Gr[q];let X="text-gray-400 border-gray-600 bg-gray-800";return q===tt.TIER_1&&(X="text-blue-400 border-blue-500/30 bg-blue-500/10"),q===tt.TIER_2&&(X="text-purple-400 border-purple-500/30 bg-purple-500/10"),q===tt.TIER_3&&(X="text-yellow-400 border-yellow-500/30 bg-yellow-500/10"),q===tt.TIER_4&&(X="text-orange-400 border-orange-500/30 bg-orange-500/10"),q===tt.TIER_5&&(X="text-red-400 border-red-500/30 bg-red-500/10"),s.jsx("span",{className:`border text-[9px] font-bold px-1.5 py-0.5 rounded leading-none uppercase ${X}`,children:V?.name||"MEMBER"})})()]})]})]})}),s.jsx("div",{className:"hidden lg:ml-10 lg:flex lg:items-baseline lg:space-x-4",children:e?s.jsxs(s.Fragment,{children:[s.jsx(_t,{to:"/dashboard",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Dashboard"}),s.jsx(_t,{to:"/collection",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Collection"}),s.jsx(_t,{to:"/wishlist",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Wishlist"}),s.jsx(_t,{to:"/decks",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Decks"}),s.jsx(_t,{to:"/precons",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Precons"}),s.jsx(_t,{to:"/sets",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Sets"})]}):s.jsx(s.Fragment,{children:u?s.jsxs(s.Fragment,{children:[s.jsx("a",{href:"#features",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Features"}),s.jsx(_t,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})]}):s.jsx(s.Fragment,{children:s.jsx(_t,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"About"})})})}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e&&s.jsxs("button",{onClick:()=>p(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20 flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"hidden sm:inline",children:"Add Card"})]}),e?s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>T(!0),className:`flex items-center justify-center w-8 h-8 rounded-full border transition-all group relative ${K.color||"bg-gray-800 border-gray-700 hover:bg-gray-700"}`,title:K.label||"Change Badge",children:[s.jsx("span",{className:"text-base",children:K.icon}),C&&s.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-amber-500"})]})]}),s.jsx("span",{className:`text-sm font-medium hidden sm:inline-block ${C?"text-amber-400 font-bold tracking-wider":"text-gray-300 max-w-[150px] truncate"}`,children:U}),s.jsx("button",{id:"user-menu-button",onClick:()=>I(!A),className:"text-gray-400 hover:text-white transition-colors focus:outline-none",children:e.photoURL?s.jsx("img",{src:e.photoURL,alt:"Profile",className:"h-8 w-8 rounded-full object-cover ring-2 ring-transparent hover:ring-indigo-500 transition-all border border-gray-600"}):s.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-500/20 border border-indigo-500/50 flex items-center justify-center ring-2 ring-transparent hover:ring-indigo-500 transition-all",children:s.jsx("span",{className:"text-xs font-bold text-indigo-300",children:e.email?e.email[0].toUpperCase():"U"})})})]}),A&&s.jsxs("div",{id:"user-menu-dropdown",className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 border border-gray-700 ring-1 ring-black ring-opacity-5 animate-fade-in-up",children:[s.jsxs("div",{className:"px-4 py-2 border-b border-gray-700",children:[s.jsx("p",{className:"text-sm text-white font-bold",children:"Account"}),s.jsx("p",{className:"text-xs text-gray-400 truncate",children:e.email})]}),s.jsx("button",{onClick:B,disabled:O,className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:O?"Uploading...":"Upload Photo"}),s.jsx("input",{type:"file",ref:E,onChange:$,className:"hidden",accept:"image/*"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{I(!1),k(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Playstyle Profile"}),s.jsx(_t,{to:"/settings",onClick:()=>I(!1),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white",children:"Settings"}),s.jsx("div",{className:"border-t border-gray-700 my-1"}),s.jsx("button",{onClick:()=>{I(!1),W()},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 hover:text-red-300",children:"Sign Out"})]})]}):s.jsx(_t,{to:"/login",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Sign In"})]})]})})})}),s.jsx(C4,{isOpen:h,onClose:()=>p(!1),onOpenForgeLens:()=>{p(!1),x(!0)}}),s.jsx(ey,{isOpen:m,onClose:()=>x(!1),onFinish:async(V,X={})=>{if(!V||V.length===0)return;const Z=X.targetDeckId?`deck:${X.targetDeckId}`:"collection",G=V.map(F=>({scryfall_id:F.scryfall_id,name:F.name,set_code:F.set_code,collector_number:F.collector_number,finish:F.finish,quantity:F.quantity,is_foil:F.finish==="foil"}));try{console.log("[Navbar] Adding batch via Forge Lens:",G,Z),await Pe.batchAddToCollection(G,Z),d(`Successfully added ${V.length} cards via Forge Lens!`,"success"),x(!1)}catch(F){console.error("Batch add failed",F),d(`Failed to add cards: ${F.message}`,"error")}}}),s.jsx(_P,{isOpen:b,onClose:()=>v(!1),onComplete:R}),s.jsx(GY,{isOpen:w,onClose:()=>k(!1),profile:r?.settings?.playstyle,userImage:e?.photoURL,onRetake:()=>{k(!1),v(!0)}}),s.jsx(YY,{isOpen:_,onClose:()=>T(!1),currentBadgeId:r?.settings?.badge?.id||"alpha_tester",isMaster:e?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3",onSelect:async V=>{await i({badge:V}),await a(),T(!1)}}),!u&&s.jsx("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-gray-900 border-t border-gray-800 z-50 pb-safe",children:s.jsxs("div",{className:"flex justify-around items-center h-16",children:[s.jsxs(_t,{to:"/dashboard",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/dashboard"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Home"})]}),s.jsxs(_t,{to:"/collection",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/collection"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Collection"})]}),s.jsxs(_t,{to:"/wishlist",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/wishlist"?"text-orange-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Wishlist"})]}),s.jsxs(_t,{to:"/decks",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/decks")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Decks"})]}),s.jsxs(_t,{to:"/precons",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/precons")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Precons"})]}),s.jsxs(_t,{to:"/sets",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname.startsWith("/sets")?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Sets"})]}),s.jsxs(_t,{to:"/settings",className:`flex flex-col items-center justify-center w-full h-full ${t.pathname==="/settings"?"text-indigo-400":"text-gray-400 hover:text-gray-200"}`,children:[s.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-[10px] mt-1 uppercase tracking-wide",children:"Settings"})]})]})})]})},I4=({isOpen:t,onClose:e})=>t?ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Binder Management Guide"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Organize your collection like a pro."})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Two Ways to Build"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[s.jsxs("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:[" Manual Binder ",s.jsx("span",{className:"text-[9px] bg-indigo-500/20 text-indigo-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Magician Tier"})]}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Classic storage. You drag and drop exactly which cards go inside. Great for mirroring your physical binders."})]}),s.jsxs("div",{className:"bg-indigo-900/10 p-4 rounded-2xl border border-indigo-500/20",children:[s.jsxs("h4",{className:"text-indigo-300 font-bold mb-1 flex items-center gap-2",children:[" Smart Binder ",s.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider",children:"Free & Up"})]}),s.jsx("p",{className:"text-xs text-indigo-200/60 leading-relaxed",children:'Live automation. You set rules (like "Price > $10"), and the binder automatically grabs matching cards from your collection.'})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"AI Smart Creator"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:"Don't want to build rules manually? Just describe what you want in plain English!"}),s.jsxs("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30 mb-4",children:[s.jsx("p",{className:"font-mono text-xs text-gray-400 mb-2",children:"Try prompts like:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-indigo-300 font-medium",children:[s.jsx("li",{children:'"All my red goblins over $5"'}),s.jsx("li",{children:'"Cards to trade that I have duplicates of"'}),s.jsx("li",{children:'"High value commanders not in any decks"'})]})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"The AI detects price, color, type, quantity, rarity, and even whether a card is currently used in a deck."})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Advanced Logic (In Deck, Quantity)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[s.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"In Deck Status"}),s.jsxs("p",{className:"text-xs text-gray-400",children:['Filter cards based on usage. Create a "Trade Binder" by excluding cards that are currently ',s.jsx("span",{className:"text-white font-mono",children:"In Deck = True"}),"."]})]}),s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-white/5",children:[s.jsx("h5",{className:"text-green-400 font-bold text-xs uppercase mb-1",children:"Quantity Control"}),s.jsxs("p",{className:"text-xs text-gray-400",children:["Filter by how many copies you own. Great for finding ",s.jsx("span",{className:"text-white font-mono",children:"Count > 4"})," (Duplicates)."]})]})]})]}),s.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Custom Style"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Use any Hex Code color and pick from hundreds of icons (including MTG Mana Symbols) to make your binder pop."})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Live Updates"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Smart Binders are alive. When you add a new card to your collection that matches the rules, it instantly appears in the binder."})]})]})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it!"})})]})]}),document.body):null,eI=({isOpen:t,onClose:e})=>t?ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-purple-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-500/20 rounded-xl text-purple-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),s.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["For Pods & Permissions.",s.jsx("span",{className:"text-[9px] bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded uppercase tracking-wider border border-purple-500/30",children:"Requires Wizard Tier"})]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',s.jsx("strong",{className:"text-white",children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),s.jsxs("div",{className:"bg-indigo-900/20 p-4 rounded-xl border border-indigo-500/20 flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsx("p",{className:"text-xs text-indigo-300 font-bold",children:"Pro Tip: Only add people you actually know and trust to your Pod."})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-blue-500/30 transition-all",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-blue-400 tracking-wider mb-2 block",children:"Default"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Viewer"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Private Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"View Collection"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Download/Clone Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Edit Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Change Settings"]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5 hover:border-purple-500/30 transition-all",children:[s.jsx("span",{className:"text-[10px] font-black uppercase text-purple-400 tracking-wider mb-2 block",children:"Advanced"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-4",children:"Editor"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Everything in Viewer"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-white font-bold",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add/Remove Cards ",s.jsx("span",{className:"font-normal text-gray-400 ml-1",children:"from Decks"})]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-green-300",children:[s.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Add Cards to Collection"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete Decks"]}),s.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-500 opacity-60",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Manage Account"]})]})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-white ring-2 ring-indigo-500",children:"You"}),s.jsx("div",{className:"h-px bg-gray-600 w-8"}),s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P2"}),s.jsx("div",{className:"h-px bg-gray-600 w-8"}),s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400",children:"P3"})]}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-widest",children:"Collaborative Deck Building"})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Got it, thanks!"})})]})]}),document.body):null;var bQ=Object.defineProperty,Gg=Object.getOwnPropertySymbols,tI=Object.prototype.hasOwnProperty,rI=Object.prototype.propertyIsEnumerable,LA=(t,e,r)=>e in t?bQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,kj=(t,e)=>{for(var r in e||(e={}))tI.call(e,r)&&LA(t,r,e[r]);if(Gg)for(var r of Gg(e))rI.call(e,r)&&LA(t,r,e[r]);return t},Sj=(t,e)=>{var r={};for(var n in t)tI.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&Gg)for(var n of Gg(t))e.indexOf(n)<0&&rI.call(t,n)&&(r[n]=t[n]);return r};var fd;(t=>{const e=class Gt{constructor(u,h,p,m){if(this.version=u,this.errorCorrectionLevel=h,this.modules=[],this.isFunction=[],u<Gt.MIN_VERSION||u>Gt.MAX_VERSION)throw new RangeError("Version value out of range");if(m<-1||m>7)throw new RangeError("Mask value out of range");this.size=u*4+17;let x=[];for(let v=0;v<this.size;v++)x.push(!1);for(let v=0;v<this.size;v++)this.modules.push(x.slice()),this.isFunction.push(x.slice());this.drawFunctionPatterns();const b=this.addEccAndInterleave(p);if(this.drawCodewords(b),m==-1){let v=1e9;for(let w=0;w<8;w++){this.applyMask(w),this.drawFormatBits(w);const k=this.getPenaltyScore();k<v&&(m=w,v=k),this.applyMask(w)}}i(0<=m&&m<=7),this.mask=m,this.applyMask(m),this.drawFormatBits(m),this.isFunction=[]}static encodeText(u,h){const p=t.QrSegment.makeSegments(u);return Gt.encodeSegments(p,h)}static encodeBinary(u,h){const p=t.QrSegment.makeBytes(u);return Gt.encodeSegments([p],h)}static encodeSegments(u,h,p=1,m=40,x=-1,b=!0){if(!(Gt.MIN_VERSION<=p&&p<=m&&m<=Gt.MAX_VERSION)||x<-1||x>7)throw new RangeError("Invalid value");let v,w;for(v=p;;v++){const A=Gt.getNumDataCodewords(v,h)*8,I=l.getTotalBits(u,v);if(I<=A){w=I;break}if(v>=m)throw new RangeError("Data too long")}for(const A of[Gt.Ecc.MEDIUM,Gt.Ecc.QUARTILE,Gt.Ecc.HIGH])b&&w<=Gt.getNumDataCodewords(v,A)*8&&(h=A);let k=[];for(const A of u){r(A.mode.modeBits,4,k),r(A.numChars,A.mode.numCharCountBits(v),k);for(const I of A.getData())k.push(I)}i(k.length==w);const _=Gt.getNumDataCodewords(v,h)*8;i(k.length<=_),r(0,Math.min(4,_-k.length),k),r(0,(8-k.length%8)%8,k),i(k.length%8==0);for(let A=236;k.length<_;A^=253)r(A,8,k);let T=[];for(;T.length*8<k.length;)T.push(0);return k.forEach((A,I)=>T[I>>>3]|=A<<7-(I&7)),new Gt(v,h,T,x)}getModule(u,h){return 0<=u&&u<this.size&&0<=h&&h<this.size&&this.modules[h][u]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const u=this.getAlignmentPatternPositions(),h=u.length;for(let p=0;p<h;p++)for(let m=0;m<h;m++)p==0&&m==0||p==0&&m==h-1||p==h-1&&m==0||this.drawAlignmentPattern(u[p],u[m]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(u){const h=this.errorCorrectionLevel.formatBits<<3|u;let p=h;for(let x=0;x<10;x++)p=p<<1^(p>>>9)*1335;const m=(h<<10|p)^21522;i(m>>>15==0);for(let x=0;x<=5;x++)this.setFunctionModule(8,x,n(m,x));this.setFunctionModule(8,7,n(m,6)),this.setFunctionModule(8,8,n(m,7)),this.setFunctionModule(7,8,n(m,8));for(let x=9;x<15;x++)this.setFunctionModule(14-x,8,n(m,x));for(let x=0;x<8;x++)this.setFunctionModule(this.size-1-x,8,n(m,x));for(let x=8;x<15;x++)this.setFunctionModule(8,this.size-15+x,n(m,x));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let u=this.version;for(let p=0;p<12;p++)u=u<<1^(u>>>11)*7973;const h=this.version<<12|u;i(h>>>18==0);for(let p=0;p<18;p++){const m=n(h,p),x=this.size-11+p%3,b=Math.floor(p/3);this.setFunctionModule(x,b,m),this.setFunctionModule(b,x,m)}}drawFinderPattern(u,h){for(let p=-4;p<=4;p++)for(let m=-4;m<=4;m++){const x=Math.max(Math.abs(m),Math.abs(p)),b=u+m,v=h+p;0<=b&&b<this.size&&0<=v&&v<this.size&&this.setFunctionModule(b,v,x!=2&&x!=4)}}drawAlignmentPattern(u,h){for(let p=-2;p<=2;p++)for(let m=-2;m<=2;m++)this.setFunctionModule(u+m,h+p,Math.max(Math.abs(m),Math.abs(p))!=1)}setFunctionModule(u,h,p){this.modules[h][u]=p,this.isFunction[h][u]=!0}addEccAndInterleave(u){const h=this.version,p=this.errorCorrectionLevel;if(u.length!=Gt.getNumDataCodewords(h,p))throw new RangeError("Invalid argument");const m=Gt.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][h],x=Gt.ECC_CODEWORDS_PER_BLOCK[p.ordinal][h],b=Math.floor(Gt.getNumRawDataModules(h)/8),v=m-b%m,w=Math.floor(b/m);let k=[];const _=Gt.reedSolomonComputeDivisor(x);for(let A=0,I=0;A<m;A++){let O=u.slice(I,I+w-x+(A<v?0:1));I+=O.length;const M=Gt.reedSolomonComputeRemainder(O,_);A<v&&O.push(0),k.push(O.concat(M))}let T=[];for(let A=0;A<k[0].length;A++)k.forEach((I,O)=>{(A!=w-x||O>=v)&&T.push(I[A])});return i(T.length==b),T}drawCodewords(u){if(u.length!=Math.floor(Gt.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let h=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let m=0;m<this.size;m++)for(let x=0;x<2;x++){const b=p-x,w=(p+1&2)==0?this.size-1-m:m;!this.isFunction[w][b]&&h<u.length*8&&(this.modules[w][b]=n(u[h>>>3],7-(h&7)),h++)}}i(h==u.length*8)}applyMask(u){if(u<0||u>7)throw new RangeError("Mask value out of range");for(let h=0;h<this.size;h++)for(let p=0;p<this.size;p++){let m;switch(u){case 0:m=(p+h)%2==0;break;case 1:m=h%2==0;break;case 2:m=p%3==0;break;case 3:m=(p+h)%3==0;break;case 4:m=(Math.floor(p/3)+Math.floor(h/2))%2==0;break;case 5:m=p*h%2+p*h%3==0;break;case 6:m=(p*h%2+p*h%3)%2==0;break;case 7:m=((p+h)%2+p*h%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[h][p]&&m&&(this.modules[h][p]=!this.modules[h][p])}}getPenaltyScore(){let u=0;for(let x=0;x<this.size;x++){let b=!1,v=0,w=[0,0,0,0,0,0,0];for(let k=0;k<this.size;k++)this.modules[x][k]==b?(v++,v==5?u+=Gt.PENALTY_N1:v>5&&u++):(this.finderPenaltyAddHistory(v,w),b||(u+=this.finderPenaltyCountPatterns(w)*Gt.PENALTY_N3),b=this.modules[x][k],v=1);u+=this.finderPenaltyTerminateAndCount(b,v,w)*Gt.PENALTY_N3}for(let x=0;x<this.size;x++){let b=!1,v=0,w=[0,0,0,0,0,0,0];for(let k=0;k<this.size;k++)this.modules[k][x]==b?(v++,v==5?u+=Gt.PENALTY_N1:v>5&&u++):(this.finderPenaltyAddHistory(v,w),b||(u+=this.finderPenaltyCountPatterns(w)*Gt.PENALTY_N3),b=this.modules[k][x],v=1);u+=this.finderPenaltyTerminateAndCount(b,v,w)*Gt.PENALTY_N3}for(let x=0;x<this.size-1;x++)for(let b=0;b<this.size-1;b++){const v=this.modules[x][b];v==this.modules[x][b+1]&&v==this.modules[x+1][b]&&v==this.modules[x+1][b+1]&&(u+=Gt.PENALTY_N2)}let h=0;for(const x of this.modules)h=x.reduce((b,v)=>b+(v?1:0),h);const p=this.size*this.size,m=Math.ceil(Math.abs(h*20-p*10)/p)-1;return i(0<=m&&m<=9),u+=m*Gt.PENALTY_N4,i(0<=u&&u<=2568888),u}getAlignmentPatternPositions(){if(this.version==1)return[];{const u=Math.floor(this.version/7)+2,h=this.version==32?26:Math.ceil((this.version*4+4)/(u*2-2))*2;let p=[6];for(let m=this.size-7;p.length<u;m-=h)p.splice(1,0,m);return p}}static getNumRawDataModules(u){if(u<Gt.MIN_VERSION||u>Gt.MAX_VERSION)throw new RangeError("Version number out of range");let h=(16*u+128)*u+64;if(u>=2){const p=Math.floor(u/7)+2;h-=(25*p-10)*p-55,u>=7&&(h-=36)}return i(208<=h&&h<=29648),h}static getNumDataCodewords(u,h){return Math.floor(Gt.getNumRawDataModules(u)/8)-Gt.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u]*Gt.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u]}static reedSolomonComputeDivisor(u){if(u<1||u>255)throw new RangeError("Degree out of range");let h=[];for(let m=0;m<u-1;m++)h.push(0);h.push(1);let p=1;for(let m=0;m<u;m++){for(let x=0;x<h.length;x++)h[x]=Gt.reedSolomonMultiply(h[x],p),x+1<h.length&&(h[x]^=h[x+1]);p=Gt.reedSolomonMultiply(p,2)}return h}static reedSolomonComputeRemainder(u,h){let p=h.map(m=>0);for(const m of u){const x=m^p.shift();p.push(0),h.forEach((b,v)=>p[v]^=Gt.reedSolomonMultiply(b,x))}return p}static reedSolomonMultiply(u,h){if(u>>>8||h>>>8)throw new RangeError("Byte out of range");let p=0;for(let m=7;m>=0;m--)p=p<<1^(p>>>7)*285,p^=(h>>>m&1)*u;return i(p>>>8==0),p}finderPenaltyCountPatterns(u){const h=u[1];i(h<=this.size*3);const p=h>0&&u[2]==h&&u[3]==h*3&&u[4]==h&&u[5]==h;return(p&&u[0]>=h*4&&u[6]>=h?1:0)+(p&&u[6]>=h*4&&u[0]>=h?1:0)}finderPenaltyTerminateAndCount(u,h,p){return u&&(this.finderPenaltyAddHistory(h,p),h=0),h+=this.size,this.finderPenaltyAddHistory(h,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(u,h){h[0]==0&&(u+=this.size),h.pop(),h.unshift(u)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function r(d,u,h){if(u<0||u>31||d>>>u)throw new RangeError("Value out of range");for(let p=u-1;p>=0;p--)h.push(d>>>p&1)}function n(d,u){return(d>>>u&1)!=0}function i(d){if(!d)throw new Error("Assertion error")}const a=class nn{constructor(u,h,p){if(this.mode=u,this.numChars=h,this.bitData=p,h<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(u){let h=[];for(const p of u)r(p,8,h);return new nn(nn.Mode.BYTE,u.length,h)}static makeNumeric(u){if(!nn.isNumeric(u))throw new RangeError("String contains non-numeric characters");let h=[];for(let p=0;p<u.length;){const m=Math.min(u.length-p,3);r(parseInt(u.substring(p,p+m),10),m*3+1,h),p+=m}return new nn(nn.Mode.NUMERIC,u.length,h)}static makeAlphanumeric(u){if(!nn.isAlphanumeric(u))throw new RangeError("String contains unencodable characters in alphanumeric mode");let h=[],p;for(p=0;p+2<=u.length;p+=2){let m=nn.ALPHANUMERIC_CHARSET.indexOf(u.charAt(p))*45;m+=nn.ALPHANUMERIC_CHARSET.indexOf(u.charAt(p+1)),r(m,11,h)}return p<u.length&&r(nn.ALPHANUMERIC_CHARSET.indexOf(u.charAt(p)),6,h),new nn(nn.Mode.ALPHANUMERIC,u.length,h)}static makeSegments(u){return u==""?[]:nn.isNumeric(u)?[nn.makeNumeric(u)]:nn.isAlphanumeric(u)?[nn.makeAlphanumeric(u)]:[nn.makeBytes(nn.toUtf8ByteArray(u))]}static makeEci(u){let h=[];if(u<0)throw new RangeError("ECI assignment value out of range");if(u<128)r(u,8,h);else if(u<16384)r(2,2,h),r(u,14,h);else if(u<1e6)r(6,3,h),r(u,21,h);else throw new RangeError("ECI assignment value out of range");return new nn(nn.Mode.ECI,0,h)}static isNumeric(u){return nn.NUMERIC_REGEX.test(u)}static isAlphanumeric(u){return nn.ALPHANUMERIC_REGEX.test(u)}getData(){return this.bitData.slice()}static getTotalBits(u,h){let p=0;for(const m of u){const x=m.mode.numCharCountBits(h);if(m.numChars>=1<<x)return 1/0;p+=4+x+m.bitData.length}return p}static toUtf8ByteArray(u){u=encodeURI(u);let h=[];for(let p=0;p<u.length;p++)u.charAt(p)!="%"?h.push(u.charCodeAt(p)):(h.push(parseInt(u.substring(p+1,p+3),16)),p+=2);return h}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=a;t.QrSegment=a})(fd||(fd={}));(t=>{(e=>{const r=class{constructor(i,a){this.ordinal=i,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(fd||(fd={}));(t=>{(e=>{const r=class{constructor(i,a){this.modeBits=i,this.numBitsCharCount=a}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(fd||(fd={}));var Ou=fd;var vQ={L:Ou.QrCode.Ecc.LOW,M:Ou.QrCode.Ecc.MEDIUM,Q:Ou.QrCode.Ecc.QUARTILE,H:Ou.QrCode.Ecc.HIGH},nI=128,sI="L",iI="#FFFFFF",aI="#000000",oI=!1,lI=1,wQ=4,jQ=0,NQ=.1;function cI(t,e=0){const r=[];return t.forEach(function(n,i){let a=null;n.forEach(function(l,d){if(!l&&a!==null){r.push(`M${a+e} ${i+e}h${d-a}v1H${a+e}z`),a=null;return}if(d===n.length-1){if(!l)return;a===null?r.push(`M${d+e},${i+e} h1v1H${d+e}z`):r.push(`M${a+e},${i+e} h${d+1-a}v1H${a+e}z`);return}l&&a===null&&(a=d)})}),r.join("")}function dI(t,e){return t.slice().map((r,n)=>n<e.y||n>=e.y+e.h?r:r.map((i,a)=>a<e.x||a>=e.x+e.w?i:!1))}function kQ(t,e,r,n){if(n==null)return null;const i=t.length+r*2,a=Math.floor(e*NQ),l=i/e,d=(n.width||a)*l,u=(n.height||a)*l,h=n.x==null?t.length/2-d/2:n.x*l,p=n.y==null?t.length/2-u/2:n.y*l,m=n.opacity==null?1:n.opacity;let x=null;if(n.excavate){let v=Math.floor(h),w=Math.floor(p),k=Math.ceil(d+h-v),_=Math.ceil(u+p-w);x={x:v,y:w,w:k,h:_}}const b=n.crossOrigin;return{x:h,y:p,h:u,w:d,excavation:x,opacity:m,crossOrigin:b}}function SQ(t,e){return e!=null?Math.max(Math.floor(e),0):t?wQ:jQ}function uI({value:t,level:e,minVersion:r,includeMargin:n,marginSize:i,imageSettings:a,size:l,boostLevel:d}){let u=Ge.useMemo(()=>{const v=(Array.isArray(t)?t:[t]).reduce((w,k)=>(w.push(...Ou.QrSegment.makeSegments(k)),w),[]);return Ou.QrCode.encodeSegments(v,vQ[e],r,void 0,void 0,d)},[t,e,r,d]);const{cells:h,margin:p,numCells:m,calculatedImageSettings:x}=Ge.useMemo(()=>{let b=u.getModules();const v=SQ(n,i),w=b.length+v*2,k=kQ(b,l,v,a);return{cells:b,margin:v,numCells:w,calculatedImageSettings:k}},[u,l,a,n,i]);return{qrcode:u,margin:p,cells:h,numCells:m,calculatedImageSettings:x}}var _Q=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),CQ=Ge.forwardRef(function(e,r){const n=e,{value:i,size:a=nI,level:l=sI,bgColor:d=iI,fgColor:u=aI,includeMargin:h=oI,minVersion:p=lI,boostLevel:m,marginSize:x,imageSettings:b}=n,w=Sj(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:k}=w,_=Sj(w,["style"]),T=b?.src,A=Ge.useRef(null),I=Ge.useRef(null),O=Ge.useCallback(q=>{A.current=q,typeof r=="function"?r(q):r&&(r.current=q)},[r]),[M,E]=Ge.useState(!1),{margin:R,cells:$,numCells:B,calculatedImageSettings:C}=uI({value:i,level:l,minVersion:p,boostLevel:m,includeMargin:h,marginSize:x,imageSettings:b,size:a});Ge.useEffect(()=>{if(A.current!=null){const q=A.current,K=q.getContext("2d");if(!K)return;let W=$;const V=I.current,X=C!=null&&V!==null&&V.complete&&V.naturalHeight!==0&&V.naturalWidth!==0;X&&C.excavation!=null&&(W=dI($,C.excavation));const Z=window.devicePixelRatio||1;q.height=q.width=a*Z;const G=a/B*Z;K.scale(G,G),K.fillStyle=d,K.fillRect(0,0,B,B),K.fillStyle=u,_Q?K.fill(new Path2D(cI(W,R))):$.forEach(function(F,Y){F.forEach(function(ne,re){ne&&K.fillRect(re+R,Y+R,1,1)})}),C&&(K.globalAlpha=C.opacity),X&&K.drawImage(V,C.x+R,C.y+R,C.w,C.h)}}),Ge.useEffect(()=>{E(!1)},[T]);const U=kj({height:a,width:a},k);let L=null;return T!=null&&(L=Ge.createElement("img",{src:T,key:T,style:{display:"none"},onLoad:()=>{E(!0)},ref:I,crossOrigin:C?.crossOrigin})),Ge.createElement(Ge.Fragment,null,Ge.createElement("canvas",kj({style:U,height:a,width:a,ref:O,role:"img"},_)),L)});CQ.displayName="QRCodeCanvas";var D4=Ge.forwardRef(function(e,r){const n=e,{value:i,size:a=nI,level:l=sI,bgColor:d=iI,fgColor:u=aI,includeMargin:h=oI,minVersion:p=lI,boostLevel:m,title:x,marginSize:b,imageSettings:v}=n,w=Sj(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:k,cells:_,numCells:T,calculatedImageSettings:A}=uI({value:i,level:l,minVersion:p,boostLevel:m,includeMargin:h,marginSize:b,imageSettings:v,size:a});let I=_,O=null;v!=null&&A!=null&&(A.excavation!=null&&(I=dI(_,A.excavation)),O=Ge.createElement("image",{href:v.src,height:A.h,width:A.w,x:A.x+k,y:A.y+k,preserveAspectRatio:"none",opacity:A.opacity,crossOrigin:A.crossOrigin}));const M=cI(I,k);return Ge.createElement("svg",kj({height:a,width:a,viewBox:`0 0 ${T} ${T}`,ref:r,role:"img"},w),!!x&&Ge.createElement("title",null,x),Ge.createElement("path",{fill:d,d:`M0,0 h${T}v${T}H0z`,shapeRendering:"crispEdges"}),Ge.createElement("path",{fill:u,d:M,shapeRendering:"crispEdges"}),O)});D4.displayName="QRCodeSVG";const EQ=({isOpen:t,onClose:e})=>{if(!t)return null;const r="https://mtg-forge.com/share/heir-to-the-hysteria-x26l";return ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1200] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"relative z-10 w-full max-w-md bg-gray-900 border border-white/10 rounded-3xl overflow-hidden shadow-2xl animate-fade-in-up",children:[s.jsxs("div",{className:"p-6 pb-2 text-center",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Scan to view deck list instantly"})]}),s.jsxs("div",{className:"p-8 flex flex-col items-center justify-center space-y-6",children:[s.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-[0_0_40px_rgba(255,255,255,0.1)]",children:s.jsx(D4,{value:r,size:200,level:"H",includeMargin:!1})}),s.jsxs("div",{className:"w-full text-center space-y-3",children:[s.jsxs("div",{className:"bg-black/40 border border-white/5 rounded-xl p-3 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 text-left",children:"Share Link"}),s.jsx("p",{className:"text-xs text-indigo-300 font-mono truncate text-left select-all",children:r})]}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(r),className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",title:"Copy",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Anyone with this link can view the full deck list and statistics."})]})]}),s.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/50 flex justify-center",children:s.jsx("button",{onClick:()=>window.open(r,"_blank"),className:"text-indigo-400 hover:text-white text-sm font-bold transition-colors",children:"Open Link in New Tab "})})]})]}),document.body)},Xf=({isOpen:t,onClose:e})=>t?ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Audit & Verification Guide"}),s.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:["Audit The Forge to verify your collection.",s.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded uppercase tracking-wider border border-green-500/30",children:"Requires Wizard Tier"})]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),"Neutral Starting State"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:'Every card starts in a "pending" state. We assume your collection matches your records until you verify it.'}),s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-2xl border border-white/5",children:[s.jsx("h4",{className:"text-white font-bold mb-1 flex items-center gap-2",children:" Pending"}),s.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:"Gray border. The input is locked. You must choose to Match or flag a Mismatch to continue."})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"2"}),"Quick Verification"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-green-900/10 p-4 rounded-2xl border border-green-500/20",children:[s.jsx("h4",{className:"text-green-300 font-bold mb-1 flex items-center gap-2",children:" Match (Check)"}),s.jsx("p",{className:"text-xs text-green-200/60 leading-relaxed",children:"Instantly marks the card as reviewed and verified. Confirms you have exactly the expected amount."})]}),s.jsxs("div",{className:"bg-red-900/10 p-4 rounded-2xl border border-red-500/20",children:[s.jsx("h4",{className:"text-red-300 font-bold mb-1 flex items-center gap-2",children:" Mismatch (X)"}),s.jsx("p",{className:"text-xs text-red-200/60 leading-relaxed",children:"Flags a discrepancy. Sets count to 0 and unlocks the input so you can type the correct physical count."})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"3"}),"Finalizing Your Audit"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`Once you've touched every card in a section (Deck or Set), mark it as "Finished".`}),s.jsx("div",{className:"bg-black/40 p-4 rounded-xl border border-indigo-500/30",children:s.jsx("p",{className:"text-xs text-indigo-300 font-medium",children:"When the entire audit is complete, use the **Finalize Audit** button in the Hub. This will sync all your Mismatches to your actual collection database, ensuring your digital records match your physical boxes."})})]}),s.jsxs("section",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 p-6 rounded-3xl border border-indigo-500/20",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:" Pro Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Discrepancy Report"}),s.jsx("p",{className:"text-xs text-gray-300",children:"Use the report table in the Audit Hub to see exactly what changed before you finalize."})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("h5",{className:"text-white font-bold text-xs uppercase tracking-wider",children:"Mobile Friendly"}),s.jsx("p",{className:"text-xs text-gray-300",children:"The Audit Wizard is optimized for phone use. Carry your phone to your bulk boxes for easy scanning!"})]})]})]})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all font-black text-sm shadow-xl shadow-indigo-900/20 active:scale-95",children:"Start Auditing"})})]})]}),document.body):null,AQ=()=>{const[t,e]=y.useState(null);return s.jsxs("section",{id:"features",className:"py-32 bg-transparent relative",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-24 animate-fade-in-up",children:[s.jsx("span",{className:"text-indigo-400 font-bold tracking-widest uppercase text-sm mb-2 block",children:"The Forge Advantage"}),s.jsxs("h2",{className:"text-4xl md:text-6xl font-black text-white mb-6 leading-tight",children:["Actionable Intelligence.",s.jsx("br",{}),"Professional Results."]}),s.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto text-xl italic",children:'"Stop tracking cards. Start forging strategy."'})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 bg-orange-500/20 rounded-3xl flex items-center justify-center mb-4 text-orange-400 ring-1 ring-orange-500/20",children:s.jsx("img",{src:"/icons/deck_doctor.png",alt:"AI Deck Doctor",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The AI Deck Doctor"}),s.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["Precision meets playability. Our surgical analysis engine provides a precise ",s.jsx("span",{className:"text-white",children:"1-5 Bracket Rating"}),', a granular 10-point power score, and card-for-card "Surgical Swaps" to optimize your curve.']}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-orange-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Brackets"}),s.jsx("div",{className:"text-white text-lg font-bold",children:"1-5 Scale"})]}),s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-green-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Precision"}),s.jsx("div",{className:"text-white text-lg font-bold",children:"0.01 PL Step"})]})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(249,115,22,0.3)] border border-orange-500/20 group animate-fade-in-right bg-gray-900/40 p-10 backdrop-blur-md",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Calculated Power"}),s.jsx("div",{className:"text-5xl font-black text-white italic",children:"7.42"})]}),s.jsx("div",{className:"px-4 py-2 bg-orange-500/20 rounded-lg border border-orange-500/30 text-orange-400 font-black uppercase tracking-widest text-xs",children:"Bracket 3"})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 via-amber-400 to-orange-600 w-[74%]"})}),s.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center mb-4 text-indigo-400 ring-1 ring-indigo-500/20 shadow-[0_0_30px_rgba(79,70,229,0.2)]",children:s.jsx("img",{src:"/icons/the_neural_architect.png",alt:"Neural Architect",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"The Neural Architect"}),s.jsxs("p",{className:"text-gray-400 text-xl leading-relaxed",children:["The first true ",s.jsx("span",{className:"text-white",children:"Zero-to-Hero"})," deck builder. Select your Commander, and watch as the Architect synthesizes a full 100-card list while prioritizing the cards you already own."]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"A"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Commander-Centric Synthesis"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"From your commander selection to a complete 100-card list in seconds."})]})]}),s.jsxs("div",{className:"p-6 bg-indigo-600/10 rounded-2xl border border-indigo-500/20 flex items-center gap-4 group hover:bg-indigo-600/20 transition-all",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-indigo-400 text-2xl font-bold",children:"C"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-black uppercase tracking-wider text-sm",children:"Collection-Aware"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Builds using cards you own first, minimizing proxy needs."})]})]})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(79,70,229,0.3)] border border-indigo-500/20 group animate-fade-in-left bg-gray-900/40 p-10 backdrop-blur-md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-2",children:"Neural Blueprint Generation"}),[{t:"Commander",v:"Selected: Niv-Mizzet, Parun"},{t:"Budget",v:"$50 (Utilizing Collection)"},{t:"Power",v:"Target Bracket 3"}].map((r,n)=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-black/40 rounded-xl border border-white/5",children:[s.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:r.t}),s.jsx("span",{className:"text-xs font-black text-indigo-400",children:r.v})]},n)),s.jsxs("div",{className:"mt-6 pt-6 border-t border-white/10",children:[s.jsxs("div",{className:"text-white font-bold mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Blueprint Complete: 100/100 Cards"]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(8)].map((r,n)=>s.jsx("div",{className:"h-1 bg-indigo-500/40 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-indigo-400 w-full animate-shimmer"})},n))})]})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-3xl flex items-center justify-center mb-4 text-blue-400 ring-1 ring-blue-500/20",children:s.jsx("img",{src:"/icons/ai_strategy_analyst.png",alt:"AI Strategy Analyst",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:"AI Strategy Analyst"}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Don't just build listsforge legends. Our Gemini-powered AI acts as a dedicated coach, analyzing synergies and suggesting win conditions tailored to your unique playstyle."}),s.jsxs("div",{className:"p-4 bg-gray-800/30 rounded-2xl border border-white/5",children:[s.jsx("div",{className:"text-blue-400 font-bold text-sm uppercase tracking-widest mb-1",children:"Advisor Analysis"}),s.jsx("div",{className:"text-white text-lg font-bold italic",children:'"Your win rate against Aggro pods increases by 14% with these adjustments."'})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(59,130,246,0.3)] border border-blue-500/20 group animate-fade-in-right",children:s.jsx("img",{src:"/images/features/ai-strategy-modal.png",alt:"AI Strategy Modal",className:"w-full h-auto opacity-80 hover:opacity-100 transition-opacity duration-700"})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row-reverse items-center gap-16 mb-40",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-right",children:[s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-3xl flex items-center justify-center mb-4 text-purple-400 ring-1 ring-purple-500/20",children:s.jsx("img",{src:"/icons/social_pods.png",alt:"Social Pods",className:"w-24 h-24 object-contain transition-all duration-500 group-hover:scale-110 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-4xl font-black text-white leading-tight",children:'Rule Your "Pod"'}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"Magic is a social game. Link accounts with your playgroup to browse friends' collections, manage shared trades, and coordinate group power levels instantly."}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("button",{onClick:()=>e("pods"),className:"px-8 py-3 rounded-xl bg-purple-500/10 border border-purple-500/30 text-purple-400 font-bold hover:bg-purple-500/20 transition-all",children:"Explore Pods"}),s.jsx("button",{onClick:()=>e("qr"),className:"px-8 py-3 rounded-xl bg-white/5 border border-white/10 text-white font-bold hover:bg-white/10 transition-all",children:"Quick Share"})]})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-[0_0_50px_-12px_rgba(168,85,247,0.3)] border border-purple-500/20 group animate-fade-in-left bg-gray-950 p-12",children:s.jsxs("div",{className:"grid grid-cols-2 gap-6 w-full h-full",children:[s.jsxs("div",{className:"bg-indigo-900/30 rounded-2xl border border-indigo-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-indigo-300 uppercase tracking-widest",children:"Smart Binder"})]}),s.jsxs("div",{className:"bg-purple-900/30 rounded-2xl border border-purple-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-75",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-purple-300 uppercase tracking-widest",children:"Pod Trade"})]}),s.jsxs("div",{className:"bg-blue-900/30 rounded-2xl border border-blue-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-100",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-blue-300 uppercase tracking-widest",children:"QR Share"})]}),s.jsxs("div",{className:"bg-green-900/30 rounded-2xl border border-green-500/20 p-6 flex flex-col items-center justify-center group-hover:scale-105 transition-transform delay-150",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-[10px] font-black text-green-300 uppercase tracking-widest",children:"Audits"})]})]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-16",children:[s.jsxs("div",{className:"flex-1 space-y-8 animate-fade-in-left",children:[s.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-4 group cursor-pointer transition-transform hover:scale-110 duration-500",children:s.jsx("img",{src:"/icons/the_professional_foundation.png",alt:"The Professional Foundation",className:"w-20 h-20 object-contain transition-all duration-500 group-hover:drop-shadow-[0_0_30px_rgba(99,102,241,0.6)]"})}),s.jsx("h3",{className:"text-3xl font-black text-white leading-tight uppercase tracking-tight",children:"The Professional Foundation"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Underneath the AI intelligence is a robust engine for cataloging your digital life. Fast scanning, accurate pricing, and comprehensive management for any format."})]}),s.jsx("div",{className:"flex-1 rounded-[2.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800/20 group",children:s.jsx("img",{src:"/images/features/collection-dashboard.jpg",alt:"Collection Dashboard",className:"w-full h-full object-cover opacity-40 group-hover:opacity-80 transition-opacity duration-700"})})]})]}),s.jsx(I4,{isOpen:t==="smart",onClose:()=>e(null)}),s.jsx(eI,{isOpen:t==="pods",onClose:()=>e(null)}),s.jsx(EQ,{isOpen:t==="qr",onClose:()=>e(null)}),s.jsx(Xf,{isOpen:t==="audit",onClose:()=>e(null)})]})},TQ=()=>s.jsxs("div",{className:"flex flex-col min-h-screen relative",children:[s.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center hidden md:block",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"}}),s.jsx("div",{className:"absolute inset-0 bg-cover bg-center md:hidden",style:{backgroundImage:"url(/MTG-Forge_Logo_Background_mobile.png)"}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-gray-950/80 to-black z-10"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[100vw] h-[100vh] bg-indigo-600/10 blur-[150px] rounded-full z-0 opacity-40"}),s.jsx("div",{className:"absolute top-1/4 left-1/4 w-[600px] h-[600px] bg-orange-500/5 blur-[120px] rounded-full z-0 opacity-20"})]}),s.jsx("div",{className:"bg-gradient-to-r from-orange-600 via-red-600 to-orange-600 text-white text-center py-2 px-4 shadow-lg z-50 relative animate-pulse-slow",children:s.jsxs("p",{className:"font-bold text-sm tracking-wide flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-lg",children:""}),"ALPHA TEST - Feature Complete but Experimental",s.jsx("span",{className:"text-lg",children:""})]})}),s.jsx("div",{className:"relative z-10 bg-transparent min-h-[80vh] flex flex-col items-center",children:s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-32 md:py-48 flex flex-col items-center text-center",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-8 animate-fade-in",children:[s.jsxs("span",{className:"relative flex h-2 w-2",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-indigo-500"})]}),s.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-widest leading-none",children:"The Future of MTG Strategy"})]}),s.jsxs("h1",{className:"text-5xl md:text-8xl font-black tracking-tight text-white mb-8 leading-tight",children:["The Forge: Where Decks",s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-500 to-orange-600 filter drop-shadow-[0_0_15px_rgba(251,191,36,0.3)]",children:"Become Legends"})]}),s.jsxs("p",{className:"max-w-2xl text-xl md:text-2xl text-gray-400 mx-auto font-medium leading-relaxed mb-12",children:["Brew Smarter. Play Harder. Your ",s.jsx("span",{className:"text-white",children:"AI-Powered Strategic Edge"}),". Join the next generation of Magic: The Gathering intelligence."]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center w-full max-w-lg",children:[s.jsxs(_t,{to:"/dashboard",className:"group relative px-10 py-5 rounded-2xl bg-indigo-600 text-white font-black text-xl transition-all shadow-[0_20px_40px_-15px_rgba(79,70,229,0.5)] hover:shadow-[0_25px_50px_-12px_rgba(79,70,229,0.6)] transform hover:-translate-y-1 hover:scale-[1.02] flex items-center justify-center gap-3",children:[s.jsx("span",{children:"Enter The Forge"}),s.jsx("svg",{className:"w-6 h-6 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]}),s.jsx(_t,{to:"/strategy",className:"px-10 py-5 rounded-2xl bg-white/5 backdrop-blur-xl hover:bg-white/10 text-white font-bold text-lg border border-white/10 transition-all hover:border-white/20 flex items-center justify-center",children:"Explore AI Strategic Edge"})]}),s.jsxs("div",{className:"mt-24 grid grid-cols-2 md:grid-cols-4 gap-8 w-full max-w-4xl border-t border-white/5 pt-12",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"99.8%"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Analysis Accuracy"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"Real-Time"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Pricing & Sync"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"5"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Bracket Tiers"})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-3xl font-black text-white mb-1",children:"AI"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-bold",children:"Driven Meta"})]})]})]})}),s.jsx("div",{className:"relative z-10",children:s.jsx(AQ,{})}),s.jsx("footer",{className:"bg-black py-12 border-t border-gray-900 mt-auto",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center",children:s.jsx("p",{className:"text-gray-500",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."})})})]}),hI=6048e5,OQ=864e5,RA=Symbol.for("constructDateFrom");function mc(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&RA in t?t[RA](e):t instanceof Date?new t.constructor(e):new Date(e)}function Ca(t,e){return mc(e||t,t)}let MQ={};function ty(){return MQ}function Jf(t,e){const r=ty(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=Ca(t,e?.in),a=i.getDay(),l=(a<n?7:0)+a-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function Vg(t,e){return Jf(t,{...e,weekStartsOn:1})}function fI(t,e){const r=Ca(t,e?.in),n=r.getFullYear(),i=mc(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=Vg(i),l=mc(r,0);l.setFullYear(n,0,4),l.setHours(0,0,0,0);const d=Vg(l);return r.getTime()>=a.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function PA(t){const e=Ca(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function LQ(t,...e){const r=mc.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function IA(t,e){const r=Ca(t,e?.in);return r.setHours(0,0,0,0),r}function RQ(t,e,r){const[n,i]=LQ(r?.in,t,e),a=IA(n),l=IA(i),d=+a-PA(a),u=+l-PA(l);return Math.round((d-u)/OQ)}function PQ(t,e){const r=fI(t,e),n=mc(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Vg(n)}function IQ(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function DQ(t){return!(!IQ(t)&&typeof t!="number"||isNaN(+Ca(t)))}function BQ(t,e){const r=Ca(t,e?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const $Q={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},UQ=(t,e,r)=>{let n;const i=$Q[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function sw(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const zQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},qQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},FQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},HQ={date:sw({formats:zQ,defaultWidth:"full"}),time:sw({formats:qQ,defaultWidth:"full"}),dateTime:sw({formats:FQ,defaultWidth:"full"})},WQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},GQ=(t,e,r,n)=>WQ[t];function df(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const l=t.defaultFormattingWidth||t.defaultWidth,d=r?.width?String(r.width):l;i=t.formattingValues[d]||t.formattingValues[l]}else{const l=t.defaultWidth,d=r?.width?String(r.width):t.defaultWidth;i=t.values[d]||t.values[l]}const a=t.argumentCallback?t.argumentCallback(e):e;return i[a]}}const VQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},XQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},JQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},QQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ZQ=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},eZ={ordinalNumber:ZQ,era:df({values:VQ,defaultWidth:"wide"}),quarter:df({values:KQ,defaultWidth:"wide",argumentCallback:t=>t-1}),month:df({values:YQ,defaultWidth:"wide"}),day:df({values:XQ,defaultWidth:"wide"}),dayPeriod:df({values:JQ,defaultWidth:"wide",formattingValues:QQ,defaultFormattingWidth:"wide"})};function uf(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;const l=a[0],d=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(d)?rZ(d,m=>m.test(l)):tZ(d,m=>m.test(l));let h;h=t.valueCallback?t.valueCallback(u):u,h=r.valueCallback?r.valueCallback(h):h;const p=e.slice(l.length);return{value:h,rest:p}}}function tZ(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function rZ(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function nZ(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],a=e.match(t.parsePattern);if(!a)return null;let l=t.valueCallback?t.valueCallback(a[0]):a[0];l=r.valueCallback?r.valueCallback(l):l;const d=e.slice(i.length);return{value:l,rest:d}}}const sZ=/^(\d+)(th|st|nd|rd)?/i,iZ=/\d+/i,aZ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oZ={any:[/^b/i,/^(a|c)/i]},lZ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cZ={any:[/1/i,/2/i,/3/i,/4/i]},dZ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uZ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hZ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fZ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},pZ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},mZ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gZ={ordinalNumber:nZ({matchPattern:sZ,parsePattern:iZ,valueCallback:t=>parseInt(t,10)}),era:uf({matchPatterns:aZ,defaultMatchWidth:"wide",parsePatterns:oZ,defaultParseWidth:"any"}),quarter:uf({matchPatterns:lZ,defaultMatchWidth:"wide",parsePatterns:cZ,defaultParseWidth:"any",valueCallback:t=>t+1}),month:uf({matchPatterns:dZ,defaultMatchWidth:"wide",parsePatterns:uZ,defaultParseWidth:"any"}),day:uf({matchPatterns:hZ,defaultMatchWidth:"wide",parsePatterns:fZ,defaultParseWidth:"any"}),dayPeriod:uf({matchPatterns:pZ,defaultMatchWidth:"any",parsePatterns:mZ,defaultParseWidth:"any"})},xZ={code:"en-US",formatDistance:UQ,formatLong:HQ,formatRelative:GQ,localize:eZ,match:gZ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function yZ(t,e){const r=Ca(t,e?.in);return RQ(r,BQ(r))+1}function bZ(t,e){const r=Ca(t,e?.in),n=+Vg(r)-+PQ(r);return Math.round(n/hI)+1}function pI(t,e){const r=Ca(t,e?.in),n=r.getFullYear(),i=ty(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,l=mc(e?.in||t,0);l.setFullYear(n+1,0,a),l.setHours(0,0,0,0);const d=Jf(l,e),u=mc(e?.in||t,0);u.setFullYear(n,0,a),u.setHours(0,0,0,0);const h=Jf(u,e);return+r>=+d?n+1:+r>=+h?n:n-1}function vZ(t,e){const r=ty(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=pI(t,e),a=mc(e?.in||t,0);return a.setFullYear(i,0,n),a.setHours(0,0,0,0),Jf(a,e)}function wZ(t,e){const r=Ca(t,e?.in),n=+Jf(r,e)-+vZ(r,e);return Math.round(n/hI)+1}function pr(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const Kl={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return pr(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):pr(r+1,2)},d(t,e){return pr(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(t,e){return pr(t.getHours()%12||12,e.length)},H(t,e){return pr(t.getHours(),e.length)},m(t,e){return pr(t.getMinutes(),e.length)},s(t,e){return pr(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return pr(i,e.length)}},yu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},DA={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Kl.y(t,e)},Y:function(t,e,r,n){const i=pI(t,n),a=i>0?i:1-i;if(e==="YY"){const l=a%100;return pr(l,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):pr(a,e.length)},R:function(t,e){const r=fI(t);return pr(r,e.length)},u:function(t,e){const r=t.getFullYear();return pr(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return pr(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return pr(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return Kl.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return pr(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const i=wZ(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):pr(i,e.length)},I:function(t,e,r){const n=bZ(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):pr(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Kl.d(t,e)},D:function(t,e,r){const n=yZ(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):pr(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return pr(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return pr(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return pr(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let i;switch(n===12?i=yu.noon:n===0?i=yu.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let i;switch(n>=17?i=yu.evening:n>=12?i=yu.afternoon:n>=4?i=yu.morning:i=yu.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Kl.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Kl.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):pr(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):pr(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Kl.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Kl.s(t,e)},S:function(t,e){return Kl.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return $A(n);case"XXXX":case"XX":return Hc(n);default:return Hc(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return $A(n);case"xxxx":case"xx":return Hc(n);default:return Hc(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+BA(n,":");default:return"GMT"+Hc(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+BA(n,":");default:return"GMT"+Hc(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return pr(n,e.length)},T:function(t,e,r){return pr(+t,e.length)}};function BA(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),a=n%60;return a===0?r+String(i):r+String(i)+e+pr(a,2)}function $A(t,e){return t%60===0?(t>0?"-":"+")+pr(Math.abs(t)/60,2):Hc(t,e)}function Hc(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=pr(Math.trunc(n/60),2),a=pr(n%60,2);return r+i+e+a}const UA=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},mI=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},jZ=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return UA(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",UA(n,e)).replace("{{time}}",mI(i,e))},NZ={p:mI,P:jZ},kZ=/^D+$/,SZ=/^Y+$/,_Z=["D","DD","YY","YYYY"];function CZ(t){return kZ.test(t)}function EZ(t){return SZ.test(t)}function AZ(t,e,r){const n=TZ(t,e,r);if(console.warn(n),_Z.includes(t))throw new RangeError(n)}function TZ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const OZ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,MZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,LZ=/^'([^]*?)'?$/,RZ=/''/g,PZ=/[a-zA-Z]/;function ps(t,e,r){const n=ty(),i=n.locale??xZ,a=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,l=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,d=Ca(t,r?.in);if(!DQ(d))throw new RangeError("Invalid time value");let u=e.match(MZ).map(p=>{const m=p[0];if(m==="p"||m==="P"){const x=NZ[m];return x(p,i.formatLong)}return p}).join("").match(OZ).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:IZ(p)};if(DA[m])return{isToken:!0,value:p};if(m.match(PZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});i.localize.preprocessor&&(u=i.localize.preprocessor(d,u));const h={firstWeekContainsDate:a,weekStartsOn:l,locale:i};return u.map(p=>{if(!p.isToken)return p.value;const m=p.value;(EZ(m)||CZ(m))&&AZ(m,e,String(t));const x=DA[m[0]];return x(d,m,i.localize,h)}).join("")}function IZ(t){const e=t.match(LZ);return e?e[1].replace(RZ,"'"):t}var gI=typeof global=="object"&&global&&global.Object===Object&&global,DZ=typeof self=="object"&&self&&self.Object===Object&&self,oo=gI||DZ||Function("return this")(),gc=oo.Symbol,xI=Object.prototype,BZ=xI.hasOwnProperty,$Z=xI.toString,hf=gc?gc.toStringTag:void 0;function UZ(t){var e=BZ.call(t,hf),r=t[hf];try{t[hf]=void 0;var n=!0}catch{}var i=$Z.call(t);return n&&(e?t[hf]=r:delete t[hf]),i}var zZ=Object.prototype,qZ=zZ.toString;function FZ(t){return qZ.call(t)}var HZ="[object Null]",WZ="[object Undefined]",zA=gc?gc.toStringTag:void 0;function dh(t){return t==null?t===void 0?WZ:HZ:zA&&zA in Object(t)?UZ(t):FZ(t)}function Jo(t){return t!=null&&typeof t=="object"}var pd=Array.isArray;function vc(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function yI(t){return t}var GZ="[object AsyncFunction]",VZ="[object Function]",KZ="[object GeneratorFunction]",YZ="[object Proxy]";function B4(t){if(!vc(t))return!1;var e=dh(t);return e==VZ||e==KZ||e==GZ||e==YZ}var iw=oo["__core-js_shared__"],qA=(function(){var t=/[^.]+$/.exec(iw&&iw.keys&&iw.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function XZ(t){return!!qA&&qA in t}var JZ=Function.prototype,QZ=JZ.toString;function Ad(t){if(t!=null){try{return QZ.call(t)}catch{}try{return t+""}catch{}}return""}var ZZ=/[\\^$.*+?()[\]{}|]/g,eee=/^\[object .+?Constructor\]$/,tee=Function.prototype,ree=Object.prototype,nee=tee.toString,see=ree.hasOwnProperty,iee=RegExp("^"+nee.call(see).replace(ZZ,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function aee(t){if(!vc(t)||XZ(t))return!1;var e=B4(t)?iee:eee;return e.test(Ad(t))}function oee(t,e){return t?.[e]}function Td(t,e){var r=oee(t,e);return aee(r)?r:void 0}var _j=Td(oo,"WeakMap"),FA=Object.create,lee=(function(){function t(){}return function(e){if(!vc(e))return{};if(FA)return FA(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function cee(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function dee(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var uee=800,hee=16,fee=Date.now;function pee(t){var e=0,r=0;return function(){var n=fee(),i=hee-(n-r);if(r=n,i>0){if(++e>=uee)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function mee(t){return function(){return t}}var Kg=(function(){try{var t=Td(Object,"defineProperty");return t({},"",{}),t}catch{}})(),gee=Kg?function(t,e){return Kg(t,"toString",{configurable:!0,enumerable:!1,value:mee(e),writable:!0})}:yI,xee=pee(gee);function yee(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var bee=9007199254740991,vee=/^(?:0|[1-9]\d*)$/;function bI(t,e){var r=typeof t;return e=e??bee,!!e&&(r=="number"||r!="symbol"&&vee.test(t))&&t>-1&&t%1==0&&t<e}function $4(t,e,r){e=="__proto__"&&Kg?Kg(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function R0(t,e){return t===e||t!==t&&e!==e}var wee=Object.prototype,jee=wee.hasOwnProperty;function vI(t,e,r){var n=t[e];(!(jee.call(t,e)&&R0(n,r))||r===void 0&&!(e in t))&&$4(t,e,r)}function Nee(t,e,r,n){var i=!r;r||(r={});for(var a=-1,l=e.length;++a<l;){var d=e[a],u=void 0;u===void 0&&(u=t[d]),i?$4(r,d,u):vI(r,d,u)}return r}var HA=Math.max;function kee(t,e,r){return e=HA(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=HA(n.length-e,0),l=Array(a);++i<a;)l[i]=n[e+i];i=-1;for(var d=Array(e+1);++i<e;)d[i]=n[i];return d[e]=r(l),cee(t,this,d)}}function See(t,e){return xee(kee(t,e,yI),t+"")}var _ee=9007199254740991;function wI(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=_ee}function ry(t){return t!=null&&wI(t.length)&&!B4(t)}function Cee(t,e,r){if(!vc(r))return!1;var n=typeof e;return(n=="number"?ry(r)&&bI(e,r.length):n=="string"&&e in r)?R0(r[e],t):!1}function Eee(t){return See(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,l=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,l&&Cee(r[0],r[1],l)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var d=r[n];d&&t(e,d,n,a)}return e})}var Aee=Object.prototype;function U4(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Aee;return t===r}function Tee(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Oee="[object Arguments]";function WA(t){return Jo(t)&&dh(t)==Oee}var jI=Object.prototype,Mee=jI.hasOwnProperty,Lee=jI.propertyIsEnumerable,Cj=WA((function(){return arguments})())?WA:function(t){return Jo(t)&&Mee.call(t,"callee")&&!Lee.call(t,"callee")};function Ree(){return!1}var NI=typeof pi=="object"&&pi&&!pi.nodeType&&pi,GA=NI&&typeof mi=="object"&&mi&&!mi.nodeType&&mi,Pee=GA&&GA.exports===NI,VA=Pee?oo.Buffer:void 0,Iee=VA?VA.isBuffer:void 0,Qf=Iee||Ree,Dee="[object Arguments]",Bee="[object Array]",$ee="[object Boolean]",Uee="[object Date]",zee="[object Error]",qee="[object Function]",Fee="[object Map]",Hee="[object Number]",Wee="[object Object]",Gee="[object RegExp]",Vee="[object Set]",Kee="[object String]",Yee="[object WeakMap]",Xee="[object ArrayBuffer]",Jee="[object DataView]",Qee="[object Float32Array]",Zee="[object Float64Array]",ete="[object Int8Array]",tte="[object Int16Array]",rte="[object Int32Array]",nte="[object Uint8Array]",ste="[object Uint8ClampedArray]",ite="[object Uint16Array]",ate="[object Uint32Array]",Dr={};Dr[Qee]=Dr[Zee]=Dr[ete]=Dr[tte]=Dr[rte]=Dr[nte]=Dr[ste]=Dr[ite]=Dr[ate]=!0;Dr[Dee]=Dr[Bee]=Dr[Xee]=Dr[$ee]=Dr[Jee]=Dr[Uee]=Dr[zee]=Dr[qee]=Dr[Fee]=Dr[Hee]=Dr[Wee]=Dr[Gee]=Dr[Vee]=Dr[Kee]=Dr[Yee]=!1;function ote(t){return Jo(t)&&wI(t.length)&&!!Dr[dh(t)]}function z4(t){return function(e){return t(e)}}var kI=typeof pi=="object"&&pi&&!pi.nodeType&&pi,$f=kI&&typeof mi=="object"&&mi&&!mi.nodeType&&mi,lte=$f&&$f.exports===kI,aw=lte&&gI.process,Gu=(function(){try{var t=$f&&$f.require&&$f.require("util").types;return t||aw&&aw.binding&&aw.binding("util")}catch{}})(),KA=Gu&&Gu.isTypedArray,q4=KA?z4(KA):ote,cte=Object.prototype,dte=cte.hasOwnProperty;function SI(t,e){var r=pd(t),n=!r&&Cj(t),i=!r&&!n&&Qf(t),a=!r&&!n&&!i&&q4(t),l=r||n||i||a,d=l?Tee(t.length,String):[],u=d.length;for(var h in t)(e||dte.call(t,h))&&!(l&&(h=="length"||i&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||bI(h,u)))&&d.push(h);return d}function _I(t,e){return function(r){return t(e(r))}}var ute=_I(Object.keys,Object),hte=Object.prototype,fte=hte.hasOwnProperty;function pte(t){if(!U4(t))return ute(t);var e=[];for(var r in Object(t))fte.call(t,r)&&r!="constructor"&&e.push(r);return e}function mte(t){return ry(t)?SI(t):pte(t)}function gte(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var xte=Object.prototype,yte=xte.hasOwnProperty;function bte(t){if(!vc(t))return gte(t);var e=U4(t),r=[];for(var n in t)n=="constructor"&&(e||!yte.call(t,n))||r.push(n);return r}function CI(t){return ry(t)?SI(t,!0):bte(t)}var Zf=Td(Object,"create");function vte(){this.__data__=Zf?Zf(null):{},this.size=0}function wte(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var jte="__lodash_hash_undefined__",Nte=Object.prototype,kte=Nte.hasOwnProperty;function Ste(t){var e=this.__data__;if(Zf){var r=e[t];return r===jte?void 0:r}return kte.call(e,t)?e[t]:void 0}var _te=Object.prototype,Cte=_te.hasOwnProperty;function Ete(t){var e=this.__data__;return Zf?e[t]!==void 0:Cte.call(e,t)}var Ate="__lodash_hash_undefined__";function Tte(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Zf&&e===void 0?Ate:e,this}function md(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}md.prototype.clear=vte;md.prototype.delete=wte;md.prototype.get=Ste;md.prototype.has=Ete;md.prototype.set=Tte;function Ote(){this.__data__=[],this.size=0}function ny(t,e){for(var r=t.length;r--;)if(R0(t[r][0],e))return r;return-1}var Mte=Array.prototype,Lte=Mte.splice;function Rte(t){var e=this.__data__,r=ny(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Lte.call(e,r,1),--this.size,!0}function Pte(t){var e=this.__data__,r=ny(e,t);return r<0?void 0:e[r][1]}function Ite(t){return ny(this.__data__,t)>-1}function Dte(t,e){var r=this.__data__,n=ny(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function ul(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ul.prototype.clear=Ote;ul.prototype.delete=Rte;ul.prototype.get=Pte;ul.prototype.has=Ite;ul.prototype.set=Dte;var e0=Td(oo,"Map");function Bte(){this.size=0,this.__data__={hash:new md,map:new(e0||ul),string:new md}}function $te(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function sy(t,e){var r=t.__data__;return $te(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Ute(t){var e=sy(this,t).delete(t);return this.size-=e?1:0,e}function zte(t){return sy(this,t).get(t)}function qte(t){return sy(this,t).has(t)}function Fte(t,e){var r=sy(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Od(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Od.prototype.clear=Bte;Od.prototype.delete=Ute;Od.prototype.get=zte;Od.prototype.has=qte;Od.prototype.set=Fte;function Hte(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var EI=_I(Object.getPrototypeOf,Object),Wte="[object Object]",Gte=Function.prototype,Vte=Object.prototype,AI=Gte.toString,Kte=Vte.hasOwnProperty,Yte=AI.call(Object);function Xte(t){if(!Jo(t)||dh(t)!=Wte)return!1;var e=EI(t);if(e===null)return!0;var r=Kte.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&AI.call(r)==Yte}function Jte(){this.__data__=new ul,this.size=0}function Qte(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Zte(t){return this.__data__.get(t)}function ere(t){return this.__data__.has(t)}var tre=200;function rre(t,e){var r=this.__data__;if(r instanceof ul){var n=r.__data__;if(!e0||n.length<tre-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Od(n)}return r.set(t,e),this.size=r.size,this}function Ya(t){var e=this.__data__=new ul(t);this.size=e.size}Ya.prototype.clear=Jte;Ya.prototype.delete=Qte;Ya.prototype.get=Zte;Ya.prototype.has=ere;Ya.prototype.set=rre;var TI=typeof pi=="object"&&pi&&!pi.nodeType&&pi,YA=TI&&typeof mi=="object"&&mi&&!mi.nodeType&&mi,nre=YA&&YA.exports===TI,XA=nre?oo.Buffer:void 0,JA=XA?XA.allocUnsafe:void 0;function OI(t,e){if(e)return t.slice();var r=t.length,n=JA?JA(r):new t.constructor(r);return t.copy(n),n}function sre(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var l=t[r];e(l,r,t)&&(a[i++]=l)}return a}function ire(){return[]}var are=Object.prototype,ore=are.propertyIsEnumerable,QA=Object.getOwnPropertySymbols,lre=QA?function(t){return t==null?[]:(t=Object(t),sre(QA(t),function(e){return ore.call(t,e)}))}:ire;function cre(t,e,r){var n=e(t);return pd(t)?n:Hte(n,r(t))}function Ej(t){return cre(t,mte,lre)}var Aj=Td(oo,"DataView"),Tj=Td(oo,"Promise"),Oj=Td(oo,"Set"),ZA="[object Map]",dre="[object Object]",e6="[object Promise]",t6="[object Set]",r6="[object WeakMap]",n6="[object DataView]",ure=Ad(Aj),hre=Ad(e0),fre=Ad(Tj),pre=Ad(Oj),mre=Ad(_j),fa=dh;(Aj&&fa(new Aj(new ArrayBuffer(1)))!=n6||e0&&fa(new e0)!=ZA||Tj&&fa(Tj.resolve())!=e6||Oj&&fa(new Oj)!=t6||_j&&fa(new _j)!=r6)&&(fa=function(t){var e=dh(t),r=e==dre?t.constructor:void 0,n=r?Ad(r):"";if(n)switch(n){case ure:return n6;case hre:return ZA;case fre:return e6;case pre:return t6;case mre:return r6}return e});var gre=Object.prototype,xre=gre.hasOwnProperty;function yre(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&xre.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Yg=oo.Uint8Array;function F4(t){var e=new t.constructor(t.byteLength);return new Yg(e).set(new Yg(t)),e}function bre(t,e){var r=F4(t.buffer);return new t.constructor(r,t.byteOffset,t.byteLength)}var vre=/\w*$/;function wre(t){var e=new t.constructor(t.source,vre.exec(t));return e.lastIndex=t.lastIndex,e}var s6=gc?gc.prototype:void 0,i6=s6?s6.valueOf:void 0;function jre(t){return i6?Object(i6.call(t)):{}}function MI(t,e){var r=e?F4(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Nre="[object Boolean]",kre="[object Date]",Sre="[object Map]",_re="[object Number]",Cre="[object RegExp]",Ere="[object Set]",Are="[object String]",Tre="[object Symbol]",Ore="[object ArrayBuffer]",Mre="[object DataView]",Lre="[object Float32Array]",Rre="[object Float64Array]",Pre="[object Int8Array]",Ire="[object Int16Array]",Dre="[object Int32Array]",Bre="[object Uint8Array]",$re="[object Uint8ClampedArray]",Ure="[object Uint16Array]",zre="[object Uint32Array]";function qre(t,e,r){var n=t.constructor;switch(e){case Ore:return F4(t);case Nre:case kre:return new n(+t);case Mre:return bre(t);case Lre:case Rre:case Pre:case Ire:case Dre:case Bre:case $re:case Ure:case zre:return MI(t,r);case Sre:return new n;case _re:case Are:return new n(t);case Cre:return wre(t);case Ere:return new n;case Tre:return jre(t)}}function LI(t){return typeof t.constructor=="function"&&!U4(t)?lee(EI(t)):{}}var Fre="[object Map]";function Hre(t){return Jo(t)&&fa(t)==Fre}var a6=Gu&&Gu.isMap,Wre=a6?z4(a6):Hre,Gre="[object Set]";function Vre(t){return Jo(t)&&fa(t)==Gre}var o6=Gu&&Gu.isSet,Kre=o6?z4(o6):Vre,Yre=1,RI="[object Arguments]",Xre="[object Array]",Jre="[object Boolean]",Qre="[object Date]",Zre="[object Error]",PI="[object Function]",ene="[object GeneratorFunction]",tne="[object Map]",rne="[object Number]",II="[object Object]",nne="[object RegExp]",sne="[object Set]",ine="[object String]",ane="[object Symbol]",one="[object WeakMap]",lne="[object ArrayBuffer]",cne="[object DataView]",dne="[object Float32Array]",une="[object Float64Array]",hne="[object Int8Array]",fne="[object Int16Array]",pne="[object Int32Array]",mne="[object Uint8Array]",gne="[object Uint8ClampedArray]",xne="[object Uint16Array]",yne="[object Uint32Array]",Er={};Er[RI]=Er[Xre]=Er[lne]=Er[cne]=Er[Jre]=Er[Qre]=Er[dne]=Er[une]=Er[hne]=Er[fne]=Er[pne]=Er[tne]=Er[rne]=Er[II]=Er[nne]=Er[sne]=Er[ine]=Er[ane]=Er[mne]=Er[gne]=Er[xne]=Er[yne]=!0;Er[Zre]=Er[PI]=Er[one]=!1;function kg(t,e,r,n,i,a){var l,d=e&Yre;if(l!==void 0)return l;if(!vc(t))return t;var u=pd(t);if(u)l=yre(t);else{var h=fa(t),p=h==PI||h==ene;if(Qf(t))return OI(t,d);if(h==II||h==RI||p&&!i)l=p?{}:LI(t);else{if(!Er[h])return i?t:{};l=qre(t,h,d)}}a||(a=new Ya);var m=a.get(t);if(m)return m;a.set(t,l),Kre(t)?t.forEach(function(v){l.add(kg(v,e,r,v,t,a))}):Wre(t)&&t.forEach(function(v,w){l.set(w,kg(v,e,r,w,t,a))});var x=Ej,b=u?void 0:x(t);return yee(b||t,function(v,w){b&&(w=v,v=t[w]),vI(l,w,kg(v,e,r,w,t,a))}),l}var bne=1,vne=4;function $u(t){return kg(t,bne|vne)}var wne="__lodash_hash_undefined__";function jne(t){return this.__data__.set(t,wne),this}function Nne(t){return this.__data__.has(t)}function Xg(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Od;++e<r;)this.add(t[e])}Xg.prototype.add=Xg.prototype.push=jne;Xg.prototype.has=Nne;function kne(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Sne(t,e){return t.has(e)}var _ne=1,Cne=2;function DI(t,e,r,n,i,a){var l=r&_ne,d=t.length,u=e.length;if(d!=u&&!(l&&u>d))return!1;var h=a.get(t),p=a.get(e);if(h&&p)return h==e&&p==t;var m=-1,x=!0,b=r&Cne?new Xg:void 0;for(a.set(t,e),a.set(e,t);++m<d;){var v=t[m],w=e[m];if(n)var k=l?n(w,v,m,e,t,a):n(v,w,m,t,e,a);if(k!==void 0){if(k)continue;x=!1;break}if(b){if(!kne(e,function(_,T){if(!Sne(b,T)&&(v===_||i(v,_,r,n,a)))return b.push(T)})){x=!1;break}}else if(!(v===w||i(v,w,r,n,a))){x=!1;break}}return a.delete(t),a.delete(e),x}function Ene(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function Ane(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Tne=1,One=2,Mne="[object Boolean]",Lne="[object Date]",Rne="[object Error]",Pne="[object Map]",Ine="[object Number]",Dne="[object RegExp]",Bne="[object Set]",$ne="[object String]",Une="[object Symbol]",zne="[object ArrayBuffer]",qne="[object DataView]",l6=gc?gc.prototype:void 0,ow=l6?l6.valueOf:void 0;function Fne(t,e,r,n,i,a,l){switch(r){case qne:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case zne:return!(t.byteLength!=e.byteLength||!a(new Yg(t),new Yg(e)));case Mne:case Lne:case Ine:return R0(+t,+e);case Rne:return t.name==e.name&&t.message==e.message;case Dne:case $ne:return t==e+"";case Pne:var d=Ene;case Bne:var u=n&Tne;if(d||(d=Ane),t.size!=e.size&&!u)return!1;var h=l.get(t);if(h)return h==e;n|=One,l.set(t,e);var p=DI(d(t),d(e),n,i,a,l);return l.delete(t),p;case Une:if(ow)return ow.call(t)==ow.call(e)}return!1}var Hne=1,Wne=Object.prototype,Gne=Wne.hasOwnProperty;function Vne(t,e,r,n,i,a){var l=r&Hne,d=Ej(t),u=d.length,h=Ej(e),p=h.length;if(u!=p&&!l)return!1;for(var m=u;m--;){var x=d[m];if(!(l?x in e:Gne.call(e,x)))return!1}var b=a.get(t),v=a.get(e);if(b&&v)return b==e&&v==t;var w=!0;a.set(t,e),a.set(e,t);for(var k=l;++m<u;){x=d[m];var _=t[x],T=e[x];if(n)var A=l?n(T,_,x,e,t,a):n(_,T,x,t,e,a);if(!(A===void 0?_===T||i(_,T,r,n,a):A)){w=!1;break}k||(k=x=="constructor")}if(w&&!k){var I=t.constructor,O=e.constructor;I!=O&&"constructor"in t&&"constructor"in e&&!(typeof I=="function"&&I instanceof I&&typeof O=="function"&&O instanceof O)&&(w=!1)}return a.delete(t),a.delete(e),w}var Kne=1,c6="[object Arguments]",d6="[object Array]",Am="[object Object]",Yne=Object.prototype,u6=Yne.hasOwnProperty;function Xne(t,e,r,n,i,a){var l=pd(t),d=pd(e),u=l?d6:fa(t),h=d?d6:fa(e);u=u==c6?Am:u,h=h==c6?Am:h;var p=u==Am,m=h==Am,x=u==h;if(x&&Qf(t)){if(!Qf(e))return!1;l=!0,p=!1}if(x&&!p)return a||(a=new Ya),l||q4(t)?DI(t,e,r,n,i,a):Fne(t,e,u,r,n,i,a);if(!(r&Kne)){var b=p&&u6.call(t,"__wrapped__"),v=m&&u6.call(e,"__wrapped__");if(b||v){var w=b?t.value():t,k=v?e.value():e;return a||(a=new Ya),i(w,k,r,n,a)}}return x?(a||(a=new Ya),Vne(t,e,r,n,i,a)):!1}function BI(t,e,r,n,i){return t===e?!0:t==null||e==null||!Jo(t)&&!Jo(e)?t!==t&&e!==e:Xne(t,e,r,n,BI,i)}function Jne(t){return function(e,r,n){for(var i=-1,a=Object(e),l=n(e),d=l.length;d--;){var u=l[++i];if(r(a[u],u,a)===!1)break}return e}}var Qne=Jne();function Mj(t,e,r){(r!==void 0&&!R0(t[e],r)||r===void 0&&!(e in t))&&$4(t,e,r)}function Zne(t){return Jo(t)&&ry(t)}function Lj(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function ese(t){return Nee(t,CI(t))}function tse(t,e,r,n,i,a,l){var d=Lj(t,r),u=Lj(e,r),h=l.get(u);if(h){Mj(t,r,h);return}var p=a?a(d,u,r+"",t,e,l):void 0,m=p===void 0;if(m){var x=pd(u),b=!x&&Qf(u),v=!x&&!b&&q4(u);p=u,x||b||v?pd(d)?p=d:Zne(d)?p=dee(d):b?(m=!1,p=OI(u,!0)):v?(m=!1,p=MI(u,!0)):p=[]:Xte(u)||Cj(u)?(p=d,Cj(d)?p=ese(d):(!vc(d)||B4(d))&&(p=LI(u))):m=!1}m&&(l.set(u,p),i(p,u,n,a,l),l.delete(u)),Mj(t,r,p)}function $I(t,e,r,n,i){t!==e&&Qne(e,function(a,l){if(i||(i=new Ya),vc(a))tse(t,e,l,r,$I,n,i);else{var d=n?n(Lj(t,l),a,l+"",t,e,i):void 0;d===void 0&&(d=a),Mj(t,l,d)}},CI)}function tc(t,e){return BI(t,e)}var dc=Eee(function(t,e,r){$I(t,e,r)}),ht=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(ht||{});class Za{constructor(e,r,n={}){this.attrName=e,this.keyName=r;const i=ht.TYPE&ht.ATTRIBUTE;this.scope=n.scope!=null?n.scope&ht.LEVEL|i:ht.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(e){return Array.from(e.attributes).map(r=>r.name)}add(e,r){return this.canAdd(e,r)?(e.setAttribute(this.keyName,r),!0):!1}canAdd(e,r){return this.whitelist==null?!0:typeof r=="string"?this.whitelist.indexOf(r.replace(/["']/g,""))>-1:this.whitelist.indexOf(r)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const r=e.getAttribute(this.keyName);return this.canAdd(e,r)&&r?r:""}}class Uu extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const UI=class Rj{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,r=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(r){let n=null;try{n=e.parentNode}catch{return null}return this.find(n,r)}return null}create(e,r,n){const i=this.query(r);if(i==null)throw new Uu(`Unable to create ${r} blot`);const a=i,l=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:a.create(n),d=new a(e,l,n);return Rj.blots.set(d.domNode,d),d}find(e,r=!1){return Rj.find(e,r)}query(e,r=ht.ANY){let n;return typeof e=="string"?n=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?n=this.types.text:typeof e=="number"?e&ht.LEVEL&ht.BLOCK?n=this.types.block:e&ht.LEVEL&ht.INLINE&&(n=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(i=>(n=this.classes[i],!!n)),n=n||this.tags[e.tagName]),n==null?null:"scope"in n&&r&ht.LEVEL&n.scope&&r&ht.TYPE&n.scope?n:null}register(...e){return e.map(r=>{const n="blotName"in r,i="attrName"in r;if(!n&&!i)throw new Uu("Invalid definition");if(n&&r.blotName==="abstract")throw new Uu("Cannot register abstract class");const a=n?r.blotName:i?r.attrName:void 0;return this.types[a]=r,i?typeof r.keyName=="string"&&(this.attributes[r.keyName]=r):n&&(r.className&&(this.classes[r.className]=r),r.tagName&&(Array.isArray(r.tagName)?r.tagName=r.tagName.map(l=>l.toUpperCase()):r.tagName=r.tagName.toUpperCase(),(Array.isArray(r.tagName)?r.tagName:[r.tagName]).forEach(l=>{(this.tags[l]==null||r.className==null)&&(this.tags[l]=r)}))),r})}};UI.blots=new WeakMap;let Vu=UI;function h6(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter(r=>r.indexOf(`${e}-`)===0)}class rse extends Za{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(r=>r.split("-").slice(0,-1).join("-"))}add(e,r){return this.canAdd(e,r)?(this.remove(e),e.classList.add(`${this.keyName}-${r}`),!0):!1}remove(e){h6(e,this.keyName).forEach(r=>{e.classList.remove(r)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const r=(h6(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,r)?r:""}}const Ea=rse;function lw(t){const e=t.split("-"),r=e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return e[0]+r}class nse extends Za{static keys(e){return(e.getAttribute("style")||"").split(";").map(r=>r.split(":")[0].trim())}add(e,r){return this.canAdd(e,r)?(e.style[lw(this.keyName)]=r,!0):!1}remove(e){e.style[lw(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const r=e.style[lw(this.keyName)];return this.canAdd(e,r)?r:""}}const wc=nse;class sse{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,r){r?e.add(this.domNode,r)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=Vu.find(this.domNode);if(e==null)return;const r=Za.keys(this.domNode),n=Ea.keys(this.domNode),i=wc.keys(this.domNode);r.concat(n).concat(i).forEach(a=>{const l=e.scroll.query(a,ht.ATTRIBUTE);l instanceof Za&&(this.attributes[l.attrName]=l)})}copy(e){Object.keys(this.attributes).forEach(r=>{const n=this.attributes[r].value(this.domNode);e.format(r,n)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(r=>{this.attributes[r].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,r)=>(e[r]=this.attributes[r].value(this.domNode),e),{})}}const iy=sse,zI=class{constructor(e,r){this.scroll=e,this.domNode=r,Vu.blots.set(r,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new Uu("Blot definition missing tagName");let r,n;return Array.isArray(this.tagName)?(typeof e=="string"?(n=e.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof e=="number"&&(n=e),typeof n=="number"?r=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?r=document.createElement(n):r=document.createElement(this.tagName[0])):r=document.createElement(this.tagName),this.className&&r.classList.add(this.className),r}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),Vu.blots.delete(this.domNode)}deleteAt(e,r){this.isolate(e,r).remove()}formatAt(e,r,n,i){const a=this.isolate(e,r);if(this.scroll.query(n,ht.BLOT)!=null&&i)a.wrap(n,i);else if(this.scroll.query(n,ht.ATTRIBUTE)!=null){const l=this.scroll.create(this.statics.scope);a.wrap(l),l.format(n,i)}}insertAt(e,r,n){const i=n==null?this.scroll.create("text",r):this.scroll.create(r,n),a=this.split(e);this.parent.insertBefore(i,a||void 0)}isolate(e,r){const n=this.split(e);if(n==null)throw new Error("Attempt to isolate at end");return n.split(r),n}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(e,r){return e===0?this:this.next}update(e,r){}wrap(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new Uu(`Cannot wrap ${e}`);return n.appendChild(this),n}};zI.blotName="abstract";let qI=zI;const FI=class extends qI{static value(e){return!0}index(e,r){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(r,1):-1}position(e,r){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};FI.scope=ht.INLINE_BLOT;let ise=FI;const ms=ise;class ase{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const r=e.slice(1);this.append(...r)}}at(e){const r=this.iterator();let n=r();for(;n&&e>0;)e-=1,n=r();return n}contains(e){const r=this.iterator();let n=r();for(;n;){if(n===e)return!0;n=r()}return!1}indexOf(e){const r=this.iterator();let n=r(),i=0;for(;n;){if(n===e)return i;i+=1,n=r()}return-1}insertBefore(e,r){e!=null&&(this.remove(e),e.next=r,r!=null?(e.prev=r.prev,r.prev!=null&&(r.prev.next=e),r.prev=e,r===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let r=0,n=this.head;for(;n!=null;){if(n===e)return r;r+=n.length(),n=n.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const r=e;return e!=null&&(e=e.next),r}}find(e,r=!1){const n=this.iterator();let i=n();for(;i;){const a=i.length();if(e<a||r&&e===a&&(i.next==null||i.next.length()!==0))return[i,e];e-=a,i=n()}return[null,0]}forEach(e){const r=this.iterator();let n=r();for(;n;)e(n),n=r()}forEachAt(e,r,n){if(r<=0)return;const[i,a]=this.find(e);let l=e-a;const d=this.iterator(i);let u=d();for(;u&&l<e+r;){const h=u.length();e>l?n(u,e-l,Math.min(r,l+h-e)):n(u,0,Math.min(h,e+r-l)),l+=h,u=d()}}map(e){return this.reduce((r,n)=>(r.push(e(n)),r),[])}reduce(e,r){const n=this.iterator();let i=n();for(;i;)r=e(r,i),i=n();return r}}function f6(t,e){const r=e.find(t);if(r)return r;try{return e.create(t)}catch{const n=e.create(ht.INLINE);return Array.from(t.childNodes).forEach(i=>{n.domNode.appendChild(i)}),t.parentNode&&t.parentNode.replaceChild(n.domNode,t),n.attach(),n}}const HI=class Yl extends qI{constructor(e,r){super(e,r),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,Yl.uiClass&&this.uiNode.classList.add(Yl.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new ase,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const r=f6(e,this.scroll);this.insertBefore(r,this.children.head||void 0)}catch(r){if(r instanceof Uu)return;throw r}})}deleteAt(e,r){if(e===0&&r===this.length())return this.remove();this.children.forEachAt(e,r,(n,i,a)=>{n.deleteAt(i,a)})}descendant(e,r=0){const[n,i]=this.children.find(r);return e.blotName==null&&e(n)||e.blotName!=null&&n instanceof e?[n,i]:n instanceof Yl?n.descendant(e,i):[null,-1]}descendants(e,r=0,n=Number.MAX_VALUE){let i=[],a=n;return this.children.forEachAt(r,n,(l,d,u)=>{(e.blotName==null&&e(l)||e.blotName!=null&&l instanceof e)&&i.push(l),l instanceof Yl&&(i=i.concat(l.descendants(e,d,a))),a-=u}),i}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(r=>{e||this.statics.allowedChildren.some(n=>r instanceof n)||(r.statics.scope===ht.BLOCK_BLOT?(r.next!=null&&this.splitAfter(r),r.prev!=null&&this.splitAfter(r.prev),r.parent.unwrap(),e=!0):r instanceof Yl?r.unwrap():r.remove())})}formatAt(e,r,n,i){this.children.forEachAt(e,r,(a,l,d)=>{a.formatAt(l,d,n,i)})}insertAt(e,r,n){const[i,a]=this.children.find(e);if(i)i.insertAt(a,r,n);else{const l=n==null?this.scroll.create("text",r):this.scroll.create(r,n);this.appendChild(l)}}insertBefore(e,r){e.parent!=null&&e.parent.children.remove(e);let n=null;this.children.insertBefore(e,r||null),e.parent=this,r!=null&&(n=r.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(e.domNode,n),e.attach()}length(){return this.children.reduce((e,r)=>e+r.length(),0)}moveChildren(e,r){this.children.forEach(n=>{e.insertBefore(n,r)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const r=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(r)}else this.remove()}path(e,r=!1){const[n,i]=this.children.find(e,r),a=[[this,e]];return n instanceof Yl?a.concat(n.path(i,r)):(n!=null&&a.push([n,i]),a)}removeChild(e){this.children.remove(e)}replaceWith(e,r){const n=typeof e=="string"?this.scroll.create(e,r):e;return n instanceof Yl&&this.moveChildren(n),super.replaceWith(n)}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(e,this.length(),(i,a,l)=>{const d=i.split(a,r);d!=null&&n.appendChild(d)}),n}splitAfter(e){const r=this.clone();for(;e.next!=null;)r.appendChild(e.next);return this.parent&&this.parent.insertBefore(r,this.next||void 0),r}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,r){const n=[],i=[];e.forEach(a=>{a.target===this.domNode&&a.type==="childList"&&(n.push(...a.addedNodes),i.push(...a.removedNodes))}),i.forEach(a=>{if(a.parentNode!=null&&a.tagName!=="IFRAME"&&document.body.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const l=this.scroll.find(a);l!=null&&(l.domNode.parentNode==null||l.domNode.parentNode===this.domNode)&&l.detach()}),n.filter(a=>a.parentNode===this.domNode&&a!==this.uiNode).sort((a,l)=>a===l?0:a.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(a=>{let l=null;a.nextSibling!=null&&(l=this.scroll.find(a.nextSibling));const d=f6(a,this.scroll);(d.next!==l||d.next==null)&&(d.parent!=null&&d.parent.removeChild(this),this.insertBefore(d,l||void 0))}),this.enforceAllowedChildren()}};HI.uiClass="";let ose=HI;const ja=ose;function lse(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}const ku=class Su extends ja{static create(e){return super.create(e)}static formats(e,r){const n=r.query(Su.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new iy(this.domNode)}format(e,r){if(e===this.statics.blotName&&!r)this.children.forEach(n=>{n instanceof Su||(n=n.wrap(Su.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{const n=this.scroll.query(e,ht.INLINE);if(n==null)return;n instanceof Za?this.attributes.attribute(n,r):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r)}}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,i){this.formats()[n]!=null||this.scroll.query(n,ht.ATTRIBUTE)?this.isolate(e,r).format(n,i):super.formatAt(e,r,n,i)}optimize(e){super.optimize(e);const r=this.formats();if(Object.keys(r).length===0)return this.unwrap();const n=this.next;n instanceof Su&&n.prev===this&&lse(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(e,r){const n=super.wrap(e,r);return n instanceof Su&&this.attributes.move(n),n}};ku.allowedChildren=[ku,ms],ku.blotName="inline",ku.scope=ht.INLINE_BLOT,ku.tagName="SPAN";let cse=ku;const H4=cse,_u=class Pj extends ja{static create(e){return super.create(e)}static formats(e,r){const n=r.query(Pj.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,r){super(e,r),this.attributes=new iy(this.domNode)}format(e,r){const n=this.scroll.query(e,ht.BLOCK);n!=null&&(n instanceof Za?this.attributes.attribute(n,r):e===this.statics.blotName&&!r?this.replaceWith(Pj.blotName):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r))}formats(){const e=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(e[this.statics.blotName]=r),e}formatAt(e,r,n,i){this.scroll.query(n,ht.BLOCK)!=null?this.format(n,i):super.formatAt(e,r,n,i)}insertAt(e,r,n){if(n==null||this.scroll.query(r,ht.INLINE)!=null)super.insertAt(e,r,n);else{const i=this.split(e);if(i!=null){const a=this.scroll.create(r,n);i.parent.insertBefore(a,i)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,r){const n=super.replaceWith(e,r);return this.attributes.copy(n),n}update(e,r){super.update(e,r),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};_u.blotName="block",_u.scope=ht.BLOCK_BLOT,_u.tagName="P",_u.allowedChildren=[H4,_u,ms];let dse=_u;const t0=dse,Ij=class extends ja{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,r){super.deleteAt(e,r),this.enforceAllowedChildren()}formatAt(e,r,n,i){super.formatAt(e,r,n,i),this.enforceAllowedChildren()}insertAt(e,r,n){super.insertAt(e,r,n),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Ij.blotName="container",Ij.scope=ht.BLOCK_BLOT;let use=Ij;const ay=use;class hse extends ms{static formats(e,r){}format(e,r){super.formatAt(0,this.length(),e,r)}formatAt(e,r,n,i){e===0&&r===this.length()?this.format(n,i):super.formatAt(e,r,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const bi=hse,fse={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},pse=100,Cu=class extends ja{constructor(e,r){super(null,r),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,fse),this.attach()}create(e,r){return this.registry.create(this,e,r)}find(e,r=!1){const n=this.registry.find(e,r);return n?n.scroll===this?n:r?this.find(n.scroll.domNode.parentNode,!0):null:null}query(e,r=ht.ANY){return this.registry.query(e,r)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,r){this.update(),e===0&&r===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(e,r)}formatAt(e,r,n,i){this.update(),super.formatAt(e,r,n,i)}insertAt(e,r,n){this.update(),super.insertAt(e,r,n)}optimize(e=[],r={}){super.optimize(r);const n=r.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)e.push(i.pop());const a=(u,h=!0)=>{u==null||u===this||u.domNode.parentNode!=null&&(n.has(u.domNode)||n.set(u.domNode,[]),h&&a(u.parent))},l=u=>{n.has(u.domNode)&&(u instanceof ja&&u.children.forEach(l),n.delete(u.domNode),u.optimize(r))};let d=e;for(let u=0;d.length>0;u+=1){if(u>=pse)throw new Error("[Parchment] Maximum optimize iterations reached");for(d.forEach(h=>{const p=this.find(h.target,!0);p!=null&&(p.domNode===h.target&&(h.type==="childList"?(a(this.find(h.previousSibling,!1)),Array.from(h.addedNodes).forEach(m=>{const x=this.find(m,!1);a(x,!1),x instanceof ja&&x.children.forEach(b=>{a(b,!1)})})):h.type==="attributes"&&a(p.prev)),a(p))}),this.children.forEach(l),d=Array.from(this.observer.takeRecords()),i=d.slice();i.length>0;)e.push(i.pop())}}update(e,r={}){e=e||this.observer.takeRecords();const n=new WeakMap;e.map(i=>{const a=this.find(i.target,!0);return a==null?null:n.has(a.domNode)?(n.get(a.domNode).push(i),null):(n.set(a.domNode,[i]),a)}).forEach(i=>{i!=null&&i!==this&&n.has(i.domNode)&&i.update(n.get(i.domNode)||[],r)}),r.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),r),this.optimize(e,r)}};Cu.blotName="scroll",Cu.defaultChild=t0,Cu.allowedChildren=[t0,ay],Cu.scope=ht.BLOCK_BLOT,Cu.tagName="DIV";let mse=Cu;const W4=mse,Dj=class WI extends ms{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,r){super(e,r),this.text=this.statics.value(this.domNode)}deleteAt(e,r){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+r)}index(e,r){return this.domNode===e?r:-1}insertAt(e,r,n){n==null?(this.text=this.text.slice(0,e)+r+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,r,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof WI&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,r=!1){return[this.domNode,e]}split(e,r=!1){if(!r){if(e===0)return this;if(e===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(e,r){e.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Dj.blotName="text",Dj.scope=ht.INLINE_BLOT;let gse=Dj;const Jg=gse,xse=Object.freeze(Object.defineProperty({__proto__:null,Attributor:Za,AttributorStore:iy,BlockBlot:t0,ClassAttributor:Ea,ContainerBlot:ay,EmbedBlot:bi,InlineBlot:H4,LeafBlot:ms,ParentBlot:ja,Registry:Vu,Scope:ht,ScrollBlot:W4,StyleAttributor:wc,TextBlot:Jg},Symbol.toStringTag,{value:"Module"}));var Tm={exports:{}},cw,p6;function yse(){if(p6)return cw;p6=1;var t=-1,e=1,r=0;function n(C,U,L,q,K){if(C===U)return C?[[r,C]]:[];if(L!=null){var W=$(C,U,L);if(W)return W}var V=d(C,U),X=C.substring(0,V);C=C.substring(V),U=U.substring(V),V=h(C,U);var Z=C.substring(C.length-V);C=C.substring(0,C.length-V),U=U.substring(0,U.length-V);var G=i(C,U);return X&&G.unshift([r,X]),Z&&G.push([r,Z]),T(G,K),q&&m(G),G}function i(C,U){var L;if(!C)return[[e,U]];if(!U)return[[t,C]];var q=C.length>U.length?C:U,K=C.length>U.length?U:C,W=q.indexOf(K);if(W!==-1)return L=[[e,q.substring(0,W)],[r,K],[e,q.substring(W+K.length)]],C.length>U.length&&(L[0][0]=L[2][0]=t),L;if(K.length===1)return[[t,C],[e,U]];var V=p(C,U);if(V){var X=V[0],Z=V[1],G=V[2],F=V[3],Y=V[4],ne=n(X,G),re=n(Z,F);return ne.concat([[r,Y]],re)}return a(C,U)}function a(C,U){for(var L=C.length,q=U.length,K=Math.ceil((L+q)/2),W=K,V=2*K,X=new Array(V),Z=new Array(V),G=0;G<V;G++)X[G]=-1,Z[G]=-1;X[W+1]=0,Z[W+1]=0;for(var F=L-q,Y=F%2!==0,ne=0,re=0,ue=0,Le=0,de=0;de<K;de++){for(var ve=-de+ne;ve<=de-re;ve+=2){var te=W+ve,ge;ve===-de||ve!==de&&X[te-1]<X[te+1]?ge=X[te+1]:ge=X[te-1]+1;for(var ke=ge-ve;ge<L&&ke<q&&C.charAt(ge)===U.charAt(ke);)ge++,ke++;if(X[te]=ge,ge>L)re+=2;else if(ke>q)ne+=2;else if(Y){var oe=W+F-ve;if(oe>=0&&oe<V&&Z[oe]!==-1){var Ee=L-Z[oe];if(ge>=Ee)return l(C,U,ge,ke)}}}for(var Te=-de+ue;Te<=de-Le;Te+=2){var oe=W+Te,Ee;Te===-de||Te!==de&&Z[oe-1]<Z[oe+1]?Ee=Z[oe+1]:Ee=Z[oe-1]+1;for(var Ye=Ee-Te;Ee<L&&Ye<q&&C.charAt(L-Ee-1)===U.charAt(q-Ye-1);)Ee++,Ye++;if(Z[oe]=Ee,Ee>L)Le+=2;else if(Ye>q)ue+=2;else if(!Y){var te=W+F-Te;if(te>=0&&te<V&&X[te]!==-1){var ge=X[te],ke=W+ge-te;if(Ee=L-Ee,ge>=Ee)return l(C,U,ge,ke)}}}}return[[t,C],[e,U]]}function l(C,U,L,q){var K=C.substring(0,L),W=U.substring(0,q),V=C.substring(L),X=U.substring(q),Z=n(K,W),G=n(V,X);return Z.concat(G)}function d(C,U){if(!C||!U||C.charAt(0)!==U.charAt(0))return 0;for(var L=0,q=Math.min(C.length,U.length),K=q,W=0;L<K;)C.substring(W,K)==U.substring(W,K)?(L=K,W=L):q=K,K=Math.floor((q-L)/2+L);return A(C.charCodeAt(K-1))&&K--,K}function u(C,U){var L=C.length,q=U.length;if(L==0||q==0)return 0;L>q?C=C.substring(L-q):L<q&&(U=U.substring(0,L));var K=Math.min(L,q);if(C==U)return K;for(var W=0,V=1;;){var X=C.substring(K-V),Z=U.indexOf(X);if(Z==-1)return W;V+=Z,(Z==0||C.substring(K-V)==U.substring(0,V))&&(W=V,V++)}}function h(C,U){if(!C||!U||C.slice(-1)!==U.slice(-1))return 0;for(var L=0,q=Math.min(C.length,U.length),K=q,W=0;L<K;)C.substring(C.length-K,C.length-W)==U.substring(U.length-K,U.length-W)?(L=K,W=L):q=K,K=Math.floor((q-L)/2+L);return I(C.charCodeAt(C.length-K))&&K--,K}function p(C,U){var L=C.length>U.length?C:U,q=C.length>U.length?U:C;if(L.length<4||q.length*2<L.length)return null;function K(re,ue,Le){for(var de=re.substring(Le,Le+Math.floor(re.length/4)),ve=-1,te="",ge,ke,oe,Ee;(ve=ue.indexOf(de,ve+1))!==-1;){var Te=d(re.substring(Le),ue.substring(ve)),Ye=h(re.substring(0,Le),ue.substring(0,ve));te.length<Ye+Te&&(te=ue.substring(ve-Ye,ve)+ue.substring(ve,ve+Te),ge=re.substring(0,Le-Ye),ke=re.substring(Le+Te),oe=ue.substring(0,ve-Ye),Ee=ue.substring(ve+Te))}return te.length*2>=re.length?[ge,ke,oe,Ee,te]:null}var W=K(L,q,Math.ceil(L.length/4)),V=K(L,q,Math.ceil(L.length/2)),X;if(!W&&!V)return null;V?W?X=W[4].length>V[4].length?W:V:X=V:X=W;var Z,G,F,Y;C.length>U.length?(Z=X[0],G=X[1],F=X[2],Y=X[3]):(F=X[0],Y=X[1],Z=X[2],G=X[3]);var ne=X[4];return[Z,G,F,Y,ne]}function m(C){for(var U=!1,L=[],q=0,K=null,W=0,V=0,X=0,Z=0,G=0;W<C.length;)C[W][0]==r?(L[q++]=W,V=Z,X=G,Z=0,G=0,K=C[W][1]):(C[W][0]==e?Z+=C[W][1].length:G+=C[W][1].length,K&&K.length<=Math.max(V,X)&&K.length<=Math.max(Z,G)&&(C.splice(L[q-1],0,[t,K]),C[L[q-1]+1][0]=e,q--,q--,W=q>0?L[q-1]:-1,V=0,X=0,Z=0,G=0,K=null,U=!0)),W++;for(U&&T(C),_(C),W=1;W<C.length;){if(C[W-1][0]==t&&C[W][0]==e){var F=C[W-1][1],Y=C[W][1],ne=u(F,Y),re=u(Y,F);ne>=re?(ne>=F.length/2||ne>=Y.length/2)&&(C.splice(W,0,[r,Y.substring(0,ne)]),C[W-1][1]=F.substring(0,F.length-ne),C[W+1][1]=Y.substring(ne),W++):(re>=F.length/2||re>=Y.length/2)&&(C.splice(W,0,[r,F.substring(0,re)]),C[W-1][0]=e,C[W-1][1]=Y.substring(0,Y.length-re),C[W+1][0]=t,C[W+1][1]=F.substring(re),W++),W++}W++}}var x=/[^a-zA-Z0-9]/,b=/\s/,v=/[\r\n]/,w=/\n\r?\n$/,k=/^\r?\n\r?\n/;function _(C){function U(re,ue){if(!re||!ue)return 6;var Le=re.charAt(re.length-1),de=ue.charAt(0),ve=Le.match(x),te=de.match(x),ge=ve&&Le.match(b),ke=te&&de.match(b),oe=ge&&Le.match(v),Ee=ke&&de.match(v),Te=oe&&re.match(w),Ye=Ee&&ue.match(k);return Te||Ye?5:oe||Ee?4:ve&&!ge&&ke?3:ge||ke?2:ve||te?1:0}for(var L=1;L<C.length-1;){if(C[L-1][0]==r&&C[L+1][0]==r){var q=C[L-1][1],K=C[L][1],W=C[L+1][1],V=h(q,K);if(V){var X=K.substring(K.length-V);q=q.substring(0,q.length-V),K=X+K.substring(0,K.length-V),W=X+W}for(var Z=q,G=K,F=W,Y=U(q,K)+U(K,W);K.charAt(0)===W.charAt(0);){q+=K.charAt(0),K=K.substring(1)+W.charAt(0),W=W.substring(1);var ne=U(q,K)+U(K,W);ne>=Y&&(Y=ne,Z=q,G=K,F=W)}C[L-1][1]!=Z&&(Z?C[L-1][1]=Z:(C.splice(L-1,1),L--),C[L][1]=G,F?C[L+1][1]=F:(C.splice(L+1,1),L--))}L++}}function T(C,U){C.push([r,""]);for(var L=0,q=0,K=0,W="",V="",X;L<C.length;){if(L<C.length-1&&!C[L][1]){C.splice(L,1);continue}switch(C[L][0]){case e:K++,V+=C[L][1],L++;break;case t:q++,W+=C[L][1],L++;break;case r:var Z=L-K-q-1;if(U){if(Z>=0&&M(C[Z][1])){var G=C[Z][1].slice(-1);if(C[Z][1]=C[Z][1].slice(0,-1),W=G+W,V=G+V,!C[Z][1]){C.splice(Z,1),L--;var F=Z-1;C[F]&&C[F][0]===e&&(K++,V=C[F][1]+V,F--),C[F]&&C[F][0]===t&&(q++,W=C[F][1]+W,F--),Z=F}}if(O(C[L][1])){var G=C[L][1].charAt(0);C[L][1]=C[L][1].slice(1),W+=G,V+=G}}if(L<C.length-1&&!C[L][1]){C.splice(L,1);break}if(W.length>0||V.length>0){W.length>0&&V.length>0&&(X=d(V,W),X!==0&&(Z>=0?C[Z][1]+=V.substring(0,X):(C.splice(0,0,[r,V.substring(0,X)]),L++),V=V.substring(X),W=W.substring(X)),X=h(V,W),X!==0&&(C[L][1]=V.substring(V.length-X)+C[L][1],V=V.substring(0,V.length-X),W=W.substring(0,W.length-X)));var Y=K+q;W.length===0&&V.length===0?(C.splice(L-Y,Y),L=L-Y):W.length===0?(C.splice(L-Y,Y,[e,V]),L=L-Y+1):V.length===0?(C.splice(L-Y,Y,[t,W]),L=L-Y+1):(C.splice(L-Y,Y,[t,W],[e,V]),L=L-Y+2)}L!==0&&C[L-1][0]===r?(C[L-1][1]+=C[L][1],C.splice(L,1)):L++,K=0,q=0,W="",V="";break}}C[C.length-1][1]===""&&C.pop();var ne=!1;for(L=1;L<C.length-1;)C[L-1][0]===r&&C[L+1][0]===r&&(C[L][1].substring(C[L][1].length-C[L-1][1].length)===C[L-1][1]?(C[L][1]=C[L-1][1]+C[L][1].substring(0,C[L][1].length-C[L-1][1].length),C[L+1][1]=C[L-1][1]+C[L+1][1],C.splice(L-1,1),ne=!0):C[L][1].substring(0,C[L+1][1].length)==C[L+1][1]&&(C[L-1][1]+=C[L+1][1],C[L][1]=C[L][1].substring(C[L+1][1].length)+C[L+1][1],C.splice(L+1,1),ne=!0)),L++;ne&&T(C,U)}function A(C){return C>=55296&&C<=56319}function I(C){return C>=56320&&C<=57343}function O(C){return I(C.charCodeAt(0))}function M(C){return A(C.charCodeAt(C.length-1))}function E(C){for(var U=[],L=0;L<C.length;L++)C[L][1].length>0&&U.push(C[L]);return U}function R(C,U,L,q){return M(C)||O(q)?null:E([[r,C],[t,U],[e,L],[r,q]])}function $(C,U,L){var q=typeof L=="number"?{index:L,length:0}:L.oldRange,K=typeof L=="number"?null:L.newRange,W=C.length,V=U.length;if(q.length===0&&(K===null||K.length===0)){var X=q.index,Z=C.slice(0,X),G=C.slice(X),F=K?K.index:null;e:{var Y=X+V-W;if(F!==null&&F!==Y||Y<0||Y>V)break e;var ne=U.slice(0,Y),re=U.slice(Y);if(re!==G)break e;var ue=Math.min(X,Y),Le=Z.slice(0,ue),de=ne.slice(0,ue);if(Le!==de)break e;var ve=Z.slice(ue),te=ne.slice(ue);return R(Le,ve,te,G)}e:{if(F!==null&&F!==X)break e;var ge=X,ne=U.slice(0,ge),re=U.slice(ge);if(ne!==Z)break e;var ke=Math.min(W-ge,V-ge),oe=G.slice(G.length-ke),Ee=re.slice(re.length-ke);if(oe!==Ee)break e;var ve=G.slice(0,G.length-ke),te=re.slice(0,re.length-ke);return R(Z,ve,te,oe)}}if(q.length>0&&K&&K.length===0)e:{var Le=C.slice(0,q.index),oe=C.slice(q.index+q.length),ue=Le.length,ke=oe.length;if(V<ue+ke)break e;var de=U.slice(0,ue),Ee=U.slice(V-ke);if(Le!==de||oe!==Ee)break e;var ve=C.slice(ue,W-ke),te=U.slice(ue,V-ke);return R(Le,ve,te,oe)}return null}function B(C,U,L,q){return n(C,U,L,q,!0)}return B.INSERT=e,B.DELETE=t,B.EQUAL=r,cw=B,cw}var Ef={exports:{}};Ef.exports;var m6;function GI(){return m6||(m6=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",l="[object Array]",d="[object Boolean]",u="[object Date]",h="[object Error]",p="[object Function]",m="[object GeneratorFunction]",x="[object Map]",b="[object Number]",v="[object Object]",w="[object Promise]",k="[object RegExp]",_="[object Set]",T="[object String]",A="[object Symbol]",I="[object WeakMap]",O="[object ArrayBuffer]",M="[object DataView]",E="[object Float32Array]",R="[object Float64Array]",$="[object Int8Array]",B="[object Int16Array]",C="[object Int32Array]",U="[object Uint8Array]",L="[object Uint8ClampedArray]",q="[object Uint16Array]",K="[object Uint32Array]",W=/[\\^$.*+?()[\]{}|]/g,V=/\w*$/,X=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,G={};G[a]=G[l]=G[O]=G[M]=G[d]=G[u]=G[E]=G[R]=G[$]=G[B]=G[C]=G[x]=G[b]=G[v]=G[k]=G[_]=G[T]=G[A]=G[U]=G[L]=G[q]=G[K]=!0,G[h]=G[p]=G[I]=!1;var F=typeof nc=="object"&&nc&&nc.Object===Object&&nc,Y=typeof self=="object"&&self&&self.Object===Object&&self,ne=F||Y||Function("return this")(),re=e&&!e.nodeType&&e,ue=re&&!0&&t&&!t.nodeType&&t,Le=ue&&ue.exports===re;function de(D,Q){return D.set(Q[0],Q[1]),D}function ve(D,Q){return D.add(Q),D}function te(D,Q){for(var se=-1,Se=D?D.length:0;++se<Se&&Q(D[se],se,D)!==!1;);return D}function ge(D,Q){for(var se=-1,Se=Q.length,Nt=D.length;++se<Se;)D[Nt+se]=Q[se];return D}function ke(D,Q,se,Se){for(var Nt=-1,rt=D?D.length:0;++Nt<rt;)se=Q(se,D[Nt],Nt,D);return se}function oe(D,Q){for(var se=-1,Se=Array(D);++se<D;)Se[se]=Q(se);return Se}function Ee(D,Q){return D?.[Q]}function Te(D){var Q=!1;if(D!=null&&typeof D.toString!="function")try{Q=!!(D+"")}catch{}return Q}function Ye(D){var Q=-1,se=Array(D.size);return D.forEach(function(Se,Nt){se[++Q]=[Nt,Se]}),se}function ze(D,Q){return function(se){return D(Q(se))}}function le(D){var Q=-1,se=Array(D.size);return D.forEach(function(Se){se[++Q]=Se}),se}var pe=Array.prototype,me=Function.prototype,Ie=Object.prototype,Fe=ne["__core-js_shared__"],qe=(function(){var D=/[^.]+$/.exec(Fe&&Fe.keys&&Fe.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""})(),Xe=me.toString,He=Ie.hasOwnProperty,ut=Ie.toString,Tt=RegExp("^"+Xe.call(He).replace(W,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=Le?ne.Buffer:void 0,nt=ne.Symbol,kt=ne.Uint8Array,mt=ze(Object.getPrototypeOf,Object),Re=Object.create,it=Ie.propertyIsEnumerable,jt=pe.splice,yt=Object.getOwnPropertySymbols,Et=Ut?Ut.isBuffer:void 0,ot=ze(Object.keys,Object),ae=mn(ne,"DataView"),Be=mn(ne,"Map"),Qe=mn(ne,"Promise"),et=mn(ne,"Set"),bt=mn(ne,"WeakMap"),Ve=mn(Object,"create"),Je=cn(ae),pt=cn(Be),he=cn(Qe),We=cn(et),vt=cn(bt),At=nt?nt.prototype:void 0,Jt=At?At.valueOf:void 0;function wr(D){var Q=-1,se=D?D.length:0;for(this.clear();++Q<se;){var Se=D[Q];this.set(Se[0],Se[1])}}function Mn(){this.__data__=Ve?Ve(null):{}}function ys(D){return this.has(D)&&delete this.__data__[D]}function Xs(D){var Q=this.__data__;if(Ve){var se=Q[D];return se===n?void 0:se}return He.call(Q,D)?Q[D]:void 0}function je(D){var Q=this.__data__;return Ve?Q[D]!==void 0:He.call(Q,D)}function Ce(D,Q){var se=this.__data__;return se[D]=Ve&&Q===void 0?n:Q,this}wr.prototype.clear=Mn,wr.prototype.delete=ys,wr.prototype.get=Xs,wr.prototype.has=je,wr.prototype.set=Ce;function Oe(D){var Q=-1,se=D?D.length:0;for(this.clear();++Q<se;){var Se=D[Q];this.set(Se[0],Se[1])}}function Ze(){this.__data__=[]}function wt(D){var Q=this.__data__,se=Hn(Q,D);if(se<0)return!1;var Se=Q.length-1;return se==Se?Q.pop():jt.call(Q,se,1),!0}function Lt(D){var Q=this.__data__,se=Hn(Q,D);return se<0?void 0:Q[se][1]}function lr(D){return Hn(this.__data__,D)>-1}function Ln(D,Q){var se=this.__data__,Se=Hn(se,D);return Se<0?se.push([D,Q]):se[Se][1]=Q,this}Oe.prototype.clear=Ze,Oe.prototype.delete=wt,Oe.prototype.get=Lt,Oe.prototype.has=lr,Oe.prototype.set=Ln;function Qt(D){var Q=-1,se=D?D.length:0;for(this.clear();++Q<se;){var Se=D[Q];this.set(Se[0],Se[1])}}function Sc(){this.__data__={hash:new wr,map:new(Be||Oe),string:new wr}}function vl(D){return ki(this,D).delete(D)}function wl(D){return ki(this,D).get(D)}function Ls(D){return ki(this,D).has(D)}function Oa(D,Q){return ki(this,D).set(D,Q),this}Qt.prototype.clear=Sc,Qt.prototype.delete=vl,Qt.prototype.get=wl,Qt.prototype.has=Ls,Qt.prototype.set=Oa;function Mr(D){this.__data__=new Oe(D)}function is(){this.__data__=new Oe}function Fn(D){return this.__data__.delete(D)}function Rs(D){return this.__data__.get(D)}function Ur(D){return this.__data__.has(D)}function uo(D,Q){var se=this.__data__;if(se instanceof Oe){var Se=se.__data__;if(!Be||Se.length<r-1)return Se.push([D,Q]),this;se=this.__data__=new Qt(Se)}return se.set(D,Q),this}Mr.prototype.clear=is,Mr.prototype.delete=Fn,Mr.prototype.get=Rs,Mr.prototype.has=Ur,Mr.prototype.set=uo;function wi(D,Q){var se=Zs(D)||Vn(D)?oe(D.length,String):[],Se=se.length,Nt=!!Se;for(var rt in D)He.call(D,rt)&&!(Nt&&(rt=="length"||Nl(rt,Se)))&&se.push(rt);return se}function bs(D,Q,se){var Se=D[Q];(!(He.call(D,Q)&&Qs(Se,se))||se===void 0&&!(Q in D))&&(D[Q]=se)}function Hn(D,Q){for(var se=D.length;se--;)if(Qs(D[se][0],Q))return se;return-1}function as(D,Q){return D&&Ra(Q,ta(Q),D)}function Zi(D,Q,se,Se,Nt,rt,It){var $t;if(Se&&($t=rt?Se(D,Nt,rt,It):Se(D)),$t!==void 0)return $t;if(!zt(D))return D;var dr=Zs(D);if(dr){if($t=po(D),!Q)return La(D,$t)}else{var Ft=Ds(D),jr=Ft==p||Ft==m;if(cs(D))return Lr(D,Q);if(Ft==v||Ft==a||jr&&!rt){if(Te(D))return rt?D:{};if($t=os(jr?{}:D),!Q)return fo(D,as($t,D))}else{if(!G[Ft])return rt?D:{};$t=Pa(D,Ft,Zi,Q)}}It||(It=new Mr);var dn=It.get(D);if(dn)return dn;if(It.set(D,$t),!dr)var Rr=se?Ni(D):ta(D);return te(Rr||D,function(Fr,Zr){Rr&&(Zr=Fr,Fr=D[Zr]),bs($t,Zr,Zi(Fr,Q,se,Se,Zr,D,It))}),$t}function ho(D){return zt(D)?Re(D):{}}function jl(D,Q,se){var Se=Q(D);return Zs(D)?Se:ge(Se,se(D))}function Ma(D){return ut.call(D)}function Wn(D){if(!zt(D)||Ia(D))return!1;var Q=Pn(D)||Te(D)?Tt:X;return Q.test(cn(D))}function zr(D){if(!ls(D))return ot(D);var Q=[];for(var se in Object(D))He.call(D,se)&&se!="constructor"&&Q.push(se);return Q}function Lr(D,Q){if(Q)return D.slice();var se=new D.constructor(D.length);return D.copy(se),se}function Ps(D){var Q=new D.constructor(D.byteLength);return new kt(Q).set(new kt(D)),Q}function Js(D,Q){var se=Q?Ps(D.buffer):D.buffer;return new D.constructor(se,D.byteOffset,D.byteLength)}function Zt(D,Q,se){var Se=Q?se(Ye(D),!0):Ye(D);return ke(Se,de,new D.constructor)}function ji(D){var Q=new D.constructor(D.source,V.exec(D));return Q.lastIndex=D.lastIndex,Q}function Is(D,Q,se){var Se=Q?se(le(D),!0):le(D);return ke(Se,ve,new D.constructor)}function ea(D){return Jt?Object(Jt.call(D)):{}}function Rn(D,Q){var se=Q?Ps(D.buffer):D.buffer;return new D.constructor(se,D.byteOffset,D.length)}function La(D,Q){var se=-1,Se=D.length;for(Q||(Q=Array(Se));++se<Se;)Q[se]=D[se];return Q}function Ra(D,Q,se,Se){se||(se={});for(var Nt=-1,rt=Q.length;++Nt<rt;){var It=Q[Nt],$t=void 0;bs(se,It,$t===void 0?D[It]:$t)}return se}function fo(D,Q){return Ra(D,qr(D),Q)}function Ni(D){return jl(D,ta,qr)}function ki(D,Q){var se=D.__data__;return Si(Q)?se[typeof Q=="string"?"string":"hash"]:se.map}function mn(D,Q){var se=Ee(D,Q);return Wn(se)?se:void 0}var qr=yt?ze(yt,Object):ra,Ds=Ma;(ae&&Ds(new ae(new ArrayBuffer(1)))!=M||Be&&Ds(new Be)!=x||Qe&&Ds(Qe.resolve())!=w||et&&Ds(new et)!=_||bt&&Ds(new bt)!=I)&&(Ds=function(D){var Q=ut.call(D),se=Q==v?D.constructor:void 0,Se=se?cn(se):void 0;if(Se)switch(Se){case Je:return M;case pt:return x;case he:return w;case We:return _;case vt:return I}return Q});function po(D){var Q=D.length,se=D.constructor(Q);return Q&&typeof D[0]=="string"&&He.call(D,"index")&&(se.index=D.index,se.input=D.input),se}function os(D){return typeof D.constructor=="function"&&!ls(D)?ho(mt(D)):{}}function Pa(D,Q,se,Se){var Nt=D.constructor;switch(Q){case O:return Ps(D);case d:case u:return new Nt(+D);case M:return Js(D,Se);case E:case R:case $:case B:case C:case U:case L:case q:case K:return Rn(D,Se);case x:return Zt(D,Se,se);case b:case T:return new Nt(D);case k:return ji(D);case _:return Is(D,Se,se);case A:return ea(D)}}function Nl(D,Q){return Q=Q??i,!!Q&&(typeof D=="number"||Z.test(D))&&D>-1&&D%1==0&&D<Q}function Si(D){var Q=typeof D;return Q=="string"||Q=="number"||Q=="symbol"||Q=="boolean"?D!=="__proto__":D===null}function Ia(D){return!!qe&&qe in D}function ls(D){var Q=D&&D.constructor,se=typeof Q=="function"&&Q.prototype||Ie;return D===se}function cn(D){if(D!=null){try{return Xe.call(D)}catch{}try{return D+""}catch{}}return""}function Gn(D){return Zi(D,!0,!0)}function Qs(D,Q){return D===Q||D!==D&&Q!==Q}function Vn(D){return _i(D)&&He.call(D,"callee")&&(!it.call(D,"callee")||ut.call(D)==a)}var Zs=Array.isArray;function ei(D){return D!=null&&Ci(D.length)&&!Pn(D)}function _i(D){return vs(D)&&ei(D)}var cs=Et||mo;function Pn(D){var Q=zt(D)?ut.call(D):"";return Q==p||Q==m}function Ci(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=i}function zt(D){var Q=typeof D;return!!D&&(Q=="object"||Q=="function")}function vs(D){return!!D&&typeof D=="object"}function ta(D){return ei(D)?wi(D):zr(D)}function ra(){return[]}function mo(){return!1}t.exports=Gn})(Ef,Ef.exports)),Ef.exports}var Af={exports:{}};Af.exports;var g6;function VI(){return g6||(g6=1,(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,a=2,l=9007199254740991,d="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",p="[object Boolean]",m="[object Date]",x="[object Error]",b="[object Function]",v="[object GeneratorFunction]",w="[object Map]",k="[object Number]",_="[object Null]",T="[object Object]",A="[object Promise]",I="[object Proxy]",O="[object RegExp]",M="[object Set]",E="[object String]",R="[object Symbol]",$="[object Undefined]",B="[object WeakMap]",C="[object ArrayBuffer]",U="[object DataView]",L="[object Float32Array]",q="[object Float64Array]",K="[object Int8Array]",W="[object Int16Array]",V="[object Int32Array]",X="[object Uint8Array]",Z="[object Uint8ClampedArray]",G="[object Uint16Array]",F="[object Uint32Array]",Y=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,re=/^(?:0|[1-9]\d*)$/,ue={};ue[L]=ue[q]=ue[K]=ue[W]=ue[V]=ue[X]=ue[Z]=ue[G]=ue[F]=!0,ue[d]=ue[u]=ue[C]=ue[p]=ue[U]=ue[m]=ue[x]=ue[b]=ue[w]=ue[k]=ue[T]=ue[O]=ue[M]=ue[E]=ue[B]=!1;var Le=typeof nc=="object"&&nc&&nc.Object===Object&&nc,de=typeof self=="object"&&self&&self.Object===Object&&self,ve=Le||de||Function("return this")(),te=e&&!e.nodeType&&e,ge=te&&!0&&t&&!t.nodeType&&t,ke=ge&&ge.exports===te,oe=ke&&Le.process,Ee=(function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}})(),Te=Ee&&Ee.isTypedArray;function Ye(D,Q){for(var se=-1,Se=D==null?0:D.length,Nt=0,rt=[];++se<Se;){var It=D[se];Q(It,se,D)&&(rt[Nt++]=It)}return rt}function ze(D,Q){for(var se=-1,Se=Q.length,Nt=D.length;++se<Se;)D[Nt+se]=Q[se];return D}function le(D,Q){for(var se=-1,Se=D==null?0:D.length;++se<Se;)if(Q(D[se],se,D))return!0;return!1}function pe(D,Q){for(var se=-1,Se=Array(D);++se<D;)Se[se]=Q(se);return Se}function me(D){return function(Q){return D(Q)}}function Ie(D,Q){return D.has(Q)}function Fe(D,Q){return D?.[Q]}function qe(D){var Q=-1,se=Array(D.size);return D.forEach(function(Se,Nt){se[++Q]=[Nt,Se]}),se}function Xe(D,Q){return function(se){return D(Q(se))}}function He(D){var Q=-1,se=Array(D.size);return D.forEach(function(Se){se[++Q]=Se}),se}var ut=Array.prototype,Tt=Function.prototype,Ut=Object.prototype,nt=ve["__core-js_shared__"],kt=Tt.toString,mt=Ut.hasOwnProperty,Re=(function(){var D=/[^.]+$/.exec(nt&&nt.keys&&nt.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""})(),it=Ut.toString,jt=RegExp("^"+kt.call(mt).replace(Y,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yt=ke?ve.Buffer:void 0,Et=ve.Symbol,ot=ve.Uint8Array,ae=Ut.propertyIsEnumerable,Be=ut.splice,Qe=Et?Et.toStringTag:void 0,et=Object.getOwnPropertySymbols,bt=yt?yt.isBuffer:void 0,Ve=Xe(Object.keys,Object),Je=qr(ve,"DataView"),pt=qr(ve,"Map"),he=qr(ve,"Promise"),We=qr(ve,"Set"),vt=qr(ve,"WeakMap"),At=qr(Object,"create"),Jt=cn(Je),wr=cn(pt),Mn=cn(he),ys=cn(We),Xs=cn(vt),je=Et?Et.prototype:void 0,Ce=je?je.valueOf:void 0;function Oe(D){var Q=-1,se=D==null?0:D.length;for(this.clear();++Q<se;){var Se=D[Q];this.set(Se[0],Se[1])}}function Ze(){this.__data__=At?At(null):{},this.size=0}function wt(D){var Q=this.has(D)&&delete this.__data__[D];return this.size-=Q?1:0,Q}function Lt(D){var Q=this.__data__;if(At){var se=Q[D];return se===n?void 0:se}return mt.call(Q,D)?Q[D]:void 0}function lr(D){var Q=this.__data__;return At?Q[D]!==void 0:mt.call(Q,D)}function Ln(D,Q){var se=this.__data__;return this.size+=this.has(D)?0:1,se[D]=At&&Q===void 0?n:Q,this}Oe.prototype.clear=Ze,Oe.prototype.delete=wt,Oe.prototype.get=Lt,Oe.prototype.has=lr,Oe.prototype.set=Ln;function Qt(D){var Q=-1,se=D==null?0:D.length;for(this.clear();++Q<se;){var Se=D[Q];this.set(Se[0],Se[1])}}function Sc(){this.__data__=[],this.size=0}function vl(D){var Q=this.__data__,se=Lr(Q,D);if(se<0)return!1;var Se=Q.length-1;return se==Se?Q.pop():Be.call(Q,se,1),--this.size,!0}function wl(D){var Q=this.__data__,se=Lr(Q,D);return se<0?void 0:Q[se][1]}function Ls(D){return Lr(this.__data__,D)>-1}function Oa(D,Q){var se=this.__data__,Se=Lr(se,D);return Se<0?(++this.size,se.push([D,Q])):se[Se][1]=Q,this}Qt.prototype.clear=Sc,Qt.prototype.delete=vl,Qt.prototype.get=wl,Qt.prototype.has=Ls,Qt.prototype.set=Oa;function Mr(D){var Q=-1,se=D==null?0:D.length;for(this.clear();++Q<se;){var Se=D[Q];this.set(Se[0],Se[1])}}function is(){this.size=0,this.__data__={hash:new Oe,map:new(pt||Qt),string:new Oe}}function Fn(D){var Q=mn(this,D).delete(D);return this.size-=Q?1:0,Q}function Rs(D){return mn(this,D).get(D)}function Ur(D){return mn(this,D).has(D)}function uo(D,Q){var se=mn(this,D),Se=se.size;return se.set(D,Q),this.size+=se.size==Se?0:1,this}Mr.prototype.clear=is,Mr.prototype.delete=Fn,Mr.prototype.get=Rs,Mr.prototype.has=Ur,Mr.prototype.set=uo;function wi(D){var Q=-1,se=D==null?0:D.length;for(this.__data__=new Mr;++Q<se;)this.add(D[Q])}function bs(D){return this.__data__.set(D,n),this}function Hn(D){return this.__data__.has(D)}wi.prototype.add=wi.prototype.push=bs,wi.prototype.has=Hn;function as(D){var Q=this.__data__=new Qt(D);this.size=Q.size}function Zi(){this.__data__=new Qt,this.size=0}function ho(D){var Q=this.__data__,se=Q.delete(D);return this.size=Q.size,se}function jl(D){return this.__data__.get(D)}function Ma(D){return this.__data__.has(D)}function Wn(D,Q){var se=this.__data__;if(se instanceof Qt){var Se=se.__data__;if(!pt||Se.length<r-1)return Se.push([D,Q]),this.size=++se.size,this;se=this.__data__=new Mr(Se)}return se.set(D,Q),this.size=se.size,this}as.prototype.clear=Zi,as.prototype.delete=ho,as.prototype.get=jl,as.prototype.has=Ma,as.prototype.set=Wn;function zr(D,Q){var se=Vn(D),Se=!se&&Qs(D),Nt=!se&&!Se&&ei(D),rt=!se&&!Se&&!Nt&&vs(D),It=se||Se||Nt||rt,$t=It?pe(D.length,String):[],dr=$t.length;for(var Ft in D)mt.call(D,Ft)&&!(It&&(Ft=="length"||Nt&&(Ft=="offset"||Ft=="parent")||rt&&(Ft=="buffer"||Ft=="byteLength"||Ft=="byteOffset")||Pa(Ft,dr)))&&$t.push(Ft);return $t}function Lr(D,Q){for(var se=D.length;se--;)if(Gn(D[se][0],Q))return se;return-1}function Ps(D,Q,se){var Se=Q(D);return Vn(D)?Se:ze(Se,se(D))}function Js(D){return D==null?D===void 0?$:_:Qe&&Qe in Object(D)?Ds(D):ls(D)}function Zt(D){return zt(D)&&Js(D)==d}function ji(D,Q,se,Se,Nt){return D===Q?!0:D==null||Q==null||!zt(D)&&!zt(Q)?D!==D&&Q!==Q:Is(D,Q,se,Se,ji,Nt)}function Is(D,Q,se,Se,Nt,rt){var It=Vn(D),$t=Vn(Q),dr=It?u:os(D),Ft=$t?u:os(Q);dr=dr==d?T:dr,Ft=Ft==d?T:Ft;var jr=dr==T,dn=Ft==T,Rr=dr==Ft;if(Rr&&ei(D)){if(!ei(Q))return!1;It=!0,jr=!1}if(Rr&&!jr)return rt||(rt=new as),It||vs(D)?Ra(D,Q,se,Se,Nt,rt):fo(D,Q,dr,se,Se,Nt,rt);if(!(se&i)){var Fr=jr&&mt.call(D,"__wrapped__"),Zr=dn&&mt.call(Q,"__wrapped__");if(Fr||Zr){var ti=Fr?D.value():D,Kn=Zr?Q.value():Q;return rt||(rt=new as),Nt(ti,Kn,se,Se,rt)}}return Rr?(rt||(rt=new as),Ni(D,Q,se,Se,Nt,rt)):!1}function ea(D){if(!Ci(D)||Si(D))return!1;var Q=cs(D)?jt:ne;return Q.test(cn(D))}function Rn(D){return zt(D)&&Pn(D.length)&&!!ue[Js(D)]}function La(D){if(!Ia(D))return Ve(D);var Q=[];for(var se in Object(D))mt.call(D,se)&&se!="constructor"&&Q.push(se);return Q}function Ra(D,Q,se,Se,Nt,rt){var It=se&i,$t=D.length,dr=Q.length;if($t!=dr&&!(It&&dr>$t))return!1;var Ft=rt.get(D);if(Ft&&rt.get(Q))return Ft==Q;var jr=-1,dn=!0,Rr=se&a?new wi:void 0;for(rt.set(D,Q),rt.set(Q,D);++jr<$t;){var Fr=D[jr],Zr=Q[jr];if(Se)var ti=It?Se(Zr,Fr,jr,Q,D,rt):Se(Fr,Zr,jr,D,Q,rt);if(ti!==void 0){if(ti)continue;dn=!1;break}if(Rr){if(!le(Q,function(Kn,ri){if(!Ie(Rr,ri)&&(Fr===Kn||Nt(Fr,Kn,se,Se,rt)))return Rr.push(ri)})){dn=!1;break}}else if(!(Fr===Zr||Nt(Fr,Zr,se,Se,rt))){dn=!1;break}}return rt.delete(D),rt.delete(Q),dn}function fo(D,Q,se,Se,Nt,rt,It){switch(se){case U:if(D.byteLength!=Q.byteLength||D.byteOffset!=Q.byteOffset)return!1;D=D.buffer,Q=Q.buffer;case C:return!(D.byteLength!=Q.byteLength||!rt(new ot(D),new ot(Q)));case p:case m:case k:return Gn(+D,+Q);case x:return D.name==Q.name&&D.message==Q.message;case O:case E:return D==Q+"";case w:var $t=qe;case M:var dr=Se&i;if($t||($t=He),D.size!=Q.size&&!dr)return!1;var Ft=It.get(D);if(Ft)return Ft==Q;Se|=a,It.set(D,Q);var jr=Ra($t(D),$t(Q),Se,Nt,rt,It);return It.delete(D),jr;case R:if(Ce)return Ce.call(D)==Ce.call(Q)}return!1}function Ni(D,Q,se,Se,Nt,rt){var It=se&i,$t=ki(D),dr=$t.length,Ft=ki(Q),jr=Ft.length;if(dr!=jr&&!It)return!1;for(var dn=dr;dn--;){var Rr=$t[dn];if(!(It?Rr in Q:mt.call(Q,Rr)))return!1}var Fr=rt.get(D);if(Fr&&rt.get(Q))return Fr==Q;var Zr=!0;rt.set(D,Q),rt.set(Q,D);for(var ti=It;++dn<dr;){Rr=$t[dn];var Kn=D[Rr],ri=Q[Rr];if(Se)var _c=It?Se(ri,Kn,Rr,Q,D,rt):Se(Kn,ri,Rr,D,Q,rt);if(!(_c===void 0?Kn===ri||Nt(Kn,ri,se,Se,rt):_c)){Zr=!1;break}ti||(ti=Rr=="constructor")}if(Zr&&!ti){var na=D.constructor,go=Q.constructor;na!=go&&"constructor"in D&&"constructor"in Q&&!(typeof na=="function"&&na instanceof na&&typeof go=="function"&&go instanceof go)&&(Zr=!1)}return rt.delete(D),rt.delete(Q),Zr}function ki(D){return Ps(D,ta,po)}function mn(D,Q){var se=D.__data__;return Nl(Q)?se[typeof Q=="string"?"string":"hash"]:se.map}function qr(D,Q){var se=Fe(D,Q);return ea(se)?se:void 0}function Ds(D){var Q=mt.call(D,Qe),se=D[Qe];try{D[Qe]=void 0;var Se=!0}catch{}var Nt=it.call(D);return Se&&(Q?D[Qe]=se:delete D[Qe]),Nt}var po=et?function(D){return D==null?[]:(D=Object(D),Ye(et(D),function(Q){return ae.call(D,Q)}))}:ra,os=Js;(Je&&os(new Je(new ArrayBuffer(1)))!=U||pt&&os(new pt)!=w||he&&os(he.resolve())!=A||We&&os(new We)!=M||vt&&os(new vt)!=B)&&(os=function(D){var Q=Js(D),se=Q==T?D.constructor:void 0,Se=se?cn(se):"";if(Se)switch(Se){case Jt:return U;case wr:return w;case Mn:return A;case ys:return M;case Xs:return B}return Q});function Pa(D,Q){return Q=Q??l,!!Q&&(typeof D=="number"||re.test(D))&&D>-1&&D%1==0&&D<Q}function Nl(D){var Q=typeof D;return Q=="string"||Q=="number"||Q=="symbol"||Q=="boolean"?D!=="__proto__":D===null}function Si(D){return!!Re&&Re in D}function Ia(D){var Q=D&&D.constructor,se=typeof Q=="function"&&Q.prototype||Ut;return D===se}function ls(D){return it.call(D)}function cn(D){if(D!=null){try{return kt.call(D)}catch{}try{return D+""}catch{}}return""}function Gn(D,Q){return D===Q||D!==D&&Q!==Q}var Qs=Zt((function(){return arguments})())?Zt:function(D){return zt(D)&&mt.call(D,"callee")&&!ae.call(D,"callee")},Vn=Array.isArray;function Zs(D){return D!=null&&Pn(D.length)&&!cs(D)}var ei=bt||mo;function _i(D,Q){return ji(D,Q)}function cs(D){if(!Ci(D))return!1;var Q=Js(D);return Q==b||Q==v||Q==h||Q==I}function Pn(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=l}function Ci(D){var Q=typeof D;return D!=null&&(Q=="object"||Q=="function")}function zt(D){return D!=null&&typeof D=="object"}var vs=Te?me(Te):Rn;function ta(D){return Zs(D)?zr(D):La(D)}function ra(){return[]}function mo(){return!1}t.exports=_i})(Af,Af.exports)),Af.exports}var Om={},x6;function bse(){if(x6)return Om;x6=1,Object.defineProperty(Om,"__esModule",{value:!0});const t=GI(),e=VI();var r;return(function(n){function i(u={},h={},p=!1){typeof u!="object"&&(u={}),typeof h!="object"&&(h={});let m=t(h);p||(m=Object.keys(m).reduce((x,b)=>(m[b]!=null&&(x[b]=m[b]),x),{}));for(const x in u)u[x]!==void 0&&h[x]===void 0&&(m[x]=u[x]);return Object.keys(m).length>0?m:void 0}n.compose=i;function a(u={},h={}){typeof u!="object"&&(u={}),typeof h!="object"&&(h={});const p=Object.keys(u).concat(Object.keys(h)).reduce((m,x)=>(e(u[x],h[x])||(m[x]=h[x]===void 0?null:h[x]),m),{});return Object.keys(p).length>0?p:void 0}n.diff=a;function l(u={},h={}){u=u||{};const p=Object.keys(h).reduce((m,x)=>(h[x]!==u[x]&&u[x]!==void 0&&(m[x]=h[x]),m),{});return Object.keys(u).reduce((m,x)=>(u[x]!==h[x]&&h[x]===void 0&&(m[x]=null),m),p)}n.invert=l;function d(u,h,p=!1){if(typeof u!="object")return h;if(typeof h!="object")return;if(!p)return h;const m=Object.keys(h).reduce((x,b)=>(u[b]===void 0&&(x[b]=h[b]),x),{});return Object.keys(m).length>0?m:void 0}n.transform=d})(r||(r={})),Om.default=r,Om}var Mm={},y6;function KI(){if(y6)return Mm;y6=1,Object.defineProperty(Mm,"__esModule",{value:!0});var t;return(function(e){function r(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}e.length=r})(t||(t={})),Mm.default=t,Mm}var Lm={},b6;function vse(){if(b6)return Lm;b6=1,Object.defineProperty(Lm,"__esModule",{value:!0});const t=KI();class e{constructor(n){this.ops=n,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(n){n||(n=1/0);const i=this.ops[this.index];if(i){const a=this.offset,l=t.default.length(i);if(n>=l-a?(n=l-a,this.index+=1,this.offset=0):this.offset+=n,typeof i.delete=="number")return{delete:n};{const d={};return i.attributes&&(d.attributes=i.attributes),typeof i.retain=="number"?d.retain=n:typeof i.retain=="object"&&i.retain!==null?d.retain=i.retain:typeof i.insert=="string"?d.insert=i.insert.substr(a,n):d.insert=i.insert,d}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?t.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const n=this.ops[this.index];return n?typeof n.delete=="number"?"delete":typeof n.retain=="number"||typeof n.retain=="object"&&n.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const n=this.offset,i=this.index,a=this.next(),l=this.ops.slice(this.index);return this.offset=n,this.index=i,[a].concat(l)}}else return[]}}return Lm.default=e,Lm}var v6;function wse(){return v6||(v6=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const r=yse(),n=GI(),i=VI(),a=bse();e.AttributeMap=a.default;const l=KI();e.Op=l.default;const d=vse();e.OpIterator=d.default;const u="\0",h=(m,x)=>{if(typeof m!="object"||m===null)throw new Error(`cannot retain a ${typeof m}`);if(typeof x!="object"||x===null)throw new Error(`cannot retain a ${typeof x}`);const b=Object.keys(m)[0];if(!b||b!==Object.keys(x)[0])throw new Error(`embed types not matched: ${b} != ${Object.keys(x)[0]}`);return[b,m[b],x[b]]};class p{constructor(x){Array.isArray(x)?this.ops=x:x!=null&&Array.isArray(x.ops)?this.ops=x.ops:this.ops=[]}static registerEmbed(x,b){this.handlers[x]=b}static unregisterEmbed(x){delete this.handlers[x]}static getHandler(x){const b=this.handlers[x];if(!b)throw new Error(`no handlers for embed type "${x}"`);return b}insert(x,b){const v={};return typeof x=="string"&&x.length===0?this:(v.insert=x,b!=null&&typeof b=="object"&&Object.keys(b).length>0&&(v.attributes=b),this.push(v))}delete(x){return x<=0?this:this.push({delete:x})}retain(x,b){if(typeof x=="number"&&x<=0)return this;const v={retain:x};return b!=null&&typeof b=="object"&&Object.keys(b).length>0&&(v.attributes=b),this.push(v)}push(x){let b=this.ops.length,v=this.ops[b-1];if(x=n(x),typeof v=="object"){if(typeof x.delete=="number"&&typeof v.delete=="number")return this.ops[b-1]={delete:v.delete+x.delete},this;if(typeof v.delete=="number"&&x.insert!=null&&(b-=1,v=this.ops[b-1],typeof v!="object"))return this.ops.unshift(x),this;if(i(x.attributes,v.attributes)){if(typeof x.insert=="string"&&typeof v.insert=="string")return this.ops[b-1]={insert:v.insert+x.insert},typeof x.attributes=="object"&&(this.ops[b-1].attributes=x.attributes),this;if(typeof x.retain=="number"&&typeof v.retain=="number")return this.ops[b-1]={retain:v.retain+x.retain},typeof x.attributes=="object"&&(this.ops[b-1].attributes=x.attributes),this}}return b===this.ops.length?this.ops.push(x):this.ops.splice(b,0,x),this}chop(){const x=this.ops[this.ops.length-1];return x&&typeof x.retain=="number"&&!x.attributes&&this.ops.pop(),this}filter(x){return this.ops.filter(x)}forEach(x){this.ops.forEach(x)}map(x){return this.ops.map(x)}partition(x){const b=[],v=[];return this.forEach(w=>{(x(w)?b:v).push(w)}),[b,v]}reduce(x,b){return this.ops.reduce(x,b)}changeLength(){return this.reduce((x,b)=>b.insert?x+l.default.length(b):b.delete?x-b.delete:x,0)}length(){return this.reduce((x,b)=>x+l.default.length(b),0)}slice(x=0,b=1/0){const v=[],w=new d.default(this.ops);let k=0;for(;k<b&&w.hasNext();){let _;k<x?_=w.next(x-k):(_=w.next(b-k),v.push(_)),k+=l.default.length(_)}return new p(v)}compose(x){const b=new d.default(this.ops),v=new d.default(x.ops),w=[],k=v.peek();if(k!=null&&typeof k.retain=="number"&&k.attributes==null){let T=k.retain;for(;b.peekType()==="insert"&&b.peekLength()<=T;)T-=b.peekLength(),w.push(b.next());k.retain-T>0&&v.next(k.retain-T)}const _=new p(w);for(;b.hasNext()||v.hasNext();)if(v.peekType()==="insert")_.push(v.next());else if(b.peekType()==="delete")_.push(b.next());else{const T=Math.min(b.peekLength(),v.peekLength()),A=b.next(T),I=v.next(T);if(I.retain){const O={};if(typeof A.retain=="number")O.retain=typeof I.retain=="number"?T:I.retain;else if(typeof I.retain=="number")A.retain==null?O.insert=A.insert:O.retain=A.retain;else{const E=A.retain==null?"insert":"retain",[R,$,B]=h(A[E],I.retain),C=p.getHandler(R);O[E]={[R]:C.compose($,B,E==="retain")}}const M=a.default.compose(A.attributes,I.attributes,typeof A.retain=="number");if(M&&(O.attributes=M),_.push(O),!v.hasNext()&&i(_.ops[_.ops.length-1],O)){const E=new p(b.rest());return _.concat(E).chop()}}else typeof I.delete=="number"&&(typeof A.retain=="number"||typeof A.retain=="object"&&A.retain!==null)&&_.push(I)}return _.chop()}concat(x){const b=new p(this.ops.slice());return x.ops.length>0&&(b.push(x.ops[0]),b.ops=b.ops.concat(x.ops.slice(1))),b}diff(x,b){if(this.ops===x.ops)return new p;const v=[this,x].map(A=>A.map(I=>{if(I.insert!=null)return typeof I.insert=="string"?I.insert:u;const O=A===x?"on":"with";throw new Error("diff() called "+O+" non-document")}).join("")),w=new p,k=r(v[0],v[1],b,!0),_=new d.default(this.ops),T=new d.default(x.ops);return k.forEach(A=>{let I=A[1].length;for(;I>0;){let O=0;switch(A[0]){case r.INSERT:O=Math.min(T.peekLength(),I),w.push(T.next(O));break;case r.DELETE:O=Math.min(I,_.peekLength()),_.next(O),w.delete(O);break;case r.EQUAL:O=Math.min(_.peekLength(),T.peekLength(),I);const M=_.next(O),E=T.next(O);i(M.insert,E.insert)?w.retain(O,a.default.diff(M.attributes,E.attributes)):w.push(E).delete(O);break}I-=O}}),w.chop()}eachLine(x,b=`
`){const v=new d.default(this.ops);let w=new p,k=0;for(;v.hasNext();){if(v.peekType()!=="insert")return;const _=v.peek(),T=l.default.length(_)-v.peekLength(),A=typeof _.insert=="string"?_.insert.indexOf(b,T)-T:-1;if(A<0)w.push(v.next());else if(A>0)w.push(v.next(A));else{if(x(w,v.next(1).attributes||{},k)===!1)return;k+=1,w=new p}}w.length()>0&&x(w,{},k)}invert(x){const b=new p;return this.reduce((v,w)=>{if(w.insert)b.delete(l.default.length(w));else{if(typeof w.retain=="number"&&w.attributes==null)return b.retain(w.retain),v+w.retain;if(w.delete||typeof w.retain=="number"){const k=w.delete||w.retain;return x.slice(v,v+k).forEach(T=>{w.delete?b.push(T):w.retain&&w.attributes&&b.retain(l.default.length(T),a.default.invert(w.attributes,T.attributes))}),v+k}else if(typeof w.retain=="object"&&w.retain!==null){const k=x.slice(v,v+1),_=new d.default(k.ops).next(),[T,A,I]=h(w.retain,_.insert),O=p.getHandler(T);return b.retain({[T]:O.invert(A,I)},a.default.invert(w.attributes,_.attributes)),v+1}}return v},0),b.chop()}transform(x,b=!1){if(b=!!b,typeof x=="number")return this.transformPosition(x,b);const v=x,w=new d.default(this.ops),k=new d.default(v.ops),_=new p;for(;w.hasNext()||k.hasNext();)if(w.peekType()==="insert"&&(b||k.peekType()!=="insert"))_.retain(l.default.length(w.next()));else if(k.peekType()==="insert")_.push(k.next());else{const T=Math.min(w.peekLength(),k.peekLength()),A=w.next(T),I=k.next(T);if(A.delete)continue;if(I.delete)_.push(I);else{const O=A.retain,M=I.retain;let E=typeof M=="object"&&M!==null?M:T;if(typeof O=="object"&&O!==null&&typeof M=="object"&&M!==null){const R=Object.keys(O)[0];if(R===Object.keys(M)[0]){const $=p.getHandler(R);$&&(E={[R]:$.transform(O[R],M[R],b)})}}_.retain(E,a.default.transform(A.attributes,I.attributes,b))}}return _.chop()}transformPosition(x,b=!1){b=!!b;const v=new d.default(this.ops);let w=0;for(;v.hasNext()&&w<=x;){const k=v.peekLength(),_=v.peekType();if(v.next(),_==="delete"){x-=Math.min(k,x-w);continue}else _==="insert"&&(w<x||!b)&&(x+=k);w+=k}return x}}p.Op=l.default,p.OpIterator=d.default,p.AttributeMap=a.default,p.handlers={},e.default=p,t.exports=p,t.exports.default=p})(Tm,Tm.exports)),Tm.exports}var Hi=wse();const dt=Ms(Hi);class Aa extends bi{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}Aa.blotName="break";Aa.tagName="BR";let ka=class extends Jg{};const jse={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function oy(t){return t.replace(/[&<>"']/g,e=>jse[e])}class ks extends H4{static allowedChildren=[ks,Aa,bi,ka];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,r){const n=ks.order.indexOf(e),i=ks.order.indexOf(r);return n>=0||i>=0?n-i:e===r?0:e<r?-1:1}formatAt(e,r,n,i){if(ks.compare(this.statics.blotName,n)<0&&this.scroll.query(n,ht.BLOT)){const a=this.isolate(e,r);i&&a.wrap(n,i)}else super.formatAt(e,r,n,i)}optimize(e){if(super.optimize(e),this.parent instanceof ks&&ks.compare(this.statics.blotName,this.parent.statics.blotName)>0){const r=this.parent.isolate(this.offset(),this.length());this.moveChildren(r),r.wrap(this)}}}const w6=1;class ns extends t0{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=YI(this)),this.cache.delta}deleteAt(e,r){super.deleteAt(e,r),this.cache={}}formatAt(e,r,n,i){r<=0||(this.scroll.query(n,ht.BLOCK)?e+r===this.length()&&this.format(n,i):super.formatAt(e,Math.min(r,this.length()-e-1),n,i),this.cache={})}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n),this.cache={};return}if(r.length===0)return;const i=r.split(`
`),a=i.shift();a.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});let l=this;i.reduce((d,u)=>(l=l.split(d,!0),l.insertAt(0,u),u.length),e+a.length)}insertBefore(e,r){const{head:n}=this.children;super.insertBefore(e,r),n instanceof Aa&&n.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+w6),this.cache.length}moveChildren(e,r){super.moveChildren(e,r),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r&&(e===0||e>=this.length()-w6)){const i=this.clone();return e===0?(this.parent.insertBefore(i,this),this):(this.parent.insertBefore(i,this.next),i)}const n=super.split(e,r);return this.cache={},n}}ns.blotName="block";ns.tagName="P";ns.defaultChild=Aa;ns.allowedChildren=[Aa,ks,bi,ka];class Fi extends bi{attach(){super.attach(),this.attributes=new iy(this.domNode)}delta(){return new dt().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,r){const n=this.scroll.query(e,ht.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,r)}formatAt(e,r,n,i){this.format(n,i)}insertAt(e,r,n){if(n!=null){super.insertAt(e,r,n);return}const i=r.split(`
`),a=i.pop(),l=i.map(u=>{const h=this.scroll.create(ns.blotName);return h.insertAt(0,u),h}),d=this.split(e);l.forEach(u=>{this.parent.insertBefore(u,d)}),a&&this.parent.insertBefore(this.scroll.create("text",a),d)}}Fi.scope=ht.BLOCK_BLOT;function YI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.descendants(ms).reduce((r,n)=>n.length()===0?r:r.insert(n.value(),zi(n,{},e)),new dt).insert(`
`,zi(t))}function zi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return t==null||("formats"in t&&typeof t.formats=="function"&&(e={...e,...t.formats()},r&&delete e["code-token"]),t.parent==null||t.parent.statics.blotName==="scroll"||t.parent.statics.scope!==t.statics.scope)?e:zi(t.parent,e,r)}let ly=class Wc extends bi{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,r,n){super(e,r),this.selection=n,this.textNode=document.createTextNode(Wc.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,r){if(this.savedLength!==0){super.format(e,r);return}let n=this,i=0;for(;n!=null&&n.statics.scope!==ht.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=Wc.CONTENTS.length,n.optimize(),n.formatAt(i,Wc.CONTENTS.length,e,r),this.savedLength=0)}index(e,r){return e===this.textNode?0:super.index(e,r)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const r=this.prev instanceof ka?this.prev:null,n=r?r.length():0,i=this.next instanceof ka?this.next:null,a=i?i.text:"",{textNode:l}=this,d=l.data.split(Wc.CONTENTS).join("");l.data=Wc.CONTENTS;let u;if(r)u=r,(d||i)&&(r.insertAt(r.length(),d+a),i&&i.remove());else if(i)u=i,i.insertAt(0,d);else{const h=document.createTextNode(d);u=this.scroll.create(h),this.parent.insertBefore(u,this)}if(this.remove(),e){const h=(x,b)=>r&&x===r.domNode?b:x===l?n+b-1:i&&x===i.domNode?n+d.length+b:null,p=h(e.start.node,e.start.offset),m=h(e.end.node,e.end.offset);if(p!==null&&m!==null)return{startNode:u.domNode,startOffset:p,endNode:u.domNode,endOffset:m}}return null}update(e,r){if(e.some(n=>n.type==="characterData"&&n.target===this.textNode)){const n=this.restore();n&&(r.range=n)}}optimize(e){super.optimize(e);let{parent:r}=this;for(;r;){if(r.domNode.tagName==="A"){this.savedLength=Wc.CONTENTS.length,r.isolate(this.offset(r),this.length()).unwrap(),this.savedLength=0;break}r=r.parent}}value(){return""}};var dw={exports:{}},j6;function Nse(){return j6||(j6=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(u,h,p){this.fn=u,this.context=h,this.once=p||!1}function a(u,h,p,m,x){if(typeof p!="function")throw new TypeError("The listener must be a function");var b=new i(p,m||u,x),v=r?r+h:h;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],b]:u._events[v].push(b):(u._events[v]=b,u._eventsCount++),u}function l(u,h){--u._eventsCount===0?u._events=new n:delete u._events[h]}function d(){this._events=new n,this._eventsCount=0}d.prototype.eventNames=function(){var h=[],p,m;if(this._eventsCount===0)return h;for(m in p=this._events)e.call(p,m)&&h.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(p)):h},d.prototype.listeners=function(h){var p=r?r+h:h,m=this._events[p];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,b=m.length,v=new Array(b);x<b;x++)v[x]=m[x].fn;return v},d.prototype.listenerCount=function(h){var p=r?r+h:h,m=this._events[p];return m?m.fn?1:m.length:0},d.prototype.emit=function(h,p,m,x,b,v){var w=r?r+h:h;if(!this._events[w])return!1;var k=this._events[w],_=arguments.length,T,A;if(k.fn){switch(k.once&&this.removeListener(h,k.fn,void 0,!0),_){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,p),!0;case 3:return k.fn.call(k.context,p,m),!0;case 4:return k.fn.call(k.context,p,m,x),!0;case 5:return k.fn.call(k.context,p,m,x,b),!0;case 6:return k.fn.call(k.context,p,m,x,b,v),!0}for(A=1,T=new Array(_-1);A<_;A++)T[A-1]=arguments[A];k.fn.apply(k.context,T)}else{var I=k.length,O;for(A=0;A<I;A++)switch(k[A].once&&this.removeListener(h,k[A].fn,void 0,!0),_){case 1:k[A].fn.call(k[A].context);break;case 2:k[A].fn.call(k[A].context,p);break;case 3:k[A].fn.call(k[A].context,p,m);break;case 4:k[A].fn.call(k[A].context,p,m,x);break;default:if(!T)for(O=1,T=new Array(_-1);O<_;O++)T[O-1]=arguments[O];k[A].fn.apply(k[A].context,T)}}return!0},d.prototype.on=function(h,p,m){return a(this,h,p,m,!1)},d.prototype.once=function(h,p,m){return a(this,h,p,m,!0)},d.prototype.removeListener=function(h,p,m,x){var b=r?r+h:h;if(!this._events[b])return this;if(!p)return l(this,b),this;var v=this._events[b];if(v.fn)v.fn===p&&(!x||v.once)&&(!m||v.context===m)&&l(this,b);else{for(var w=0,k=[],_=v.length;w<_;w++)(v[w].fn!==p||x&&!v[w].once||m&&v[w].context!==m)&&k.push(v[w]);k.length?this._events[b]=k.length===1?k[0]:k:l(this,b)}return this},d.prototype.removeAllListeners=function(h){var p;return h?(p=r?r+h:h,this._events[p]&&l(this,p)):(this._events=new n,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=r,d.EventEmitter=d,t.exports=d})(dw)),dw.exports}var kse=Nse();const XI=Ms(kse),Bj=new WeakMap,$j=["error","warn","log","info"];let Uj="warn";function JI(t){if(Uj&&$j.indexOf(t)<=$j.indexOf(Uj)){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];console[t](...r)}}function hl(t){return $j.reduce((e,r)=>(e[r]=JI.bind(console,r,t),e),{})}hl.level=t=>{Uj=t};JI.level=hl.level;const uw=hl("quill:events"),Sse=["selectionchange","mousedown","mouseup","click"];Sse.forEach(t=>{document.addEventListener(t,function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(i=>{const a=Bj.get(i);a&&a.emitter&&a.emitter.handleDOM(...r)})})});class lt extends XI{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",uw.error)}emit(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return uw.log.call(uw,...r),super.emit(...r)}handleDOM(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(this.domListeners[e.type]||[]).forEach(a=>{let{node:l,handler:d}=a;(e.target===l||l.contains(e.target))&&d(e,...n)})}listenDOM(e,r,n){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:r,handler:n})}}const hw=hl("quill:selection");class gd{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=r}}class _se{constructor(e,r){this.emitter=r,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new gd(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,lt.sources.USER),1)}),this.emitter.on(lt.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(lt.events.SCROLL_UPDATE,(i,a)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);const l=a.some(d=>d.type==="characterData"||d.type==="childList"||d.type==="attributes"&&d.target===this.root);this.update(l?lt.sources.SILENT:i)}catch{}})}),this.emitter.on(lt.events.SCROLL_OPTIMIZE,(n,i)=>{if(i.range){const{startNode:a,startOffset:l,endNode:d,endOffset:u}=i.range;this.setNativeRange(a,l,d,u),this.update(lt.sources.SILENT)}}),this.update(lt.sources.SILENT)}handleComposition(){this.emitter.on(lt.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(lt.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(lt.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,r){this.scroll.update();const n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(e,ht.BLOCK))){if(n.start.node!==this.cursor.textNode){const i=this.scroll.find(n.start.node,!1);if(i==null)return;if(i instanceof ms){const a=i.split(n.start.offset);i.parent.insertBefore(this.cursor,a)}else i.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,r),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.scroll.length();e=Math.min(e,n-1),r=Math.min(e+r,n-1)-e;let i,[a,l]=this.scroll.leaf(e);if(a==null)return null;if(r>0&&l===a.length()){const[p]=this.scroll.leaf(e+1);if(p){const[m]=this.scroll.line(e),[x]=this.scroll.line(e+1);m===x&&(a=p,l=0)}}[i,l]=a.position(l,!0);const d=document.createRange();if(r>0)return d.setStart(i,l),[a,l]=this.scroll.leaf(e+r),a==null?null:([i,l]=a.position(l,!0),d.setEnd(i,l),d.getBoundingClientRect());let u="left",h;if(i instanceof Text){if(!i.data.length)return null;l<i.data.length?(d.setStart(i,l),d.setEnd(i,l+1)):(d.setStart(i,l-1),d.setEnd(i,l),u="right"),h=d.getBoundingClientRect()}else{if(!(a.domNode instanceof Element))return null;h=a.domNode.getBoundingClientRect(),l>0&&(u="right")}return{bottom:h.top+h.height,height:h.height,left:h[u],right:h[u],top:h.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const r=e.getRangeAt(0);if(r==null)return null;const n=this.normalizeNative(r);return hw.info("getNativeRange",n),n}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const r=this.getNativeRange();return r==null?[null,null]:[this.normalizedToRange(r),r]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&fw(this.root,document.activeElement)}normalizedToRange(e){const r=[[e.start.node,e.start.offset]];e.native.collapsed||r.push([e.end.node,e.end.offset]);const n=r.map(l=>{const[d,u]=l,h=this.scroll.find(d,!0),p=h.offset(this.scroll);return u===0?p:h instanceof ms?p+h.index(d,u):p+h.length()}),i=Math.min(Math.max(...n),this.scroll.length()-1),a=Math.min(i,...n);return new gd(a,i-a)}normalizeNative(e){if(!fw(this.root,e.startContainer)||!e.collapsed&&!fw(this.root,e.endContainer))return null;const r={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[r.start,r.end].forEach(n=>{let{node:i,offset:a}=n;for(;!(i instanceof Text)&&i.childNodes.length>0;)if(i.childNodes.length>a)i=i.childNodes[a],a=0;else if(i.childNodes.length===a)i=i.lastChild,i instanceof Text?a=i.data.length:i.childNodes.length>0?a=i.childNodes.length:a=i.childNodes.length+1;else break;n.node=i,n.offset=a}),r}rangeToNative(e){const r=this.scroll.length(),n=(i,a)=>{i=Math.min(r-1,i);const[l,d]=this.scroll.leaf(i);return l?l.position(d,a):[null,-1]};return[...n(e.index,!1),...n(e.index+e.length,!0)]}setNativeRange(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(hw.info("setNativeRange",e,r,n,i),e!=null&&(this.root.parentNode==null||e.parentNode==null||n.parentNode==null))return;const l=document.getSelection();if(l!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:d}=this.getNativeRange()||{};if(d==null||a||e!==d.startContainer||r!==d.startOffset||n!==d.endContainer||i!==d.endOffset){e instanceof Element&&e.tagName==="BR"&&(r=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),n instanceof Element&&n.tagName==="BR"&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const u=document.createRange();u.setStart(e,r),u.setEnd(n,i),l.removeAllRanges(),l.addRange(u)}}else l.removeAllRanges(),this.root.blur()}setRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lt.sources.API;if(typeof r=="string"&&(n=r,r=!1),hw.info("setRange",e),e!=null){const i=this.rangeToNative(e);this.setNativeRange(...i,r)}else this.setNativeRange(null);this.update(n)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lt.sources.USER;const r=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,this.lastRange!=null&&(this.savedRange=this.lastRange),!tc(r,this.lastRange)){if(!this.composing&&i!=null&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const l=this.cursor.restore();l&&this.setNativeRange(l.startNode,l.startOffset,l.endNode,l.endOffset)}const a=[lt.events.SELECTION_CHANGE,$u(this.lastRange),$u(r),e];this.emitter.emit(lt.events.EDITOR_CHANGE,...a),e!==lt.sources.SILENT&&this.emitter.emit(...a)}}}function fw(t,e){try{e.parentNode}catch{return!1}return t.contains(e)}const Cse=/^[ -~]*$/;class Ese{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let r=this.scroll.length();this.scroll.batchStart();const n=N6(e),i=new dt;return Tse(n.ops.slice()).reduce((l,d)=>{const u=Hi.Op.length(d);let h=d.attributes||{},p=!1,m=!1;if(d.insert!=null){if(i.retain(u),typeof d.insert=="string"){const v=d.insert;m=!v.endsWith(`
`)&&(r<=l||!!this.scroll.descendant(Fi,l)[0]),this.scroll.insertAt(l,v);const[w,k]=this.scroll.line(l);let _=dc({},zi(w));if(w instanceof ns){const[T]=w.descendant(ms,k);T&&(_=dc(_,zi(T)))}h=Hi.AttributeMap.diff(_,h)||{}}else if(typeof d.insert=="object"){const v=Object.keys(d.insert)[0];if(v==null)return l;const w=this.scroll.query(v,ht.INLINE)!=null;if(w)(r<=l||this.scroll.descendant(Fi,l)[0])&&(m=!0);else if(l>0){const[k,_]=this.scroll.descendant(ms,l-1);k instanceof ka?k.value()[_]!==`
`&&(p=!0):k instanceof bi&&k.statics.scope===ht.INLINE_BLOT&&(p=!0)}if(this.scroll.insertAt(l,v,d.insert[v]),w){const[k]=this.scroll.descendant(ms,l);if(k){const _=dc({},zi(k));h=Hi.AttributeMap.diff(_,h)||{}}}}r+=u}else if(i.push(d),d.retain!==null&&typeof d.retain=="object"){const v=Object.keys(d.retain)[0];if(v==null)return l;this.scroll.updateEmbedAt(l,v,d.retain[v])}Object.keys(h).forEach(v=>{this.scroll.formatAt(l,u,v,h[v])});const x=p?1:0,b=m?1:0;return r+=x+b,i.retain(x),i.delete(b),l+u+x+b},0),i.reduce((l,d)=>typeof d.delete=="number"?(this.scroll.deleteAt(l,d.delete),l):l+Hi.Op.length(d),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(e,r){return this.scroll.deleteAt(e,r),this.update(new dt().retain(e).delete(r))}formatLine(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(a=>{this.scroll.lines(e,Math.max(r,1)).forEach(l=>{l.format(a,n[a])})}),this.scroll.optimize();const i=new dt().retain(e).retain(r,$u(n));return this.update(i)}formatText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(a=>{this.scroll.formatAt(e,r,a,n[a])});const i=new dt().retain(e).retain(r,$u(n));return this.update(i)}getContents(e,r){return this.delta.slice(e,e+r)}getDelta(){return this.scroll.lines().reduce((e,r)=>e.concat(r.delta()),new dt)}getFormat(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],i=[];r===0?this.scroll.path(e).forEach(d=>{const[u]=d;u instanceof ns?n.push(u):u instanceof ms&&i.push(u)}):(n=this.scroll.lines(e,r),i=this.scroll.descendants(ms,e,r));const[a,l]=[n,i].map(d=>{const u=d.shift();if(u==null)return{};let h=zi(u);for(;Object.keys(h).length>0;){const p=d.shift();if(p==null)return h;h=Ase(zi(p),h)}return h});return{...a,...l}}getHTML(e,r){const[n,i]=this.scroll.line(e);if(n){const a=n.length();return n.length()>=i+r&&!(i===0&&r===a)?r0(n,i,r,!0):r0(this.scroll,e,r,!0)}return""}getText(e,r){return this.getContents(e,r).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(e,r){const n=N6(r),i=new dt().retain(e).concat(n);return this.scroll.insertContents(e,n),this.update(i)}insertEmbed(e,r,n){return this.scroll.insertAt(e,r,n),this.update(new dt().retain(e).insert({[r]:n}))}insertText(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r=r.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,r),Object.keys(n).forEach(i=>{this.scroll.formatAt(e,r.length,i,n[i])}),this.update(new dt().retain(e).insert(r,$u(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==ns.blotName)return!1;const r=e;return r.children.length>1?!1:r.children.head instanceof Aa}removeFormat(e,r){const n=this.getText(e,r),[i,a]=this.scroll.line(e+r);let l=0,d=new dt;i!=null&&(l=i.length()-a,d=i.delta().slice(a,a+l-1).insert(`
`));const h=this.getContents(e,r+l).diff(new dt().insert(n).concat(d)),p=new dt().retain(e).concat(h);return this.applyDelta(p)}update(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const i=this.delta;if(r.length===1&&r[0].type==="characterData"&&r[0].target.data.match(Cse)&&this.scroll.find(r[0].target)){const a=this.scroll.find(r[0].target),l=zi(a),d=a.offset(this.scroll),u=r[0].oldValue.replace(ly.CONTENTS,""),h=new dt().insert(u),p=new dt().insert(a.value()),m=n&&{oldRange:k6(n.oldRange,-d),newRange:k6(n.newRange,-d)};e=new dt().retain(d).concat(h.diff(p,m)).reduce((b,v)=>v.insert?b.insert(v.insert,l):b.push(v),new dt),this.delta=i.compose(e)}else this.delta=this.getDelta(),(!e||!tc(i.compose(e),this.delta))&&(e=i.diff(this.delta,n));return e}}function Eu(t,e,r){if(t.length===0){const[b]=pw(r.pop());return e<=0?`</li></${b}>`:`</li></${b}>${Eu([],e-1,r)}`}const[{child:n,offset:i,length:a,indent:l,type:d},...u]=t,[h,p]=pw(d);if(l>e)return r.push(d),l===e+1?`<${h}><li${p}>${r0(n,i,a)}${Eu(u,l,r)}`:`<${h}><li>${Eu(t,e+1,r)}`;const m=r[r.length-1];if(l===e&&d===m)return`</li><li${p}>${r0(n,i,a)}${Eu(u,l,r)}`;const[x]=pw(r.pop());return`</li></${x}>${Eu(t,e-1,r)}`}function r0(t,e,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in t&&typeof t.html=="function")return t.html(e,r);if(t instanceof ka)return oy(t.value().slice(e,e+r)).replaceAll(" ","&nbsp;");if(t instanceof ja){if(t.statics.blotName==="list-container"){const h=[];return t.children.forEachAt(e,r,(p,m,x)=>{const b="formats"in p&&typeof p.formats=="function"?p.formats():{};h.push({child:p,offset:m,length:x,indent:b.indent||0,type:b.list})}),Eu(h,-1,[])}const i=[];if(t.children.forEachAt(e,r,(h,p,m)=>{i.push(r0(h,p,m))}),n||t.statics.blotName==="list")return i.join("");const{outerHTML:a,innerHTML:l}=t.domNode,[d,u]=a.split(`>${l}<`);return d==="<table"?`<table style="border: 1px solid #000;">${i.join("")}<${u}`:`${d}>${i.join("")}<${u}`}return t.domNode instanceof Element?t.domNode.outerHTML:""}function Ase(t,e){return Object.keys(e).reduce((r,n)=>{if(t[n]==null)return r;const i=e[n];return i===t[n]?r[n]=i:Array.isArray(i)?i.indexOf(t[n])<0?r[n]=i.concat([t[n]]):r[n]=i:r[n]=[i,t[n]],r},{})}function pw(t){const e=t==="ordered"?"ol":"ul";switch(t){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function N6(t){return t.reduce((e,r)=>{if(typeof r.insert=="string"){const n=r.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(n,r.attributes)}return e.push(r)},new dt)}function k6(t,e){let{index:r,length:n}=t;return new gd(r+e,n)}function Tse(t){const e=[];return t.forEach(r=>{typeof r.insert=="string"?r.insert.split(`
`).forEach((i,a)=>{a&&e.push({insert:`
`,attributes:r.attributes}),i&&e.push({insert:i,attributes:r.attributes})}):e.push(r)}),e}class lo{static DEFAULTS={};constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=r}}const Rm="\uFEFF";class G4 extends bi{constructor(e,r){super(e,r),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(Rm),this.rightGuard=document.createTextNode(Rm),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,r){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,r)}restore(e){let r=null,n;const i=e.data.split(Rm).join("");if(e===this.leftGuard)if(this.prev instanceof ka){const a=this.prev.length();this.prev.insertAt(a,i),r={startNode:this.prev.domNode,startOffset:a+i.length}}else n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this),r={startNode:n,startOffset:i.length};else e===this.rightGuard&&(this.next instanceof ka?(this.next.insertAt(0,i),r={startNode:this.next.domNode,startOffset:i.length}):(n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this.next),r={startNode:n,startOffset:i.length}));return e.data=Rm,r}update(e,r){e.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){const i=this.restore(n.target);i&&(r.range=i)}})}}class Ose{isComposing=!1;constructor(e,r){this.scroll=e,this.emitter=r,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const r=e.target instanceof Node?this.scroll.find(e.target,!0):null;r&&!(r instanceof G4)&&(this.emitter.emit(lt.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(lt.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(lt.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(lt.events.COMPOSITION_END,e),this.isComposing=!1}}class uh{static DEFAULTS={modules:{}};static themes={default:uh};modules={};constructor(e,r){this.quill=e,this.options=r}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const r=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new r(this.quill,this.options.modules[e]||{}),this.modules[e]}}const Mse=t=>t.parentElement||t.getRootNode().host||null,Lse=t=>{const e=t.getBoundingClientRect(),r="offsetWidth"in t&&Math.abs(e.width)/t.offsetWidth||1,n="offsetHeight"in t&&Math.abs(e.height)/t.offsetHeight||1;return{top:e.top,right:e.left+t.clientWidth*r,bottom:e.top+t.clientHeight*n,left:e.left}},Pm=t=>{const e=parseInt(t,10);return Number.isNaN(e)?0:e},S6=(t,e,r,n,i,a)=>t<r&&e>n?0:t<r?-(r-t+i):e>n?e-t>n-r?t+i-r:e-n+a:0,Rse=(t,e)=>{const r=t.ownerDocument;let n=e,i=t;for(;i;){const a=i===r.body,l=a?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:Lse(i),d=getComputedStyle(i),u=S6(n.left,n.right,l.left,l.right,Pm(d.scrollPaddingLeft),Pm(d.scrollPaddingRight)),h=S6(n.top,n.bottom,l.top,l.bottom,Pm(d.scrollPaddingTop),Pm(d.scrollPaddingBottom));if(u||h)if(a)r.defaultView?.scrollBy(u,h);else{const{scrollLeft:p,scrollTop:m}=i;h&&(i.scrollTop+=h),u&&(i.scrollLeft+=u);const x=i.scrollLeft-p,b=i.scrollTop-m;n={left:n.left-x,top:n.top-b,right:n.right-x,bottom:n.bottom-b}}i=a||d.position==="fixed"?null:Mse(i)}},Pse=100,Ise=["block","break","cursor","inline","scroll","text"],Dse=(t,e,r)=>{const n=new Vu;return Ise.forEach(i=>{const a=e.query(i);a&&n.register(a)}),t.forEach(i=>{let a=e.query(i);a||r.error(`Cannot register "${i}" specified in "formats" config. Are you sure it was registered?`);let l=0;for(;a;)if(n.register(a),a="blotName"in a?a.requiredContainer??null:null,l+=1,l>Pse){r.error(`Cycle detected in registering blot requiredContainer: "${i}"`);break}}),n},zu=hl("quill"),Im=new Vu;ja.uiClass="ql-ui";class $e{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:Im,theme:"default"};static events=lt.events;static sources=lt.sources;static version="2.0.3";static imports={delta:dt,parchment:xse,"core/module":lo,"core/theme":uh};static debug(e){e===!0&&(e="log"),hl.level(e)}static find(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Bj.get(e)||Im.find(e,r)}static import(e){return this.imports[e]==null&&zu.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],r=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in e?e.attrName:e.blotName;typeof n=="string"?this.register(`formats/${n}`,e,r):Object.keys(e).forEach(i=>{this.register(i,e[i],r)})}else{const e=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!n&&zu.warn(`Overwriting ${e} with`,r),this.imports[e]=r,(e.startsWith("blots/")||e.startsWith("formats/"))&&r&&typeof r!="boolean"&&r.blotName!=="abstract"&&Im.register(r),typeof r.register=="function"&&r.register(Im)}}constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=Bse(e,r),this.container=this.options.container,this.container==null){zu.error("Invalid Quill container",e);return}this.options.debug&&$e.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Bj.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new lt;const i=W4.blotName,a=this.options.registry.query(i);if(!a||!("blotName"in a))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new a(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Ese(this.scroll),this.selection=new _se(this.scroll,this.emitter),this.composition=new Ose(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(lt.events.EDITOR_CHANGE,l=>{l===lt.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(lt.events.SCROLL_UPDATE,(l,d)=>{const u=this.selection.lastRange,[h]=this.selection.getRange(),p=u&&h?{oldRange:u,newRange:h}:void 0;ca.call(this,()=>this.editor.update(null,d,p),l)}),this.emitter.on(lt.events.SCROLL_EMBED_UPDATE,(l,d)=>{const u=this.selection.lastRange,[h]=this.selection.getRange(),p=u&&h?{oldRange:u,newRange:h}:void 0;ca.call(this,()=>{const m=new dt().retain(l.offset(this)).retain({[l.statics.blotName]:d});return this.editor.update(m,[],p)},$e.sources.USER)}),n){const l=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(l)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const n=e;e=document.createElement("div"),e.classList.add(n)}return this.container.insertBefore(e,r),e}blur(){this.selection.setRange(null)}deleteText(e,r,n){return[e,r,,n]=Lo(e,r,n),ca.call(this,()=>this.editor.deleteText(e,r),n,e,-1*r)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const r=e();return this.allowReadOnlyEdits=!1,r}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lt.sources.API;return ca.call(this,()=>{const i=this.getSelection(!0);let a=new dt;if(i==null)return a;if(this.scroll.query(e,ht.BLOCK))a=this.editor.formatLine(i.index,i.length,{[e]:r});else{if(i.length===0)return this.selection.format(e,r),a;a=this.editor.formatText(i.index,i.length,{[e]:r})}return this.setSelection(i,lt.sources.SILENT),a},n)}formatLine(e,r,n,i,a){let l;return[e,r,l,a]=Lo(e,r,n,i,a),ca.call(this,()=>this.editor.formatLine(e,r,l),a,e,0)}formatText(e,r,n,i,a){let l;return[e,r,l,a]=Lo(e,r,n,i,a),ca.call(this,()=>this.editor.formatText(e,r,l),a,e,0)}getBounds(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof e=="number"?n=this.selection.getBounds(e,r):n=this.selection.getBounds(e.index,e.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,r]=Lo(e,r),this.editor.getContents(e,r)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,r):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,r)}getModule(e){return this.theme.modules[e]}getSelection(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=Lo(e,r),this.editor.getHTML(e,r)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(r=r??this.getLength()-e),[e,r]=Lo(e,r),this.editor.getText(e,r)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$e.sources.API;return ca.call(this,()=>this.editor.insertEmbed(e,r,n),i,e)}insertText(e,r,n,i,a){let l;return[e,,l,a]=Lo(e,0,n,i,a),ca.call(this,()=>this.editor.insertText(e,r,l),a,e,r.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,r,n){return[e,r,,n]=Lo(e,r,n),ca.call(this,()=>this.editor.removeFormat(e,r),n,e)}scrollRectIntoView(e){Rse(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,r=e&&this.selection.getBounds(e.index,e.length);r&&this.scrollRectIntoView(r)}setContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt.sources.API;return ca.call(this,()=>{e=new dt(e);const n=this.getLength(),i=this.editor.deleteText(0,n),a=this.editor.insertContents(0,e),l=this.editor.deleteText(this.getLength()-1,1);return i.compose(a).compose(l)},r)}setSelection(e,r,n){e==null?this.selection.setRange(null,r||$e.sources.API):([e,r,,n]=Lo(e,r,n),this.selection.setRange(new gd(Math.max(0,e),r),n),n!==lt.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt.sources.API;const n=new dt().insert(e);return this.setContents(n,r)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lt.sources.USER;const r=this.scroll.update(e);return this.selection.update(e),r}updateContents(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt.sources.API;return ca.call(this,()=>(e=new dt(e),this.editor.applyDelta(e)),r,!0)}}function _6(t){return typeof t=="string"?document.querySelector(t):t}function mw(t){return Object.entries(t??{}).reduce((e,r)=>{let[n,i]=r;return{...e,[n]:i===!0?{}:i}},{})}function C6(t){return Object.fromEntries(Object.entries(t).filter(e=>e[1]!==void 0))}function Bse(t,e){const r=_6(t);if(!r)throw new Error("Invalid Quill container");const i=!e.theme||e.theme===$e.DEFAULTS.theme?uh:$e.import(`themes/${e.theme}`);if(!i)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:a,...l}=$e.DEFAULTS,{modules:d,...u}=i.DEFAULTS;let h=mw(e.modules);h!=null&&h.toolbar&&h.toolbar.constructor!==Object&&(h={...h,toolbar:{container:h.toolbar}});const p=dc({},mw(a),mw(d),h),m={...l,...C6(u),...C6(e)};let x=e.registry;return x?e.formats&&zu.warn('Ignoring "formats" option because "registry" is specified'):x=e.formats?Dse(e.formats,m.registry,zu):m.registry,{...m,registry:x,container:r,theme:i,modules:Object.entries(p).reduce((b,v)=>{let[w,k]=v;if(!k)return b;const _=$e.import(`modules/${w}`);return _==null?(zu.error(`Cannot load ${w} module. Are you sure you registered it?`),b):{...b,[w]:dc({},_.DEFAULTS||{},k)}},{}),bounds:_6(m.bounds)}}function ca(t,e,r,n){if(!this.isEnabled()&&e===lt.sources.USER&&!this.allowReadOnlyEdits)return new dt;let i=r==null?null:this.getSelection();const a=this.editor.delta,l=t();if(i!=null&&(r===!0&&(r=i.index),n==null?i=E6(i,l,e):n!==0&&(i=E6(i,r,n,e)),this.setSelection(i,lt.sources.SILENT)),l.length()>0){const d=[lt.events.TEXT_CHANGE,l,a,e];this.emitter.emit(lt.events.EDITOR_CHANGE,...d),e!==lt.sources.SILENT&&this.emitter.emit(...d)}return l}function Lo(t,e,r,n,i){let a={};return typeof t.index=="number"&&typeof t.length=="number"?typeof e!="number"?(i=n,n=r,r=e,e=t.length,t=t.index):(e=t.length,t=t.index):typeof e!="number"&&(i=n,n=r,r=e,e=0),typeof r=="object"?(a=r,i=n):typeof r=="string"&&(n!=null?a[r]=n:i=r),i=i||lt.sources.API,[t,e,a,i]}function E6(t,e,r,n){const i=typeof r=="number"?r:0;if(t==null)return null;let a,l;return e&&typeof e.transformPosition=="function"?[a,l]=[t.index,t.index+t.length].map(d=>e.transformPosition(d,n!==lt.sources.USER)):[a,l]=[t.index,t.index+t.length].map(d=>d<e||d===e&&n===lt.sources.USER?d:i>=0?d+i:Math.max(e,d+i)),new gd(a,l-a)}class Md extends ay{}function A6(t){return t instanceof ns||t instanceof Fi}function T6(t){return typeof t.updateContent=="function"}class $se extends W4{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=ns;static allowedChildren=[ns,Fi,Md];constructor(e,r,n){let{emitter:i}=n;super(e,r),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",a=>this.handleDragStart(a))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(lt.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(lt.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,r){this.emitter.emit(lt.events.SCROLL_EMBED_UPDATE,e,r)}deleteAt(e,r){const[n,i]=this.line(e),[a]=this.line(e+r);if(super.deleteAt(e,r),a!=null&&n!==a&&i>0){if(n instanceof Fi||a instanceof Fi){this.optimize();return}const l=a.children.head instanceof Aa?null:a.children.head;n.moveChildren(a,l),n.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,r,n,i){super.formatAt(e,r,n,i),this.optimize()}insertAt(e,r,n){if(e>=this.length())if(n==null||this.scroll.query(r,ht.BLOCK)==null){const i=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(i),n==null&&r.endsWith(`
`)?i.insertAt(0,r.slice(0,-1),n):i.insertAt(0,r,n)}else{const i=this.scroll.create(r,n);this.appendChild(i)}else super.insertAt(e,r,n);this.optimize()}insertBefore(e,r){if(e.statics.scope===ht.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(e),super.insertBefore(n,r)}else super.insertBefore(e,r)}insertContents(e,r){const n=this.deltaToRenderBlocks(r.concat(new dt().insert(`
`))),i=n.pop();if(i==null)return;this.batchStart();const a=n.shift();if(a){const u=a.type==="block"&&(a.delta.length()===0||!this.descendant(Fi,e)[0]&&e<this.length()),h=a.type==="block"?a.delta:new dt().insert({[a.key]:a.value});gw(this,e,h);const p=a.type==="block"?1:0,m=e+h.length()+p;u&&this.insertAt(m-1,`
`);const x=zi(this.line(e)[0]),b=Hi.AttributeMap.diff(x,a.attributes)||{};Object.keys(b).forEach(v=>{this.formatAt(m-1,1,v,b[v])}),e=m}let[l,d]=this.children.find(e);if(n.length&&(l&&(l=l.split(d),d=0),n.forEach(u=>{if(u.type==="block"){const h=this.createBlock(u.attributes,l||void 0);gw(h,0,u.delta)}else{const h=this.create(u.key,u.value);this.insertBefore(h,l||void 0),Object.keys(u.attributes).forEach(p=>{h.format(p,u.attributes[p])})}})),i.type==="block"&&i.delta.length()){const u=l?l.offset(l.scroll)+d:this.length();gw(this,u,i.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const r=this.path(e).pop();if(!r)return[null,-1];const[n,i]=r;return n instanceof ms?[n,i]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(A6,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const n=(i,a,l)=>{let d=[],u=l;return i.children.forEachAt(a,l,(h,p,m)=>{A6(h)?d.push(h):h instanceof ay&&(d=d.concat(n(h,p,u))),u-=m}),d};return n(this,e,r)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,r),e.length>0&&this.emitter.emit(lt.events.SCROLL_OPTIMIZE,e,r))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let r=lt.sources.USER;typeof e=="string"&&(r=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(n=>{let{target:i}=n;const a=this.find(i,!0);return a&&!T6(a)}),e.length>0&&this.emitter.emit(lt.events.SCROLL_BEFORE_UPDATE,r,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(lt.events.SCROLL_UPDATE,r,e)}updateEmbedAt(e,r,n){const[i]=this.descendant(a=>a instanceof Fi,e);i&&i.statics.blotName===r&&T6(i)&&i.updateContent(n)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const r=[];let n=new dt;return e.forEach(i=>{const a=i?.insert;if(a)if(typeof a=="string"){const l=a.split(`
`);l.slice(0,-1).forEach(u=>{n.insert(u,i.attributes),r.push({type:"block",delta:n,attributes:i.attributes??{}}),n=new dt});const d=l[l.length-1];d&&n.insert(d,i.attributes)}else{const l=Object.keys(a)[0];if(!l)return;this.query(l,ht.INLINE)?n.push(i):(n.length()&&r.push({type:"block",delta:n,attributes:{}}),n=new dt,r.push({type:"blockEmbed",key:l,value:a[l],attributes:i.attributes??{}}))}}),n.length()&&r.push({type:"block",delta:n,attributes:{}}),r}createBlock(e,r){let n;const i={};Object.entries(e).forEach(d=>{let[u,h]=d;this.query(u,ht.BLOCK&ht.BLOT)!=null?n=u:i[u]=h});const a=this.create(n||this.statics.defaultChild.blotName,n?e[n]:void 0);this.insertBefore(a,r||void 0);const l=a.length();return Object.entries(i).forEach(d=>{let[u,h]=d;a.formatAt(0,l,u,h)}),a}}function gw(t,e,r){r.reduce((n,i)=>{const a=Hi.Op.length(i);let l=i.attributes||{};if(i.insert!=null){if(typeof i.insert=="string"){const d=i.insert;t.insertAt(n,d);const[u]=t.descendant(ms,n),h=zi(u);l=Hi.AttributeMap.diff(h,l)||{}}else if(typeof i.insert=="object"){const d=Object.keys(i.insert)[0];if(d==null)return n;if(t.insertAt(n,d,i.insert[d]),t.scroll.query(d,ht.INLINE)!=null){const[h]=t.descendant(ms,n),p=zi(h);l=Hi.AttributeMap.diff(p,l)||{}}}}return Object.keys(l).forEach(d=>{t.formatAt(n,a,d,l[d])}),n+a},e)}const V4={scope:ht.BLOCK,whitelist:["right","center","justify"]},Use=new Za("align","align",V4),QI=new Ea("align","ql-align",V4),ZI=new wc("align","text-align",V4);class e9 extends wc{value(e){let r=super.value(e);return r.startsWith("rgb(")?(r=r.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${r.split(",").map(i=>`00${parseInt(i,10).toString(16)}`.slice(-2)).join("")}`):r}}const zse=new Ea("color","ql-color",{scope:ht.INLINE}),K4=new e9("color","color",{scope:ht.INLINE}),qse=new Ea("background","ql-bg",{scope:ht.INLINE}),Y4=new e9("background","background-color",{scope:ht.INLINE});class Ld extends Md{static create(e){const r=super.create(e);return r.setAttribute("spellcheck","false"),r}code(e,r){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(e,e+r)}html(e,r){return`<pre>
${oy(this.code(e,r))}
</pre>`}}class Es extends ns{static TAB="  ";static register(){$e.register(Ld)}}class X4 extends ks{}X4.blotName="code";X4.tagName="CODE";Es.blotName="code-block";Es.className="ql-code-block";Es.tagName="DIV";Ld.blotName="code-block-container";Ld.className="ql-code-block-container";Ld.tagName="DIV";Ld.allowedChildren=[Es];Es.allowedChildren=[ka,Aa,ly];Es.requiredContainer=Ld;const J4={scope:ht.BLOCK,whitelist:["rtl"]},t9=new Za("direction","dir",J4),r9=new Ea("direction","ql-direction",J4),n9=new wc("direction","direction",J4),s9={scope:ht.INLINE,whitelist:["serif","monospace"]},i9=new Ea("font","ql-font",s9);class Fse extends wc{value(e){return super.value(e).replace(/["']/g,"")}}const a9=new Fse("font","font-family",s9),o9=new Ea("size","ql-size",{scope:ht.INLINE,whitelist:["small","large","huge"]}),l9=new wc("size","font-size",{scope:ht.INLINE,whitelist:["10px","18px","32px"]}),Hse=hl("quill:keyboard"),Wse=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class cy extends lo{static match(e,r){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!r[n]!==e[n]&&r[n]!==null)?!1:r.key===e.key||r.key===e.which}constructor(e,r){super(e,r),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=Vse(e);if(i==null){Hse.warn("Attempted to add invalid keyboard binding",i);return}typeof r=="function"&&(r={handler:r}),typeof n=="function"&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach(l=>{const d={...i,key:l,...r,...n};this.bindings[d.key]=this.bindings[d.key]||[],this.bindings[d.key].push(d)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const i=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(_=>cy.match(e,_));if(i.length===0)return;const a=$e.find(e.target,!0);if(a&&a.scroll!==this.quill.scroll)return;const l=this.quill.getSelection();if(l==null||!this.quill.hasFocus())return;const[d,u]=this.quill.getLine(l.index),[h,p]=this.quill.getLeaf(l.index),[m,x]=l.length===0?[h,p]:this.quill.getLeaf(l.index+l.length),b=h instanceof Jg?h.value().slice(0,p):"",v=m instanceof Jg?m.value().slice(x):"",w={collapsed:l.length===0,empty:l.length===0&&d.length()<=1,format:this.quill.getFormat(l),line:d,offset:u,prefix:b,suffix:v,event:e};i.some(_=>{if(_.collapsed!=null&&_.collapsed!==w.collapsed||_.empty!=null&&_.empty!==w.empty||_.offset!=null&&_.offset!==w.offset)return!1;if(Array.isArray(_.format)){if(_.format.every(T=>w.format[T]==null))return!1}else if(typeof _.format=="object"&&!Object.keys(_.format).every(T=>_.format[T]===!0?w.format[T]!=null:_.format[T]===!1?w.format[T]==null:tc(_.format[T],w.format[T])))return!1;return _.prefix!=null&&!_.prefix.test(w.prefix)||_.suffix!=null&&!_.suffix.test(w.suffix)?!1:_.handler.call(this,l,w,_)!==!0})&&e.preventDefault()})}handleBackspace(e,r){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(r.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let i={};const[a]=this.quill.getLine(e.index);let l=new dt().retain(e.index-n).delete(n);if(r.offset===0){const[d]=this.quill.getLine(e.index-1);if(d&&!(d.statics.blotName==="block"&&d.length()<=1)){const h=a.formats(),p=this.quill.getFormat(e.index-1,1);if(i=Hi.AttributeMap.diff(h,p)||{},Object.keys(i).length>0){const m=new dt().retain(e.index+a.length()-2).retain(1,i);l=l.compose(m)}}}this.quill.updateContents(l,$e.sources.USER),this.quill.focus()}handleDelete(e,r){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(r.suffix)?2:1;if(e.index>=this.quill.getLength()-n)return;let i={};const[a]=this.quill.getLine(e.index);let l=new dt().retain(e.index).delete(n);if(r.offset>=a.length()-1){const[d]=this.quill.getLine(e.index+1);if(d){const u=a.formats(),h=this.quill.getFormat(e.index,1);i=Hi.AttributeMap.diff(u,h)||{},Object.keys(i).length>0&&(l=l.retain(d.length()-1).retain(1,i))}}this.quill.updateContents(l,$e.sources.USER),this.quill.focus()}handleDeleteRange(e){Q4({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,r){const n=Object.keys(r.format).reduce((a,l)=>(this.quill.scroll.query(l,ht.BLOCK)&&!Array.isArray(r.format[l])&&(a[l]=r.format[l]),a),{}),i=new dt().retain(e.index).delete(e.length).insert(`
`,n);this.quill.updateContents(i,$e.sources.USER),this.quill.setSelection(e.index+1,$e.sources.SILENT),this.quill.focus()}}const Gse={bindings:{bold:xw("bold"),italic:xw("italic"),underline:xw("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",$e.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(t,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",$e.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(t,e){e.format.indent!=null?this.quill.format("indent","-1",$e.sources.USER):e.format.list!=null&&this.quill.format("list",!1,$e.sources.USER)}},"indent code-block":O6(!0),"outdent code-block":O6(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(t){this.quill.deleteText(t.index-1,1,$e.sources.USER)}},tab:{key:"Tab",handler(t,e){if(e.format.table)return!0;this.quill.history.cutoff();const r=new dt().retain(t.index).delete(t.length).insert("	");return this.quill.updateContents(r,$e.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,$e.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,$e.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(t,e){const r={list:!1};e.format.indent&&(r.indent=!1),this.quill.formatLine(t.index,t.length,r,$e.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(t){const[e,r]=this.quill.getLine(t.index),n={...e.formats(),list:"checked"},i=new dt().retain(t.index).insert(`
`,n).retain(e.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,$e.sources.USER),this.quill.setSelection(t.index+1,$e.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(t,e){const[r,n]=this.quill.getLine(t.index),i=new dt().retain(t.index).insert(`
`,e.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,$e.sources.USER),this.quill.setSelection(t.index+1,$e.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(t){const e=this.quill.getModule("table");if(e){const[r,n,i,a]=e.getTable(t),l=Kse(r,n,i,a);if(l==null)return;let d=r.offset();if(l<0){const u=new dt().retain(d).insert(`
`);this.quill.updateContents(u,$e.sources.USER),this.quill.setSelection(t.index+1,t.length,$e.sources.SILENT)}else if(l>0){d+=r.length();const u=new dt().retain(d).insert(`
`);this.quill.updateContents(u,$e.sources.USER),this.quill.setSelection(d,$e.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(t,e){const{event:r,line:n}=e,i=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(i-1,$e.sources.USER):this.quill.setSelection(i+n.length(),$e.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(this.quill.scroll.query("list")==null)return!0;const{length:r}=e.prefix,[n,i]=this.quill.getLine(t.index);if(i>r)return!0;let a;switch(e.prefix.trim()){case"[]":case"[ ]":a="unchecked";break;case"[x]":a="checked";break;case"-":case"*":a="bullet";break;default:a="ordered"}this.quill.insertText(t.index," ",$e.sources.USER),this.quill.history.cutoff();const l=new dt().retain(t.index-i).delete(r+1).retain(n.length()-2-i).retain(1,{list:a});return this.quill.updateContents(l,$e.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-r,$e.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(t){const[e,r]=this.quill.getLine(t.index);let n=2,i=e;for(;i!=null&&i.length()<=1&&i.formats()["code-block"];)if(i=i.prev,n-=1,n<=0){const a=new dt().retain(t.index+e.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(a,$e.sources.USER),this.quill.setSelection(t.index-1,$e.sources.SILENT),!1}return!0}},"embed left":Dm("ArrowLeft",!1),"embed left shift":Dm("ArrowLeft",!0),"embed right":Dm("ArrowRight",!1),"embed right shift":Dm("ArrowRight",!0),"table down":M6(!1),"table up":M6(!0)}};cy.DEFAULTS=Gse;function O6(t){return{key:"Tab",shiftKey:!t,format:{"code-block":!0},handler(e,r){let{event:n}=r;const i=this.quill.scroll.query("code-block"),{TAB:a}=i;if(e.length===0&&!n.shiftKey){this.quill.insertText(e.index,a,$e.sources.USER),this.quill.setSelection(e.index+a.length,$e.sources.SILENT);return}const l=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:d,length:u}=e;l.forEach((h,p)=>{t?(h.insertAt(0,a),p===0?d+=a.length:u+=a.length):h.domNode.textContent.startsWith(a)&&(h.deleteAt(0,a.length),p===0?d-=a.length:u-=a.length)}),this.quill.update($e.sources.USER),this.quill.setSelection(d,u,$e.sources.SILENT)}}}function Dm(t,e){return{key:t,shiftKey:e,altKey:null,[t==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;t==="ArrowRight"&&(i+=n.length+1);const[a]=this.quill.getLeaf(i);return a instanceof bi?(t==="ArrowLeft"?e?this.quill.setSelection(n.index-1,n.length+1,$e.sources.USER):this.quill.setSelection(n.index-1,$e.sources.USER):e?this.quill.setSelection(n.index,n.length+1,$e.sources.USER):this.quill.setSelection(n.index+n.length+1,$e.sources.USER),!1):!0}}}function xw(t){return{key:t[0],shortKey:!0,handler(e,r){this.quill.format(t,!r.format[t],$e.sources.USER)}}}function M6(t){return{key:t?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,r){const n=t?"prev":"next",i=r.line,a=i.parent[n];if(a!=null){if(a.statics.blotName==="table-row"){let l=a.children.head,d=i;for(;d.prev!=null;)d=d.prev,l=l.next;const u=l.offset(this.quill.scroll)+Math.min(r.offset,l.length()-1);this.quill.setSelection(u,0,$e.sources.USER)}}else{const l=i.table()[n];l!=null&&(t?this.quill.setSelection(l.offset(this.quill.scroll)+l.length()-1,0,$e.sources.USER):this.quill.setSelection(l.offset(this.quill.scroll),0,$e.sources.USER))}return!1}}}function Vse(t){if(typeof t=="string"||typeof t=="number")t={key:t};else if(typeof t=="object")t=$u(t);else return null;return t.shortKey&&(t[Wse]=t.shortKey,delete t.shortKey),t}function Q4(t){let{quill:e,range:r}=t;const n=e.getLines(r);let i={};if(n.length>1){const a=n[0].formats(),l=n[n.length-1].formats();i=Hi.AttributeMap.diff(l,a)||{}}e.deleteText(r,$e.sources.USER),Object.keys(i).length>0&&e.formatLine(r.index,1,i,$e.sources.USER),e.setSelection(r.index,$e.sources.SILENT)}function Kse(t,e,r,n){return e.prev==null&&e.next==null?r.prev==null&&r.next==null?n===0?-1:1:r.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const Yse=/font-weight:\s*normal/,Xse=["P","OL","UL"],L6=t=>t&&Xse.includes(t.tagName),Jse=t=>{Array.from(t.querySelectorAll("br")).filter(e=>L6(e.previousElementSibling)&&L6(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)})},Qse=t=>{Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(Yse)).forEach(e=>{const r=t.createDocumentFragment();r.append(...e.childNodes),e.parentNode?.replaceChild(r,e)})};function Zse(t){t.querySelector('[id^="docs-internal-guid-"]')&&(Qse(t),Jse(t))}const eie=/\bmso-list:[^;]*ignore/i,tie=/\bmso-list:[^;]*\bl(\d+)/i,rie=/\bmso-list:[^;]*\blevel(\d+)/i,nie=(t,e)=>{const r=t.getAttribute("style"),n=r?.match(tie);if(!n)return null;const i=Number(n[1]),a=r?.match(rie),l=a?Number(a[1]):1,d=new RegExp(`@list l${i}:level${l}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),u=e.match(d),h=u&&u[1]==="bullet"?"bullet":"ordered";return{id:i,indent:l,type:h,element:t}},sie=t=>{const e=Array.from(t.querySelectorAll("[style*=mso-list]")),r=[],n=[];e.forEach(l=>{(l.getAttribute("style")||"").match(eie)?r.push(l):n.push(l)}),r.forEach(l=>l.parentNode?.removeChild(l));const i=t.documentElement.innerHTML,a=n.map(l=>nie(l,i)).filter(l=>l);for(;a.length;){const l=[];let d=a.shift();for(;d;)l.push(d),d=a.length&&a[0]?.element===d.element.nextElementSibling&&a[0].id===d.id?a.shift():null;const u=document.createElement("ul");l.forEach(m=>{const x=document.createElement("li");x.setAttribute("data-list",m.type),m.indent>1&&x.setAttribute("class",`ql-indent-${m.indent-1}`),x.innerHTML=m.element.innerHTML,u.appendChild(x)});const h=l[0]?.element,{parentNode:p}=h??{};h&&p?.replaceChild(u,h),l.slice(1).forEach(m=>{let{element:x}=m;p?.removeChild(x)})}};function iie(t){t.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&sie(t)}const aie=[iie,Zse],oie=t=>{t.documentElement&&aie.forEach(e=>{e(t)})},lie=hl("quill:clipboard"),cie=[[Node.TEXT_NODE,jie],[Node.TEXT_NODE,P6],["br",mie],[Node.ELEMENT_NODE,P6],[Node.ELEMENT_NODE,pie],[Node.ELEMENT_NODE,fie],[Node.ELEMENT_NODE,vie],["li",yie],["ol, ul",bie],["pre",gie],["tr",wie],["b",yw("bold")],["i",yw("italic")],["strike",yw("strike")],["style",xie]],die=[Use,t9].reduce((t,e)=>(t[e.keyName]=e,t),{}),R6=[ZI,Y4,K4,n9,a9,l9].reduce((t,e)=>(t[e.keyName]=e,t),{});class uie extends lo{static DEFAULTS={matchers:[]};constructor(e,r){super(e,r),this.quill.root.addEventListener("copy",n=>this.onCaptureCopy(n,!1)),this.quill.root.addEventListener("cut",n=>this.onCaptureCopy(n,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],cie.concat(this.options.matchers??[]).forEach(n=>{let[i,a]=n;this.addMatcher(i,a)})}addMatcher(e,r){this.matchers.push([e,r])}convert(e){let{html:r,text:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i[Es.blotName])return new dt().insert(n||"",{[Es.blotName]:i[Es.blotName]});if(!r)return new dt().insert(n||"",i);const a=this.convertHTML(r);return P0(a,`
`)&&(a.ops[a.ops.length-1].attributes==null||i.table)?a.compose(new dt().retain(a.length()-1).delete(1)):a}normalizeHTML(e){oie(e)}convertHTML(e){const r=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(r);const n=r.body,i=new WeakMap,[a,l]=this.prepareMatching(n,i);return Z4(this.quill.scroll,n,a,l,i)}dangerouslyPasteHTML(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$e.sources.API;if(typeof e=="string"){const i=this.convert({html:e,text:""});this.quill.setContents(i,r),this.quill.setSelection(0,$e.sources.SILENT)}else{const i=this.convert({html:r,text:""});this.quill.updateContents(new dt().retain(e).concat(i),n),this.quill.setSelection(e+i.length(),$e.sources.SILENT)}}onCaptureCopy(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[n]=this.quill.selection.getRange();if(n==null)return;const{html:i,text:a}=this.onCopy(n,r);e.clipboardData?.setData("text/plain",a),e.clipboardData?.setData("text/html",i),r&&Q4({range:n,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(r=>r[0]!=="#").join(`
`)}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const r=this.quill.getSelection(!0);if(r==null)return;const n=e.clipboardData?.getData("text/html");let i=e.clipboardData?.getData("text/plain");if(!n&&!i){const l=e.clipboardData?.getData("text/uri-list");l&&(i=this.normalizeURIList(l))}const a=Array.from(e.clipboardData?.files||[]);if(!n&&a.length>0){this.quill.uploader.upload(r,a);return}if(n&&a.length>0){const l=new DOMParser().parseFromString(n,"text/html");if(l.body.childElementCount===1&&l.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(r,a);return}}this.onPaste(r,{html:n,text:i})}onCopy(e){const r=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:r}}onPaste(e,r){let{text:n,html:i}=r;const a=this.quill.getFormat(e.index),l=this.convert({text:n,html:i},a);lie.log("onPaste",l,{text:n,html:i});const d=new dt().retain(e.index).delete(e.length).concat(l);this.quill.updateContents(d,$e.sources.USER),this.quill.setSelection(d.length()-e.length,$e.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,r){const n=[],i=[];return this.matchers.forEach(a=>{const[l,d]=a;switch(l){case Node.TEXT_NODE:i.push(d);break;case Node.ELEMENT_NODE:n.push(d);break;default:Array.from(e.querySelectorAll(l)).forEach(u=>{r.has(u)?r.get(u)?.push(d):r.set(u,[d])});break}}),[n,i]}}function Rd(t,e,r,n){return n.query(e)?t.reduce((i,a)=>{if(!a.insert)return i;if(a.attributes&&a.attributes[e])return i.push(a);const l=r?{[e]:r}:{};return i.insert(a.insert,{...l,...a.attributes})},new dt):t}function P0(t,e){let r="";for(let n=t.ops.length-1;n>=0&&r.length<e.length;--n){const i=t.ops[n];if(typeof i.insert!="string")break;r=i.insert+r}return r.slice(-1*e.length)===e}function sc(t,e){if(!(t instanceof Element))return!1;const r=e.query(t);return r&&r.prototype instanceof bi?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(t.tagName.toLowerCase())}function hie(t,e){return t.previousElementSibling&&t.nextElementSibling&&!sc(t.previousElementSibling,e)&&!sc(t.nextElementSibling,e)}const Bm=new WeakMap;function c9(t){return t==null?!1:(Bm.has(t)||(t.tagName==="PRE"?Bm.set(t,!0):Bm.set(t,c9(t.parentNode))),Bm.get(t))}function Z4(t,e,r,n,i){return e.nodeType===e.TEXT_NODE?n.reduce((a,l)=>l(e,a,t),new dt):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((a,l)=>{let d=Z4(t,l,r,n,i);return l.nodeType===e.ELEMENT_NODE&&(d=r.reduce((u,h)=>h(l,u,t),d),d=(i.get(l)||[]).reduce((u,h)=>h(l,u,t),d)),a.concat(d)},new dt):new dt}function yw(t){return(e,r,n)=>Rd(r,t,!0,n)}function fie(t,e,r){const n=Za.keys(t),i=Ea.keys(t),a=wc.keys(t),l={};return n.concat(i).concat(a).forEach(d=>{let u=r.query(d,ht.ATTRIBUTE);u!=null&&(l[u.attrName]=u.value(t),l[u.attrName])||(u=die[d],u!=null&&(u.attrName===d||u.keyName===d)&&(l[u.attrName]=u.value(t)||void 0),u=R6[d],u!=null&&(u.attrName===d||u.keyName===d)&&(u=R6[d],l[u.attrName]=u.value(t)||void 0))}),Object.entries(l).reduce((d,u)=>{let[h,p]=u;return Rd(d,h,p,r)},e)}function pie(t,e,r){const n=r.query(t);if(n==null)return e;if(n.prototype instanceof bi){const i={},a=n.value(t);if(a!=null)return i[n.blotName]=a,new dt().insert(i,n.formats(t,r))}else if(n.prototype instanceof t0&&!P0(e,`
`)&&e.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return Rd(e,n.blotName,n.formats(t,r),r);return e}function mie(t,e){return P0(e,`
`)||e.insert(`
`),e}function gie(t,e,r){const n=r.query("code-block"),i=n&&"formats"in n&&typeof n.formats=="function"?n.formats(t,r):!0;return Rd(e,"code-block",i,r)}function xie(){return new dt}function yie(t,e,r){const n=r.query(t);if(n==null||n.blotName!=="list"||!P0(e,`
`))return e;let i=-1,a=t.parentNode;for(;a!=null;)["OL","UL"].includes(a.tagName)&&(i+=1),a=a.parentNode;return i<=0?e:e.reduce((l,d)=>d.insert?d.attributes&&typeof d.attributes.indent=="number"?l.push(d):l.insert(d.insert,{indent:i,...d.attributes||{}}):l,new dt)}function bie(t,e,r){const n=t;let i=n.tagName==="OL"?"ordered":"bullet";const a=n.getAttribute("data-checked");return a&&(i=a==="true"?"checked":"unchecked"),Rd(e,"list",i,r)}function P6(t,e,r){if(!P0(e,`
`)){if(sc(t,r)&&(t.childNodes.length>0||t instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&t.nextSibling){let n=t.nextSibling;for(;n!=null;){if(sc(n,r))return e.insert(`
`);const i=r.query(n);if(i&&i.prototype instanceof Fi)return e.insert(`
`);n=n.firstChild}}}return e}function vie(t,e,r){const n={},i=t.style||{};return i.fontStyle==="italic"&&(n.italic=!0),i.textDecoration==="underline"&&(n.underline=!0),i.textDecoration==="line-through"&&(n.strike=!0),(i.fontWeight?.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),e=Object.entries(n).reduce((a,l)=>{let[d,u]=l;return Rd(a,d,u,r)},e),parseFloat(i.textIndent||0)>0?new dt().insert("	").concat(e):e}function wie(t,e,r){const n=t.parentElement?.tagName==="TABLE"?t.parentElement:t.parentElement?.parentElement;if(n!=null){const a=Array.from(n.querySelectorAll("tr")).indexOf(t)+1;return Rd(e,"table",a,r)}return e}function jie(t,e,r){let n=t.data;if(t.parentElement?.tagName==="O:P")return e.insert(n.trim());if(!c9(t)){if(n.trim().length===0&&n.includes(`
`)&&!hie(t,r))return e;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(t.previousSibling==null&&t.parentElement!=null&&sc(t.parentElement,r)||t.previousSibling instanceof Element&&sc(t.previousSibling,r))&&(n=n.replace(/^ /,"")),(t.nextSibling==null&&t.parentElement!=null&&sc(t.parentElement,r)||t.nextSibling instanceof Element&&sc(t.nextSibling,r))&&(n=n.replace(/ $/,"")),n=n.replaceAll(""," ")}return e.insert(n)}class Nie extends lo{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,r){super(e,r),this.quill.on($e.events.EDITOR_CHANGE,(n,i,a,l)=>{n===$e.events.SELECTION_CHANGE?i&&l!==$e.sources.SILENT&&(this.currentRange=i):n===$e.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||l===$e.sources.USER?this.record(i,a):this.transform(i)),this.currentRange=zj(this.currentRange,i))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",n=>{n.inputType==="historyUndo"?(this.undo(),n.preventDefault()):n.inputType==="historyRedo"&&(this.redo(),n.preventDefault())})}change(e,r){if(this.stack[e].length===0)return;const n=this.stack[e].pop();if(!n)return;const i=this.quill.getContents(),a=n.delta.invert(i);this.stack[r].push({delta:a,range:zj(n.range,a)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,$e.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,r){if(e.ops.length===0)return;this.stack.redo=[];let n=e.invert(r),i=this.currentRange;const a=Date.now();if(this.lastRecorded+this.options.delay>a&&this.stack.undo.length>0){const l=this.stack.undo.pop();l&&(n=n.compose(l.delta),i=l.range)}else this.lastRecorded=a;n.length()!==0&&(this.stack.undo.push({delta:n,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){I6(this.stack.undo,e),I6(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,$e.sources.USER);else{const r=Sie(this.quill.scroll,e.delta);this.quill.setSelection(r,$e.sources.USER)}}}function I6(t,e){let r=e;for(let n=t.length-1;n>=0;n-=1){const i=t[n];t[n]={delta:r.transform(i.delta,!0),range:i.range&&zj(i.range,r)},r=i.delta.transform(r),t[n].delta.length()===0&&t.splice(n,1)}}function kie(t,e){const r=e.ops[e.ops.length-1];return r==null?!1:r.insert!=null?typeof r.insert=="string"&&r.insert.endsWith(`
`):r.attributes!=null?Object.keys(r.attributes).some(n=>t.query(n,ht.BLOCK)!=null):!1}function Sie(t,e){const r=e.reduce((i,a)=>i+(a.delete||0),0);let n=e.length()-r;return kie(t,e)&&(n-=1),n}function zj(t,e){if(!t)return t;const r=e.transformPosition(t.index),n=e.transformPosition(t.index+t.length);return{index:r,length:n-r}}class d9 extends lo{constructor(e,r){super(e,r),e.root.addEventListener("drop",n=>{n.preventDefault();let i=null;if(document.caretRangeFromPoint)i=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){const l=document.caretPositionFromPoint(n.clientX,n.clientY);i=document.createRange(),i.setStart(l.offsetNode,l.offset),i.setEnd(l.offsetNode,l.offset)}const a=i&&e.selection.normalizeNative(i);if(a){const l=e.selection.normalizedToRange(a);n.dataTransfer?.files&&this.upload(l,n.dataTransfer.files)}})}upload(e,r){const n=[];Array.from(r).forEach(i=>{i&&this.options.mimetypes?.includes(i.type)&&n.push(i)}),n.length>0&&this.options.handler.call(this,e,n)}}d9.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(t,e){if(!this.quill.scroll.query("image"))return;const r=e.map(n=>new Promise(i=>{const a=new FileReader;a.onload=()=>{i(a.result)},a.readAsDataURL(n)}));Promise.all(r).then(n=>{const i=n.reduce((a,l)=>a.insert({image:l}),new dt().retain(t.index).delete(t.length));this.quill.updateContents(i,lt.sources.USER),this.quill.setSelection(t.index+n.length,lt.sources.SILENT)})}};const _ie=["insertText","insertReplacementText"];class Cie extends lo{constructor(e,r){super(e,r),e.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||e.on($e.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){Q4({range:e,quill:this.quill})}replaceText(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(r){const n=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new dt().retain(e.index).insert(r,n),$e.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+r.length,0,$e.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!_ie.includes(e.inputType))return;const r=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!r||r.collapsed===!0)return;const n=Eie(e);if(n==null)return;const i=this.quill.selection.normalizeNative(r),a=i?this.quill.selection.normalizedToRange(i):null;a&&this.replaceText(a,n)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function Eie(t){return typeof t.data=="string"?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null}const Aie=/Mac/i.test(navigator.platform),Tie=100,Oie=t=>!!(t.key==="ArrowLeft"||t.key==="ArrowRight"||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="Home"||Aie&&t.key==="a"&&t.ctrlKey===!0);class Mie extends lo{isListening=!1;selectionChangeDeadline=0;constructor(e,r){super(e,r),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,r){let{line:n,event:i}=r;if(!(n instanceof ja)||!n.uiNode)return!0;const a=getComputedStyle(n.domNode).direction==="rtl";return a&&i.key!=="ArrowRight"||!a&&i.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(i.shiftKey?1:0),$e.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&Oie(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+Tie,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const r=e.getRangeAt(0);if(r.collapsed!==!0||r.startOffset!==0)return;const n=this.quill.scroll.find(r.startContainer);if(!(n instanceof ja)||!n.uiNode)return;const i=document.createRange();i.setStartAfter(n.uiNode),i.setEndAfter(n.uiNode),e.removeAllRanges(),e.addRange(i)}}$e.register({"blots/block":ns,"blots/block/embed":Fi,"blots/break":Aa,"blots/container":Md,"blots/cursor":ly,"blots/embed":G4,"blots/inline":ks,"blots/scroll":$se,"blots/text":ka,"modules/clipboard":uie,"modules/history":Nie,"modules/keyboard":cy,"modules/uploader":d9,"modules/input":Cie,"modules/uiNode":Mie});class Lie extends Ea{add(e,r){let n=0;if(r==="+1"||r==="-1"){const i=this.value(e)||0;n=r==="+1"?i+1:i-1}else typeof r=="number"&&(n=r);return n===0?(this.remove(e),!0):super.add(e,n.toString())}canAdd(e,r){return super.canAdd(e,r)||super.canAdd(e,parseInt(r,10))}value(e){return parseInt(super.value(e),10)||void 0}}const Rie=new Lie("indent","ql-indent",{scope:ht.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class Pie extends ns{static blotName="blockquote";static tagName="blockquote"}class Iie extends ns{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}class I0 extends Md{}I0.blotName="list-container";I0.tagName="OL";class D0 extends ns{static create(e){const r=super.create();return r.setAttribute("data-list",e),r}static formats(e){return e.getAttribute("data-list")||void 0}static register(){$e.register(I0)}constructor(e,r){super(e,r);const n=r.ownerDocument.createElement("span"),i=a=>{if(!e.isEnabled())return;const l=this.statics.formats(r,e);l==="checked"?(this.format("list","unchecked"),a.preventDefault()):l==="unchecked"&&(this.format("list","checked"),a.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-list",r):super.format(e,r)}}D0.blotName="list";D0.tagName="LI";I0.allowedChildren=[D0];D0.requiredContainer=I0;class e5 extends ks{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class Die extends e5{static blotName="italic";static tagName=["EM","I"]}class Qg extends ks{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const r=super.create(e);return r.setAttribute("href",this.sanitize(e)),r.setAttribute("rel","noopener noreferrer"),r.setAttribute("target","_blank"),r}static formats(e){return e.getAttribute("href")}static sanitize(e){return u9(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,r){e!==this.statics.blotName||!r?super.format(e,r):this.domNode.setAttribute("href",this.constructor.sanitize(r))}}function u9(t,e){const r=document.createElement("a");r.href=t;const n=r.href.slice(0,r.href.indexOf(":"));return e.indexOf(n)>-1}class Bie extends ks{static blotName="script";static tagName=["SUB","SUP"];static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}class $ie extends e5{static blotName="strike";static tagName=["S","STRIKE"]}class Uie extends ks{static blotName="underline";static tagName="U"}class zie extends G4{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const r=super.create(e);return typeof e=="string"&&(window.katex.render(e,r,{throwOnError:!1,errorColor:"#f00"}),r.setAttribute("data-value",e)),r}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const D6=["alt","height","width"];let qie=class extends bi{static blotName="image";static tagName="IMG";static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("src",this.sanitize(e)),r}static formats(e){return D6.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return u9(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,r){D6.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}};const B6=["height","width"];class Fie extends Fi{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const r=super.create(e);return r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),r.setAttribute("src",this.sanitize(e)),r}static formats(e){return B6.reduce((r,n)=>(e.hasAttribute(n)&&(r[n]=e.getAttribute(n)),r),{})}static sanitize(e){return Qg.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,r){B6.indexOf(e)>-1?r?this.domNode.setAttribute(e,r):this.domNode.removeAttribute(e):super.format(e,r)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const Tf=new Ea("code-token","hljs",{scope:ht.INLINE});class Qo extends ks{static formats(e,r){for(;e!=null&&e!==r.domNode;){if(e.classList&&e.classList.contains(Es.className))return super.formats(e,r);e=e.parentNode}}constructor(e,r,n){super(e,r,n),Tf.add(this.domNode,n)}format(e,r){e!==Qo.blotName?super.format(e,r):r?Tf.add(this.domNode,r):(Tf.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Tf.value(this.domNode)||this.unwrap()}}Qo.blotName="code-token";Qo.className="ql-token";class qi extends Es{static create(e){const r=super.create(e);return typeof e=="string"&&r.setAttribute("data-language",e),r}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,r){e===this.statics.blotName&&r?this.domNode.setAttribute("data-language",r):super.format(e,r)}replaceWith(e,r){return this.formatAt(0,this.length(),Qo.blotName,!1),super.replaceWith(e,r)}}class Uf extends Ld{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,r){e===qi.blotName&&(this.forceNext=!0,this.children.forEach(n=>{n.format(e,r)}))}formatAt(e,r,n,i){n===qi.blotName&&(this.forceNext=!0),super.formatAt(e,r,n,i)}highlight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const i=`${Array.from(this.domNode.childNodes).filter(l=>l!==this.uiNode).map(l=>l.textContent).join(`
`)}
`,a=qi.formats(this.children.head.domNode);if(r||this.forceNext||this.cachedText!==i){if(i.trim().length>0||this.cachedText==null){const l=this.children.reduce((u,h)=>u.concat(YI(h,!1)),new dt),d=e(i,a);l.diff(d).reduce((u,h)=>{let{retain:p,attributes:m}=h;return p?(m&&Object.keys(m).forEach(x=>{[qi.blotName,Qo.blotName].includes(x)&&this.formatAt(u,p,x,m[x])}),u+p):u},0)}this.cachedText=i,this.forceNext=!1}}html(e,r){const[n]=this.children.find(e);return`<pre data-language="${n?qi.formats(n.domNode):"plain"}">
${oy(this.code(e,r))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const r=qi.formats(this.children.head.domNode);r!==this.uiNode.value&&(this.uiNode.value=r)}}}Uf.allowedChildren=[qi];qi.requiredContainer=Uf;qi.allowedChildren=[Qo,ly,ka,Aa];const Hie=(t,e,r)=>{if(typeof t.versionString=="string"){const n=t.versionString.split(".")[0];if(parseInt(n,10)>=11)return t.highlight(r,{language:e}).value}return t.highlight(e,r).value};class h9 extends lo{static register(){$e.register(Qo,!0),$e.register(qi,!0),$e.register(Uf,!0)}constructor(e,r){if(super(e,r),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((n,i)=>{let{key:a}=i;return n[a]=!0,n},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on($e.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof Uf))return;const r=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(n=>{let{key:i,label:a}=n;const l=r.ownerDocument.createElement("option");l.textContent=a,l.setAttribute("value",i),r.appendChild(l)}),r.addEventListener("change",()=>{e.format(qi.blotName,r.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(r),e.children.head&&(r.value=qi.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on($e.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update($e.sources.USER);const n=this.quill.getSelection();(e==null?this.quill.scroll.descendants(Uf):[e]).forEach(a=>{a.highlight(this.highlightBlot,r)}),this.quill.update($e.sources.SILENT),n!=null&&this.quill.setSelection(n,$e.sources.SILENT)}highlightBlot(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(r=this.languages[r]?r:"plain",r==="plain")return oy(e).split(`
`).reduce((i,a,l)=>(l!==0&&i.insert(`
`,{[Es.blotName]:r}),i.insert(a)),new dt);const n=this.quill.root.ownerDocument.createElement("div");return n.classList.add(Es.className),n.innerHTML=Hie(this.options.hljs,r,e),Z4(this.quill.scroll,n,[(i,a)=>{const l=Tf.value(i);return l?a.compose(new dt().retain(a.length(),{[Qo.blotName]:l})):a}],[(i,a)=>i.data.split(`
`).reduce((l,d,u)=>(u!==0&&l.insert(`
`,{[Es.blotName]:r}),l.insert(d)),a)],new WeakMap)}}h9.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class pa extends ns{static blotName="table";static tagName="TD";static create(e){const r=super.create();return e?r.setAttribute("data-row",e):r.setAttribute("data-row",t5()),r}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,r){e===pa.blotName&&r?this.domNode.setAttribute("data-row",r):super.format(e,r)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class xd extends Md{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),r=this.children.tail.formats(),n=this.next.children.head.formats(),i=this.next.children.tail.formats();return e.table===r.table&&e.table===n.table&&e.table===i.table}return!1}optimize(e){super.optimize(e),this.children.forEach(r=>{if(r.next==null)return;const n=r.formats(),i=r.next.formats();if(n.table!==i.table){const a=this.splitAfter(r);a&&a.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class uc extends Md{static blotName="table-body";static tagName="TBODY"}class Zg extends Md{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(xd),r=e.reduce((n,i)=>Math.max(i.children.length,n),0);e.forEach(n=>{new Array(r-n.children.length).fill(0).forEach(()=>{let i;n.children.head!=null&&(i=pa.formats(n.children.head.domNode));const a=this.scroll.create(pa.blotName,i);n.appendChild(a),a.optimize()})})}cells(e){return this.rows().map(r=>r.children.at(e))}deleteColumn(e){const[r]=this.descendant(uc);r==null||r.children.head==null||r.children.forEach(n=>{const i=n.children.at(e);i?.remove()})}insertColumn(e){const[r]=this.descendant(uc);r==null||r.children.head==null||r.children.forEach(n=>{const i=n.children.at(e),a=pa.formats(n.children.head.domNode),l=this.scroll.create(pa.blotName,a);n.insertBefore(l,i)})}insertRow(e){const[r]=this.descendant(uc);if(r==null||r.children.head==null)return;const n=t5(),i=this.scroll.create(xd.blotName);r.children.head.children.forEach(()=>{const l=this.scroll.create(pa.blotName,n);i.appendChild(l)});const a=r.children.at(e);r.insertBefore(i,a)}rows(){const e=this.children.head;return e==null?[]:e.children.map(r=>r)}}Zg.allowedChildren=[uc];uc.requiredContainer=Zg;uc.allowedChildren=[xd];xd.requiredContainer=uc;xd.allowedChildren=[pa];pa.requiredContainer=xd;function t5(){return`row-${Math.random().toString(36).slice(2,6)}`}class Wie extends lo{static register(){$e.register(pa),$e.register(xd),$e.register(uc),$e.register(Zg)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(Zg).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,r]=this.getTable();r!=null&&(e.deleteColumn(r.cellOffset()),this.quill.update($e.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update($e.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const r=e.offset();e.remove(),this.quill.update($e.sources.USER),this.quill.setSelection(r,$e.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[r,n]=this.quill.getLine(e.index);if(r==null||r.statics.blotName!==pa.blotName)return[null,null,null,-1];const i=r.parent;return[i.parent.parent,i,r,n]}insertColumn(e){const r=this.quill.getSelection();if(!r)return;const[n,i,a]=this.getTable(r);if(a==null)return;const l=a.cellOffset();n.insertColumn(l+e),this.quill.update($e.sources.USER);let d=i.rowOffset();e===0&&(d+=1),this.quill.setSelection(r.index+d,r.length,$e.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const r=this.quill.getSelection();if(!r)return;const[n,i,a]=this.getTable(r);if(a==null)return;const l=i.rowOffset();n.insertRow(l+e),this.quill.update($e.sources.USER),e>0?this.quill.setSelection(r,$e.sources.SILENT):this.quill.setSelection(r.index+i.children.length,r.length,$e.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,r){const n=this.quill.getSelection();if(n==null)return;const i=new Array(e).fill(0).reduce(a=>{const l=new Array(r).fill(`
`).join("");return a.insert(l,{table:t5()})},new dt().retain(n.index));this.quill.updateContents(i,$e.sources.USER),this.quill.setSelection(n.index,$e.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on($e.events.SCROLL_OPTIMIZE,e=>{e.some(r=>["TD","TR","TBODY","TABLE"].includes(r.target.tagName)?(this.quill.once($e.events.TEXT_CHANGE,(n,i,a)=>{a===$e.sources.USER&&this.balanceTables()}),!0):!1)})}}const $6=hl("quill:toolbar");class r5 extends lo{constructor(e,r){if(super(e,r),Array.isArray(this.options.container)){const n=document.createElement("div");n.setAttribute("role","toolbar"),Gie(n,this.options.container),e.container?.parentNode?.insertBefore(n,e.container),this.container=n}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){$6.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(n=>{const i=this.options.handlers?.[n];i&&this.addHandler(n,i)}),Array.from(this.container.querySelectorAll("button, select")).forEach(n=>{this.attach(n)}),this.quill.on($e.events.EDITOR_CHANGE,()=>{const[n]=this.quill.selection.getRange();this.update(n)})}addHandler(e,r){this.handlers[e]=r}attach(e){let r=Array.from(e.classList).find(i=>i.indexOf("ql-")===0);if(!r)return;if(r=r.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[r]==null&&this.quill.scroll.query(r)==null){$6.warn("ignoring attaching to nonexistent format",r,e);return}const n=e.tagName==="SELECT"?"change":"click";e.addEventListener(n,i=>{let a;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const d=e.options[e.selectedIndex];d.hasAttribute("selected")?a=!1:a=d.value||!1}else e.classList.contains("ql-active")?a=!1:a=e.value||!e.hasAttribute("value"),i.preventDefault();this.quill.focus();const[l]=this.quill.selection.getRange();if(this.handlers[r]!=null)this.handlers[r].call(this,a);else if(this.quill.scroll.query(r).prototype instanceof bi){if(a=prompt(`Enter ${r}`),!a)return;this.quill.updateContents(new dt().retain(l.index).delete(l.length).insert({[r]:a}),$e.sources.USER)}else this.quill.format(r,a,$e.sources.USER);this.update(l)}),this.controls.push([r,e])}update(e){const r=e==null?{}:this.quill.getFormat(e);this.controls.forEach(n=>{const[i,a]=n;if(a.tagName==="SELECT"){let l=null;if(e==null)l=null;else if(r[i]==null)l=a.querySelector("option[selected]");else if(!Array.isArray(r[i])){let d=r[i];typeof d=="string"&&(d=d.replace(/"/g,'\\"')),l=a.querySelector(`option[value="${d}"]`)}l==null?(a.value="",a.selectedIndex=-1):l.selected=!0}else if(e==null)a.classList.remove("ql-active"),a.setAttribute("aria-pressed","false");else if(a.hasAttribute("value")){const l=r[i],d=l===a.getAttribute("value")||l!=null&&l.toString()===a.getAttribute("value")||l==null&&!a.getAttribute("value");a.classList.toggle("ql-active",d),a.setAttribute("aria-pressed",d.toString())}else{const l=r[i]!=null;a.classList.toggle("ql-active",l),a.setAttribute("aria-pressed",l.toString())}})}}r5.DEFAULTS={};function U6(t,e,r){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${e}`),n.setAttribute("aria-pressed","false"),r!=null?(n.value=r,n.setAttribute("aria-label",`${e}: ${r}`)):n.setAttribute("aria-label",e),t.appendChild(n)}function Gie(t,e){Array.isArray(e[0])||(e=[e]),e.forEach(r=>{const n=document.createElement("span");n.classList.add("ql-formats"),r.forEach(i=>{if(typeof i=="string")U6(n,i);else{const a=Object.keys(i)[0],l=i[a];Array.isArray(l)?Vie(n,a,l):U6(n,a,l)}}),t.appendChild(n)})}function Vie(t,e,r){const n=document.createElement("select");n.classList.add(`ql-${e}`),r.forEach(i=>{const a=document.createElement("option");i!==!1?a.setAttribute("value",String(i)):a.setAttribute("selected","selected"),n.appendChild(a)}),t.appendChild(n)}r5.DEFAULTS={container:null,handlers:{clean(){const t=this.quill.getSelection();if(t!=null)if(t.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(r=>{this.quill.scroll.query(r,ht.INLINE)!=null&&this.quill.format(r,!1,$e.sources.USER)})}else this.quill.removeFormat(t.index,t.length,$e.sources.USER)},direction(t){const{align:e}=this.quill.getFormat();t==="rtl"&&e==null?this.quill.format("align","right",$e.sources.USER):!t&&e==="right"&&this.quill.format("align",!1,$e.sources.USER),this.quill.format("direction",t,$e.sources.USER)},indent(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e),n=parseInt(r.indent||0,10);if(t==="+1"||t==="-1"){let i=t==="+1"?1:-1;r.direction==="rtl"&&(i*=-1),this.quill.format("indent",n+i,$e.sources.USER)}},link(t){t===!0&&(t=prompt("Enter link URL:")),this.quill.format("link",t,$e.sources.USER)},list(t){const e=this.quill.getSelection(),r=this.quill.getFormat(e);t==="check"?r.list==="checked"||r.list==="unchecked"?this.quill.format("list",!1,$e.sources.USER):this.quill.format("list","unchecked",$e.sources.USER):this.quill.format("list",t,$e.sources.USER)}}};const Kie='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',Yie='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',Xie='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',Jie='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',Qie='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',Zie='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',eae='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',tae='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',z6='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',rae='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',nae='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',sae='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',iae='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',aae='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',oae='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',lae='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',cae='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',dae='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',uae='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',hae='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',fae='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',pae='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',mae='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',gae='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',xae='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',yae='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',bae='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',vae='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',wae='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',jae='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',Nae='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',kae='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',Sae='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',n0={align:{"":Kie,center:Yie,right:Xie,justify:Jie},background:Qie,blockquote:Zie,bold:eae,clean:tae,code:z6,"code-block":z6,color:rae,direction:{"":nae,rtl:sae},formula:iae,header:{1:aae,2:oae,3:lae,4:cae,5:dae,6:uae},italic:hae,image:fae,indent:{"+1":pae,"-1":mae},link:gae,list:{bullet:xae,check:yae,ordered:bae},script:{sub:vae,super:wae},strike:jae,table:Nae,underline:kae,video:Sae},_ae='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let q6=0;function F6(t,e){t.setAttribute(e,`${t.getAttribute(e)!=="true"}`)}class dy{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",r=>{switch(r.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),r.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),F6(this.label,"aria-expanded"),F6(this.options,"aria-hidden")}buildItem(e){const r=document.createElement("span");r.tabIndex="0",r.setAttribute("role","button"),r.classList.add("ql-picker-item");const n=e.getAttribute("value");return n&&r.setAttribute("data-value",n),e.textContent&&r.setAttribute("data-label",e.textContent),r.addEventListener("click",()=>{this.selectItem(r,!0)}),r.addEventListener("keydown",i=>{switch(i.key){case"Enter":this.selectItem(r,!0),i.preventDefault();break;case"Escape":this.escape(),i.preventDefault();break}}),r}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=_ae,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${q6}`,q6+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(r=>{const n=this.buildItem(r);e.appendChild(n),r.selected===!0&&this.selectItem(n)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.container.querySelector(".ql-selected");e!==n&&(n?.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),r&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const n=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(n)}else this.selectItem(null);const r=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",r)}}class f9 extends dy{constructor(e,r){super(e),this.label.innerHTML=r,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(n=>{n.classList.add("ql-primary")})}buildItem(e){const r=super.buildItem(e);return r.style.backgroundColor=e.getAttribute("value")||"",r}selectItem(e,r){super.selectItem(e,r);const n=this.label.querySelector(".ql-color-label"),i=e&&e.getAttribute("data-value")||"";n&&(n.tagName==="line"?n.style.stroke=i:n.style.fill=i)}}class p9 extends dy{constructor(e,r){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(n=>{n.innerHTML=r[n.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,r){super.selectItem(e,r);const n=e||this.defaultItem;if(n!=null){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}}const Cae=t=>{const{overflowY:e}=getComputedStyle(t,null);return e!=="visible"&&e!=="clip"};let m9=class{constructor(e,r){this.quill=e,this.boundsContainer=r||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Cae(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const r=e.left+e.width/2-this.root.offsetWidth/2,n=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${r}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),a=this.root.getBoundingClientRect();let l=0;if(a.right>i.right&&(l=i.right-a.right,this.root.style.left=`${r+l}px`),a.left<i.left&&(l=i.left-a.left,this.root.style.left=`${r+l}px`),a.bottom>i.bottom){const d=a.bottom-a.top,u=e.bottom-e.top+d;this.root.style.top=`${n-u}px`,this.root.classList.add("ql-flip")}return l}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}};const Eae=[!1,"center","right","justify"],Aae=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Tae=[!1,"serif","monospace"],Oae=["1","2","3",!1],Mae=["small",!1,"large","huge"];class B0 extends uh{constructor(e,r){super(e,r);const n=i=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",n);return}this.tooltip!=null&&!this.tooltip.root.contains(i.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(a=>{a.container.contains(i.target)||a.close()})};e.emitter.listenDOM("click",document.body,n)}addModule(e){const r=super.addModule(e);return e==="toolbar"&&this.extendToolbar(r),r}buildButtons(e,r){Array.from(e).forEach(n=>{(n.getAttribute("class")||"").split(/\s+/).forEach(a=>{if(a.startsWith("ql-")&&(a=a.slice(3),r[a]!=null))if(a==="direction")n.innerHTML=r[a][""]+r[a].rtl;else if(typeof r[a]=="string")n.innerHTML=r[a];else{const l=n.value||"";l!=null&&r[a][l]&&(n.innerHTML=r[a][l])}})})}buildPickers(e,r){this.pickers=Array.from(e).map(i=>{if(i.classList.contains("ql-align")&&(i.querySelector("option")==null&&ff(i,Eae),typeof r.align=="object"))return new p9(i,r.align);if(i.classList.contains("ql-background")||i.classList.contains("ql-color")){const a=i.classList.contains("ql-background")?"background":"color";return i.querySelector("option")==null&&ff(i,Aae,a==="background"?"#ffffff":"#000000"),new f9(i,r[a])}return i.querySelector("option")==null&&(i.classList.contains("ql-font")?ff(i,Tae):i.classList.contains("ql-header")?ff(i,Oae):i.classList.contains("ql-size")&&ff(i,Mae)),new dy(i)});const n=()=>{this.pickers.forEach(i=>{i.update()})};this.quill.on(lt.events.EDITOR_CHANGE,n)}}B0.DEFAULTS=dc({},uh.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let t=this.container.querySelector("input.ql-image[type=file]");t==null&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),t.classList.add("ql-image"),t.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,t.files),t.value=""}),this.container.appendChild(t)),t.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class g9 extends m9{constructor(e,r){super(e,r),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;r!=null?this.textbox.value=r:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);n!=null&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:r}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,lt.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,lt.sources.USER)),this.quill.root.scrollTop=r;break}case"video":e=Lae(e);case"formula":{if(!e)break;const r=this.quill.getSelection(!0);if(r!=null){const n=r.index+r.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),e,lt.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(n+1," ",lt.sources.USER),this.quill.setSelection(n+2,lt.sources.USER)}break}}this.textbox.value="",this.hide()}}function Lae(t){let e=t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:t}function ff(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(n=>{const i=document.createElement("option");n===r?i.setAttribute("selected","selected"):i.setAttribute("value",String(n)),t.appendChild(i)})}const Rae=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class Pae extends g9{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,r){super(e,r),this.quill.on(lt.events.EDITOR_CHANGE,(n,i,a,l)=>{if(n===lt.events.SELECTION_CHANGE)if(i!=null&&i.length>0&&l===lt.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const d=this.quill.getLines(i.index,i.length);if(d.length===1){const u=this.quill.getBounds(i);u!=null&&this.position(u)}else{const u=d[d.length-1],h=this.quill.getIndex(u),p=Math.min(u.length()-1,i.index+i.length-h),m=this.quill.getBounds(new gd(h,p));m!=null&&this.position(m)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(lt.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const r=this.quill.getBounds(e);r!=null&&this.position(r)}},1)})}cancel(){this.show()}position(e){const r=super.position(e),n=this.root.querySelector(".ql-tooltip-arrow");return n.style.marginLeft="",r!==0&&(n.style.marginLeft=`${-1*r-n.offsetWidth/2}px`),r}}class x9 extends B0{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=Rae),super(e,r),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new Pae(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),n0),this.buildPickers(e.container.querySelectorAll("select"),n0))}}x9.DEFAULTS=dc({},B0.DEFAULTS,{modules:{toolbar:{handlers:{link(t){t?this.quill.theme.tooltip.edit():this.quill.format("link",!1,$e.sources.USER)}}}}});const Iae=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class Dae extends g9{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const r=this.linkRange;this.restoreFocus(),this.quill.formatText(r,"link",!1,lt.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(lt.events.SELECTION_CHANGE,(e,r,n)=>{if(e!=null){if(e.length===0&&n===lt.sources.USER){const[i,a]=this.quill.scroll.descendant(Qg,e.index);if(i!=null){this.linkRange=new gd(e.index-a,i.length());const l=Qg.formats(i.domNode);this.preview.textContent=l,this.preview.setAttribute("href",l),this.show();const d=this.quill.getBounds(this.linkRange);d!=null&&this.position(d);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class y9 extends B0{constructor(e,r){r.modules.toolbar!=null&&r.modules.toolbar.container==null&&(r.modules.toolbar.container=Iae),super(e,r),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),n0),this.buildPickers(e.container.querySelectorAll("select"),n0),this.tooltip=new Dae(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(r,n)=>{e.handlers.link.call(e,!n.format.link)}))}}y9.DEFAULTS=dc({},B0.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const e=this.quill.getSelection();if(e==null||e.length===0)return;let r=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(r)&&r.indexOf("mailto:")!==0&&(r=`mailto:${r}`);const{tooltip:n}=this.quill.theme;n.edit("link",r)}else this.quill.format("link",!1,$e.sources.USER)}}}}});$e.register({"attributors/attribute/direction":t9,"attributors/class/align":QI,"attributors/class/background":qse,"attributors/class/color":zse,"attributors/class/direction":r9,"attributors/class/font":i9,"attributors/class/size":o9,"attributors/style/align":ZI,"attributors/style/background":Y4,"attributors/style/color":K4,"attributors/style/direction":n9,"attributors/style/font":a9,"attributors/style/size":l9},!0);$e.register({"formats/align":QI,"formats/direction":r9,"formats/indent":Rie,"formats/background":Y4,"formats/color":K4,"formats/font":i9,"formats/size":o9,"formats/blockquote":Pie,"formats/code-block":Es,"formats/header":Iie,"formats/list":D0,"formats/bold":e5,"formats/code":X4,"formats/italic":Die,"formats/link":Qg,"formats/script":Bie,"formats/strike":$ie,"formats/underline":Uie,"formats/formula":zie,"formats/image":qie,"formats/video":Fie,"modules/syntax":h9,"modules/table":Wie,"modules/toolbar":r5,"themes/bubble":x9,"themes/snow":y9,"ui/icons":n0,"ui/picker":dy,"ui/icon-picker":p9,"ui/color-picker":f9,"ui/tooltip":m9},!0);class uy extends Ge.Component{constructor(e){super(e),this.editingAreaRef=y.createRef(),this.containerRef=y.createRef(),this.dirtyProps=["modules","formats","bounds","theme","children"],this.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],this.state={generation:0},this.selection=null,this.onEditorChange=(n,i,a,l)=>{n==="text-change"?this.onEditorChangeText?.(this.editor.getSemanticHTML(),i,l,this.unprivilegedEditor):n==="selection-change"&&this.onEditorChangeSelection?.(i,l,this.unprivilegedEditor)};const r=this.isControlled()?e.value:e.defaultValue;this.value=r??""}validateProps(e){if(Ge.Children.count(e.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ge.Children.count(e.children)&&Ge.Children.only(e.children)?.type==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.");if(this.lastDeltaChangeSet&&e.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")}shouldComponentUpdate(e,r){if(this.validateProps(e),!this.editor||this.state.generation!==r.generation)return!0;if("value"in e){const n=this.getEditorContents(),i=e.value??"";this.isEqualValue(i,n)||this.setEditorContents(this.editor,i)}return e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,e.readOnly),[...this.cleanProps,...this.dirtyProps].some(n=>!tc(e[n],this.props[n]))}shouldComponentRegenerate(e){return this.dirtyProps.some(r=>!tc(e[r],this.props[r]))}componentDidMount(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())}componentWillUnmount(){this.destroyEditor()}componentDidUpdate(e,r){if(this.editor&&this.shouldComponentRegenerate(e)){const n=this.editor.getContents(),i=this.editor.getSelection();this.regenerationSnapshot={delta:n,selection:i},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.editor&&e.placeholder!==this.props.placeholder&&(this.editor.root.dataset.placeholder=this.props.placeholder||""),this.state.generation!==r.generation){const{delta:n,selection:i}=this.regenerationSnapshot;delete this.regenerationSnapshot,this.instantiateEditor();const a=this.editor;a.setContents(n),H6(()=>this.setEditorSelection(a,i))}}instantiateEditor(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())}destroyEditor(){if(!this.editor)return;this.unhookEditor(this.editor);const e=this.props.modules?.toolbar;if(!(typeof e=="object"&&e&&"container"in e&&typeof e.container=="string"||typeof e=="string")){const n=this.containerRef.current?.querySelector(".ql-toolbar");n&&n.remove()}delete this.editor}isControlled(){return"value"in this.props}getEditorConfig(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,theme:this.props.theme}}getEditor(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor}createEditor(e,r){const n=new $e(e,r);return r.tabIndex!=null&&this.setEditorTabIndex(n,r.tabIndex),this.hookEditor(n),n}hookEditor(e){this.unprivilegedEditor=this.makeUnprivilegedEditor(e),e.on("editor-change",this.onEditorChange)}unhookEditor(e){e.off("editor-change",this.onEditorChange)}getEditorContents(){return this.value}getEditorSelection(){return this.selection}isDelta(e){return e&&e.ops}isEqualValue(e,r){return this.isDelta(e)&&this.isDelta(r)?tc(e.ops,r.ops):tc(e,r)}setEditorContents(e,r){this.value=r;const n=this.getEditorSelection();typeof r=="string"?e.setContents(e.clipboard.convert({html:r})):e.setContents(r),H6(()=>this.setEditorSelection(e,n))}setEditorSelection(e,r){if(this.selection=r,r){const n=e.getLength();r.index=Math.max(0,Math.min(r.index,n-1)),r.length=Math.max(0,Math.min(r.length,n-1-r.index)),e.setSelection(r)}}setEditorTabIndex(e,r){e?.scroll?.domNode&&(e.scroll.domNode.tabIndex=r)}setEditorReadOnly(e,r){r?e.disable():e.enable()}makeUnprivilegedEditor(e){const r=e;return{getHTML:()=>r.root.innerHTML,getSemanticHTML:r.getSemanticHTML.bind(r),getLength:r.getLength.bind(r),getText:r.getText.bind(r),getContents:r.getContents.bind(r),getSelection:r.getSelection.bind(r),getBounds:r.getBounds.bind(r)}}getEditingArea(){const e=this.editingAreaRef.current;if(!e)throw new Error("Cannot find element for editing area");if(e.nodeType===3)throw new Error("Editing area cannot be a text node");return e}renderEditingArea(){const{children:e,preserveWhitespace:r}=this.props,{generation:n}=this.state,i={key:n,ref:this.editingAreaRef};return Ge.Children.count(e)?Ge.cloneElement(Ge.Children.only(e),i):r?Ge.createElement("pre",{...i}):Ge.createElement("div",{...i})}render(){return Ge.createElement("div",{ref:this.containerRef,id:this.props.id,style:this.props.style,key:this.state.generation,className:`quill ${this.props.className??""}`,onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())}onEditorChangeText(e,r,n,i){if(!this.editor)return;const a=this.isDelta(this.value)?i.getContents():i.getSemanticHTML();a!==this.getEditorContents()&&(this.lastDeltaChangeSet=r,this.value=a,this.props.onChange?.(e,r,n,i))}onEditorChangeSelection(e,r,n){if(!this.editor)return;const i=this.getEditorSelection(),a=!i&&e,l=i&&!e;tc(e,i)||(this.selection=e,this.props.onChangeSelection?.(e,r,n),a?this.props.onFocus?.(e,r,n):l&&this.props.onBlur?.(i,r,n))}focus(){this.editor&&this.editor.focus()}blur(){this.editor&&(this.selection=null,this.editor.blur())}}uy.displayName="React Quill";uy.Quill=$e;uy.defaultProps={theme:"snow",modules:{},readOnly:!1};function H6(t){Promise.resolve().then(t)}const Bae={toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["clean"]]},qj=({value:t,onChange:e,placeholder:r,type:n="General",height:i="h-40"})=>{const{userProfile:a}=Mt(),{addToast:l}=_r(),[d,u]=y.useState(!1),h=async()=>{const p=a?.settings?.geminiApiKey;if(!p){l("AI API Key missing in settings.","error");return}if(!t||t.replace(/<[^>]*>/g,"").trim().length<5){l("Please write a bit more first!","warning");return}u(!0);try{const m=await _s.spruceUpText(p,t,n);e(m),l("Spruced up successfully!","success")}catch(m){console.error(m),l("AI failed to enhance text.","error")}finally{u(!1)}};return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.jsxs("button",{type:"button",onClick:h,disabled:d,className:"flex items-center gap-1 text-[10px] uppercase font-bold tracking-wider bg-indigo-600/80 hover:bg-indigo-500 text-white px-3 py-1.5 rounded-full transition-all backdrop-blur-sm disabled:opacity-50 shadow-lg border border-indigo-400/30",title:"Spruce up with AI",children:[d?s.jsx("span",{className:"animate-spin h-3 w-3 border-2 border-white border-t-transparent rounded-full"}):s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"AI Polish"]})}),s.jsx("div",{className:`bg-gray-900 border border-gray-700 rounded-lg overflow-hidden ${i} flex flex-col`,children:s.jsx(uy,{theme:"snow",value:t||"",onChange:e,modules:Bae,placeholder:r,className:"flex-1 text-white flex flex-col h-full"})}),s.jsx("style",{children:`
                .quill { display: flex; flex-direction: column; height: 100%; overflow: hidden; }
                .ql-toolbar.ql-snow { border: none !important; border-bottom: 1px solid #374151 !important; background: #111827; flex-shrink: 0; }
                .ql-container.ql-snow { border: none !important; flex: 1; display: flex; flex-direction: column; overflow: hidden; background: transparent; }
                .ql-editor { color: #e5e7eb; flex: 1; overflow-y: auto; font-family: inherit; padding: 1rem; }
                .ql-editor.ql-blank::before { color: #6b7280; font-style: normal; font-style: italic; }
                
                /* Icon/Picker Colors */
                .ql-snow .ql-stroke { stroke: #9ca3af !important; }
                .ql-snow .ql-fill { fill: #9ca3af !important; }
                .ql-snow .ql-picker { color: #9ca3af !important; }
                .ql-snow .ql-picker-options { background-color: #1f2937 !important; border-color: #374151 !important; color: #e5e7eb !important; }
                .ql-snow .ql-picker-item:hover { color: #818cf8 !important; }
                .ql-snow .ql-picker-item.ql-selected { color: #6366f1 !important; }
            `})]})},$ae=({ticket:t,isAdmin:e,currentUserId:r,onEdit:n,onDelete:i,onVote:a,getTypeBadge:l,getStatusBadge:d})=>{const[u,h]=y.useState(!1),[p,m]=y.useState([]);return y.useEffect(()=>{u&&t.note_count>0&&p.length===0&&Pe.getTicketNotes(t.id).then(m).catch(console.error)},[u,t.note_count,t.id]),s.jsx("div",{className:"bg-gray-800/40 border border-white/5 rounded-lg p-4 hover:bg-gray-800/60 transition-colors group",children:s.jsxs("div",{className:"flex justify-between items-start gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1 flex-wrap",children:[l(t.type),s.jsx("h4",{className:"text-white font-medium hover:text-indigo-300 cursor-pointer truncate",onClick:()=>(e||t.created_by===r&&t.status==="open")&&n(t),children:t.title}),d(t.status),t.epic_title&&s.jsx("span",{className:"text-[10px] bg-indigo-500/10 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/20 whitespace-nowrap",children:t.epic_title})]}),s.jsx("div",{className:`text-sm text-gray-400 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-0 [&>ul]:list-none [&>ul]:pl-0 ${u?"":"line-clamp-2"}`,dangerouslySetInnerHTML:{__html:t.description||""}}),s.jsx("button",{onClick:x=>{x.stopPropagation(),h(!u)},className:"text-xs text-indigo-400 hover:text-indigo-300 mt-1 hover:underline focus:outline-none",children:u?"Show less":"Read more..."}),s.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-gray-500 flex-wrap",children:[s.jsxs("span",{children:["b/",t.created_by_username||"Unknown"]}),t.assigned_to&&s.jsxs("span",{className:"text-indigo-400",children:["Assigned: ",t.assigned_to_username]}),t.due_date&&s.jsxs("span",{children:["Due: ",ps(new Date(t.due_date),"MMM d")]}),t.estimated_release_date&&s.jsxs("span",{className:"text-orange-400",children:["Est. Release: ",ps(new Date(t.estimated_release_date),"MMM d")]}),t.date_released&&s.jsxs("span",{className:"text-green-400",children:["Released: ",ps(new Date(t.date_released),"MMM d")]}),t.note_count>0&&s.jsxs("span",{className:"flex items-center gap-1 text-gray-400 bg-gray-700/50 px-1.5 py-0.5 rounded",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),t.note_count," ",t.note_count===1?"Note":"Notes",t.last_note_at&&s.jsxs("span",{className:"opacity-70 ml-1",children:[" ",ps(new Date(t.last_note_at),"MMM d, h:mm a")]})]}),(e||t.created_by===r&&t.status==="open")&&s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>n(t),className:"hover:text-white transition-colors",children:["Edit ",e&&t.created_by!==r?"(Admin)":""]}),s.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this ticket?")&&i(t.id)},className:"text-gray-500 hover:text-red-400 transition-colors",children:"Delete"})]})]}),u&&p.length>0&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 space-y-2",children:[s.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase",children:"Latest Notes"}),p.map(x=>s.jsxs("div",{className:"bg-gray-900/30 p-2 rounded text-xs border border-white/5",children:[s.jsxs("div",{className:"flex justify-between text-gray-500 mb-0.5",children:[s.jsx("span",{className:"font-bold text-indigo-400",children:x.username}),s.jsx("span",{children:ps(new Date(x.created_at),"MMM d, h:mm a")})]}),s.jsx("p",{className:"text-gray-300 mb-0",children:x.note})]},x.id))]})]}),s.jsxs("div",{className:"flex flex-col items-center gap-1 pl-4 border-l border-white/5 shrink-0",children:[s.jsx("button",{onClick:()=>a(t.id),className:"text-gray-400 hover:text-indigo-400",children:""}),s.jsx("span",{className:"font-mono text-sm font-bold text-white",children:t.votes})]})]})})},Uae=({isOpen:t,onClose:e})=>{const{user:r,userProfile:n}=Mt(),[i,a]=y.useState("issues"),[l,d]=y.useState([]),[u,h]=y.useState([]),[p,m]=y.useState(!1),[x,b]=y.useState(""),[v,w]=y.useState(""),[k,_]=y.useState({title:"",description:"",type:"bug",epic_id:""}),[T,A]=y.useState(null),[I,O]=y.useState([]),[M,E]=y.useState([]),[R,$]=y.useState(""),C=r?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||n?.settings?.isAdmin||n?.settings?.permissions?.includes("manage_tickets");y.useEffect(()=>{t&&U()},[t,i]),y.useEffect(()=>{C&&t&&(async()=>{try{const F=await Pe.getAssignees();O(F)}catch(F){console.error(F)}})()},[C,t]),y.useEffect(()=>{T?(async()=>{try{const F=await Pe.getTicketNotes(T.id);E(F)}catch(F){console.error(F)}})():(E([]),$(""))},[T]);const U=async()=>{m(!0);try{if(i==="issues"){const G={};x&&(G.status=x),v&&(G.type=v);const F=await Pe.getTickets(G);d(F)}else if(i==="projects"||i==="new_ticket"){const G=await Pe.getEpics();h(G)}}catch(G){console.error("Failed to load data",G)}finally{m(!1)}},L=async G=>{G.preventDefault();try{await Pe.createTicket(k),_({title:"",description:"",type:"bug",epic_id:""}),a("issues"),U()}catch(F){alert("Failed to create ticket: "+F.message)}},q=async G=>{try{await Pe.voteTicket(G),d(l.map(F=>F.id===G?{...F,votes:(F.votes||0)+1}:F))}catch(F){console.error(F)}},K=async G=>{try{await Pe.deleteTicket(G),d(l.filter(F=>F.id!==G))}catch(F){console.error("Delete error:",F),alert("Failed to delete ticket: "+F.message)}},W=async G=>{if(G.preventDefault(),!!T)try{await Pe.updateTicket(T.id,T),A(null),U()}catch(F){alert("Update failed: "+F.message)}},V=async G=>{if(G.preventDefault(),!!R.trim())try{const F=await Pe.addTicketNote(T.id,R);E([...M,F]),$("")}catch(F){alert("Failed to add note: "+F.message)}},X=G=>{const F={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},Y={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Complete - Pending Release",complete_scheduled:"Complete - Release Scheduled",complete_blocked:"Complete - Waiting on Epic",wont_fix:"Won't Fix"};return s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold border ${F[G]||F.open} uppercase tracking-wider whitespace-nowrap`,children:Y[G]||(G||"open").replace(/_/g," ")})},Z=G=>G==="bug"?s.jsx("span",{className:"text-red-400 font-mono text-xs",children:"[BUG]"}):s.jsx("span",{className:"text-cyan-400 font-mono text-xs",children:"[FEAT]"});return t?s.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto",role:"dialog","aria-modal":"true",children:[s.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-900/80 backdrop-blur-sm transition-opacity",onClick:e}),s.jsxs("div",{className:"relative z-50 inline-block align-bottom bg-gray-900 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full border border-white/10",children:[s.jsxs("div",{className:"bg-gray-800/50 px-6 py-4 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""})," System Status & Feedback"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("a",{href:"https://discord.gg/p4ybr8h6QV",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 text-sm font-medium flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"bg-gray-800/30 px-6 border-b border-white/5 flex gap-6 overflow-x-auto",children:["issues","projects","new_ticket"].map(G=>s.jsxs("button",{onClick:()=>a(G),className:`py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${i===G?"border-indigo-500 text-white":"border-transparent text-gray-400 hover:text-gray-300"}`,children:[G==="issues"&&"Board & Issues",G==="projects"&&"Projects (Epics)",G==="new_ticket"&&"Review / Submit Issue"]},G))}),s.jsxs("div",{className:"p-6 min-h-[400px] max-h-[70vh] overflow-y-auto bg-gray-900",children:[i==="issues"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex gap-4 mb-4",children:[s.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:x,onChange:G=>b(G.target.value),children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"})]}),s.jsxs("select",{className:"bg-gray-800 border border-white/10 rounded px-3 py-1 text-sm text-gray-300",value:v,onChange:G=>w(G.target.value),children:[s.jsx("option",{value:"",children:"All Types"}),s.jsx("option",{value:"bug",children:"Bugs"}),s.jsx("option",{value:"feature",children:"Features"})]}),s.jsx("button",{onClick:U,className:"text-xs text-indigo-400 hover:text-indigo-300 underline",children:"Refresh"})]}),p?s.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading issues..."}):l.length===0?s.jsxs("div",{className:"text-center py-12 text-gray-500 border border-dashed border-white/10 rounded-xl",children:["No tickets found. ",s.jsx("button",{onClick:()=>a("new_ticket"),className:"text-indigo-400 hover:underline",children:"Create one?"})]}):s.jsx("div",{className:"space-y-3",children:l.map(G=>s.jsx($ae,{ticket:G,isAdmin:C,currentUserId:n?.id,onEdit:A,onDelete:K,onVote:q,getTypeBadge:Z,getStatusBadge:X},G.id))})]}),i==="projects"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"Large scale projects and goals for the platform."}),u.map(G=>s.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h4",{className:"text-lg font-bold text-white",children:G.title}),s.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-700 text-gray-300",children:G.status})]}),s.jsx("div",{className:"text-gray-400 text-sm mt-2 prose prose-invert prose-sm max-w-none w-full break-words [&>p]:mb-2 [&>ul]:list-disc [&>ul]:pl-4",dangerouslySetInnerHTML:{__html:G.description||""}}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 text-xs text-gray-500",children:[G.ticket_count||0," Tickets linked"]})]},G.id)),u.length===0&&s.jsx("div",{className:"text-gray-500 text-center py-8",children:"No active projects. Admins can create them via API for now."})]}),i==="new_ticket"&&s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs("form",{onSubmit:L,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Issue Type"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${k.type==="bug"?"bg-red-500/10 border-red-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("input",{type:"radio",className:"hidden",value:"bug",checked:k.type==="bug",onChange:G=>_({...k,type:G.target.value})}),s.jsx("div",{className:"font-bold mb-1",children:"Bug Report"}),s.jsx("div",{className:"text-xs opacity-70",children:"Something is broken"})]}),s.jsxs("label",{className:`flex-1 cursor-pointer p-4 rounded-xl border ${k.type==="feature"?"bg-indigo-500/10 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700"}`,children:[s.jsx("input",{type:"radio",className:"hidden",value:"feature",checked:k.type==="feature",onChange:G=>_({...k,type:G.target.value})}),s.jsx("div",{className:"font-bold mb-1",children:"Feature Request"}),s.jsx("div",{className:"text-xs opacity-70",children:"New idea or improvement"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),s.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",placeholder:"Short summary of the issue...",value:k.title,onChange:G=>_({...k,title:G.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),s.jsx("div",{className:"h-64",children:s.jsx(qj,{value:k.description,onChange:G=>_({...k,description:G}),placeholder:"Detailed description, steps to reproduce, or link to screenshots...",type:"Ticket",height:"h-56"})})]}),u.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Project (Optional)"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:k.epic_id,onChange:G=>_({...k,epic_id:G.target.value}),children:[s.jsx("option",{value:"",children:"- None -"}),u.map(G=>s.jsx("option",{value:G.id,children:G.title},G.id))]})]}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg shadow-lg hover:shadow-indigo-500/25 transition-all",children:"Submit Issue"})})]})})]})]})]}),T&&s.jsx("div",{className:"absolute inset-0 z-[110] flex items-center justify-center p-4 bg-black/70 backdrop-blur-md",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl max-w-3xl w-full p-8 border border-white/10 shadow-3xl overflow-y-auto max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-2xl font-black text-white italic uppercase tracking-tight",children:C?"Edit Ticket (Admin)":"Edit Your Ticket"}),s.jsx("button",{onClick:()=>A(null),className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("form",{onSubmit:W,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Issue Type"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:T.type,onChange:G=>A({...T,type:G.target.value}),children:[s.jsx("option",{value:"bug",children:"Bug Report"}),s.jsx("option",{value:"feature",children:"Feature Request"})]})]}),C&&s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Status"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:T.status,onChange:G=>A({...T,status:G.target.value}),children:[s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Title"}),s.jsx("input",{type:"text",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:T.title,onChange:G=>A({...T,title:G.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Description"}),s.jsx("div",{className:"h-64",children:s.jsx(qj,{value:T.description,onChange:G=>A({...T,description:G}),placeholder:"Update description...",type:"Ticket",height:"h-56"})})]}),C&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Project (Epic)"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:T.epic_id||"",onChange:G=>A({...T,epic_id:G.target.value||null}),children:[s.jsx("option",{value:"",children:"None"}),u.map(G=>s.jsx("option",{value:G.id,children:G.title},G.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Assignee"}),s.jsxs("select",{className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-white focus:border-indigo-500 transition-colors",value:T.assigned_to||"",onChange:G=>A({...T,assigned_to:G.target.value||null}),children:[s.jsx("option",{value:"",children:"- Unassigned -"}),I.map(G=>s.jsx("option",{value:G.id,children:G.username},G.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Due Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:T.due_date?ps(new Date(T.due_date),"yyyy-MM-dd"):"",onChange:G=>A({...T,due_date:G.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Completion"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:T.est_completion_date?ps(new Date(T.est_completion_date),"yyyy-MM-dd"):"",onChange:G=>A({...T,est_completion_date:G.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Est. Release"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:T.estimated_release_date?ps(new Date(T.estimated_release_date),"yyyy-MM-dd"):"",onChange:G=>A({...T,estimated_release_date:G.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest block mb-2",children:"Date Released"}),s.jsx("input",{type:"date",className:"w-full bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",value:T.date_released?ps(new Date(T.date_released),"yyyy-MM-dd"):"",onChange:G=>A({...T,date_released:G.target.value})})]})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-6 mt-6",children:[s.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4",children:"Internal Notes"}),s.jsxs("div",{className:"space-y-3 max-h-48 overflow-y-auto mb-4 custom-scrollbar",children:[M.length===0&&s.jsx("p",{className:"text-xs text-gray-600 italic",children:"No notes yet."}),M.map(G=>s.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[s.jsx("span",{className:"font-bold text-indigo-400 uppercase tracking-widest",children:G.username}),s.jsx("span",{children:ps(new Date(G.created_at),"MMM d, h:mm a")})]}),s.jsx("p",{className:"text-sm text-gray-300",children:G.note})]},G.id))]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",className:"flex-1 bg-gray-800 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-indigo-500 transition-colors",placeholder:"Add a note...",value:R,onChange:G=>$(G.target.value),onKeyDown:G=>G.key==="Enter"&&(G.preventDefault(),V(G))}),s.jsx("button",{type:"button",onClick:V,className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white text-xs font-bold uppercase tracking-widest rounded-xl transition-all",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[s.jsx("button",{type:"button",onClick:()=>A(null),className:"px-6 py-3 text-gray-500 font-bold uppercase tracking-widest text-xs hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold uppercase tracking-widest text-xs rounded-xl shadow-lg shadow-indigo-500/20 transition-all",children:"Save Changes"})]})]})]})})]}):null};function Pd(t=null){const[e,r]=y.useState([]),[n,i]=y.useState(!0),[a,l]=y.useState(null),{currentUser:d}=Mt(),u=async()=>{if(d){i(!0);try{const h=await Pe.get("/api/decks",t?{userId:t}:{});r(h),l(null)}catch(h){console.error("Error fetching decks:",h),l(h)}finally{i(!1)}}};return y.useEffect(()=>{if(!d){r([]),i(!1);return}u()},[d,t]),{decks:e,loading:n,error:a,refresh:u}}const bw={W:{name:"White",flavor:"A single spark of light can banish a world of shadows.",theme:"Absolute Order",pips:["W"],bg:"bg-yellow-600"},U:{name:"Blue",flavor:"The mind is the only battlefield where victory is absolute.",theme:"Infinite Inquiry",pips:["U"],bg:"bg-blue-600"},B:{name:"Black",flavor:"Power at any cost, for greatness is written in blood.",theme:"Unrestricted Power",pips:["B"],bg:"bg-gray-800"},R:{name:"Red",flavor:"Do not fear the fire; fear the heart that commands it.",theme:"Chaotic Passion",pips:["R"],bg:"bg-red-600"},G:{name:"Green",flavor:"The forest does not ask for permission to grow.",theme:"Primal Growth",pips:["G"],bg:"bg-green-600"},C:{name:"Colorless",flavor:"Existence is a fleeting dream in the eyes of the silent.",theme:"The Great Void",pips:["C"],bg:"bg-gray-500"},WU:{name:"Azorius Senate",flavor:"Justice is blind, but she has a very long reach.",theme:"Bureaucratic Control",pips:["W","U"],bg:"bg-gradient-to-br from-yellow-300 to-blue-500"},UB:{name:"House Dimir",flavor:"The finest secrets are those that kill the ones who keep them.",theme:"Subterfuge & Infiltration",pips:["U","B"],bg:"bg-gradient-to-br from-blue-600 to-black"},BR:{name:"Cult of Rakdos",flavor:"Entertain us, or become the entertainment.",theme:"Carnival of Carnage",pips:["B","R"],bg:"bg-gradient-to-br from-black to-red-600"},RG:{name:"Gruul Clans",flavor:"Not for city-dwellers. Not for the weak. Only for the wild.",theme:"Primal Destruction",pips:["R","G"],bg:"bg-gradient-to-br from-red-500 to-green-600"},WG:{name:"Selesnya Conclave",flavor:"One voice is a whisper; the Conclave is a roar.",theme:"Collective Harmony",pips:["W","G"],bg:"bg-gradient-to-br from-green-500 to-yellow-200"},WB:{name:"Orzhov Syndicate",flavor:"Even death is no excuse for a breach of contract.",theme:"Indentured Eternity",pips:["W","B"],bg:"bg-gradient-to-br from-gray-200 to-gray-900"},BG:{name:"Golgari Swarm",flavor:"Every grave is a garden if you wait long enough.",theme:"Cycles of Rot",pips:["B","G"],bg:"bg-gradient-to-br from-gray-900 to-green-600"},UG:{name:"Simic Combine",flavor:"Nature is a rough draft; we are the final edit.",theme:"Biological Evolution",pips:["U","G"],bg:"bg-gradient-to-br from-green-400 to-blue-500"},UR:{name:"Izzet League",flavor:"If it doesn't explode, you aren't trying hard enough.",theme:"Volatile Genius",pips:["U","R"],bg:"bg-gradient-to-br from-blue-500 to-red-500"},WR:{name:"Boros Legion",flavor:"First to the fight, last to the fall.",theme:"Tactical Aggression",pips:["W","R"],bg:"bg-gradient-to-br from-red-600 to-yellow-200"},WUG:{name:"Bant",flavor:"The sigil of the sun protects those who stand together.",theme:"Knightly Order",pips:["W","U","G"],bg:"bg-gradient-to-r from-green-400 via-yellow-200 to-blue-400"},WUB:{name:"Esper",flavor:"Perfection is not a goal; it is a requirement.",theme:"Obsidian Logic",pips:["W","U","B"],bg:"bg-gradient-to-r from-yellow-200 via-blue-400 to-black"},UBR:{name:"Grixis",flavor:"A wasteland of power where only the cruelest thrive.",theme:"Ruthless Tyranny",pips:["U","B","R"],bg:"bg-gradient-to-r from-blue-600 via-black to-red-600"},BRG:{name:"Jund",flavor:"In this world, you are either the dragon or the meal.",theme:"Apex Predation",pips:["B","R","G"],bg:"bg-gradient-to-r from-black via-red-600 to-green-600"},WRG:{name:"Naya",flavor:"Where the mountains wake and the earth trembles.",theme:"Primal Majesty",pips:["W","R","G"],bg:"bg-gradient-to-r from-red-500 via-green-500 to-yellow-200"},WBG:{name:"Abzan",flavor:"We do not break; we simply outlast.",theme:"Eternal Endurance",pips:["W","B","G"],bg:"bg-gradient-to-r from-yellow-100 via-black to-green-600"},WUR:{name:"Jeskai",flavor:"The wind carries the strike; the mind guides the bolt.",theme:"Disciplined Spark",pips:["W","U","R"],bg:"bg-gradient-to-r from-blue-500 via-red-500 to-yellow-100"},UBG:{name:"Sultai",flavor:"Power is measured in gold and the bones of the fallen.",theme:"Opulent Decay",pips:["U","B","G"],bg:"bg-gradient-to-r from-black via-green-600 to-blue-600"},WBR:{name:"Mardu",flavor:"Victory is the only law worth following.",theme:"Relentless Conquest",pips:["W","B","R"],bg:"bg-gradient-to-r from-red-600 via-yellow-100 to-black"},URG:{name:"Temur",flavor:"The wild does not think; it reacts with ice and fire.",theme:"Elemental Instinct",pips:["U","R","G"],bg:"bg-gradient-to-r from-green-500 via-blue-500 to-red-500"},UBRG:{name:"Glint-Eye",flavor:"Order is a cage; we have chosen to break the locks.",theme:"Chaotic Adaptation",pips:["U","B","R","G"],bg:"bg-indigo-900"},WBRG:{name:"Dune-Brood",flavor:"When the logic of the mind fails, the instinct of the swarm prevails.",theme:"Sandless Conquest",pips:["W","B","R","G"],bg:"bg-orange-900"},WURG:{name:"Ink-Treader",flavor:"To touch one is to touch the whole of the world.",theme:"Radiant Reflection",pips:["W","U","R","G"],bg:"bg-sky-900"},WUBG:{name:"Witch-Maw",flavor:"There is a hunger beneath the earth that knows no fire.",theme:"Eldritch Growth",pips:["W","U","B","G"],bg:"bg-emerald-900"},WUBR:{name:"Yore-Tiller",flavor:"The past is a weapon we sharpen for the future.",theme:"Relentless History",pips:["W","U","B","R"],bg:"bg-slate-900"},WUBRG:{name:"WUBRG",flavor:"The full spectrum of power, bound in a single hand.",theme:"The Convergence",pips:["W","U","B","R","G"],bg:"bg-gradient-to-r from-yellow-500 via-blue-500 to-green-500"}},Fj=t=>{if(!t)return bw.C;const e={W:0,U:1,B:2,R:3,G:4,C:-1};let r=Array.isArray(t)?t:t.split("");const i=[...new Set(r)].filter(a=>e[a]!==void 0&&a!=="C").sort((a,l)=>e[a]-e[l]).join("");return bw[i]||bw.C},zae=({tier:t,counts:e})=>{const r=(l,d)=>{if(d===1/0)return"bg-blue-500";const u=l/d*100;return u>=90?"bg-red-500":u>=75?"bg-yellow-500":"bg-green-500"},n=(l,d)=>{if(d===1/0)return"100%";const u=l/d*100;return`${Math.min(u,100)}%`},i=(l,d,u)=>{const h=r(d,u),p=n(d,u),m=u!==1/0&&d/u>=.9;return s.jsxs("div",{className:"mb-4 last:mb-0",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-xs font-bold text-gray-300 uppercase tracking-wider",children:l}),s.jsxs("span",{className:`text-xs font-mono ${m?"text-red-400 font-bold":"text-gray-400"}`,children:[d," ",s.jsx("span",{className:"text-gray-600",children:"/"})," ",u===1/0?"":u]})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden border border-gray-700",children:s.jsx("div",{className:`h-full ${h} transition-all duration-1000 ease-out`,style:{width:p}})})]})},a=t.limits.decks!==1/0&&e.decks/t.limits.decks>=.9||t.limits.collection!==1/0&&e.collection/t.limits.collection>=.9||t.limits.wishlist!==1/0&&e.wishlist/t.limits.wishlist>=.9;return s.jsxs("div",{className:"bg-gradient-to-br from-gray-900/60 to-gray-800/60 border border-indigo-500/20 rounded-3xl p-6 backdrop-blur-md relative overflow-hidden group h-full flex flex-col justify-between",children:[s.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-indigo-500/10 rounded-full blur-2xl group-hover:bg-indigo-500/20 transition-all duration-700"}),s.jsxs("div",{className:"relative z-10 w-full flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-indigo-500/20 rounded-xl flex items-center justify-center text-xl shadow-inner border border-indigo-500/30",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-white leading-tight",children:"Allocations"}),s.jsxs("p",{className:"text-[10px] text-indigo-400 font-bold uppercase tracking-widest",children:[t.name," Plan"]})]})]}),s.jsx(_t,{to:"/settings/membership",className:"text-xs text-gray-400 hover:text-white underline decoration-gray-600 hover:decoration-white transition-all",children:"Manage"})]}),s.jsxs("div",{className:"flex-grow space-y-4",children:[i("Decks",e.decks,t.limits.decks),i("Collection",e.collection,t.limits.collection),i("Wishlist",e.wishlist,t.limits.wishlist)]}),a&&s.jsxs("div",{className:"mt-6 p-3 bg-red-500/10 border border-red-500/20 rounded-xl",children:[s.jsxs("p",{className:"text-xs text-red-200 mb-2 font-medium flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Storage limits reached!"]}),s.jsx(_t,{to:"/pricing",className:"block w-full py-2 text-center bg-red-600 hover:bg-red-500 text-white text-xs font-bold rounded-lg transition-colors shadow-lg shadow-red-900/20",children:"Upgrade Plan"})]}),!a&&t.name==="Initiate"&&s.jsx("div",{className:"mt-6",children:s.jsx(_t,{to:"/pricing",className:"block w-full py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white text-sm font-bold rounded-xl transition-all shadow-lg shadow-indigo-900/20 text-center",children:"Upgrade for More"})})]})]})},qae=()=>{const t=on(),{addToast:e}=_r(),[r,n]=y.useState([]),[i,a]=y.useState(0),[l,d]=y.useState(!0);y.useEffect(()=>{(async()=>{try{const m=await ts.fetchRelationships(),x=m.filter(v=>v.status==="accepted");n(x);const b=m.filter(v=>v.status==="pending"&&v.direction==="incoming");a(b.length)}catch(m){console.error("Widget fetch failed",m)}finally{d(!1)}})()},[]);const u=(p,m)=>{p.preventDefault(),p.stopPropagation(),t("/settings/community")},h=p=>{p.preventDefault(),p.stopPropagation(),e("Go to Settings > Community > Manage to view the guide.","info"),t("/settings/community")};return s.jsxs("div",{className:"bg-gray-900/50 rounded-2xl p-6 border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/20 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-gray-400 text-sm font-medium flex items-center gap-2",children:["My Pod",i>0&&s.jsxs("span",{className:"bg-indigo-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse",children:[i," New"]})]}),s.jsxs("div",{className:"mt-1",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:r.length}),s.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"connections"})]})]}),s.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),s.jsx("div",{className:"flex-1 space-y-3 relative z-10",children:l?s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-10 bg-gray-800 rounded-xl animate-pulse"}),s.jsx("div",{className:"h-10 bg-gray-800 rounded-xl animate-pulse delay-75"})]}):r.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-2",children:r.slice(0,2).map(p=>s.jsxs("div",{className:"group/item flex items-center justify-between p-2 rounded-xl hover:bg-white/5 transition-colors border border-transparent hover:border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-900 flex items-center justify-center text-xs font-bold text-indigo-200 ring-2 ring-gray-900",children:p.friend.username?.[0]?.toUpperCase()}),s.jsx("div",{className:"text-sm font-bold text-gray-300 truncate max-w-[80px]",children:p.friend.username})]}),s.jsx("button",{onClick:m=>u(m,p.id),className:"opacity-0 group-hover/item:opacity-100 p-1.5 text-xs font-bold text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-all",children:"Manage"})]},p.id))}),r.length>2&&s.jsxs(_t,{to:"/settings/community",className:"block text-center text-xs text-gray-500 hover:text-indigo-400 mt-2 font-medium transition-colors",children:["+ ",r.length-2," others"]})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"No friends yet."}),s.jsx(_t,{to:"/settings/community",className:"text-xs font-bold text-indigo-400 hover:text-indigo-300",children:"Add Friends "})]})}),s.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-800 relative z-10 flex justify-between items-center",children:[s.jsxs("button",{onClick:h,className:"flex items-center gap-1.5 text-[10px] uppercase font-bold text-gray-500 hover:text-indigo-400 transition-colors",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Setup Guide"]}),s.jsx(_t,{to:"/settings/community",className:"text-[10px] uppercase font-bold text-indigo-500 hover:text-indigo-400 transition-colors",children:"All Settings "})]})]})},bu=["Just buy a new booster box? Add the cards through the set page, after organizing the cards by collector number. You can go top down, or bottom up on the list and make your life MUCH easier.","You can bulk import your collection via CSV! Check the Collection page for the template.","Right-click any card in your collection to instantly find it on TCGPlayer.","Use the 'Wishlist' filter in your collection to track cards you plan to buy.","You can separate your 'Foils' from regular printings by toggling the foil icon when adding cards.","Filter your collection by 'Rarity: Mythic' to see your big hits quickly.","The 'Price' filter helps you find those hidden gems in your bulk box.","Did you know? You can manually edit the market price of a card if you have a specific variant not tracked correctly.","Smart Binders update automatically. If you add a new Goblin to your collection, it instantly goes into your 'Goblin Tribe' binder.","You can use RegEx in Smart Binders! Example: Name matches `^Dark` finds cards starting with 'Dark'.","Want a binder for high-value cards? Set a rule for 'Price > 5.00'.","Create a 'Trade Binder' by excluding cards that are currently in a deck: `In Deck = False`.","You can combine rules! `Color Identity = R` AND `Type = Dragon` makes a perfect dragon binder.","Smart Binders can track duplicates. Set `Quantity > 4` to find cards you can trade away.","Customize your binder icons with emojis to make them stand out in the list.","Use the 'Pro Color' toggles in the Smart Creator to quickly select color identities.","When building a deck, use the 'Synergy' tab to see cards that work well with your Commander.","The Mana Curve chart updates in real-time as you add cards to your deck.","You can clone any of your existing decks to try out a new strategy without losing the original.","Use the 'Playtest' feature to draw sample hands and see if your land count is right.","Toggle 'Group by Type' in the deck view to see your creature/spell balance.","The AI Strategy tool can suggest a land base for you based on your color pips.","Add 'Tags' to cards in your deck (like 'Ramp', 'Removal') to see a custom breakdown.","You can set a card as your 'Commander' directly from the search results.","Check the 'Sideboard' tab to keep track of cards you're considering but haven't cut yet.","Invite friends to your 'Pod' to see their trade binders in real-time.","You can set your Pod permissions to 'Viewer' (read-only) or 'Editor' (trust them to modify decks).","Share your deck with a QR code! It's perfect for showing off your build at the LGS.","Link your account with a partner to build 'Team Decks' using a shared card pool.","Mark cards as 'Not for Trade' in your collection, and they won't show up for your Pod friends.","Collaborate on a deck list by giving a friend 'Editor' access in your Pod.","Keep your database healthy! Run the 'Cleanup' script periodically if you notice duplicate entries.","You can change your theme preference in the Settings menu (Dark/Light mode).","Report bugs directly from the dashboard using the 'System Status' widget.","The dollar value of your collection is an estimate based on TCGPlayer Market Price.","Use standard Scryfall syntax in the search bar. `t:creature cmc>5` works!","Hover over the KPI cards on the dashboard to see more detailed tooltips.","Click the 'Update Prices' button on the dashboard to fetch the latest market data.","You can view your deck's stats (CMC, Type distribution) on the mobile view too!","The app works offline for browsing, but you need internet to sync prices or images.","Double-click a card image to view the high-res version.","Use keyboard shortcuts! 'Ctrl/Cmd + F' usually brings up the card search."],Fae=()=>{const[t,e]=y.useState(0),[r,n]=y.useState(!1);y.useEffect(()=>{const a=Math.floor(Math.random()*bu.length);e(a)},[]);const i=a=>{r||(n(!0),setTimeout(()=>n(!1),300),e(l=>a==="next"?(l+1)%bu.length:(l-1+bu.length)%bu.length))};return s.jsxs("div",{className:"bg-gray-900/50 border border-white/5 rounded-3xl p-4 backdrop-blur-md relative overflow-hidden group min-h-[140px] flex flex-col",children:[s.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("svg",{className:"w-20 h-20 transform rotate-12",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"})})}),s.jsxs("h2",{className:"font-bold text-white mb-2 flex items-center gap-2 relative z-10 text-xs",children:[s.jsx("span",{className:"p-1.5 bg-yellow-500/10 rounded-lg text-yellow-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),"Pro Tips"]}),s.jsxs("div",{className:"relative z-10 flex-1 flex flex-col justify-between",children:[s.jsx("p",{className:`text-[11px] text-gray-300 leading-relaxed transition-opacity duration-300 ${r?"opacity-0":"opacity-100"}`,children:bu[t]}),s.jsxs("div",{className:"flex items-center justify-between mt-3 border-t border-white/5 pt-2",children:[s.jsxs("span",{className:"text-[9px] text-gray-600 font-mono uppercase",children:[t+1," / ",bu.length]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>i("prev"),className:"p-1 rounded-lg hover:bg-white/10 text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>i("next"),className:"p-1 rounded-lg hover:bg-white/10 text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})]})]})},Hae=()=>{const{userProfile:t}=Mt(),e=t?.settings?.organization?.mode,n=(i=>{switch(i){case"deckbuilder":return{label:"Deckbuilder",icon:"",desc:"Sorted by Color & Type"};case"collector":return{label:"Collector",icon:"",desc:"Sorted by Set & Number"};case"hybrid":return{label:"Hybrid",icon:"",desc:"Binders + Bulk Boxes"};case"custom":return{label:"Custom",icon:"",desc:"Advanced Hierarchy"};default:return{label:"Reference",icon:"",desc:"Default Organization"}}})(e);return s.jsxs(_t,{to:"/settings/display",className:"group relative overflow-hidden rounded-2xl p-4 md:p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5 block",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600 to-purple-600 opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),s.jsx("div",{className:"absolute inset-0 bg-gray-800/50 group-hover:opacity-0 transition-opacity"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-3 text-gray-300 group-hover:text-white transition-colors h-full",children:[s.jsx("div",{className:"p-3 bg-gray-900/50 rounded-full backdrop-blur-sm group-hover:scale-110 transition-transform group-hover:bg-white/20 text-2xl",children:n.icon}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"font-bold text-sm tracking-wide",children:"Organization"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest mt-0.5",children:n.label})]})]})]})},Wae=({isOpen:t,onClose:e,release:r})=>{const[n,i]=y.useState(!1);return y.useEffect(()=>(i(!0),()=>i(!1)),[]),!t||!r||!n?null:ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",onClick:e,children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-2xl w-full max-w-2xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] animate-slide-up",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-start bg-gray-950/50",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-1",children:r.version}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("span",{className:"text-xs text-gray-400 font-mono uppercase",children:["Released ",ps(new Date(r.released_at),"MMMM d, yyyy")]})})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar bg-gray-900/50",children:[s.jsxs("div",{className:"flex gap-4 mb-6",children:[r.stats?.features>0&&s.jsx("div",{className:"px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-lg",children:s.jsxs("span",{className:"text-xs font-bold text-emerald-400 uppercase tracking-wider",children:[r.stats.features," New Features"]})}),r.stats?.bugs>0&&s.jsx("div",{className:"px-3 py-1 bg-red-500/10 border border-red-500/20 rounded-lg",children:s.jsxs("span",{className:"text-xs font-bold text-red-400 uppercase tracking-wider",children:[r.stats.bugs," Bug Fixes"]})})]}),s.jsx("div",{className:"prose prose-invert prose-lg max-w-none prose-headings:text-indigo-300 prose-a:text-indigo-400 prose-strong:text-white",dangerouslySetInnerHTML:{__html:r.notes}})]}),s.jsx("div",{className:"p-4 border-t border-white/5 bg-gray-950/30 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Close"})})]})}),document.body)},Gae=()=>{const[t,e]=y.useState([]),[r,n]=y.useState(!0),[i,a]=y.useState(null);return y.useEffect(()=>{(async()=>{try{const d=await Pe.getReleases();e(d||[])}catch(d){console.error("Failed to load releases",d)}finally{n(!1)}})()},[]),s.jsxs("div",{className:"bg-gray-900/40 border border-white/5 rounded-3xl p-6 backdrop-blur-md flex flex-col h-full overflow-hidden",children:[s.jsxs("h2",{className:"font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"p-1.5 bg-green-500/10 rounded-lg text-green-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),"Recent Releases Hub"]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar",children:r?s.jsx("div",{className:"text-gray-500 text-sm animate-pulse",children:"Loading updates..."}):t.length===0?s.jsx("div",{className:"text-gray-500 text-sm italic py-4 text-center border border-dashed border-gray-800 rounded-xl",children:"No releases published yet."}):t.map(l=>s.jsxs("div",{className:"bg-gray-950/30 border border-white/5 rounded-xl p-4 flex items-center justify-between group hover:border-indigo-500/30 transition-all",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[s.jsx("span",{className:"font-black text-white text-lg tracking-tight",children:l.version}),s.jsx("span",{className:"text-[10px] text-gray-500 font-mono uppercase",children:ps(new Date(l.released_at),"MMM d, yyyy")})]}),s.jsxs("div",{className:"flex gap-3 text-[10px] font-bold uppercase tracking-wide",children:[l.stats?.features>0&&s.jsxs("span",{className:"text-emerald-400 bg-emerald-500/10 px-2 py-0.5 rounded-full",children:[l.stats.features," Features"]}),l.stats?.bugs>0&&s.jsxs("span",{className:"text-red-400 bg-red-500/10 px-2 py-0.5 rounded-full",children:[l.stats.bugs," Bugs"]})]})]}),s.jsxs("button",{onClick:()=>a(l),className:"px-3 py-1.5 bg-gray-800 hover:bg-indigo-600 text-gray-300 hover:text-white rounded-lg text-xs font-bold transition-all shadow-sm flex items-center gap-1 group-hover:translate-x-0 translate-x-2 opacity-0 group-hover:opacity-100",children:["View Release",s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]},l.id))}),s.jsx(Wae,{isOpen:!!i,onClose:()=>a(null),release:i})]})},Vae=({isOpen:t,onClose:e,onConfirm:r,type:n,targetId:i,loading:a,activeSession:l})=>t?ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900/90 border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 pointer-events-none"}),s.jsxs("div",{className:"p-8 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center text-2xl border border-indigo-500/30 text-indigo-400",children:""}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Start ",n.charAt(0).toUpperCase()+n.slice(1)," Audit"]}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Verify your physical ownership"})]})]}),s.jsxs("div",{className:"space-y-4 mb-8",children:[l?s.jsxs("div",{className:"border border-red-500/30 bg-red-900/20 p-4 rounded-xl",children:[s.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Previous Audit In Progress"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["You have an active ",s.jsx("strong",{children:l.type})," audit. Starting this new audit will ",s.jsx("strong",{children:"cancel and delete"})," the existing session."]})]}):s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-white/5",children:[s.jsx("h3",{className:"text-sm font-bold text-white mb-2",children:"How it works:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"1."}),s.jsx("span",{children:"We'll create a snapshot of your current digital list."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"2."}),s.jsx("span",{children:"You'll verify each card physically."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"3."}),s.jsx("span",{children:"Finalize to reconcile any differences."})]})]})]}),!l&&s.jsxs("div",{className:"flex items-center gap-3 text-sm text-blue-400 bg-blue-500/10 p-3 rounded-lg border border-blue-500/20",children:[s.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:"Only one active audit allowed. This will be your active session."})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white font-medium transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,disabled:a,className:`px-6 py-2 font-bold rounded-xl shadow-lg transition-all transform hover:scale-105 active:scale-95 flex items-center gap-2 disabled:opacity-50 ${l?"bg-red-600 hover:bg-red-500 text-white shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-500/20"}`,children:[a?"Starting...":l?"Overwrite & Start":"Begin Audit",!a&&s.jsx("span",{className:"opacity-70",children:""})]})]})]})]})}),document.body):null;function hy({type:t,targetId:e,label:r="Start Audit",className:n=""}){const[i,a]=y.useState(!1),[l,d]=y.useState(!1),u=on(),[h,p]=y.useState(null),m=async()=>{a(!0);try{h&&await Pe.cancelAudit(h.id);const b=await Pe.startAudit({type:t,targetId:e});u(`/audit/${b.id}`)}catch(b){console.error(b),alert("Failed to start audit: "+b.message)}finally{a(!1),d(!1),p(null)}},x=async()=>{a(!0);try{const b=await Pe.getActiveAudit();if(b){const v=b.type===t,w=!e||String(b.target_id)===String(e);if(v&&w){u(`/audit/${b.id}`);return}p(b),d(!0);return}p(null),d(!0)}catch(b){console.error(b),d(!0)}finally{a(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:x,className:`flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors shadow-lg shadow-indigo-500/20 disabled:opacity-50 ${n}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),r]}),s.jsx(Vae,{isOpen:l,onClose:()=>d(!1),onConfirm:m,type:t,loading:i,activeSession:h})]})}function Kae(){const[t,e]=y.useState(null),[r,n]=y.useState(null),[i,a]=y.useState(!0),[l,d]=y.useState(!1),u=on(),{userProfile:h}=Mt();y.useEffect(()=>{(async()=>{try{const A=await Pe.getActiveAudit();if(e(A),A){const I=await Pe.get(`/api/audit/${A.id}/stats`);n(I)}}catch(A){console.error("Failed to check audit status",A)}finally{a(!1)}})()},[]);const{features:p}=Yt(h?.subscription_tier);if(!p.collectionAudit)return s.jsxs("div",{className:"bg-gray-900/50 rounded-2xl p-4 border border-gray-800 transition-all group relative overflow-hidden flex flex-col h-full min-h-[140px] opacity-75 hover:opacity-100",children:[s.jsx("div",{className:"flex justify-between items-start mb-1 relative z-10",children:s.jsx("div",{children:s.jsx("h3",{className:"text-gray-400 text-xs font-medium flex items-center gap-2",children:"Audit The Forge"})})}),s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center relative z-10",children:[s.jsx("div",{className:"p-2 bg-green-500/10 rounded-full mb-2",children:s.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("p",{className:"text-[10px] text-gray-400 mb-2",children:"Verify your physical collection."}),s.jsx("button",{onClick:()=>u("/settings/membership"),className:"text-[9px] font-bold uppercase tracking-widest text-green-400 hover:text-white border border-green-500/30 px-3 py-1.5 rounded-lg hover:bg-green-500/20 transition-all",children:"Unlock on Wizard"})]})]});if(i)return null;if(!t)return s.jsxs("div",{className:"bg-gray-900/50 rounded-2xl p-4 border border-gray-800 hover:border-indigo-500/30 transition-all group relative overflow-hidden flex flex-col h-full min-h-[140px]",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/10 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-1 relative z-10",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-gray-400 text-xs font-medium flex items-center gap-2",children:"Audit The Forge"}),s.jsx("div",{className:"mt-1",children:s.jsx("span",{className:"text-2xl font-bold text-white/20",children:"Ready"})})]}),s.jsx("div",{className:"p-1.5 bg-gray-800/50 rounded-lg text-gray-600 group-hover:text-indigo-400 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})})]}),s.jsx("p",{className:"text-[11px] text-gray-500 mb-4 relative z-10",children:"Keep your inventory accurate."}),s.jsxs("div",{className:"mt-auto relative z-10 flex flex-col gap-2",children:[s.jsx(hy,{type:"collection",label:"Start Audit",className:"w-full py-1.5 bg-gray-800 hover:bg-indigo-600 text-gray-400 hover:text-white rounded-xl font-bold text-[10px] transition-all border border-gray-700 hover:border-indigo-500 active:scale-95 shadow-none"}),s.jsxs("button",{onClick:()=>d(!0),className:"text-[9px] font-bold text-gray-600 hover:text-indigo-400 uppercase tracking-widest transition-colors flex items-center justify-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Setup Guide"]})]}),s.jsx(Xf,{isOpen:l,onClose:()=>d(!1)})]});const m=Math.ceil((new Date(t.expires_at)-new Date)/(1e3*60*60*24)),x=r?.total_cards||0,b=r?.total_reviewed||0,v=r?.mismatches?.length||0,w=b-v,k=x-b,_=x>0?Math.round(b/x*100):0;return s.jsxs("div",{className:"bg-gray-900/50 rounded-2xl p-4 border border-indigo-500/20 hover:border-indigo-500/40 transition-all group relative overflow-hidden flex flex-col h-full min-h-[140px]",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 group-hover:bg-indigo-500/20 transition-all pointer-events-none"}),s.jsxs("div",{className:"flex justify-between items-start mb-1 relative z-10",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-indigo-400 text-[11px] font-medium flex items-center gap-2 uppercase tracking-wider",children:["Audit in Progress",s.jsx("span",{className:"w-1 h-1 rounded-full bg-indigo-500 animate-pulse"})]}),s.jsxs("div",{className:"mt-0.5",children:[s.jsxs("span",{className:"text-2xl font-bold text-white",children:[_,"%"]}),s.jsx("span",{className:"text-[10px] text-gray-500 ml-1",children:"Complete"})]})]}),s.jsx("button",{onClick:()=>d(!0),className:"p-1.5 bg-indigo-500/10 rounded-lg text-indigo-400 hover:bg-indigo-500/20 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),r&&s.jsxs("div",{className:"relative z-10 mb-3",children:[s.jsx("div",{className:"w-full bg-gray-800 rounded-full h-1 my-1.5 overflow-hidden",children:s.jsx("div",{className:"bg-indigo-500 h-full transition-all duration-1000 ease-out",style:{width:`${_}%`}})}),s.jsxs("div",{className:"flex justify-between text-[9px] font-bold uppercase tracking-wider",children:[s.jsxs("span",{className:"text-green-500/80",children:[w," Match"]}),s.jsxs("span",{className:"text-red-500/80",children:[v," Diff"]}),s.jsxs("span",{className:"text-gray-500",children:[k," Left"]})]})]}),!r&&s.jsx("div",{className:"flex-1"}),s.jsxs("div",{className:"mt-auto relative z-10 flex items-center justify-between gap-3",children:[s.jsxs("span",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-widest",children:[m,"d left"]}),s.jsx("button",{onClick:()=>u("/audit"),className:"flex-1 py-1.5 bg-indigo-500 hover:bg-indigo-400 text-white rounded-xl font-bold text-[10px] transition-all shadow-lg shadow-indigo-500/20 active:scale-95",children:"Resume "})]}),s.jsx(Xf,{isOpen:l,onClose:()=>d(!1)})]})}var b9="clover",Yae=function(e){return e===3?"v3":e},v9="https://js.stripe.com",Xae="".concat(v9,"/").concat(b9,"/stripe.js"),Jae=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Qae=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,Zae=function(e){return Jae.test(e)||Qae.test(e)},eoe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(v9,'"]')),r=0;r<e.length;r++){var n=e[r];if(Zae(n.src))return n}return null},W6=function(e){var r="",n=document.createElement("script");n.src="".concat(Xae).concat(r);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},toe=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.6.0",startTime:r})},pf=null,$m=null,Um=null,roe=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},noe=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},soe=function(e){return pf!==null?pf:(pf=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var i=eoe();if(!(i&&e)){if(!i)i=W6(e);else if(i&&Um!==null&&$m!==null){var a;i.removeEventListener("load",Um),i.removeEventListener("error",$m),(a=i.parentNode)===null||a===void 0||a.removeChild(i),i=W6(e)}}Um=noe(r,n),$m=roe(n),i.addEventListener("load",Um),i.addEventListener("error",$m)}catch(l){n(l);return}}),pf.catch(function(r){return pf=null,Promise.reject(r)}))},ioe=function(e,r,n){if(e===null)return null;var i=r[0],a=i.match(/^pk_test/),l=Yae(e.version),d=b9;a&&l!==d&&console.warn("Stripe.js@".concat(l," was loaded on the page, but @stripe/stripe-js@").concat("8.6.0"," expected Stripe.js@").concat(d,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var u=e.apply(void 0,r);return toe(u,n),u},mf,w9=!1,j9=function(){return mf||(mf=soe(null).catch(function(e){return mf=null,Promise.reject(e)}),mf)};Promise.resolve().then(function(){return j9()}).catch(function(t){w9||console.warn(t)});var aoe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];w9=!0;var i=Date.now();return j9().then(function(a){return ioe(a,r,i)})},ooe=P4();const kr=Ms(ooe);function G6(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function V6(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G6(Object(r),!0).forEach(function(n){N9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G6(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Sg(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Sg=function(e){return typeof e}:Sg=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sg(t)}function N9(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function loe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function coe(t,e){if(t==null)return{};var r=loe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function k9(t,e){return doe(t)||uoe(t,e)||hoe(t,e)||foe()}function doe(t){if(Array.isArray(t))return t}function uoe(t,e){var r=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(r!=null){var n=[],i=!0,a=!1,l,d;try{for(r=r.call(t);!(i=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));i=!0);}catch(u){a=!0,d=u}finally{try{!i&&r.return!=null&&r.return()}finally{if(a)throw d}}return n}}function hoe(t,e){if(t){if(typeof t=="string")return K6(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K6(t,e)}}function K6(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function foe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var js=function(e,r,n){var i=!!n,a=Ge.useRef(n);Ge.useEffect(function(){a.current=n},[n]),Ge.useEffect(function(){if(!i||!e)return function(){};var l=function(){a.current&&a.current.apply(a,arguments)};return e.on(r,l),function(){e.off(r,l)}},[i,r,e,a])},Hj=function(e){var r=Ge.useRef(e);return Ge.useEffect(function(){r.current=e},[e]),r.current},Ku=function(e){return e!==null&&Sg(e)==="object"},poe=function(e){return Ku(e)&&typeof e.then=="function"},moe=function(e){return Ku(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},Y6="[object Object]",goe=function t(e,r){if(!Ku(e)||!Ku(r))return e===r;var n=Array.isArray(e),i=Array.isArray(r);if(n!==i)return!1;var a=Object.prototype.toString.call(e)===Y6,l=Object.prototype.toString.call(r)===Y6;if(a!==l)return!1;if(!a&&!n)return e===r;var d=Object.keys(e),u=Object.keys(r);if(d.length!==u.length)return!1;for(var h={},p=0;p<d.length;p+=1)h[d[p]]=!0;for(var m=0;m<u.length;m+=1)h[u[m]]=!0;var x=Object.keys(h);if(x.length!==d.length)return!1;var b=e,v=r,w=function(_){return t(b[_],v[_])};return x.every(w)},S9=function(e,r,n){return Ku(e)?Object.keys(e).reduce(function(i,a){var l=!Ku(r)||!goe(e[a],r[a]);return n.includes(a)?(l&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),i):l?V6(V6({},i||{}),{},N9({},a,e[a])):i},null):null},_9="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",X6=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_9;if(e===null||moe(e))return e;throw new Error(r)},xoe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_9;if(poe(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(i){return X6(i,r)})};var n=X6(e,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},yoe=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.4.1"}),e.registerAppInfo({name:"react-stripe-js",version:"5.4.1",url:"https://stripe.com/docs/stripe-js/react"}))},fy=Ge.createContext(null);fy.displayName="ElementsContext";var C9=function(e,r){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return e},E9=function(e){var r=e.stripe,n=e.options,i=e.children,a=Ge.useMemo(function(){return xoe(r)},[r]),l=Ge.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(n):null}}),d=k9(l,2),u=d[0],h=d[1];Ge.useEffect(function(){var x=!0,b=function(w){h(function(k){return k.stripe?k:{stripe:w,elements:w.elements(n)}})};return a.tag==="async"&&!u.stripe?a.stripePromise.then(function(v){v&&x&&b(v)}):a.tag==="sync"&&!u.stripe&&b(a.stripe),function(){x=!1}},[a,u,n]);var p=Hj(r);Ge.useEffect(function(){p!==null&&p!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[p,r]);var m=Hj(n);return Ge.useEffect(function(){if(u.elements){var x=S9(n,m,["clientSecret","fonts"]);x&&u.elements.update(x)}},[n,m,u.elements]),Ge.useEffect(function(){yoe(u.stripe)},[u.stripe]),Ge.createElement(fy.Provider,{value:u},i)};E9.propTypes={stripe:kr.any,options:kr.object};var boe=function(e){var r=Ge.useContext(fy);return C9(r,e)},voe=function(){var e=boe("calls useElements()"),r=e.elements;return r};kr.func.isRequired;var A9=Ge.createContext(null);A9.displayName="CheckoutContext";kr.any,kr.shape({clientSecret:kr.oneOfType([kr.string,kr.instanceOf(Promise)]).isRequired,elementsOptions:kr.object}).isRequired;var Wj=function(e){var r=Ge.useContext(A9),n=Ge.useContext(fy);if(r){if(n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return r}else return C9(n,e)},woe=["mode"],joe=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Vs=function(e,r){var n="".concat(joe(e),"Element"),i=function(u){var h=u.id,p=u.className,m=u.options,x=m===void 0?{}:m,b=u.onBlur,v=u.onFocus,w=u.onReady,k=u.onChange,_=u.onEscape,T=u.onClick,A=u.onLoadError,I=u.onLoaderStart,O=u.onNetworksChange,M=u.onConfirm,E=u.onCancel,R=u.onShippingAddressChange,$=u.onShippingRateChange,B=u.onSavedPaymentMethodRemove,C=u.onSavedPaymentMethodUpdate,U=Wj("mounts <".concat(n,">")),L="elements"in U?U.elements:null,q="checkoutState"in U?U.checkoutState:null,K=q?.type==="success"||q?.type==="loading"?q.sdk:null,W=Ge.useState(null),V=k9(W,2),X=V[0],Z=V[1],G=Ge.useRef(null),F=Ge.useRef(null);js(X,"blur",b),js(X,"focus",v),js(X,"escape",_),js(X,"click",T),js(X,"loaderror",A),js(X,"loaderstart",I),js(X,"networkschange",O),js(X,"confirm",M),js(X,"cancel",E),js(X,"shippingaddresschange",R),js(X,"shippingratechange",$),js(X,"savedpaymentmethodremove",B),js(X,"savedpaymentmethodupdate",C),js(X,"change",k);var Y;w&&(e==="expressCheckout"?Y=w:Y=function(){w(X)}),js(X,"ready",Y),Ge.useLayoutEffect(function(){if(G.current===null&&F.current!==null&&(L||K)){var re=null;if(K)switch(e){case"paymentForm":re=K.createPaymentFormElement();break;case"payment":re=K.createPaymentElement(x);break;case"address":if("mode"in x){var ue=x.mode,Le=coe(x,woe);if(ue==="shipping")re=K.createShippingAddressElement(Le);else if(ue==="billing")re=K.createBillingAddressElement(Le);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":re=K.createExpressCheckoutElement(x);break;case"currencySelector":re=K.createCurrencySelectorElement();break;case"taxId":re=K.createTaxIdElement(x);break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else L&&(re=L.create(e,x));G.current=re,Z(re),re&&re.mount(F.current)}},[L,K,x]);var ne=Hj(x);return Ge.useEffect(function(){if(G.current){var re=S9(x,ne,["paymentRequest"]);re&&"update"in G.current&&G.current.update(re)}},[x,ne]),Ge.useLayoutEffect(function(){return function(){if(G.current&&typeof G.current.destroy=="function")try{G.current.destroy(),G.current=null}catch{}}},[]),Ge.createElement("div",{id:h,className:p,ref:F})},a=function(u){Wj("mounts <".concat(n,">"));var h=u.id,p=u.className;return Ge.createElement("div",{id:h,className:p})},l=r?a:i;return l.propTypes={id:kr.string,className:kr.string,onChange:kr.func,onBlur:kr.func,onFocus:kr.func,onReady:kr.func,onEscape:kr.func,onClick:kr.func,onLoadError:kr.func,onLoaderStart:kr.func,onNetworksChange:kr.func,onConfirm:kr.func,onCancel:kr.func,onShippingAddressChange:kr.func,onShippingRateChange:kr.func,onSavedPaymentMethodRemove:kr.func,onSavedPaymentMethodUpdate:kr.func,options:kr.object},l.displayName=n,l.__elementType=e,l},Ks=typeof window>"u",Noe=Ge.createContext(null);Noe.displayName="EmbeddedCheckoutProviderContext";var koe=function(){var e=Wj("calls useStripe()"),r=e.stripe;return r};Vs("auBankAccount",Ks);Vs("card",Ks);Vs("cardNumber",Ks);Vs("cardExpiry",Ks);Vs("cardCvc",Ks);Vs("iban",Ks);var Soe=Vs("payment",Ks);Vs("expressCheckout",Ks);Vs("paymentRequestButton",Ks);Vs("linkAuthentication",Ks);Vs("address",Ks);Vs("shippingAddress",Ks);Vs("paymentMethodMessaging",Ks);Vs("taxId",Ks);const _oe=aoe("pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W"),Coe=({amount:t,onCancel:e,onSuccess:r})=>{const n=koe(),i=voe(),[a,l]=y.useState(null),[d,u]=y.useState(!1),[h,p]=y.useState(!1),m="pk_live_51SlUIzDBKqoK8H1R678IbVVW4LcMLcprIgwAioxS9rFmd96GIScateX2EnhsV9C7QmXFfrhXav1E9tH34fRDLPUh00vufnhp6W".startsWith("pk_live")&&window.location.protocol==="http:",x=async b=>{if(b.preventDefault(),!n||!i)return;u(!0);const{error:v}=await n.confirmPayment({elements:i,confirmParams:{return_url:window.location.origin+"/dashboard?donation=success"},redirect:"if_required"});v?(l(v.message),u(!1)):r()};return s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[m?s.jsxs("div",{className:"bg-amber-900/30 border border-amber-500/50 p-6 rounded-xl text-center space-y-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsx("h3",{className:"font-bold text-amber-200",children:"HTTPS Required"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Live Stripe payments require a secure (HTTPS) connection. Please use ",s.jsx("strong",{children:"test keys"})," for local development or deploy to a secure server."]})]}):s.jsxs("div",{className:"relative min-h-[100px]",children:[!h&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 rounded-xl border border-gray-700 animate-pulse text-gray-500 text-sm",children:"Loading Secure Form..."}),s.jsx(Soe,{onReady:()=>p(!0),onLoadError:b=>l(b.error?.message||"Failed to load payment form."),className:"bg-gray-900 p-4 rounded-xl border border-gray-700"})]}),a&&s.jsx("div",{className:"text-red-500 text-sm mt-2 p-3 bg-red-950/30 border border-red-500/30 rounded-lg",children:a}),s.jsxs("div",{className:"flex gap-4 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded-xl font-bold transition-all",children:"Change Amount"}),s.jsx("button",{disabled:d||!n,className:"flex-1 px-4 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-indigo-500/25 disabled:opacity-50",children:d?"Processing...":`Donate $${t}`})]})]})},Eoe=({isOpen:t,onClose:e})=>{const[r,n]=y.useState("amount"),[i,a]=y.useState(10),[l,d]=y.useState(""),[u,h]=y.useState(!1),[p,m]=y.useState("stripe");y.useEffect(()=>{t||(n("amount"),d(""),h(!1))},[t]);const x=async b=>{a(b),h(!0);try{const v=await Pe.post("/api/payments/create-intent",{amount:b});d(v.clientSecret),n("payment")}catch(v){alert("Error creating payment: "+v.message)}finally{h(!1)}};return t?s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 w-full max-w-lg rounded-3xl flex flex-col max-h-[calc(100vh-4rem)] shadow-2xl animate-fade-in-up overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-950/50 flex-shrink-0",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-pink-500 text-2xl",children:""})," Support MTG-Forge"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors p-2",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-grow",children:[r==="amount"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-400 mb-6",children:"Your support helps us keep the servers running and the AI Architect dreaming of new decks."}),s.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[5,10,20].map(b=>s.jsxs("button",{onClick:()=>a(b),className:`py-4 rounded-xl border font-bold transition-all ${i===b?"bg-indigo-600 border-indigo-400 text-white shadow-lg shadow-indigo-500/20 scale-105":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:["$",b]},b))}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"}),s.jsx("input",{type:"number",value:i,onChange:b=>a(parseFloat(b.target.value)||""),className:"w-full bg-gray-800 border border-gray-700 rounded-xl py-3 pl-8 pr-4 text-white font-bold focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Other amount"})]})]}),s.jsx("button",{onClick:()=>x(i),disabled:u||!i||i<1,className:"w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl font-bold text-lg shadow-xl hover:shadow-indigo-500/30 transition-all transform hover:-translate-y-1 disabled:opacity-50",children:u?"Loading...":"Continue to Payment"})]}),r==="payment"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("div",{className:"flex bg-gray-950 p-1 rounded-xl mb-4",children:["stripe","google","paypal"].map(b=>s.jsx("button",{onClick:()=>m(b),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${p===b?"bg-gray-800 text-white shadow-sm":"text-gray-500 hover:text-gray-400"}`,children:b==="stripe"?"Card":b==="google"?"Google Pay":"PayPal"},b))}),p==="stripe"&&l&&s.jsx(E9,{stripe:_oe,options:{clientSecret:l,appearance:{theme:"night"}},children:s.jsx(Coe,{amount:i,onCancel:()=>n("amount"),onSuccess:()=>n("success")})}),(p==="google"||p==="paypal")&&s.jsxs("div",{className:"text-center py-12 space-y-4 animate-pulse",children:[s.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-800 rounded-full flex items-center justify-center text-2xl",children:p==="google"?"":""}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-gray-300 capitalize",children:[p," Pay Integration"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Coming incredibly soon! Please use Card for now."})]}),s.jsx("button",{onClick:()=>m("stripe"),className:"text-indigo-400 text-sm hover:underline font-bold",children:"Back to Card Payment"})]})]}),r==="success"&&s.jsxs("div",{className:"text-center space-y-8 animate-fade-in py-8",children:[s.jsxs("div",{className:"w-24 h-24 mx-auto relative",children:[s.jsx("div",{className:"absolute inset-0 bg-pink-500 rounded-full animate-ping opacity-20"}),s.jsx("div",{className:"relative bg-gradient-to-br from-pink-500 to-rose-600 w-24 h-24 rounded-full flex items-center justify-center text-4xl shadow-lg ring-4 ring-pink-500/20",children:""})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-4xl font-black text-white tracking-tight",children:"YOU ARE ABSOLUTELY INCREDIBLE!"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-gray-300 text-lg",children:["From the bottom of our digital hearts, ",s.jsx("span",{className:"text-pink-400 font-bold",children:"THANK YOU!"})]}),s.jsx("p",{className:"text-gray-400 leading-relaxed max-w-xs mx-auto text-sm italic",children:`"Your generosity fuels the spark of creativity. You're not just a donor; you're a patron of the Multiverse."`})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[s.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black tracking-[0.2em]",children:"Honorary Title Acquired"}),s.jsx("div",{className:"bg-indigo-500/10 border border-indigo-500/30 py-2 px-4 rounded-full inline-block mx-auto text-indigo-300 font-bold text-sm",children:"Guardian of the Forge"})]}),s.jsx("button",{onClick:e,className:"w-full py-4 bg-gray-800 hover:bg-gray-700 text-white rounded-xl font-bold transition-all border border-gray-700 mt-4",children:"Continue Forging"})]})]}),r!=="success"&&s.jsx("div",{className:"bg-gray-950/80 p-4 border-t border-gray-800 text-center flex-shrink-0",children:s.jsxs("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Secure Payments by Stripe"]})})]})]}):null},Aoe=()=>{const{currentUser:t,userProfile:e}=Mt(),{addToast:r}=_r(),{cards:n,refresh:i}=Gs(),{decks:a,loading:l}=Pd(),[d,u]=y.useState(!1),[h,p]=y.useState(!1),[m,x]=y.useState(!1),[b,v]=y.useState(!1),[w,k]=y.useState(!1),[_,T]=y.useState(!1),A=on(),I=async()=>{T(!0);try{await Pe.post("/api/sync/prices"),await i()}catch(E){console.error("Sync failed",E)}finally{T(!1)}},O=y.useMemo(()=>{if(!n||!a)return{totalCards:0,uniqueDecks:0,value:0,topColor:"N/A"};const E=new Set(n.map(V=>V.scryfall_id||V.id)),R=n.filter(V=>!V.is_wishlist),$=n.filter(V=>V.is_wishlist);let B=R.reduce((V,X)=>V+(X.count||1),0),C=$.reduce((V,X)=>V+(X.count||1),0),U=B;a.forEach(V=>{if(V.commander){const X=V.commander.id||V.commander.scryfall_id;X&&!E.has(X)&&(B++,E.add(X))}if(V.commander_partner){const X=V.commander_partner.id||V.commander_partner.scryfall_id;X&&!E.has(X)&&(B++,E.add(X))}});const L=n.reduce((V,X)=>{const Z=parseFloat(X.prices?.usd||0);return V+Z*(X.count||1)},0),q={};n.forEach(V=>{const X=V.color_identity||[],Z={W:0,U:1,B:2,R:3,G:4},G=X.filter(Y=>Z[Y]!==void 0).sort((Y,ne)=>Z[Y]-Z[ne]).join(""),F=G.length===0?"C":G;q[F]=(q[F]||0)+(V.count||1)});const K=Object.entries(q);let W=Fj("C");if(K.length>0){const[V,X]=K.reduce((Z,G)=>G[1]>Z[1]?G:Z);W=Fj(V)}return{totalCards:B,collectionCount:U,wishlistCount:C,uniqueDecks:a.length,value:L.toLocaleString("en-US",{style:"currency",currency:"USD"}),topColor:W}},[n,a]),M=y.useMemo(()=>a?[...a].reverse().slice(0,3):[],[a]);return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 space-y-12 animate-fade-in",children:[s.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"Dashboard"}),s.jsxs("p",{className:"text-gray-400",children:["Welcome back, ",s.jsx("span",{className:"text-indigo-400 font-bold",children:t?t.displayName||t.email:"Guest"}),"."]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(vw,{to:"/collection",title:"Total Cards",value:O.totalCards,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"blue"}),s.jsx(vw,{to:"/decks",title:"Unique Decks",value:O.uniqueDecks,icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",color:"purple"}),s.jsx(vw,{title:"Collection Value",value:O.value,icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"green",children:s.jsx("button",{onClick:I,disabled:_,className:`absolute top-4 right-4 p-1.5 rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-all ${_?"animate-spin":""}`,title:"Update Prices from Scryfall",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),s.jsxs("div",{className:"bg-gray-900/60 border border-gray-800 rounded-2xl p-5 backdrop-blur-sm hover:border-gray-700 transition-colors group relative overflow-hidden",children:[s.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 opacity-10 rounded-bl-full ${O.topColor.bg}`}),s.jsxs("div",{className:"flex flex-col h-full justify-between relative z-10",children:[s.jsx("div",{className:"flex gap-1 mb-2",children:O.topColor.pips?.map((E,R)=>s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center font-bold text-xs ring-1 ring-white/10 shadow-sm ${E==="W"?"bg-yellow-200 text-yellow-900":E==="U"?"bg-blue-300 text-blue-900":E==="B"?"bg-gray-800 text-gray-200":E==="R"?"bg-red-400 text-red-900":E==="G"?"bg-green-400 text-green-900":"bg-gray-400 text-gray-900"}`,children:E},R))}),s.jsxs("div",{children:[s.jsx("div",{className:`text-xl font-black tracking-tight ${O.topColor.color||"text-white"}`,children:O.topColor.name}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:"Top Color Identity"}),s.jsxs("div",{className:"text-[10px] text-gray-400 italic mt-2 line-clamp-2 opacity-70",children:['"',O.topColor.flavor,'"']})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[s.jsx(zm,{title:"New Deck",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),color:"from-indigo-600 to-purple-600",onClick:()=>{const E=Gr[e?.subscription_tier||"free"].limits.decks,R=O.uniqueDecks;if(E!==1/0&&R>=E){r(`Deck limit reached (${R}/${E}). Upgrade to create more!`,"error");return}A("/decks/new")}}),s.jsx(zm,{title:"Add Cards",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-blue-600 to-cyan-600",onClick:()=>A("/collection")}),s.jsx(zm,{title:"Browse Sets",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"from-green-600 to-emerald-600",onClick:()=>A("/sets")}),s.jsx(zm,{title:"Wishlist",icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),color:"from-pink-600 to-rose-600",onClick:()=>A("/collection?wishlist=true")}),s.jsx(Hae,{})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-8 backdrop-blur-md shadow-xl",children:[s.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),"Recent Decks"]}),l?s.jsx("div",{className:"text-gray-400 text-center py-8",children:"Loading decks..."}):M.length>0?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(E=>{const R=C=>C?C.image_uris?.art_crop?C.image_uris.art_crop:C.card_faces?.[0]?.image_uris?.art_crop?C.card_faces[0].image_uris.art_crop:null:null,$=R(E.commander),B=R(E.commander_partner);return s.jsxs("div",{onClick:()=>A(`/decks/${E.id}`),className:"group relative aspect-[63/88] rounded-2xl overflow-hidden cursor-pointer shadow-lg hover:shadow-indigo-500/30 transition-all hover:-translate-y-2 border border-white/5 bg-gray-900",children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950",children:E.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[s.jsx("img",{src:$||"https://placehold.co/400x600?text=?",alt:E.commander?.name,className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"})]}),s.jsxs("div",{className:"w-1/2 h-full relative",children:[s.jsx("img",{src:B||"https://placehold.co/400x600?text=?",alt:E.commander_partner?.name,className:"w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"})]})]}):s.jsx("img",{src:$||"https://placehold.co/400x600?text=?",alt:E.name,className:"absolute inset-0 w-full h-full object-cover opacity-90 group-hover:scale-110 transition-transform duration-700"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/40 to-transparent opacity-90"}),s.jsxs("div",{className:"absolute inset-0 p-5 flex flex-col justify-end",children:[s.jsxs("div",{className:"mb-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 rounded text-[10px] font-bold uppercase tracking-wider backdrop-blur-sm self-start",children:E.format||"Commander"}),s.jsx("div",{className:"flex gap-1 bg-black/40 backdrop-blur-sm rounded-full px-1.5 py-0.5 border border-white/10 self-start",children:(()=>{const C=E?.commander?.color_identity||[],U=E?.commander_partner?.color_identity||[],L=[...new Set([...C,...U])];return L.length===0&&L.push("C"),L.map(q=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${q}.svg`,alt:q,className:"w-3.5 h-3.5 shadow-sm"},q))})()})]}),(E.ai_blueprint?.grade?.powerLevel>0||E.aiBlueprint?.grade?.powerLevel>0)&&s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsxs("div",{className:"flex items-center gap-1 bg-indigo-600/30 border border-indigo-500/40 rounded px-1.5 py-0.5 backdrop-blur-sm",children:[s.jsx("span",{className:"text-[8px] font-black text-indigo-300 uppercase",children:"B"}),s.jsx("span",{className:"text-[10px] font-bold text-white",children:E.ai_blueprint?.grade?.commanderBracket||E.aiBlueprint?.grade?.commanderBracket})]}),s.jsxs("div",{className:"flex items-center gap-1 bg-emerald-600/30 border border-emerald-500/40 rounded px-1.5 py-0.5 backdrop-blur-sm",children:[s.jsx("span",{className:"text-[8px] font-black text-emerald-300 uppercase italic",children:"P"}),s.jsx("span",{className:"text-[10px] font-bold text-white",children:Number(E.ai_blueprint?.grade?.powerLevel||E.aiBlueprint?.grade?.powerLevel).toFixed(1)})]})]})]}),s.jsx("h3",{className:"text-xl font-bold text-white leading-tight mb-1 group-hover:text-indigo-400 transition-colors line-clamp-2",children:E.name}),s.jsx("p",{className:"text-sm text-gray-400 line-clamp-1",children:E.commander_partner?`${E.commander.name} & ${E.commander_partner.name}`:E.commander?.name||"Unknown Commander"})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex justify-between items-center text-xs text-gray-500 font-mono",children:[s.jsxs("span",{children:[E.card_count||0," cards"]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-white transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]},E.id)})}):s.jsxs("div",{className:"text-center py-12 bg-gray-900/30 rounded-2xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500",children:"No decks forged yet."}),s.jsx(_t,{to:"/decks/new",className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 inline-block",children:"Create your first deck "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-red-900/10 border border-red-500/20 rounded-3xl p-6 backdrop-blur-md",children:[s.jsxs("h2",{className:"font-bold text-white mb-2 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"System Status"]}),s.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Found a bug or have a feature request? Help us improve the Forge."}),s.jsxs("button",{onClick:()=>u(!0),className:"w-full py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl shadow-lg shadow-red-900/20 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Report Issue"]})]}),s.jsx(zae,{tier:Gr[e?.subscription_tier||"free"],counts:{decks:O.uniqueDecks,collection:O.collectionCount,wishlist:O.wishlistCount}}),s.jsx("div",{className:"h-full relative group",children:Yt(e?.subscription_tier).features.pods?s.jsx(qae,{}):s.jsxs("div",{className:"h-full bg-gray-900/60 border border-gray-800 rounded-3xl p-6 backdrop-blur-sm flex flex-col items-center justify-center text-center opacity-75 hover:opacity-100 transition-opacity",children:[s.jsx("div",{className:"p-3 bg-purple-500/20 rounded-full mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"My Pods"}),s.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Create private playgroups and share collections with friends."}),s.jsx(_t,{to:"/settings/membership",className:"text-xs font-bold uppercase tracking-widest text-purple-400 hover:text-white border border-purple-500/30 px-4 py-2 rounded-lg hover:bg-purple-500/20 transition-all",children:"Unlock on Wizard Tier"})]})})]})]}),s.jsxs("div",{className:"space-y-6 flex flex-col h-full",children:[s.jsx(Kae,{}),s.jsx(Fae,{}),s.jsxs("div",{className:"bg-gray-900/40 border border-white/5 rounded-3xl p-6 backdrop-blur-md",children:[s.jsxs("h2",{className:"font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"p-1.5 bg-blue-500/10 rounded-lg text-blue-400",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),"Guides & Resources"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>x(!0),className:"w-full text-left p-3 rounded-xl bg-gray-950/50 hover:bg-gray-800 border border-white/5 hover:border-indigo-500/30 transition-all group flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-lg text-indigo-400 group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-gray-200 group-hover:text-white",children:"Smart Binders"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Automate your collection"})]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-indigo-400 ml-auto transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsxs("button",{onClick:()=>v(!0),className:"w-full text-left p-3 rounded-xl border transition-all group flex items-center gap-3 bg-gray-950/50 hover:bg-gray-800 border-white/5 hover:border-purple-500/30",children:[s.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg text-purple-400 group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-gray-200 group-hover:text-white",children:"Pods & Sharing"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Manage permissions"})]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-purple-400 ml-auto transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsxs("button",{onClick:()=>k(!0),className:"w-full text-left p-3 rounded-xl border transition-all group flex items-center gap-3 bg-gray-950/50 hover:bg-gray-800 border-white/5 hover:border-green-500/30",children:[s.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg text-green-400 group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-gray-200 group-hover:text-white",children:"Audit & Verification"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Maintain a perfect collection"})]}),s.jsx("svg",{className:"w-4 h-4 text-gray-600 group-hover:text-green-400 ml-auto transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),s.jsx("div",{className:"flex-1 min-h-[300px]",children:s.jsx(Gae,{})})]})]})]}),s.jsx(Uae,{isOpen:d,onClose:()=>u(!1)}),s.jsx(Eoe,{isOpen:h,onClose:()=>p(!1)}),s.jsx(I4,{isOpen:m,onClose:()=>x(!1)}),s.jsx(eI,{isOpen:b,onClose:()=>v(!1)}),s.jsx(Xf,{isOpen:w,onClose:()=>k(!1)})]})},vw=({title:t,value:e,icon:r,color:n,to:i,children:a})=>{const l=s.jsxs("div",{className:"bg-gray-900/60 border border-gray-800 rounded-2xl p-5 backdrop-blur-sm hover:border-gray-700 transition-colors group relative h-full",children:[a,s.jsx("div",{className:"flex justify-between items-start mb-4",children:s.jsx("div",{className:`p-2.5 rounded-xl bg-gray-950 text-${n}-400 group-hover:scale-110 transition-transform shadow-inner`,children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r})})})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-3xl font-black text-white tracking-tight",children:e}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1",children:t})]})]});return i?s.jsx(_t,{to:i,className:"block transition-transform active:scale-95",children:l}):l},zm=({title:t,icon:e,color:r,onClick:n})=>s.jsxs("button",{onClick:n,className:"group relative overflow-hidden rounded-2xl p-4 md:p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl border border-white/5",children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r} opacity-0 group-hover:opacity-10 transition-opacity duration-300`}),s.jsx("div",{className:"absolute inset-0 bg-gray-800/50 group-hover:opacity-0 transition-opacity"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-3 text-gray-300 group-hover:text-white transition-colors",children:[s.jsx("div",{className:"p-3 bg-gray-900/50 rounded-full backdrop-blur-sm group-hover:scale-110 transition-transform group-hover:bg-white/20",children:e}),s.jsx("span",{className:"font-bold text-sm tracking-wide",children:t})]})]}),T9=[{name:"Limits",items:[{label:"Collection size",type:"limit",key:"collection"},{label:"Wishlist size",type:"limit",key:"wishlist"},{label:"Deck count",type:"limit",key:"decks"},{label:"Pod Count",type:"limit",key:"pods"}]},{name:"Collection",items:[{label:"Organization customization",type:"static",value:!0},{label:"Tags",type:"static",value:!0},{label:"Bulk Import",type:"static",value:!0},{label:"Manual Price Sync",type:"static",value:!0},{label:"Smart Binders",type:"feature",key:"smartBinders"},{label:"Binders",type:"feature",key:"binders"},{label:"Collection Audit",type:"feature",key:"collectionAudit"},{label:"Snap Version (Scanner)",type:"feature",key:"snapScan"},{label:"Quick Scan (Batch)",type:"feature",key:"batchScan"}]},{name:"Wishlist",items:[{label:"Mass Deletion",type:"static",value:!0},{label:"Precon Addition",type:"static",value:!0}]},{name:"Decks",items:[{label:"Public/Private View",type:"static",value:!0},{label:"Deck Stats",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0},{label:"Mockup Deck",type:"feature",key:"mockupDeck"},{label:"AI Strategy",type:"feature",key:"aiStrategy"},{label:"Deck Doctor",type:"feature",key:"deckDoctor"},{label:"Deck Suggestions",type:"feature",key:"deckSuggestions"},{label:"Deck Audit",type:"feature",key:"deckAudit"},{label:"Shared edit",type:"feature",key:"sharedEdit"}]},{name:"Precons",items:[{label:"Add to collection",type:"static",value:!0},{label:"Add to wishlist",type:"static",value:!0},{label:"Buy on TCGPlayer",type:"static",value:!0}]},{name:"Sets",items:[{label:"Quick Add",type:"static",value:!0},{label:"Set Audit",type:"feature",key:"setAudit"}]},{name:"AI",items:[{label:"Chatbot",type:"static",value:!0},{label:"Default Oracle",type:"static",value:!0},{label:"Custom AI Persona",type:"feature",key:"customAiPersona"}]},{name:"Settings",items:[{label:"Collection Backup",type:"feature",key:"collectionBackup"},{label:"Deck Backup",type:"feature",key:"deckBackup"},{label:"Pods / Linking",type:"limit_check",key:"pods"}]}],Toe=(t,e)=>{const r=Gr[t],n=e?Gr[e]:null;if(!n)return t===tt.FREE?{limits:[{label:`Collection: ${r.limits.collection}`,type:"limit"},{label:`Wishlist: ${r.limits.wishlist}`,type:"limit"},{label:`Decks: ${r.limits.decks}`,type:"limit"},{label:"Pods (Shared Accounts): 0",type:"limit"}],features:[{label:"AI Chatbot",type:"feature"}]}:{limits:[],features:[]};const i=[],a=[];r.limits.collection>n.limits.collection&&i.push({label:`Collection: ${r.limits.collection===1/0?"Unlimited":r.limits.collection}`,type:"limit"}),r.limits.wishlist>n.limits.wishlist&&i.push({label:`Wishlist: ${r.limits.wishlist===1/0?"Unlimited":r.limits.wishlist}`,type:"limit"}),r.limits.decks>n.limits.decks&&i.push({label:`Decks: ${r.limits.decks===1/0?"Unlimited":r.limits.decks}`,type:"limit"});const l=t===tt.TIER_3,d=[tt.TIER_1,tt.TIER_2].includes(t);return(r.limits.pods>n.limits.pods||d)&&i.push({label:`Pods (Shared Accounts): ${r.limits.pods===1/0?"Unlimited":r.limits.pods}`,type:"limit",bold:l,tooltip:"Pods allow you to link accounts (friends/family) to share your collection and deck building tools."}),Object.keys(r.features).forEach(u=>{if(r.features[u]&&!n.features[u]){const h=T9.flatMap(p=>p.items).find(p=>p.key===u);a.push({label:h?h.label:u.replace(/([A-Z])/g," $1").trim(),type:"feature"})}}),{limits:i,features:a}},J6=({label:t,check:e,highlight:r,bold:n,tooltip:i})=>s.jsxs("div",{className:`flex items-start text-sm ${e?r?"text-white font-medium":"text-gray-300":"text-gray-500"} ${n?"font-bold":""}`,title:i,children:[e?s.jsx(lc,{className:`w-4 h-4 mr-2 mt-0.5 flex-shrink-0 ${r?"text-purple-400":"text-green-500"}`}):s.jsx(Yf,{className:"w-4 h-4 mr-2 text-red-900/50 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:t})]}),n5=({billingInterval:t,setBillingInterval:e,onSubscribe:r,isLoading:n,currentTier:i,showIntervalSelector:a=!0})=>{const l=Object.values(tt),d=u=>{const h=Gr[u];return!h.prices.monthly&&!h.prices.biannual&&!h.prices.yearly?"Free":{[tt.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[tt.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[tt.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[tt.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[tt.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[u]?.[t]||"Free"};return s.jsxs("div",{className:"w-full",children:[a&&s.jsx("div",{className:"flex justify-center mb-8",children:s.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(u=>s.jsx("button",{onClick:()=>e(u),className:`px-4 py-2 rounded-lg transition-all capitalize ${t===u?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:u==="biannual"?"6 Months":u},u))})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:l.map((u,h)=>{const p=Gr[u],m=i===u,x=h>0?l[h-1]:null,{limits:b,features:v}=Toe(u,x);return s.jsxs("div",{className:`relative flex flex-col p-5 rounded-2xl border ${m?"border-purple-500 shadow-[0_0_20px_rgba(168,85,247,0.3)]":"border-gray-700"} bg-gray-800/50 backdrop-blur-sm hover:border-purple-500/50 transition-all duration-300`,children:[m&&s.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-white text-[10px] px-2 py-0.5 rounded-full uppercase tracking-wider font-bold shadow-lg z-10",children:"Current"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-100",children:p.name}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-2xl font-bold text-white",children:d(u)}),s.jsxs("span",{className:"text-sm text-gray-500",children:["/",t==="monthly"?"mo":t==="biannual"?"6mo":"yr"]})]}),s.jsx("p",{className:"text-sm text-gray-400 mt-2 min-h-[48px]",children:p.description})]}),s.jsx("button",{onClick:()=>r(u),disabled:n||m,className:`w-full py-2 rounded-lg font-bold text-sm mb-6 transition-all ${m?"bg-gray-700 cursor-default text-gray-400":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white shadow-lg"}`,children:n?"...":m?"Active":u===tt.FREE?"Select":"Subscribe"}),s.jsxs("div",{className:"space-y-3 flex-grow",children:[(b.length>0||v.length>0)&&s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] uppercase tracking-wider text-purple-400 font-bold mb-2 border-b border-purple-500/30 pb-1",children:u===tt.FREE?"Includes:":"Adds / Increases:"}),b.map((w,k)=>s.jsx(J6,{label:w.label,check:!0,highlight:!0,bold:w.bold,tooltip:w.tooltip},`limit-${k}`)),b.length>0&&v.length>0&&s.jsx("div",{className:"my-3 border-t border-gray-700"}),v.map((w,k)=>s.jsx(J6,{label:w.label,check:!0,highlight:!0,bold:w.bold,tooltip:w.tooltip},`feat-${k}`))]}),b.length===0&&v.length===0&&u!==tt.FREE&&s.jsx("p",{className:"text-xs text-gray-500 italic",children:"Includes all previous features"})]})]},u)})})]})},Ooe=()=>{const{currentUser:t,userProfile:e}=Mt(),r=on(),{addToast:n}=_r(),[i,a]=y.useState("monthly"),[l,d]=y.useState(!1),[u,h]=y.useState("cards"),[p,m]=y.useState(null),[x,b]=y.useState(null),v=async A=>{if(!t){r("/login");return}if(A===tt.FREE){n("You are already on the free tier.","info");return}d(!0);try{const I=await Pe.post("/api/payments/create-checkout-session",{tierId:A,interval:i});I.url&&(window.location.href=I.url)}catch(I){console.error("Subscription error:",I),n("Failed to start checkout. Please try again.","error")}finally{d(!1)}},w=A=>{const I=Gr[A];return!I.prices.monthly&&!I.prices.biannual&&!I.prices.yearly?"Free":{[tt.TIER_1]:{monthly:"$2.99",biannual:"$14.99",yearly:"$29.99"},[tt.TIER_2]:{monthly:"$4.99",biannual:"$24.99",yearly:"$49.99"},[tt.TIER_3]:{monthly:"$9.99",biannual:"$49.99",yearly:"$99.99"},[tt.TIER_4]:{monthly:"$14.99",biannual:"$74.99",yearly:"$149.99"},[tt.TIER_5]:{monthly:"$19.99",biannual:"$99.99",yearly:"$199.99"}}[A]?.[i]||"Free"},k=()=>i==="biannual"?s.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"1 Month Free"}):i==="yearly"?s.jsx("span",{className:"text-green-400 text-xl font-bold ml-2",children:"2 Months Free"}):null,_=(A,I)=>{const O=Gr[I];if(A.type==="static")return s.jsx(lc,{className:"w-5 h-5 text-green-500 mx-auto"});if(A.type==="limit"){const M=O.limits[A.key];return M===1/0?"Unlimited":M}if(A.type==="limit_check"){const M=O.limits[A.key];return M>0||M===1/0?s.jsx(lc,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx(Yf,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"})}return A.type==="feature"?O.features[A.key]?s.jsx(lc,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx(Yf,{className:"w-4 h-4 text-gray-700 mx-auto opacity-30"}):"-"},T=Object.values(tt);return s.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-4 md:p-8",children:[s.jsxs("div",{className:"max-w-[1800px] mx-auto",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-600",children:"Choose Your Path"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto mb-8",children:"Comparing plans to find the perfect fit for your magic journey."}),s.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6",children:[s.jsx("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:["monthly","biannual","yearly"].map(A=>s.jsx("button",{onClick:()=>a(A),className:`px-4 py-2 rounded-lg transition-all capitalize ${i===A?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:A==="biannual"?"6 Months":A},A))}),s.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl",children:[s.jsxs("button",{onClick:()=>h("cards"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${u==="cards"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[s.jsx(PX,{className:"w-4 h-4"})," Cards"]}),s.jsxs("button",{onClick:()=>h("table"),className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${u==="table"?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[s.jsx(zX,{className:"w-4 h-4"})," Compare All"]})]})]}),s.jsx("div",{className:"mt-4 h-8",children:k()})]}),u==="cards"?s.jsx(n5,{billingInterval:i,setBillingInterval:a,onSubscribe:v,isLoading:l,currentTier:e?.subscription_tier}):s.jsx("div",{className:"overflow-x-auto pb-12 pt-12 animate-in fade-in duration-300",children:s.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-4 w-[250px] sticky left-0 z-20 bg-gray-900 border-b border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]",children:s.jsx("div",{className:"text-xl font-bold text-gray-500",children:"Features"})}),T.map((A,I)=>{const O=Gr[A],M=e?.subscription_tier===A,E=x===I;return s.jsxs("th",{className:`p-4 min-w-[180px] text-center relative transition-colors duration-300 border-b border-gray-800
                                                ${E?"bg-gray-800/80":"bg-gray-900"}
                                                ${M?"ring-2 ring-purple-500 ring-inset bg-purple-900/10":""}
                                            `,onMouseEnter:()=>b(I),onMouseLeave:()=>b(null),children:[M&&s.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-purple-600 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Current"}),s.jsx("h3",{className:`text-xl font-bold mb-1 ${M?"text-purple-300":"text-gray-200"}`,children:O.name}),s.jsxs("div",{className:"text-2xl font-bold mb-2",children:[w(A),s.jsxs("span",{className:"text-xs text-gray-500 font-normal",children:["/",i==="monthly"?"mo":i==="biannual"?"6mo":"yr"]})]}),s.jsx("button",{onClick:()=>v(A),disabled:l||M,className:`w-full py-2 rounded text-sm font-bold transition-all ${M?"bg-gray-800 text-gray-500 cursor-default":"bg-purple-600 hover:bg-purple-500 text-white shadow-lg shadow-purple-900/20"}`,children:M?"Active":A===tt.FREE?"Default":"Subscribe"})]},A)})]})}),s.jsx("tbody",{children:T9.map((A,I)=>s.jsx(Ge.Fragment,{children:A.items.map((O,M)=>{const E=`${I}-${M}`,R=p===E;return s.jsxs("tr",{className:`transition-colors duration-200 border-b border-gray-800/50
                                                    ${R?"bg-gray-800/60":"hover:bg-gray-800/30"}
                                                `,onMouseEnter:()=>m(E),onMouseLeave:()=>m(null),children:[s.jsx("td",{className:`p-3 pl-4 text-sm font-medium text-gray-300 sticky left-0 z-10
                                                    bg-gray-900 transition-colors duration-200 border-r border-gray-800 shadow-[4px_0_24px_rgba(0,0,0,0.4)]
                                                    ${R?"text-white bg-gray-800":""}
                                                `,children:A.name==="Limits"||A.name==="Settings"||A.name==="AI"?O.label:`${A.name} - ${O.label}`}),T.map(($,B)=>{const C=x===B,U=R&&C;return s.jsx("td",{className:`p-3 text-center text-sm transition-colors duration-200
                                                                ${C?"bg-gray-800/40":""}
                                                                ${U?"bg-purple-500/10":""}
                                                            `,onMouseEnter:()=>b(B),onMouseLeave:()=>b(null),children:_(O,$)},$)})]},O.label)})},A.name))})]})})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("p",{className:"text-gray-500 text-sm",children:"* Prices and limits subject to change. VAT may apply."})})]})},Moe=()=>{const[t,e]=y.useState(!0),[r,n]=y.useState(""),[i,a]=y.useState(""),[l,d]=y.useState(""),[u,h]=y.useState(""),[p,m]=y.useState(""),[x,b]=y.useState(""),[v,w]=y.useState(!1),[k,_]=y.useState(!1),[T,A]=y.useState(""),{login:I,signup:O,loginWithGoogle:M,resetPassword:E}=Mt(),R=on(),$=async C=>{C.preventDefault();try{if(A(""),v){await E(r),_(!0);return}if(t)await I(r,i),R("/dashboard");else{if(i!==l)return A("Passwords do not match");if(i.length<6)return A("Password must be at least 6 characters");await O(r,i,{username:u,first_name:p,last_name:x}),R("/onboarding")}}catch(U){A("Failed to "+(t?"log in":"sign up")+": "+U.message)}},B=async()=>{try{A(""),await M(),R("/dashboard")}catch(C){A("Failed to log in with Google: "+C.message)}};return s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8 relative",children:[s.jsx("div",{className:"absolute inset-0 z-0",children:s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-50"})}),s.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10 bg-black/60 p-10 rounded-2xl backdrop-blur-md border border-white/10 shadow-2xl",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:v?"Reset Password":t?"Sign in to MTG-Forge":"Create an Account"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-400",children:v?"Enter your email to receive a reset link":t?"Access your collection and decks anywhere":"Start your journey with MTG-Forge"})]}),k&&s.jsx("div",{className:"bg-green-500/20 border border-green-500 text-green-100 p-3 rounded text-sm text-center",children:"Reset link sent! Check your inbox."}),T&&s.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 p-3 rounded text-sm text-center",children:T}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:$,children:[s.jsxs("div",{className:"space-y-4",children:[!t&&!v&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"First Name",value:p,onChange:C=>m(C.target.value)})}),s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Last Name",value:x,onChange:C=>b(C.target.value)})})]}),!t&&!v&&s.jsx("div",{children:s.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Username",value:u,onChange:C=>h(C.target.value)})}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:r,onChange:C=>n(C.target.value)})]}),!v&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:t?"current-password":"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:i,onChange:C=>a(C.target.value)})]}),!t&&!v&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),s.jsx("input",{id:"confirm-password",name:"confirmConnectPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-700 placeholder-gray-500 text-white bg-gray-800 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:l,onChange:C=>d(C.target.value)})]})]}),t&&!v&&s.jsx("div",{className:"flex items-center justify-end",children:s.jsx("button",{type:"button",onClick:()=>w(!0),className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:"Forgot your password?"})}),s.jsx("div",{children:s.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:v?"Send Reset Link":t?"Sign in with Email":"Sign Up with Email"})})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"button",onClick:()=>{v?(w(!1),_(!1)):e(!t),A("")},className:"text-sm text-indigo-400 hover:text-indigo-300 transition-colors",children:v?"Back to Sign In":t?"Don't have an account? Sign Up":"Already have an account? Sign In"})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-600"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-transparent text-gray-400 uppercase font-bold bg-[#1a1c23]",children:"Or continue with"})})]}),s.jsxs("button",{onClick:B,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),s.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),s.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),s.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),t?"Sign in with Google":"Sign up with Google"]})]})]})};function O9(){const[t,e]=y.useState([]),[r,n]=y.useState(!0),{currentUser:i}=Mt(),a=async()=>{if(i){n(!0);try{const l=await Pe.getBinders();e(l)}catch(l){console.error("[useBinders] Failed to fetch",l)}finally{n(!1)}}};return y.useEffect(()=>{a()},[i]),{binders:t,loading:r,refreshBinders:a}}const _g=({options:t=[],selected:e=[],onChange:r,placeholder:n="Select...",label:i})=>{const[a,l]=y.useState(!1),[d,u]=y.useState(""),h=y.useRef(null);y.useEffect(()=>{const x=b=>{h.current&&!h.current.contains(b.target)&&l(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=t.filter(x=>x.label.toLowerCase().includes(d.toLowerCase())),m=x=>{const b=e.includes(x)?e.filter(v=>v!==x):[...e,x];r(b)};return s.jsxs("div",{className:"relative",ref:h,children:[i&&s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:i}),s.jsxs("button",{type:"button",onClick:()=>l(!a),className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 px-3 text-left text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent flex justify-between items-center",children:[s.jsx("span",{className:"truncate",children:e.length===0?n:`${e.length} selected`}),s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&s.jsxs("div",{className:"absolute z-50 mt-2 w-full bg-gray-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl max-h-68 flex flex-col overflow-hidden animate-fade-in-down",children:[s.jsx("div",{className:"p-3 border-b border-white/5",children:s.jsx("input",{type:"text",placeholder:"Filter options...",className:"w-full bg-gray-950/50 border border-gray-800 rounded-xl px-3 py-2 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 placeholder-gray-600",value:d,onChange:x=>u(x.target.value),autoFocus:!0})}),s.jsx("div",{className:"overflow-y-auto flex-1 p-2 custom-scrollbar",children:p.length===0?s.jsx("div",{className:"text-gray-500 text-[10px] font-bold uppercase tracking-widest p-4 text-center",children:"No results found"}):p.map(x=>s.jsxs("div",{onClick:()=>m(x.value),className:`
                                        flex items-center gap-3 px-3 py-2 rounded-xl cursor-pointer text-xs font-medium transition-all
                                        ${e.includes(x.value)?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/40":"text-gray-400 hover:bg-white/5 hover:text-white"}
                                    `,children:[s.jsx("div",{className:`w-4 h-4 rounded-md border transition-all flex items-center justify-center ${e.includes(x.value)?"bg-white border-white scale-110":"border-gray-700 bg-gray-950/50"}`,children:e.includes(x.value)&&s.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:"truncate",children:x.label})]},x.value))})]})]})},M9=()=>s.jsx("div",{className:"relative aspect-[2.5/3.5] bg-gray-800 rounded-lg overflow-hidden border border-gray-700 animate-pulse",children:s.jsx("div",{className:"absolute inset-0 bg-gray-700/50"})}),Yu=({card:t,availableFoils:e,onRemove:r,showQuantity:n=!0,onClick:i,decks:a=[],ownerName:l,currentUser:d,showOwnerTag:u=!1,hideDeckTag:h=!1,hideOwnerTag:p=!1,selectMode:m=!1,isSelected:x=!1,onToggleSelect:b})=>{const[v,w]=y.useState(!1),{openCardModal:k}=L0(),_=a?.find(B=>B.id===t.deck_id)?.name,T=l||t.owner_username||(d&&(t.owner_id===d.id||t.user_id===d.id)?d.username||"ME":null),A=B=>parseFloat(t.prices?.[B]||t.data?.prices?.[B])||0,I=(B,C=0)=>{if(!B)return"https://placehold.co/250x350?text=No+Image";const U=B.data||B;return U.card_faces&&U.card_faces.length>1&&U.card_faces[C]?.image_uris?.normal?U.card_faces[C].image_uris.normal:U.image_uris?.normal||B.image_uri||"https://placehold.co/250x350?text=No+Image"},O=t.data?.card_faces?.length>1&&t.data?.card_faces?.[1]?.image_uris||t.card_faces?.length>1&&t.card_faces?.[1]?.image_uris,M=I(t,0),E=O?I(t,1):null,R=t.countInDeck||t.quantity||t.count||1,$=B=>{if(B.stopPropagation(),m&&b){b(t.id);return}i?i(t):k(t)};return s.jsx("div",{className:`relative group perspective-1000 h-full w-full aspect-[2.5/3.5] min-h-[200px] cursor-pointer ${x?"ring-4 ring-indigo-500 rounded-xl":""}`,onClick:$,children:s.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${v?"rotate-y-180":""}`,children:[s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx("img",{src:M,alt:t.name,className:"w-full h-full object-cover",loading:"lazy"}),n&&R>1&&s.jsxs("div",{className:"absolute top-1.5 right-1.5 bg-black/80 text-white text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-sm z-20",children:["x",R]}),!h&&_&&s.jsxs("div",{className:"absolute top-[3.75rem] left-1.5 max-w-[80%] bg-indigo-600/90 text-white text-[9px] font-bold px-2 py-0.5 rounded shadow-lg z-20 backdrop-blur-md border border-indigo-400/50 truncate uppercase tracking-tight",title:`In deck: ${_}`,children:[" ",_]}),!p&&u&&T&&s.jsxs("div",{className:`absolute ${_?"top-[5.25rem]":"top-[3.75rem]"} left-1.5 bg-gray-950/90 text-white text-[11px] font-black px-2 py-0.5 rounded border border-white/20 shadow-xl z-20 backdrop-blur-md uppercase tracking-wider`,children:[" ",T]}),t.finish==="foil"?s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-yellow-500/80 text-yellow-100 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-300/50",children:""}):t.is_wishlist?s.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-orange-600/90 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-orange-400/50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"WISH"]}):e?.has(t.name)&&s.jsx("div",{className:"absolute top-1.5 left-1.5 bg-gray-700/90 text-yellow-400 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-md z-20 backdrop-blur-sm border border-yellow-500/30 cursor-help",title:"Foil copy available in collection",children:""}),s.jsx("div",{className:"absolute bottom-1.5 left-1.5 right-1.5 bg-black/70 backdrop-blur-md px-2 py-1 rounded border border-white/10 z-20 text-[9px] font-mono flex items-center justify-center",children:s.jsxs("span",{className:t.finish==="foil"?"text-yellow-400":"text-green-400",children:["$",(t.finish==="foil"?A("usd_foil")||A("usd"):A("usd")||A("usd_foil")).toFixed(2)]})}),m&&s.jsx("div",{className:`absolute inset-0 z-40 transition-all duration-200 flex items-center justify-center ${x?"bg-indigo-500/20":"bg-black/40 hover:bg-black/20"}`,children:s.jsx("div",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all scale-110 ${x?"bg-indigo-500 border-indigo-500 text-white":"border-white/50 bg-black/40"}`,children:x&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})})}),!m&&s.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-300 z-30",children:[s.jsx("div",{className:"absolute inset-0 bg-black/20"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/95 to-transparent p-3 pt-6",children:[s.jsx("p",{className:"font-black text-sm text-white leading-tight line-clamp-1 drop-shadow-lg mb-2",children:t.name}),s.jsx("div",{className:"flex items-center gap-2 mb-3",children:s.jsxs("div",{className:`flex items-center gap-1.5 border rounded-lg px-2.5 py-1 backdrop-blur-md ${t.finish==="foil"?"bg-yellow-500/20 border-yellow-500/40":"bg-green-500/20 border-green-500/40"}`,children:[s.jsx("svg",{className:`w-3 h-3 ${t.finish==="foil"?"text-yellow-400":"text-green-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("span",{className:`text-xs font-bold font-mono ${t.finish==="foil"?"text-yellow-400":"text-green-400"}`,children:["$",(t.finish==="foil"?A("usd_foil")||A("usd"):A("usd")||A("usd_foil")).toFixed(2)]})]})}),s.jsxs("div",{className:"flex gap-1.5",children:[s.jsxs("button",{onClick:$,className:"flex-1 bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 text-white font-bold py-2 px-3 rounded-lg transition-all duration-200 flex items-center justify-center gap-1.5 shadow-lg hover:shadow-indigo-500/50 active:scale-95",children:[s.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),s.jsx("span",{className:"text-[10px] uppercase tracking-wider font-black",children:"View"})]}),O&&s.jsx("button",{onClick:B=>{B.stopPropagation(),w(!v)},className:"bg-gray-700/90 hover:bg-gray-600 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-gray-500/30 active:scale-95",title:"Flip",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),r&&s.jsx("button",{onClick:B=>{B.stopPropagation(),r(t.firestoreId||t.id,t.name)},className:"bg-red-600/90 hover:bg-red-500 text-white p-2 rounded-lg transition-all duration-200 shadow-lg hover:shadow-red-500/50 active:scale-95",title:"Remove",children:s.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})]}),O&&s.jsxs("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 rounded-lg overflow-hidden shadow-md bg-gray-950/40 backdrop-blur-md border border-white/5 bg-cover bg-center",style:{backgroundImage:"url('/card-back.jpg')"},children:[s.jsx("img",{src:E,alt:`${t.name} (Back)`,className:"w-full h-full object-cover",loading:"lazy"}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-200 flex flex-col justify-center items-center gap-2 p-2 backdrop-blur-sm z-30",children:[s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"font-bold text-xs text-white line-clamp-2",children:t.name})}),s.jsx("div",{className:"text-indigo-300 text-xs font-bold uppercase tracking-wider bg-indigo-900/50 px-2 py-1 rounded border border-indigo-500/30",children:"Click to Flip"})]})]})]})})},Loe=({cards:t,isMixed:e})=>{const[r,n]=y.useState({key:"name",direction:"asc"}),i=y.useMemo(()=>{let u=[...t];return r.key&&u.sort((h,p)=>{let m=h[r.key],x=p[r.key];return r.key==="price"?(m=parseFloat(h.prices?.usd||0),x=parseFloat(p.prices?.usd||0)):r.key==="type"?(m=h.type_line||"",x=p.type_line||""):r.key==="set"&&(m=h.set_name||"",x=p.set_name||""),m<x?r.direction==="asc"?-1:1:m>x?r.direction==="asc"?1:-1:0}),u},[t,r]),a=u=>{let h="asc";r.key===u&&r.direction==="asc"&&(h="desc"),n({key:u,direction:h})},l=u=>r.key!==u?s.jsx("svg",{className:"w-3 h-3 text-gray-700 opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):r.direction==="asc"?s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):s.jsx("svg",{className:"w-3 h-3 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),d=({label:u,sortKey:h,className:p=""})=>s.jsx("th",{className:`px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group hover:text-white transition-colors select-none ${p}`,onClick:()=>a(h),children:s.jsxs("div",{className:"flex items-center gap-2",children:[u,l(h)]})});return s.jsx("div",{className:"w-full overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[1000px] border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-800",children:[s.jsx(d,{label:"Card Name",sortKey:"name"}),s.jsx(d,{label:"Set",sortKey:"set"}),s.jsx(d,{label:"Type",sortKey:"type"}),s.jsx(d,{label:"Rarity",sortKey:"rarity"}),s.jsx(d,{label:"Market Price",sortKey:"price"}),s.jsx(d,{label:"Paid",sortKey:"price_bought"}),e&&s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Owner"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800/50",children:i.map(u=>s.jsxs("tr",{className:"group hover:bg-gray-800/30 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-10 w-10 flex-shrink-0 relative rounded overflow-hidden mr-4 border border-gray-700 bg-gray-900 group-hover:scale-150 group-hover:z-10 transition-all origin-left",children:s.jsx("img",{className:"h-full w-full object-cover",src:u.image_uri||u.image_uris?.small,alt:""})}),s.jsxs("div",{className:"ml-0",children:[s.jsx("div",{className:"text-sm font-bold text-white group-hover:text-indigo-300 transition-colors",children:u.name}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:["x",u.count]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300 border border-gray-700",children:[s.jsx("svg",{className:"mr-1.5 h-3 w-3 text-indigo-400",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),u.set_name]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 truncate max-w-[200px]",title:u.type_line,children:u.type_line}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`
                                    inline-flex items-center px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide
                                    ${u.rarity==="mythic"?"text-orange-400 bg-orange-900/10 border border-orange-500/20":u.rarity==="rare"?"text-yellow-400 bg-yellow-900/10 border border-yellow-500/20":u.rarity==="uncommon"?"text-blue-400 bg-blue-900/10 border border-blue-500/20":"text-gray-400 bg-gray-800 border border-gray-700"}
                                `,children:u.rarity})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-400 font-mono",children:["$",parseFloat(u.prices?.usd||0).toFixed(2)]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400 font-mono",children:u.price_bought?`$${parseFloat(u.price_bought).toFixed(2)}`:"-"}),e&&s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center gap-2",title:u.owner_username,children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-600 flex items-center justify-center text-white text-[10px] font-bold",children:u.owner_username?u.owner_username[0].toUpperCase():"?"}),s.jsx("span",{className:"text-xs text-gray-400 truncate max-w-[80px]",children:u.owner_username})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-wrap gap-1",children:[(u.tags&&typeof u.tags=="string"?JSON.parse(u.tags):u.tags||[]).map((h,p)=>s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:h},p)),(!u.tags||Array.isArray(u.tags)&&u.tags.length===0)&&s.jsx("span",{className:"text-gray-600 text-xs italic",children:"No tags"})]})})]},u.id||u.firestoreId))})]})})},Roe=({mode:t,onChange:e})=>s.jsxs("div",{className:"bg-gray-900 p-1 rounded-xl flex border border-gray-800",children:[s.jsx("button",{onClick:()=>e("folder"),className:`p-2 rounded-lg transition-all ${t==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Folder Group View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),s.jsx("button",{onClick:()=>e("grid"),className:`p-2 rounded-lg transition-all ${t==="grid"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>e("table"),className:`p-2 rounded-lg transition-all ${t==="table"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,title:"Table List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]}),Poe=({isOpen:t,onClose:e})=>{const{currentUser:r}=Mt(),{addToast:n}=_r(),{refreshCollection:i}=Gs(),[a,l]=y.useState(""),[d,u]=y.useState([]),[h,p]=y.useState(!1),[m,x]=y.useState("input"),[b,v]=y.useState([]),[w,k]=y.useState(""),[_,T]=y.useState(!1),[A,I]=y.useState([]),O=y.useRef(null),M=C=>{const U=C.trim();if(!U)return null;const L=U.split(/[,\t]/).map(X=>X.trim());if(L.length<1)return null;const q=L[0],K=L[1]||null,W=L[2]||null,V=L[3]||null;return{count:1,name:q,set:K,collector_number:W,tag:V,mode:"unified"}},E=async()=>{if(a.trim()){p(!0);try{const U=a.split(`
`).map(M).filter(Boolean),L=await Promise.all(U.map(async q=>{try{let K="";if(q.set&&q.collector_number)K=`https://api.scryfall.com/cards/${q.set.toLowerCase()}/${q.collector_number}`;else{let V=q.name;q.set&&(V+=` set:${q.set}`),K=`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(V)}`}const W=await fetch(K);if(W.ok){const V=await W.json();return{...q,valid:!0,scryfallId:V.id,data:V,image:V.image_uris?.small||V.card_faces?.[0]?.image_uris?.small}}else{if(q.set&&q.collector_number){const V=await fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(q.name)}`);if(V.ok){const X=await V.json();return{...q,valid:!0,scryfallId:X.id,data:X,image:X.image_uris?.small||X.card_faces?.[0]?.image_uris?.small,warning:"Exact match failed, found by name."}}}return{...q,valid:!1}}}catch{return{...q,valid:!1}}}));u(L),x("preview")}catch{n("Failed to parse cards","error")}finally{p(!1)}}},R=C=>{const U=C.target.files[0];if(!U)return;const L=new FileReader;L.onload=q=>{l(q.target.result)},L.readAsText(U)},$=async()=>{T(!0);const C=d.filter(U=>U.valid);try{const U=C.map(K=>{const W=[...b];return K.tag&&!W.includes(K.tag)&&W.push(K.tag),{name:K.data.name,scryfall_id:K.scryfallId,set_code:K.data.set,collector_number:K.data.collector_number,image_uri:K.data.image_uris?.normal||K.data.card_faces?.[0]?.image_uris?.normal,count:K.count,data:K.data,tags:JSON.stringify(W)}}),L=await r.getIdToken();if(!(await fetch("http://localhost:3000/api/collection/batch",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`},body:JSON.stringify({cards:U,mode:"merge"})})).ok)throw new Error("Import failed");I(U),x("success"),i(),n(`Successfully imported ${C.length} cards!`,"success")}catch(U){console.error(U),n("Import failed. Check console.","error")}finally{T(!1)}},B=C=>{C.key==="Enter"&&w.trim()&&(b.includes(w.trim())||v([...b,w.trim()]),k(""))};return t?ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:m==="success"?"Import Complete":"Bulk Import"}),s.jsx("p",{className:"text-gray-400",children:m==="success"?`Successfully added ${A.length} cards to your collection.`:"Import cards from CSV or text list."})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[m==="input"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl text-blue-200 text-sm",children:[s.jsx("p",{className:"font-bold mb-2",children:"Supported Formats:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"CSV (Recommended)"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Black Lotus, LEA, 1, Power 9"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-xs uppercase text-blue-400 mb-1",children:"Text List"}),s.jsxs("code",{className:"block bg-black/30 p-2 rounded text-xs opacity-80",children:["Name, Set, CN, Tag",s.jsx("br",{}),"Sol Ring, CMD, 45, Mana Rock",s.jsx("br",{}),"Command Tower, CMD, , Base"]})]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>O.current.click(),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-lg text-sm font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Upload CSV / Text File"]}),s.jsx("input",{type:"file",ref:O,onChange:R,accept:".csv,.txt",className:"hidden"})]}),s.jsx("textarea",{value:a,onChange:C=>l(C.target.value),placeholder:"Paste your list here...",className:"w-full h-80 bg-gray-800/50 border border-gray-700 text-gray-200 p-4 rounded-xl font-mono focus:ring-2 focus:ring-indigo-500 outline-none resize-none text-sm"})]}),m==="preview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:"Apply Tags to Batch"}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[b.map(C=>s.jsxs("span",{className:"bg-indigo-600 text-white px-2 py-1 rounded text-sm flex items-center gap-1",children:[C,s.jsx("button",{onClick:()=>v(b.filter(U=>U!==C)),className:"hover:text-red-300",children:""})]},C)),s.jsx("input",{type:"text",placeholder:"Type tag & Enter...",value:w,onChange:C=>k(C.target.value),onKeyDown:B,className:"bg-transparent border-none focus:ring-0 text-white placeholder-gray-600 text-sm min-w-[120px]"})]})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Matched Tag"}),s.jsx("th",{className:"p-3 text-right",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:d.map((C,U)=>s.jsxs("tr",{className:C.valid?"":"bg-red-900/10",children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[C.image?s.jsx("img",{src:C.image,className:"w-8 h-8 rounded object-cover",alt:""}):s.jsx("div",{className:"w-8 h-8 bg-gray-800 rounded flex items-center justify-center text-xs",children:"?"}),s.jsxs("div",{children:[s.jsx("div",{className:C.valid?"text-white font-bold":"text-red-400 line-through",children:C.name}),C.warning&&s.jsx("div",{className:"text-[10px] text-yellow-500",children:C.warning})]})]}),s.jsx("td",{className:"p-3",children:C.data?.set_name||C.set||"-"}),s.jsx("td",{className:"p-3 text-center font-mono",children:C.count}),s.jsx("td",{className:"p-3",children:C.tag&&s.jsx("span",{className:"text-xs bg-gray-700 px-1 rounded text-gray-300",children:C.tag})}),s.jsx("td",{className:"p-3 text-right",children:C.valid?s.jsx("span",{className:"text-green-400",children:"Ready"}):s.jsx("span",{className:"text-red-500",children:"Not Found"})})]},U))})]})})]}),m==="success"&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 p-4 rounded-xl text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-2",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Import Successful!"}),s.jsx("p",{className:"text-green-200 text-sm",children:"Your new cards have been added to the collection."})]}),s.jsx("div",{className:"bg-black/20 rounded-xl overflow-hidden border border-gray-800 max-h-[50vh] overflow-y-auto",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[s.jsx("thead",{className:"bg-gray-800/50 text-gray-500 font-bold sticky top-0 bg-gray-900 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Card"}),s.jsx("th",{className:"p-3",children:"Set"}),s.jsx("th",{className:"p-3 text-center",children:"Qty"}),s.jsx("th",{className:"p-3",children:"Applied Tags"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-800",children:A.map((C,U)=>s.jsxs("tr",{children:[s.jsxs("td",{className:"p-3 flex items-center gap-3",children:[s.jsx("img",{src:C.image_uri,className:"w-8 h-8 rounded object-cover",alt:""}),s.jsx("span",{className:"text-white font-bold",children:C.name})]}),s.jsx("td",{className:"p-3",children:C.set_code?.toUpperCase()}),s.jsx("td",{className:"p-3 text-center font-mono",children:C.count}),s.jsx("td",{className:"p-3",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:JSON.parse(C.tags).map(L=>s.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:L},L))})})]},U))})]})})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-800 flex justify-between bg-gray-900/50 rounded-b-2xl",children:m==="input"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:e,className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Cancel"}),s.jsx("button",{onClick:E,disabled:h||!a.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:h?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Review Cards"]}):"Review Cards"})]}):m==="preview"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>x("input"),className:"px-6 py-3 font-bold text-gray-400 hover:text-white",children:"Back to Edit"}),s.jsx("button",{onClick:$,disabled:_||d.filter(C=>C.valid).length===0,className:"bg-green-600 hover:bg-green-500 disabled:opacity-50 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg flex items-center gap-2",children:_?"Importing...":`Import ${d.filter(C=>C.valid).length} Cards`})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{}),s.jsx("button",{onClick:e,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg",children:"Done"})]})})]})}),document.body):null},Ioe=t=>{const e=t.toLowerCase(),r=[];let n="Smart Binder",i="",a="blue",l=`Generated from "${t}"`;(e.includes("red")||e.includes("fire")||e.includes("mountain")||e.includes("burn"))&&(a="red",e.includes("goblin")||(n="Red Collection")),(e.includes("green")||e.includes("forest")||e.includes("elf")||e.includes("nature"))&&(a="green",e.includes("elf")||(n="Green Collection")),(e.includes("blue")||e.includes("island")||e.includes("control")||e.includes("water"))&&(a="blue",n="Blue Collection"),(e.includes("black")||e.includes("swamp")||e.includes("death")||e.includes("grave"))&&(a="purple",n="Black Collection"),(e.includes("white")||e.includes("plains")||e.includes("light")||e.includes("angel"))&&(a="gray",n="White Collection"),e.includes("commander")||e.includes("legend")||e.includes("edh")?(r.push({field:"type",operator:"contains",value:"Legendary Creature"}),i="",n="Commanders",(e.includes("potential")||e.includes("candidate"))&&(n="Potential Commanders")):e.includes("creature")&&(r.push({field:"type",operator:"contains",value:"Creature"}),n==="Smart Binder"&&(n="Creatures",i="")),e.includes("land")&&(r.push({field:"type",operator:"contains",value:"Land"}),i="",n="Lands"),(e.includes("artifact")||e.includes("rock"))&&(r.push({field:"type",operator:"contains",value:"Artifact"}),i="",n="Artifacts"),e.includes("enchantment")&&(r.push({field:"type",operator:"contains",value:"Enchantment"}),i="",n="Enchantments"),e.includes("goblin")&&(r.push({field:"type",operator:"contains",value:"Goblin"}),i="",n="Goblin Tribe",a="red"),(e.includes("elf")||e.includes("elves"))&&(r.push({field:"type",operator:"contains",value:"Elf"}),i="",n="Elven Tribe",a="green"),e.includes("not in deck")||e.includes("unused")||e.includes("spare")||e.includes("binder fodder")?(r.push({field:"in_deck",operator:"is",value:"false"}),n==="Smart Binder"?n="Unused Cards":n=`Unused ${n}`):(e.includes("in deck")||e.includes("used")||e.includes("active"))&&(r.push({field:"in_deck",operator:"is",value:"true"}),n=`Active ${n}`),(e.includes("expensive")||e.includes("value")||e.includes("money")||e.includes("high end")||e.includes("sell")&&!e.includes("not")&&!e.includes("dont")&&!e.includes("wouldnt"))&&(r.push({field:"price",operator:"gt",value:"5.00"}),i="",n.includes("Commander")||(n="High Value")),(e.includes("bulk")||e.includes("cheap")||e.includes("pauper")||e.includes("sell")&&(e.includes("not")||e.includes("dont")||e.includes("wouldnt")))&&(r.push({field:"price",operator:"lt",value:"1.00"}),i="",n="Bulk Storage"),e.includes("trade")&&(r.some(u=>u.field==="in_deck")||r.push({field:"in_deck",operator:"is",value:"false"}),n="Trade Binder",i="");const d=[];return e.includes("rare")&&d.push("rare"),e.includes("mythic")&&d.push("mythic"),d.length>0&&(r.push({field:"rarity",operator:"in",value:d}),(!i||i==="")&&(i="")),(e.includes("duplicate")||e.includes("playset")||e.includes("extra")||e.includes("few of")||e.includes("many"))&&(r.push({field:"count",operator:"gt",value:"4"}),n==="Smart Binder"&&(n="Trade Stock"),i=""),r.length===0&&r.push({field:"name",operator:"contains",value:t}),{id:`ai-${Date.now()}`,name:n,description:l,icon:i,color:a,rules:r}},qm={string:[{id:"contains",label:"contains"},{id:"is",label:"is exactly"},{id:"not",label:"is not"}],number:[{id:"gt",label:"is greater than"},{id:"lt",label:"is less than"},{id:"eq",label:"is exactly"}],select:[{id:"in",label:"is one of"},{id:"not_in",label:"is none of"}],color:[{id:"contains",label:"contains"},{id:"contains_any",label:"contains any of"},{id:"is_exactly",label:"is exactly"}],boolean:[{id:"is",label:"is"}]},Fm=[{id:"name",label:"Name",type:"string"},{id:"colors",label:"Color Identity",type:"color"},{id:"rarity",label:"Rarity",type:"select",options:["common","uncommon","rare","mythic"]},{id:"type",label:"Type Line",type:"string"},{id:"price",label:"Market Price ($)",type:"number"},{id:"cmc",label:"Mana Value (CMC)",type:"number"},{id:"set",label:"Set Code",type:"string"},{id:"count",label:"Quantity",type:"number"},{id:"in_deck",label:"In a Deck?",type:"boolean",options:[{id:"true",label:"In a Deck"},{id:"false",label:"Not in a Deck"}]}],Doe=({rules:t=[],onChange:e})=>{const[r,n]=y.useState(!1),i=()=>{const u={field:"name",operator:"contains",value:""};e([...t,u])},a=(u,h)=>{const p=[...t];if(p[u]={...p[u],...h},h.field){const m=Fm.find(b=>b.id===h.field),x=qm[m.type]||qm.string;p[u].operator=x[0].id,p[u].value=m.type==="select"?[]:m.type==="color"?[]:m.type==="boolean"?m.options[0].id:""}e(p)},l=u=>{e(t.filter((h,p)=>p!==u))},d=(u,h)=>{const p=t[u].value||[],m=p.includes(h)?p.filter(x=>x!==h):[...p,h].sort((x,b)=>"WUBRG".indexOf(x)-"WUBRG".indexOf(b));a(u,{value:m})};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-500",children:"Logic Rules"}),s.jsx("button",{onClick:i,className:"text-[10px] font-bold bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 px-3 py-1 rounded-full hover:bg-indigo-600 hover:text-white transition-all",children:"+ Add Condition"})]}),s.jsxs("div",{className:"space-y-3",children:[t.map((u,h)=>{const p=Fm.find(x=>x.id===u.field)||Fm[0],m=qm[p.type]||qm.string;return s.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center gap-2 bg-gray-950/40 p-3 rounded-2xl border border-gray-800/50 hover:border-gray-700 transition-all",children:[s.jsx("div",{className:"w-12 text-[10px] font-black uppercase text-indigo-500/60",children:h===0?"IF":"AND"}),s.jsx("select",{value:u.field,onChange:x=>a(h,{field:x.target.value}),className:"bg-gray-950/50 border border-white/5 text-white text-xs font-black rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:Fm.map(x=>s.jsx("option",{value:x.id,children:x.label},x.id))}),s.jsx("select",{value:u.operator,onChange:x=>a(h,{operator:x.target.value}),className:"bg-gray-950/50 border border-white/5 text-indigo-400 text-xs font-bold rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",children:m.map(x=>s.jsx("option",{value:x.id,children:x.label},x.id))}),s.jsx("div",{className:"flex-1 min-w-[150px]",children:p.type==="color"?s.jsx("div",{className:"flex gap-1",children:"WUBRGC".split("").map(x=>s.jsx("button",{onClick:()=>d(h,x),className:`w-7 h-7 rounded-full flex items-center justify-center transition-all border ${u.value?.includes(x)?"bg-indigo-600 border-indigo-400 shadow-[0_0_10px_rgba(79,70,229,0.4)]":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-500"}`,children:s.jsx("i",{className:`ms ms-${x.toLowerCase()} ms-cost text-xs ${u.value?.includes(x)?"text-white":""}`})},x))}):p.type==="select"?s.jsx("div",{className:"flex flex-wrap gap-1",children:p.options.map(x=>s.jsx("button",{onClick:()=>{const b=u.value||[],v=b.includes(x)?b.filter(w=>w!==x):[...b,x];a(h,{value:v})},className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase transition-all border ${u.value?.includes(x)?"bg-indigo-600/20 border-indigo-500 text-indigo-400":"bg-gray-800 border-gray-700 text-gray-500"}`,children:x},x))}):p.type==="boolean"?s.jsx("div",{className:"flex gap-1",children:p.options.map(x=>s.jsx("button",{onClick:()=>a(h,{value:x.id}),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all border ${u.value===x.id?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-800 border-gray-700 text-gray-500 hover:border-gray-600"}`,children:x.label},x.id))}):s.jsx("input",{type:p.type==="number"?"number":"text",value:u.value,placeholder:"Value...",onChange:x=>a(h,{value:x.target.value}),className:"w-full bg-gray-900/50 border-none text-white text-xs rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 outline-none"})}),s.jsx("button",{onClick:()=>l(h),className:"p-1 px-2 text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all text-sm",title:"Remove Rule",children:""})]},h)}),t.length===0&&s.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium italic",children:"No rules defined. This binder will be empty or use manual selection."}),s.jsx("button",{onClick:i,className:"text-indigo-400 text-xs font-bold mt-2 hover:underline",children:"+ Click to create your first rule"})]})]}),s.jsxs("div",{className:"mt-4 p-4 bg-indigo-950/10 border border-indigo-900/20 rounded-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Binder Recipe Output"})]}),s.jsx("button",{onClick:()=>n(!r),className:"text-[10px] font-bold text-gray-500 hover:text-white transition-colors uppercase tracking-wider",children:r?"Show Preview":"Import / Export"})]}),r?s.jsxs("div",{children:[s.jsx("textarea",{value:JSON.stringify(t,null,2),onChange:u=>{try{const h=JSON.parse(u.target.value);Array.isArray(h)&&e(h)}catch{}},className:"w-full h-32 bg-gray-900/50 border border-indigo-500/30 rounded-xl p-3 text-[10px] font-mono text-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 resize-y",placeholder:"Paste rule JSON here..."}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Copy this JSON to share rules between binders. Paste existing JSON to load it."})]}):s.jsx("div",{className:"font-mono text-[10px] text-gray-500 break-all leading-relaxed select-text cursor-text active:text-indigo-400 transition-colors",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(t,null,2))},title:"Click to copy JSON to clipboard",children:t.length>0?s.jsxs(s.Fragment,{children:["SELECT * FROM collection WHERE user_id = current_user",t.map((u,h)=>s.jsxs("span",{className:"text-indigo-300/60 block ml-4",children:["AND ",u.field," ",u.operator," '",Array.isArray(u.value)?u.value.join(", "):u.value,"'"]},h))]}):"-- No rules defined yet --"})]})]})},Fs={METHOD:1,CONFIG:2,REVIEW:3},Boe=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","0","1","2","3","4","5","6","7","8","9","","","#","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],$oe=({isOpen:t,onClose:e,selectedCards:r=[],editingBinder:n=null})=>{const{addToast:i}=_r();Gs();const[a,l]=y.useState(Fs.METHOD),[d,u]=y.useState(!1),[h,p]=y.useState(""),[m,x]=y.useState("collection"),[b,v]=y.useState("emoji"),[w,k]=y.useState(""),[_,T]=y.useState("blue"),[A,I]=y.useState([]),[O,M]=y.useState([]),[E,R]=y.useState(!1);y.useEffect(()=>{t&&(n?(l(Fs.CONFIG),p(n.name||""),x(n.type||"collection"),v(n.icon_type||"emoji"),k(n.icon_value||""),T(n.color_preference||"blue"),M(n.rules?typeof n.rules=="string"?JSON.parse(n.rules):n.rules:[]),R(!!n.rules),I([])):(l(Fs.METHOD),p(""),x("collection"),v("emoji"),k(""),T("blue"),I(r||[]),M([]),R(!1)),B([]))},[t,n]);const[$,B]=y.useState([]),[C,U]=y.useState(""),[L,q]=y.useState(!1),K=async()=>{C.trim()&&(q(!0),B([]),setTimeout(()=>{const Y=Ioe(C);B([Y]),q(!1)},800))},W=Y=>{p(Y.name),k(Y.icon),T(Y.color),M(Y.rules),R(!0),l(Fs.CONFIG)},V=async()=>{u(!0);try{const Y={name:h,type:m,icon_type:b,icon_value:w,color_preference:_,rules:E?O:null};let ne;if(n?(await Pe.updateBinder(n.id,Y),ne=n.id):ne=(await Pe.post("/api/binders",Y)).id,A.length>0){const re=A.map(ue=>ue.firestoreId||ue.id);await Pe.put("/api/collection/batch-update",{cardIds:re,binderId:ne})}i(n?"Binder updated!":"Binder created successfully!","success"),e()}catch(Y){console.error("[BinderWizard] Submit error:",Y),i("Failed to save binder","error")}finally{u(!1)}},X=async()=>{if(n&&window.confirm(`Are you sure you want to delete "${n.name}"? This will NOT delete the cards inside.`)){u(!0);try{await Pe.deleteBinder(n.id),i("Binder deleted","success"),e()}catch(Y){console.error("[BinderWizard] Delete error:",Y),i("Failed to delete binder","error")}finally{u(!1)}}},Z=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>{R(!1),l(Fs.CONFIG)},className:"p-6 bg-gray-950/40 hover:bg-indigo-900/10 border border-white/5 hover:border-indigo-500/50 rounded-3xl text-left transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:s.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}),s.jsx("div",{className:"w-14 h-14 bg-gray-800 rounded-2xl flex items-center justify-center text-3xl mb-4 group-hover:scale-110 transition-transform shadow-xl",children:""}),s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Manual Binder"}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:"Classic storage. Move cards in and out exactly how you want."})]}),s.jsxs("div",{className:"p-6 bg-indigo-950/20 border border-indigo-500/20 rounded-3xl relative overflow-hidden flex flex-col h-full",children:[s.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:s.jsx("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.381z",clipRule:"evenodd"})})}),s.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-600/20 text-indigo-400 rounded-2xl flex items-center justify-center text-3xl mb-4 shadow-xl shadow-indigo-900/20",children:""}),s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:"Smart Creator"}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["Describe what you want, and AI will build the rules for you. ",s.jsx("button",{onClick:()=>window.open("https://github.com/TristinParker/MTGLibrary/blob/main/docs/SMART_BINDERS.md","_blank"),className:"text-indigo-400 hover:text-indigo-300 underline md:hidden",children:"What is this?"})]}),s.jsx("div",{className:"mt-auto",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:C,onChange:Y=>U(Y.target.value),placeholder:'e.g., "Red Goblins over $5"',className:"w-full bg-black/40 border border-indigo-500/30 rounded-xl pl-4 pr-12 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-sm",onKeyDown:Y=>Y.key==="Enter"&&K()}),s.jsx("button",{onClick:K,disabled:!C.trim()||L,className:"absolute right-1 top-1 bottom-1 px-3 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-all flex items-center justify-center",children:L?s.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})})]})]})]}),(L||$.length>0)&&s.jsxs("div",{className:"mt-8 space-y-4 animate-fade-in-up",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px bg-white/10 flex-1"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Suggested Blueprints"}),s.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),L?s.jsxs("div",{className:"py-8 flex flex-col items-center",children:[s.jsxs("div",{className:"relative w-16 h-16",children:[s.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500/20 rounded-full"}),s.jsx("div",{className:"absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),s.jsx("p",{className:"mt-4 text-indigo-400 font-mono text-xs animate-pulse",children:"Generating rules..."})]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:$.map(Y=>s.jsxs("button",{onClick:()=>W(Y),className:"p-4 bg-gray-900/60 hover:bg-gray-800 border border-white/5 hover:border-indigo-500/30 rounded-2xl flex items-center gap-4 transition-all text-left group shadow-lg",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-transform group-hover:scale-110",style:{backgroundColor:`rgba(${Y.color==="purple"?"139, 92, 246":Y.color==="green"?"16, 185, 129":Y.color==="orange"?"249, 115, 22":"239, 68, 68"}, 0.1)`},children:Y.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-white text-sm",children:Y.name}),s.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:Y.description})]}),s.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-indigo-500",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]},Y.id))})]})]}),G=()=>s.jsxs("div",{className:"space-y-8 max-w-xl mx-auto",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Binder Name"}),s.jsx("input",{type:"text",value:h,onChange:Y=>p(Y.target.value),placeholder:"e.g., The Vault",autoFocus:!0,className:"w-full bg-gray-950 border-2 border-white/5 focus:border-indigo-500/50 text-white px-5 py-4 rounded-2xl focus:outline-none font-black text-xl transition-all shadow-inner shadow-black/40 placeholder:text-gray-800"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Icon Type"}),s.jsxs("div",{className:"flex bg-gray-950 p-1 rounded-xl border border-white/5",children:[s.jsx("button",{onClick:()=>v("emoji"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${b==="emoji"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Emoji"}),s.jsx("button",{onClick:()=>v("mtg"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${b==="mtg"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:"Symbols"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-2 ml-1",children:"Theme Color"}),s.jsxs("div",{className:"flex gap-2 bg-gray-950 p-2 rounded-xl border border-white/5 overflow-x-auto custom-scrollbar no-scrollbar items-center",children:[["blue","red","green","purple","orange","gray"].map(Y=>s.jsx("button",{onClick:()=>T(Y),className:`w-6 h-6 shrink-0 rounded-full transition-all ${_===Y?"ring-2 ring-white scale-110 shadow-lg":"opacity-40 hover:opacity-100"}`,style:{backgroundColor:Y==="blue"?"#3B82F6":Y==="red"?"#EF4444":Y==="green"?"#10B981":Y==="purple"?"#8B5CF6":Y==="orange"?"#F59E0B":"#6B7280"}},Y)),s.jsx("div",{className:"w-px h-6 bg-white/10 mx-1"}),s.jsx("div",{className:"relative group",children:s.jsx("div",{className:`w-6 h-6 rounded-full border border-white/20 flex items-center justify-center overflow-hidden ${["blue","red","green","purple","orange","gray"].includes(_)?"":"ring-2 ring-white"}`,children:s.jsx("input",{type:"color",value:["blue","red","green","purple","orange","gray"].includes(_)?"#ffffff":_,onChange:Y=>T(Y.target.value),className:"w-8 h-8 -m-1 cursor-pointer"})})})]})]})]})]}),s.jsx("div",{className:"bg-gray-950 rounded-3xl p-5 border border-white/5 shadow-inner shadow-black/40",children:s.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-10 gap-3 h-40 overflow-y-auto custom-scrollbar pr-2",children:b==="emoji"?Boe.map(Y=>s.jsx("button",{onClick:()=>k(Y),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${w===Y?"bg-indigo-600 shadow-lg shadow-indigo-900/40":"bg-gray-900 border border-white/5 text-gray-500 hover:bg-gray-800 hover:text-white"}`,children:Y},Y)):["ms-w","ms-u","ms-b","ms-r","ms-g","ms-c","ms-wp","ms-up","ms-bp","ms-rp","ms-gp","ms-s","ms-x","ms-e","ms-planeswalker","ms-land","ms-artifact","ms-enchantment","ms-creature","ms-instant","ms-sorcery","ms-multiple","ms-guild-azorius","ms-guild-selesnya","ms-guild-boros","ms-guild-dimir","ms-guild-simic","ms-guild-gruul","ms-guild-rakdos","ms-guild-orzhov","ms-guild-izzet","ms-guild-golgari","ms-clan-abzan","ms-clan-jeskai","ms-clan-sultai","ms-clan-mardu","ms-clan-temur","ms-shard-bant","ms-shard-esper","ms-shard-grixis","ms-shard-jund","ms-shard-naya","ms-p","ms-chaos","ms-loyalty-up","ms-loyalty-down","ms-loyalty-zero","ms-tap","ms-untap","ms-flashback","ms-dfc-day","ms-dfc-night"].map(Y=>s.jsx("button",{onClick:()=>k(Y),className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl transition-all ${w===Y?"bg-indigo-600 shadow-lg shadow-indigo-900/40 text-white":"bg-gray-900 border border-white/5 text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:s.jsx("i",{className:`ms ${Y} ms-cost`})},Y))})}),s.jsxs("div",{className:"bg-gray-950 rounded-3xl p-6 border border-white/5 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-xl transition-colors ${E?"bg-indigo-600/20 text-indigo-400":"bg-gray-800 text-gray-500"}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold text-sm",children:"Automated Smart Rules"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"Auto-organize collection based on conditions."})]})]}),s.jsx("button",{onClick:()=>R(!E),className:`w-12 h-6 rounded-full transition-all relative ${E?"bg-indigo-600":"bg-gray-800"}`,children:s.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-all shadow-md ${E?"left-7":"left-1"}`})})]}),E&&s.jsx("div",{className:"pt-4 border-t border-white/5 animate-fade-in",children:s.jsx(Doe,{rules:O,onChange:M})})]})]}),F=()=>s.jsxs("div",{className:"text-center py-10 space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:`absolute inset-0 bg-${_}-500/20 blur-3xl rounded-full scale-150 animate-pulse`}),s.jsxs("div",{className:"relative w-32 h-32 bg-gray-900 border-4 border-white/10 rounded-[2.5rem] flex items-center justify-center text-6xl shadow-2xl z-10 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent pointer-events-none"}),w.startsWith("ms")?s.jsx("i",{className:`ms ${w} ms-2x`}):w]}),s.jsx("div",{className:"absolute -bottom-2 -right-2 px-3 py-1 bg-indigo-600 text-white text-[10px] font-black uppercase rounded-full shadow-lg border border-white/20 z-20",children:E?"Smart":"Manual"})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-black text-white mb-2 leading-tight",children:h||"Unnamed Binder"}),s.jsx("p",{className:"text-gray-500 text-sm",children:E?`Smart Binder with ${O.length} rule(s)`:"Curated collection binder"})]}),s.jsx("div",{className:"bg-gray-950/40 rounded-3xl p-6 border border-white/5 max-w-sm mx-auto shadow-inner shadow-black/60",children:E?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[s.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Recipe Preview"})]}),s.jsxs("div",{className:"space-y-2",children:[O.map((Y,ne)=>s.jsxs("div",{className:"text-xs text-gray-400 bg-black/40 p-2 rounded-xl border border-white/5 flex gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:ne===0?"IF":"AND"}),s.jsxs("span",{children:[Y.field," ",s.jsx("span",{className:"text-indigo-400",children:Y.operator})," '",Array.isArray(Y.value)?Y.value.join(", "):Y.value,"'"]})]},ne)),O.length===0&&s.jsx("p",{className:"text-xs text-red-400 italic",children:"Warning: No rules defined! This binder will be empty."})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Manifest"}),s.jsxs("span",{children:[A.length," Cards"]})]}),s.jsx("div",{className:"flex justify-center -space-x-4 pl-4 h-24 items-end pb-2",children:A.length>0?A.slice(0,5).map((Y,ne)=>s.jsx("div",{className:"w-16 h-20 bg-gray-800 rounded-lg border-2 border-white/10 shadow-2xl relative transition-transform hover:-translate-y-2 overflow-hidden",style:{transform:`rotate(${(ne-2)*8}deg)`},children:Y.data?.image_uris?.small||Y.image_uris?.small?s.jsx("img",{src:Y.data?.image_uris?.small||Y.image_uris.small,className:"w-full h-full object-cover",alt:""}):null},ne)):s.jsx("div",{className:"text-gray-700 italic text-xs",children:"Empty binder (add cards later)"})}),A.length>5&&s.jsxs("div",{className:"text-[10px] text-gray-600 font-bold",children:["+ ",A.length-5," more items"]})]})})]});return t?ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-950 border border-white/10 rounded-[2.5rem] shadow-[0_0_100px_rgba(0,0,0,0.8)] w-full max-w-2xl flex flex-col max-h-[90vh] overflow-hidden relative",children:[s.jsx("div",{className:`absolute top-0 left-1/2 -translate-x-1/2 w-48 h-1 bg-${_}-500 blur-md opacity-30`}),s.jsxs("div",{className:"p-8 pb-4 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-[0.3em]",children:["Step 0",a]}),s.jsx("div",{className:"h-px w-8 bg-indigo-500/30"})]}),s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:a===Fs.METHOD?"Initialize Binder":a===Fs.CONFIG?"Configure Profile":"Final Review"})]}),s.jsx("button",{onClick:e,className:"w-10 h-10 rounded-2xl bg-white/5 hover:bg-white/10 flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-8 py-4 no-scrollbar",children:[a===Fs.METHOD&&Z(),a===Fs.CONFIG&&G(),a===Fs.REVIEW&&F()]}),s.jsxs("div",{className:"p-8 pt-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>a>1?l(a-1):e(),className:"px-6 py-3 font-black text-gray-500 hover:text-white transition-colors text-xs uppercase tracking-widest active:scale-95",children:a===1?"Cancel":"Back"}),n&&a===Fs.CONFIG&&s.jsxs("button",{onClick:X,disabled:d,className:"px-4 py-3 text-[10px] font-black text-red-500/60 hover:text-red-500 transition-colors uppercase tracking-[0.2em] flex items-center gap-2 bg-red-500/5 rounded-xl border border-red-500/10 hover:border-red-500/30",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}),s.jsx("button",{onClick:()=>{a===Fs.REVIEW?V():l(a+1)},disabled:d||a===Fs.CONFIG&&!h,className:`group px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all ${d?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-2xl shadow-indigo-900/40 active:scale-95 flex items-center gap-3"}`,children:d?s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white/30 border-t-white rounded-full"}):s.jsxs(s.Fragment,{children:[a===Fs.REVIEW?n?"Push Changes":"Initialize":"Proceed",s.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7-7 7"})})]})})]})]})}),document.body):null},Q6=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],Uoe=[{value:"color",label:"Color"},{value:"color_identity",label:"Color Identity"},{value:"type",label:"Card Type"},{value:"cmc",label:"Mana Value (CMC)"},{value:"rarity",label:"Rarity"},{value:"set",label:"Set Release"},{value:"collector_number",label:"Collector Number"},{value:"name",label:"Name"},{value:"price",label:"Price"},{value:"power",label:"Power"},{value:"toughness",label:"Toughness"},{value:"artist",label:"Artist"}],L9=({isOpen:t,onClose:e,onComplete:r})=>{const{updateSettings:n}=Mt();O9();const[i,a]=y.useState(1),[l,d]=y.useState(null),[u,h]=y.useState([null,null,null,null]),[p,m]=y.useState({rares:!0,foils:!0,value:!0,valueThreshold:2}),[x,b]=y.useState(!1);if(!t)return null;const v=_=>{const T=Q6.find(A=>A.id===_);d(T),_==="advanced"?a(1.5):_==="hybrid"?a(2):k(T.sort,T.grouping)},w=(_,T)=>{const A=[...u];A[_]=T,h(A)},k=async(_,T)=>{b(!0);try{const A=_.filter(Boolean);let I=T;if(T==="custom"&&A.length>0){const M=A[0];["color","color_identity"].includes(M)?I="color":["set","release"].includes(M)?I="set":["type"].includes(M)?I="type":["rarity"].includes(M)?I="rarity":I="color"}const O={mode:l.id,sortHierarchy:A,groupingPreference:I};await n({organization:O}),r?r():e()}catch(A){console.error("Failed to save organization settings",A)}finally{b(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-3xl w-full max-w-5xl overflow-hidden shadow-2xl relative",children:[s.jsxs("div",{className:"p-8 pb-0 text-center",children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Organize Your Collection"}),s.jsx("p",{className:"text-gray-400",children:"Make your digital library feel like home."})]}),s.jsxs("div",{className:"p-8",children:[i===1&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Q6.map(_=>s.jsxs("button",{onClick:()=>v(_.id),className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl flex flex-col h-full",children:[s.jsx("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform",children:_.icon}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:_.name}),s.jsx("p",{className:"text-sm text-gray-300 mb-4 h-12",children:_.description}),s.jsx("ul",{className:"text-xs text-gray-400 space-y-2 mt-auto pt-4 border-t border-gray-700/50",children:_.features.map((T,A)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),T]},A))})]},_.id))}),i===1.5&&s.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[s.jsx("p",{className:"text-indigo-300 font-bold uppercase tracking-widest text-xs text-center",children:"Define your custom hierarchy (Max 4)"}),s.jsx("div",{className:"space-y-3 max-w-md mx-auto",children:[0,1,2,3].map(_=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:_+1}),s.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:u[_]||"",onChange:T=>w(_,T.target.value),children:[s.jsx("option",{value:"",children:"(None)"}),Uoe.map(T=>s.jsx("option",{value:T.value,children:T.label},T.value))]})]},_))}),s.jsxs("div",{className:"flex justify-between pt-6",children:[s.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),s.jsx("button",{onClick:()=>k(u,"custom"),disabled:!u[0]||x,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:x?"Applying...":"Apply Hierarchy"})]})]}),i===2&&s.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[s.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl mb-4",children:s.jsxs("p",{className:"text-sm text-indigo-300",children:["We'll set your main view to ",s.jsx("strong",{children:"Set & Collector Number"})," (for your boxes), and create ",s.jsx("strong",{children:"Smart Binders"})," for your special cards."]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:p.rares,onChange:_=>m({...p,rares:_.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Rares & Mythics"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a "Trade Binder" for high rarity cards.'})]})]}),s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:p.foils,onChange:_=>m({...p,foils:_.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-white",children:"Foils"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a separate "Foils" binder.'})]})]}),s.jsxs("label",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:p.value,onChange:_=>m({...p,value:_.target.checked}),className:"w-5 h-5 text-indigo-500 rounded focus:ring-indigo-500 bg-gray-900 border-gray-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-white",children:"Valuable Cards"}),s.jsx("div",{className:"text-xs text-gray-400",children:'Create a "High Value" binder.'})]}),p.value&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-400",children:"$"}),s.jsx("input",{type:"number",value:p.valueThreshold,onChange:_=>m({...p,valueThreshold:_.target.value}),className:"w-16 bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white text-sm",onClick:_=>_.stopPropagation()})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-6",children:[s.jsx("button",{onClick:()=>a(1),className:"text-gray-400 hover:text-white font-bold",children:"Back"}),s.jsx("button",{onClick:()=>k(l.sort,l.grouping),disabled:x,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold transition-colors disabled:opacity-50",children:x?"Configuring...":"Finish Setup"})]})]})]})]})})},zoe=(t,e)=>!e||!Array.isArray(e)||e.length===0?!0:e.every(r=>{const{field:n,operator:i,value:a}=r;let l;switch(n){case"name":l=t.name||"";break;case"colors":l=t.data?.color_identity||[];break;case"rarity":l=t.data?.rarity||"";break;case"type":l=t.data?.type_line||"";break;case"price":l=parseFloat(t.data?.prices?.usd||0);break;case"set":l=t.data?.set_name||"";const u=t.data?.set||"";if(i==="contains")return l.toLowerCase().includes(String(a).toLowerCase())||u.toLowerCase().includes(String(a).toLowerCase());break;case"cmc":l=parseFloat(t.data?.cmc||0);break;case"count":l=parseInt(t.count||0,10);break;case"in_deck":const h=!!t.deck_id;return a==="true"?h:!h;default:l=t.data?.[n]||""}const d=Array.isArray(a)?a:String(a);switch(i){case"is":case"eq":return String(l).toLowerCase()===String(d).toLowerCase();case"not":return String(l).toLowerCase()!==String(d).toLowerCase();case"contains":return String(l).toLowerCase().includes(String(d).toLowerCase());case"gt":case"greater_than":return parseFloat(l)>parseFloat(d);case"lt":case"less_than":return parseFloat(l)<parseFloat(d);case"in":return Array.isArray(d)?d.includes(String(l).toLowerCase()):!1;case"not_in":return Array.isArray(d)?!d.includes(String(l).toLowerCase()):!0;case"contains_any":return Array.isArray(l)&&Array.isArray(d)?d.some(u=>l.includes(u)):!1;case"is_exactly":return Array.isArray(l)?JSON.stringify(l.sort())===JSON.stringify(d.sort()):!1;default:return!1}}),qoe=()=>{const{userProfile:t}=Mt(),{addToast:e}=_r(),r=yi(),n=new URLSearchParams(r.search).get("wishlist")==="true",[i,a]=y.useState([]),[l,d]=y.useState("me");y.useEffect(()=>{ts.fetchIncomingPermissions().then(ae=>{const Be=[],Qe=new Set;(Array.isArray(ae)?ae:ae.data||[]).forEach(bt=>{bt.owner_id&&!Qe.has(bt.owner_id)&&(Qe.add(bt.owner_id),Be.push({id:bt.owner_id,name:bt.owner_username||"Unknown"}))}),a(Be)}).catch(ae=>console.error("Failed to fetch shared sources",ae))},[]);const u=l!=="me"&&l!=="all",h=l==="all",{cards:p,error:m,refresh:x}=Gs({wishlist:n,userId:l==="me"?null:l}),{binders:b,refreshBinders:v}=O9(),{decks:w}=Pd(l==="me"?null:l),[k,_]=y.useState(""),[T,A]=y.useState(!1),[I,O]=y.useState(!1),M=async()=>{O(!0);try{await Pe.post("/api/sync/prices"),await x()}catch(ae){console.error("Sync failed",ae)}finally{O(!1)}},[E,R]=y.useState(()=>localStorage.getItem("collection_viewMode")||"grid"),[$,B]=y.useState(()=>localStorage.getItem("collection_groupingMode")||"binders"),[C,U]=y.useState(null),[L,q]=y.useState([]),[K,W]=y.useState(!1),[V,X]=y.useState(!1),[Z,G]=y.useState(!1),[F,Y]=y.useState(!1),[ne,re]=y.useState(!1),[ue,Le]=y.useState(!1),[de,ve]=y.useState(!1),[te,ge]=y.useState(!1),[ke,oe]=y.useState(!1),Ee=y.useRef(null),Te=y.useRef(null),[Ye,ze]=y.useState(null),[le,pe]=y.useState(()=>{const ae=localStorage.getItem("collection_filters");return ae?JSON.parse(ae):{colors:[],rarity:[],types:[],sets:[],decks:[],users:[]}}),[me,Ie]=y.useState(()=>localStorage.getItem("collection_sortBy")||"added_at"),[Fe,qe]=y.useState(()=>localStorage.getItem("collection_sortOrder")||"desc"),[Xe,He]=y.useState(()=>parseInt(localStorage.getItem("collection_currentPage"))||1),[ut,Tt]=y.useState(()=>parseInt(localStorage.getItem("collection_itemsPerPage"))||50);Ge.useEffect(()=>{localStorage.setItem("collection_viewMode",E)},[E]),Ge.useEffect(()=>{localStorage.setItem("collection_groupingMode",$)},[$]),Ge.useEffect(()=>{localStorage.setItem("collection_filters",JSON.stringify(le))},[le]),Ge.useEffect(()=>{localStorage.setItem("collection_sortBy",me),localStorage.setItem("collection_sortOrder",Fe)},[me,Fe]),Ge.useEffect(()=>{localStorage.setItem("collection_currentPage",Xe),localStorage.setItem("collection_itemsPerPage",ut)},[Xe,ut]),Ge.useEffect(()=>{He(1)},[k,le,me,Fe]),y.useEffect(()=>{const ae=Be=>{Ee.current&&!Ee.current.contains(Be.target)&&(oe(!1),ge(!1))};return document.addEventListener("mousedown",ae),()=>document.removeEventListener("mousedown",ae)},[]),y.useEffect(()=>{if(C&&C.startsWith("binder-")){const ae=C.replace("binder-","");W(!0),Pe.getBinderCards(ae).then(Be=>q(Be)).catch(Be=>e("Failed to load binder cards","error")).finally(()=>W(!1))}else q([])},[C,e]);const Ut=y.useMemo(()=>{const ae=new Set;return p.forEach(Be=>{Be.set&&Be.set_name&&ae.add(JSON.stringify({value:Be.set,label:Be.set_name}))}),Array.from(ae).map(Be=>JSON.parse(Be)).sort((Be,Qe)=>Be.label.localeCompare(Qe.label))},[p]),nt=y.useMemo(()=>i.map(ae=>({value:ae.id,label:ae.name})),[i]),kt=y.useMemo(()=>w.map(ae=>({value:ae.id,label:ae.name})),[w]),mt=(ae,Be,Qe)=>{switch(Qe){case"color":case"color_identity":{const et={W:0,U:1,B:2,R:3,G:4},bt=Ve=>{let Je=Ve.color_identity||[];if(typeof Je=="string")try{Je=JSON.parse(Je)}catch{}return Je.length===0?6:Je.length>1?5:et[Je[0]]??7};return bt(ae)-bt(Be)}case"type":{const et={Creature:0,Instant:1,Sorcery:2,Enchantment:3,Artifact:4,Planeswalker:5,Land:6},bt=Ve=>{const Je=Ve.type_line||"";for(const[pt,he]of Object.entries(et))if(Je.includes(pt))return he;return 7};return bt(ae)-bt(Be)}case"cmc":return(parseFloat(ae.cmc)||0)-(parseFloat(Be.cmc)||0);case"price":return parseFloat(ae.prices?.usd||0)-parseFloat(Be.prices?.usd||0);case"collector_number":{const et=parseInt(ae.collector_number||0),bt=parseInt(Be.collector_number||0);return et-bt}case"set":return(ae.set||"").localeCompare(Be.set||"");case"name":return(ae.name||"").localeCompare(Be.name||"");case"power":return(parseFloat(ae.power)||0)-(parseFloat(Be.power)||0);case"toughness":return(parseFloat(ae.toughness)||0)-(parseFloat(Be.toughness)||0);case"artist":return(ae.artist||"").localeCompare(Be.artist||"");default:return 0}},Re=y.useMemo(()=>p.filter(Be=>{const Qe=Be.name||"";if(k&&!Qe.toLowerCase().includes(k.toLowerCase()))return!1;if(le.colors.length>0){const et=Be.color_identity||[],bt=et.length>1,Ve=et.length===0;if(!le.colors.some(pt=>pt==="C"?Ve:pt==="M"?bt:et.includes(pt)))return!1}if(le.rarity.length>0&&!le.rarity.includes(Be.rarity))return!1;if(le.types.length>0){const et=(Be.type_line||"").toLowerCase();if(!le.types.some(Ve=>et.includes(Ve.toLowerCase())))return!1}return!(le.sets.length>0&&!le.sets.includes(Be.set)||le.decks.length>0&&!le.decks.includes(Be.deckId)||le.users&&le.users.length>0&&!le.users.includes(Be.user_id)&&!le.users.includes(Be.owner_id))}).sort((Be,Qe)=>{const et=t?.settings?.organization?.sortHierarchy;if(et&&Array.isArray(et)&&et.length>0){for(const Je of et){const pt=mt(Be,Qe,Je);if(pt!==0)return pt}return mt(Be,Qe,"name")}if(me==="added_at"){const Je=new Date(Be.added_at||0).getTime(),pt=new Date(Qe.added_at||0).getTime();return Fe==="asc"?Je-pt:pt-Je}let bt=me;if(me==="owner")return(Be.owner_username||"ME").localeCompare(Qe.owner_username||"ME");const Ve=mt(Be,Qe,bt);return Fe==="asc"?Ve:-Ve}),[p,k,le,me,Fe,t]),it=y.useMemo(()=>{if(E!=="folder")return[];if($==="custom"){const ae={},Be=[];Re.forEach(et=>{const bt=typeof et.tags=="string"?JSON.parse(et.tags):et.tags||[];bt.length===0?Be.push(et):bt.forEach(Ve=>{ae[Ve]||(ae[Ve]=[]),ae[Ve].push(et)})});const Qe=Object.entries(ae).map(([et,bt])=>({id:`tag-${et}`,label:et,type:"tag",cards:bt,icon:"",color:"indigo"}));return Be.length>0&&Qe.push({id:"unsorted",label:"Unsorted",type:"tag",cards:Be,icon:"",color:"gray"}),Qe.sort((et,bt)=>et.label.localeCompare(bt.label))}if($==="smart"){const ae=[],Be={};Re.forEach(Ve=>{if(Ve.deck_id){const Je=w.find(pt=>pt.id===Ve.deck_id)?.name||"Unknown Deck";Be[Je]||(Be[Je]=[]),Be[Je].push(Ve)}}),Object.entries(Be).forEach(([Ve,Je])=>{const pt=h&&Je[0]?.owner_username?Je[0].owner_username:null;ae.push({id:`deck-${Ve}`,label:Ve,type:"deck",cards:Je,icon:"",color:"purple",sub:"Deck",ownerName:pt})});const Qe=t?.settings?.organization?.groupingPreference||"color",et={};Re.forEach(Ve=>{let Je="Other",pt="Other",he=0,We={};if(Qe==="set")Je=Ve.set||"unknown",pt=Ve.set_name||"Unknown Set",he=Ve.released_at?new Date(Ve.released_at).getTime():0,We={icon:"",color:"blue"};else if(Qe==="type"){const vt=["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"],At=Ve.type_line||"",Jt=vt.find(wr=>At.includes(wr))||"Other";Je=Jt,pt=Jt,We={icon:"",color:"emerald"}}else if(Qe==="rarity")Je=Ve.rarity||"common",pt=Je.charAt(0).toUpperCase()+Je.slice(1),he={common:0,uncommon:1,rare:2,mythic:3}[Je]||0,We={icon:"",color:"yellow"};else{let vt=Ve.color_identity;if(typeof vt=="string")try{vt=JSON.parse(vt)}catch{vt=[]}Array.isArray(vt)||(vt=[]);const At={W:0,U:1,B:2,R:3,G:4},wr=vt.filter(ys=>At[ys]!==void 0).sort((ys,Xs)=>At[ys]-At[Xs]).join("");Je=wr.length===0?"C":wr;const Mn=Fj(Je);pt=Mn.name,he=Je==="C"?-1:Je.length,We={icon:"",color:Mn.bg?.replace("bg-","")?.split(" ")[0]||"blue",pips:Mn.pips,flavor:Mn.flavor,theme:Mn.theme}}et[Je]||(et[Je]={label:pt,cards:[],sortValue:he,...We}),et[Je].cards.push(Ve)});const bt=Object.entries(et).map(([Ve,Je])=>({id:`group-${Ve}`,label:Je.label,type:Qe,cards:Je.cards,icon:Je.icon,color:Je.color||"gray",sub:Qe.charAt(0).toUpperCase()+Qe.slice(1),pips:Je.pips,flavor:Je.flavor,theme:Je.theme,sortValue:Je.sortValue}));return bt.sort((Ve,Je)=>Qe==="rarity"||Qe==="set"?Je.sortValue-Ve.sortValue:Qe==="color"?(Ve.id.replace("group-","").length,Ve.theme&&Je.theme?Ve.label.localeCompare(Je.label):0):Ve.label.localeCompare(Je.label)),[...ae,...bt]}return $==="binders"?b.map(ae=>{const Be=ae.rules?typeof ae.rules=="string"?JSON.parse(ae.rules):ae.rules:null,Qe=Be?p.filter(et=>zoe(et,Be)):p.filter(et=>String(et.binder_id)===String(ae.id));return{id:`binder-${ae.id}`,label:ae.name,type:"binder",cards:Qe,icon:ae.icon_value||"",color:ae.color_preference||"blue",sub:Be?"Smart Binder":"Collection Binder",isSmart:!!Be}}):[]},[Re,$,E,w,b,p,t]),jt=(ae,Be)=>{pe(Qe=>{const et=Qe[ae],bt=et.includes(Be)?et.filter(Ve=>Ve!==Be):[...et,Be];return{...Qe,[ae]:bt}})},yt=y.useMemo(()=>{const ae=it.find(Be=>Be.id===C);return ae&&ae.type==="binder"?{...ae,cards:L}:ae},[it,C,L]),Et=y.useMemo(()=>{if(E!=="grid")return Re;const ae=(Xe-1)*ut,Be=ae+ut;return Re.slice(ae,Be)},[Re,Xe,ut,E]),ot=y.useMemo(()=>E!=="grid"?1:Math.ceil(Re.length/ut),[Re.length,ut,E]);return y.useEffect(()=>{const ae=Yt(t?.subscription_tier).features.binders;E==="folder"&&$==="binders"&&!ae&&R("grid")},[t,E,$]),s.jsxs("div",{className:"relative min-h-screen overflow-x-hidden",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:"url(/MTG-Forge_Logo_Background.png)"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm"})}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto px-4 md:px-6 py-8 space-y-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"relative z-50 flex flex-col md:flex-row justify-between items-start md:items-end gap-4 bg-gray-950/40 p-4 md:p-6 rounded-3xl backdrop-blur-md border border-white/5 shadow-xl",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl md:text-4xl font-black text-white tracking-tight mb-1 md:mb-2",children:n?"My Wishlist":"My Collection"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[s.jsxs("p",{className:"text-gray-400 font-medium text-xs md:text-sm",children:[Re.length," ",Re.length===1?"card":"cards"," found  ",s.jsxs("span",{className:"text-indigo-400",children:["$",Re.reduce((ae,Be)=>ae+parseFloat(Be.prices?.usd||0)*(Be.count||1),0).toFixed(2)]})]}),s.jsxs("button",{onClick:M,disabled:I,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 text-[10px] font-black uppercase tracking-widest transition-all border border-indigo-500/20 ${I?"opacity-70 cursor-wait":""}`,title:"Update prices from Scryfall",children:[s.jsx("svg",{className:`w-3 h-3 ${I?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),I?"Syncing...":"Sync Prices"]})]})]}),s.jsxs("div",{className:"flex gap-2 md:gap-3 w-full md:w-auto items-center justify-between md:justify-end",children:[s.jsx(Roe,{mode:E,onChange:ae=>{R(ae),U(null),ae==="folder"&&(Yt(t?.subscription_tier).features.binders||B("smart"))}}),!u&&s.jsx(s.Fragment,{children:s.jsxs("div",{ref:Ee,className:"relative",onMouseEnter:()=>{Te.current&&(clearTimeout(Te.current),Te.current=null),ge(!0)},onMouseLeave:()=>{ke||(Te.current=setTimeout(()=>{ge(!1)},400))},children:[s.jsxs("button",{onClick:()=>{oe(!ke),ge(!0)},className:`flex items-center gap-3 px-6 py-3 rounded-2xl border transition-all duration-300 shadow-xl ${ke?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-900 border-white/10 text-gray-400 hover:text-white hover:border-indigo-500/50 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex -space-x-1.5 items-center",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500/20 border border-indigo-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500/20 border border-purple-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500/20 border border-blue-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})})]}),s.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:ke?"Close":"Tools"})]}),te&&s.jsx("div",{className:"absolute right-0 top-full mt-3 w-72 md:w-80 bg-gray-950/95 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden z-[100] animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Adding Cards"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>{X(!0),ge(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Manual Add"})]}),s.jsxs("button",{onClick:()=>{ve(!0),ge(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group lg:min-h-[64px]",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Forge Lens"})]}),s.jsxs("button",{onClick:()=>{G(!0),ge(!1)},className:"flex flex-col items-center gap-2 p-3 bg-white/5 hover:bg-gray-800 rounded-xl border border-white/5 transition-all group col-span-2",children:[s.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Bulk Paste / Import"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Management"}),s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 divide-y divide-white/5 overflow-hidden",children:[s.jsxs("button",{onClick:()=>{if(!Yt(t?.subscription_tier).features.binders){e("Custom Binders are available on Wizard tier and above.","info");return}Y(!0),ge(!1)},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${Yt(t?.subscription_tier).features.binders?"hover:bg-indigo-500/10":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"New Binder"})]}),!Yt(t?.subscription_tier).features.binders&&s.jsx("span",{className:"text-[8px] bg-indigo-500/20 text-indigo-400 px-1.5 py-0.5 rounded leading-none",children:"WIZARD"})]}),s.jsxs("button",{onClick:()=>{if(!Yt(t?.subscription_tier).features.collectionAudit){e("Collection Organization tools are available on Wizard tier.","info");return}Le(!0),ge(!1)},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${Yt(t?.subscription_tier).features.collectionAudit?"hover:bg-purple-500/10":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Organize Collection"})]}),!Yt(t?.subscription_tier).features.collectionAudit&&s.jsx("span",{className:"text-[8px] bg-purple-500/20 text-purple-400 px-1.5 py-0.5 rounded leading-none",children:"WIZARD"})]}),s.jsxs("button",{onClick:()=>{re(!0),ge(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center gap-3 hover:bg-gray-800 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Binder Guide"})]})]})]})]})})]})})]})]}),m&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-3xl p-8 text-center backdrop-blur-md",children:[s.jsx("svg",{className:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Failed to load collection"}),s.jsx("p",{className:"text-red-200 mb-6",children:m.message||"Something went wrong while fetching your cards."}),s.jsx("button",{onClick:()=>x(),className:"px-6 py-2 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition-all shadow-lg shadow-red-900/20",children:"Try Again"})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-4 md:p-6 backdrop-blur-md shadow-2xl",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 md:gap-4 mb-6 justify-between",children:[s.jsxs("div",{className:"flex gap-2 flex-wrap flex-1",children:[s.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[s.jsx("input",{type:"text",placeholder:"Search cards...",value:k,onChange:ae=>_(ae.target.value),className:"w-full bg-gray-900/50 border border-gray-700 text-white px-4 py-2.5 md:py-3 pl-10 md:pl-12 pr-10 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all placeholder-gray-500 font-medium text-sm h-10 md:h-12"}),s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400 absolute left-3 md:left-4 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),k&&s.jsx("button",{onClick:()=>_(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("select",{value:l,onChange:ae=>{d(ae.target.value),U(null)},className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 whitespace-nowrap h-10 md:h-12",children:[s.jsx("option",{value:"me",children:"My Collection"}),s.jsx("option",{value:"all",children:"All Linked Collections"}),i.map(ae=>s.jsxs("option",{value:ae.id,children:[ae.name,"'s Collection"]},ae.id))]}),s.jsxs("select",{value:me,onChange:ae=>Ie(ae.target.value),className:"bg-gray-800 border-gray-700 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl font-bold text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 h-10 md:h-12",children:[s.jsx("option",{value:"added_at",children:"Date Added"}),s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"price",children:"Price"}),h&&s.jsx("option",{value:"owner",children:"Owner"})]}),s.jsx("button",{onClick:()=>qe(Fe==="asc"?"desc":"asc"),className:"bg-gray-800 border border-gray-700 text-gray-400 hover:text-white px-3 py-2 md:px-4 md:py-3 rounded-xl transition-all h-10 md:h-12",title:`Sort Order: ${Fe.toUpperCase()}`,children:Fe==="asc"?s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}):s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})})}),s.jsxs("button",{onClick:()=>A(!T),className:`px-4 py-2 md:px-5 md:py-3 rounded-xl border font-bold text-xs md:text-sm flex items-center gap-2 transition-all h-10 md:h-12 ${T?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Filters"})]})]}),E==="folder"&&!C&&s.jsx("div",{className:"flex gap-2",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-1 rounded-xl flex self-start overflow-hidden",children:[s.jsxs("button",{onClick:()=>{if(!Yt(t?.subscription_tier).features.binders){e(`Custom Binders are available on ${Gr[tt.TIER_2].name} tier.`,"info");return}B("binders")},className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 ${$==="binders"?"bg-indigo-600 text-white":Yt(t?.subscription_tier).features.binders?"text-gray-500 hover:text-gray-300":"text-gray-600 cursor-not-allowed opacity-60"}`,children:["Binders",!Yt(t?.subscription_tier).features.binders&&s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),s.jsx("button",{onClick:()=>B("smart"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${$==="smart"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Smart"}),s.jsx("button",{onClick:()=>B("custom"),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${$==="custom"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Tags"})]})})]}),T&&s.jsx("div",{className:"mb-8 p-6 bg-gray-900/50 rounded-2xl border border-gray-800 space-y-6 animate-fade-in-down",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(ae=>s.jsxs("button",{onClick:()=>jt("colors",ae),className:`
w - 8 h - 8 rounded - full border flex items - center justify - center transition - all transform hover: scale - 110
                                                    ${le.colors.includes(ae)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 shadow-lg scale-110":"opacity-60 hover:opacity-100"}
                                                    ${ae==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                                    ${ae==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                                    ${ae==="B"?"bg-[#1F2937] text-white border-gray-600":""}
                                                    ${ae==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                                    ${ae==="G"?"bg-[#10B981] text-white border-green-600":""}
                                                    ${ae==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                                    ${ae==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
`,title:ae==="C"?"Colorless":ae==="M"?"Multicolor":ae,children:[ae!=="M"&&ae!=="C"&&s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ae}.svg`,alt:ae,className:"w-4 h-4"}),ae==="M"&&s.jsx("span",{className:"font-bold text-xs",children:"M"}),ae==="C"&&s.jsx("span",{className:"font-bold text-xs",children:"C"})]},ae))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(ae=>s.jsx("button",{onClick:()=>jt("rarity",ae),className:`
                                                    px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                    ${le.rarity.includes(ae)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                `,children:ae},ae))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-3",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(ae=>s.jsx("button",{onClick:()=>jt("types",ae),className:`
                                                     px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border transition-all hover:-translate-y-0.5
                                                     ${le.types.includes(ae)?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500 hover:text-white"}
                                                 `,children:ae},ae))})]}),s.jsxs("div",{className:"col-span-1 space-y-4",children:[s.jsx(_g,{label:"Sets",options:Ut,selected:le.sets,onChange:ae=>pe({...le,sets:ae})}),h&&s.jsx(_g,{label:"Card Owner",options:nt,selected:le.users,onChange:ae=>pe({...le,users:ae})}),s.jsx(_g,{label:"Filter by Deck",options:kt,selected:le.decks,onChange:ae=>pe(Be=>({...Be,decks:ae})),placeholder:"All Decks"})]})]})}),m?s.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-8 rounded-2xl text-center",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Collection"}),s.jsx("p",{children:m.message})]}):s.jsxs(s.Fragment,{children:[E==="folder"&&!yt&&s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6 animate-fade-in",children:[it.map(ae=>s.jsxs("div",{onClick:()=>U(ae.id),className:"bg-gray-900/40 hover:bg-gray-800/60 border border-white/5 hover:border-indigo-500/30 rounded-2xl p-4 md:p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-2 md:gap-3 backdrop-blur-sm relative overflow-hidden",children:[s.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 bg-${ae.color}-500/10 rounded-full blur-3xl`}),s.jsx("div",{className:"flex gap-1 mb-1 md:mb-2 group-hover:scale-110 transition-transform",children:ae.pips?ae.pips.map((Be,Qe)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${Be}.svg`,alt:Be,className:"w-6 h-6 md:w-8 md:h-8 drop-shadow-md transition-transform group-hover:scale-110"},Qe)):ae.icon&&ae.icon.startsWith("ms-")?s.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${ae.color}-900/30 text-${ae.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:s.jsx("i",{className:`ms ${ae.icon} ms-cost`})}):s.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-${ae.color}-900/30 text-${ae.color}-400 rounded-xl flex items-center justify-center text-xl md:text-2xl`,children:ae.icon})}),s.jsxs("div",{className:"z-10 px-2 mt-4",children:[s.jsx("div",{className:"text-[10px] uppercase tracking-tighter text-indigo-400 font-black mb-1",children:ae.theme||ae.sub}),s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors leading-tight",children:ae.label}),ae.flavor&&s.jsxs("p",{className:"text-[10px] text-gray-500 italic mt-2 font-serif px-2 leading-relaxed opacity-80 group-hover:opacity-100 transition-opacity",children:['"',ae.flavor,'"']}),ae.ownerName&&s.jsxs("div",{className:"mt-2 inline-flex items-center gap-1 bg-gray-950/80 text-gray-300 text-[9px] font-bold px-2 py-1 rounded-full border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),ae.ownerName]})]}),s.jsxs("span",{className:"mt-4 px-3 py-1 bg-black/30 rounded-full text-xs font-mono text-gray-400 border border-white/5",children:[ae.cards.length," cards"]})]},ae.id)),it.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards match your filter criteria."})]}),E==="folder"&&yt&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>U(null),className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[yt.icon," ",yt.label]}),yt.type==="binder"&&s.jsx("button",{onClick:()=>{const ae=b.find(Be=>Be.id===parseInt(C.replace("binder-","")));ze(ae),Y(!0)},className:"p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-indigo-400 hover:text-white transition-colors",title:"Edit Binder Rules",children:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),yt.type==="binder"&&s.jsx(hy,{type:"binder",targetId:C.replace("binder-",""),label:"Audit",className:"text-xs bg-gray-800 border-gray-700 hover:bg-gray-700 hover:text-white py-2"})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:yt.cards.map(ae=>s.jsx("div",{className:"h-full",children:s.jsx(Yu,{card:ae,decks:w,currentUser:t,showOwnerTag:h})},ae.firestoreId||ae.id))})]}),E==="grid"&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 animate-fade-in",children:[Et.map(ae=>s.jsx("div",{className:"h-full",children:s.jsx(Yu,{card:ae,decks:w,currentUser:t,showOwnerTag:h})},ae.firestoreId||ae.id)),Re.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500 italic",children:"No cards found."})]})}),E==="table"&&s.jsx("div",{className:"animate-fade-in",children:s.jsx(Loe,{cards:Re,isMixed:h})})]})]})]}),s.jsx(C4,{isOpen:V,onClose:()=>X(!1),onAddCard:()=>x(),onOpenForgeLens:()=>{X(!1),ve(!0)}}),s.jsx(Poe,{isOpen:Z,onClose:()=>G(!1)}),s.jsx(I4,{isOpen:ne,onClose:()=>re(!1)}),s.jsx(ey,{isOpen:de,onClose:()=>ve(!1),onFinish:async(ae,Be={})=>{if(ae.length)try{const{targetDeckId:Qe,additionMode:et}=Be,bt=ae.map(pt=>({name:pt.name,scryfall_id:pt.scryfall_id,set_code:pt.set_code,collector_number:pt.collector_number,image_uri:pt.data.image_uris?.normal||pt.data.card_faces?.[0]?.image_uris?.normal,count:pt.quantity,data:pt.data,is_wishlist:pt.is_wishlist,finish:pt.finish||"nonfoil",deck_id:Qe||null,tags:[]})),Ve=et==="transfer"?"transfer_to_deck":"merge";await Pe.batchAddToCollection(bt,Ve);const Je=Qe?"deck":"collection";e(`Successfully ${et==="transfer"?"moved":"added"} ${ae.length} cards to ${Je}!`,"success"),x()}catch(Qe){console.error("Forge Lens Add Failed",Qe),e("Failed to add scanned cards.","error")}}}),s.jsx($oe,{isOpen:F,editingBinder:Ye,onClose:()=>{if(Y(!1),ze(null),v(),C&&C.startsWith("binder-")){const ae=C.replace("binder-","");W(!0),Pe.getBinderCards(ae).then(q).finally(()=>W(!1))}}}),E==="grid"&&Re.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"hidden md:block fixed bottom-0 left-0 right-0 z-[55] bg-gray-950/95 backdrop-blur-xl border-t border-white/10 shadow-[0_-10px_40px_rgba(0,0,0,0.5)]",children:s.jsx("div",{className:"max-w-[1600px] mx-auto px-6 pr-24 py-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"text-sm text-gray-400 font-medium whitespace-nowrap",children:["Showing ",(Xe-1)*ut+1," - ",Math.min(Xe*ut,Re.length)," of ",Re.length," cards"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>He(1),disabled:Xe===1,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"First Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>He(ae=>Math.max(1,ae-1)),disabled:Xe===1,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Previous Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,ot)},(ae,Be)=>{let Qe;return ot<=5||Xe<=3?Qe=Be+1:Xe>=ot-2?Qe=ot-4+Be:Qe=Xe-2+Be,s.jsx("button",{onClick:()=>He(Qe),className:`min-w-[2.5rem] px-3 py-2 rounded-lg font-bold text-sm transition-all ${Xe===Qe?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700"}`,children:Qe},Qe)})}),s.jsx("button",{onClick:()=>He(ae=>Math.min(ot,ae+1)),disabled:Xe===ot,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Next Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),s.jsx("button",{onClick:()=>He(ot),disabled:Xe===ot,className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 hover:text-white hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Last Page",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),s.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[s.jsx("label",{className:"text-sm text-gray-400 font-medium",children:"Per page:"}),s.jsxs("select",{value:ut,onChange:ae=>{Tt(parseInt(ae.target.value)),He(1)},className:"bg-gray-800 border border-gray-700 text-white px-3 py-2 rounded-lg font-bold text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"}),s.jsx("option",{value:200,children:"200"})]})]})]})})}),s.jsx("div",{className:"md:hidden fixed bottom-16 left-0 right-0 z-[55] bg-gray-950/95 backdrop-blur-xl border-t border-white/10 shadow-[0_-10px_40px_rgba(0,0,0,0.5)]",children:s.jsx("div",{className:"px-4 pr-24 py-3",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"text-xs text-gray-400 font-medium",children:["Page ",Xe," of ",ot]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>He(ae=>Math.max(1,ae-1)),disabled:Xe===1,className:"px-2.5 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 active:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Previous",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("div",{className:"text-xs font-bold text-white bg-indigo-600 px-3 py-2 rounded-lg min-w-[3rem] text-center",children:Xe}),s.jsx("button",{onClick:()=>He(ae=>Math.min(ot,ae+1)),disabled:Xe===ot,className:"px-2.5 py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 active:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-all",title:"Next",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),s.jsxs("select",{value:ut,onChange:ae=>{Tt(parseInt(ae.target.value)),He(1)},className:"bg-gray-800 border border-gray-700 text-white px-2 py-2 rounded-lg font-bold text-xs focus:outline-none",children:[s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"}),s.jsx("option",{value:200,children:"200"})]})]})})})]}),s.jsx(L9,{isOpen:ue,onClose:()=>Le(!1),onComplete:()=>{Le(!1),window.location.reload()}})]})},Z6=t=>{if(!t)return null;const e=t.data||t;return e.image_uris?.art_crop?e.image_uris.art_crop:e.card_faces?.[0]?.image_uris?.art_crop?e.card_faces[0].image_uris.art_crop:e.image_uris?.normal?e.image_uris.normal:null},Foe=t=>{const e=t?.commander?.color_identity||[],r=t?.commander_partner?.color_identity||[],n=[...new Set([...e,...r])];return n.length>0?n:["C"]},Hoe=[{badge:"White",colors:["W"],flavor:"Order, protection, and the light of law."},{badge:"Blue",colors:["U"],flavor:"Knowledge, manipulation, and the perfection of mind."},{badge:"Black",colors:["B"],flavor:"Power, ambition, and death at any cost."},{badge:"Red",colors:["R"],flavor:"Freedom, emotion, and the fire of impulse."},{badge:"Green",colors:["G"],flavor:"Nature, instinct, and the strength of the wild."},{badge:"Colorless",colors:["C"],flavor:"The void between, pure and unyielding."},{badge:"Azorius",colors:["W","U"],flavor:"The law is the shield of the just."},{badge:"Dimir",colors:["U","B"],flavor:"Knowledge is power, and we know everything."},{badge:"Rakdos",colors:["B","R"],flavor:"Entertainment is a serious business."},{badge:"Gruul",colors:["R","G"],flavor:"Not Gruul? Then die!"},{badge:"Selesnya",colors:["G","W"],flavor:"Together, we are the world's soul."},{badge:"Orzhov",colors:["W","B"],flavor:"Wealth is power, and spirit is currency."},{badge:"Izzet",colors:["U","R"],flavor:"Genius and madness are two sides of the same coin."},{badge:"Golgari",colors:["B","G"],flavor:"Life and death are a continuous circle."},{badge:"Boros",colors:["R","W"],flavor:"Strike fast, strike hard, strike true."},{badge:"Simic",colors:["G","U"],flavor:"Nature, perfected by design."},{badge:"Esper",colors:["W","U","B"],flavor:"Perfection through etherium and discipline."},{badge:"Grixis",colors:["U","B","R"],flavor:"Life is short, death is forever."},{badge:"Jund",colors:["B","R","G"],flavor:"Only the strongest survive the feeding frenzy."},{badge:"Naya",colors:["R","G","W"],flavor:"Where giant beasts roam and the wild reigns."},{badge:"Bant",colors:["G","W","U"],flavor:"Honor, valor, and the righteousness of caste."},{badge:"Abzan",colors:["W","B","G"],flavor:"Family is the only fortress that matters."},{badge:"Jeskai",colors:["U","R","W"],flavor:"Cunning strategies and swift strikes."},{badge:"Sultai",colors:["B","G","U"],flavor:"Ruthlessness is a virtue in the opulent dark."},{badge:"Mardu",colors:["R","W","B"],flavor:"Speed of the horse, edge of the blade."},{badge:"Temur",colors:["G","U","R"],flavor:"Savagery concealed by ice and snow."},{badge:"Glint-Eye",colors:["U","B","R","G"],flavor:"Chaos without order."},{badge:"Dune-Brood",colors:["W","B","R","G"],flavor:"Growth through conflict."},{badge:"Ink-Treader",colors:["W","U","R","G"],flavor:"Motion without purpose."},{badge:"Witch-Maw",colors:["W","U","B","G"],flavor:"Life without death."},{badge:"Yore-Tiller",colors:["W","U","B","R"],flavor:"Artifice without nature."},{badge:"WUBRG",colors:["W","U","B","R","G"],flavor:"All five colors in perfect harmony."}],R9=t=>{const e=t||[],r=e.length;return Hoe.find(i=>i.badge==="Colorless"&&(r===0||r===1&&e[0]==="C")?!0:i.colors.length!==r?!1:i.colors.every(a=>e.includes(a)))||{badge:"Commander",colors:e,flavor:"A unique combination of powers."}},Woe=({deck:t})=>{const e=Foe(t),r=R9(e),n=parseInt(t.card_count||0),i=Z6(t.commander),a=Z6(t.commander_partner);return s.jsx(_t,{to:`/decks/${t.id}`,className:"group relative flex flex-col h-[420px] rounded-3xl transition-all duration-300 hover:-translate-y-2",children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[60%] w-full relative overflow-hidden bg-gray-950 shrink-0",children:[t.commander_partner?s.jsxs("div",{className:"w-full h-full flex",children:[s.jsxs("div",{className:"w-1/2 h-full relative border-r border-black/50",children:[s.jsx("img",{src:i||"https://placehold.co/400x600?text=?",alt:t.commander?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]}),s.jsxs("div",{className:"w-1/2 h-full relative",children:[s.jsx("img",{src:a||"https://placehold.co/400x600?text=?",alt:t.commander_partner?.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"})]})]}):i?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:i,alt:t.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("svg",{className:"w-16 h-16 text-gray-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1",children:[t.tags&&t.tags.includes("Precon")&&s.jsx("div",{className:"px-2 py-1 bg-teal-500/20 text-teal-400 border border-teal-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Precon"}),t.is_mockup&&s.jsx("div",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 border border-orange-500/30 backdrop-blur-md rounded text-[10px] font-black uppercase tracking-widest shadow-lg text-center",children:"Mockup"})]})]}),s.jsxs("div",{className:"h-[40%] p-5 flex flex-col justify-between relative grow",children:[s.jsx("div",{className:"absolute -top-3 left-5 flex gap-1 bg-gray-900/80 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:(t.format?.toLowerCase()==="standard"?t.colors||[]:e).map(l=>{const d=`https://svgs.scryfall.io/card-symbols/${l}.svg`;return s.jsx("img",{src:d,alt:l,className:"w-4 h-4 shadow-sm"},l)})}),(t.ai_blueprint?.grade?.powerLevel>0||t.aiBlueprint?.grade?.powerLevel>0)&&s.jsxs("div",{className:"absolute -top-3 right-5 flex items-center gap-1.5 bg-gray-900 backdrop-blur-md rounded-full px-3 py-1 border border-white/10 shadow-xl group-hover:border-indigo-500/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-indigo-400 tracking-wider",children:"B"}),s.jsx("span",{className:"text-xs font-mono font-bold text-white",children:t.ai_blueprint?.grade?.commanderBracket||t.aiBlueprint?.grade?.commanderBracket||"?"})]}),s.jsx("div",{className:"w-px h-2.5 bg-white/10"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-teal-400 tracking-wider",children:"PWR"}),s.jsx("span",{className:"text-xs font-mono font-bold text-white",children:Number(t.ai_blueprint?.grade?.powerLevel||t.aiBlueprint?.grade?.powerLevel).toFixed(1)})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-1 opacity-80",children:r.badge}),s.jsx("h3",{className:"text-xl font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:t.name||"Untitled Deck"}),s.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:t.commander_partner?`${t.commander?.name} & ${t.commander_partner?.name}`:t.commander?.name||"No Commander"})]}),s.jsxs("div",{className:"flex justify-between items-center border-t border-white/5 pt-4 mt-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Format"}),s.jsx("span",{className:"text-xs text-gray-300 font-medium",children:t.format||"Commander"})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Cards"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${n>=(t.format?.toLowerCase()==="standard"?60:100)?"text-green-500":"text-indigo-400"}`,children:[n,s.jsxs("span",{className:"text-gray-600 text-[10px]",children:["/",t.format?.toLowerCase()==="standard"?"60":"100"]})]})]})]})]})]})})},P9=({title:t,decks:e,loading:r,error:n,isOwner:i=!1})=>{const[a,l]=y.useState(!1),d=a?e:e.slice(0,4),u=e.length>4;return r?s.jsxs("div",{className:"mb-12",children:[s.jsx("div",{className:"h-8 w-48 bg-gray-800 rounded-lg animate-pulse mb-6"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(h=>s.jsx("div",{className:"h-[420px] bg-gray-900 rounded-3xl animate-pulse"},h))})]}):n?s.jsx("div",{className:"mb-12 p-6 bg-red-900/20 border border-red-500/50 rounded-2xl",children:s.jsx("h3",{className:"text-red-400 font-bold",children:"Error loading decks"})}):e.length===0?null:s.jsxs("div",{className:"mb-12 animate-fade-in relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-6 border-b border-white/5 pb-4",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-2xl font-bold text-white tracking-tight flex items-center gap-3",children:[t,s.jsx("span",{className:"text-sm font-medium text-gray-500 bg-gray-800 px-2 py-0.5 rounded-full",children:e.length})]})}),u&&s.jsxs("button",{onClick:()=>l(!a),className:"text-indigo-400 hover:text-indigo-300 text-sm font-bold uppercase tracking-wider transition-colors flex items-center gap-2",children:[a?"Show Less":`Show All (${e.length})`,s.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${a?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.map(h=>s.jsx(Woe,{deck:h},h.id))}),i&&e.length===0&&s.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-center bg-gray-900/20 rounded-3xl border border-dashed border-gray-800",children:[s.jsx("p",{className:"text-gray-500 mb-6",children:"You haven't built any decks yet."}),s.jsx(_t,{to:"/decks/new",className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl transition-all",children:"Create Deck"})]})]})},Goe=({friend:t})=>{const{decks:e,loading:r,error:n}=Pd(t.owner_id),i=t.owner?.username||t.owner_username||"Unknown Friend";return!r&&!n&&e.length===0?null:s.jsx(P9,{title:`Decks by ${i}`,decks:e,loading:r,error:n,isOwner:!1})},Voe=()=>{const{user:t,userProfile:e}=Mt(),{addToast:r}=_r(),[n,i]=y.useState([]),{decks:a,loading:l,error:d}=Pd(null);y.useEffect(()=>{t&&(async()=>{try{const p=await ts.fetchIncomingPermissions(),m=(Array.isArray(p)?p:[]).filter(x=>!x.target_deck_id);i(m)}catch(p){console.error("Failed to load shared sources",p)}})()},[t]);const u=h=>{const p=Gr[e?.subscription_tier||"free"].limits.decks,m=a?.length||0;p!==1/0&&m>=p&&(h.preventDefault(),r(`Deck limit reached (${m}/${p}). Upgrade to create more!`,"error"))};return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/10 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-10 relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-end mb-12",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight mb-2",children:"My Strategies"}),s.jsx("p",{className:"text-gray-400 font-medium",children:"Manage your collection and view shared decks."})]}),s.jsxs(_t,{to:"/decks/new",onClick:u,className:"group bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs transition-all shadow-lg shadow-indigo-500/20 flex items-center gap-2 border border-indigo-400/20 hover:border-indigo-400",children:[s.jsx("span",{className:"text-xl leading-none font-light",children:"+"}),"Create New Deck"]})]}),s.jsx(P9,{title:"My Decks",decks:a,loading:l,error:d,isOwner:!0}),n.length>0&&s.jsxs("div",{className:"mt-16 border-t border-white/5 pt-12",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-500 uppercase tracking-widest mb-8 flex items-center gap-4",children:[s.jsx("span",{className:"h-px bg-gray-800 flex-1"}),"Shared Libraries",s.jsx("span",{className:"h-px bg-gray-800 flex-1"})]}),s.jsx("div",{className:"space-y-4",children:n.map(h=>s.jsx(Goe,{friend:h},h.id))})]})]})]})},Koe=({isOpen:t,onClose:e,onAdd:r})=>{const{addToast:n}=_r(),[i,a]=y.useState(""),[l,d]=y.useState(!1),[u,h]=y.useState([]),[p,m]=y.useState(null),[x,b]=y.useState(!1),[v,w]=y.useState([]),[k,_]=y.useState("and"),[T,A]=y.useState(""),[I,O]=y.useState(""),M=B=>{w(C=>C.includes(B)?C.filter(U=>U!==B):[...C,B])},E=async B=>{B.preventDefault();const C=v.length>0||T.trim()||I.trim();if(!(!i.trim()&&!C)){d(!0);try{let U=null;if(I.trim()){const K=I.trim().match(/^([<>]=?|=)?\s*(\d+)$/);K&&(U={operator:K[1]||"=",value:parseInt(K[2],10)})}const L={query:i,type:"legendary creature",text:T,colors:v.length>0?v:void 0,colorIdentity:!0,colorLogic:k,mv:U},q=await Pe.post("/api/cards/search",L);h(q.data||[])}catch(U){console.error(U),n("Search failed. The Oracle is unreachable.","error")}finally{d(!1)}}},R=async B=>{m({id:B.id,name:B.name});try{const C={scryfall_id:B.id,name:B.name,set_code:B.set,collector_number:B.collector_number,finish:"nonfoil",count:1,data:B,is_wishlist:!0};await Pe.post("/api/collection",C),n(`"${B.name}" added to Wishlist!`,"success"),r&&r(),e()}catch(C){console.error(C),n("Failed to add to wishlist.","error")}finally{m(null)}};if(!t)return null;const $={W:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",symbol:"https://svgs.scryfall.io/card-symbols/W.svg"},U:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",symbol:"https://svgs.scryfall.io/card-symbols/U.svg"},B:{bg:"bg-gray-300",text:"text-gray-800",border:"border-gray-400",symbol:"https://svgs.scryfall.io/card-symbols/B.svg"},R:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",symbol:"https://svgs.scryfall.io/card-symbols/R.svg"},G:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",symbol:"https://svgs.scryfall.io/card-symbols/G.svg"}};return ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:[s.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] flex flex-col border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gray-950/50 flex justify-between items-center shrink-0",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-purple-400",children:"Summon Legend"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/20 text-purple-300 uppercase tracking-wider border border-purple-500/30",children:"Wishlist"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search the multiverse for a commander you don't own yet."})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"bg-gray-900 border-b border-white/5 flex flex-col shrink-0",children:s.jsxs("form",{onSubmit:E,className:"p-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",value:i,onChange:B=>a(B.target.value),placeholder:"Search by name...",className:"w-full bg-gray-950 border border-white/10 rounded-2xl py-4 pl-14 pr-14 text-lg text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all shadow-inner",autoFocus:!x}),s.jsx("svg",{className:"absolute left-5 top-5 w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&s.jsx("button",{type:"button",onClick:()=>a(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("button",{type:"button",onClick:()=>b(!x),className:`px-4 rounded-2xl border border-white/10 flex items-center gap-2 font-bold transition-all ${x?"bg-purple-600 text-white border-purple-500":"bg-gray-950 text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[s.jsx(SP,{className:"w-5 h-5"}),"Filters"]}),s.jsx("button",{type:"submit",disabled:l,className:"px-8 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-2xl transition-all disabled:opacity-50 shadow-lg shadow-purple-500/20",children:l?"Searching...":"Search"})]}),s.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${x?"max-h-96 opacity-100 mt-6":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"bg-gray-950/50 rounded-2xl p-6 border border-white/5 grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Color Identity"}),s.jsx("div",{className:"flex gap-2",children:Object.entries($).map(([B,C])=>s.jsx("button",{type:"button",onClick:()=>M(B),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all border-2 ${v.includes(B)?"border-white scale-110 shadow-lg":"border-transparent opacity-60 hover:opacity-100 hover:scale-105"}`,style:{backgroundColor:v.includes(B)?"transparent":""},children:s.jsx("img",{src:C.symbol,alt:B,className:`w-full h-full ${v.includes(B)?"drop-shadow-md":"grayscale"}`})},B))}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[s.jsx("span",{className:`cursor-pointer ${k==="or"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>_("or"),children:"Includes any (OR)"}),s.jsx("div",{className:"w-10 h-5 bg-gray-800 rounded-full relative cursor-pointer border border-white/10",onClick:()=>_(B=>B==="or"?"and":"or"),children:s.jsx("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-purple-500 transition-all ${k==="and"?"left-5.5":"left-0.5"}`})}),s.jsx("span",{className:`cursor-pointer ${k==="and"?"text-purple-400 font-bold":"text-gray-600"}`,onClick:()=>_("and"),children:"Exact match (AND)"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Oracle Text"}),s.jsx("input",{type:"text",value:T,onChange:B=>A(B.target.value),placeholder:"e.g. 'draw cards', 'counter'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm"}),s.jsx("p",{className:"text-[10px] text-gray-600",children:"Searches abilities and rules text."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Mana Value (CMC)"}),s.jsx("input",{type:"text",value:I,onChange:B=>O(B.target.value),placeholder:"e.g. '4' or '<= 3'",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 text-sm font-mono"})]})]})})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-950/30 custom-scrollbar",children:[!l&&u.length===0&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40",children:[s.jsx("svg",{className:"w-24 h-24 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),s.jsx("p",{className:"text-xl font-bold text-gray-400",children:"No legends found."}),s.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:u.map(B=>{const C=B.image_uris?.art_crop||B.image_uris?.normal||B.data?.image_uris?.art_crop||B.data?.image_uris?.normal,U=p?.id===B.id;return s.jsxs("div",{className:"group relative bg-gray-900 rounded-2xl border border-white/5 overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-2xl hover:shadow-purple-500/10 hover:-translate-y-1",children:[s.jsxs("div",{className:"h-60 w-full bg-black relative",children:[C?s.jsx("img",{src:C,alt:B.name,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-500"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-700 font-bold",children:"No Art"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent"})]}),s.jsxs("div",{className:"p-4 relative",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-purple-300 transition-colors line-clamp-1",children:B.name}),s.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-1",children:B.type_line}),s.jsx("button",{onClick:()=>R(B),disabled:U,className:"w-full py-2 bg-white/5 hover:bg-purple-600 text-gray-300 hover:text-white rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 group-hover:bg-purple-600 group-hover:text-white",children:U?s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add to Wishlist"]})})]})]},B.id)})})]})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(168, 85, 247, 0.4); }
            `}})]}),document.body)},Yr={BASICS:1,COMMANDER:2,PARTNER:2.5,AI_STRATEGY:3,REVIEW:4},Yoe=()=>{const t=on(),{userProfile:e}=Mt(),{addToast:r}=_r(),[n,i]=y.useState(Yr.BASICS),[a,l]=y.useState(!1),[d,u]=y.useState("folder"),[h,p]=y.useState({}),[m,x]=y.useState(null),[b,v]=y.useState(""),[w,k]=y.useState("Commander"),[_,T]=y.useState([]),[A,I]=y.useState(null),[O,M]=y.useState(null),[E,R]=y.useState(""),[$,B]=y.useState(""),[C,U]=y.useState(null),[L,q]=y.useState("Consulting the Oracle..."),[K,W]=y.useState(!1),[V,X]=y.useState(!1),[Z,G]=y.useState([]),[F,Y]=y.useState(!0);y.useEffect(()=>{ne()},[]);const ne=async()=>{try{const me=await Pe.get("/api/precons/types");G(me)}catch(me){console.error("Failed to fetch precon types",me)}finally{Y(!1)}};y.useEffect(()=>{window.scrollTo(0,0)},[n]);const re=me=>{if(!me)return null;const Ie=me.data||me;return Ie.image_uris?.art_crop?Ie.image_uris.art_crop:Ie.card_faces?.[0]?.image_uris?.art_crop?Ie.card_faces[0].image_uris.art_crop:Ie.image_uris?.normal?Ie.image_uris.normal:null},ue=me=>{const Fe=(me.data||me).color_identity||[];return Fe.length>0?Fe:["C"]},Le=(me,Ie)=>{me==="Commander"||me==="Standard"?de(me,Ie):console.warn("Unknown format selected")},de=async(me,Ie)=>{l(!0);try{const Fe={unused:!0};me==="Commander"&&(Fe.type_line="legendary creature"),Ie||(Fe.wishlist="false");const qe=await Pe.get("/api/collection",Fe);T(qe),i(Yr.COMMANDER)}catch(Fe){console.error(Fe),r("Failed to load cards","error")}finally{l(!1)}},ve=me=>{if(I(me),w==="Standard"){r("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info"),i(Yr.REVIEW);return}const Ie=me.data||me,Fe=Ie.keywords||[],qe=Ie.oracle_text||"";if(Fe.includes("Partner")||qe.includes("Partner"))i(Yr.PARTNER);else{const He=Yt(e?.subscription_tier).features.aiStrategy;i(He?Yr.AI_STRATEGY:Yr.REVIEW)}},te=me=>{M(me);const Ie=Yt(e?.subscription_tier).features.aiStrategy;i(Ie?Yr.AI_STRATEGY:Yr.REVIEW)},ge=async()=>{if(w==="Standard")return;const me=e?.settings?.geminiApiKey,Ie=e?.settings?.helper?.name||"The Oracle";if(!me){r("AI Key missing. Skipping strategy.","warning"),i(Yr.REVIEW);return}l(!0),q(`${Ie} is analyzing ${O?"your commanders":"your commander"}...`);try{const Fe=O?`${A.name} & ${O.name}`:A.name,qe=await _s.getDeckStrategy(me,Fe,e.playstyle,[],e?.settings?.helper);qe.layout||(qe.layout={functional:{Lands:36,"Mana Ramp":10,"Card Draw":10,Removal:10,"Board Wipes":3,Synergy:30},types:{Creatures:30,Instants:10,Sorceries:10,Artifacts:10,Enchantments:4,Planeswalkers:0,Lands:36}}),U(qe),!b.trim()&&qe.suggestedName&&v(qe.suggestedName),i(Yr.REVIEW)}catch(Fe){console.error(Fe),r("AI Generation Failed. Proceeding manually.","error"),U({theme:"",strategy:"Manual strategy required.",layout:{functional:{Lands:36,Creatures:63},types:{Lands:36,Creatures:63}}}),i(Yr.REVIEW)}finally{l(!1)}},ke=async()=>{l(!0);try{const me={name:b||(O?`${A.name} & ${O.name}`:A?.name)||"New Commander Deck",format:w,commander:A?.data||A||null,commanderPartner:O?.data||O||null,aiBlueprint:C?{theme:C.theme,strategy:C.strategy,suggestedCounts:C.layout?.functional||C.layout,typeCounts:C.layout?.types}:null,isMockup:K},Ie=await Pe.post("/api/decks",me);r("Deck created successfully!","success"),t(`/decks/${Ie.id}`)}catch(me){console.error(me),r("Failed to create deck","error")}finally{l(!1)}};y.useEffect(()=>{n===Yr.AI_STRATEGY&&A&&!C&&ge()},[n]);const oe=({card:me,onClick:Ie,isSelected:Fe})=>{const qe=re(me),Xe=ue(me),He=me.data||me;return s.jsx("div",{onClick:()=>Ie(me),className:`group relative h-[480px] rounded-3xl cursor-pointer transition-all duration-300 hover:-translate-y-2 ${Fe?"ring-4 ring-indigo-500 scale-105":""}`,children:s.jsxs("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-md rounded-3xl border border-white/5 shadow-2xl group-hover:border-indigo-500/50 group-hover:shadow-indigo-500/20 transition-all overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"h-[55%] w-full relative overflow-hidden bg-gray-950",children:[qe?s.jsx("img",{src:qe,alt:me.name,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:s.jsx("span",{className:"text-gray-700 font-bold",children:"No Art"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-90"})]}),s.jsxs("div",{className:"h-[45%] p-5 flex flex-col relative",children:[s.jsxs("div",{className:"absolute -top-3 left-5 flex gap-2 z-10",children:[s.jsx("div",{className:"flex gap-1 bg-gray-900/90 backdrop-blur-md rounded-full px-2 py-1 border border-white/10 shadow-xl",children:Xe.map((ut,Tt)=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ut}.svg`,alt:ut,className:"w-4 h-4 shadow-sm"},Tt))}),me.finish==="foil"&&s.jsx("div",{className:"flex items-center justify-center w-8 h-8 -mt-1 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full shadow-[0_0_15px_rgba(250,204,21,0.6)] animate-pulse",title:"Foil",children:s.jsx("svg",{className:"w-5 h-5 text-white drop-shadow-sm",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),s.jsxs("div",{className:"mt-4 flex-1 flex flex-col gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white leading-tight line-clamp-2 mb-1 group-hover:text-indigo-300 transition-colors",children:me.name}),s.jsx("p",{className:"text-xs text-gray-400 font-medium line-clamp-1 border-b border-white/5 pb-2 mb-2",children:He.type_line})]}),s.jsx("p",{className:"text-[10px] text-gray-300 leading-relaxed font-serif opacity-80 line-clamp-4",children:He.oracle_text})]}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[He.power&&He.toughness&&s.jsxs("div",{className:"bg-gray-800/80 px-2 py-1 rounded text-xs font-bold text-white border border-white/10 shadow-inner",children:[He.power," / ",He.toughness]}),s.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select"})]})]})]})})},Ee=y.useMemo(()=>{if(!_.length)return{};const me={};return _.filter(Fe=>Fe.name.toLowerCase().includes(E.toLowerCase())||(Fe.data?.type_line||"").toLowerCase().includes(E.toLowerCase())).forEach(Fe=>{const qe=ue(Fe),Xe=R9(qe);me[Xe.badge]||(me[Xe.badge]={identity:Xe,cards:[]}),me[Xe.badge].cards.push(Fe)}),me},[_,E]),Te=()=>{const me=E.trim().length>0,Ie=Object.entries(Ee).sort((qe,Xe)=>{const He=qe[1].identity.colors.length-Xe[1].identity.colors.length;return He!==0?He:Xe[1].cards.length-qe[1].cards.length}),Fe=(qe,Xe,He)=>s.jsxs("div",{onClick:He,className:"w-full bg-gray-900/60 hover:bg-gray-800/60 backdrop-blur-md border border-white/5 rounded-2xl p-6 cursor-pointer transition-all flex items-center justify-between group mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-1.5 border border-white/5",children:qe.identity.colors.map(ut=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${ut}.svg`,alt:ut,className:"w-5 h-5 shadow-sm"},ut))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-indigo-300 transition-colors",children:qe.identity.badge}),s.jsxs("p",{className:"text-sm text-gray-400 italic line-clamp-1",children:['"',qe.identity.flavor,'"']})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[qe.cards.length," ",w==="Commander"?"Legends":"Cards"]}),s.jsx("svg",{className:`w-6 h-6 text-gray-400 transform transition-transform ${Xe?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-4 gap-4 shrink-0",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:w==="Commander"?"Choose Commander":"Choose Spotlight Card"}),s.jsx("p",{className:"text-gray-400",children:w==="Commander"?"Select the legend who will lead your deck.":"Select a card to feature as the face of your deck."})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:()=>X(!0),className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg shadow-purple-500/20 flex items-center gap-2 transition-all hover:-translate-y-0.5",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Database"]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-1 flex border border-white/10",children:[s.jsx("button",{onClick:()=>u("list"),className:`p-2 rounded-lg transition-all ${d==="list"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"List View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),s.jsx("button",{onClick:()=>u("folder"),className:`p-2 rounded-lg transition-all ${d==="folder"?"bg-indigo-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,title:"Folder View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:w==="Commander"?"Search legends...":"Search cards...",value:E,onChange:qe=>R(qe.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),E&&s.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:[d==="folder"&&!m&&s.jsx(s.Fragment,{children:Ie.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mb-6 border border-gray-700",children:s.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Cards Found"}),s.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:E?"No cards match your search filters.":"We couldn't find any qualifying cards in your collection."}),s.jsxs("button",{onClick:()=>X(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-500/20 hover:-translate-y-1 transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Full Database"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ie.map(([qe,Xe])=>s.jsxs("div",{onClick:()=>x(qe),className:"bg-gray-800/40 hover:bg-gray-700/50 border border-white/5 rounded-2xl p-6 cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl group flex flex-col items-center text-center gap-3 backdrop-blur-sm",children:[s.jsx("div",{className:"flex gap-1 bg-gray-950/50 rounded-full px-3 py-2 border border-white/5",children:Xe.identity.colors.map(He=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${He}.svg`,alt:He,className:"w-6 h-6"},He))}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-black text-white group-hover:text-indigo-300 transition-colors uppercase tracking-wide",children:Xe.identity.badge}),s.jsx("div",{className:"h-0.5 w-8 bg-indigo-500/50 mx-auto my-2"}),s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',Xe.identity.flavor,'"']})]}),s.jsxs("span",{className:"text-sm font-mono font-bold text-gray-500 bg-black/20 px-3 py-1 rounded-full mt-2",children:[Xe.cards.length," ",w==="Commander"?"Legends":"Cards"]})]},qe))})}),d==="folder"&&m&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("button",{onClick:()=>x(null),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors font-bold uppercase text-xs tracking-widest mb-4",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Groups"]}),s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("h3",{className:"text-3xl font-black text-white",children:Ee[m].identity.badge}),s.jsx("div",{className:"flex gap-1",children:Ee[m].identity.colors.map(qe=>s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${qe}.svg`,alt:qe,className:"w-6 h-6"},qe))})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ee[m].cards.map(qe=>s.jsx(oe,{card:qe,onClick:ve},qe.id))})]}),d==="list"&&s.jsx("div",{className:"space-y-4",children:Ie.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in border border-dashed border-gray-800 rounded-3xl",children:[s.jsx("p",{className:"text-gray-400",children:"No cards found in your collection matching criteria."}),s.jsx("button",{onClick:()=>X(!0),className:"text-indigo-400 font-bold hover:text-indigo-300 mt-2 hover:underline",children:"Search Scryfall Database"})]}):Ie.map(([qe,Xe])=>{const He=h[qe]||me;return s.jsxs("div",{children:[Fe(Xe,He,()=>p(ut=>({...ut,[qe]:!ut[qe]}))),He&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8 pl-4 border-l-2 border-white/5 animate-fade-in",children:Xe.cards.map(ut=>s.jsx(oe,{card:ut,onClick:ve},ut.id))})]},qe)})})]})]})},Ye=()=>{const me=_.filter(Ie=>{const Fe=Ie.data||Ie,qe=Fe.keywords||[],Xe=Fe.oracle_text||"",He=qe.includes("Partner")||Xe.includes("Partner");return Ie.id===A?.id||!He?!1:Ie.name.toLowerCase().includes($.toLowerCase())});return s.jsxs("div",{className:"animate-fade-in space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white mb-2",children:"Choose Partner"}),s.jsxs("p",{className:"text-gray-400",children:["Select a partner for ",A?.name,"."]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search partners...",value:$,onChange:Ie=>B(Ie.target.value),className:"bg-gray-800/50 border border-white/10 rounded-xl px-4 py-3 pl-10 pr-10 text-white placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 outline-none w-64 backdrop-blur-md"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),$&&s.jsx("button",{onClick:()=>B(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("button",{onClick:()=>{M(null),i(Yr.AI_STRATEGY)},className:"text-sm font-bold text-gray-400 hover:text-white underline self-center",children:"Skip / Solo Commander"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[me.map(Ie=>s.jsx(oe,{card:Ie,onClick:te},Ie.id)),me.length===0&&s.jsx("div",{className:"col-span-full py-20 text-center text-gray-500",children:"No valid partners found matching your search."})]})]})},ze=()=>s.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in text-center",children:[s.jsxs("div",{className:"relative mb-8",children:[s.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full animate-ping absolute inset-0"}),s.jsx("div",{className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center relative shadow-[0_0_50px_rgba(79,70,229,0.5)]",children:s.jsx("svg",{className:"w-10 h-10 text-white animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})]}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:L}),s.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:"Brewing a perfect strategy tailored to your playstyle."})]}),le=()=>{const me=C?.layout?.functional||{},Ie=C?.layout?.types||{};return s.jsxs("div",{className:"animate-fade-in flex flex-col space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-6 mb-8 shrink-0 sticky -top-8 z-30 bg-gray-950/90 backdrop-blur-xl pt-4 pb-6 -mx-8 px-8 rounded-t-3xl border-b border-white/5",children:[s.jsxs("div",{className:"space-y-2 flex-1 w-full",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deck Name"}),s.jsx("input",{type:"text",value:b,onChange:Fe=>v(Fe.target.value),className:"w-full text-4xl font-black bg-transparent border-b-2 border-white/10 focus:border-indigo-500 text-white placeholder-gray-600 outline-none pb-2 transition-colors",placeholder:"Name your deck..."})]}),s.jsxs("button",{onClick:ke,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold py-4 px-10 rounded-2xl shadow-lg shadow-indigo-500/20 transform hover:-translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 shrink-0",children:[a?"Forging...":"Create Deck",!a&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),s.jsx("div",{className:"space-y-8 flex-1",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md",children:[s.jsx("h3",{className:"text-xl font-bold text-indigo-300 mb-4",children:"Theme & Strategy"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Theme"}),s.jsx("p",{className:"text-lg text-white font-medium",children:C?.theme})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Gameplan"}),s.jsx("div",{className:"text-sm text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:C?.strategy}})]})]})]}),s.jsxs("div",{className:"bg-gray-800/40 border border-white/5 rounded-2xl p-6 backdrop-blur-md space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Composition Preview"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Functional Needs"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(me).map(([Fe,qe])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:Fe}),s.jsx("span",{className:"font-mono font-bold text-indigo-400",children:qe})]},Fe))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Type Balance"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(Ie).map(([Fe,qe])=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 px-3 py-2 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-300",children:Fe}),s.jsx("span",{className:"font-mono font-bold text-emerald-400",children:qe})]},Fe))})]})]})]})})]})},pe=A?re(A):null;return s.jsxs("div",{className:"min-h-screen bg-gray-950 relative flex flex-col pb-20",children:[pe&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-cover bg-center transition-all duration-1000 transform scale-105",style:{backgroundImage:`url(${pe})`}}),s.jsx("div",{className:"fixed inset-0 bg-gray-950/60 backdrop-blur-2xl transition-all duration-1000"}),s.jsx("div",{className:"fixed inset-0 bg-gradient-to-t from-gray-950 via-gray-950/50 to-transparent"})]}),!pe&&s.jsx("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-indigo-900/20 blur-[120px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto w-full px-6 py-8",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx("button",{onClick:()=>t("/decks"),className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m-7 7h18"})})}),s.jsx("div",{className:"h-8 w-[1px] bg-white/10 mx-2"}),s.jsx("div",{className:"flex gap-2",children:[Yr.BASICS,Yr.COMMANDER,Yr.AI_STRATEGY,Yr.REVIEW].map((me,Ie)=>s.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${n>=me?"w-12 bg-indigo-500":"w-4 bg-gray-700"}`},me))})]}),s.jsxs("div",{className:"bg-gray-950/40 border border-white/5 rounded-3xl p-8 shadow-2xl backdrop-blur-xl animate-fade-in-up",children:[a&&n!==Yr.AI_STRATEGY&&s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}),!a&&n===Yr.BASICS&&s.jsxs("div",{className:"flex flex-col items-center space-y-12 animate-fade-in py-8",children:[s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tight text-center",children:["Let's build something ",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400",children:"legendary."})]}),s.jsxs("div",{className:"w-full max-w-5xl px-4 space-y-12",children:[A&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-white/5 backdrop-blur-sm animate-fade-in-down",children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:w==="Commander"?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"flex gap-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl opacity-50 group-hover:opacity-75 blur transition duration-500"}),s.jsx("img",{src:A.image_uris?.normal||A.image_uris?.large,alt:A.name,className:"relative w-64 rounded-xl shadow-2xl transform group-hover:scale-[1.02] transition-all duration-500"})]}),s.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-3xl font-black text-white mb-2",children:A.name}),s.jsx("p",{className:"text-gray-400 text-sm",children:A.type_line}),s.jsx("p",{className:"text-gray-300 mt-4 text-base leading-relaxed",children:A.oracle_text})]}),s.jsxs("button",{onClick:()=>I(null),className:"self-start text-sm font-bold text-red-400 hover:text-red-300 underline mt-4",children:["Change ",w==="Commander"?"Commander":"Spotlight Card"]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Commander"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{W(!1),k("Commander"),Le("Commander",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-indigo-900/20 border border-white/10 hover:border-indigo-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-indigo-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-indigo-300 transition-colors",children:"From Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build using only cards you own.",s.jsx("br",{}),"Oracle verifies your binder."]})]})]}),s.jsxs("div",{onClick:()=>{W(!0),k("Commander"),Le("Commander",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-purple-900/20 border border-white/10 hover:border-purple-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-purple-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-purple-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-purple-300 transition-colors",children:"Theorycraft Mockup"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Design without limits.",s.jsx("br",{}),"Missing cards added to wishlist."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Standard"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{onClick:()=>{W(!1),k("Standard"),Le("Standard",!1)},className:"group cursor-pointer bg-gray-800/40 hover:bg-emerald-900/20 border border-white/10 hover:border-emerald-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-emerald-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-emerald-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-emerald-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-emerald-300 transition-colors",children:"Standard Collection"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Build a 60-card Standard deck.",s.jsx("br",{}),"Using your own cards."]})]})]}),s.jsxs("div",{onClick:()=>{W(!0),k("Standard"),Le("Standard",!0)},className:"group cursor-pointer bg-gray-800/40 hover:bg-cyan-900/20 border border-white/10 hover:border-cyan-500/50 rounded-3xl p-8 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-cyan-500/10 flex flex-col items-center text-center gap-4 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-20 h-20 bg-cyan-500/20 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-cyan-500/30",children:s.jsx("svg",{className:"w-10 h-10 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:text-cyan-300 transition-colors",children:"Standard Theorycraft"}),s.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed",children:["Test new Standard meta decks.",s.jsx("br",{}),"Without owning every card."]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-[0.3em]",children:"Precons"}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),F?s.jsx("div",{className:"flex justify-center p-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[Z.map(me=>s.jsxs("div",{onClick:()=>t(`/precons?type=${encodeURIComponent(me)}`),className:"group cursor-pointer bg-gray-800/40 hover:bg-amber-900/20 border border-white/10 hover:border-amber-500/50 rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl hover:shadow-amber-500/10 flex flex-col items-center text-center gap-3 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-500 border border-white/5 group-hover:border-amber-500/30",children:s.jsx("svg",{className:"w-6 h-6 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-amber-300 transition-colors",children:me})]},me)),Z.length===0&&s.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No precon types found. (Is the DB populated?)"})]})]})]})]}),!a&&n===Yr.COMMANDER&&Te(),!a&&n===Yr.PARTNER&&Ye(),n===Yr.AI_STRATEGY&&ze(),!a&&n===Yr.REVIEW&&le()]})]}),s.jsx(Koe,{isOpen:V,onClose:()=>X(!1),onAdd:()=>de()})]})};function I9(t){const[e,r]=y.useState(null),[n,i]=y.useState([]),[a,l]=y.useState(!0),[d,u]=y.useState(null),{currentUser:h}=Mt(),p=async(m=!1)=>{if(!(!h||!t||t==="new")){m||l(!0);try{const{deck:x,items:b}=await Pe.get(`/api/decks/${t}`);r(x),i(b.map(v=>({...v,countInDeck:v.count||1,managedId:v.id}))),u(null)}catch(x){console.error("Error fetching deck:",x),u(x)}finally{l(!1)}}};return y.useEffect(()=>{if(!h||!t){l(!1);return}p()},[h,t]),{deck:e,cards:n,loading:a,error:d,refresh:p}}const di={async addCardToDeck(t,e,r){return Pe.post("/api/collection",{scryfall_id:r.id,name:r.name,set_code:r.set||r.set_code,collector_number:r.collector_number,finish:r.finish||"nonfoil",data:r,deck_id:e,count:1})},async batchAddCardsToDeck(t,e,r,n="merge"){const i=r.map(a=>({...a,deck_id:e}));return Pe.batchAddToCollection(i,n)},async removeCardFromDeck(t,e,r){return Pe.put(`/api/collection/${r}`,{deck_id:null})},async updateCardQuantity(t,e,r,n){return n<=0?this.removeCardFromDeck(t,e,r):Pe.put(`/api/collection/${r}`,{count:n})},async setCommander(t,e,r){return Pe.put(`/api/decks/${e}`,{commander:r})},async importDeck(t,e,r,n){return Pe.post("/api/decks/import",{deck:e,cards:r,options:n})},async updateDeck(t,e,r){return Pe.put(`/api/decks/${e}`,r)},async deleteDeck(t,e,r={}){const n=new URLSearchParams(r).toString();return Pe.delete(`/api/decks/${e}?${n}`)},async batchRemoveCards(t,e,r,n="remove"){return Pe.delete(`/api/decks/${e}/cards?action=${n}`,{cardIds:r})}},Xoe=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",cancelText:l="Cancel",isDanger:d=!1,children:u})=>t?s.jsxs("div",{className:`fixed inset-0 z-[9999] flex items-center justify-center transition-all duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),s.jsx("div",{className:"relative bg-gray-800 rounded-xl shadow-2xl border border-gray-700 w-full max-w-md transform transition-all scale-100 animate-scale-in m-4",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",id:"modal-title",children:n}),s.jsx("p",{className:"text-gray-300 mb-6",children:i}),u,s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-gray-700 transition-colors font-medium",children:l}),s.jsx("button",{onClick:()=>{r(),e()},className:`px-4 py-2 rounded-lg text-white font-bold shadow-lg transition-transform transform hover:-translate-y-0.5 ${d?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:a})]})]})})]}):null,Joe=(t,e)=>{if(!t||t.length===0)return!0;const r=new Set(e||[]);return t.every(n=>r.has(n))},Qoe=({isOpen:t,onClose:e,deck:r,deckCards:n=[]})=>{const{cards:i,loading:a}=Gs(),{currentUser:l}=Mt(),{openCardModal:d}=L0(),[u,h]=y.useState(""),[p,m]=y.useState("All"),[x,b]=y.useState(!1),[v,w]=y.useState({colors:[],rarity:[],set:"",manaValue:""}),[k,_]=y.useState("name"),T=y.useMemo(()=>{if(!i||!r)return[];const O=r.format?.toLowerCase()==="standard",M=r.commander?.color_identity||[],E=r.commander_partner?.color_identity||[],R=new Set([...M,...E]);return i.filter(B=>{if(B.deckId)return!1;const C=B.type_line?.toLowerCase().includes("basic land");if(!O&&!Joe(B.color_identity,[...R]))return!1;if(v.colors.length>0){const K=B.color_identity||[];if(!v.colors.some(V=>V==="C"?K.length===0:K.includes(V)))return!1}if(v.rarity.length>0&&!v.rarity.includes(B.rarity?.toLowerCase()))return!1;if(v.set){const K=v.set.toLowerCase();if(!B.set?.toLowerCase().includes(K)&&!B.set_name?.toLowerCase().includes(K))return!1}if(v.manaValue!==""){const K=parseFloat(v.manaValue);if(B.cmc!==K)return!1}const U=n.filter(K=>K.name===B.name).reduce((K,W)=>K+(W.countInDeck||1),0);if(!C&&U>=(O?4:1))return!1;const q=u.toLowerCase();return!(q&&!B.name.toLowerCase().includes(q)&&!B.type_line?.toLowerCase().includes(q)||p!=="All"&&!B.type_line?.toLowerCase().includes(p.toLowerCase()))}).sort((B,C)=>{if(k==="name")return B.name.localeCompare(C.name);if(k.startsWith("price")){const U=parseFloat(B.prices?.usd||B.data?.prices?.usd||0),L=parseFloat(C.prices?.usd||C.data?.prices?.usd||0);return k==="price-asc"?U-L:L-U}if(k==="rarity"){const U={mythic:4,rare:3,uncommon:2,common:1},L=U[B.rarity?.toLowerCase()]||0;return(U[C.rarity?.toLowerCase()]||0)-L}return 0})},[i,r,n,u,p,v,k]),A=async O=>{try{await di.addCardToDeck(l.uid,r.id,O),addToast(`Added ${O.name} to deck`,"success")}catch(M){console.error(M),addToast("Failed to add card","error")}};if(!t)return null;const I=["All","Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"];return ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl h-[90vh] flex flex-col border border-gray-700",children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50 rounded-t-xl",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:"Add from Collection"}),s.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["(",T.length," available)"]})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Showing unassigned cards compatible with this deck."})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 hover:bg-gray-700 p-2 rounded-lg",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700 space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name, type, or text...",className:"w-full bg-gray-900 text-white border border-gray-700 rounded-lg py-3 px-4 pl-12 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-inner",value:u,onChange:O=>h(O.target.value),autoFocus:!0}),s.jsx("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:I.map(O=>s.jsx("button",{onClick:()=>m(O),className:`px-3 py-1 text-xs font-bold rounded-full transition-colors border ${p===O?"bg-indigo-600 text-white border-indigo-500 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-gray-200"}`,children:O},O))}),s.jsxs("button",{onClick:()=>b(!x),className:`flex items-center gap-2 px-4 py-1.5 text-xs font-bold rounded-lg border transition-all ${x?"bg-indigo-600 text-white border-indigo-500 shadow-lg":"bg-gray-900 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),x?"Hide Filters":"Advanced Filters"]})]}),x&&s.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-700 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in-down shadow-inner",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Color Identity"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[["W","U","B","R","G"].filter(O=>r?.format?.toLowerCase()==="standard"?!0:new Set([...r?.commander?.color_identity||[],...r?.commander_partner?.color_identity||[]]).has(O)).map(O=>s.jsx("button",{onClick:()=>w(M=>({...M,colors:M.colors.includes(O)?M.colors.filter(E=>E!==O):[...M.colors,O]})),className:`w-8 h-8 rounded-full border flex items-center justify-center transition-all ${v.colors.includes(O)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-gray-700":"opacity-40 grayscale hover:grayscale-0 hover:opacity-100 border-gray-600 bg-gray-800"}`,children:s.jsx("img",{src:`https://svgs.scryfall.io/card-symbols/${O}.svg`,alt:O,className:"w-5 h-5 shadow-sm"})},O)),s.jsx("button",{onClick:()=>w(O=>({...O,colors:O.colors.includes("C")?O.colors.filter(M=>M!=="C"):[...O.colors,"C"]})),className:`w-8 h-8 rounded-full border flex items-center justify-center text-[10px] font-black transition-all ${v.colors.includes("C")?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-gray-900 border-white bg-indigo-600 text-white":"opacity-40 border-gray-600 bg-gray-800 text-gray-500 hover:opacity-100"}`,children:"C"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(O=>s.jsx("button",{onClick:()=>w(M=>({...M,rarity:M.rarity.includes(O)?M.rarity.filter(E=>E!==O):[...M.rarity,O]})),className:`px-3 py-1 text-[10px] font-bold uppercase rounded-lg border transition-all ${v.rarity.includes(O)?"bg-indigo-600 text-white border-indigo-400 shadow-md":"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:text-gray-300"}`,children:O.charAt(0)},O))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Set (Name/Code)"}),s.jsx("input",{type:"text",placeholder:"e.g. MH3 or Modern Horizons 3",value:v.set,onChange:O=>w(M=>({...M,set:O.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Mana Value"}),s.jsx("input",{type:"number",min:"0",placeholder:"CMC",value:v.manaValue,onChange:O=>w(M=>({...M,manaValue:O.target.value})),className:"w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-500 mb-3",children:"Sort By"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("select",{value:k,onChange:O=>_(O.target.value),className:"bg-gray-800 text-gray-300 border border-gray-700 rounded-lg px-3 py-1.5 text-xs focus:outline-none focus:border-indigo-500 w-full",children:[s.jsx("option",{value:"name",children:"Name (A-Z)"}),s.jsx("option",{value:"price-desc",children:"Price (Highest)"}),s.jsx("option",{value:"price-asc",children:"Price (Lowest)"}),s.jsx("option",{value:"rarity",children:"Rarity"})]}),s.jsx("button",{onClick:()=>{w({colors:[],rarity:[],set:"",manaValue:""}),_("name"),h(""),m("All")},className:"text-[10px] font-bold text-indigo-400 hover:text-indigo-300 transition-colors uppercase tracking-widest mt-1",children:"Reset All"})]})]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-900/30 p-2 custom-scrollbar",children:a?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):T.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 space-y-2",children:[s.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),s.jsx("p",{children:"No cards found matching your criteria."})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:T.map(O=>{const M=O.data||O,E=M.image_uris?.art_crop||M.image_uris?.normal||M.card_faces?.[0]?.image_uris?.art_crop||M.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/100x100?text=No+Img";return s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-800/80 rounded-lg border border-gray-700/50 hover:bg-gray-700 hover:border-indigo-500/50 transition-all group cursor-pointer",onClick:()=>d(O),children:[s.jsxs("div",{className:"relative w-16 h-12 rounded overflow-hidden shrink-0 shadow-sm",children:[s.jsx("img",{src:E,className:"w-full h-full object-cover",alt:O.name,loading:"lazy"}),O.finish==="foil"&&s.jsx("div",{className:"absolute top-0.5 right-0.5 text-yellow-500 bg-black/40 rounded-full p-0.5 leading-none",title:"Foil",children:s.jsx("span",{className:"text-[10px]",children:""})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-gray-500 text-xs font-mono font-bold bg-gray-900 px-1 rounded",children:[O.count||1,"x"]}),s.jsx("h4",{className:"font-bold text-gray-200 text-sm truncate",children:O.name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[s.jsx("span",{className:"truncate max-w-[120px]",children:O.type_line}),s.jsx("span",{className:"bg-gray-700 px-1 rounded text-[10px]",children:O.set?.toUpperCase()})]})]}),s.jsx("button",{onClick:R=>{R.stopPropagation(),A(O)},className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg shadow-md transition-transform active:scale-95 shrink-0 flex items-center gap-1 text-xs font-bold",children:"Add"})]},O.firestoreId||O.id)})})})]})}),document.body)},Hm=[{key:"W",name:"White",color:"bg-yellow-100",text:"text-yellow-600",border:"border-yellow-200/50",bg:"bg-yellow-500/10",pip:""},{key:"U",name:"Blue",color:"bg-blue-400",text:"text-blue-400",border:"border-blue-500/30",bg:"bg-blue-500/10",pip:""},{key:"B",name:"Black",color:"bg-gray-600",text:"text-gray-400",border:"border-gray-500/30",bg:"bg-gray-500/10",pip:""},{key:"R",name:"Red",color:"bg-red-500",text:"text-red-400",border:"border-red-500/30",bg:"bg-red-500/10",pip:""},{key:"G",name:"Green",color:"bg-green-500",text:"text-green-400",border:"border-green-500/30",bg:"bg-green-500/10",pip:""},{key:"C",name:"Colorless",color:"bg-gray-400",text:"text-gray-500",border:"border-gray-600/30",bg:"bg-gray-600/10",pip:""}],Zoe=({cards:t=[]})=>{const e=y.useMemo(()=>{const n={pips:{W:0,U:0,B:0,R:0,G:0,C:0},production:{W:0,U:0,B:0,R:0,G:0,C:0},curve:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0},colorCurve:{W:[0,0,0,0,0,0,0,0],U:[0,0,0,0,0,0,0,0],B:[0,0,0,0,0,0,0,0],R:[0,0,0,0,0,0,0,0],G:[0,0,0,0,0,0,0,0],C:[0,0,0,0,0,0,0,0]},totalPips:0,totalProduction:0,nonLandCount:0,avgCMC:0};let i=0;return t.forEach(a=>{const l=a.data||a,d=(l.type_line||"").toLowerCase(),u=d.includes("land"),h=l.mana_cost||"",p=(l.oracle_text||"").toLowerCase();if(!u){n.nonLandCount+=a.countInDeck||1;const b=l.cmc??0;i+=b*(a.countInDeck||1),(h.match(/\{([^}]+)\}/g)||[]).forEach(k=>{k.slice(1,-1).split("/").forEach(A=>{if(["W","U","B","R","G","C"].includes(A)){n.pips[A]+=a.countInDeck||1,n.totalPips+=a.countInDeck||1;const I=Math.min(Math.floor(b),7);n.colorCurve[A][I]+=a.countInDeck||1}})});const w=b>=7?"7+":Math.floor(b);n.curve[w]+=a.countInDeck||1}let m=l.produced_mana||[];(p.includes("any color")||p.includes("mana of any color"))&&(m=["W","U","B","R","G"]),m.length===0&&u&&(d.includes("plains")&&m.push("W"),d.includes("island")&&m.push("U"),d.includes("swamp")&&m.push("B"),d.includes("mountain")&&m.push("R"),d.includes("forest")&&m.push("G")),!u&&p.includes("add {")&&["w","u","b","r","g","c"].forEach(b=>{p.includes(`add {${b}}`)&&m.push(b.toUpperCase())}),[...new Set(m)].forEach(b=>{n.production[b]!==void 0&&(n.production[b]+=a.countInDeck||1,n.totalProduction+=a.countInDeck||1)})}),n.avgCMC=n.nonLandCount>0?(i/n.nonLandCount).toFixed(2):0,n},[t]),r=(n,i="bg-indigo-500",a="h-48")=>{const l=Object.entries(n),d=Math.max(...l.map(u=>u[1]),1);return s.jsx("div",{className:`flex gap-1 ${a} w-full px-2`,children:l.map(([u,h])=>s.jsxs("div",{className:"flex-1 h-full flex flex-col justify-end items-center group relative",children:[h>0&&s.jsx("div",{className:`w-full ${i} rounded-t transition-all duration-500 group-hover:brightness-125`,style:{height:`${h/d*100}%`},children:s.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-bold text-white opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 px-1 rounded",children:h})}),s.jsx("div",{className:"text-[10px] font-bold text-gray-500 mt-2",children:u})]},u))})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Cost (Pips)"}),s.jsxs("span",{children:[e.totalPips," Total"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800",children:Hm.filter(n=>e.pips[n.key]>0).map(n=>s.jsx("div",{className:`${n.color} h-full transition-all duration-700`,style:{width:`${e.pips[n.key]/e.totalPips*100}%`},title:`${n.name}: ${e.pips[n.key]}`},n.key))})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s.jsx("span",{children:"Production"}),s.jsxs("span",{children:[e.totalProduction," Sources"]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-900/50 rounded-full overflow-hidden flex border border-gray-800 shadow-inner",children:Hm.filter(n=>e.production[n.key]>0).map(n=>s.jsx("div",{className:`${n.color} h-full transition-all duration-700 opacity-80`,style:{width:`${e.production[n.key]/e.totalProduction*100}%`},title:`${n.name}: ${e.production[n.key]}`},n.key))})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:Hm.map(n=>{const i=e.pips[n.key],a=e.production[n.key],l=e.totalPips>0?Math.round(i/e.totalPips*100):0,d=e.totalProduction>0?Math.round(a/e.totalProduction*100):0,u=i>0||a>0;return s.jsxs("div",{className:`p-4 rounded-2xl border transition-all duration-300 ${u?`${n.bg} ${n.border}`:"bg-gray-800/10 border-gray-800/50 opacity-40"}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("span",{className:"text-2xl",children:n.pip}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:`text-[10px] font-black uppercase tracking-tighter ${n.text}`,children:n.name})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Cost"}),s.jsxs("span",{className:"text-white",children:[l,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${n.color} transition-all duration-1000`,style:{width:`${l}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[i," pips"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-500 uppercase",children:[s.jsx("span",{children:"Prod"}),s.jsxs("span",{className:"text-white",children:[d,"%"]})]}),s.jsx("div",{className:"h-1.5 bg-gray-950 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${n.color} opacity-60 transition-all duration-1000`,style:{width:`${d}%`}})}),s.jsxs("div",{className:"text-[10px] text-gray-600 font-mono",children:[a," mana"]})]})]})]},n.key)})}),s.jsxs("div",{className:"bg-gray-950/40 p-6 rounded-2xl border border-gray-800/50",children:[s.jsx("div",{className:"flex justify-between items-end mb-8",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"Mana Curve"}),s.jsxs("p",{className:"text-xs text-gray-500 font-medium",children:["Average Mana Value (Non-lands): ",s.jsx("span",{className:"text-indigo-400",children:e.avgCMC})]})]})}),r(e.curve,"bg-indigo-500","h-40")]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Hm.filter(n=>e.pips[n.key]>0).map(n=>s.jsxs("div",{className:"bg-gray-900/30 p-4 rounded-xl border border-gray-800/50",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-lg",children:n.pip}),s.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${n.text}`,children:[n.name," Spells"]})]}),r(Object.fromEntries(e.colorCurve[n.key].map((i,a)=>[a===7?"7+":a,i])),n.color,"h-24")]},n.key))})]})},D9=({isOpen:t,onClose:e,cards:r,deckName:n})=>{const{userProfile:i}=Mt(),a=i?.settings?.helper?.name||"The Oracle";return t?s4.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-6xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/5 shrink-0",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[10px] font-black font-mono text-indigo-400 uppercase tracking-widest bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20",children:"Analytics"}),s.jsx("span",{className:"text-[10px] font-black font-mono text-gray-400 uppercase tracking-widest bg-white/5 px-2 py-0.5 rounded border border-white/5",children:a})]}),s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Deck Performance"})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-8 custom-scrollbar",children:s.jsx(Zoe,{cards:r})}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0",children:s.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Analytics"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body):null},ele=({isOpen:t,onClose:e,deck:r,cards:n=[],onStrategyUpdate:i})=>{const{userProfile:a,currentUser:l}=Mt(),{addToast:d}=_r(),u=a?.settings?.helper?.name||"The Oracle",[h,p]=Ge.useState(!1),[m,x]=Ge.useState(0),[b,v]=Ge.useState(!1);if(Ge.useEffect(()=>(t?(x(0),v(!1),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t||!r)return null;const w=r.aiBlueprint||{},k=w.strategy||`<p class="text-gray-400 italic">No strategy generated for this deck yet. Ask ${u} to analyze it.</p>`,_=w.theme||"Uncharted Strategy",T=[r.commander];r.commander_partner&&T.push(r.commander_partner);const A=T[m]||T[0],I=A?.card_faces?.length>1,O=()=>{if(!A)return"https://placehold.co/480x680?text=Commander";if(I){const C=A.card_faces[b?1:0];return C.image_uris?.art_crop||C.image_uris?.large||C.image_uris?.normal}return A.image_uris?.art_crop||A.image_uris?.large||A.image_uris?.normal||A.image_uri},M=w.layout?.functional||w.suggestedCounts||{},E=w.layout?.types||w.typeCounts||{},R=Yt(a?.subscription_tier).features.aiStrategy,$=!!w.strategy,B=async()=>{if(!a?.settings?.geminiApiKey){d("Gemini API Key missing in settings.","error");return}p(!0);try{console.log("[DeckStrategy] requesting new strategy...");const C=await _s.getDeckStrategy(a.settings.geminiApiKey,r.commander?.name||"Unknown Commander",a.playstyle,n,r.commander_partner?.name);console.log("[DeckStrategy] new strategy received:",C);const U=await di.updateDeck(l.uid,r.id,{aiBlueprint:{...w,theme:C.theme,strategy:C.strategy,layout:C.layout}});console.log("[DeckStrategy] update response:",U),d("Strategy updated based on your current build!","success"),await new Promise(L=>setTimeout(L,500)),i&&await i()}catch(C){console.error(C),d("Failed to rerun strategy analysis.","error")}finally{p(!1)}};return s4.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-md animate-fade-in overscroll-contain",children:[s.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl w-full max-w-5xl max-h-[90vh] mx-auto rounded-[2.5rem] border border-white/10 shadow-[0_0_50px_-12px_rgba(0,0,0,0.5)] flex flex-col overflow-hidden ring-1 ring-white/5 relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"}),s.jsx("div",{className:"absolute -top-[20%] -right-[10%] w-[500px] h-[500px] bg-indigo-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("div",{className:"absolute -bottom-[20%] -left-[10%] w-[500px] h-[500px] bg-purple-500/10 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"px-4 py-6 md:px-10 md:py-8 border-b border-white/5 flex flex-col md:flex-row justify-between items-center bg-white/5 shrink-0 relative z-10 gap-4 md:gap-0",children:[s.jsxs("div",{className:"flex items-center gap-4 md:gap-6 w-full md:w-auto",children:[s.jsx("div",{className:"w-14 h-14 bg-indigo-500/20 rounded-2xl flex items-center justify-center border border-indigo-500/30 shadow-inner backdrop-blur-sm",children:s.jsx("span",{className:"text-3xl",children:""})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl md:text-3xl font-black text-white tracking-tighter uppercase leading-none mb-1",dangerouslySetInnerHTML:{__html:_}}),s.jsxs("p",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.3em]",children:[u," Strategic Blueprint"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-4 w-full md:w-auto justify-end",children:[s.jsxs("button",{onClick:R?B:()=>d(`Upgrade to ${Gr[tt.TIER_2].name} to use AI Strategy tools.`,"info"),disabled:h||!R,className:`flex-1 md:flex-none flex items-center justify-center gap-2 md:gap-3 px-4 md:px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all border ${h||!R?"bg-white/5 text-gray-500 border-white/5 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white border-white/20 shadow-[0_0_20px_rgba(79,70,229,0.3)] hover:shadow-[0_0_30px_rgba(79,70,229,0.5)] active:scale-95"}`,title:R?"":`Requires ${Gr[tt.TIER_2].name} Tier`,children:[h?s.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{className:"md:hidden",children:h?"Consulting...":"Recreate"}),s.jsx("span",{className:"hidden md:inline",children:h?`Consulting with ${u}...`:`Have ${u} Recreate Strategy`})]}),s.jsx("div",{className:"w-px h-8 bg-white/10 mx-2"}),s.jsx("button",{onClick:e,className:"p-3 bg-white/5 hover:bg-white/10 rounded-2xl transition-all text-gray-400 hover:text-white border border-white/5 hover:border-white/10 group",children:s.jsx("svg",{className:"w-6 h-6 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-10 py-10 custom-scrollbar space-y-12 relative z-10 overscroll-contain",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-12",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"sticky top-0 space-y-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl rounded-[2rem] group-hover:bg-indigo-500/30 transition-all duration-700"}),s.jsxs("div",{className:"relative aspect-[4/5] rounded-[2rem] overflow-hidden shadow-2xl border border-white/10 z-10 bg-black/40",children:[s.jsx("img",{src:O(),className:"w-full h-full object-cover transition-transform duration-700 active:scale-95",alt:A?.name}),I&&s.jsx("button",{onClick:()=>v(!b),className:"absolute top-4 right-4 p-3 bg-black/60 hover:bg-indigo-600 backdrop-blur-md rounded-full text-white border border-white/20 shadow-lg transition-all group/flip z-30",title:"Flip Card",children:s.jsx("svg",{className:`w-5 h-5 transition-transform duration-500 ${b?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),s.jsx("div",{className:"absolute bottom-0 inset-x-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent",children:s.jsxs("div",{className:"text-white font-bold text-center text-sm leading-tight drop-shadow-md",children:[A.name,I&&s.jsx("span",{className:"block text-[9px] text-gray-400 font-normal mt-0.5 uppercase tracking-widest",children:b?"Back Face":"Front Face"})]})})]}),s.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 z-20",children:s.jsxs("div",{className:"bg-black/80 text-white px-5 py-2 rounded-full border border-white/10 shadow-xl backdrop-blur-md flex items-center gap-2 whitespace-nowrap",children:[s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Cards"}),s.jsx("div",{className:"w-px h-3 bg-white/20"}),s.jsxs("span",{className:"text-sm font-black font-mono",children:[(n||[]).length,"/100"]})]})})]}),s.jsxs("div",{className:"text-center pt-4 space-y-4",children:[s.jsxs("div",{onClick:()=>{x(0),v(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${m===0?"bg-indigo-500/10 border-indigo-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${m===0?"text-indigo-400":"text-gray-600"}`,children:"Lead Commander"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${m===0?"text-white":"text-gray-400"}`,children:T[0]?.name})]}),T[1]&&s.jsxs("div",{onClick:()=>{x(1),v(!1)},className:`cursor-pointer transition-all duration-300 p-2 rounded-xl border ${m===1?"bg-purple-500/10 border-purple-500/30":"border-transparent hover:bg-white/5"}`,children:[s.jsx("h4",{className:`text-[9px] font-black uppercase tracking-[0.3em] mb-1 ${m===1?"text-purple-400":"text-gray-600"}`,children:"Partnered With"}),s.jsx("div",{className:`font-bold text-sm leading-tight ${m===1?"text-white":"text-gray-400"}`,children:T[1].name})]})]})]})}),s.jsxs("div",{className:"space-y-10",children:[s.jsxs("div",{className:"bg-white/5 rounded-[2rem] p-8 border border-white/5 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-9xl",children:""})}),s.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-px bg-gray-700"}),$||R?"Tactical Overview":`Tactical Overview (Requires ${Gr[tt.TIER_2].name})`]}),s.jsx("div",{className:"text-gray-300 leading-relaxed strategy-content-refined font-medium text-lg/8",dangerouslySetInnerHTML:{__html:$||R?k:`<p class="italic text-gray-500">Strategy generation is available on the ${Gr[tt.TIER_2].name} tier. Upgrade to unlock deep strategic insights for your deck.</p>`}})]}),s.jsxs("div",{className:"space-y-8",children:[Object.keys(M).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"}),"Target Functional Needs"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(M).map(([C,U])=>s.jsxs("div",{className:"bg-white/5 p-5 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-indigo-400 transition-colors h-8 flex items-center justify-center",children:C}),s.jsx("div",{className:"text-3xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:U})]},C))})]}),Object.keys(E).length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-[10px] font-black text-purple-400/60 uppercase tracking-[0.2em] flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),"Target Type Distribution"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries(E).map(([C,U])=>s.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 text-center group hover:bg-white/10 hover:border-white/10 hover:-translate-y-1 transition-all duration-300 shadow-sm hover:shadow-xl",children:[s.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-2 group-hover:text-purple-400 transition-colors h-8 flex items-center justify-center",children:C}),s.jsx("div",{className:"text-2xl font-black text-white tracking-tighter group-hover:scale-110 transition-transform",children:U})]},C))})]})]})]})]})}),s.jsx("div",{className:"px-10 py-6 border-t border-white/5 bg-white/5 flex justify-end shrink-0 relative z-10",children:s.jsx("button",{onClick:e,className:"px-8 py-3.5 bg-gray-900/50 hover:bg-gray-800 text-white font-black rounded-2xl transition-all border border-white/10 hover:border-white/20 active:scale-95 text-[11px] uppercase tracking-[0.2em] shadow-lg",children:"Close Blueprint"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .strategy-content-refined h4 {
                    font-size: 1.1rem;
                    font-weight: 800;
                    color: white;
                    margin-top: 1.5rem;
                    margin-bottom: 0.5rem;
                }
                .strategy-content-refined p {
                    margin-bottom: 1rem;
                }
                .strategy-content-refined strong {
                    color: #a5b4fc; /* Indigo 300 */
                }
                .strategy-content-refined ul {
                    list-style-type: disc;
                    padding-left: 1.5rem;
                    margin-bottom: 1rem;
                    color: #9ca3af;
                }
                .custom-scrollbar::-webkit-scrollbar { width: 8px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; transition: background 0.3s; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); border: 2px solid transparent; background-clip: content-box; }
            `}})]}),document.body)},tle=({isOpen:t,onClose:e,deck:r,onUpdateDeck:n})=>{const{user:i}=Mt(),[a,l]=y.useState([]),[d,u]=y.useState([]),[h,p]=y.useState(!0),[m,x]=y.useState(!1),[b,v]=y.useState(""),[w,k]=y.useState(!1),[_,T]=y.useState(""),[A,I]=y.useState("viewer"),[O,M]=y.useState(!1);y.useEffect(()=>{t&&r&&(R(),x(r.is_public||!1),v(r.share_slug||E(r.name)))},[t,r]);const E=L=>L.toLowerCase().replace(/[^a-z0-9]+/g,"-")+"-"+Math.random().toString(36).substring(2,6),R=async()=>{p(!0);try{const L=await ts.fetchPermissions(r.id);l(L);const K=(await ts.fetchRelationships()).filter(W=>W.status==="accepted").map(W=>W.friend);u(K)}catch(L){console.error("Failed to load share data",L)}finally{p(!1)}},$=async L=>{if(L.preventDefault(),!!_){M(!0);try{await ts.grantPermission(_,A,r.id),await R(),T("")}catch(q){alert(`Failed to share: ${q.message}`)}finally{M(!1)}}},B=async L=>{try{await ts.revokePermission(L),await R()}catch{alert("Failed to revoke access.")}},C=async()=>{const L=!m,q=b||E(r.name);try{await ts.updateDeckPublicStatus(r.id,L,q),x(L),v(q),n({...r,is_public:L,share_slug:q})}catch{alert("Failed to update public status.")}},U=()=>{const L=window.location.origin;navigator.clipboard.writeText(`${L}/share/${b}`),k(!0),setTimeout(()=>k(!1),2e3)};return t?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-gray-900 border border-indigo-500/20 rounded-2xl w-full max-w-lg shadow-2xl p-6 animate-fade-in-up",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Share Deck"}),s.jsx("p",{className:"text-sm text-gray-400 mb-6 truncate",children:r?.name}),s.jsxs("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl p-4 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${m?"bg-green-500":"bg-gray-500"}`}),s.jsx("span",{className:"font-bold text-gray-200",children:"Public Link"})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"sr-only peer",checked:m,onChange:C}),s.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500"})]})]}),m&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}/share/${b}`,className:"flex-1 bg-gray-950 border border-gray-700 rounded-lg px-3 py-2 text-xs text-gray-300 select-all"}),s.jsx("button",{onClick:U,className:"px-3 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-colors",children:w?"Copied!":"Copy"})]}),s.jsx("div",{className:"flex justify-center p-4 bg-white rounded-xl w-fit mx-auto shadow-lg",children:s.jsx(ZP,{value:`${window.location.origin}/share/${b}`,size:128,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 128 128"})}),s.jsx("p",{className:"text-center text-[10px] text-gray-400",children:"Scan to view on mobile"})]}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:m?"Anyone with this link can view this deck.":"Only people you explicitly add below can access this deck."})]}),s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest mb-3",children:"Add People"}),s.jsxs("form",{onSubmit:$,className:"flex gap-2 mb-6",children:[s.jsxs("select",{value:_,onChange:L=>T(L.target.value),className:"flex-1 bg-gray-800 border border-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500",required:!0,children:[s.jsx("option",{value:"",children:"Select a friend..."}),d.map(L=>s.jsx("option",{value:L.id,children:L.username},L.id))]}),s.jsxs("select",{value:A,onChange:L=>I(L.target.value),className:"bg-gray-800 border border-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500",children:[s.jsx("option",{value:"viewer",children:"Viewer"}),s.jsx("option",{value:"contributor",children:"Contributor"}),s.jsx("option",{value:"editor",children:"Editor"})]}),s.jsx("button",{type:"submit",disabled:O||!_,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg font-bold text-sm transition-colors",children:"Add"})]}),s.jsx("div",{className:"space-y-4 max-h-[200px] overflow-y-auto",children:a.length===0?s.jsx("p",{className:"text-center text-gray-500 text-xs italic py-4",children:"No specific people have access."}):a.map(L=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-300 text-xs font-bold",children:L.grantee_username?.[0]?.toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold text-gray-200",children:L.grantee_username}),s.jsx("div",{className:"text-xs text-gray-500 capitalize",children:L.permission_level})]})]}),s.jsx("button",{onClick:()=>B(L.id),className:"text-red-400 hover:text-red-300 text-xs font-bold px-2 py-1 rounded bg-red-500/10 hover:bg-red-500/20 transition-colors",children:"Remove"})]},L.id))})]})]}):null},B9=({isOpen:t,onClose:e,deck:r,cards:n,isOwner:i})=>{const{userProfile:a,currentUser:l}=Mt(),{addToast:d}=_r();on();const u=a?.settings?.helper?.name||"The Oracle",[h,p]=y.useState(!1),[m,x]=y.useState(r?.aiBlueprint?.grade||null),[b,v]=y.useState(!1);if(Ge.useEffect(()=>{t&&r?.aiBlueprint?.grade&&x(r.aiBlueprint.grade)},[t,r]),!t)return null;const w=async()=>{p(!0);try{const k=a?.settings?.geminiApiKey;if(!k){d("Please save your API Key in Settings > AI first.","error"),p(!1);return}const _=await _s.gradeDeck(k,{deckName:r.name,commander:r.commander?.name||"Unknown",cards:n,playerProfile:"Competitive but casual friendly",strategyGuide:r.description||"General synergy",helperPersona:a?.settings?.helper});if(x(_),i){const T={...r.aiBlueprint,grade:_,lastDiagnosed:new Date().toISOString()};await di.updateDeck(l.uid,r.id,{aiBlueprint:T}),d("Power Level Calibrated & Saved!","success")}}catch(k){console.error(k),d("Doctor is out. Try again later.","error")}finally{p(!1)}};return s4.createPortal(s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 w-full max-w-4xl rounded-3xl border border-white/10 shadow-2xl p-8 relative flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-start mb-8 relative z-10",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white italic uppercase",children:"Deck Power Analysis"}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Evaluated by ",u]})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white p-2",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center pointer-events-none opacity-[0.12] saturate-[1.5] brightness-125",children:s.jsx("img",{src:"/icons/deck_doctor.png",alt:"",className:"w-[80%] h-[80%] object-contain"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-12 relative z-10",children:[!m&&!h&&s.jsxs("div",{className:"text-center py-20",children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Ready to calibrate?"}),s.jsx("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"This process will analyze every card in your deck to determine its competitive bracket and numerical power level."}),s.jsxs("button",{onClick:w,className:"px-10 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black text-lg rounded-2xl shadow-xl hover:shadow-indigo-500/20 transition-all uppercase tracking-widest flex items-center gap-3 mx-auto",children:[s.jsx("span",{children:"Run Diagnosis"}),s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),h&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-6",children:[s.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-b-4 border-indigo-500"}),s.jsx("p",{className:"text-indigo-400 font-black text-xl animate-pulse uppercase tracking-widest",children:"Simulating Matchups..."})]}),m&&s.jsxs("div",{className:"animate-fade-in space-y-10",children:[s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"inline-flex flex-col items-center",children:[s.jsx("span",{className:"text-gray-500 font-bold uppercase tracking-widest text-sm mb-2",children:"Power Level"}),s.jsxs("div",{className:"text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 filter drop-shadow-lg",children:[Number(m.powerLevel).toFixed(2),s.jsx("span",{className:"text-3xl text-gray-600 ml-2",children:"/ 10"})]})]})}),s.jsxs("div",{className:"grid grid-cols-3 gap-8 max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[m.metrics.efficiency,s.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Efficiency"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[m.metrics.interaction,s.jsx("span",{className:"text-base text-gray-500",children:"/10"})]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Interaction"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-800/50 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["Turn ",m.metrics.winTurn]}),s.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest font-bold",children:"Avg Win Turn"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"text-center text-gray-500 text-xs font-black uppercase tracking-[0.2em]",children:["Commander Bracket: ",m.commanderBracket]}),s.jsx("div",{className:"grid grid-cols-5 gap-1 h-32 rounded-2xl overflow-hidden border border-white/10",children:[{id:1,label:"Exhibition",desc:"Ultra-Casual",color:"bg-yellow-500/20 text-yellow-500 border-yellow-500/50"},{id:2,label:"Core",desc:"Average Precon",color:"bg-green-500/20 text-green-500 border-green-500/50"},{id:3,label:"Upgraded",desc:"Beyond Precon",color:"bg-blue-500/20 text-blue-500 border-blue-500/50"},{id:4,label:"Optimized",desc:"High Power",color:"bg-orange-500/20 text-orange-500 border-orange-500/50"},{id:5,label:"cEDH",desc:"Competitive",color:"bg-purple-500/20 text-purple-500 border-purple-500/50"}].map(k=>{const _=m.commanderBracket===k.id;return s.jsxs("div",{className:`relative flex flex-col items-center justify-center p-4 border-t-4 transition-all ${_?`bg-gray-800 ${k.color.replace("/20","/10")} border-t-4 border-b-0 border-l-0 border-r-0`:"bg-gray-950 border-gray-800 opacity-40 grayscale"}`,style:{borderColor:_?void 0:"transparent"},children:[_&&s.jsx("div",{className:"absolute top-2 right-2 bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded",children:"MATCH"}),s.jsx("div",{className:`text-2xl font-black mb-1 ${_?k.color.split(" ")[1]:"text-gray-500"}`,children:k.id}),s.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider mb-1",children:k.label}),s.jsx("div",{className:"text-[10px] text-gray-400 text-center leading-tight",children:k.desc})]},k.id)})})]}),s.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-white/5",children:[s.jsx("h4",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-2",children:"Bracket Justification"}),s.jsxs("p",{className:"text-gray-300 leading-relaxed italic",children:['"',m.bracketJustification,'"']})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""})," Clinical Critique"]}),s.jsx("div",{className:"bg-gray-950/50 p-8 rounded-3xl border border-white/5 shadow-inner",children:s.jsx("p",{className:"text-gray-300 leading-relaxed text-lg font-medium",children:m.critique})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-orange-500",children:""})," Mechanical improvements"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.mechanicalImprovements.map((k,_)=>s.jsxs("div",{className:"flex gap-4 p-5 bg-white/5 rounded-2xl border border-white/5 items-start group hover:bg-orange-500/10 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400 font-bold shrink-0",children:_+1}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed group-hover:text-white transition-colors",children:k})]},_))})]}),s.jsxs("div",{className:"space-y-6 pb-12",children:[s.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-2",children:[s.jsx("span",{className:"text-red-500",children:""})," Surgical Swaps"]}),s.jsx("div",{className:"space-y-4",children:m.recommendedSwaps.map((k,_)=>s.jsxs("div",{className:"p-6 bg-gray-950/50 rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[s.jsxs("div",{className:"flex-1 w-full",children:[s.jsx("div",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest mb-2",children:"Cut This Card"}),s.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:s.jsx("span",{className:"text-white font-bold",children:k.remove})})]}),s.jsx("div",{className:"flex items-center justify-center",children:s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 border border-white/10 flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})}),s.jsxs("div",{className:"flex-1 w-full",children:[s.jsx("div",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest mb-2",children:"Slot This In"}),s.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl text-right",children:s.jsx("span",{className:"text-white font-bold",children:k.add})})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['"',k.reason,'"']})})]},_))})]}),s.jsx("div",{className:"flex justify-center pb-12",children:s.jsxs("button",{onClick:w,disabled:h,className:"flex items-center gap-2 px-8 py-3 bg-indigo-900/40 hover:bg-indigo-600/40 text-indigo-300 rounded-xl border border-indigo-500/20 transition-all font-bold uppercase text-xs tracking-widest group",children:[s.jsx("svg",{className:`w-4 h-4 transition-transform duration-700 ${h?"animate-spin":"group-hover:rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),h?"Consulting Oracle...":"Rerun Diagnosis"]})})]})]})]})}),document.body)},Wm=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],rle=()=>{const{deckId:t}=ol(),e=on(),{currentUser:r,userProfile:n,updateSettings:i}=Mt(),{addToast:a}=_r(),l=n?.settings?.helper?.name||"The Oracle",[d,u]=y.useState(!1),[h,p]=y.useState(!1),[m,x]=y.useState(!1),[b,v]=y.useState(!1),[w,k]=y.useState(""),[_,T]=y.useState(0),[A,I]=y.useState(!1),[O,M]=y.useState(!1),[E,R]=y.useState(new Set),$=je=>{const Ce=new Set(E);Ce.has(je)?Ce.delete(je):Ce.add(je),R(Ce)},B=()=>{E.size===pe.length?R(new Set):R(new Set(pe.map(je=>je.id)))},C=async()=>{if(E.size===0)return;const je=le.is_mockup?"delete":"remove",Ce=E.size;if(window.confirm(`Are you sure you want to ${je==="delete"?"delete":"remove"} ${Ce} cards?`))try{await di.batchRemoveCards(r.uid,t,Array.from(E),je),a(`Successfully removed ${Ce} cards`,"success"),M(!1),R(new Set),window.location.reload()}catch(Oe){console.error(Oe),a("Failed to remove cards","error")}},[U,L]=y.useState({}),[q,K]=y.useState(!1),[W,V]=y.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[X,Z]=y.useState(!1),[G,F]=y.useState(!1),[Y,ne]=y.useState(!1),[re,ue]=y.useState(!1),[Le,de]=y.useState(!1),[ve,te]=y.useState(!1),ge=y.useRef(null),ke=y.useRef(null),[oe,Ee]=y.useState(!0),[Te,Ye]=y.useState(n?.settings?.deckViewMode||"grid");y.useEffect(()=>{const je=Ce=>{ge.current&&!ge.current.contains(Ce.target)&&(te(!1),de(!1))};return document.addEventListener("mousedown",je),()=>document.removeEventListener("mousedown",je)},[]);const ze=je=>{Ye(je),i({deckViewMode:je})},{deck:le,cards:pe,loading:me,error:Ie,refresh:Fe}=I9(t),{decks:qe}=Pd(),{cards:Xe}=Gs(),He=le?.permissionLevel||"viewer",ut=He==="owner",Tt=He==="owner"||He==="editor",Ut=y.useMemo(()=>{if(le?.format?.toLowerCase()==="standard"){const wt=le.colors||le.commander?.color_identity||[];return Wm.find(lr=>lr.colors.length!==wt.length?!1:lr.colors.every(Ln=>wt.includes(Ln)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const je=le?.commander?.color_identity||[],Ce=le?.commander_partner?.color_identity||[],Oe=[...new Set([...je,...Ce])];return!le||Oe.length===0?Wm.find(wt=>wt.badge==="Colorless"):Wm.find(wt=>wt.colors.length!==Oe.length?!1:wt.colors.every(Lt=>Oe.includes(Lt)))||Wm.find(wt=>wt.badge==="Colorless")},[le]),nt=y.useMemo(()=>{if(!Xe)return new Set;const je=new Set;return Xe.forEach(Ce=>{Ce.finish==="foil"&&!Ce.deckId&&je.add(Ce.name)}),je},[Xe]),kt=je=>{if(!pe)return 0;let Ce=pe.reduce((Oe,Ze)=>(Ze.data?.type_line||Ze.type_line||"").includes(je)?Oe+(Ze.countInDeck||1):Oe,0);return le?.commander&&!pe.some(Oe=>Oe.scryfall_id===(le.commander.id||le.commander.scryfall_id)||Oe.oracle_id&&Oe.oracle_id===le.commander.oracle_id)&&(le.commander.type_line||"").includes(je)&&Ce++,le?.commander_partner&&!pe.some(Oe=>Oe.scryfall_id===(le.commander_partner.id||le.commander_partner.scryfall_id)||Oe.oracle_id&&Oe.oracle_id===le.commander_partner.oracle_id)&&(le.commander_partner.type_line||"").includes(je)&&Ce++,Ce},mt=y.useMemo(()=>{if(!pe)return 0;let je=pe.reduce((Ce,Oe)=>Ce+(Oe.countInDeck||1),0);return le?.commander&&!pe.some(Ce=>Ce.scryfall_id===(le.commander.id||le.commander.scryfall_id)||Ce.oracle_id&&Ce.oracle_id===le.commander.oracle_id)&&je++,le?.commander_partner&&!pe.some(Ce=>Ce.scryfall_id===(le.commander_partner.id||le.commander_partner.scryfall_id)||Ce.oracle_id&&Ce.oracle_id===le.commander_partner.oracle_id)&&je++,je},[pe,le]),Re=y.useMemo(()=>{if(!pe)return 0;let je=pe.filter(Ce=>!Ce.is_wishlist).reduce((Ce,Oe)=>Ce+(Oe.countInDeck||1),0);return le?.commander&&!pe.some(Ce=>Ce.scryfall_id===(le.commander.id||le.commander.scryfall_id)||Ce.oracle_id&&Ce.oracle_id===le.commander.oracle_id)&&je++,le?.commander_partner&&!pe.some(Ce=>Ce.scryfall_id===(le.commander_partner.id||le.commander_partner.scryfall_id)||Ce.oracle_id&&Ce.oracle_id===le.commander_partner.oracle_id)&&je++,je},[pe,le]),it=y.useMemo(()=>{if(!pe)return 0;let je=pe.reduce((Ce,Oe)=>{const Ze=parseFloat(Oe.prices?.[Oe.finish==="foil"?"usd_foil":"usd"])||parseFloat(Oe.data?.prices?.[Oe.finish==="foil"?"usd_foil":"usd"])||0;return Ce+Ze*(Oe.countInDeck||1)},0);if(le?.commander&&!pe.some(Ce=>Ce.scryfall_id===(le.commander.id||le.commander.scryfall_id)||Ce.oracle_id&&Ce.oracle_id===le.commander.oracle_id)){const Ce=le.commander,Oe=parseFloat(Ce.prices?.[Ce.finish==="foil"?"usd_foil":"usd"])||0;je+=Oe}if(le?.commander_partner&&!pe.some(Ce=>Ce.scryfall_id===(le.commander_partner.id||le.commander_partner.scryfall_id)||Ce.oracle_id&&Ce.oracle_id===le.commander_partner.oracle_id)){const Ce=le.commander_partner,Oe=parseFloat(Ce.prices?.[Ce.finish==="foil"?"usd_foil":"usd"])||0;je+=Oe}return je},[pe,le]),jt=y.useMemo(()=>{const je=le?.aiBlueprint||{},Ce=je.layout?.types||je.suggestedCounts||{};return[{label:"Total",current:mt,target:le?.format?.toLowerCase()==="standard"||le?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:kt("Creature"),target:Ce.Creatures||Ce.Creature||30},{label:"Lands",current:kt("Land"),target:Ce.Lands||Ce.Land||36},{label:"Instants",current:kt("Instant"),target:Ce.Instants||Ce.Instant||10},{label:"Sorceries",current:kt("Sorcery"),target:Ce.Sorceries||Ce.Sorcery||10},{label:"Enchantments",current:kt("Enchantment"),target:Ce.Enchantments||Ce.Enchantment||5},{label:"Artifacts",current:kt("Artifact"),target:Ce.Artifacts||Ce.Artifact||10},{label:"Planeswalkers",current:kt("Planeswalker"),target:Ce.Planeswalkers||Ce.Planeswalker||0}].filter(Ze=>Ze.target>0)},[le,mt,pe]),yt=y.useMemo(()=>{if(!pe)return{};const je={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return pe.forEach(Ce=>{const Oe=Ce,Ze=(Oe.data?.type_line||Oe.type_line||"").toLowerCase(),wt=le?.commander&&(Oe.scryfall_id===(le.commander.id||le.commander.scryfall_id)||Oe.oracle_id&&Oe.oracle_id===le.commander.oracle_id),Lt=le?.commander_partner&&(Oe.scryfall_id===(le.commander_partner.id||le.commander_partner.scryfall_id)||Oe.oracle_id&&Oe.oracle_id===le.commander_partner.oracle_id);if(wt||Lt){je.Commander.push(Oe);return}Ze.includes("creature")?je.Creature.push(Oe):Ze.includes("planeswalker")?je.Planeswalker.push(Oe):Ze.includes("instant")?je.Instant.push(Oe):Ze.includes("sorcery")?je.Sorcery.push(Oe):Ze.includes("artifact")?je.Artifact.push(Oe):Ze.includes("enchantment")?je.Enchantment.push(Oe):Ze.includes("land")?je.Land.push(Oe):je.Other.push(Oe)}),Object.fromEntries(Object.entries(je).filter(([Ce,Oe])=>Oe.length>0))},[pe,le]),Et=()=>{if(!le||!pe)return;const je={deck:{name:le.name,commander:le.commander},cards:pe,exported_at:new Date},Ce=JSON.stringify(je,null,2),Oe=new Blob([Ce],{type:"application/json"}),Ze=URL.createObjectURL(Oe),wt=document.createElement("a");wt.href=Ze,wt.download=`${le.name.replace(/[^a-z0-9]/yi,"_")}_backup.json`,document.body.appendChild(wt),wt.click(),document.body.removeChild(wt)},ot=je=>{let Ce=je.split(/[\r\n~]/);Ce.forEach((Ze,wt)=>{Ze=Ze.split("(")[0],Ze=Ze.replace(/ *\[[^\]]*\] */g," "),Ze=Ze.replace(/ *<[^>]*> */g," "),Ze=Ze.trim(),Ce[wt]=Ze});const Oe=Ce.join("~");return encodeURIComponent(Oe).replace(/%20/g,"+")+"~Z~"},ae=()=>{if(!le||!pe)return;const je=[];le.commander&&je.push(`1 ${le.commander.name}`),le.commander_partner&&je.push(`1 ${le.commander_partner.name}`),pe.forEach(Ze=>{const wt=Ze.countInDeck||1,Lt=Ze.name||Ze.data?.name||"";Lt&&je.push(`${wt} ${Lt}`)});const Ce=je.join(`
`),Oe=ot(Ce);window.open(`https://edhpowerlevel.com?d=${Oe}`,"_blank")},Be=()=>{if(!le||!pe)return;const je=[];le.commander&&je.push(`1 ${le.commander.name}`),le.commander_partner&&je.push(`1 ${le.commander_partner.name}`),pe.forEach(Ze=>{const wt=Ze.countInDeck||1,Lt=Ze.name||Ze.data?.name||"";Lt&&je.push(`${wt} ${Lt}`)});const Ce=je.join(`
`),Oe=encodeURIComponent(Ce);window.open(`https://www.tcgplayer.com/massentry?c=${Oe}`,"_blank")},Qe=async je=>{try{await di.addCardToDeck(r.uid,t,je),a(`Added ${je.name} to deck`,"success")}catch(Ce){console.error(Ce),a("Failed to add card to deck","error")}},et=async(je,Ce)=>{V({isOpen:!0,title:"Remove Card",message:`Are you sure you want to remove ${Ce} from this deck?`,onConfirm:async()=>{try{await di.removeCardFromDeck(r.uid,t,je),a(`Removed ${Ce} from deck`,"success")}catch(Oe){console.error(Oe),a("Failed to remove card","error")}}})},bt=je=>{if(!je)return"https://placehold.co/250x350?text=No+Image";const Ce=je.data||je;return U[Ce.id]&&Ce.card_faces&&Ce.card_faces[1]&&Ce.card_faces[1].image_uris?.normal?Ce.card_faces[1].image_uris.normal:Ce.image_uris?.normal?Ce.image_uris.normal:Ce.card_faces?.[0]?.image_uris?.normal?Ce.card_faces[0].image_uris.normal:je.image_uri?je.image_uri:"https://placehold.co/250x350?text=No+Image"},Ve=async(je,Ce,Oe)=>{if(je.stopPropagation(),le.commander_partner&&_!==Oe){T(Oe);return}const Ze=Ce.data||Ce;if(!(!Ze.card_faces||Ze.card_faces.length<2)){if(!U[Ze.id]&&!Ze.card_faces[1].image_uris){K(!0);try{a("Fetching back face data...","info");const wt=await fetch(`https://api.scryfall.com/cards/${Ze.id}`);if(!wt.ok)throw new Error("Fetch failed");const Lt=await wt.json(),lr=Oe===0?{commander:Lt}:{commanderPartner:Lt};await di.updateDeck(r.uid,t,lr),Oe===0?le.commander=Lt:le.commander_partner=Lt,a("Commander data updated.","success")}catch(wt){console.error("Flip fix failed",wt),a("Could not load card back.","error")}finally{K(!1)}}L(wt=>({...wt,[Ze.id]:!wt[Ze.id]}))}},Je=()=>{k(le.name),v(!0)},pt=async()=>{try{await di.updateDeck(r.uid,t,{name:w}),a("Deck renamed successfully","success"),v(!1),window.location.reload()}catch(je){console.error(je),a("Failed to rename deck","error")}},he=async()=>{try{await di.updateDeck(r.uid,t,{is_mockup:!le.is_mockup}),a(`Deck set to ${le.is_mockup?"Collection":"Mockup"} mode`,"info"),window.location.reload()}catch(je){console.error(je),a("Failed to update deck mode","error")}},We=Ge.useRef(!1),[vt,At]=y.useState(!1),Jt=()=>{We.current=!1,At(!0),V({isOpen:!0,title:"Delete Deck",message:"Are you sure you want to delete this deck? Cards inside will be returned to your collection binder.",onConfirm:async()=>{try{await di.deleteDeck(r.uid,t,{deleteCards:We.current}),a("Deck deleted successfully","success"),e("/decks")}catch(je){console.error(je),a("Failed to delete deck","error")}finally{At(!1)}}})},wr=je=>{if(!je)return"";const Ce=je.data||je;return U[Ce.id]&&Ce.card_faces&&Ce.card_faces[1]&&Ce.card_faces[1].image_uris?.art_crop?Ce.card_faces[1].image_uris.art_crop:Ce.image_uris?.art_crop?Ce.image_uris.art_crop:Ce.card_faces?.[0]?.image_uris?.art_crop?Ce.card_faces[0].image_uris.art_crop:Ce.image_uris?.normal?Ce.image_uris.normal:je.image_uri?je.image_uri:""};if(me)return s.jsx("div",{className:"flex justify-center p-20",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(Ie)return s.jsxs("div",{className:"p-20 text-center text-red-500 text-xl font-bold",children:["Error loading deck: ",Ie.message]});if(!le)return null;const Mn=_===0?le.commander:le.commander_partner||le.commander,ys=wr(Mn),Xs={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"};return s.jsxs("div",{className:"relative min-h-screen",children:[s.jsx("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${ys})`,backgroundSize:"cover",backgroundPosition:"center"},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"})}),s.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 md:p-6 space-y-6 animate-fade-in pb-24 relative z-10",children:[s.jsx("div",{className:"sticky top-16 z-40 bg-gradient-to-r from-gray-900/95 via-gray-900/80 to-gray-900/40 backdrop-blur-3xl border-b border-white/10 shadow-2xl transition-all duration-300 mx-auto w-full max-w-[1600px] rounded-b-3xl",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 md:gap-6 px-3 md:px-8 py-3 md:py-4",children:[s.jsxs("div",{className:"flex items-start gap-3 md:gap-4 min-w-0 shrink-0",children:[s.jsx(_t,{to:"/decks",className:"w-9 h-9 md:w-12 md:h-12 flex items-center justify-center bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl border border-gray-700 transition-all shrink-0 mt-0.5 md:mt-0",title:"Back to Decks",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[b?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:w,onChange:je=>k(je.target.value),className:"bg-black/50 text-2xl font-black text-white border-b-2 border-indigo-500 outline-none px-2 py-1 w-full max-w-md backdrop-blur-sm rounded",autoFocus:!0}),s.jsx("button",{onClick:pt,className:"p-2 bg-green-600 rounded-lg hover:bg-green-500 text-white shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}):s.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 group max-w-full",children:[s.jsx("h2",{className:"text-xl md:text-3xl lg:text-4xl font-black text-white tracking-tighter uppercase truncate leading-tight flex-1",title:le.name,children:le.name}),Tt&&s.jsx("button",{onClick:Je,className:"p-1 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity text-gray-500 hover:text-white shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[s.jsxs("div",{className:"text-[10px] md:text-[11px] text-indigo-300 font-black uppercase tracking-[0.15em] md:tracking-[0.2em] opacity-80 whitespace-nowrap",children:[Ut.badge,"  ",Ut.theme]}),!ut&&s.jsxs("span",{className:`text-[9px] md:text-[10px] font-bold uppercase tracking-widest px-2 py-0.5 rounded-full border whitespace-nowrap ${Tt?"bg-green-900/40 text-green-400 border-green-500/30":"bg-gray-800 text-gray-400 border-gray-700"}`,children:[He," Access"]}),s.jsx("div",{className:"flex items-center gap-1 shrink-0",children:(()=>{const je=le?.commander?.color_identity||[],Ce=le?.commander_partner?.color_identity||[];return[...new Set([...je,...Ce])].map(Ze=>s.jsx("img",{src:Xs[Ze],alt:Ze,className:"w-5 h-5 md:w-6 md:h-6 shadow-sm"},Ze))})()})]})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 mt-2 md:mt-3",children:s.jsxs("div",{className:"flex items-center gap-2 bg-black/40 px-2.5 md:px-3 py-1 md:py-1.5 rounded-xl border border-white/5 backdrop-blur-md shadow-2xl",children:[s.jsx("span",{className:"bg-orange-600/20 text-orange-400 px-2 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-orange-500/30",children:le.format||"Commander"}),le.tags&&le.tags.includes("Precon")&&s.jsx("span",{className:"bg-teal-600/20 text-teal-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-teal-500/30",children:"Precon"}),le.aiBlueprint?.grade?.commanderBracket&&s.jsxs("span",{className:"bg-indigo-600/20 text-indigo-300 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-indigo-500/30",children:[s.jsx("span",{className:"hidden md:inline",children:"Bracket "}),le.aiBlueprint.grade.commanderBracket]}),le.is_mockup&&s.jsx("span",{className:"bg-red-600/20 text-red-400 px-2 md:px-2.5 py-0.5 rounded-full text-[9px] md:text-[10px] font-black uppercase tracking-widest border border-red-500/30",children:"Mockup"}),le.aiBlueprint?.grade?.powerLevel>0&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold uppercase tracking-widest opacity-80",children:[s.jsx("span",{className:"hidden md:inline",children:"power "}),le.aiBlueprint.grade.powerLevel.toFixed(1)]})]}),s.jsx("div",{className:"h-4 w-px bg-white/10 mx-1"}),s.jsxs("span",{className:"text-gray-400 text-[10px] md:text-xs font-bold font-mono",children:["$",it.toFixed(2)]})]})})]})]}),s.jsx("div",{className:"hidden sm:block flex-1 px-8 text-center",children:s.jsxs("div",{className:"text-[12px] md:text-[13px] text-white/30 italic font-medium tracking-tight mx-auto max-w-2xl leading-relaxed",children:['"',Ut.flavor_text,'"']})}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-3 bg-gray-950/40 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md relative self-end lg:self-auto",children:[s.jsxs("button",{onClick:()=>Z(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-indigo-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Strategy"})]}),Tt&&s.jsxs("button",{onClick:()=>p(!0),className:"bg-green-600 hover:bg-green-500 text-white font-black py-2.5 px-4 md:px-6 rounded-xl shadow-lg shadow-green-900/40 transition-all flex items-center gap-2 uppercase tracking-widest text-[10px] md:text-xs shrink-0",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),s.jsx("span",{className:"hidden sm:inline",children:"Collection"})]}),s.jsxs("div",{ref:ge,className:"relative",onMouseEnter:()=>{ke.current&&(clearTimeout(ke.current),ke.current=null),de(!0)},onMouseLeave:()=>{ve||(ke.current=setTimeout(()=>{de(!1)},400))},children:[s.jsxs("button",{onClick:()=>{te(!ve),de(!0)},className:`flex items-center gap-3 px-6 py-3 rounded-2xl border transition-all duration-300 shadow-xl ${ve?"bg-indigo-600 border-indigo-500 text-white":"bg-indigo-600/10 border-indigo-500/20 text-indigo-300 hover:text-white hover:border-indigo-500/50 hover:bg-indigo-600/20"}`,children:[s.jsxs("div",{className:"flex -space-x-1.5 items-center",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500/20 border border-indigo-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500/20 border border-purple-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),s.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500/20 border border-blue-500/40 flex items-center justify-center backdrop-blur-sm",children:s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})})]}),s.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:ve?"Close":"Tools"})]}),Le&&s.jsx("div",{className:"absolute right-0 top-full mt-3 w-72 md:w-80 bg-gray-950/95 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden z-[60] animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Deck Building"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Tt&&s.jsxs("button",{onClick:je=>{je.stopPropagation(),x(!0),de(!1)},className:"flex flex-col items-center justify-center p-3 bg-white/5 hover:bg-indigo-500/20 rounded-xl border border-white/5 transition-all group lg:min-h-[64px] group",title:"Forge Lens: Scan & Add",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400 group-hover:scale-110 transition-transform mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Forge Lens"})]}),s.jsxs("button",{onClick:je=>{je.stopPropagation(),u(!0),de(!1)},className:`flex flex-col items-center gap-2 p-3 bg-white/5 rounded-xl border border-white/5 transition-all group ${Tt?"hover:bg-indigo-500/20":"opacity-50 cursor-not-allowed"}`,disabled:!Tt,children:[s.jsx("svg",{className:"w-5 h-5 text-blue-400 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"Search"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Logic & Analysis"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:je=>{if(je.stopPropagation(),!Yt(n?.subscription_tier).features.deckDoctor){a("Deck Doctor is available on Wizard tier and above.","info");return}ne(!0),de(!1)},className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border transition-all group ${Yt(n?.subscription_tier).features.deckDoctor?"bg-indigo-500/10 hover:bg-indigo-500/30 border-indigo-500/20":"bg-gray-900 border-gray-800 opacity-40 cursor-not-allowed"}`,children:[s.jsx("svg",{className:"w-8 h-8 text-indigo-400 group-hover:scale-110 transition-transform bg-indigo-500/20 p-1.5 rounded-lg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-indigo-300 uppercase tracking-wider",children:"Deck Doctor"})]}),Tt&&(Yt(n?.subscription_tier).features.deckAudit?s.jsx("div",{onClick:()=>de(!1),className:"h-full",children:s.jsx(hy,{type:"deck",targetId:t,label:"Audit",className:"w-full h-full flex flex-col items-center gap-2 p-3 bg-purple-500/10 hover:bg-purple-500/30 border border-purple-500/20 rounded-xl transition-all font-bold text-[10px] text-purple-300"})}):s.jsxs("button",{onClick:je=>{je.stopPropagation(),a("Deck Audits are available on Magician tier and above.","info")},className:"flex flex-col items-center gap-2 p-3 bg-gray-900 border border-gray-800 rounded-xl opacity-40 cursor-not-allowed",children:[s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"Audit"})]}))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Tabletop Tools"}),s.jsx("div",{className:"px-2 py-3 bg-white/5 rounded-xl border border-white/5 border-dashed",children:s.jsx("p",{className:"text-[9px] text-gray-500 font-bold uppercase tracking-wider text-center italic",children:"Future Tabletop expansion area"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] px-2",children:"Management"}),s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/5 divide-y divide-white/5",children:[s.jsxs("button",{onClick:je=>{je.stopPropagation(),ue(!0),de(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center justify-between hover:bg-indigo-500/10 transition-colors group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Share Deck"})]}),s.jsx("svg",{className:"w-3 h-3 text-gray-600 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsxs("button",{onClick:je=>{je.stopPropagation(),Yt(n?.subscription_tier).features.deckBackup?(Et(),de(!1)):a("Deck Export is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${Yt(n?.subscription_tier).features.deckBackup?"hover:bg-gray-800":"opacity-40 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),s.jsx("span",{className:"font-bold text-gray-300",children:"Export JSON"})]}),!Yt(n?.subscription_tier).features.deckBackup&&s.jsx("span",{className:"text-[8px] bg-amber-500/20 text-amber-500 px-1.5 py-0.5 rounded leading-none",children:"PRO"})]}),Tt&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:je=>{je.stopPropagation(),Yt(n?.subscription_tier).features.mockupDeck?(he(),de(!1)):a("Mockup Mode is available on Magician tier and above.","error")},className:`w-full text-left px-4 py-3 text-xs flex items-center justify-between transition-colors group ${Yt(n?.subscription_tier).features.mockupDeck?"hover:bg-orange-950/20":"opacity-40 cursor-not-allowed"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"font-bold text-gray-300",children:le.is_mockup?"To Collection":"To Mockup"})]})}),s.jsxs("button",{onClick:je=>{je.stopPropagation(),Jt(),de(!1)},className:"w-full text-left px-4 py-3 text-xs flex items-center gap-3 hover:bg-red-900/30 text-red-400 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{className:"font-bold",children:"Delete Deck"})]})]})]})]})]})})]})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:jt.map((je,Ce)=>{const Oe=je.target>0?Math.min(je.current/je.target*100,100):0,Ze=je.target>0&&je.current===je.target,wt=je.target>0&&je.current>je.target;return s.jsxs("div",{className:"bg-gray-950/30 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg group hover:border-indigo-500/30 transition-all hover:bg-gray-950/50",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:je.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${Ze?"text-green-400":wt?"text-orange-400":"text-indigo-300"}`,children:[je.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),je.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${Ze?"bg-green-500":wt?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${Oe||0}%`}})})]},Ce)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsxs("div",{className:"flex-1 min-w-0 bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl border border-white/10 order-2 lg:order-1 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/5 bg-white/5 rounded-t-xl backdrop-blur-sm",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),mt>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 px-3 py-1 rounded-full border border-gray-700",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Acquired"}),s.jsxs("span",{className:`text-sm font-mono font-bold ${Re===mt?"text-green-400":"text-orange-400"}`,children:[Re,"/",mt]}),s.jsx("div",{className:"w-20 h-1.5 bg-gray-700 rounded-full overflow-hidden ml-1",children:s.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${Re/mt*100}%`}})})]})]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700 items-center",children:[O?s.jsxs("div",{className:"flex items-center gap-2 mr-2 animate-fade-in",children:[s.jsx("button",{onClick:B,className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:E.size===pe.length?"Deselect All":"Select All"}),s.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2",children:[E.size," Selected"]}),s.jsx("button",{onClick:C,disabled:E.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:le.is_mockup?"Delete":"Remove"}),s.jsx("button",{onClick:()=>M(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):s.jsx("button",{onClick:()=>M(!0),className:"text-xs font-bold text-gray-400 hover:text-indigo-400 px-3 transition-colors uppercase mr-1",children:"Select"}),s.jsx("div",{className:"w-px h-4 bg-gray-700 mx-1"}),s.jsx("button",{onClick:()=>ze("grid"),className:`p-1.5 rounded-md transition-all ${Te==="grid"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Grid View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>ze("table"),className:`p-1.5 rounded-md transition-all ${Te==="table"?"text-white bg-gray-700 shadow-sm":"text-gray-400 hover:text-white"}`,title:"Table View",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsxs("div",{className:"p-4 space-y-8 min-h-[500px]",children:[Object.entries(yt).length===0&&s.jsx("div",{className:"text-center py-20 text-gray-500 italic",children:'Use the "Collection" button to start building your deck.'}),Object.entries(yt).map(([je,Ce])=>s.jsxs("div",{className:"animate-fade-in text-left",children:[s.jsxs("h4",{className:"text-sm font-bold text-indigo-300 border-b border-white/5 mb-4 pb-2 sticky top-0 bg-gray-950/60 backdrop-blur-md z-10 flex justify-between uppercase tracking-wider pl-1",children:[s.jsx("span",{children:je}),s.jsx("span",{className:"text-gray-500 text-xs bg-gray-900 px-2 py-0.5 rounded-full border border-gray-700",children:Ce.reduce((Oe,Ze)=>Oe+(Ze.countInDeck||1),0)})]}),Te==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4 px-1",children:Ce.map(Oe=>s.jsx(Yu,{card:Oe,availableFoils:nt,onRemove:et,decks:qe,currentUser:n,showOwnerTag:!0,hideDeckTag:!0,hideOwnerTag:!0,selectMode:O,isSelected:E.has(Oe.id),onToggleSelect:$},Oe.firestoreId||Oe.id))}):s.jsx("div",{className:"space-y-1",children:Ce.map((Oe,Ze)=>s.jsxs("div",{className:`flex items-center justify-between p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm group border ${E.has(Oe.id)?"bg-indigo-900/20 border-indigo-500/50":"border-transparent hover:border-gray-700"}`,onClick:wt=>{O&&(wt.stopPropagation(),$(Oe.id))},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[O&&s.jsx("input",{type:"checkbox",checked:E.has(Oe.id),readOnly:!0,className:"rounded bg-gray-700 border-gray-600 text-indigo-500 focus:ring-0 w-4 h-4 cursor-pointer"}),s.jsx("span",{className:"font-mono text-gray-500 w-6 text-center bg-gray-900 rounded py-0.5 text-xs",children:Oe.countInDeck}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`font-medium ${Oe.finish==="foil"?"text-yellow-200":"text-gray-200"}`,children:Oe.name}),Oe.finish!=="foil"&&nt.has(Oe.name)&&s.jsx("span",{className:"text-yellow-500 text-xs cursor-help",title:"Foil copy available in collection",children:""})]}),Oe.finish==="foil"&&s.jsx("span",{className:"text-[10px] bg-yellow-900/40 text-yellow-500 px-1 rounded uppercase tracking-wider border border-yellow-800",children:"Foil"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-gray-400",children:[s.jsx("span",{className:"hidden md:inline-block text-xs text-gray-500",children:Oe.data?.type_line||Oe.type_line||""}),s.jsx("span",{className:"font-mono w-16 text-right text-xs",children:Oe.mana_cost||""}),s.jsxs("span",{className:"font-mono w-16 text-right text-green-400/80 text-xs",children:["$",(parseFloat(Oe.prices?.[Oe.finish==="foil"?"usd_foil":"usd"])||0).toFixed(2)]}),Tt&&!O&&s.jsx("button",{onClick:()=>et(Oe.firestoreId||Oe.id,Oe.name),className:"text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]},Oe.id+Ze))})]},je))]})]}),s.jsxs("div",{className:"w-full lg:w-80 space-y-6 shrink-0 order-1 lg:order-2",children:[le.commander&&s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:le.format?.toLowerCase()==="standard"?"Spotlight Card":le.commander_partner?"Partners":"Commander"}),le.commander_partner&&s.jsx("button",{onClick:()=>T(je=>je===0?1:0),className:"text-indigo-400 hover:text-indigo-300 text-xs font-bold uppercase tracking-wider transition-colors",children:"Swap View "})]}),s.jsxs("div",{className:"p-4 flex justify-center relative min-h-[350px]",children:[le.commander_partner&&s.jsx("div",{className:`transition-all duration-500 ease-out transform absolute top-4 
                                            ${_===0?"scale-90 opacity-60 translate-x-4 -rotate-3 z-0 blur-[1px] hover:blur-0":"scale-100 opacity-100 z-10 translate-x-0 rotate-0"}
                                            cursor-pointer`,onClick:je=>Ve(je,le.commander_partner,1),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:bt(le.commander_partner),className:"w-full max-w-[250px] rounded-lg shadow-2xl skew-y-1",alt:le.commander_partner.name}),(le.commander_partner.card_faces||le.commander_partner.data?.card_faces)&&_===1&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${q?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),s.jsx("div",{className:`transition-all duration-500 ease-out transform relative 
                                        ${le.commander_partner&&_===1?"scale-90 opacity-60 -translate-x-4 rotate-3 z-0 blur-[1px] hover:blur-0 cursor-pointer":"scale-100 opacity-100 z-10"}
                                        `,onClick:je=>Ve(je,le.commander,0),children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:bt(le.commander),className:"w-full max-w-[250px] rounded-lg shadow-2xl hover:shadow-indigo-500/30 transition-shadow duration-300",alt:le.commander.name}),(le.commander.card_faces||le.commander.data?.card_faces)&&_===0&&s.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm",children:s.jsx("svg",{className:`w-4 h-4 ${q?"animate-spin":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl p-6 border border-white/10 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"}),l," Tools"]}),s.jsxs("div",{className:"space-y-3 relative z-10",children:[s.jsxs("button",{onClick:()=>{le.format?.toLowerCase()==="standard"?a("Standard AI Deck Tech coming soon! Please verify on Discord to prioritize.","info",0):e(`/decks/${t}/build`)},className:"w-full py-4 bg-indigo-600/10 hover:bg-indigo-600/20 text-indigo-300 rounded-xl border border-indigo-500/20 hover:border-indigo-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),l,"'s Deck Builder"]}),s.jsxs("button",{onClick:()=>F(!0),className:"w-full py-4 bg-indigo-900/10 hover:bg-indigo-900/20 text-indigo-400 rounded-xl border border-indigo-500/10 hover:border-indigo-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Full Deck Stats"]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-3xl shadow-2xl overflow-hidden border border-white/10 relative group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:s.jsx("span",{className:"text-8xl",children:""})}),s.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 p-4 pb-0 flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse"}),"External Sites"]}),s.jsxs("div",{className:"space-y-3 relative z-10 p-4 pt-3",children:[s.jsxs("button",{onClick:ae,className:"w-full py-4 bg-purple-600/10 hover:bg-purple-600/20 text-purple-300 rounded-xl border border-purple-500/20 hover:border-purple-500/40 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3 group/btn",children:[s.jsx("span",{className:"text-lg group-hover/btn:scale-110 transition-transform",children:""}),"EDH Power Level"]}),s.jsxs("button",{onClick:Be,className:"w-full py-4 bg-green-900/10 hover:bg-green-900/20 text-green-400 rounded-xl border border-green-500/10 hover:border-green-500/30 transition-all font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-lg",children:""}),"Buy on TCGPlayer"]})]})]})]})]}),s.jsx(tle,{isOpen:re,onClose:()=>ue(!1),deck:le,onUpdateDeck:je=>Object.assign(le,je)}),s.jsx(B9,{isOpen:Y,onClose:()=>ne(!1),deck:le,cards:pe,isOwner:Tt}),s.jsx(C4,{isOpen:d,onClose:()=>u(!1),onAddCard:Qe,onOpenForgeLens:()=>{u(!1),x(!0)}}),s.jsx(Xoe,{isOpen:W.isOpen,onClose:()=>V({...W,isOpen:!1}),onConfirm:W.onConfirm,title:W.title,message:W.message,isDanger:!0,confirmText:"Remove",children:vt&&s.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white/5 p-3 rounded-lg border border-white/10",children:[s.jsx("input",{type:"checkbox",id:"deleteCardsCheckbox",className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500",onChange:je=>We.current=je.target.checked}),s.jsxs("label",{htmlFor:"deleteCardsCheckbox",className:"text-gray-300 text-sm select-none",children:["Also remove these cards from my ",le.is_mockup?"wishlist":"collection binder"]})]})}),s.jsx(ele,{isOpen:X,onClose:()=>Z(!1),deck:le,cards:pe,onStrategyUpdate:()=>Fe(!0)}),s.jsx(Qoe,{isOpen:h,onClose:()=>p(!1),deck:le,deckCards:pe}),s.jsx(D9,{isOpen:G,onClose:()=>F(!1),cards:pe,deckName:le.name}),s.jsx(ey,{isOpen:m,onClose:()=>x(!1),onFinish:async(je,Ce={})=>{if(je.length)try{const{targetDeckId:Oe,additionMode:Ze}=Ce,wt=je.map(Qt=>({name:Qt.name,scryfall_id:Qt.scryfall_id,set_code:Qt.set_code,collector_number:Qt.collector_number,image_uri:Qt.data.image_uris?.normal||Qt.data.card_faces?.[0]?.image_uris?.normal,count:Qt.quantity,data:Qt.data,finish:Qt.finish||"nonfoil",is_wishlist:Qt.is_wishlist,tags:[]})),Lt=Ze==="transfer"?"transfer_to_deck":"merge",lr=Oe||t;await di.batchAddCardsToDeck(r.uid,lr,wt,Lt);const Ln=Oe?Oe===t?"this deck":"another deck":"your collection";a(`Successfully ${Ze==="transfer"?"moved":"added"} ${je.length} cards to ${Ln}!`,"success"),lr===t&&Fe()}catch(Oe){console.error("Forge Lens Add Failed",Oe),a("Failed to add scanned cards.","error")}}})]})]})};function nle(){const[t,e]=y.useState([]),[r,n]=y.useState(!0),[i,a]=y.useState(null);return y.useEffect(()=>{(async()=>{try{const u=(await Pe.get("/api/sets")).data||[];e(u),n(!1)}catch(d){console.error("Error fetching sets:",d),a(d),n(!1)}})()},[]),{sets:t,loading:r,error:i}}const $9=({value:t,onChange:e,onSelect:r,placeholder:n="Find card in sets..."})=>{const[i,a]=y.useState([]),[l,d]=y.useState(!1),[u,h]=y.useState(!1),p=y.useRef(null);y.useEffect(()=>{const x=b=>{p.current&&!p.current.contains(b.target)&&d(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),y.useEffect(()=>{const b=setTimeout(async()=>{if(t.length<2){a([]);return}h(!0);try{const v=await Pe.get("/api/cards/autocomplete",{q:t});a(v.data||[]),d(!0)}catch(v){console.error("Autocomplete failed",v)}finally{h(!1)}},300);return()=>clearTimeout(b)},[t]);const m=x=>{e(x),d(!1),r&&r(x)};return s.jsxs("div",{ref:p,className:"relative w-full",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u?s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-indigo-400"}):s.jsx("svg",{className:"h-4 w-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 bg-gray-900/50 border border-indigo-500/20 rounded-xl text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none text-sm",placeholder:n,value:t,onChange:x=>e(x.target.value),onFocus:()=>t.length>=2&&d(!0)}),t&&s.jsx("button",{onClick:()=>e(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l&&i.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl overflow-hidden animate-fade-in",children:i.map((x,b)=>s.jsx("button",{onClick:()=>m(x),className:"w-full text-left px-4 py-2.5 text-sm text-gray-300 hover:bg-indigo-600 hover:text-white transition-colors border-b border-white/5 last:border-0",children:x},b))})]})},sle=()=>{const{sets:t,loading:e,error:r}=nle(),{cards:n}=Gs(),[i,a]=y.useState(""),[l,d]=y.useState(sessionStorage.getItem("mtg_card_search")||""),[u,h]=y.useState(null),[p,m]=y.useState(!1),[x,b]=y.useState(!1),v=on();y.useEffect(()=>{const I=setTimeout(async()=>{const O=l.trim();if(!O){h(null),sessionStorage.removeItem("mtg_card_search");return}sessionStorage.setItem("mtg_card_search",O),m(!0);try{const M=await Pe.get("/api/cards/sets-for-card",{name:O});h(new Set(M.data||[]))}catch(M){console.error("Local card search failed",M),h(new Set)}finally{m(!1)}},500);return()=>clearTimeout(I)},[l]);const w=y.useMemo(()=>{const A=new Map;n&&n.forEach(O=>{if(O.is_wishlist||O.deck_id)return;const M=(O.set||O.set_code)?.toLowerCase(),E=O.name;A.has(M)||A.set(M,new Set),E&&A.get(M).add(E)});const I={};return A.forEach((O,M)=>{I[M]=O.size}),I},[n]),k=y.useMemo(()=>{if(!t)return{};const A={Expansion:[],Core:[],Commander:[],Masters:[],"Draft Innovation":[],Other:[]},I={expansion:"Expansion",core:"Core",commander:"Commander",masters:"Masters",draft_innovation:"Draft Innovation"};return t.forEach(O=>{const M=w[O.code.toLowerCase()]||0,E=M>0,R=!i||O.name.toLowerCase().includes(i.toLowerCase())||O.code.toLowerCase().includes(i.toLowerCase()),$=!u||u.has(O.code.toLowerCase());if(!R||!(!x||E)||!$)return;const C=I[O.set_type]||"Other";A[C]?A[C].push({...O,ownedCount:M}):A.Other.push({...O,ownedCount:M})}),Object.keys(A).forEach(O=>{A[O].sort((M,E)=>new Date(E.released_at)-new Date(M.released_at))}),A},[t,i,x,w,u]),_=A=>{v(`/sets/${A}`)};if(e)return s.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(r)return s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-red-500 bg-red-500/10 p-8 rounded-2xl border border-red-500/20 max-w-md",children:[s.jsx("p",{className:"font-bold text-xl mb-2",children:"Error loading sets"}),s.jsx("p",{className:"text-sm opacity-80",children:r.message})]})});const T=["Expansion","Core","Commander","Masters","Draft Innovation","Other"];return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-gray-950/80 backdrop-blur-xl border-b border-white/10 sticky top-16 z-30 py-3 md:py-4",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[s.jsx("div",{className:"flex items-center gap-4 w-full lg:w-auto",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:["Set ",s.jsx("span",{className:"text-indigo-500",children:"Library"})]}),s.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Browse Collections"})]})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto lg:flex-1 lg:justify-end",children:[s.jsxs("div",{className:"relative flex-grow max-w-xs group",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-3.5 w-3.5 text-gray-500 group-focus-within:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-9 pr-10 py-2 bg-gray-900/50 border border-white/5 rounded-lg text-xs text-gray-300 placeholder-gray-600 focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all outline-none",placeholder:"Search sets...",value:i,onChange:A=>a(A.target.value)}),i&&s.jsx("button",{onClick:()=>a(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"relative flex-grow max-w-sm",children:s.jsx($9,{value:l,onChange:d,placeholder:"Find card in sets..."})}),s.jsx("button",{onClick:()=>b(!x),className:`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${x?"bg-indigo-600 text-white shadow-lg":"bg-gray-800/80 text-gray-400 border border-white/5 hover:bg-gray-700"}`,children:x?"Owned":"Show All"})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:T.map(A=>k[A]&&k[A].length>0&&s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsxs("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-3",children:[A,s.jsx("div",{className:"h-[2px] w-12 bg-indigo-500/50"})]}),s.jsxs("span",{className:"text-[10px] font-black text-gray-500 bg-gray-800/50 border border-white/5 px-3 py-1 rounded-full uppercase tracking-widest",children:[k[A].length," Sets"]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:k[A].map(I=>{const O=Math.min(100,Math.round(I.ownedCount/I.card_count*100)),M=O>=100;return s.jsxs("div",{onClick:()=>_(I.code),className:"relative bg-gray-800/40 backdrop-blur-md rounded-2xl border border-white/5 p-5 group cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:border-indigo-500/30 overflow-hidden min-h-[160px] flex flex-col justify-between",children:[s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-1000 ease-out z-0",style:{height:`${O}%`,background:M?"linear-gradient(to top, rgba(34, 197, 94, 0.15) 0%, transparent 100%)":"linear-gradient(to top, rgba(79, 70, 229, 0.15) 0%, transparent 100%)"}}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-900/80 rounded-xl flex items-center justify-center border border-white/5 shadow-inner",children:I.icon_svg_uri?s.jsx("img",{src:I.icon_svg_uri,alt:I.name,className:"w-6 h-6 filter invert opacity-60 group-hover:opacity-100 transition-opacity"}):s.jsx("span",{className:"text-xs font-black text-gray-500",children:I.code.toUpperCase()})}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Code"}),s.jsx("span",{className:"text-xs font-bold text-indigo-400 mb-2",children:I.code.toUpperCase()}),s.jsx("span",{className:"text-[10px] font-black text-gray-500 block uppercase tracking-widest leading-none mb-1",children:"Release"}),s.jsx("span",{className:"text-xs font-bold text-gray-400",children:I.released_at?.split("-")[0]})]})})]}),s.jsx("h3",{className:"text-sm font-black text-white leading-snug group-hover:text-indigo-400 transition-colors",children:I.name})]}),s.jsxs("div",{className:"relative z-10 pt-4 mt-4 border-t border-white/5 flex items-end justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:`text-lg font-black tabular-nums ${M?"text-green-400":"text-indigo-400"}`,children:I.ownedCount}),s.jsxs("span",{className:"text-gray-600 text-[10px] font-bold",children:["/ ",I.card_count]})]})]}),s.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-[10px] font-black ${M?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-gray-950/80 text-gray-400 border border-white/5"}`,children:[O,"%"]})]})]},I.id)})})]},A))})]})},ile=()=>{const{setCode:t}=ol(),[e,r]=y.useState([]),[n,i]=y.useState(!0),[a,l]=y.useState(null),[d,u]=y.useState("all"),[h,p]=y.useState(sessionStorage.getItem("mtg_card_search")||""),{currentUser:m,userProfile:x}=Mt(),{addToast:b}=_r(),{cards:v,refresh:w}=Gs();y.useEffect(()=>{h?sessionStorage.setItem("mtg_card_search",h):sessionStorage.removeItem("mtg_card_search")},[h]);const k=y.useMemo(()=>{const O=new Map;return v&&v.forEach(M=>{const E=M.scryfall_id||M.data&&(M.data.scryfall_id||M.data.id)||M.id;O.has(E)||O.set(E,[]),O.get(E).push(M)}),O},[v]),_=y.useMemo(()=>{const O=new Set(e.map(R=>R.name)),M=new Set;let E=0;return e.forEach(R=>{const $=k.get(R.scryfall_id||R.id)||[],B=$.filter(U=>U.finish==="nonfoil"&&!U.is_wishlist).reduce((U,L)=>U+(L.count||1),0),C=$.filter(U=>U.finish==="foil"&&!U.is_wishlist).reduce((U,L)=>U+(L.count||1),0);if(B>0||C>0){M.add(R.name);const U=parseFloat(R.prices?.usd||0)*B,L=parseFloat(R.prices?.usd_foil||0)*C;E+=U+L}}),{collected:M.size,total:O.size,value:E.toFixed(2)}},[e,k]),T=y.useMemo(()=>{let O=e;if(d!=="all"&&(O=O.filter(M=>{const R=(k.get(M.scryfall_id||M.id)||[]).some($=>!$.is_wishlist&&($.count||0)>0);return d==="owned"?R:!R})),h){const M=h.toLowerCase();O=O.filter(E=>E.name.toLowerCase().includes(M)||(E.data?.name_en||"").toLowerCase().includes(M))}return O},[e,k,d,h]);y.useEffect(()=>{(async()=>{if(t){i(!0);try{const M=await Pe.get(`/api/sets/${t}/cards`);r(M.data||[]),l(null)}catch(M){console.error("Failed to load set cards",M),l(M.message)}finally{i(!1)}}})()},[t]);const A=async(O,M,E)=>{if(!m)return b("Please log in","error");try{const R=O.id,$=k.get(R)||[],B=M==="foil"?"foil":"nonfoil",C=$.find(U=>U.finish===B&&!U.deck_id&&!U.is_wishlist);E>0?C?(await Un.updateCard(C.id,{count:(C.count||1)+1}),b(`Added ${B} ${O.name}`,"success")):(await Un.addCardToCollection(m.uid,O,1,B),b(`Added new ${B} ${O.name}`,"success")):C&&((C.count||1)>1?(await Un.updateCard(C.id,{count:C.count-1}),b(`Removed ${B} ${O.name}`,"info")):(await Un.removeCard(C.id),b(`Removed last ${B} ${O.name}`,"info"))),await w()}catch(R){console.error("Update failed",R),b("Failed to update collection","error")}},I=async(O,M)=>{if(!m)return b("Please log in","error");try{const E=O.id,$=(k.get(E)||[]).find(B=>B.is_wishlist&&!B.deck_id);M>0?$?(await Un.updateCard($.id,{count:($.count||1)+1}),b(`Increased wishlist for ${O.name}`,"success")):(await Un.addCardToCollection(m.uid,O,1,"nonfoil",!0),b(`Added ${O.name} to wishlist`,"success")):$&&(($.count||1)>1?(await Un.updateCard($.id,{count:$.count-1}),b(`Decreased wishlist for ${O.name}`,"info")):(await Un.removeCard($.id),b(`Removed ${O.name} from wishlist`,"info"))),await w()}catch(E){console.error("Wishlist update failed",E),b("Failed to update wishlist","error")}};return s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsx("div",{className:"sticky top-16 z-30 bg-gray-950/80 backdrop-blur-xl border-b border-white/10 shadow-2xl",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(_t,{to:"/sets",className:"p-1.5 bg-gray-800/50 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white transition-all group",title:"Back to Sets",children:s.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-black text-white uppercase tracking-tighter leading-none",children:[t," ",s.jsx("span",{className:"text-gray-500 font-bold ml-1",children:"Library"})]}),s.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1 opacity-70",children:"Expansion Collection"})]})]}),s.jsxs("div",{className:"flex items-center gap-6 bg-gray-900/50 border border-white/5 px-4 py-2 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Collected"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-sm font-black text-indigo-400",children:_.collected}),s.jsxs("span",{className:"text-gray-600 font-bold text-[10px]",children:["/ ",_.total]})]})]}),s.jsx("div",{className:"w-[1px] h-4 bg-white/10"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-black uppercase text-gray-500 tracking-wider",children:"Estimate Value"}),s.jsxs("span",{className:"text-sm font-black text-emerald-400 tabular-nums",children:["$",_.value]})]})]}),Yt(x?.subscription_tier).features.setAudit?s.jsx(hy,{type:"set",targetId:t,label:"Audit Set",className:"text-xs py-1.5"}):s.jsxs("button",{onClick:()=>b(`Set Audits are available on ${Gr[tt.TIER_2].name} tier and above.`,"info"),className:"bg-gray-800/50 border border-gray-700 text-gray-500 px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-widest cursor-not-allowed flex items-center gap-2",title:`Requires ${Gr[tt.TIER_2].name} Tier`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Audit Set"]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 pt-3 border-t border-white/5",children:[s.jsx("div",{className:"flex bg-gray-900/80 rounded-lg p-0.5 border border-white/5 w-full md:w-auto overflow-hidden",children:["all","owned","missing"].map(O=>s.jsx("button",{onClick:()=>u(O),className:`flex-1 md:flex-none px-4 py-1.5 rounded-md text-[10px] font-black uppercase tracking-widest transition-all duration-300 ${d===O?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white hover:bg-white/5"}`,children:O},O))}),s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto md:flex-1 justify-end",children:[s.jsx("div",{className:"relative w-full max-w-sm",children:s.jsx($9,{value:h,onChange:p,placeholder:"Filter cards..."})}),h&&s.jsx("button",{onClick:()=>{p(""),sessionStorage.removeItem("mtg_card_search")},className:"p-2 bg-indigo-500/10 border border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/20 hover:text-white rounded-lg transition-all",title:"Clear filter",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:n?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6",children:Array.from({length:12}).map((O,M)=>s.jsx(M9,{},M))}):a?s.jsxs("div",{className:"text-center text-red-500 py-12 bg-red-500/10 rounded-2xl border border-red-500/20",children:["Error loading set: ",a]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:T.map((O,M)=>{const E=k.get(O.scryfall_id||O.id)||[],R=E.filter(C=>C.finish==="nonfoil"&&!C.is_wishlist).reduce((C,U)=>C+(U.count||1),0),$=E.filter(C=>C.finish==="foil"&&!C.is_wishlist).reduce((C,U)=>C+(U.count||1),0),B=E.filter(C=>C.is_wishlist).reduce((C,U)=>C+(U.count||1),0);return s.jsx(kP,{card:O,normalCount:R,foilCount:$,wishlistCount:B,onUpdateCount:A,onUpdateWishlistCount:I,currentUser:x,showOwnerTag:!0},O.id||M)})})})]})},ale=({isOpen:t,onClose:e,mode:r="global"})=>{const{currentUser:n}=Mt(),{addToast:i}=_r(),a=y.useRef(null),[l,d]=y.useState(null),[u,h]=y.useState(!1),[p,m]=y.useState("cards"),[x,b]=y.useState("merge"),[v,w]=y.useState({checkCollection:!0,addToCollection:!0}),k=T=>{const A=T.target.files[0];if(!A)return;const I=new FileReader;I.onload=O=>{try{const M=JSON.parse(O.target.result);if(M.deck&&M.cards)m("deck"),d(M);else if(M.cards&&M.decks)m("cards"),d(M);else if(M.collection&&typeof M.collection=="object"&&!Array.isArray(M.collection)){const E=Object.values(M.collection);m("cards"),d({cards:E})}else if(Array.isArray(M))m("cards"),d({cards:M});else if(M.cards&&Array.isArray(M.cards))m("cards"),d(M);else if(typeof M=="object"){const E=Object.values(M).find(R=>Array.isArray(R)&&R.length>0&&(R[0].name||R[0].id));E?(m("cards"),d({cards:E})):(console.error("Invalid JSON structure",M),i("Invalid JSON: Could not find card data","error"))}else i("Invalid JSON format","error")}catch(M){console.error(M),i("Failed to parse JSON","error")}},I.readAsText(A)},_=async()=>{if(l){h(!0);try{if(p==="cards")await Un.importBatch(n.uid,l.cards,x,l.decks),i(`Successfully imported ${l.cards.length} cards${l.decks?.length?` and ${l.decks.length} decks`:""}`,"success"),e();else if(p==="deck"){const T=await di.importDeck(n.uid,l.deck,l.cards,v);T.missingCards?.length>0?i(`Imported deck with ${T.missingCards.length} missing cards`,"warning"):i("Deck imported successfully","success"),e()}}catch(T){console.error(T),i("Import failed","error")}finally{h(!1)}}};return t?ln.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl border border-gray-700 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import Data"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 space-y-6",children:l?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg border border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detected Content"}),s.jsx("p",{className:"text-white font-bold text-lg",children:p==="cards"?s.jsxs(s.Fragment,{children:["Collection (",l.cards?.length||0," cards)",l.decks?.length>0&&` + ${l.decks.length} Decks`]}):`Deck: ${l.deck?.name} (${l.cards?.length||0} cards)`})]}),s.jsx("button",{onClick:()=>d(null),className:"text-sm text-red-400 hover:text-red-300 underline",children:"Change File"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-700 pb-2",children:"Import Options"}),p==="cards"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-700 hover:bg-gray-700/50 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:x==="merge",onChange:()=>b("merge"),className:"mt-1 bg-gray-900 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Merge (Recommended)"}),s.jsx("span",{className:"block text-gray-400 text-sm",children:"Add records to your existing collection. Updates if exists."})]})]}),s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-red-900/30 hover:bg-red-900/10 cursor-pointer transition-colors",children:[s.jsx("input",{type:"radio",name:"replaceMode",checked:x==="replace",onChange:()=>b("replace"),className:"mt-1 bg-gray-900 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-medium",children:"Replace (Use with Caution)"}),s.jsxs("span",{className:"block text-red-300 text-sm",children:["Delete your ENTIRE current collection.",l.decks?.length>0?" Existing decks will also be replaced by those in the backup.":" Your decks will be preserved since this backup only contains cards."]})]})]})]}),p==="deck"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:v.checkCollection,onChange:T=>w(A=>({...A,checkCollection:T.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Use existing unassigned copies from collection"})]}),s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:v.addToCollection,onChange:T=>w(A=>({...A,addToCollection:T.target.checked})),className:"rounded bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-300",children:"Add missing cards to collection automatically"})]})]})]})]}):s.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500 hover:bg-gray-700/30 transition-all group",onClick:()=>a.current?.click(),children:[s.jsx("svg",{className:"w-12 h-12 text-gray-500 group-hover:text-indigo-400 mb-4 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s.jsx("p",{className:"text-gray-300 font-medium",children:"Click to select backup JSON"}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Supports Collection exports and Deck exports"}),s.jsx("input",{type:"file",ref:a,onChange:k,accept:".json",className:"hidden"})]})}),s.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-900/50 flex justify-end gap-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800 transition-colors",disabled:u,children:"Cancel"}),s.jsx("button",{onClick:_,disabled:!l||u,className:`px-6 py-2 rounded-lg font-bold text-white transition-all shadow-lg ${u?"bg-indigo-800 cursor-wait":x==="replace"&&p==="cards"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-indigo-600 hover:bg-indigo-500 shadow-indigo-500/20"}`,children:u?"Importing...":"Start Import"})]})]})}),document.body):null},ole=({isOpen:t,onClose:e})=>{const{userProfile:r,refreshUserProfile:n}=Mt(),[i,a]=y.useState(!1),[l,d]=y.useState(r?.settings?.helper?.name||""),[u,h]=y.useState(r?.settings?.helper?.type||""),[p,m]=y.useState(r?.settings?.helper?.personality||""),[x,b]=y.useState(!1),[v,w]=y.useState([]),[k,_]=y.useState(""),[T,A]=y.useState(!1),[I,O]=y.useState({});Ge.useEffect(()=>{if(t){const B=r?.settings?.helper||{};d(B.name||""),h(B.type||""),m(B.personality||""),a(!1),w([]),O({})}},[t,r]);const M=async()=>{b(!0);try{const C={...r?.settings||{},helper:{name:l,type:u,personality:p}};await Pe.updateUser(r.id,{settings:C}),await n(),e()}catch(B){console.error(B),alert("Failed to save helper.")}finally{b(!1)}},E=async()=>{a(!0),A(!0),O({}),w([]);try{const B=r?.settings?.geminiApiKey;if(!B)throw new Error("API Key missing");const C=await _s.forgeHelperChat(B,[],{});w([{role:"model",content:C.aiResponse}])}catch(B){console.error(B),w([{role:"model",content:"Error connecting to the Forge. Please try again."}])}finally{A(!1)}},R=async()=>{if(!k.trim())return;const B=k;_(""),w(C=>[...C,{role:"user",content:B}]),A(!0);try{const C=r?.settings?.geminiApiKey,U=v.map(q=>({role:q.role,content:q.content}));U.push({role:"user",content:B});const L=await _s.forgeHelperChat(C,U,I);O(L.updatedDraft||{}),w(q=>[...q,{role:"model",content:L.aiResponse}])}catch(C){console.error(C),w(U=>[...U,{role:"model",content:"Reviewing the blueprints... (Error, try again)"}])}finally{A(!1)}},$=()=>{I.name&&d(I.name),I.type&&h(I.type),I.personality&&m(I.personality),a(!1)};return t?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-gray-900",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-500",children:"Helper Settings"}),s.jsx("span",{className:"text-xs bg-gray-800 text-gray-500 px-2 py-1 rounded border border-gray-700",children:"Beta"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:i?s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-lg mb-4 text-sm text-gray-400 flex justify-between items-center",children:[s.jsx("span",{children:"Forging new identity..."}),s.jsx("button",{onClick:()=>a(!1),className:"text-white hover:underline",children:"Cancel"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 p-2 bg-gray-950/30 rounded-lg border border-gray-800",children:[v.map((B,C)=>s.jsx("div",{className:`flex ${B.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-xl text-sm ${B.role==="user"?"bg-emerald-600 text-white":"bg-gray-800 text-gray-200"}`,children:B.content})},C)),T&&s.jsx("div",{className:"flex justify-start",children:s.jsx("span",{className:"animate-pulse text-emerald-500",children:"..."})})]}),(I.name||I.type)&&s.jsxs("div",{className:"bg-black/40 p-3 rounded border border-emerald-500/30 mb-4 flex gap-4 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"})," ",s.jsx("span",{className:"text-white",children:I.name||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Type:"})," ",s.jsx("span",{className:"text-white",children:I.type||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Personality:"})," ",s.jsx("span",{className:"text-white",children:I.personality||"-"})]}),s.jsx("button",{onClick:$,className:"ml-auto bg-emerald-600 text-white px-3 py-1 rounded hover:bg-emerald-500",children:"Apply This"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:k,onChange:B=>_(B.target.value),onKeyDown:B=>B.key==="Enter"&&R(),placeholder:"Describe your helper...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-emerald-500 outline-none"}),s.jsx("button",{onClick:R,disabled:T,className:"bg-emerald-600 p-2 rounded-lg text-white",children:""})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 flex gap-4 items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-teal-500 to-emerald-700 rounded-full flex items-center justify-center text-2xl shadow-lg",children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:l||"Unknown Helper"}),s.jsx("p",{className:"text-emerald-400 text-sm font-medium",children:u||"Generic Construct"}),s.jsxs("p",{className:"text-gray-400 text-sm italic mt-1",children:['"',p||"Standard protocol.",'"']})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Name"}),s.jsx("input",{type:"text",value:l,onChange:B=>d(B.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Type"}),s.jsx("input",{type:"text",value:u,onChange:B=>h(B.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Personality"}),s.jsx("input",{type:"text",value:p,onChange:B=>m(B.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-emerald-500 outline-none"})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-800",children:[s.jsxs("button",{onClick:E,className:"text-emerald-400 hover:text-emerald-300 font-bold flex items-center gap-2 px-4 py-2 hover:bg-emerald-900/20 rounded-lg transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Re-Forge Persona"]}),s.jsx("button",{onClick:M,disabled:x,className:"bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-6 rounded-lg transition-all shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:x?"Saving...":"Save Changes"})]})]})})]})}):null},lle=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,targetName:a})=>{const[l,d]=y.useState(""),u=l.toUpperCase()==="DELETE";return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:s.jsxs("div",{className:"bg-gray-900 border border-red-500/50 rounded-2xl max-w-md w-full p-6 shadow-2xl shadow-red-900/20 transform transition-all scale-100",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center border border-red-500/50",children:s.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:n||"Confirm Deletion"}),s.jsx("p",{className:"text-red-400 text-sm font-medium",children:"This action cannot be undone."})]})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsx("p",{className:"text-gray-300 leading-relaxed",children:i}),a&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:[s.jsx("span",{className:"text-red-200 text-sm",children:"Target: "}),s.jsx("span",{className:"text-white font-mono font-bold",children:a})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:["Type ",s.jsx("span",{className:"text-white font-mono",children:"DELETE"})," to confirm"]}),s.jsx("input",{type:"text",className:"w-full bg-black/50 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-colors font-mono",placeholder:"DELETE",value:l,onChange:h=>d(h.target.value)})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium rounded-xl transition-colors",children:"Cancel"}),s.jsx("button",{onClick:r,disabled:!u,className:`flex-1 px-4 py-3 font-bold rounded-xl transition-all shadow-lg ${u?"bg-red-600 hover:bg-red-500 text-white shadow-red-900/30":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:"Delete Forever"})]})]})}):null},cle=typeof document<"u"?Ge.useLayoutEffect:()=>{},jc=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},Qc=t=>t&&"window"in t&&t.window===t?t:jc(t).defaultView||window;function dle(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function ule(t){return dle(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let hle=!1;function s5(){return hle}function U9(t,e){if(!s5())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:ule(r)?r=r.host:r=r.parentNode}return!1}const Gj=(t=document)=>{var e;if(!s5())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function z9(t){return s5()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}function q9(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=q9(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function gr(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=q9(t))&&(n&&(n+=" "),n+=e);return n}function fle(t){if(ple())t.focus({preventScroll:!0});else{let e=mle(t);t.focus(),gle(e)}}let Gm=null;function ple(){if(Gm==null){Gm=!1;try{document.createElement("div").focus({get preventScroll(){return Gm=!0,!0}})}catch{}}return Gm}function mle(t){let e=t.parentNode,r=[],n=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==n;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&r.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return n instanceof HTMLElement&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),r}function gle(t){for(let{element:e,scrollTop:r,scrollLeft:n}of t)e.scrollTop=r,e.scrollLeft=n}function py(t){var e;if(typeof window>"u"||window.navigator==null)return!1;let r=(e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands;return Array.isArray(r)&&r.some(n=>t.test(n.brand))||t.test(window.navigator.userAgent)}function F9(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function hh(t){let e=null;return()=>(e==null&&(e=t()),e)}const ex=hh(function(){return F9(/^Mac/i)}),xle=hh(function(){return F9(/^iPad/i)||ex()&&navigator.maxTouchPoints>1}),yle=hh(function(){return py(/AppleWebKit/i)&&!ble()}),ble=hh(function(){return py(/Chrome/i)}),vle=hh(function(){return py(/Android/i)}),wle=hh(function(){return py(/Firefox/i)});function s0(t,e,r=!0){var n,i;let{metaKey:a,ctrlKey:l,altKey:d,shiftKey:u}=e;wle()&&(!((i=window.event)===null||i===void 0||(n=i.type)===null||n===void 0)&&n.startsWith("key"))&&t.target==="_blank"&&(ex()?a=!0:l=!0);let h=yle()&&ex()&&!xle()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:l,altKey:d,shiftKey:u}):new MouseEvent("click",{metaKey:a,ctrlKey:l,altKey:d,shiftKey:u,detail:1,bubbles:!0,cancelable:!0});s0.isOpening=r,fle(t),t.dispatchEvent(h),s0.isOpening=!1}s0.isOpening=!1;function H9(){let t=y.useRef(new Map),e=y.useCallback((i,a,l,d)=>{let u=d?.once?(...h)=>{t.current.delete(l),l(...h)}:l;t.current.set(l,{type:a,eventTarget:i,fn:u,options:d}),i.addEventListener(a,u,d)},[]),r=y.useCallback((i,a,l,d)=>{var u;let h=((u=t.current.get(l))===null||u===void 0?void 0:u.fn)||l;i.removeEventListener(a,h,d),t.current.delete(l)},[]),n=y.useCallback(()=>{t.current.forEach((i,a)=>{r(i.eventTarget,i.type,a,i.options)})},[r]);return y.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function jle(t){return t.pointerType===""&&t.isTrusted?!0:vle()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function W9(t){let e=t;return e.nativeEvent=t,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function Nle(t,e){Object.defineProperty(t,"target",{value:e}),Object.defineProperty(t,"currentTarget",{value:e})}function G9(t){let e=y.useRef({isFocused:!1,observer:null});return cle(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]),y.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let n=r.target,i=a=>{if(e.current.isFocused=!1,n.disabled){let l=W9(a);t?.(l)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};n.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&n.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let l=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:l})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:l}))}}),e.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let kle=!1,$0=null,Vj=new Set,zf=new Map,yd=!1,Kj=!1;const Sle={Tab:!0,Escape:!0};function i5(t,e){for(let r of Vj)r(t,e)}function _le(t){return!(t.metaKey||!ex()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function tx(t){yd=!0,!s0.isOpening&&_le(t)&&($0="keyboard",i5("keyboard",t))}function qu(t){$0="pointer","pointerType"in t&&t.pointerType,(t.type==="mousedown"||t.type==="pointerdown")&&(yd=!0,i5("pointer",t))}function V9(t){!s0.isOpening&&jle(t)&&(yd=!0,$0="virtual")}function K9(t){t.target===window||t.target===document||kle||!t.isTrusted||(!yd&&!Kj&&($0="virtual",i5("virtual",t)),yd=!1,Kj=!1)}function Y9(){yd=!1,Kj=!0}function Yj(t){if(typeof window>"u"||typeof document>"u"||zf.get(Qc(t)))return;const e=Qc(t),r=jc(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){yd=!0,n.apply(this,arguments)},r.addEventListener("keydown",tx,!0),r.addEventListener("keyup",tx,!0),r.addEventListener("click",V9,!0),e.addEventListener("focus",K9,!0),e.addEventListener("blur",Y9,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",qu,!0),r.addEventListener("pointermove",qu,!0),r.addEventListener("pointerup",qu,!0)),e.addEventListener("beforeunload",()=>{X9(t)},{once:!0}),zf.set(e,{focus:n})}const X9=(t,e)=>{const r=Qc(t),n=jc(t);e&&n.removeEventListener("DOMContentLoaded",e),zf.has(r)&&(r.HTMLElement.prototype.focus=zf.get(r).focus,n.removeEventListener("keydown",tx,!0),n.removeEventListener("keyup",tx,!0),n.removeEventListener("click",V9,!0),r.removeEventListener("focus",K9,!0),r.removeEventListener("blur",Y9,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",qu,!0),n.removeEventListener("pointermove",qu,!0),n.removeEventListener("pointerup",qu,!0)),zf.delete(r))};function Cle(t){const e=jc(t);let r;return e.readyState!=="loading"?Yj(t):(r=()=>{Yj(t)},e.addEventListener("DOMContentLoaded",r)),()=>X9(t,r)}typeof document<"u"&&Cle();function J9(){return $0!=="pointer"}const Ele=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Ale(t,e,r){let n=jc(r?.target);const i=typeof window<"u"?Qc(r?.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?Qc(r?.target).HTMLTextAreaElement:HTMLTextAreaElement,l=typeof window<"u"?Qc(r?.target).HTMLElement:HTMLElement,d=typeof window<"u"?Qc(r?.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof i&&!Ele.has(n.activeElement.type)||n.activeElement instanceof a||n.activeElement instanceof l&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof d&&!Sle[r.key])}function Tle(t,e,r){Yj(),y.useEffect(()=>{let n=(i,a)=>{Ale(!!r?.isTextInput,i,a)&&t(J9())};return Vj.add(n),()=>{Vj.delete(n)}},e)}function Ole(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:i}=t;const a=y.useCallback(u=>{if(u.target===u.currentTarget)return n&&n(u),i&&i(!1),!0},[n,i]),l=G9(a),d=y.useCallback(u=>{const h=jc(u.target),p=h?Gj(h):Gj();u.target===u.currentTarget&&p===z9(u.nativeEvent)&&(r&&r(u),i&&i(!0),l(u))},[i,r,l]);return{focusProps:{onFocus:!e&&(r||i||n)?d:void 0,onBlur:!e&&(n||i)?a:void 0}}}function Mle(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:i}=t,a=y.useRef({isFocusWithin:!1}),{addGlobalListener:l,removeAllGlobalListeners:d}=H9(),u=y.useCallback(m=>{m.currentTarget.contains(m.target)&&a.current.isFocusWithin&&!m.currentTarget.contains(m.relatedTarget)&&(a.current.isFocusWithin=!1,d(),r&&r(m),i&&i(!1))},[r,i,a,d]),h=G9(u),p=y.useCallback(m=>{if(!m.currentTarget.contains(m.target))return;const x=jc(m.target),b=Gj(x);if(!a.current.isFocusWithin&&b===z9(m.nativeEvent)){n&&n(m),i&&i(!0),a.current.isFocusWithin=!0,h(m);let v=m.currentTarget;l(x,"focus",w=>{if(a.current.isFocusWithin&&!U9(v,w.target)){let k=new x.defaultView.FocusEvent("blur",{relatedTarget:w.target});Nle(k,v);let _=W9(k);u(_)}},{capture:!0})}},[n,i,h,l,u]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:p,onBlur:u}}}let Xj=!1,Vm=0;function Lle(){Xj=!0,setTimeout(()=>{Xj=!1},50)}function eT(t){t.pointerType==="touch"&&Lle()}function Rle(){if(!(typeof document>"u"))return Vm===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",eT),Vm++,()=>{Vm--,!(Vm>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",eT)}}function Ple(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:i}=t,[a,l]=y.useState(!1),d=y.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;y.useEffect(Rle,[]);let{addGlobalListener:u,removeAllGlobalListeners:h}=H9(),{hoverProps:p,triggerHoverEnd:m}=y.useMemo(()=>{let x=(w,k)=>{if(d.pointerType=k,i||k==="touch"||d.isHovered||!w.currentTarget.contains(w.target))return;d.isHovered=!0;let _=w.currentTarget;d.target=_,u(jc(w.target),"pointerover",T=>{d.isHovered&&d.target&&!U9(d.target,T.target)&&b(T,T.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:_,pointerType:k}),r&&r(!0),l(!0)},b=(w,k)=>{let _=d.target;d.pointerType="",d.target=null,!(k==="touch"||!d.isHovered||!_)&&(d.isHovered=!1,h(),n&&n({type:"hoverend",target:_,pointerType:k}),r&&r(!1),l(!1))},v={};return typeof PointerEvent<"u"&&(v.onPointerEnter=w=>{Xj&&w.pointerType==="mouse"||x(w,w.pointerType)},v.onPointerLeave=w=>{!i&&w.currentTarget.contains(w.target)&&b(w,w.pointerType)}),{hoverProps:v,triggerHoverEnd:b}},[e,r,n,i,d,u,h]);return y.useEffect(()=>{i&&m({currentTarget:d.target},d.pointerType)},[i]),{hoverProps:p,isHovered:a}}function Ile(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,i=y.useRef({isFocused:!1,isFocusVisible:e||J9()}),[a,l]=y.useState(!1),[d,u]=y.useState(()=>i.current.isFocused&&i.current.isFocusVisible),h=y.useCallback(()=>u(i.current.isFocused&&i.current.isFocusVisible),[]),p=y.useCallback(b=>{i.current.isFocused=b,l(b),h()},[h]);Tle(b=>{i.current.isFocusVisible=b,h()},[],{isTextInput:r});let{focusProps:m}=Ole({isDisabled:n,onFocusChange:p}),{focusWithinProps:x}=Mle({isDisabled:!n,onFocusWithinChange:p});return{isFocused:a,isFocusVisible:d,focusProps:n?x:m}}var Dle=Object.defineProperty,Ble=(t,e,r)=>e in t?Dle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ww=(t,e,r)=>(Ble(t,typeof e!="symbol"?e+"":e,r),r);let $le=class{constructor(){ww(this,"current",this.detect()),ww(this,"handoffState","pending"),ww(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Q9=new $le;function Z9(t){var e;return Q9.isServer?null:t==null?document:(e=t?.ownerDocument)!=null?e:document}function Ule(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function my(){let t=[],e={addEventListener(r,n,i,a){return r.addEventListener(n,i,a),e.add(()=>r.removeEventListener(n,i,a))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return e.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return Ule(()=>{n.current&&r[0]()}),e.add(()=>{n.current=!1})},style(r,n,i){let a=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:i}),this.add(()=>{Object.assign(r.style,{[n]:a})})},group(r){let n=my();return r(n),this.add(()=>n.dispose())},add(r){return t.includes(r)||t.push(r),()=>{let n=t.indexOf(r);if(n>=0)for(let i of t.splice(n,1))i()}},dispose(){for(let r of t.splice(0))r()}};return e}function e7(){let[t]=y.useState(my);return y.useEffect(()=>()=>t.dispose(),[t]),t}let t7=(t,e)=>{Q9.isServer?y.useEffect(t,e):y.useLayoutEffect(t,e)};function zle(t){let e=y.useRef(t);return t7(()=>{e.current=t},[t]),e}let qo=function(t){let e=zle(t);return Ge.useCallback((...r)=>e.current(...r),[e])};function qle(t){let e=t.width/2,r=t.height/2;return{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function Fle(t,e){return!(!t||!e||t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function Hle({disabled:t=!1}={}){let e=y.useRef(null),[r,n]=y.useState(!1),i=e7(),a=qo(()=>{e.current=null,n(!1),i.dispose()}),l=qo(d=>{if(i.dispose(),e.current===null){e.current=d.currentTarget,n(!0);{let u=Z9(d.currentTarget);i.addEventListener(u,"pointerup",a,!1),i.addEventListener(u,"pointermove",h=>{if(e.current){let p=qle(h);n(Fle(p,e.current.getBoundingClientRect()))}},!1),i.addEventListener(u,"pointercancel",a,!1)}}});return{pressed:r,pressProps:t?{}:{onPointerDown:l,onPointerUp:a,onClick:a}}}function a5(t){return y.useMemo(()=>t,Object.values(t))}function tT(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function U0(t,e,...r){if(t in e){let i=e[t];return typeof i=="function"?i(...r):i}let n=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,U0),n}var Jj=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Jj||{}),Wle=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(Wle||{});function o5(){let t=Vle();return y.useCallback(e=>Gle({mergeRefs:t,...e}),[t])}function Gle({ourProps:t,theirProps:e,slot:r,defaultTag:n,features:i,visible:a=!0,name:l,mergeRefs:d}){d=d??Kle;let u=r7(e,t);if(a)return Km(u,r,n,l,d);let h=i??0;if(h&2){let{static:p=!1,...m}=u;if(p)return Km(m,r,n,l,d)}if(h&1){let{unmount:p=!0,...m}=u;return U0(p?0:1,{0(){return null},1(){return Km({...m,hidden:!0,style:{display:"none"}},r,n,l,d)}})}return Km(u,r,n,l,d)}function Km(t,e={},r,n,i){let{as:a=r,children:l,refName:d="ref",...u}=jw(t,["unmount","static"]),h=t.ref!==void 0?{[d]:t.ref}:{},p=typeof l=="function"?l(e):l;"className"in u&&u.className&&typeof u.className=="function"&&(u.className=u.className(e)),u["aria-labelledby"]&&u["aria-labelledby"]===u.id&&(u["aria-labelledby"]=void 0);let m={};if(e){let x=!1,b=[];for(let[v,w]of Object.entries(e))typeof w=="boolean"&&(x=!0),w===!0&&b.push(v.replace(/([A-Z])/g,k=>`-${k.toLowerCase()}`));if(x){m["data-headlessui-state"]=b.join(" ");for(let v of b)m[`data-${v}`]=""}}if(qf(a)&&(Object.keys(vu(u)).length>0||Object.keys(vu(m)).length>0))if(!y.isValidElement(p)||Array.isArray(p)&&p.length>1||Xle(p)){if(Object.keys(vu(u)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(vu(u)).concat(Object.keys(vu(m))).map(x=>`  - ${x}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(x=>`  - ${x}`).join(`
`)].join(`
`))}else{let x=p.props,b=x?.className,v=typeof b=="function"?(..._)=>tT(b(..._),u.className):tT(b,u.className),w=v?{className:v}:{},k=r7(p.props,vu(jw(u,["ref"])));for(let _ in m)_ in k&&delete m[_];return y.cloneElement(p,Object.assign({},k,m,h,{ref:i(Yle(p),h.ref)},w))}return y.createElement(a,Object.assign({},jw(u,["ref"]),!qf(a)&&h,!qf(a)&&m),p)}function Vle(){let t=y.useRef([]),e=y.useCallback(r=>{for(let n of t.current)n!=null&&(typeof n=="function"?n(r):n.current=r)},[]);return(...r)=>{if(!r.every(n=>n==null))return t.current=r,e}}function Kle(...t){return t.every(e=>e==null)?void 0:e=>{for(let r of t)r!=null&&(typeof r=="function"?r(e):r.current=e)}}function r7(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];if(e.disabled||e["aria-disabled"])for(let n in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(r[n]=[i=>{var a;return(a=i?.preventDefault)==null?void 0:a.call(i)}]);for(let n in r)Object.assign(e,{[n](i,...a){let l=r[n];for(let d of l){if((i instanceof Event||i?.nativeEvent instanceof Event)&&i.defaultPrevented)return;d(i,...a)}}});return e}function rT(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},r={};for(let n of t)for(let i in n)i.startsWith("on")&&typeof n[i]=="function"?(r[i]!=null||(r[i]=[]),r[i].push(n[i])):e[i]=n[i];for(let n in r)Object.assign(e,{[n](...i){let a=r[n];for(let l of a)l?.(...i)}});return e}function l5(t){var e;return Object.assign(y.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function vu(t){let e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function jw(t,e=[]){let r=Object.assign({},t);for(let n of e)n in r&&delete r[n];return r}function Yle(t){return Ge.version.split(".")[0]>="19"?t.props.ref:t.ref}function qf(t){return t===y.Fragment||t===Symbol.for("react.fragment")}function Xle(t){return qf(t.type)}function Jle(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function n7(t){return Jle(t)&&"tagName"in t}function s7(t){return n7(t)&&"accessKey"in t}function nT(t){return n7(t)&&"tabIndex"in t}function Qle(t){return s7(t)&&t.nodeName==="FIELDSET"}function i7(t){return s7(t)&&t.nodeName==="LEGEND"}function Zle(t){let e=t.parentElement,r=null;for(;e&&!Qle(e);)i7(e)&&(r=e),e=e.parentElement;let n=e?.getAttribute("disabled")==="";return n&&ece(r)?!1:n}function ece(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(i7(e))return!1;e=e.previousElementSibling}return!0}let a7=Symbol();function tce(t,e=!0){return Object.assign(t,{[a7]:e})}function c5(...t){let e=y.useRef(t);y.useEffect(()=>{e.current=t},[t]);let r=qo(n=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(n):i.current=n)});return t.every(n=>n==null||n?.[a7])?void 0:r}var Au=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Au||{});let rce=y.createContext(()=>{});function nce({value:t,children:e}){return Ge.createElement(rce.Provider,{value:t},e)}var Nw={exports:{}},kw={};var sT;function sce(){if(sT)return kw;sT=1;var t=al();function e(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,l=t.useMemo,d=t.useDebugValue;return kw.useSyncExternalStoreWithSelector=function(u,h,p,m,x){var b=i(null);if(b.current===null){var v={hasValue:!1,value:null};b.current=v}else v=b.current;b=l(function(){function k(O){if(!_){if(_=!0,T=O,O=m(O),x!==void 0&&v.hasValue){var M=v.value;if(x(M,O))return A=M}return A=O}if(M=A,r(T,O))return M;var E=m(O);return x!==void 0&&x(M,E)?(T=O,M):(T=O,A=E)}var _=!1,T,A,I=p===void 0?null:p;return[function(){return k(h())},I===null?void 0:function(){return k(I())}]},[h,p,m,x]);var w=n(u,b[0],b[1]);return a(function(){v.hasValue=!0,v.value=w},[w]),d(w),w},kw}var iT;function ice(){return iT||(iT=1,Nw.exports=sce()),Nw.exports}ice();function ace(t,e){return y.useMemo(()=>{var r;if(t.type)return t.type;let n=(r=t.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||e?.tagName==="BUTTON"&&!e.hasAttribute("type"))return"button"},[t.type,t.as,e])}function oce(t=0){let[e,r]=y.useState(t),n=y.useCallback(u=>r(u),[]),i=y.useCallback(u=>r(h=>h|u),[]),a=y.useCallback(u=>(e&u)===u,[e]),l=y.useCallback(u=>r(h=>h&~u),[]),d=y.useCallback(u=>r(h=>h^u),[]);return{flags:e,setFlag:n,addFlag:i,hasFlag:a,removeFlag:l,toggleFlag:d}}var lce={},aT,oT;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((aT=process==null?void 0:lce)==null?void 0:aT.NODE_ENV)==="test"&&typeof((oT=Element?.prototype)==null?void 0:oT.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var cce=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(cce||{});function dce(t){let e={};for(let r in t)t[r]===!0&&(e[`data-${r}`]="");return e}function uce(t,e,r,n){let[i,a]=y.useState(r),{hasFlag:l,addFlag:d,removeFlag:u}=oce(t&&i?3:0),h=y.useRef(!1),p=y.useRef(!1),m=e7();return t7(()=>{var x;if(t){if(r&&a(!0),!e){r&&d(3);return}return(x=void 0)==null||x.call(n,r),hce(e,{inFlight:h,prepare(){p.current?p.current=!1:p.current=h.current,h.current=!0,!p.current&&(r?(d(3),u(4)):(d(4),u(2)))},run(){p.current?r?(u(3),d(4)):(u(4),d(3)):r?u(1):d(1)},done(){var b;p.current&&mce(e)||(h.current=!1,u(7),r||a(!1),(b=void 0)==null||b.call(n,r))}})}},[t,r,e,m]),t?[i,{closed:l(1),enter:l(2),leave:l(4),transition:l(2)||l(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function hce(t,{prepare:e,run:r,done:n,inFlight:i}){let a=my();return pce(t,{prepare:e,inFlight:i}),a.nextFrame(()=>{r(),a.requestAnimationFrame(()=>{a.add(fce(t,n))})}),a.dispose}function fce(t,e){var r,n;let i=my();if(!t)return i.dispose;let a=!1;i.add(()=>{a=!0});let l=(n=(r=t.getAnimations)==null?void 0:r.call(t).filter(d=>d instanceof CSSTransition))!=null?n:[];return l.length===0?(e(),i.dispose):(Promise.allSettled(l.map(d=>d.finished)).then(()=>{a||e()}),i.dispose)}function pce(t,{inFlight:e,prepare:r}){if(e!=null&&e.current){r();return}let n=t.style.transition;t.style.transition="none",r(),t.offsetHeight,t.style.transition=n}function mce(t){var e,r;return((r=(e=t.getAnimations)==null?void 0:e.call(t))!=null?r:[]).some(n=>n instanceof CSSTransition&&n.playState!=="finished")}let gy=y.createContext(null);gy.displayName="OpenClosedContext";var i0=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(i0||{});function gce(){return y.useContext(gy)}function xce({value:t,children:e}){return Ge.createElement(gy.Provider,{value:t},e)}function yce({children:t}){return Ge.createElement(gy.Provider,{value:null},t)}var lT;let bce=(lT=Ge.startTransition)!=null?lT:function(t){t()};var vce=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(vce||{}),wce=(t=>(t[t.ToggleDisclosure=0]="ToggleDisclosure",t[t.CloseDisclosure=1]="CloseDisclosure",t[t.SetButtonId=2]="SetButtonId",t[t.SetPanelId=3]="SetPanelId",t[t.SetButtonElement=4]="SetButtonElement",t[t.SetPanelElement=5]="SetPanelElement",t))(wce||{});let jce={0:t=>({...t,disclosureState:U0(t.disclosureState,{0:1,1:0})}),1:t=>t.disclosureState===1?t:{...t,disclosureState:1},2(t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},3(t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}},4(t,e){return t.buttonElement===e.element?t:{...t,buttonElement:e.element}},5(t,e){return t.panelElement===e.element?t:{...t,panelElement:e.element}}},d5=y.createContext(null);d5.displayName="DisclosureContext";function u5(t){let e=y.useContext(d5);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,u5),r}return e}let h5=y.createContext(null);h5.displayName="DisclosureAPIContext";function o7(t){let e=y.useContext(h5);if(e===null){let r=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,o7),r}return e}let f5=y.createContext(null);f5.displayName="DisclosurePanelContext";function Nce(){return y.useContext(f5)}function kce(t,e){return U0(e.type,jce,t,e)}let Sce=y.Fragment;function _ce(t,e){let{defaultOpen:r=!1,...n}=t,i=y.useRef(null),a=c5(e,tce(w=>{i.current=w},t.as===void 0||qf(t.as))),l=y.useReducer(kce,{disclosureState:r?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:d,buttonId:u},h]=l,p=qo(w=>{h({type:1});let k=Z9(i.current);if(!k||!u)return;let _=w?nT(w)?w:"current"in w&&nT(w.current)?w.current:k.getElementById(u):k.getElementById(u);_?.focus()}),m=y.useMemo(()=>({close:p}),[p]),x=a5({open:d===0,close:p}),b={ref:a},v=o5();return Ge.createElement(d5.Provider,{value:l},Ge.createElement(h5.Provider,{value:m},Ge.createElement(nce,{value:p},Ge.createElement(xce,{value:U0(d,{0:i0.Open,1:i0.Closed})},v({ourProps:b,theirProps:n,slot:x,defaultTag:Sce,name:"Disclosure"})))))}let Cce="button";function Ece(t,e){let r=y.useId(),{id:n=`headlessui-disclosure-button-${r}`,disabled:i=!1,autoFocus:a=!1,...l}=t,[d,u]=u5("Disclosure.Button"),h=Nce(),p=h===null?!1:h===d.panelId,m=y.useRef(null),x=c5(m,e,qo($=>{if(!p)return u({type:4,element:$})}));y.useEffect(()=>{if(!p)return u({type:2,buttonId:n}),()=>{u({type:2,buttonId:null})}},[n,u,p]);let b=qo($=>{var B;if(p){if(d.disclosureState===1)return;switch($.key){case Au.Space:case Au.Enter:$.preventDefault(),$.stopPropagation(),u({type:0}),(B=d.buttonElement)==null||B.focus();break}}else switch($.key){case Au.Space:case Au.Enter:$.preventDefault(),$.stopPropagation(),u({type:0});break}}),v=qo($=>{$.key===Au.Space&&$.preventDefault()}),w=qo($=>{var B;Zle($.currentTarget)||i||(p?(u({type:0}),(B=d.buttonElement)==null||B.focus()):u({type:0}))}),{isFocusVisible:k,focusProps:_}=Ile({autoFocus:a}),{isHovered:T,hoverProps:A}=Ple({isDisabled:i}),{pressed:I,pressProps:O}=Hle({disabled:i}),M=a5({open:d.disclosureState===0,hover:T,active:I,disabled:i,focus:k,autofocus:a}),E=ace(t,d.buttonElement),R=rT(p?{ref:x,type:E,disabled:i||void 0,autoFocus:a,onKeyDown:b,onClick:w}:{ref:x,id:n,type:E,"aria-expanded":d.disclosureState===0,"aria-controls":d.panelElement?d.panelId:void 0,disabled:i||void 0,autoFocus:a,onKeyDown:b,onKeyUp:v,onClick:w},_,A,O);return o5()({ourProps:R,theirProps:l,slot:M,defaultTag:Cce,name:"Disclosure.Button"})}let Ace="div",Tce=Jj.RenderStrategy|Jj.Static;function Oce(t,e){let r=y.useId(),{id:n=`headlessui-disclosure-panel-${r}`,transition:i=!1,...a}=t,[l,d]=u5("Disclosure.Panel"),{close:u}=o7("Disclosure.Panel"),[h,p]=y.useState(null),m=c5(e,qo(T=>{bce(()=>d({type:5,element:T}))}),p);y.useEffect(()=>(d({type:3,panelId:n}),()=>{d({type:3,panelId:null})}),[n,d]);let x=gce(),[b,v]=uce(i,h,x!==null?(x&i0.Open)===i0.Open:l.disclosureState===0),w=a5({open:l.disclosureState===0,close:u}),k={ref:m,id:n,...dce(v)},_=o5();return Ge.createElement(yce,null,Ge.createElement(f5.Provider,{value:l.panelId},_({ourProps:k,theirProps:a,slot:w,defaultTag:Ace,features:Tce,visible:b,name:"Disclosure.Panel"})))}let Mce=l5(_ce),Lce=l5(Ece),Rce=l5(Oce),Sw=Object.assign(Mce,{Button:Lce,Panel:Rce});const l7=({isOpen:t,onClose:e})=>t?ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-3xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-indigo-900 to-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-tight",children:"Access Control Guide"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Everything you need to know about Pods & Permissions."})]})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:"1"}),'What is a "Pod"?']}),s.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:['In Magic: The Gathering, a "Pod" is your local playgroup. On Forge, it represents your list of ',s.jsx("strong",{children:"Trusted Connections"}),". Linking accounts with someone in your Pod allows you to share digital resources instantly."]}),s.jsx("div",{className:"bg-blue-900/10 border border-blue-500/20 p-4 rounded-xl",children:s.jsx("p",{className:"text-blue-200 text-sm font-medium",children:" Pro Tip: Only add people you actually know and trust to your Pod."})})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center text-xs",children:"2"}),"Permission Levels"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("span",{className:"text-indigo-400 font-black uppercase text-xs tracking-wider",children:"Default"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Viewer"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," View Private Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," View Collection"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Download/Clone Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Edit Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Change Settings"]})]})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:[s.jsx("span",{className:"text-purple-400 font-black uppercase text-xs tracking-wider",children:"Advanced"}),s.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Editor"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Everything in Viewer"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," ",s.jsx("strong",{children:"Add/Remove Cards"})," from Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Add Cards to Collection"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Delete Decks"]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-red-400",children:""})," Manage Account"]})]})]})]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center text-xs",children:"3"}),"Shared Collections"]}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-4",children:`When building a deck, you can choose to see cards from your friends' collections. This is perfect for brewing "Team Decks" or borrowing cards you don't own.`}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-sm text-gray-400 border border-gray-700",children:[s.jsx("strong",{children:"How to use:"}),` In the Deck Builder, open the "Sources" dropdown and select a friend's collection to see their cards alongside yours.`]})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-red-500/20 text-red-400 flex items-center justify-center text-xs",children:"4"}),"Safety & Revoking"]}),s.jsxs("p",{className:"text-gray-300 text-sm leading-relaxed",children:["You are always in control. You can revoke access at any time from this menu or the Settings page. Revoking access is ",s.jsx("strong",{children:"immediate"}),". The other user will be disconnected from your session instantly."]}),s.jsx("div",{className:"mt-4 flex gap-4",children:s.jsxs("div",{className:"flex-1 p-3 bg-red-900/10 border border-red-500/10 rounded-lg",children:[s.jsx("h5",{className:"font-bold text-red-400 text-xs uppercase mb-1",children:"They Cannot"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Delete your account, change your password, or permanently delete your cards/decks."})]})})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors font-bold text-sm shadow-lg",children:"Got it, thanks!"})})]})]}),document.body):null,Pce=({isOpen:t,onClose:e,connection:r})=>{const{addToast:n}=_r(),[i,a]=y.useState([]),[l,d]=y.useState(!0),[u,h]=y.useState(!1),[p,m]=y.useState(!1);y.useEffect(()=>{t&&r&&(async()=>{d(!0);try{const k=await ts.fetchPermissions(),_=(Array.isArray(k)?k:[]).filter(T=>T.grantee_id===r.friend.id);a(_)}catch(k){console.error(k),n("Failed to load permissions","error")}finally{d(!1)}})()},[t,r]);const x=async w=>{h(!0);try{await ts.grantPermission(r.friend.id,w,null),n(`Global ${w} access granted`,"success");const k=await ts.fetchPermissions(),_=(Array.isArray(k)?k:[]).filter(T=>T.grantee_id===r.friend.id);a(_)}catch(k){console.error(k),n("Failed to update permission","error")}finally{h(!1)}},b=async w=>{try{await ts.revokePermission(w),n("Permission revoked","info"),a(k=>k.filter(_=>_.id!==w))}catch(k){console.error(k),n("Failed to revoke permission","error")}};if(!t||!r)return null;const v=i.find(w=>w.target_deck_id===null);return ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity",onClick:e}),s.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-2xl relative z-10 shadow-2xl overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]",children:[s.jsx("div",{className:"p-8 border-b border-white/5 bg-gradient-to-r from-gray-900 to-gray-950 flex justify-between items-start",children:s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-black text-3xl shadow-lg ring-4 ring-gray-900",children:r.friend.username?.[0]?.toUpperCase()}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:r.friend.username}),s.jsx("p",{className:"text-indigo-400 font-bold uppercase tracking-widest text-xs mt-1",children:"Manage Permissions"})]})]})}),s.jsxs("div",{className:"p-8 space-y-8 overflow-y-auto custom-scrollbar",children:[s.jsx("div",{className:"bg-indigo-900/10 border border-indigo-500/20 rounded-xl overflow-hidden",children:s.jsx(Sw,{children:({open:w})=>s.jsxs(s.Fragment,{children:[s.jsxs(Sw.Button,{className:"flex justify-between w-full px-4 py-3 text-sm font-bold text-indigo-300 hover:text-indigo-200 transition-colors uppercase tracking-wider text-left",children:[s.jsx("span",{children:"What does Linking Accounts do?"}),s.jsx(qY,{className:`${w?"transform rotate-180":""} w-5 h-5 text-indigo-400`})]}),s.jsxs(Sw.Panel,{className:"px-4 pb-4 text-sm text-indigo-200/80 leading-relaxed space-y-2",children:[s.jsx("p",{children:"Linking accounts allows you to share your Magic: The Gathering experience with trusted friends."}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1 mt-2",children:[s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Sharing Decks:"})," Friends can view your private decks to offer advice or clone them."]}),s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Shared Collection:"})," Combine your card pools visually to build decks together."]}),s.jsxs("li",{children:[s.jsx("strong",{className:"text-white",children:"Deck Editing:"})," If granted ",s.jsx("strong",{children:"Editor"})," access, friends can actively tweak your deck lists (add/remove cards)."]})]}),s.jsx("p",{className:"mt-2 text-xs italic opacity-70",children:"Note: Friends can NEVER delete your decks or account, regardless of permission level."}),s.jsx("div",{className:"pt-2 mt-2 border-t border-indigo-500/20",children:s.jsxs("a",{href:"#",className:"flex items-center gap-2 text-indigo-400 hover:text-white font-bold transition-colors",onClick:k=>{k.preventDefault(),m(!0)},children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Read the Full Setup Guide"]})})]})]})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Global Access Level"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>x("viewer"),disabled:u,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${v?.permission_level==="viewer"?"bg-indigo-600/10 border-indigo-500 shadow-indigo-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-lg font-black ${v?.permission_level==="viewer"?"text-indigo-400":"text-white"}`,children:"Viewer"}),v?.permission_level==="viewer"&&s.jsx("span",{className:"bg-indigo-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),s.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Read-only access. Can view your ",s.jsx("strong",{children:"private decks"}),", ",s.jsx("strong",{children:"binders"}),", and ",s.jsx("strong",{children:"collection"}),". Cannot make changes."]})]}),s.jsxs("button",{onClick:()=>x("editor"),disabled:u,className:`relative group p-5 rounded-2xl border-2 text-left transition-all duration-300 hover:shadow-xl ${v?.permission_level==="editor"?"bg-purple-600/10 border-purple-500 shadow-purple-900/20":"bg-gray-800/50 border-gray-700 hover:border-gray-500 hover:bg-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-lg font-black ${v?.permission_level==="editor"?"text-purple-400":"text-white"}`,children:"Editor"}),v?.permission_level==="editor"&&s.jsx("span",{className:"bg-purple-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase",children:"Active"})]}),s.jsxs("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors leading-relaxed",children:["Full collaboration. Can ",s.jsx("strong",{children:"edit your decks"}),", add cards to your ",s.jsx("strong",{children:"collection"}),", and view everything."]})]})]}),v&&s.jsx("div",{className:"mt-6 flex justify-center",children:s.jsxs("button",{onClick:()=>b(v.id),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Revoke All Access"]})})]}),s.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-gray-500 uppercase tracking-widest mb-4",children:"Specific Deck Overrides"}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto custom-scrollbar bg-gray-950/30 rounded-xl border border-white/5 p-2",children:i.filter(w=>w.target_deck_id).length>0?i.filter(w=>w.target_deck_id).map(w=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded bg-gray-900 flex items-center justify-center text-gray-500",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsxs("div",{children:[s.jsxs("span",{className:"text-sm font-bold text-gray-200 block",children:["Deck #",w.target_deck_id.slice(0,8),"..."]}),s.jsxs("span",{className:"text-xs text-gray-500 uppercase tracking-wider",children:[w.permission_level," Access"]})]})]}),s.jsx("button",{onClick:()=>b(w.id),className:"text-gray-500 hover:text-red-400 p-2 hover:bg-white/5 rounded-lg transition-colors",title:"Revoke Permission",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},w.id)):s.jsx("div",{className:"text-center py-6 text-gray-500",children:s.jsx("p",{className:"text-xs italic",children:"No specific deck permissions granted."})})})]})]}),s.jsx("div",{className:"p-6 bg-gray-950 border-t border-white/5 flex justify-end",children:s.jsx("button",{onClick:e,className:"px-6 py-3 bg-white text-gray-900 hover:bg-gray-200 rounded-xl transition-colors font-bold text-sm shadow-xl",children:"Done"})})]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }
            `}}),s.jsx(l7,{isOpen:p,onClose:()=>m(!1)})]}),document.body)},Ice=({isOpen:t,onClose:e,onSuccess:r})=>{const{updateProfileFields:n}=Mt(),[i,a]=y.useState(""),[l,d]=y.useState(!1),[u,h]=y.useState(null),p=async m=>{if(m.preventDefault(),h(null),!i.trim()){h("Username is required.");return}d(!0);try{await n({username:i.trim()}),r(),e()}catch(x){console.error(x),h("Failed to update username. It might be taken.")}finally{d(!1)}};return t?ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-sm"}),s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-md relative z-10 shadow-2xl p-8 animate-fade-in-up",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Identify Yourself"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"To connect with friends and share decks, you need to set a unique username so others can find you."}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block",children:"Username"}),s.jsx("input",{type:"text",value:i,onChange:m=>a(m.target.value),placeholder:"e.g. Planeswalker99",className:"w-full bg-gray-950 border border-gray-800 text-white px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-600 focus:border-transparent outline-none transition-all",autoFocus:!0})]}),u&&s.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:u}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:l,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-xl shadow-lg shadow-indigo-600/20 transition-all disabled:opacity-50 flex items-center gap-2",children:l?"Saving...":"Save & Continue"})]})]})]})]}),document.body):null},Dce=({isOpen:t,onClose:e,referralUrl:r,username:n})=>{if(!t)return null;const i=()=>{const a=document.getElementById("qr-gen"),l=new XMLSerializer().serializeToString(a),d=document.createElement("canvas"),u=d.getContext("2d"),h=new Image;h.onload=()=>{d.width=h.width,d.height=h.height,u.drawImage(h,0,0);const p=d.toDataURL("image/png"),m=document.createElement("a");m.download=`MTG-Forge-Referral-${n}.png`,m.href=`${p}`,m.click()},h.src="data:image/svg+xml;base64,"+btoa(l)};return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e}),s.jsxs("div",{className:"relative bg-[#1a1c23] border border-indigo-500/30 w-full max-w-sm rounded-3xl p-8 shadow-2xl animate-fade-in pointer-events-auto",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-white p-2 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"text-center space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white mb-2",children:"Share The Forge"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Scan this code to join ",n,"'s Pod and start brewing together."]})]}),s.jsx("div",{className:"bg-white p-4 rounded-3xl inline-block shadow-inner mx-auto",children:s.jsx(D4,{id:"qr-gen",value:r,size:200,level:"H",includeMargin:!0,imageSettings:{src:"/logo.png",x:void 0,y:void 0,height:40,width:40,excavate:!0}})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:i,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl transition-all shadow-lg flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download QR Code"]}),s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:"Supports iOS & Android Camera Apps"})]})]})]})]})},Bce=()=>{const{user:t,userProfile:e}=Mt(),[r,n]=y.useState([]),[i,a]=y.useState(!0),[l,d]=y.useState(null),[u,h]=y.useState(""),[p,m]=y.useState("pod"),[x,b]=y.useState(!1),[v,w]=y.useState(null),[k,_]=y.useState(!1),T=`https://mtg-forge.com/?ref=${e?.username||t.uid}`,[A,I]=y.useState(null),[O,M]=y.useState(!1),[E,R]=y.useState(!1),[$,B]=y.useState(!1),C=async()=>{a(!0);try{const X=await ts.fetchRelationships();n(X)}catch(X){console.error(X),d("Failed to load connections.")}finally{a(!1)}};y.useEffect(()=>{C()},[]);const U=async X=>{if(X.preventDefault(),!e?.username){B(!0);return}b(!0),w(null);try{await ts.sendRequest(u,p),w({type:"success",text:`Invite sent to ${u}!`}),h(""),C()}catch(Z){w({type:"error",text:Z.response?.data?.error||"Failed to send request."})}finally{b(!1)}},L=async(X,Z)=>{if(!e?.username){B(!0);return}try{await ts.respondToRequest(X,Z),C()}catch(G){console.error(G),d("Failed to update request.")}},q=r.filter(X=>X.status==="pending"),K=q.filter(X=>X.direction==="incoming"),W=q.filter(X=>X.direction==="outgoing"),V=r.filter(X=>X.status==="accepted");return s.jsxs("div",{className:"space-y-8 animate-fade-in relative z-0",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4 border-b border-gray-800 pb-6 relative",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 mb-2",children:"My Pod"}),s.jsx("p",{className:"text-gray-400 text-sm max-w-xl leading-relaxed",children:"Connect with trusted friends to view their decks, share collections, and collaborate on brews."})]}),s.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 text-indigo-400 hover:text-white transition-colors text-sm font-bold bg-indigo-900/20 hover:bg-indigo-900/40 px-4 py-2 rounded-lg border border-indigo-500/30",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"How it Works"]})]}),i?s.jsx("div",{className:"flex justify-center py-20",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):V.length===0&&K.length===0&&W.length===0?s.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-950 rounded-3xl border border-gray-800 p-8 md:p-12 text-center animate-fade-in-up shadow-2xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),s.jsxs("div",{className:"max-w-md mx-auto relative z-10",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/10 text-indigo-400 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl ring-1 ring-inset ring-indigo-500/20",children:s.jsx("svg",{className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsx("h2",{className:"text-2xl font-black text-white mb-3",children:"Start Your Pod"}),s.jsx("p",{className:"text-gray-400 mb-8 leading-relaxed",children:"Magic is better with friends. Invite someone to your Pod to start sharing decks and combining collections."}),s.jsxs("form",{onSubmit:U,className:"space-y-6",children:[s.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl max-w-xs mx-auto",children:[s.jsx("button",{type:"button",onClick:()=>m("pod"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${p==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod Invite"}),s.jsx("button",{type:"button",onClick:()=>m("friend"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-all ${p==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Social Friend"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"email",required:!0,placeholder:"Enter friend's email address...",value:u,onChange:X=>h(X.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-5 py-4 rounded-xl focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-center placeholder-gray-600 shadow-inner"}),s.jsx("button",{type:"submit",disabled:x,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg shadow-indigo-900/20 transform hover:-translate-y-1",children:x?"Sending Invite...":p==="pod"?"Send Pod Invitation":"Send Friend Invite"})]}),v&&s.jsx("div",{className:`text-sm font-medium mt-2 ${v.type==="success"?"text-green-400":"text-red-400"}`,children:v.text})]})]})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsxs("div",{className:"bg-gray-900/30 rounded-3xl border border-gray-800 p-8 shadow-xl",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-3",children:[s.jsx("span",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-2 rounded-lg shadow-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),"Active Connections"]}),V.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:V.map(X=>s.jsxs("div",{className:"relative group bg-gray-800/40 p-5 rounded-2xl border border-gray-700/50 hover:border-indigo-500/50 transition-all duration-300 hover:bg-gray-800/60 hover:shadow-xl hover:shadow-indigo-900/10",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center text-white font-black text-2xl shadow-lg ring-2 ring-gray-900",children:X.friend.username?.[0]?.toUpperCase()||"?"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-bold text-white text-lg truncate group-hover:text-indigo-300 transition-colors uppercase",children:X.friend.username}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-[10px] uppercase tracking-widest font-black px-2 py-0.5 rounded ${X.type==="friend"?"bg-purple-900/30 text-purple-400 border border-purple-800/50":"bg-indigo-900/30 text-indigo-400 border border-indigo-800/50"}`,children:X.type==="friend"?"Friend":"Pod"}),s.jsx("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold",children:X.type==="friend"?"Social Connect":"Full Access"})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{I(X),M(!0)},className:"flex-1 bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white py-2 rounded-lg text-xs font-bold transition-colors uppercase tracking-wider border border-white/5",children:"Manage"}),s.jsx("button",{onClick:async()=>{if(window.confirm(`Are you sure you want to remove ${X.friend.username} from your Pod?`))try{await ts.deleteRelationship(X.id),n(Z=>Z.filter(G=>G.id!==X.id))}catch(Z){console.error(Z),alert("Failed to remove")}},className:"px-3 bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 rounded-lg transition-colors border border-red-500/10",title:"Remove Connection",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},X.id))}):s.jsx("div",{className:"text-center py-12 text-gray-500 italic opacity-50",children:"No active connections. Check your pending requests!"})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Add to Pod"}),s.jsxs("div",{className:"flex p-1 bg-black/40 border border-gray-700 rounded-xl mb-4",children:[s.jsx("button",{type:"button",onClick:()=>m("pod"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${p==="pod"?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Pod"}),s.jsx("button",{type:"button",onClick:()=>m("friend"),className:`flex-1 py-1.5 px-3 rounded-lg text-xs font-bold transition-all ${p==="friend"?"bg-purple-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Friend"})]}),s.jsxs("form",{onSubmit:U,className:"space-y-3",children:[s.jsx("input",{type:"email",required:!0,placeholder:"friend@example.com",value:u,onChange:X=>h(X.target.value),className:"w-full bg-black/40 border border-gray-700 text-white px-4 py-3 rounded-xl focus:outline-none focus:border-indigo-500 text-sm transition-all"}),s.jsxs("button",{type:"submit",disabled:x,className:`w-full ${p==="friend"?"bg-purple-600 hover:bg-purple-500":"bg-indigo-600 hover:bg-indigo-500"} text-white font-bold py-3 px-4 rounded-xl transition-all shadow-lg text-sm flex items-center justify-center gap-2`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Invite ",p==="pod"?"to Pod":"as Friend"]}),v&&s.jsx("div",{className:`text-xs text-center ${v.type==="success"?"text-green-400":"text-red-400"}`,children:v.text})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/10 to-purple-900/10 rounded-2xl border border-indigo-500/20 p-6 space-y-4",children:[s.jsx("h3",{className:"text-sm font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 uppercase tracking-wider mb-2",children:"Referral & Sharing"}),s.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Spread the word about MTG Forge. Anyone who joins using your unique link will be automatically connected as a Social Friend."}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded-xl p-3 flex items-center gap-2",children:[s.jsxs("span",{className:"text-[10px] text-indigo-400 font-mono truncate flex-1 leading-none select-all pt-1",children:["https://mtg-forge.com/?ref=$",e?.username||t.uid]}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`https://mtg-forge.com/?ref=${e?.username||t.uid}`),alert("Referral link copied!")},className:"p-1.5 hover:bg-indigo-500/20 text-indigo-400 rounded-lg transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>window.open(`mailto:?subject=Join me on MTG Forge&body=Hey, I've been using this awesome MTG collection manager and deck builder. Check it out: https://mtg-forge.com/?ref=${e?.username||t.uid}`),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]}),s.jsxs("button",{onClick:()=>_(!0),className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white py-2 rounded-lg text-xs font-bold transition-all border border-gray-700",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1l-3 3h2v5h2V8h2l-3-3V4h-2zm-6 8v1h12v-1H6zm0 3v1h12v-1H6z"})}),"QR Code"]})]})]})]}),s.jsx(Dce,{isOpen:k,onClose:()=>_(!1),referralUrl:T,username:e?.username||"Hunter"}),K.length>0&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/30 to-purple-900/30 rounded-2xl border border-indigo-500/30 p-6 animate-pulse-border",children:[s.jsxs("h3",{className:"text-sm font-bold text-indigo-300 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsxs("span",{className:"relative flex h-3 w-3",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-indigo-500"})]}),"Pending Requests"]}),s.jsx("div",{className:"space-y-3",children:K.map(X=>s.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-indigo-500/20 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:X.friend.username?.[0]?.toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-bold text-white text-sm truncate",children:X.friend.username}),s.jsx("div",{className:"text-xs text-indigo-300 truncate",children:"wants to join your Pod"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>L(X.id,"accepted"),className:"flex-1 bg-indigo-500 hover:bg-indigo-400 text-white text-xs font-bold py-2 rounded-lg transition-colors shadow-md",children:"Accept"}),s.jsx("button",{onClick:()=>L(X.id,"blocked"),className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-400 text-xs font-bold py-2 rounded-lg transition-colors border border-gray-700",children:"Decline"})]})]},X.id))})]}),W.length>0&&s.jsxs("div",{className:"bg-gray-900/30 rounded-2xl border border-gray-800 p-6 opacity-60 hover:opacity-100 transition-opacity",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Pending Invites"}),s.jsx("div",{className:"space-y-3",children:W.map(X=>s.jsxs("div",{className:"flex items-center gap-3 text-sm bg-gray-900 p-3 rounded-lg border border-gray-800",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500/50 animate-pulse"}),s.jsx("span",{className:"text-gray-300 truncate flex-1",children:X.friend.email})]},X.id))})]})]})]}),s.jsx(Pce,{isOpen:O,onClose:()=>M(!1),connection:A,currentUser:t}),s.jsx(Ice,{isOpen:$,onClose:()=>B(!1),onSuccess:()=>{}}),s.jsx(l7,{isOpen:E,onClose:()=>R(!1)})]})},$ce=({isOpen:t,onClose:e,onConfirm:r,user:n})=>{const[i,a]=y.useState(tt.FREE);if(y.useEffect(()=>{t&&n&&a(n.override_tier||n.subscription_tier||tt.FREE)},[t,n]),!t||!n)return null;const l=Gr[i],d=i===tt.FREE;l.prices;const h={[tt.FREE]:{m:"$0",b:"$0",y:"$0"},[tt.TIER_1]:{m:"$2.99",b:"$14.99",y:"$29.99"},[tt.TIER_2]:{m:"$4.99",b:"$24.99",y:"$49.99"},[tt.TIER_3]:{m:"$9.99",b:"$49.99",y:"$99.99"},[tt.TIER_4]:{m:"$14.99",b:"$74.99",y:"$149.99"},[tt.TIER_5]:{m:"$19.99",b:"$99.99",y:"$199.99"}}[i]||{m:"-",b:"-",y:"-"};return s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-purple-500/30 rounded-xl p-6 max-w-lg w-full shadow-2xl transform transition-all animate-fade-in relative",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Override Subscription"}),s.jsxs("p",{className:"text-gray-400 text-sm mb-6",children:["Manually set the subscription tier for ",s.jsx("span",{className:"text-white font-bold",children:n.username}),". This will bypass Stripe billing."]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Select Tier"}),s.jsx("select",{className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-500",value:i,onChange:p=>a(p.target.value),children:Object.values(tt).map(p=>s.jsxs("option",{value:p,children:[Gr[p].name," (",p.replace("tier_","Tier "),")"]},p))})]}),!d&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[s.jsx("h4",{className:"text-red-400 font-bold text-sm mb-2",children:" Potential Revenue Loss"}),s.jsxs("p",{className:"text-gray-400 text-xs mb-3",children:["By overriding this user to ",s.jsx("strong",{children:l.name}),", you are bypassing the following billing options:"]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Monthly"}),s.jsx("div",{className:"text-white font-mono",children:h.m})]}),s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"6 Months"}),s.jsx("div",{className:"text-white font-mono",children:h.b})]}),s.jsxs("div",{className:"bg-gray-800/50 p-2 rounded",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Yearly"}),s.jsx("div",{className:"text-white font-mono",children:h.y})]})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[n.override_tier&&s.jsx("button",{onClick:()=>r(null),className:"mr-auto px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold border border-red-500/30 transition-colors",children:"Remove Override"}),s.jsx("button",{onClick:e,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:()=>r(i),className:"px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-500 text-white font-bold shadow-lg",children:"Apply Override"})]})]})})},Uce=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",creating:l})=>t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 border border-indigo-500/30 rounded-xl p-6 max-w-md w-full shadow-2xl transform transition-all animate-fade-in relative",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),s.jsx("p",{className:"text-gray-300 mb-6",children:i}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:e,disabled:l,className:"px-4 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,disabled:l,className:"px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white font-bold shadow-lg disabled:opacity-50 flex items-center gap-2",children:[l&&s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})]})]})}):null,zce=()=>{const{userProfile:t}=Mt(),[e,r]=y.useState("sync"),[n,i]=y.useState([]),[a,l]=y.useState(""),[d,u]=y.useState([]),[h,p]=y.useState(!1),m=Ge.useRef(!1),[x,b]=y.useState({current:0,total:0}),[v,w]=y.useState({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),[k,_]=y.useState({updatePrices:!0,updateInfo:!0}),[T,A]=y.useState(null),[I,O]=y.useState([]),[M,E]=y.useState(!1),[R,$]=y.useState([]),[B,C]=y.useState(!1);y.useEffect(()=>{U();const he=localStorage.getItem("admin_last_sync");if(he)try{A(JSON.parse(he))}catch(We){console.error(We)}},[]),y.useEffect(()=>{e==="permissions"?L():e==="referrals"&&q()},[e]);const U=async()=>{try{const he=await Pe.get("/api/admin/sets");i(he.data||[])}catch(he){console.error(he)}},L=async()=>{E(!0);try{const he=await Pe.getUsers();he.sort((We,vt)=>(vt.settings?.isAdmin?1:0)-(We.settings?.isAdmin?1:0)||We.id-vt.id),O(he)}catch(he){console.error(he)}finally{E(!1)}},q=async()=>{C(!0);try{const he=await Pe.get("/api/admin/invitations");$(he)}catch(he){console.error(he)}finally{C(!1)}},K=async he=>{if(window.confirm("Are you sure you want to reset this invitation? This will delete the pending record."))try{await Pe.delete(`/api/admin/invitations/${he}`),q()}catch{alert("Failed to reset invitation")}},W=he=>u(We=>[...We,`${new Date().toLocaleTimeString()} - ${he}`]),V=(he,We)=>{w(vt=>{const At={...vt};return At.totalCards+=he,We&&Object.keys(We).forEach(Jt=>At.types[Jt]=(At.types[Jt]||0)+(We[Jt]||0)),At})},X=he=>{const We={date:new Date().toISOString(),stats:he};A(We),localStorage.setItem("admin_last_sync",JSON.stringify(We))},Z=async(he,We=!1)=>{if(he)try{W(`Starting sync for ${he}...`);const At=await(await fetch("/api/admin/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({setCode:he,...k})})).json();At.success?(W(`Success: ${he}. Processed ${At.count} cards.`),V(At.count,At.typeStats),We&&b(Jt=>({...Jt,current:Jt.current+1}))):W(`Error: ${At.error}`)}catch(vt){W(`Request Failed: ${vt.message}`)}},G=()=>{window.confirm("Cancel sync?")&&(m.current=!0,W("Cancelling..."))},F=async()=>{if(window.confirm("Sync ALL sets?")){p(!0),m.current=!1,W("Starting Mass Sync..."),w({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),b({current:0,total:n.length});for(const he of n){if(m.current)break;await Z(he.code,!0)}W("Mass Sync Complete!"),X(v),p(!1)}},Y=async()=>{a&&(p(!0),w({totalCards:0,types:{creature:0,instant:0,sorcery:0,enchantment:0,artifact:0,land:0,planeswalker:0,other:0}}),await Z(a),p(!1))},ne=async he=>{const We=he.target.files[0];if(!We||!window.confirm(`Upload ${We.name}?`))return;const vt=new FormData;vt.append("file",We);try{const Jt=await(await fetch("/api/admin/precons/upload",{method:"POST",body:vt})).json();Jt.success?alert(`Uploaded ${Jt.name}`):alert(`Error: ${Jt.error}`)}catch{alert("Upload failed")}he.target.value=null},re=async(he,We)=>{try{const vt=he.settings?.permissions||[],At=vt.includes(We);let Jt;At?Jt=vt.filter(wr=>wr!==We):Jt=[...vt,We],O(I.map(wr=>wr.id===he.id?{...wr,settings:{...wr.settings,permissions:Jt}}:wr)),await Pe.updateUserPermissions(he.id,Jt,he.settings?.isAdmin)}catch{alert("Failed to update permission"),L()}},ue=async he=>{if(window.confirm(`Are you sure you want to toggle ADMIN status for ${he.username}?`))try{const We=!he.settings?.isAdmin;O(I.map(vt=>vt.id===he.id?{...vt,settings:{...vt.settings,isAdmin:We}}:vt)),await Pe.updateUserPermissions(he.id,he.settings?.permissions,We)}catch{alert("Failed to update admin status"),L()}},[Le,de]=y.useState(!1),[ve,te]=y.useState(null),ge=he=>{te(he),de(!0)},ke=async he=>{if(ve)try{const We=he||"free";O(I.map(At=>At.id===ve.id?{...At,override_tier:he,subscription_tier:We}:At));const vt={user_override_tier:he,subscription_status:he?"active":"canceled"};vt.subscription_tier=We,await Pe.updateUserPermissions(ve.id,ve.settings?.permissions,ve.settings?.isAdmin,vt),de(!1),te(null)}catch(We){alert(We.message||"Failed to update subscription"),L()}},[oe,Ee]=y.useState([]),[Te,Ye]=y.useState({title:"",description:"",status:"open"}),[ze,le]=y.useState(null),[pe,me]=y.useState(!1),[Ie,Fe]=y.useState({start:ps(new Date(Date.now()-10080*60*1e3),"yyyy-MM-dd"),end:ps(new Date,"yyyy-MM-dd")}),[qe,Xe]=y.useState([]),[He,ut]=y.useState(!1),[Tt,Ut]=y.useState(""),[nt,kt]=y.useState(!1),[mt,Re]=y.useState(!1),[it,jt]=y.useState(""),[yt,Et]=y.useState(!1);y.useEffect(()=>{e==="epics"&&ot()},[e]);const ot=async()=>{me(!0);try{const he=await Pe.getEpics();Ee(he||[])}catch(he){console.error(he)}finally{me(!1)}},ae=async he=>{he.preventDefault();try{await Pe.createEpic(Te),Ye({title:"",description:"",status:"open"}),ot(),alert("Epic created successfully!")}catch(We){alert("Failed to create epic: "+We.message)}},Be=async he=>{if(he.preventDefault(),!!ze)try{await Pe.updateEpic(ze.id,ze),le(null),ot(),alert("Epic updated successfully!")}catch(We){alert("Failed to update epic: "+We.message)}},Qe=async he=>{if(window.confirm("Delete this epic? This will NOT delete associated tickets but will unlink them."))try{await Pe.deleteEpic(he),ot()}catch(We){alert("Failed to delete epic: "+We.message)}},et=he=>{const We={open:"bg-green-500/20 text-green-400 border-green-500/30",planned:"bg-blue-500/20 text-blue-400 border-blue-500/30",in_progress:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",complete_pending:"bg-pink-500/20 text-pink-400 border-pink-500/30",complete_scheduled:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",complete_blocked:"bg-orange-500/20 text-orange-400 border-orange-500/30",wont_fix:"bg-gray-500/20 text-gray-400 border-gray-500/30"},vt={open:"Open",planned:"Planned",in_progress:"In Progress",completed:"Completed",complete_pending:"Pend. Release",complete_scheduled:"Rel. Sched.",complete_blocked:"Blocked",wont_fix:"Won't Fix"};return s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-bold tracking-wider border ${We[he]||We.open}`,children:vt[he]||he})},bt=async()=>{ut(!0);try{const he=await Pe.getTicketReport({startDate:Ie.start,endDate:Ie.end,excludeReleased:!0,status:""});Xe(he)}catch(he){alert("Failed to fetch report: "+he.message)}finally{ut(!1)}},Ve=async()=>{if(!t?.settings?.geminiApiKey){alert("Missing Gemini API Key. Please add it in Settings > AI.");return}kt(!0);try{const he=await _s.generateReleaseNotes(t.settings.geminiApiKey,qe);Ut(he),jt(`v${new Date().toISOString().slice(0,10).replace(/-/g,".")}`)}catch(he){alert("Failed to generate release notes: "+he.message)}finally{kt(!1)}},Je=()=>{if(!it)return alert("Please enter a version number (e.g. v1.2.0)");if(!Tt)return alert("No notes generated");Et(!0)},pt=async()=>{Re(!0);try{const he={features:qe.filter(We=>We.type==="feature").length,bugs:qe.filter(We=>We.type==="bug").length,total:qe.length};await Pe.publishRelease({version:it,notes:Tt,ticketIds:qe.map(We=>We.id),typeStats:he}),Et(!1),Ut(""),Xe([]),alert("Release Published Successfully!")}catch(he){alert("Failed to publish: "+he.message),Et(!1)}finally{Re(!1)}};return s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx(Uce,{isOpen:yt,onClose:()=>Et(!1),onConfirm:pt,title:`Publish Release ${it}?`,message:`This will move ${qe.length} tickets to the "Released" status and they will no longer appear on the active board. Are you sure?`,confirmText:mt?"Publishing...":"Confirm Publish",creating:mt}),s.jsx($ce,{isOpen:Le,onClose:()=>de(!1),onConfirm:ke,user:ve}),s.jsxs("div",{className:"flex border-b border-gray-700 mb-6 overflow-x-auto",children:[s.jsx("button",{onClick:()=>r("sync"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="sync"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"DB Sync & Tools"}),s.jsx("button",{onClick:()=>r("permissions"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="permissions"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"User Permissions"}),s.jsx("button",{onClick:()=>r("epics"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="epics"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Epics / Projects"}),s.jsx("button",{onClick:()=>r("release"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="release"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Release Notes"}),s.jsx("button",{onClick:()=>r("referrals"),className:`px-4 py-2 border-b-2 font-medium transition-colors whitespace-nowrap ${e==="referrals"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-white"}`,children:"Referrals"})]}),e==="sync"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Scryfall Sync"}),T&&s.jsxs("div",{className:"text-right text-xs text-gray-400",children:[s.jsxs("p",{children:["Last: ",new Date(T.date).toLocaleString()]}),s.jsxs("p",{children:[T.stats.totalCards," cards"]})]})]}),s.jsxs("div",{className:"bg-purple-900/20 border border-purple-500/30 p-4 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Upload Precon JSON"}),s.jsx("input",{type:"file",accept:".json",onChange:ne,className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-indigo-900/40 p-4 rounded-lg border border-indigo-700/50",children:[s.jsx("p",{className:"text-xs text-indigo-300 uppercase font-bold",children:"Total Cards"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:v.totalCards})]}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg border border-gray-700",children:[s.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold",children:"Progress"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:x.total>0?`${x.current} / ${x.total}`:"-"}),x.total>0&&s.jsx("div",{className:"w-full bg-gray-700 h-1.5 mt-2 rounded-full overflow-hidden",children:s.jsx("div",{className:"bg-green-500 h-full transition-all",style:{width:`${x.current/x.total*100}%`}})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-lg border border-gray-700/50 flex flex-wrap gap-6 items-center",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:k.updatePrices,onChange:he=>_(We=>({...We,updatePrices:he.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),s.jsx("span",{className:"text-gray-200 text-sm",children:"Update Prices"})]}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:k.updateInfo,onChange:he=>_(We=>({...We,updateInfo:he.target.checked})),className:"form-checkbox bg-gray-800 border-gray-600 text-indigo-500"}),s.jsx("span",{className:"text-gray-200 text-sm",children:"Update Card Info"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Single Set"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white flex-1 min-w-0 max-w-full",value:a,onChange:he=>l(he.target.value),children:[s.jsx("option",{value:"",children:"Select Set..."}),n.map(he=>s.jsxs("option",{value:he.code,className:"truncate",children:[he.name," (",he.code.toUpperCase(),")"]},he.code))]}),s.jsx("button",{onClick:Y,disabled:h||!a,className:"bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white px-4 py-2 rounded-lg",children:h?"...":"Sync"})]})]}),s.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Mass Sync"}),h?s.jsx("button",{onClick:G,className:"bg-red-600 text-white px-6 py-3 rounded-lg w-full font-bold animate-pulse",children:"CANCEL"}):s.jsx("button",{onClick:F,className:"bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg w-full font-bold",children:"SYNC ALL"})]})]}),s.jsx("div",{className:"bg-black/50 p-4 rounded-lg font-mono text-xs text-green-400 h-64 overflow-y-auto border border-white/10",children:d.map((he,We)=>s.jsx("div",{children:he},We))})]})]}),e==="permissions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"User Permissions Manager"}),M?s.jsx("p",{className:"text-gray-400",children:"Loading users..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-700 text-gray-400 text-sm uppercase",children:[s.jsx("th",{className:"py-3 px-4",children:"User"}),s.jsx("th",{className:"py-3 px-4",children:"Email"}),s.jsx("th",{className:"py-3 px-4",children:"Subscription"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Admin"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Ticket Mgr"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Actions"})]})}),s.jsx("tbody",{className:"text-sm divide-y divide-gray-800",children:I.map(he=>{const We=he.settings?.permissions?.includes("manage_tickets"),vt=he.settings?.isAdmin;return s.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[s.jsxs("td",{className:"py-3 px-4 font-medium text-white",children:[he.username||"No Username",he.id===1&&s.jsx("span",{className:"ml-2 text-[10px] bg-yellow-500 text-black px-1 rounded",children:"ROOT"})]}),s.jsx("td",{className:"py-3 px-4 text-gray-400",children:he.email}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${he.override_tier?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-gray-700 text-gray-300 border-gray-600"}`,children:(he.override_tier||he.subscription_tier||"free").replace("tier_","Tier ")}),s.jsx("button",{onClick:()=>ge(he),className:"text-[10px] bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition-colors",children:"Manage"})]})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>ue(he),className:`w-8 h-4 rounded-full transition-colors relative ${vt?"bg-indigo-600":"bg-gray-600"}`,children:s.jsx("span",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${vt?"translate-x-4":"translate-x-0"}`})})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>re(he,"manage_tickets"),className:`w-8 h-4 rounded-full transition-colors relative ${We?"bg-green-600":"bg-gray-600"}`,children:s.jsx("span",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${We?"translate-x-4":"translate-x-0"}`})})}),s.jsxs("td",{className:"py-3 px-4 text-right text-xs text-gray-500",children:["ID: ",he.id]})]},he.id)})})]})})]}),e==="epics"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Manage Projects (Epics)"}),s.jsxs("div",{className:`bg-gray-800/50 p-6 rounded-xl border ${ze?"border-indigo-500/50 shadow-lg shadow-indigo-500/10":"border-white/10"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:ze?"Edit Project":"Create New Project"}),ze&&s.jsx("button",{onClick:()=>le(null),className:"text-xs text-gray-400 hover:text-white underline",children:"Cancel Edit"})]}),s.jsxs("form",{onSubmit:ze?Be:ae,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),s.jsx("input",{type:"text",required:!0,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:ze?ze.title:Te.title,onChange:he=>ze?le({...ze,title:he.target.value}):Ye({...Te,title:he.target.value}),placeholder:"e.g. Q1 Mobile App"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),s.jsx("div",{className:"h-48",children:s.jsx(qj,{value:ze?ze.description:Te.description,onChange:he=>ze?le({...ze,description:he}):Ye({...Te,description:he}),placeholder:"Detailed epic goal...",type:"Epic",height:"h-40"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Status"}),s.jsxs("select",{className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:ze?ze.status:Te.status,onChange:he=>ze?le({...ze,status:he.target.value}):Ye({...Te,status:he.target.value}),children:[s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"planned",children:"Planned"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"complete_pending",children:"Complete - Pending Release"}),s.jsx("option",{value:"complete_scheduled",children:"Complete - Release Scheduled"}),s.jsx("option",{value:"complete_blocked",children:"Complete - Waiting on Epic"}),s.jsx("option",{value:"wont_fix",children:"Won't Fix"}),s.jsx("option",{value:"active",className:"text-gray-500",children:"Active (Legacy)"}),s.jsx("option",{value:"archived",className:"text-gray-500",children:"Archived (Legacy)"})]})]}),s.jsx("div",{className:"flex justify-end pt-4 gap-2",children:s.jsx("button",{type:"submit",className:`px-6 py-2 font-bold rounded-lg shadow-lg transition-all text-white ${ze?"bg-green-600 hover:bg-green-500":"bg-indigo-600 hover:bg-indigo-500"}`,children:ze?"Save Changes":"Create Epic"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:"Existing Projects"}),pe?s.jsx("div",{className:"text-gray-500",children:"Loading..."}):s.jsxs("div",{className:"space-y-2",children:[oe.map(he=>s.jsxs("div",{className:`bg-gray-800 p-4 rounded-xl border flex justify-between items-center group transition-all ${ze?.id===he.id?"border-indigo-500 ring-1 ring-indigo-500 bg-gray-800/80":"border-white/5 hover:border-white/10"}`,children:[s.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[s.jsx("h4",{className:"font-bold text-white truncate",children:he.title}),et(he.status)]}),s.jsx("div",{className:"text-sm text-gray-400 prose prose-invert prose-sm max-w-none line-clamp-1",dangerouslySetInnerHTML:{__html:he.description||""}})]}),s.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[s.jsxs("div",{className:"text-right hidden sm:block",children:[s.jsxs("span",{className:"text-xs text-gray-500 block",children:["ID: ",he.id]}),s.jsxs("span",{className:"text-xs text-indigo-400 block",children:[he.ticket_count||0," tickets"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{le(he),window.scrollTo({top:0,behavior:"smooth"})},className:"p-2 text-gray-400 hover:text-white bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Edit",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("button",{onClick:()=>Qe(he.id),className:"p-2 text-gray-400 hover:text-red-400 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Delete",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},he.id)),oe.length===0&&s.jsx("div",{className:"text-gray-500 italic",children:"No projects found."})]})]})]}),e==="release"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Release Notes Generator"}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-white/10 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Start Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:Ie.start,onChange:he=>Fe({...Ie,start:he.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"End Date"}),s.jsx("input",{type:"date",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500",value:Ie.end,onChange:he=>Fe({...Ie,end:he.target.value})})]}),s.jsx("button",{onClick:bt,disabled:He,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg transition-all disabled:opacity-50",children:He?"Fetching...":"Fetch Active Tickets"})]}),qe.length>0&&s.jsxs("div",{className:"space-y-4 pt-4 border-t border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-medium text-white italic",children:["Tickets Found (",qe.length,")"]}),s.jsxs("button",{onClick:Ve,disabled:nt,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white font-bold rounded-lg shadow-lg transition-all disabled:opacity-50",children:[" ",nt?"Generating...":"Generate AI Release Notes"]})]}),s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 pr-2",children:qe.map(he=>s.jsxs("div",{className:"bg-black/30 p-3 rounded-lg border border-white/5 flex gap-4 items-center",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded text-center ${he.type==="bug"?"bg-red-500/20 text-red-400":"bg-emerald-500/20 text-emerald-400"}`,children:he.type}),s.jsx("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded text-center ${he.status==="completed"?"bg-green-500/20 text-green-400":"bg-indigo-500/20 text-indigo-400"}`,children:he.status.replace("_"," ")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-white truncate",children:he.title}),s.jsxs("div",{className:"flex gap-2",children:[he.epic_title&&s.jsxs("p",{className:"text-[10px] text-gray-400",children:["Project: ",he.epic_title]}),he.type==="bug"&&he.created_by_username&&s.jsxs("p",{className:"text-[10px] text-indigo-400",children:["By: ",he.created_by_username]})]})]}),s.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:ps(new Date(he.updated_at),"MMM d")})]},he.id))})]}),Tt&&s.jsxs("div",{className:"space-y-4 pt-6 border-t border-indigo-500/30",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-medium text-indigo-400 font-black uppercase tracking-widest",children:"Release Notes Preview"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"text",placeholder:"v1.0.0",className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-1 text-white text-sm",value:it,onChange:he=>jt(he.target.value)}),s.jsx("button",{onClick:Je,disabled:mt,className:"px-4 py-1.5 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg text-sm shadow-lg disabled:opacity-50",children:" Publish Release"}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Tt),alert("Copied to clipboard!")},className:"text-xs text-indigo-400 hover:text-white transition-colors",children:"Copy HTML"})]})]}),s.jsx("div",{className:"bg-gray-900 border border-indigo-500/20 p-6 rounded-xl prose prose-invert max-w-none shadow-2xl",dangerouslySetInnerHTML:{__html:Tt}})]})]})]}),e==="referrals"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"External Invitations (Referrals)"}),s.jsx("button",{onClick:q,className:"text-xs text-indigo-400 hover:text-indigo-300 font-medium",children:"Refresh List"})]}),B?s.jsx("p",{className:"text-gray-400",children:"Loading invitations..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-700 text-gray-400 text-sm uppercase",children:[s.jsx("th",{className:"py-3 px-4",children:"Invitee Email"}),s.jsx("th",{className:"py-3 px-4",children:"Invited By"}),s.jsx("th",{className:"py-3 px-4",children:"Sent At"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Actions"})]})}),s.jsxs("tbody",{className:"text-sm divide-y divide-gray-800",children:[R.map(he=>s.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-white",children:he.invitee_email}),s.jsxs("td",{className:"py-3 px-4 text-gray-400",children:[s.jsx("div",{children:he.inviter_username}),s.jsx("div",{className:"text-[10px] text-gray-500",children:he.inviter_email})]}),s.jsx("td",{className:"py-3 px-4 text-gray-400",children:ps(new Date(he.created_at),"MMM dd, yyyy HH:mm")}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border ${he.status==="completed"?"bg-green-500/10 text-green-400 border-green-500/20":"bg-yellow-500/10 text-yellow-400 border-yellow-500/20"}`,children:he.status})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsx("button",{onClick:()=>K(he.id),className:"text-red-400 hover:text-red-300 transition-colors font-medium text-xs",children:"Reset"})})]},he.id)),R.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"py-8 text-center text-gray-500 italic",children:"No invitations found."})})]})]})})]})]})},qce=()=>{const{userProfile:t,currentUser:e,refreshUserProfile:r}=Mt();on();const[n,i]=y.useState(!1),[a,l]=y.useState(!1),[d,u]=y.useState("monthly"),{cards:h}=Gs(),{decks:p}=Pd(),m=t?.override_tier||t?.subscription_tier||tt.FREE,x=Yt(m),b=t?.subscription_status||(m!==tt.FREE?"active":"free"),v=t?.subscription_end_date?new Date(t.subscription_end_date).toLocaleDateString():null,w=y.useMemo(()=>{if(!h||!p)return{decks:0,collection:0,wishlist:0};const I=h.filter(R=>!R.is_wishlist),O=h.filter(R=>R.is_wishlist);let M=I.reduce((R,$)=>R+($.count||1),0),E=O.reduce((R,$)=>R+($.count||1),0);return{decks:p.length,collection:M,wishlist:E}},[h,p]),k=async()=>{i(!0);try{const I=await Pe.post("/api/payments/create-portal-session",{});I.url?window.location.href=I.url:alert("Failed to redirect to billing portal.")}catch(I){console.error("Billing portal error:",I),alert("Could not open billing portal. "+(I.response?.data?.error||I.message))}finally{i(!1)}},_=async I=>{i(!0);try{const O=await Pe.post("/api/payments/create-checkout-session",{tierId:I,interval:d,successUrl:`${window.location.origin}/settings?success=true`,cancelUrl:`${window.location.origin}/settings?canceled=true`});if(O.url)window.location.href=O.url;else throw new Error("No checkout URL returned")}catch(O){console.error("Subscription error:",O),alert(O.message||"Failed to start subscription process"),i(!1)}},T=I=>{switch(I){case tt.FREE:return s.jsx(fA,{className:"w-12 h-12 text-gray-400"});case tt.TIER_1:return s.jsx(YX,{className:"w-12 h-12 text-blue-400"});case tt.TIER_2:return s.jsx(xj,{className:"w-12 h-12 text-purple-400"});case tt.TIER_3:return s.jsx(q1,{className:"w-12 h-12 text-yellow-400"});case tt.TIER_4:return s.jsx(q1,{className:"w-12 h-12 text-orange-500"});case tt.TIER_5:return s.jsx(q1,{className:"w-12 h-12 text-red-500"});default:return s.jsx(fA,{className:"w-12 h-12 text-gray-400"})}},A=(I,O,M,E)=>{const R=M===1/0?0:Math.min(O/M*100,100),$=M!==1/0&&O/M>=.9;let B="bg-green-500";return M===1/0?B="bg-blue-500":R>=90?B="bg-red-500":R>=75&&(B="bg-yellow-500"),s.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-gray-300 text-sm font-medium flex items-center gap-2",children:[s.jsx("span",{children:E})," ",I]}),s.jsxs("span",{className:`font-bold text-sm ${$?"text-red-400":"text-white"}`,children:[O," / ",M===1/0?"":M]})]}),s.jsx("div",{className:"h-2 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/50",children:s.jsx("div",{className:`h-full ${B} transition-all duration-1000 ease-out`,style:{width:M===1/0?"100%":`${R}%`}})}),$&&s.jsx("p",{className:"text-[10px] text-red-400 mt-1 mt-2",children:"Running low on space!"})]})};return s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Membership & Billing"}),s.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between relative z-10 gap-6",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"p-3 bg-gray-800 rounded-lg border border-gray-700 shrink-0",children:T(m)}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:x.name}),s.jsx("p",{className:"text-gray-400 text-sm max-w-md",children:x.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border ${b==="active"?"bg-green-500/10 text-green-400 border-green-500/20":b==="canceled"?"bg-yellow-500/10 text-yellow-400 border-yellow-500/20":b==="past_due"?"bg-red-500/10 text-red-400 border-red-500/20":"bg-gray-700 text-gray-300 border-gray-600"}`,children:b==="free"?"Free Plan":b.replace("_"," ")}),t?.override_tier&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wide border bg-purple-500/10 text-purple-400 border-purple-500/20",children:"Admin Override"}),v&&b!=="free"&&!t?.override_tier&&s.jsxs("span",{className:"text-xs text-gray-500",children:[b==="canceled"?"Expires":"Renews"," on ",v]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:[s.jsx("button",{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-purple-900/20 transition-all hover:scale-105 whitespace-nowrap",children:m===tt.FREE?"Upgrade Plan":"Change Plan"}),m!==tt.FREE&&s.jsxs("button",{onClick:k,disabled:n,className:"flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium border border-gray-600 transition-colors text-sm",children:[s.jsx(MX,{className:"w-4 h-4"}),n?"Loading...":"Manage Billing"]})]})]}),s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-b from-purple-500/10 to-transparent rounded-bl-full pointer-events-none"})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:""})," Usage & Limits"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[A("Decks",w.decks,x.limits.decks,""),A("Collection",w.collection,x.limits.collection,""),A("Wishlist",w.wishlist,x.limits.wishlist,"")]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 text-right",children:"* Limits apply to active items. Archived/Deleted items do not count."})]}),a&&ln.createPortal(s.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center p-4 pt-24 text-left font-sans",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>l(!1)}),s.jsxs("div",{className:"relative bg-gray-900 border border-gray-700 rounded-2xl w-full max-w-[95vw] max-h-[85vh] overflow-y-auto shadow-2xl animate-scale-in",children:[s.jsxs("div",{className:"sticky top-0 z-20 flex justify-between items-center p-6 bg-gray-900/95 backdrop-blur border-b border-gray-800",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select a Plan"}),s.jsx("button",{onClick:()=>l(!1),className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:s.jsx(Yf,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"p-6 md:p-8",children:s.jsx(n5,{billingInterval:d,setBillingInterval:u,onSubscribe:_,isLoading:n,currentTier:m})})]})]}),document.body)]})},Fce=()=>{const{user:t,userProfile:e,refreshUserProfile:r,resetPassword:n,sendVerification:i,updateProfileFields:a}=Mt(),{tab:l}=ol(),d=on(),u=l||"account",[h,p]=y.useState(!1),[m,x]=y.useState(!1),[b,v]=y.useState(!1),[w,k]=y.useState(!1),[_,T]=y.useState(!1),[A,I]=y.useState(!1),[O,M]=y.useState(null),[E,R]=y.useState(!1),[$,B]=y.useState(""),[C,U]=y.useState("grid"),[L,q]=y.useState("md"),[K,W]=y.useState(""),[V,X]=y.useState(""),[Z,G]=y.useState(""),[F,Y]=y.useState(!1),[ne,re]=y.useState(!1),[ue,Le]=n4();y.useEffect(()=>{e?.settings&&(e.settings.geminiApiKey&&B(e.settings.geminiApiKey),e.settings.viewMode&&U(e.settings.viewMode),e.settings.gridSize&&q(e.settings.gridSize)),e&&(W(e.username||""),X(e.first_name||""),G(e.last_name||"")),ue.get("success")==="true"&&(async()=>{try{await Pe.post("/api/payments/sync-subscription"),await r(),Le({}),alert("Subscription updated successfully!")}catch(Te){console.error("Sync failed",Te)}})()},[e,ue,Le,r]);const de=async()=>{if(!e?.id){alert("User profile not ready. Please try again.");return}x(!0);try{const Ee={...e?.settings||{},geminiApiKey:$,viewMode:C,gridSize:L};await Pe.updateUser(e.id,{settings:Ee}),await r(),alert("Settings saved!")}catch(oe){console.error("Failed to save settings:",oe),alert("Error saving settings: "+(oe.message||"Unknown error"))}finally{x(!1)}},ve=async()=>{x(!0);try{await a({username:K,first_name:V,last_name:Z}),alert("Profile updated successfully!")}catch(oe){console.error("Failed to update profile:",oe),alert("Error updating profile: "+(oe.message||"Unknown error"))}finally{x(!1)}},te=async()=>{if(t?.email){Y(!0);try{await n(t.email),alert("Password reset email sent!")}catch(oe){alert("Error: "+oe.message)}finally{Y(!1)}}},ge=async()=>{re(!0);try{await i(),alert("Verification email sent!")}catch(oe){alert("Error: "+oe.message)}finally{re(!1)}},ke=async()=>{try{const oe=await Pe.get("/api/collection/export");let Ee=[],Te=[];if(Array.isArray(oe)?Ee=oe:oe&&typeof oe=="object"&&(Ee=oe.cards||[],Te=oe.decks||[]),Ee.length===0&&Te.length===0){alert("No data to export.");return}const Ye=JSON.stringify({cards:Ee,decks:Te,exported_at:new Date},null,2),ze=new Blob([Ye],{type:"application/json"}),le=URL.createObjectURL(ze),pe=document.createElement("a");pe.href=le,pe.download=`mtg_library_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(pe),pe.click(),document.body.removeChild(pe)}catch(oe){console.error("Export failed:",oe),alert("Failed to export library.")}};return t?s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Settings"}),s.jsx("div",{className:"flex border-b border-gray-700 overflow-x-auto",children:["account","membership","general","community","ai","display","data",...t?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||e?.settings?.isAdmin?["admin"]:[]].map(oe=>s.jsx("button",{onClick:()=>d(`/settings/${oe}`),className:`px-6 py-3 font-medium transition-colors border-b-2 whitespace-nowrap ${u===oe?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:oe.charAt(0).toUpperCase()+oe.slice(1)},oe))}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg min-h-[400px]",children:[u==="account"&&s.jsxs("div",{className:"space-y-8 animate-fade-in",children:[s.jsxs("section",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Profile Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"First Name"}),s.jsx("input",{type:"text",value:V,onChange:oe=>X(oe.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Last Name"}),s.jsx("input",{type:"text",value:Z,onChange:oe=>G(oe.target.value),className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-sm text-gray-400 block",children:"Username"}),s.jsx("input",{type:"text",value:K,onChange:oe=>W(oe.target.value),placeholder:"Enter username...",className:"w-full bg-gray-900 border border-gray-700 p-2.5 rounded-lg text-gray-200 focus:ring-2 focus:ring-indigo-500 outline-none"})]}),s.jsx("div",{className:"flex justify-start",children:s.jsx("button",{onClick:ve,disabled:m,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50",children:"Update Profile"})})]}),s.jsxs("section",{className:"pt-6 border-t border-gray-700 space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Security & Account"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Email Address"}),s.jsx("p",{className:"text-sm text-gray-400",children:t.email}),!t.emailVerified&&s.jsx("span",{className:"text-[10px] bg-yellow-500/20 text-yellow-500 px-1.5 py-0.5 rounded-full border border-yellow-500/30 mt-1 inline-block",children:"Unverified"}),t.emailVerified&&s.jsx("span",{className:"text-[10px] bg-green-500/20 text-green-500 px-1.5 py-0.5 rounded-full border border-green-500/30 mt-1 inline-block",children:"Verified"})]}),!t.emailVerified&&s.jsx("button",{onClick:ge,disabled:ne,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium",children:ne?"Sending...":"Send Verification"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-200",children:"Password"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Change your account password"})]}),s.jsx("button",{onClick:te,disabled:F,className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors font-medium disabled:opacity-50",children:F?"Sending...":"Reset Password"})]})]})]})]}),u==="general"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"App Preferences"}),s.jsxs("div",{className:"pt-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Guided Experience"}),s.jsx("button",{onClick:async()=>{window.confirm("This will restart the welcome tour. Continue?")&&(await Pe.updateUser(e.id,{settings:{...e.settings,onboarding_complete:!1,onboarding_step:0}}),await r(),d("/onboarding"))},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg border border-gray-600 transition-colors text-sm font-medium",children:"Reset Onboarding Tour"})]})]}),u==="ai"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Integrations"}),s.jsx("span",{className:"bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded border border-indigo-700/50",children:"Gemini"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-400 text-sm",children:"To enable the AI Assistant and Deck Suggestions, you need a Google Gemini API Key. Keys are stored securely in your user profile."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Gemini API Key"}),s.jsx("input",{type:"password",value:$,onChange:oe=>B(oe.target.value),placeholder:"Enter AI Key...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"}),s.jsxs("div",{className:"text-xs text-gray-500 flex justify-between",children:[s.jsx("span",{children:"Never share your API key."}),s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 hover:underline",children:"Get a key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Personalization"}),s.jsx("div",{className:"flex flex-wrap gap-4",children:s.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-3 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-5 py-3 rounded-xl transition-all hover:shadow-lg hover:border-emerald-500 group",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center text-xl group-hover:scale-110 transition-transform",children:""}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold text-sm",children:"Helper Settings"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Customize your AI companion"})]})]})})]})]}),u==="display"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Display Preferences"}),s.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-xl p-4 md:p-6 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Organization Profile"}),s.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Current Mode: ",s.jsx("span",{className:"text-indigo-400 font-bold capitalize",children:e?.settings?.organization?.mode||"Default"})]}),s.jsx("p",{className:"text-xs text-gray-500 max-w-lg mb-4",children:"Your organization profile determines how your collection is sorted and grouped by default."})]}),s.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-lg text-indigo-400",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})})]}),s.jsx("button",{onClick:()=>T(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors",children:"Configure Organization..."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Default View "}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${C==="grid"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"grid",checked:C==="grid",onChange:()=>U("grid"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Grid View"})]}),s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${C==="table"?"bg-indigo-600/20 border-indigo-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("input",{type:"radio",name:"viewMode",value:"table",checked:C==="table",onChange:()=>U("table"),className:"text-indigo-500 focus:ring-indigo-500"}),s.jsx("span",{className:"text-gray-200",children:"Table View"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Grid Size"}),s.jsxs("select",{value:L,onChange:oe=>q(oe.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 w-full sm:w-48",children:[s.jsx("option",{value:"sm",children:"Small"}),s.jsx("option",{value:"md",children:"Medium"}),s.jsx("option",{value:"lg",children:"Large"})]})]})]})]}),u==="community"&&s.jsx(Bce,{}),u==="data"&&s.jsxs("div",{className:"space-y-6 animate-fade-in",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Data Management"}),s.jsxs("details",{className:"group border border-red-500/20 rounded-xl bg-red-500/5 open:bg-red-500/10 transition-colors",children:[s.jsxs("summary",{className:"flex items-center justify-between p-4 cursor-pointer select-none",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-red-500",children:""}),s.jsx("h3",{className:"text-lg font-bold text-red-500 uppercase tracking-wide",children:"Danger Zone"})]}),s.jsx("div",{className:"text-red-500 transform transition-transform group-open:rotate-180",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),s.jsx("div",{className:"p-4 pt-0 border-t border-red-500/10 mt-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Clear Wishlist"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Permanently delete all items from your wishlist."})]}),s.jsx("button",{onClick:()=>{M("wishlist"),I(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Clear Wishlist"})]}),s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete All Decks"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Delete all your decks. Cards will remain in your collection."})]}),s.jsx("button",{onClick:()=>{M("decks"),I(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Decks"})]}),s.jsxs("div",{className:"p-4 border-b border-red-500/10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete Collection"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Delete all cards. This will empty your decks."})]}),s.jsx("button",{onClick:()=>{M("collection"),I(!0)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg text-sm font-bold transition-colors",children:"Delete Collection"})]}),s.jsxs("div",{className:"p-4 bg-red-900/20 rounded-lg flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white",children:"Delete Everything"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Wipe your entire library: decks, cards, and wishlist."})]}),s.jsx("button",{onClick:()=>{M("all"),I(!0)},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-bold transition-colors shadow-lg shadow-red-900/20",children:"Delete Everything"})]})]})})]}),s.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/50 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"text-yellow-500 font-bold mb-1 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Important Note"]}),s.jsx("p",{className:"text-yellow-200/80 text-sm",children:"Backups include your collection data. Deck exports can be done from individual deck pages."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Export Collection"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Download a JSON backup of your entire card collection."})]}),s.jsx("button",{onClick:ke,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Export JSON"})]}),s.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 flex items-center justify-between hover:bg-gray-700/30 transition-colors",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-medium",children:"Import Data"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Restore from a backup or import cards. Supports Merge and Replace."})]}),s.jsx("button",{onClick:()=>v(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors border border-gray-600",children:"Import..."})]})]})]}),u==="membership"&&s.jsx(qce,{}),u==="admin"&&(t?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||e?.settings?.isAdmin)&&s.jsx(zce,{})]}),s.jsx(ale,{isOpen:b,onClose:()=>v(!1),mode:"global"}),s.jsx(ole,{isOpen:w,onClose:()=>k(!1)}),s.jsx(L9,{isOpen:_,onClose:()=>T(!1),onComplete:()=>{T(!1),r()}}),s.jsx(lle,{isOpen:A,onClose:()=>I(!1),targetName:O?O.toUpperCase():"",title:O==="all"?"Delete Everything?":O==="decks"?"Delete All Decks?":O==="collection"?"Delete Collection?":"Clear Wishlist?",message:O==="all"?"This will permanently delete ALL data associated with your account, including decks, cards, and wishlist. This cannot be undone.":O==="decks"?"This will delete all your deck lists. Your cards will be returned to your binder.":O==="collection"?"This will delete all cards in your collection. Your decks will remain but will be empty.":"This will remove all cards from your wishlist.",onConfirm:async()=>{R(!0);try{await Pe.delete("/api/users/me/data",{target:O}),window.location.reload()}catch(oe){console.error(oe),alert("Failed to delete data.")}finally{R(!1),I(!1)}}}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:de,disabled:m,className:`bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-lg shadow-lg shadow-indigo-500/20 transition-all transform hover:-translate-y-0.5 ${m?"opacity-50 cursor-not-allowed":""}`,children:m?"Saving...":"Save Settings"})})]}):s.jsx("div",{className:"p-8 text-center text-gray-500",children:"Please log in to view settings."})},Hce=()=>{const{cards:t,loading:e,error:r}=Gs({wishlist:!0}),{currentUser:n}=Mt(),{addToast:i}=_r(),[a,l]=y.useState(""),[d,u]=y.useState(!1),[h,p]=y.useState(!1),[m,x]=y.useState(new Set),b=O=>{const M=new Set(m);M.has(O)?M.delete(O):M.add(O),x(M)},v=O=>{m.size===O.length?x(new Set):x(new Set(O.map(M=>M.id)))},w=async()=>{if(m.size===0)return;const O=m.size;if(window.confirm(`Are you sure you want to delete ${O} cards from your wishlist?`))try{await Un.batchRemoveCards(Array.from(m)),i(`Successfully removed ${O} cards`,"success"),p(!1),x(new Set),window.location.reload()}catch(M){console.error(M),i("Failed to remove cards","error")}},[k,_]=y.useState({colors:[],rarity:[],types:[],sets:[]}),T=y.useMemo(()=>{const O=new Set;return t.forEach(M=>{M.set&&M.set_name&&O.add(JSON.stringify({value:M.set,label:M.set_name}))}),Array.from(O).map(M=>JSON.parse(M)).sort((M,E)=>M.label.localeCompare(E.label))},[t]),A=y.useMemo(()=>t.filter(O=>{const M=O.name||"";if(a&&!M.toLowerCase().includes(a.toLowerCase()))return!1;if(k.colors.length>0){const E=O.color_identity||[],R=E.length>1,$=E.length===0;if(!k.colors.some(C=>C==="C"?$:C==="M"?R:E.includes(C)))return!1}if(k.rarity.length>0&&!k.rarity.includes(O.rarity))return!1;if(k.types.length>0){const E=(O.type_line||"").toLowerCase();if(!k.types.some($=>E.includes($.toLowerCase())))return!1}return!(k.sets.length>0&&!k.sets.includes(O.set))}),[t,a,k]),I=(O,M)=>{_(E=>{const R=E[O],$=R.includes(M)?R.filter(B=>B!==M):[...R,M];return{...E,[O]:$}})};return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"p-2 bg-orange-500/10 rounded-xl",children:s.jsx("svg",{className:"w-8 h-8 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),"Wishlist"]}),s.jsx("p",{className:"text-gray-400 mt-1 text-sm",children:"Manage cards you want to acquire"})]}),s.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[s.jsxs("div",{className:"relative w-full md:w-80",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 border border-gray-700 rounded-md leading-5 bg-gray-800 text-gray-300 placeholder-gray-500 focus:outline-none focus:bg-gray-700 focus:border-orange-500 transition duration-150 ease-in-out sm:text-sm",placeholder:"Search wishlist...",value:a,onChange:O=>l(O.target.value)}),a&&s.jsx("button",{onClick:()=>l(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[h?s.jsxs("div",{className:"flex items-center gap-2 bg-gray-900/50 p-1 rounded-lg border border-gray-700 animate-fade-in mr-2",children:[s.jsx("button",{onClick:()=>v(A),className:"px-2 py-1 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-xs px-2 mr-2 border border-gray-600",children:m.size===A.length?"Deselect All":"Select All"}),s.jsxs("span",{className:"text-xs text-indigo-300 font-bold ml-2 whitespace-nowrap",children:[m.size," Selected"]}),s.jsx("button",{onClick:w,disabled:m.size===0,className:"px-3 py-1 bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500/30 rounded text-xs font-bold uppercase transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"}),s.jsx("button",{onClick:()=>p(!1),className:"p-1 px-2 text-gray-400 hover:text-white text-xs",children:"Cancel"})]}):s.jsx("button",{onClick:()=>p(!0),className:"px-3 py-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-indigo-400 border border-gray-700 rounded-md transition-colors text-sm font-bold uppercase",children:"Select"}),s.jsxs("button",{onClick:()=>u(!d),className:`px-3 py-2 rounded-md border transition-colors flex items-center gap-2 ${d?"bg-orange-600 border-orange-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:text-white"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]})]})]}),d&&s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-8 border border-gray-700 gap-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 animate-fade-in-down",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Colors"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["W","U","B","R","G","C","M"].map(O=>s.jsx("button",{onClick:()=>I("colors",O),className:`
                                        w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border shadow-sm transition-transform hover:scale-105
                                        ${k.colors.includes(O)?"ring-2 ring-orange-500 ring-offset-2 ring-offset-gray-800":"opacity-70 hover:opacity-100"}
                                        ${O==="W"?"bg-[#F9FAFB] text-gray-900 border-gray-300":""}
                                        ${O==="U"?"bg-[#3B82F6] text-white border-blue-600":""}
                                        ${O==="B"?"bg-[#1F2937] text-white border-gray-900":""}
                                        ${O==="R"?"bg-[#EF4444] text-white border-red-600":""}
                                        ${O==="G"?"bg-[#10B981] text-white border-green-600":""}
                                        ${O==="C"?"bg-gray-400 text-gray-900 border-gray-500":""}
                                        ${O==="M"?"bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 text-white border-purple-500":""}
                                    `,children:O},O))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Rarity"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["common","uncommon","rare","mythic"].map(O=>s.jsx("button",{onClick:()=>I("rarity",O),className:`
                                        px-3 py-1 rounded text-xs font-bold uppercase border transition-colors
                                        ${k.rarity.includes(O)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                    `,children:O},O))})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Types"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Creature","Instant","Sorcery","Enchantment","Artifact","Planeswalker","Land"].map(O=>s.jsx("button",{onClick:()=>I("types",O),className:`
                                         px-2 py-1 rounded text-xs border transition-colors
                                         ${k.types.includes(O)?"bg-orange-600 border-orange-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}
                                     `,children:O},O))})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(_g,{label:"Filter by Set",options:T,selected:k.sets,onChange:O=>_(M=>({...M,sets:O})),placeholder:"All Sets"})})]}),e?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:Array.from({length:12}).map((O,M)=>s.jsx(M9,{},M))}):r?s.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-4 rounded-lg",children:["Error loading wishlist: ",r.message]}):s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:[A.map(O=>s.jsx("div",{className:"h-full",children:s.jsx(Yu,{card:O,selectMode:h,isSelected:m.has(O.id),onToggleSelect:b})},O.id)),A.length===0&&s.jsxs("div",{className:"col-span-full text-center text-gray-500 py-12 flex flex-col items-center",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("p",{className:"text-xl",children:"Your wishlist is empty"}),s.jsx("p",{className:"text-sm mt-2 font-medium",children:"Add cards to your wishlist from the search modal!"})]})]})]})},_w=()=>{const t=on(),{type:e,set:r}=ol(),{addToast:n}=_r(),[i,a]=y.useState([]),[l,d]=y.useState([]),[u,h]=y.useState([]),[p,m]=y.useState("types"),[x,b]=y.useState(!0),[v,w]=y.useState(""),[k,_]=y.useState("");y.useEffect(()=>{const E=setTimeout(()=>_(v),500);return()=>clearTimeout(E)},[v]),y.useEffect(()=>{(async()=>(i.length===0&&await T(),l.length===0&&await A()))()},[]),y.useEffect(()=>{(async()=>{b(!0);try{k?await I({search:k}):e?await I({type:e}):r?await I({set_code:r}):h([])}finally{b(!1)}})()},[k,e,r]);const T=async()=>{try{const E=await Pe.get("/api/precons/types");a(E)}catch(E){console.error(E),n("Failed to load types","error")}},A=async()=>{try{const E=await Pe.get("/api/precons/sets");d(E)}catch(E){console.error(E)}},I=async E=>{try{const R=new URLSearchParams(E).toString(),$=await Pe.get(`/api/precons?${R}`);h($)}catch(R){console.error(R),n("Failed to load precons","error")}},O=E=>{const R=["from-purple-500/20 to-blue-500/5 hover:border-purple-500","from-emerald-500/20 to-teal-500/5 hover:border-emerald-500","from-amber-500/20 to-orange-500/5 hover:border-amber-500","from-rose-500/20 to-red-500/5 hover:border-rose-500","from-cyan-500/20 to-blue-500/5 hover:border-cyan-500"];let $=0;for(let C=0;C<E.length;C++)$=E.charCodeAt(C)+(($<<5)-$);const B=Math.abs($)%R.length;return R[B]},M=!!(e||r||k);return s.jsx("div",{className:"min-h-screen bg-gray-950 p-6 md:p-8 pt-24",children:s.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 border-b border-gray-800 pb-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:["Precon ",s.jsx("span",{className:"text-purple-500",children:"Database"})]}),s.jsx("p",{className:"text-gray-400",children:M?s.jsxs(s.Fragment,{children:[s.jsx(_t,{to:"/precons",onClick:()=>{w("")},className:"hover:text-white transition-colors underline decoration-dotted",children:"Database"})," > ",s.jsx("span",{className:"text-white font-bold",children:k?`Search: "${k}"`:e||r})]}):"Browse official preconstructed decks."})]}),s.jsxs("div",{className:"flex gap-4",children:[!M&&s.jsxs("div",{className:"bg-gray-900 rounded-lg p-1 border border-gray-700 flex text-sm font-bold",children:[s.jsx("button",{onClick:()=>m("types"),className:`px-4 py-2 rounded-md transition-colors ${p==="types"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Types"}),s.jsx("button",{onClick:()=>m("sets"),className:`px-4 py-2 rounded-md transition-colors ${p==="sets"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:"Sets"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search decks or commanders...",value:v,onChange:E=>w(E.target.value),className:"bg-gray-900 border border-gray-700 text-white px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none w-64 md:w-80 pl-10 pr-10"}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),v&&s.jsx("button",{onClick:()=>w(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors p-1",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),x?s.jsx("div",{className:"flex justify-center py-20",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):M?u.length===0?s.jsx("div",{className:"text-center py-20 text-gray-500",children:"No precons found."}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:u.map(E=>s.jsxs(_t,{to:`/precons/deck/${E.id}`,className:"bg-gray-900 border border-gray-800 rounded-2xl overflow-hidden hover:border-purple-500/50 transition-all hover:shadow-xl group flex flex-col cursor-pointer hover:-translate-y-1",children:[s.jsxs("div",{className:"p-6 flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-purple-400 transition-colors line-clamp-2",children:E.name}),s.jsx("span",{className:"text-xs font-bold bg-gray-800 text-gray-400 px-2 py-1 rounded uppercase tracking-wider",children:E.data?.code||"???"})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Commander"}),s.jsx("span",{className:"text-gray-200 font-medium truncate ml-2 max-w-[150px] text-right",children:E.data?.commander?.[0]?.name||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Cards"}),s.jsx("span",{className:"text-gray-200",children:(E.data?.mainBoard?.length||0)+(E.data?.sideBoard?.length||0)+(E.data?.commander?.length||0)})]}),E.total_price>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Market Price"}),s.jsxs("span",{className:"text-green-400 font-bold",children:["$",E.total_price.toFixed(2)]})]})]})]}),s.jsx("div",{className:"bg-gray-800/50 p-4 border-t border-gray-800 flex justify-center text-purple-400 font-bold text-sm group-hover:bg-purple-900/20 transition-colors",children:"View Deck List"})]},E.id))}):p==="types"?s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:i.map(E=>s.jsx("div",{onClick:()=>t(`/precons/type/${encodeURIComponent(E)}`),className:`group cursor-pointer bg-gray-900 border border-gray-800 rounded-2xl p-8 transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${O(E)}`,children:s.jsx("h3",{className:"text-xl font-bold text-white text-center group-hover:scale-105 transition-transform",children:E})},E))}):s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:l.map(E=>s.jsxs("div",{onClick:()=>t(`/precons/set/${E}`),className:"group cursor-pointer bg-gray-900 border border-gray-800 rounded-xl p-6 transition-all hover:-translate-y-1 hover:border-purple-500 flex flex-col items-center justify-center gap-2",children:[s.jsx("span",{className:"text-2xl font-black text-gray-700 group-hover:text-white transition-colors uppercase",children:E}),s.jsx("span",{className:"text-xs text-purple-400 font-bold",children:"Set Code"})]},E))})]})})};var Wce=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function p5(t){if(typeof t!="string")return!1;var e=Wce;return e.includes(t)}var Gce=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Vce=new Set(Gce);function c7(t){return typeof t!="string"?!1:Vce.has(t)}function d7(t){return typeof t=="string"&&t.startsWith("data-")}function eo(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(c7(r)||d7(r))&&(e[r]=t[r]);return e}function a0(t){if(t==null)return null;if(y.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return eo(e)}return typeof t=="object"&&!Array.isArray(t)?eo(t):null}function Ki(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(c7(r)||d7(r)||p5(r))&&(e[r]=t[r]);return e}var Kce=["children","width","height","viewBox","className","style","title","desc"];function Qj(){return Qj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qj.apply(null,arguments)}function Yce(t,e){if(t==null)return{};var r,n,i=Xce(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Xce(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var m5=y.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:l,style:d,title:u,desc:h}=t,p=Yce(t,Kce),m=a||{width:n,height:i,x:0,y:0},x=gr("recharts-surface",l);return y.createElement("svg",Qj({},Ki(p),{className:x,width:n,height:i,style:d,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:e}),y.createElement("title",null,u),y.createElement("desc",null,h),r)}),Jce=["children","className"];function Zj(){return Zj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zj.apply(null,arguments)}function Qce(t,e){if(t==null)return{};var r,n,i=Zce(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Zce(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Ts=y.forwardRef((t,e)=>{var{children:r,className:n}=t,i=Qce(t,Jce),a=gr("recharts-layer",n);return y.createElement("g",Zj({className:a},Ki(i),{ref:e}),r)}),u7=y.createContext(null),ede=()=>y.useContext(u7);function Ar(t){return function(){return t}}const h7=Math.cos,rx=Math.sin,Ta=Math.sqrt,nx=Math.PI,xy=2*nx,eN=Math.PI,tN=2*eN,Gc=1e-6,tde=tN-Gc;function f7(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function rde(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return f7;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class nde{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?f7:rde(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,l){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+l}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let l=this._x1,d=this._y1,u=n-e,h=i-r,p=l-e,m=d-r,x=p*p+m*m;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(x>Gc)if(!(Math.abs(m*u-h*p)>Gc)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let b=n-l,v=i-d,w=u*u+h*h,k=b*b+v*v,_=Math.sqrt(w),T=Math.sqrt(x),A=a*Math.tan((eN-Math.acos((w+x-k)/(2*_*T)))/2),I=A/T,O=A/_;Math.abs(I-1)>Gc&&this._append`L${e+I*p},${r+I*m}`,this._append`A${a},${a},0,0,${+(m*b>p*v)},${this._x1=e+O*u},${this._y1=r+O*h}`}}arc(e,r,n,i,a,l){if(e=+e,r=+r,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let d=n*Math.cos(i),u=n*Math.sin(i),h=e+d,p=r+u,m=1^l,x=l?i-a:a-i;this._x1===null?this._append`M${h},${p}`:(Math.abs(this._x1-h)>Gc||Math.abs(this._y1-p)>Gc)&&this._append`L${h},${p}`,n&&(x<0&&(x=x%tN+tN),x>tde?this._append`A${n},${n},0,1,${m},${e-d},${r-u}A${n},${n},0,1,${m},${this._x1=h},${this._y1=p}`:x>Gc&&this._append`A${n},${n},0,${+(x>=eN)},${m},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function g5(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new nde(e)}function x5(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function p7(t){this._context=t}p7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function yy(t){return new p7(t)}function m7(t){return t[0]}function g7(t){return t[1]}function x7(t,e){var r=Ar(!0),n=null,i=yy,a=null,l=g5(d);t=typeof t=="function"?t:t===void 0?m7:Ar(t),e=typeof e=="function"?e:e===void 0?g7:Ar(e);function d(u){var h,p=(u=x5(u)).length,m,x=!1,b;for(n==null&&(a=i(b=l())),h=0;h<=p;++h)!(h<p&&r(m=u[h],h,u))===x&&((x=!x)?a.lineStart():a.lineEnd()),x&&a.point(+t(m,h,u),+e(m,h,u));if(b)return a=null,b+""||null}return d.x=function(u){return arguments.length?(t=typeof u=="function"?u:Ar(+u),d):t},d.y=function(u){return arguments.length?(e=typeof u=="function"?u:Ar(+u),d):e},d.defined=function(u){return arguments.length?(r=typeof u=="function"?u:Ar(!!u),d):r},d.curve=function(u){return arguments.length?(i=u,n!=null&&(a=i(n)),d):i},d.context=function(u){return arguments.length?(u==null?n=a=null:a=i(n=u),d):n},d}function Ym(t,e,r){var n=null,i=Ar(!0),a=null,l=yy,d=null,u=g5(h);t=typeof t=="function"?t:t===void 0?m7:Ar(+t),e=typeof e=="function"?e:Ar(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?g7:Ar(+r);function h(m){var x,b,v,w=(m=x5(m)).length,k,_=!1,T,A=new Array(w),I=new Array(w);for(a==null&&(d=l(T=u())),x=0;x<=w;++x){if(!(x<w&&i(k=m[x],x,m))===_)if(_=!_)b=x,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),v=x-1;v>=b;--v)d.point(A[v],I[v]);d.lineEnd(),d.areaEnd()}_&&(A[x]=+t(k,x,m),I[x]=+e(k,x,m),d.point(n?+n(k,x,m):A[x],r?+r(k,x,m):I[x]))}if(T)return d=null,T+""||null}function p(){return x7().defined(i).curve(l).context(a)}return h.x=function(m){return arguments.length?(t=typeof m=="function"?m:Ar(+m),n=null,h):t},h.x0=function(m){return arguments.length?(t=typeof m=="function"?m:Ar(+m),h):t},h.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Ar(+m),h):n},h.y=function(m){return arguments.length?(e=typeof m=="function"?m:Ar(+m),r=null,h):e},h.y0=function(m){return arguments.length?(e=typeof m=="function"?m:Ar(+m),h):e},h.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Ar(+m),h):r},h.lineX0=h.lineY0=function(){return p().x(t).y(e)},h.lineY1=function(){return p().x(t).y(r)},h.lineX1=function(){return p().x(n).y(e)},h.defined=function(m){return arguments.length?(i=typeof m=="function"?m:Ar(!!m),h):i},h.curve=function(m){return arguments.length?(l=m,a!=null&&(d=l(a)),h):l},h.context=function(m){return arguments.length?(m==null?a=d=null:d=l(a=m),h):a},h}class y7{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function sde(t){return new y7(t,!0)}function ide(t){return new y7(t,!1)}const y5={draw(t,e){const r=Ta(e/nx);t.moveTo(r,0),t.arc(0,0,r,0,xy)}},ade={draw(t,e){const r=Ta(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},b7=Ta(1/3),ode=b7*2,lde={draw(t,e){const r=Ta(e/ode),n=r*b7;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},cde={draw(t,e){const r=Ta(e),n=-r/2;t.rect(n,n,r,r)}},dde=.8908130915292852,v7=rx(nx/10)/rx(7*nx/10),ude=rx(xy/10)*v7,hde=-h7(xy/10)*v7,fde={draw(t,e){const r=Ta(e*dde),n=ude*r,i=hde*r;t.moveTo(0,-r),t.lineTo(n,i);for(let a=1;a<5;++a){const l=xy*a/5,d=h7(l),u=rx(l);t.lineTo(u*r,-d*r),t.lineTo(d*n-u*i,u*n+d*i)}t.closePath()}},Cw=Ta(3),pde={draw(t,e){const r=-Ta(e/(Cw*3));t.moveTo(0,r*2),t.lineTo(-Cw*r,-r),t.lineTo(Cw*r,-r),t.closePath()}},Ii=-.5,Di=Ta(3)/2,rN=1/Ta(12),mde=(rN/2+1)*3,gde={draw(t,e){const r=Ta(e/mde),n=r/2,i=r*rN,a=n,l=r*rN+r,d=-a,u=l;t.moveTo(n,i),t.lineTo(a,l),t.lineTo(d,u),t.lineTo(Ii*n-Di*i,Di*n+Ii*i),t.lineTo(Ii*a-Di*l,Di*a+Ii*l),t.lineTo(Ii*d-Di*u,Di*d+Ii*u),t.lineTo(Ii*n+Di*i,Ii*i-Di*n),t.lineTo(Ii*a+Di*l,Ii*l-Di*a),t.lineTo(Ii*d+Di*u,Ii*u-Di*d),t.closePath()}};function xde(t,e){let r=null,n=g5(i);t=typeof t=="function"?t:Ar(t||y5),e=typeof e=="function"?e:Ar(e===void 0?64:+e);function i(){let a;if(r||(r=a=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:Ar(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:Ar(+a),i):e},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function sx(){}function ix(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function w7(t){this._context=t}w7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ix(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ix(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function yde(t){return new w7(t)}function j7(t){this._context=t}j7.prototype={areaStart:sx,areaEnd:sx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ix(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function bde(t){return new j7(t)}function N7(t){this._context=t}N7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ix(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function vde(t){return new N7(t)}function k7(t){this._context=t}k7.prototype={areaStart:sx,areaEnd:sx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function wde(t){return new k7(t)}function cT(t){return t<0?-1:1}function dT(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),l=(r-t._y1)/(i||n<0&&-0),d=(a*i+l*n)/(n+i);return(cT(a)+cT(l))*Math.min(Math.abs(a),Math.abs(l),.5*Math.abs(d))||0}function uT(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function Ew(t,e,r){var n=t._x0,i=t._y0,a=t._x1,l=t._y1,d=(a-n)/3;t._context.bezierCurveTo(n+d,i+d*e,a-d,l-d*r,a,l)}function ax(t){this._context=t}ax.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ew(this,this._t0,uT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ew(this,uT(this,r=dT(this,t,e)),r);break;default:Ew(this,this._t0,r=dT(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function S7(t){this._context=new _7(t)}(S7.prototype=Object.create(ax.prototype)).point=function(t,e){ax.prototype.point.call(this,e,t)};function _7(t){this._context=t}_7.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function jde(t){return new ax(t)}function Nde(t){return new S7(t)}function C7(t){this._context=t}C7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=hT(t),i=hT(e),a=0,l=1;l<r;++a,++l)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[l],e[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function hT(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),l=new Array(r);for(i[0]=0,a[0]=2,l[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,l[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,l[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,l[e]-=n*l[e-1];for(i[r-1]=l[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(l[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function kde(t){return new C7(t)}function by(t,e){this._context=t,this._t=e}by.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function Sde(t){return new by(t,.5)}function _de(t){return new by(t,0)}function Cde(t){return new by(t,1)}function bd(t,e){if((l=t.length)>1)for(var r=1,n,i,a=t[e[0]],l,d=a.length;r<l;++r)for(i=a,a=t[e[r]],n=0;n<d;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function nN(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function Ede(t,e){return t[e]}function Ade(t){const e=[];return e.key=t,e}function Tde(){var t=Ar([]),e=nN,r=bd,n=Ede;function i(a){var l=Array.from(t.apply(this,arguments),Ade),d,u=l.length,h=-1,p;for(const m of a)for(d=0,++h;d<u;++d)(l[d][h]=[0,+n(m,l[d].key,h,a)]).data=m;for(d=0,p=x5(e(l));d<u;++d)l[p[d]].index=d;return r(l,p),l}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:Ar(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Ar(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?nN:typeof a=="function"?a:Ar(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??bd,i):r},i}function Ode(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,l;i<a;++i){for(l=r=0;r<n;++r)l+=t[r][i][1]||0;if(l)for(r=0;r<n;++r)t[r][i][1]/=l}bd(t,e)}}function Mde(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var l=0,d=0;l<i;++l)d+=t[l][r][1]||0;n[r][1]+=n[r][0]=-d/2}bd(t,e)}}function Lde(t,e){if(!(!((l=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,l;n<a;++n){for(var d=0,u=0,h=0;d<l;++d){for(var p=t[e[d]],m=p[n][1]||0,x=p[n-1][1]||0,b=(m-x)/2,v=0;v<d;++v){var w=t[e[v]],k=w[n][1]||0,_=w[n-1][1]||0;b+=k-_}u+=m,h+=b*m}i[n-1][1]+=i[n-1][0]=r,u&&(r-=h/u)}i[n-1][1]+=i[n-1][0]=r,bd(t,e)}}var Aw={},Tw={},fT;function Rde(){return fT||(fT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(Tw)),Tw}var Ow={},pT;function E7(){return pT||(pT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(Ow)),Ow}var Mw={},mT;function b5(){return mT||(mT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(Mw)),Mw}var Lw={},Rw={},gT;function Pde(){return gT||(gT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(Rw)),Rw}var xT;function v5(){return xT||(xT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pde(),r=b5();function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=e.toString(i);const a=[],l=i.length;if(l===0)return a;let d=0,u="",h="",p=!1;for(i.charCodeAt(0)===46&&(a.push(""),d++);d<l;){const m=i[d];h?m==="\\"&&d+1<l?(d++,u+=i[d]):m===h?h="":u+=m:p?m==='"'||m==="'"?h=m:m==="]"?(p=!1,a.push(u),u=""):u+=m:m==="["?(p=!0,u&&(a.push(u),u="")):m==="."?u&&(a.push(u),u=""):u+=m,d++}return u&&a.push(u),a}t.toPath=n})(Lw)),Lw}var yT;function w5(){return yT||(yT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Rde(),r=E7(),n=b5(),i=v5();function a(d,u,h){if(d==null)return h;switch(typeof u){case"string":{if(e.isUnsafeProperty(u))return h;const p=d[u];return p===void 0?r.isDeepKey(u)?a(d,i.toPath(u),h):h:p}case"number":case"symbol":{typeof u=="number"&&(u=n.toKey(u));const p=d[u];return p===void 0?h:p}default:{if(Array.isArray(u))return l(d,u,h);if(Object.is(u?.valueOf(),-0)?u="-0":u=String(u),e.isUnsafeProperty(u))return h;const p=d[u];return p===void 0?h:p}}}function l(d,u,h){if(u.length===0)return h;let p=d;for(let m=0;m<u.length;m++){if(p==null||e.isUnsafeProperty(u[m]))return h;p=p[u[m]]}return p===void 0?h:p}t.get=a})(Aw)),Aw}var Pw,bT;function Ide(){return bT||(bT=1,Pw=w5().get),Pw}var Dde=Ide();const vd=Ms(Dde);var Bde=4;function ic(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bde,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function sn(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((i,a,l)=>{var d=r[l-1];return typeof d=="string"?i+d+a:d!==void 0?i+ic(d)+a:i+a},"")}var rs=t=>t===0?0:t>0?1:-1,to=t=>typeof t=="number"&&t!=+t,Zo=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,gt=t=>(typeof t=="number"||t instanceof Number)&&!to(t),ro=t=>gt(t)||typeof t=="string",$de=0,o0=t=>{var e=++$de;return"".concat(t||"").concat(e)},xs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!gt(e)&&typeof e!="string")return n;var a;if(Zo(e)){if(r==null)return n;var l=e.indexOf("%");a=r*parseFloat(e.slice(0,l))/100}else a=+e;return to(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},A7=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function _n(t,e,r){return gt(t)&&gt(e)?ic(t+r*(e-t)):e}function Ude(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):vd(n,e))===r)}var zn=t=>t===null||typeof t>"u",z0=t=>zn(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function zde(t){return t!=null}function q0(){}var qde=["type","size","sizeType"];function sN(){return sN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sN.apply(null,arguments)}function vT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function wT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vT(Object(r),!0).forEach(function(n){Fde(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Fde(t,e,r){return(e=Hde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hde(t){var e=Wde(t,"string");return typeof e=="symbol"?e:e+""}function Wde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gde(t,e){if(t==null)return{};var r,n,i=Vde(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Vde(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var T7={symbolCircle:y5,symbolCross:ade,symbolDiamond:lde,symbolSquare:cde,symbolStar:fde,symbolTriangle:pde,symbolWye:gde},Kde=Math.PI/180,Yde=t=>{var e="symbol".concat(z0(t));return T7[e]||y5},Xde=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*Kde;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Jde=(t,e)=>{T7["symbol".concat(z0(t))]=e},j5=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,i=Gde(t,qde),a=wT(wT({},i),{},{type:e,size:r,sizeType:n}),l="circle";typeof e=="string"&&(l=e);var d=()=>{var x=Yde(l),b=xde().type(x).size(Xde(r,n,l)),v=b();if(v!==null)return v},{className:u,cx:h,cy:p}=a,m=Ki(a);return gt(h)&&gt(p)&&gt(r)?y.createElement("path",sN({},m,{className:gr("recharts-symbols",u),transform:"translate(".concat(h,", ").concat(p,")"),d:d()})):null};j5.registerSymbol=Jde;var O7=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,Qde=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(y.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{p5(i)&&(n[i]=(a=>r[i](r,a)))}),n},Zde=(t,e,r)=>n=>(t(e,r,n),null),F0=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];p5(i)&&typeof a=="function"&&(n||(n={}),n[i]=Zde(a,e,r))}),n};function jT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function eue(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jT(Object(r),!0).forEach(function(n){tue(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tue(t,e,r){return(e=rue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rue(t){var e=nue(t,"string");return typeof e=="symbol"?e:e+""}function nue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ss(t,e){var r=eue({},t),n=e,i=Object.keys(e),a=i.reduce((l,d)=>(l[d]===void 0&&n[d]!==void 0&&(l[d]=n[d]),l),r);return a}function ox(){return ox=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ox.apply(null,arguments)}function NT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function sue(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NT(Object(r),!0).forEach(function(n){iue(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iue(t,e,r){return(e=aue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aue(t){var e=oue(t,"string");return typeof e=="symbol"?e:e+""}function oue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $i=32,lue={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function cue(t){var{data:e,iconType:r,inactiveColor:n}=t,i=$i/2,a=$i/6,l=$i/3,d=e.inactive?n:e.color,u=r??e.type;if(u==="none")return null;if(u==="plainline"){var h;return y.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:(h=e.payload)===null||h===void 0?void 0:h.strokeDasharray,x1:0,y1:i,x2:$i,y2:i,className:"recharts-legend-icon"})}if(u==="line")return y.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat($i,"M").concat(2*l,",").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(u==="rect")return y.createElement("path",{stroke:"none",fill:d,d:"M0,".concat($i/8,"h").concat($i,"v").concat($i*3/4,"h").concat(-$i,"z"),className:"recharts-legend-icon"});if(y.isValidElement(e.legendIcon)){var p=sue({},e);return delete p.legendIcon,y.cloneElement(e.legendIcon,p)}return y.createElement(j5,{fill:d,cx:i,cy:i,size:$i,sizeType:"diameter",type:u})}function due(t){var{payload:e,iconSize:r,layout:n,formatter:i,inactiveColor:a,iconType:l}=t,d={x:0,y:0,width:$i,height:$i},u={display:n==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((p,m)=>{var x=p.formatter||i,b=gr({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:p.inactive});if(p.type==="none")return null;var v=p.inactive?a:p.color,w=x?x(p.value,p,m):p.value;return y.createElement("li",ox({className:b,style:u,key:"legend-item-".concat(m)},F0(t,p,m)),y.createElement(m5,{width:r,height:r,viewBox:d,style:h,"aria-label":"".concat(w," legend icon")},y.createElement(cue,{data:p,iconType:l,inactiveColor:a})),y.createElement("span",{className:"recharts-legend-item-text",style:{color:v}},w))})}var uue=t=>{var e=ss(t,lue),{payload:r,layout:n,align:i}=e;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return y.createElement("ul",{className:"recharts-default-legend",style:a},y.createElement(due,ox({},e,{payload:r})))},Iw={},Dw={},kT;function hue(){return kT||(kT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const l=r[a],d=n(l);i.has(d)||i.set(d,l)}return Array.from(i.values())}t.uniqBy=e})(Dw)),Dw}var Bw={},ST;function M7(){return ST||(ST=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(Bw)),Bw}var $w={},Uw={},zw={},_T;function fue(){return _T||(_T=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(zw)),zw}var CT;function N5(){return CT||(CT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=fue();function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(Uw)),Uw}var qw={},ET;function pue(){return ET||(ET=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(qw)),qw}var AT;function mue(){return AT||(AT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=N5(),r=pue();function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})($w)),$w}var Fw={},Hw={},TT;function gue(){return TT||(TT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=w5();function r(n){return function(i){return e.get(i,n)}}t.property=r})(Hw)),Hw}var Ww={},Gw={},Vw={},Kw={},OT;function L7(){return OT||(OT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(Kw)),Kw}var Yw={},MT;function R7(){return MT||(MT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(Yw)),Yw}var Xw={},LT;function P7(){return LT||(LT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(Xw)),Xw}var RT;function xue(){return RT||(RT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=L7(),r=R7(),n=P7();function i(p,m,x){return typeof x!="function"?i(p,m,()=>{}):a(p,m,function b(v,w,k,_,T,A){const I=x(v,w,k,_,T,A);return I!==void 0?!!I:a(v,w,b,A)},new Map)}function a(p,m,x,b){if(m===p)return!0;switch(typeof m){case"object":return l(p,m,x,b);case"function":return Object.keys(m).length>0?a(p,{...m},x,b):n.eq(p,m);default:return e.isObject(p)?typeof m=="string"?m==="":!0:n.eq(p,m)}}function l(p,m,x,b){if(m==null)return!0;if(Array.isArray(m))return u(p,m,x,b);if(m instanceof Map)return d(p,m,x,b);if(m instanceof Set)return h(p,m,x,b);const v=Object.keys(m);if(p==null||r.isPrimitive(p))return v.length===0;if(v.length===0)return!0;if(b?.has(m))return b.get(m)===p;b?.set(m,p);try{for(let w=0;w<v.length;w++){const k=v[w];if(!r.isPrimitive(p)&&!(k in p)||m[k]===void 0&&p[k]!==void 0||m[k]===null&&p[k]!==null||!x(p[k],m[k],k,p,m,b))return!1}return!0}finally{b?.delete(m)}}function d(p,m,x,b){if(m.size===0)return!0;if(!(p instanceof Map))return!1;for(const[v,w]of m.entries()){const k=p.get(v);if(x(k,w,v,p,m,b)===!1)return!1}return!0}function u(p,m,x,b){if(m.length===0)return!0;if(!Array.isArray(p))return!1;const v=new Set;for(let w=0;w<m.length;w++){const k=m[w];let _=!1;for(let T=0;T<p.length;T++){if(v.has(T))continue;const A=p[T];let I=!1;if(x(A,k,w,p,m,b)&&(I=!0),I){v.add(T),_=!0;break}}if(!_)return!1}return!0}function h(p,m,x,b){return m.size===0?!0:p instanceof Set?u([...p],[...m],x,b):!1}t.isMatchWith=i,t.isSetMatch=h})(Vw)),Vw}var PT;function I7(){return PT||(PT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xue();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r})(Gw)),Gw}var Jw={},Qw={},Zw={},IT;function yue(){return IT||(IT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Zw)),Zw}var e2={},DT;function D7(){return DT||(DT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(e2)),e2}var t2={},BT;function B7(){return BT||(BT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",l="[object Symbol]",d="[object Date]",u="[object Map]",h="[object Set]",p="[object Array]",m="[object Function]",x="[object ArrayBuffer]",b="[object Object]",v="[object Error]",w="[object DataView]",k="[object Uint8Array]",_="[object Uint8ClampedArray]",T="[object Uint16Array]",A="[object Uint32Array]",I="[object BigUint64Array]",O="[object Int8Array]",M="[object Int16Array]",E="[object Int32Array]",R="[object BigInt64Array]",$="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=x,t.arrayTag=p,t.bigInt64ArrayTag=R,t.bigUint64ArrayTag=I,t.booleanTag=i,t.dataViewTag=w,t.dateTag=d,t.errorTag=v,t.float32ArrayTag=$,t.float64ArrayTag=B,t.functionTag=m,t.int16ArrayTag=M,t.int32ArrayTag=E,t.int8ArrayTag=O,t.mapTag=u,t.numberTag=n,t.objectTag=b,t.regexpTag=e,t.setTag=h,t.stringTag=r,t.symbolTag=l,t.uint16ArrayTag=T,t.uint32ArrayTag=A,t.uint8ArrayTag=k,t.uint8ClampedArrayTag=_})(t2)),t2}var r2={},$T;function bue(){return $T||($T=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(r2)),r2}var UT;function $7(){return UT||(UT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yue(),r=D7(),n=B7(),i=R7(),a=bue();function l(p,m){return d(p,void 0,p,new Map,m)}function d(p,m,x,b=new Map,v=void 0){const w=v?.(p,m,x,b);if(w!==void 0)return w;if(i.isPrimitive(p))return p;if(b.has(p))return b.get(p);if(Array.isArray(p)){const k=new Array(p.length);b.set(p,k);for(let _=0;_<p.length;_++)k[_]=d(p[_],_,x,b,v);return Object.hasOwn(p,"index")&&(k.index=p.index),Object.hasOwn(p,"input")&&(k.input=p.input),k}if(p instanceof Date)return new Date(p.getTime());if(p instanceof RegExp){const k=new RegExp(p.source,p.flags);return k.lastIndex=p.lastIndex,k}if(p instanceof Map){const k=new Map;b.set(p,k);for(const[_,T]of p)k.set(_,d(T,_,x,b,v));return k}if(p instanceof Set){const k=new Set;b.set(p,k);for(const _ of p)k.add(d(_,void 0,x,b,v));return k}if(typeof Buffer<"u"&&Buffer.isBuffer(p))return p.subarray();if(a.isTypedArray(p)){const k=new(Object.getPrototypeOf(p)).constructor(p.length);b.set(p,k);for(let _=0;_<p.length;_++)k[_]=d(p[_],_,x,b,v);return k}if(p instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&p instanceof SharedArrayBuffer)return p.slice(0);if(p instanceof DataView){const k=new DataView(p.buffer.slice(0),p.byteOffset,p.byteLength);return b.set(p,k),u(k,p,x,b,v),k}if(typeof File<"u"&&p instanceof File){const k=new File([p],p.name,{type:p.type});return b.set(p,k),u(k,p,x,b,v),k}if(typeof Blob<"u"&&p instanceof Blob){const k=new Blob([p],{type:p.type});return b.set(p,k),u(k,p,x,b,v),k}if(p instanceof Error){const k=new p.constructor;return b.set(p,k),k.message=p.message,k.name=p.name,k.stack=p.stack,k.cause=p.cause,u(k,p,x,b,v),k}if(p instanceof Boolean){const k=new Boolean(p.valueOf());return b.set(p,k),u(k,p,x,b,v),k}if(p instanceof Number){const k=new Number(p.valueOf());return b.set(p,k),u(k,p,x,b,v),k}if(p instanceof String){const k=new String(p.valueOf());return b.set(p,k),u(k,p,x,b,v),k}if(typeof p=="object"&&h(p)){const k=Object.create(Object.getPrototypeOf(p));return b.set(p,k),u(k,p,x,b,v),k}return p}function u(p,m,x=p,b,v){const w=[...Object.keys(m),...e.getSymbols(m)];for(let k=0;k<w.length;k++){const _=w[k],T=Object.getOwnPropertyDescriptor(p,_);(T==null||T.writable)&&(p[_]=d(m[_],_,x,b,v))}}function h(p){switch(r.getTag(p)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=l,t.cloneDeepWithImpl=d,t.copyProperties=u})(Qw)),Qw}var zT;function vue(){return zT||(zT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$7();function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(Jw)),Jw}var qT;function wue(){return qT||(qT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=I7(),r=vue();function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(Ww)),Ww}var n2={},s2={},i2={},FT;function jue(){return FT||(FT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$7(),r=B7();function n(i,a){return e.cloneDeepWith(i,(l,d,u,h)=>{const p=a?.(l,d,u,h);if(p!==void 0)return p;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new i.constructor(i?.valueOf());return e.copyProperties(m,i),m}case r.argumentsTag:{const m={};return e.copyProperties(m,i),m.length=i.length,m[Symbol.iterator]=i[Symbol.iterator],m}default:return}})}t.cloneDeepWith=n})(i2)),i2}var HT;function Nue(){return HT||(HT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jue();function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(s2)),s2}var a2={},o2={},WT;function U7(){return WT||(WT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(o2)),o2}var l2={},GT;function kue(){return GT||(GT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=D7();function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(l2)),l2}var VT;function Sue(){return VT||(VT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=E7(),r=U7(),n=kue(),i=v5();function a(l,d){let u;if(Array.isArray(d)?u=d:typeof d=="string"&&e.isDeepKey(d)&&l?.[d]==null?u=i.toPath(d):u=[d],u.length===0)return!1;let h=l;for(let p=0;p<u.length;p++){const m=u[p];if((h==null||!Object.hasOwn(h,m))&&!((Array.isArray(h)||n.isArguments(h))&&r.isIndex(m)&&m<h.length))return!1;h=h[m]}return!0}t.has=a})(a2)),a2}var KT;function _ue(){return KT||(KT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=I7(),r=b5(),n=Nue(),i=w5(),a=Sue();function l(d,u){switch(typeof d){case"object":{Object.is(d?.valueOf(),-0)&&(d="-0");break}case"number":{d=r.toKey(d);break}}return u=n.cloneDeep(u),function(h){const p=i.get(h,d);return p===void 0?a.has(h,d):u===void 0?p===void 0:e.isMatch(p,u)}}t.matchesProperty=l})(n2)),n2}var YT;function Cue(){return YT||(YT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=M7(),r=gue(),n=wue(),i=_ue();function a(l){if(l==null)return e.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?i.matchesProperty(l[0],l[1]):n.matches(l);case"string":case"symbol":case"number":return r.property(l)}}t.iteratee=a})(Fw)),Fw}var XT;function Eue(){return XT||(XT=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hue(),r=M7(),n=mue(),i=Cue();function a(l,d=r.identity){return n.isArrayLikeObject(l)?e.uniqBy(Array.from(l),i.iteratee(d)):[]}t.uniqBy=a})(Iw)),Iw}var c2,JT;function Aue(){return JT||(JT=1,c2=Eue().uniqBy),c2}var Tue=Aue();const QT=Ms(Tue);function z7(t,e,r){return e===!0?QT(t,r):typeof e=="function"?QT(t,e):t}var d2={exports:{}},u2={},h2={exports:{}},f2={};var ZT;function Oue(){if(ZT)return f2;ZT=1;var t=al();function e(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,l=t.useDebugValue;function d(m,x){var b=x(),v=n({inst:{value:b,getSnapshot:x}}),w=v[0].inst,k=v[1];return a(function(){w.value=b,w.getSnapshot=x,u(w)&&k({inst:w})},[m,b,x]),i(function(){return u(w)&&k({inst:w}),m(function(){u(w)&&k({inst:w})})},[m]),l(b),b}function u(m){var x=m.getSnapshot;m=m.value;try{var b=x();return!r(m,b)}catch{return!0}}function h(m,x){return x()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:d;return f2.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,f2}var eO;function Mue(){return eO||(eO=1,h2.exports=Oue()),h2.exports}var tO;function Lue(){if(tO)return u2;tO=1;var t=al(),e=Mue();function r(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,a=t.useRef,l=t.useEffect,d=t.useMemo,u=t.useDebugValue;return u2.useSyncExternalStoreWithSelector=function(h,p,m,x,b){var v=a(null);if(v.current===null){var w={hasValue:!1,value:null};v.current=w}else w=v.current;v=d(function(){function _(M){if(!T){if(T=!0,A=M,M=x(M),b!==void 0&&w.hasValue){var E=w.value;if(b(E,M))return I=E}return I=M}if(E=I,n(A,M))return E;var R=x(M);return b!==void 0&&b(E,R)?(A=M,E):(A=M,I=R)}var T=!1,A,I,O=m===void 0?null:m;return[function(){return _(p())},O===null?void 0:function(){return _(O())}]},[p,m,x,b]);var k=i(h,v[0],v[1]);return l(function(){w.hasValue=!0,w.value=k},[k]),u(k),k},u2}var rO;function Rue(){return rO||(rO=1,d2.exports=Lue()),d2.exports}var Pue=Rue(),k5=y.createContext(null),Iue=t=>t,Or=()=>{var t=y.useContext(k5);return t?t.store.dispatch:Iue},Cg=()=>{},Due=()=>Cg,Bue=(t,e)=>t===e;function ft(t){var e=y.useContext(k5);return Pue.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:Due,e?e.store.getState:Cg,e?e.store.getState:Cg,e?t:Cg,Bue)}function $ue(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function Uue(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function zue(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var nO=t=>Array.isArray(t)?t:[t];function que(t){const e=Array.isArray(t[0])?t[0]:t;return zue(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function Fue(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var Hue=class{constructor(t){this.value=t}deref(){return this.value}},Wue=typeof WeakRef<"u"?WeakRef:Hue,Gue=0,sO=1;function Xm(){return{s:Gue,v:void 0,o:null,p:null}}function q7(t,e={}){let r=Xm();const{resultEqualityCheck:n}=e;let i,a=0;function l(){let d=r;const{length:u}=arguments;for(let m=0,x=u;m<x;m++){const b=arguments[m];if(typeof b=="function"||typeof b=="object"&&b!==null){let v=d.o;v===null&&(d.o=v=new WeakMap);const w=v.get(b);w===void 0?(d=Xm(),v.set(b,d)):d=w}else{let v=d.p;v===null&&(d.p=v=new Map);const w=v.get(b);w===void 0?(d=Xm(),v.set(b,d)):d=w}}const h=d;let p;if(d.s===sO)p=d.v;else if(p=t.apply(null,arguments),a++,n){const m=i?.deref?.()??i;m!=null&&n(m,p)&&(p=m,a!==0&&a--),i=typeof p=="object"&&p!==null||typeof p=="function"?new Wue(p):p}return h.s=sO,h.v=p,p}return l.clearCache=()=>{r=Xm(),l.resetResultsCount()},l.resultsCount=()=>a,l.resetResultsCount=()=>{a=0},l}function Vue(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,l=0,d,u={},h=i.pop();typeof h=="object"&&(u=h,h=i.pop()),$ue(h,`createSelector expects an output function after the inputs, but received: [${typeof h}]`);const p={...r,...u},{memoize:m,memoizeOptions:x=[],argsMemoize:b=q7,argsMemoizeOptions:v=[]}=p,w=nO(x),k=nO(v),_=que(i),T=m(function(){return a++,h.apply(null,arguments)},...w),A=b(function(){l++;const O=Fue(_,arguments);return d=T.apply(null,O),d},...k);return Object.assign(A,{resultFunc:h,memoizedResultFunc:T,dependencies:_,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>d,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:m,argsMemoize:b})};return Object.assign(n,{withTypes:()=>n}),n}var we=Vue(q7),Kue=Object.assign((t,e=we)=>{Uue(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((l,d,u)=>(l[r[u]]=d,l),{}))},{withTypes:()=>Kue}),p2={},m2={},g2={},iO;function Yue(){return iO||(iO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const l=e(n),d=e(i);if(l===d&&l===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?d-l:l-d}return 0};t.compareValues=r})(g2)),g2}var x2={},y2={},aO;function F7(){return aO||(aO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(y2)),y2}var oO;function Xue(){return oO||(oO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=F7(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,l){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||l!=null&&Object.hasOwn(l,a)}t.isKey=i})(x2)),x2}var lO;function Jue(){return lO||(lO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Yue(),r=Xue(),n=v5();function i(a,l,d,u){if(a==null)return[];d=u?void 0:d,Array.isArray(a)||(a=Object.values(a)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(d)||(d=d==null?[]:[d]),d=d.map(b=>String(b));const h=(b,v)=>{let w=b;for(let k=0;k<v.length&&w!=null;++k)w=w[v[k]];return w},p=(b,v)=>v==null||b==null?v:typeof b=="object"&&"key"in b?Object.hasOwn(v,b.key)?v[b.key]:h(v,b.path):typeof b=="function"?b(v):Array.isArray(b)?h(v,b):typeof v=="object"?v[b]:v,m=l.map(b=>(Array.isArray(b)&&b.length===1&&(b=b[0]),b==null||typeof b=="function"||Array.isArray(b)||r.isKey(b)?b:{key:b,path:n.toPath(b)}));return a.map(b=>({original:b,criteria:m.map(v=>p(v,b))})).slice().sort((b,v)=>{for(let w=0;w<m.length;w++){const k=e.compareValues(b.criteria[w],v.criteria[w],d[w]);if(k!==0)return k}return 0}).map(b=>b.original)}t.orderBy=i})(m2)),m2}var b2={},cO;function Que(){return cO||(cO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),l=(d,u)=>{for(let h=0;h<d.length;h++){const p=d[h];Array.isArray(p)&&u<a?l(p,u+1):i.push(p)}};return l(r,0),i}t.flatten=e})(b2)),b2}var v2={},dO;function H7(){return dO||(dO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=U7(),r=N5(),n=L7(),i=P7();function a(l,d,u){return n.isObject(u)&&(typeof d=="number"&&r.isArrayLike(u)&&e.isIndex(d)&&d<u.length||typeof d=="string"&&d in u)?i.eq(u[d],l):!1}t.isIterateeCall=a})(v2)),v2}var uO;function Zue(){return uO||(uO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Jue(),r=Que(),n=H7();function i(a,...l){const d=l.length;return d>1&&n.isIterateeCall(a,l[0],l[1])?l=[]:d>2&&n.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),e.orderBy(a,r.flatten(l),["asc"])}t.sortBy=i})(p2)),p2}var w2,hO;function ehe(){return hO||(hO=1,w2=Zue().sortBy),w2}var the=ehe();const vy=Ms(the);var W7=t=>t.legend.settings,rhe=t=>t.legend.size,nhe=t=>t.legend.payload,she=we([nhe,W7],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?vy(n,r):n});function ihe(){return ft(she)}var Jm=1;function G7(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=y.useState({height:0,left:0,top:0,width:0}),n=y.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),l={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(l.height-e.height)>Jm||Math.abs(l.left-e.left)>Jm||Math.abs(l.top-e.top)>Jm||Math.abs(l.width-e.width)>Jm)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function Zn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var ahe=typeof Symbol=="function"&&Symbol.observable||"@@observable",fO=ahe,j2=()=>Math.random().toString(36).substring(7).split("").join("."),ohe={INIT:`@@redux/INIT${j2()}`,REPLACE:`@@redux/REPLACE${j2()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${j2()}`},lx=ohe;function S5(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function V7(t,e,r){if(typeof t!="function")throw new Error(Zn(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Zn(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Zn(1));return r(V7)(t,e)}let n=t,i=e,a=new Map,l=a,d=0,u=!1;function h(){l===a&&(l=new Map,a.forEach((k,_)=>{l.set(_,k)}))}function p(){if(u)throw new Error(Zn(3));return i}function m(k){if(typeof k!="function")throw new Error(Zn(4));if(u)throw new Error(Zn(5));let _=!0;h();const T=d++;return l.set(T,k),function(){if(_){if(u)throw new Error(Zn(6));_=!1,h(),l.delete(T),a=null}}}function x(k){if(!S5(k))throw new Error(Zn(7));if(typeof k.type>"u")throw new Error(Zn(8));if(typeof k.type!="string")throw new Error(Zn(17));if(u)throw new Error(Zn(9));try{u=!0,i=n(i,k)}finally{u=!1}return(a=l).forEach(T=>{T()}),k}function b(k){if(typeof k!="function")throw new Error(Zn(10));n=k,x({type:lx.REPLACE})}function v(){const k=m;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error(Zn(11));function T(){const I=_;I.next&&I.next(p())}return T(),{unsubscribe:k(T)}},[fO](){return this}}}return x({type:lx.INIT}),{dispatch:x,subscribe:m,getState:p,replaceReducer:b,[fO]:v}}function lhe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:lx.INIT})>"u")throw new Error(Zn(12));if(typeof r(void 0,{type:lx.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Zn(13))})}function K7(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const l=e[a];typeof t[l]=="function"&&(r[l]=t[l])}const n=Object.keys(r);let i;try{lhe(r)}catch(a){i=a}return function(l={},d){if(i)throw i;let u=!1;const h={};for(let p=0;p<n.length;p++){const m=n[p],x=r[m],b=l[m],v=x(b,d);if(typeof v>"u")throw d&&d.type,new Error(Zn(14));h[m]=v,u=u||v!==b}return u=u||n.length!==Object.keys(l).length,u?h:l}}function cx(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function che(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(Zn(15))};const l={getState:i.getState,dispatch:(u,...h)=>a(u,...h)},d=t.map(u=>u(l));return a=cx(...d)(i.dispatch),{...i,dispatch:a}}}function Y7(t){return S5(t)&&"type"in t&&typeof t.type=="string"}var X7=Symbol.for("immer-nothing"),pO=Symbol.for("immer-draftable"),Os=Symbol.for("immer-state");function ma(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var fi=Object,Xu=fi.getPrototypeOf,dx="constructor",wy="prototype",iN="configurable",ux="enumerable",Eg="writable",l0="value",el=t=>!!t&&!!t[Os];function Sa(t){return t?J7(t)||jy(t)||!!t[pO]||!!t[dx]?.[pO]||Ny(t)||ky(t):!1}var dhe=fi[wy][dx].toString(),mO=new WeakMap;function J7(t){if(!t||!_5(t))return!1;const e=Xu(t);if(e===null||e===fi[wy])return!0;const r=fi.hasOwnProperty.call(e,dx)&&e[dx];if(r===Object)return!0;if(!Tu(r))return!1;let n=mO.get(r);return n===void 0&&(n=Function.toString.call(r),mO.set(r,n)),n===dhe}function H0(t,e,r=!0){W0(t)===0?(r?Reflect.ownKeys(t):fi.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((n,i)=>e(i,n,t))}function W0(t){const e=t[Os];return e?e.type_:jy(t)?1:Ny(t)?2:ky(t)?3:0}var gO=(t,e,r=W0(t))=>r===2?t.has(e):fi[wy].hasOwnProperty.call(t,e),aN=(t,e,r=W0(t))=>r===2?t.get(e):t[e],hx=(t,e,r,n=W0(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function uhe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var jy=Array.isArray,Ny=t=>t instanceof Map,ky=t=>t instanceof Set,_5=t=>typeof t=="object",Tu=t=>typeof t=="function",N2=t=>typeof t=="boolean";function hhe(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Po=t=>t.copy_||t.base_,C5=t=>t.modified_?t.copy_:t.base_;function oN(t,e){if(Ny(t))return new Map(t);if(ky(t))return new Set(t);if(jy(t))return Array[wy].slice.call(t);const r=J7(t);if(e===!0||e==="class_only"&&!r){const n=fi.getOwnPropertyDescriptors(t);delete n[Os];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const l=i[a],d=n[l];d[Eg]===!1&&(d[Eg]=!0,d[iN]=!0),(d.get||d.set)&&(n[l]={[iN]:!0,[Eg]:!0,[ux]:d[ux],[l0]:t[l]})}return fi.create(Xu(t),n)}else{const n=Xu(t);if(n!==null&&r)return{...t};const i=fi.create(n);return fi.assign(i,t)}}function E5(t,e=!1){return Sy(t)||el(t)||!Sa(t)||(W0(t)>1&&fi.defineProperties(t,{set:Qm,add:Qm,clear:Qm,delete:Qm}),fi.freeze(t),e&&H0(t,(r,n)=>{E5(n,!0)},!1)),t}function fhe(){ma(2)}var Qm={[l0]:fhe};function Sy(t){return t===null||!_5(t)?!0:fi.isFrozen(t)}var fx="MapSet",lN="Patches",xO="ArrayMethods",Q7={};function wd(t){const e=Q7[t];return e||ma(0,t),e}var yO=t=>!!Q7[t],c0,Z7=()=>c0,phe=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:yO(fx)?wd(fx):void 0,arrayMethodsPlugin_:yO(xO)?wd(xO):void 0});function bO(t,e){e&&(t.patchPlugin_=wd(lN),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function cN(t){dN(t),t.drafts_.forEach(mhe),t.drafts_=null}function dN(t){t===c0&&(c0=t.parent_)}var vO=t=>c0=phe(c0,t);function mhe(t){const e=t[Os];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function wO(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Os].modified_&&(cN(e),ma(4)),Sa(t)&&(t=jO(e,t));const{patchPlugin_:i}=e;i&&i.generateReplacementPatches_(r[Os].base_,t,e)}else t=jO(e,r);return ghe(e,t,!0),cN(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==X7?t:void 0}function jO(t,e){if(Sy(e))return e;const r=e[Os];if(!r)return A5(e,t.handledSet_,t);if(!_y(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);rD(r,t)}return r.copy_}function ghe(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&E5(e,r)}function eD(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var _y=(t,e)=>t.scope_===e,xhe=[];function tD(t,e,r,n){const i=Po(t),a=t.type_;if(n!==void 0&&aN(i,n,a)===e){hx(i,n,r,a);return}if(!t.draftLocations_){const d=t.draftLocations_=new Map;H0(i,(u,h)=>{if(el(h)){const p=d.get(h)||[];p.push(u),d.set(h,p)}})}const l=t.draftLocations_.get(e)??xhe;for(const d of l)hx(i,d,r,a)}function yhe(t,e,r){t.callbacks_.push(function(i){const a=e;if(!a||!_y(a,i))return;i.mapSetPlugin_?.fixSetContents(a);const l=C5(a);tD(t,a.draft_??a,l,r),rD(a,i)})}function rD(t,e){if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(t.assigned_?.size??0)>0)){const{patchPlugin_:n}=e;if(n){const i=n.getPath(t);i&&n.generatePatches_(t,i,e)}eD(t)}}function bhe(t,e,r){const{scope_:n}=t;if(el(r)){const i=r[Os];_y(i,n)&&i.callbacks_.push(function(){Ag(t);const l=C5(i);tD(t,r,l,e)})}else Sa(r)&&t.callbacks_.push(function(){const a=Po(t);aN(a,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&A5(aN(t.copy_,e,t.type_),n.handledSet_,n)})}function A5(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||el(t)||e.has(t)||!Sa(t)||Sy(t)||(e.add(t),H0(t,(n,i)=>{if(el(i)){const a=i[Os];if(_y(a,r)){const l=C5(a);hx(t,n,l,t.type_),eD(a)}}else Sa(i)&&A5(i,e,r)})),t}function vhe(t,e){const r=jy(t),n={type_:r?1:0,scope_:e?e.scope_:Z7(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,a=T5;r&&(i=[n],a=d0);const{revoke:l,proxy:d}=Proxy.revocable(i,a);return n.draft_=d,n.revoke_=l,[d,n]}var T5={get(t,e){if(e===Os)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r?.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const i=Po(t);if(!gO(i,e,t.type_))return whe(t,i,e);const a=i[e];if(t.finalized_||!Sa(a)||n&&t.operationMethod&&r?.isMutatingArrayMethod(t.operationMethod)&&hhe(e))return a;if(a===k2(t.base_,e)){Ag(t);const l=t.type_===1?+e:e,d=hN(t.scope_,a,t,l);return t.copy_[l]=d}return a},has(t,e){return e in Po(t)},ownKeys(t){return Reflect.ownKeys(Po(t))},set(t,e,r){const n=nD(Po(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=k2(Po(t),e),a=i?.[Os];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(uhe(r,i)&&(r!==void 0||gO(t.base_,e,t.type_)))return!0;Ag(t),uN(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),bhe(t,e,r)),!0},deleteProperty(t,e){return Ag(t),k2(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),uN(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Po(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[Eg]:!0,[iN]:t.type_!==1||e!=="length",[ux]:n[ux],[l0]:r[e]}},defineProperty(){ma(11)},getPrototypeOf(t){return Xu(t.base_)},setPrototypeOf(){ma(12)}},d0={};H0(T5,(t,e)=>{d0[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}});d0.deleteProperty=function(t,e){return d0.set.call(this,t,e,void 0)};d0.set=function(t,e,r){return T5.set.call(this,t[0],e,r,t[0])};function k2(t,e){const r=t[Os];return(r?Po(r):t)[e]}function whe(t,e,r){const n=nD(e,r);return n?l0 in n?n[l0]:n.get?.call(t.draft_):void 0}function nD(t,e){if(!(e in t))return;let r=Xu(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Xu(r)}}function uN(t){t.modified_||(t.modified_=!0,t.parent_&&uN(t.parent_))}function Ag(t){t.copy_||(t.assigned_=new Map,t.copy_=oN(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var jhe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(Tu(r)&&!Tu(n)){const l=n;n=r;const d=this;return function(h=l,...p){return d.produce(h,m=>n.call(this,m,...p))}}Tu(n)||ma(6),i!==void 0&&!Tu(i)&&ma(7);let a;if(Sa(r)){const l=vO(this),d=hN(l,r,void 0);let u=!0;try{a=n(d),u=!1}finally{u?cN(l):dN(l)}return bO(l,i),wO(a,l)}else if(!r||!_5(r)){if(a=n(r),a===void 0&&(a=r),a===X7&&(a=void 0),this.autoFreeze_&&E5(a,!0),i){const l=[],d=[];wd(lN).generateReplacementPatches_(r,a,{patches_:l,inversePatches_:d}),i(l,d)}return a}else ma(1,r)},this.produceWithPatches=(r,n)=>{if(Tu(r))return(d,...u)=>this.produceWithPatches(d,h=>r(h,...u));let i,a;return[this.produce(r,n,(d,u)=>{i=d,a=u}),i,a]},N2(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),N2(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),N2(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Sa(e)||ma(8),el(e)&&(e=Na(e));const r=vO(this),n=hN(r,e,void 0);return n[Os].isManual_=!0,dN(r),n}finishDraft(e,r){const n=e&&e[Os];(!n||!n.isManual_)&&ma(9);const{scope_:i}=n;return bO(i,r),wO(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const a=r[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(r=r.slice(n+1));const i=wd(lN).applyPatches_;return el(e)?i(e,r):this.produce(e,a=>i(a,r))}};function hN(t,e,r,n){const[i,a]=Ny(e)?wd(fx).proxyMap_(e,r):ky(e)?wd(fx).proxySet_(e,r):vhe(e,r);return(r?.scope_??Z7()).drafts_.push(i),a.callbacks_=r?.callbacks_??[],a.key_=n,r&&n!==void 0?yhe(r,a,n):a.callbacks_.push(function(u){u.mapSetPlugin_?.fixSetContents(a);const{patchPlugin_:h}=u;a.modified_&&h&&h.generatePatches_(a,[],u)}),i}function Na(t){return el(t)||ma(10,t),sD(t)}function sD(t){if(!Sa(t)||Sy(t))return t;const e=t[Os];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=oN(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=oN(t,!0);return H0(r,(i,a)=>{hx(r,i,sD(a))},n),e&&(e.finalized_=!1),r}var Nhe=new jhe,iD=Nhe.produce;function aD(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var khe=aD(),She=aD,_he=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?cx:cx.apply(null,arguments)};function Yi(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(gi(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Y7(n)&&n.type===t,r}var oD=class Of extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Of.prototype)}static get[Symbol.species](){return Of}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Of(...e[0].concat(this)):new Of(...e.concat(this))}};function NO(t){return Sa(t)?iD(t,()=>{}):t}function Zm(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function Che(t){return typeof t=="boolean"}var Ehe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let l=new oD;return r&&(Che(r)?l.push(khe):l.push(She(r.extraArgument))),l},lD="RTK_autoBatch",Wr=()=>t=>({payload:t,meta:{[lD]:!0}}),kO=t=>e=>{setTimeout(e,t)},cD=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,l=!1;const d=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:kO(10):t.type==="callback"?t.queueNotification:kO(t.timeout),h=()=>{l=!1,a&&(a=!1,d.forEach(p=>p()))};return Object.assign({},n,{subscribe(p){const m=()=>i&&p(),x=n.subscribe(m);return d.add(p),()=>{x(),d.delete(p)}},dispatch(p){try{return i=!p?.meta?.[lD],a=!i,a&&(l||(l=!0,u(h))),n.dispatch(p)}finally{i=!0}}})},Ahe=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new oD(t);return n&&i.push(cD(typeof n=="object"?n:void 0)),i};function The(t){const e=Ehe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:l=void 0}=t||{};let d;if(typeof r=="function")d=r;else if(S5(r))d=K7(r);else throw new Error(gi(1));let u;typeof n=="function"?u=n(e):u=e();let h=cx;i&&(h=_he({trace:!1,...typeof i=="object"&&i}));const p=che(...u),m=Ahe(p);let x=typeof l=="function"?l(m):m();const b=h(...x);return V7(d,a,b)}function dD(t){const e={},r=[];let n;const i={addCase(a,l){const d=typeof a=="string"?a:a.type;if(!d)throw new Error(gi(28));if(d in e)throw new Error(gi(29));return e[d]=l,i},addAsyncThunk(a,l){return l.pending&&(e[a.pending.type]=l.pending),l.rejected&&(e[a.rejected.type]=l.rejected),l.fulfilled&&(e[a.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:a.settled,reducer:l.settled}),i},addMatcher(a,l){return r.push({matcher:a,reducer:l}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function Ohe(t){return typeof t=="function"}function Mhe(t,e){let[r,n,i]=dD(e),a;if(Ohe(t))a=()=>NO(t());else{const d=NO(t);a=()=>d}function l(d=a(),u){let h=[r[u.type],...n.filter(({matcher:p})=>p(u)).map(({reducer:p})=>p)];return h.filter(p=>!!p).length===0&&(h=[i]),h.reduce((p,m)=>{if(m)if(el(p)){const b=m(p,u);return b===void 0?p:b}else{if(Sa(p))return iD(p,x=>m(x,u));{const x=m(p,u);if(x===void 0){if(p===null)return p;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return p},d)}return l.getInitialState=a,l}var Lhe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Rhe=(t=21)=>{let e="",r=t;for(;r--;)e+=Lhe[Math.random()*64|0];return e},Phe=Symbol.for("rtk-slice-createasyncthunk");function Ihe(t,e){return`${t}/${e}`}function Dhe({creators:t}={}){const e=t?.asyncThunk?.[Phe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(gi(11));const l=(typeof n.reducers=="function"?n.reducers($he()):n.reducers)||{},d=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(A,I){const O=typeof A=="string"?A:A.type;if(!O)throw new Error(gi(12));if(O in u.sliceCaseReducersByType)throw new Error(gi(13));return u.sliceCaseReducersByType[O]=I,h},addMatcher(A,I){return u.sliceMatchers.push({matcher:A,reducer:I}),h},exposeAction(A,I){return u.actionCreators[A]=I,h},exposeCaseReducer(A,I){return u.sliceCaseReducersByName[A]=I,h}};d.forEach(A=>{const I=l[A],O={reducerName:A,type:Ihe(i,A),createNotation:typeof n.reducers=="function"};zhe(I)?Fhe(O,I,h,e):Uhe(O,I,h)});function p(){const[A={},I=[],O=void 0]=typeof n.extraReducers=="function"?dD(n.extraReducers):[n.extraReducers],M={...A,...u.sliceCaseReducersByType};return Mhe(n.initialState,E=>{for(let R in M)E.addCase(R,M[R]);for(let R of u.sliceMatchers)E.addMatcher(R.matcher,R.reducer);for(let R of I)E.addMatcher(R.matcher,R.reducer);O&&E.addDefaultCase(O)})}const m=A=>A,x=new Map,b=new WeakMap;let v;function w(A,I){return v||(v=p()),v(A,I)}function k(){return v||(v=p()),v.getInitialState()}function _(A,I=!1){function O(E){let R=E[A];return typeof R>"u"&&I&&(R=Zm(b,O,k)),R}function M(E=m){const R=Zm(x,I,()=>new WeakMap);return Zm(R,E,()=>{const $={};for(const[B,C]of Object.entries(n.selectors??{}))$[B]=Bhe(C,E,()=>Zm(b,E,k),I);return $})}return{reducerPath:A,getSelectors:M,get selectors(){return M(O)},selectSlice:O}}const T={name:i,reducer:w,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:k,..._(a),injectInto(A,{reducerPath:I,...O}={}){const M=I??a;return A.inject({reducerPath:M,reducer:w},O),{...T,..._(M,!0)}}};return T}}function Bhe(t,e,r,n){function i(a,...l){let d=e(a);return typeof d>"u"&&n&&(d=r()),t(d,...l)}return i.unwrapped=t,i}var Ys=Dhe();function $he(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function Uhe({type:t,reducerName:e,createNotation:r},n,i){let a,l;if("reducer"in n){if(r&&!qhe(n))throw new Error(gi(17));a=n.reducer,l=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,l?Yi(t,l):Yi(t))}function zhe(t){return t._reducerDefinitionType==="asyncThunk"}function qhe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Fhe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(gi(18));const{payloadCreator:a,fulfilled:l,pending:d,rejected:u,settled:h,options:p}=r,m=i(t,a,p);n.exposeAction(e,m),l&&n.addCase(m.fulfilled,l),d&&n.addCase(m.pending,d),u&&n.addCase(m.rejected,u),h&&n.addMatcher(m.settled,h),n.exposeCaseReducer(e,{fulfilled:l||eg,pending:d||eg,rejected:u||eg,settled:h||eg})}function eg(){}var Hhe="task",uD="listener",hD="completed",O5="cancelled",Whe=`task-${O5}`,Ghe=`task-${hD}`,fN=`${uD}-${O5}`,Vhe=`${uD}-${hD}`,Cy=class{constructor(t){this.code=t,this.message=`${Hhe} ${O5} (reason: ${t})`}name="TaskAbortError";message},M5=(t,e)=>{if(typeof t!="function")throw new TypeError(gi(32))},px=()=>{},fD=(t,e=px)=>(t.catch(e),t),pD=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),sd=t=>{if(t.aborted)throw new Cy(t.reason)};function mD(t,e){let r=px;return new Promise((n,i)=>{const a=()=>i(new Cy(t.reason));if(t.aborted){a();return}r=pD(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=px})}var Khe=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof Cy?"cancelled":"rejected",error:r}}finally{e?.()}},mx=t=>e=>fD(mD(t,e).then(r=>(sd(t),r))),gD=t=>{const e=mx(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:Fu}=Object,SO={},Ey="listenerMiddleware",Yhe=(t,e)=>{const r=n=>pD(t,()=>n.abort(t.reason));return(n,i)=>{M5(n);const a=new AbortController;r(a);const l=Khe(async()=>{sd(t),sd(a.signal);const d=await n({pause:mx(a.signal),delay:gD(a.signal),signal:a.signal});return sd(a.signal),d},()=>a.abort(Ghe));return i?.autoJoin&&e.push(l.catch(px)),{result:mx(t)(l),cancel(){a.abort(Whe)}}}},Xhe=(t,e)=>{const r=async(n,i)=>{sd(e);let a=()=>{};const d=[new Promise((u,h)=>{let p=t({predicate:n,effect:(m,x)=>{x.unsubscribe(),u([m,x.getState(),x.getOriginalState()])}});a=()=>{p(),h()}})];i!=null&&d.push(new Promise(u=>setTimeout(u,i,null)));try{const u=await mD(e,Promise.race(d));return sd(e),u}finally{a()}};return(n,i)=>fD(r(n,i))},xD=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=Yi(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(gi(21));return M5(a),{predicate:i,type:e,effect:a}},yD=Fu(t=>{const{type:e,predicate:r,effect:n}=xD(t);return{id:Rhe(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(gi(22))}}},{withTypes:()=>yD}),_O=(t,e)=>{const{type:r,effect:n,predicate:i}=xD(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},pN=t=>{t.pending.forEach(e=>{e.abort(fN)})},Jhe=(t,e)=>()=>{for(const r of e.keys())pN(r);t.clear()},CO=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},bD=Fu(Yi(`${Ey}/add`),{withTypes:()=>bD}),Qhe=Yi(`${Ey}/removeAll`),vD=Fu(Yi(`${Ey}/remove`),{withTypes:()=>vD}),Zhe=(...t)=>{console.error(`${Ey}/error`,...t)},G0=(t={})=>{const e=new Map,r=new Map,n=b=>{const v=r.get(b)??0;r.set(b,v+1)},i=b=>{const v=r.get(b)??1;v===1?r.delete(b):r.set(b,v-1)},{extra:a,onError:l=Zhe}=t;M5(l);const d=b=>(b.unsubscribe=()=>e.delete(b.id),e.set(b.id,b),v=>{b.unsubscribe(),v?.cancelActive&&pN(b)}),u=b=>{const v=_O(e,b)??yD(b);return d(v)};Fu(u,{withTypes:()=>u});const h=b=>{const v=_O(e,b);return v&&(v.unsubscribe(),b.cancelActive&&pN(v)),!!v};Fu(h,{withTypes:()=>h});const p=async(b,v,w,k)=>{const _=new AbortController,T=Xhe(u,_.signal),A=[];try{b.pending.add(_),n(b),await Promise.resolve(b.effect(v,Fu({},w,{getOriginalState:k,condition:(I,O)=>T(I,O).then(Boolean),take:T,delay:gD(_.signal),pause:mx(_.signal),extra:a,signal:_.signal,fork:Yhe(_.signal,A),unsubscribe:b.unsubscribe,subscribe:()=>{e.set(b.id,b)},cancelActiveListeners:()=>{b.pending.forEach((I,O,M)=>{I!==_&&(I.abort(fN),M.delete(I))})},cancel:()=>{_.abort(fN),b.pending.delete(_)},throwIfCancelled:()=>{sd(_.signal)}})))}catch(I){I instanceof Cy||CO(l,I,{raisedBy:"effect"})}finally{await Promise.all(A),_.abort(Vhe),i(b),b.pending.delete(_)}},m=Jhe(e,r);return{middleware:b=>v=>w=>{if(!Y7(w))return v(w);if(bD.match(w))return u(w.payload);if(Qhe.match(w)){m();return}if(vD.match(w))return h(w.payload);let k=b.getState();const _=()=>{if(k===SO)throw new Error(gi(23));return k};let T;try{if(T=v(w),e.size>0){const A=b.getState(),I=Array.from(e.values());for(const O of I){let M=!1;try{M=O.predicate(w,A,k)}catch(E){M=!1,CO(l,E,{raisedBy:"predicate"})}M&&p(O,w,b,_)}}}finally{k=SO}return T},startListening:u,stopListening:h,clearListeners:m}};function gi(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var efe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},wD=Ys({name:"chartLayout",initialState:efe,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,i,a;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(i=e.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(a=e.payload.left)!==null&&a!==void 0?a:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:tfe,setLayout:rfe,setChartSize:nfe,setScale:sfe}=wD.actions,ife=wD.reducer;function jD(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Jr(t){return Number.isFinite(t)}function xc(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function EO(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EO(Object(r),!0).forEach(function(n){afe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EO(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function afe(t,e,r){return(e=ofe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ofe(t){var e=lfe(t,"string");return typeof e=="symbol"?e:e+""}function lfe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $r(t,e,r){return zn(t)||zn(e)?r:ro(e)?vd(t,e,r):typeof e=="function"?e(t):r}var cfe=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:l,layout:d}=e;if((d==="vertical"||d==="horizontal"&&l==="middle")&&a!=="center"&&gt(t[a]))return Mu(Mu({},t),{},{[a]:t[a]+(n||0)});if((d==="horizontal"||d==="vertical"&&a==="center")&&l!=="middle"&&gt(t[l]))return Mu(Mu({},t),{},{[l]:t[l]+(i||0)})}return t},Id=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",AO=1e-4,dfe=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-AO,a=Math.max(n[0],n[1])+AO,l=t(e[0]),d=t(e[r-1]);(l<i||l>a||d<i||d>a)&&t.domain([e[0],e[r-1]])}},ufe=(t,e)=>{if(!e||e.length!==2||!gt(e[0])||!gt(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),i=[t[0],t[1]];return(!gt(t[0])||t[0]<r)&&(i[0]=r),(!gt(t[1])||t[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},hfe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,l=0,d=0;d<r;++d){var u=t[d],h=u?.[i];if(h!=null){var p=h[1],m=h[0],x=to(p)?m:p;x>=0?(h[0]=a,h[1]=a+x,a=p):(h[0]=l,h[1]=l+x,l=p)}}}},ffe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,l=0;l<r;++l){var d=t[l],u=d?.[i];if(u!=null){var h=to(u[1])?u[0]:u[1];h>=0?(u[0]=a,u[1]=a+h,a=u[1]):(u[0]=0,u[1]=0)}}}},pfe={sign:hfe,expand:Ode,none:bd,silhouette:Mde,wiggle:Lde,positive:ffe},mfe=(t,e,r)=>{var n,i=(n=pfe[r])!==null&&n!==void 0?n:bd,a=Tde().keys(e).value((d,u)=>Number($r(d,u,0))).order(nN).offset(i),l=a(t);return l.forEach((d,u)=>{d.forEach((h,p)=>{var m=$r(t[p],e[u],0);Array.isArray(m)&&m.length===2&&gt(m[0])&&gt(m[1])&&(h[0]=m[0],h[1]=m[1])})}),l};function gfe(t){return t==null?void 0:String(t)}var TO=t=>{var{axis:e,ticks:r,offset:n,bandSize:i,entry:a,index:l}=t;if(e.type==="category")return r[l]?r[l].coordinate+n:null;var d=$r(a,e.dataKey,e.scale.domain()[l]);return zn(d)?null:e.scale(d)-i/2+n},xfe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},yfe=t=>{var e=t.flat(2).filter(gt);return[Math.min(...e),Math.max(...e)]},bfe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],vfe=(t,e,r)=>{if(t!=null)return bfe(Object.keys(t).reduce((n,i)=>{var a=t[i];if(!a)return n;var{stackedData:l}=a,d=l.reduce((u,h)=>{var p=jD(h,e,r),m=yfe(p);return!Jr(m[0])||!Jr(m[1])?u:[Math.min(u[0],m[0]),Math.max(u[1],m[1])]},[1/0,-1/0]);return[Math.min(d[0],n[0]),Math.max(d[1],n[1])]},[1/0,-1/0]))},OO=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MO=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gx=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=vy(e,p=>p.coordinate),a=1/0,l=1,d=i.length;l<d;l++){var u=i[l],h=i[l-1];a=Math.min((u?.coordinate||0)-(h?.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function LO(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return Mu(Mu({},e),{},{dataKey:r,payload:n,value:i,name:a})}function Ay(t,e){if(t)return String(t);if(typeof e=="string")return e}var wfe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},jfe=(t,e)=>e==="centric"?t.angle:t.radius,fl=t=>t.layout.width,pl=t=>t.layout.height,Nfe=t=>t.layout.scale,ND=t=>t.layout.margin,Ty=we(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Oy=we(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),kD="data-recharts-item-index",SD="data-recharts-item-id",V0=60;function RO(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function tg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RO(Object(r),!0).forEach(function(n){kfe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RO(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kfe(t,e,r){return(e=Sfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sfe(t){var e=_fe(t,"string");return typeof e=="symbol"?e:e+""}function _fe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cfe=t=>t.brush.height;function Efe(t){var e=Oy(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:V0;return r+i}return r},0)}function Afe(t){var e=Oy(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:V0;return r+i}return r},0)}function Tfe(t){var e=Ty(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Ofe(t){var e=Ty(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var En=we([fl,pl,ND,Cfe,Efe,Afe,Tfe,Ofe,W7,rhe],(t,e,r,n,i,a,l,d,u,h)=>{var p={left:(r.left||0)+i,right:(r.right||0)+a},m={top:(r.top||0)+l,bottom:(r.bottom||0)+d},x=tg(tg({},m),p),b=x.bottom;x.bottom+=n,x=cfe(x,u,h);var v=t-x.left-x.right,w=e-x.top-x.bottom;return tg(tg({brushBottom:b},x),{},{width:Math.max(v,0),height:Math.max(w,0)})}),Mfe=we(En,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),L5=we(fl,pl,(t,e)=>({x:0,y:0,width:t,height:e})),Lfe=y.createContext(null),vi=()=>y.useContext(Lfe)!=null,My=t=>t.brush,Ly=we([My,En,ND],(t,e,r)=>({height:t.height,x:gt(t.x)?t.x:e.left,y:gt(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:gt(t.width)?t.width:e.width})),S2={},_2={},C2={},PO;function Rfe(){return PO||(PO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:i,edges:a}={}){let l,d=null;const u=a!=null&&a.includes("leading"),h=a==null||a.includes("trailing"),p=()=>{d!==null&&(r.apply(l,d),l=void 0,d=null)},m=()=>{h&&p(),w()};let x=null;const b=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},n)},v=()=>{x!==null&&(clearTimeout(x),x=null)},w=()=>{v(),l=void 0,d=null},k=()=>{p()},_=function(...T){if(i?.aborted)return;l=this,d=T;const A=x==null;b(),u&&A&&p()};return _.schedule=b,_.cancel=w,_.flush=k,i?.addEventListener("abort",w,{once:!0}),_}t.debounce=e})(C2)),C2}var IO;function Pfe(){return IO||(IO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Rfe();function r(n,i=0,a={}){typeof a!="object"&&(a={});const{leading:l=!1,trailing:d=!0,maxWait:u}=a,h=Array(2);l&&(h[0]="leading"),d&&(h[1]="trailing");let p,m=null;const x=e.debounce(function(...w){p=n.apply(this,w),m=null},i,{edges:h}),b=function(...w){return u!=null&&(m===null&&(m=Date.now()),Date.now()-m>=u)?(p=n.apply(this,w),m=Date.now(),x.cancel(),x.schedule(),p):(x.apply(this,w),p)},v=()=>(x.flush(),p);return b.cancel=x.cancel,b.flush=v,b}t.debounce=r})(_2)),_2}var DO;function Ife(){return DO||(DO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pfe();function r(n,i=0,a={}){const{leading:l=!0,trailing:d=!0}=a;return e.debounce(n,i,{leading:l,maxWait:i,trailing:d})}t.throttle=r})(S2)),S2}var E2,BO;function Dfe(){return BO||(BO=1,E2=Ife().throttle),E2}var Bfe=Dfe();const $fe=Ms(Bfe);var $O=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=0;console.warn(r.replace(/%s/g,()=>i[l++]))}},_D=(t,e,r)=>{var{width:n="100%",height:i="100%",aspect:a,maxHeight:l}=r,d=Zo(n)?t:Number(n),u=Zo(i)?e:Number(i);return a&&a>0&&(d?u=d/a:u&&(d=u*a),l&&u!=null&&u>l&&(u=l)),{calculatedWidth:d,calculatedHeight:u}},Ufe={width:0,height:0,overflow:"visible"},zfe={width:0,overflowX:"visible"},qfe={height:0,overflowY:"visible"},Ffe={},Hfe=t=>{var{width:e,height:r}=t,n=Zo(e),i=Zo(r);return n&&i?Ufe:n?zfe:i?qfe:Ffe};function Wfe(t){var{width:e,height:r,aspect:n}=t,i=e,a=r;return i===void 0&&a===void 0?(i="100%",a="100%"):i===void 0?i=n&&n>0?void 0:"100%":a===void 0&&(a=n&&n>0?void 0:"100%"),{width:i,height:a}}function mN(){return mN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mN.apply(null,arguments)}function UO(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UO(Object(r),!0).forEach(function(n){Gfe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UO(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Gfe(t,e,r){return(e=Vfe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vfe(t){var e=Kfe(t,"string");return typeof e=="symbol"?e:e+""}function Kfe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CD=y.createContext({width:-1,height:-1});function Yfe(t){return xc(t.width)&&xc(t.height)}function ED(t){var{children:e,width:r,height:n}=t,i=y.useMemo(()=>({width:r,height:n}),[r,n]);return Yfe(i)?y.createElement(CD.Provider,{value:i},e):null}var R5=()=>y.useContext(CD),Xfe=y.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i,height:a,minWidth:l=0,minHeight:d,maxHeight:u,children:h,debounce:p=0,id:m,className:x,onResize:b,style:v={}}=t,w=y.useRef(null),k=y.useRef();k.current=b,y.useImperativeHandle(e,()=>w.current);var[_,T]=y.useState({containerWidth:n.width,containerHeight:n.height}),A=y.useCallback((R,$)=>{T(B=>{var C=Math.round(R),U=Math.round($);return B.containerWidth===C&&B.containerHeight===U?B:{containerWidth:C,containerHeight:U}})},[]);y.useEffect(()=>{if(w.current==null||typeof ResizeObserver>"u")return q0;var R=U=>{var L,{width:q,height:K}=U[0].contentRect;A(q,K),(L=k.current)===null||L===void 0||L.call(k,q,K)};p>0&&(R=$fe(R,p,{trailing:!0,leading:!1}));var $=new ResizeObserver(R),{width:B,height:C}=w.current.getBoundingClientRect();return A(B,C),$.observe(w.current),()=>{$.disconnect()}},[A,p]);var{containerWidth:I,containerHeight:O}=_;$O(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:M,calculatedHeight:E}=_D(I,O,{width:i,height:a,aspect:r,maxHeight:u});return $O(M!=null&&M>0||E!=null&&E>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,M,E,i,a,l,d,r),y.createElement("div",{id:m?"".concat(m):void 0,className:gr("recharts-responsive-container",x),style:zO(zO({},v),{},{width:i,height:a,minWidth:l,minHeight:d,maxHeight:u}),ref:w},y.createElement("div",{style:Hfe({width:i,height:a})},y.createElement(ED,{width:M,height:E},h)))}),qO=y.forwardRef((t,e)=>{var r=R5();if(xc(r.width)&&xc(r.height))return t.children;var{width:n,height:i}=Wfe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:a,calculatedHeight:l}=_D(void 0,void 0,{width:n,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return gt(a)&&gt(l)?y.createElement(ED,{width:a,height:l},t.children):y.createElement(Xfe,mN({},t,{width:n,height:i,ref:e}))});function AD(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var Ry=()=>{var t,e=vi(),r=ft(Mfe),n=ft(Ly),i=(t=ft(My))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},Jfe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Qfe=()=>{var t;return(t=ft(En))!==null&&t!==void 0?t:Jfe},TD=()=>ft(fl),OD=()=>ft(pl),Zfe=()=>ft(t=>t.layout.margin),ar=t=>t.layout.layoutType,K0=()=>ft(ar),e0e=()=>{var t=K0();return t!==void 0},Py=t=>{var e=Or(),r=vi(),{width:n,height:i}=t,a=R5(),l=n,d=i;return a&&(l=a.width>0?a.width:n,d=a.height>0?a.height:i),y.useEffect(()=>{!r&&xc(l)&&xc(d)&&e(nfe({width:l,height:d}))},[e,r,l,d]),null},MD=Symbol.for("immer-nothing"),FO=Symbol.for("immer-draftable"),xi=Symbol.for("immer-state");function ga(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var u0=Object.getPrototypeOf;function Ju(t){return!!t&&!!t[xi]}function jd(t){return t?LD(t)||Array.isArray(t)||!!t[FO]||!!t.constructor?.[FO]||Y0(t)||Dy(t):!1}var t0e=Object.prototype.constructor.toString(),HO=new WeakMap;function LD(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=HO.get(r);return n===void 0&&(n=Function.toString.call(r),HO.set(r,n)),n===t0e}function xx(t,e,r=!0){Iy(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((n,i)=>e(i,n,t))}function Iy(t){const e=t[xi];return e?e.type_:Array.isArray(t)?1:Y0(t)?2:Dy(t)?3:0}function gN(t,e){return Iy(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function RD(t,e,r){const n=Iy(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function r0e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Y0(t){return t instanceof Map}function Dy(t){return t instanceof Set}function Vc(t){return t.copy_||t.base_}function xN(t,e){if(Y0(t))return new Map(t);if(Dy(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=LD(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[xi];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const l=i[a],d=n[l];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(n[l]={configurable:!0,writable:!0,enumerable:d.enumerable,value:t[l]})}return Object.create(u0(t),n)}else{const n=u0(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function P5(t,e=!1){return By(t)||Ju(t)||!jd(t)||(Iy(t)>1&&Object.defineProperties(t,{set:rg,add:rg,clear:rg,delete:rg}),Object.freeze(t),e&&Object.values(t).forEach(r=>P5(r,!0))),t}function n0e(){ga(2)}var rg={value:n0e};function By(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var s0e={};function Nd(t){const e=s0e[t];return e||ga(0,t),e}var h0;function PD(){return h0}function i0e(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function WO(t,e){e&&(Nd("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function yN(t){bN(t),t.drafts_.forEach(a0e),t.drafts_=null}function bN(t){t===h0&&(h0=t.parent_)}function GO(t){return h0=i0e(h0,t)}function a0e(t){const e=t[xi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function VO(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[xi].modified_&&(yN(e),ga(4)),jd(t)&&(t=yx(e,t),e.parent_||bx(e,t)),e.patches_&&Nd("Patches").generateReplacementPatches_(r[xi].base_,t,e.patches_,e.inversePatches_)):t=yx(e,r,[]),yN(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==MD?t:void 0}function yx(t,e,r){if(By(e))return e;const n=t.immer_.shouldUseStrictIteration(),i=e[xi];if(!i)return xx(e,(a,l)=>KO(t,i,e,a,l,r),n),e;if(i.scope_!==t)return e;if(!i.modified_)return bx(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const a=i.copy_;let l=a,d=!1;i.type_===3&&(l=new Set(a),a.clear(),d=!0),xx(l,(u,h)=>KO(t,i,a,u,h,r,d),n),bx(t,a,!1),r&&t.patches_&&Nd("Patches").generatePatches_(i,r,t.patches_,t.inversePatches_)}return i.copy_}function KO(t,e,r,n,i,a,l){if(i==null||typeof i!="object"&&!l)return;const d=By(i);if(!(d&&!l)){if(Ju(i)){const u=a&&e&&e.type_!==3&&!gN(e.assigned_,n)?a.concat(n):void 0,h=yx(t,i,u);if(RD(r,n,h),Ju(h))t.canAutoFreeze_=!1;else return}else l&&r.add(i);if(jd(i)&&!d){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===i&&d)return;yx(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(Y0(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&bx(t,i)}}}function bx(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&P5(e,r)}function o0e(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:PD(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=I5;r&&(i=[n],a=f0);const{revoke:l,proxy:d}=Proxy.revocable(i,a);return n.draft_=d,n.revoke_=l,d}var I5={get(t,e){if(e===xi)return t;const r=Vc(t);if(!gN(r,e))return l0e(t,r,e);const n=r[e];return t.finalized_||!jd(n)?n:n===A2(t.base_,e)?(T2(t),t.copy_[e]=wN(n,t)):n},has(t,e){return e in Vc(t)},ownKeys(t){return Reflect.ownKeys(Vc(t))},set(t,e,r){const n=ID(Vc(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=A2(Vc(t),e),a=i?.[xi];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(r0e(r,i)&&(r!==void 0||gN(t.base_,e)))return!0;T2(t),vN(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return A2(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,T2(t),vN(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Vc(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){ga(11)},getPrototypeOf(t){return u0(t.base_)},setPrototypeOf(){ga(12)}},f0={};xx(I5,(t,e)=>{f0[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});f0.deleteProperty=function(t,e){return f0.set.call(this,t,e,void 0)};f0.set=function(t,e,r){return I5.set.call(this,t[0],e,r,t[0])};function A2(t,e){const r=t[xi];return(r?Vc(r):t)[e]}function l0e(t,e,r){const n=ID(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function ID(t,e){if(!(e in t))return;let r=u0(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=u0(r)}}function vN(t){t.modified_||(t.modified_=!0,t.parent_&&vN(t.parent_))}function T2(t){t.copy_||(t.copy_=xN(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var c0e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const l=this;return function(u=a,...h){return l.produce(u,p=>r.call(this,p,...h))}}typeof r!="function"&&ga(6),n!==void 0&&typeof n!="function"&&ga(7);let i;if(jd(e)){const a=GO(this),l=wN(e,void 0);let d=!0;try{i=r(l),d=!1}finally{d?yN(a):bN(a)}return WO(a,n),VO(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===MD&&(i=void 0),this.autoFreeze_&&P5(i,!0),n){const a=[],l=[];Nd("Patches").generateReplacementPatches_(e,i,a,l),n(a,l)}return i}else ga(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(l,...d)=>this.produceWithPatches(l,u=>e(u,...d));let n,i;return[this.produce(e,r,(l,d)=>{n=l,i=d}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){jd(t)||ga(8),Ju(t)&&(t=d0e(t));const e=GO(this),r=wN(t,void 0);return r[xi].isManual_=!0,bN(e),r}finishDraft(t,e){const r=t&&t[xi];(!r||!r.isManual_)&&ga(9);const{scope_:n}=r;return WO(n,e),VO(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=Nd("Patches").applyPatches_;return Ju(t)?n(t,e):this.produce(t,i=>n(i,e))}};function wN(t,e){const r=Y0(t)?Nd("MapSet").proxyMap_(t,e):Dy(t)?Nd("MapSet").proxySet_(t,e):o0e(t,e);return(e?e.scope_:PD()).drafts_.push(r),r}function d0e(t){return Ju(t)||ga(10,t),DD(t)}function DD(t){if(!jd(t)||By(t))return t;const e=t[xi];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=xN(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=xN(t,!0);return xx(r,(i,a)=>{RD(r,i,DD(a))},n),e&&(e.finalized_=!1),r}var u0e=new c0e;u0e.produce;var h0e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},BD=Ys({name:"legend",initialState:h0e,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Wr()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,i=Na(t).payload.indexOf(r);i>-1&&(t.payload[i]=n)},prepare:Wr()},removeLegendPayload:{reducer(t,e){var r=Na(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Wr()}}}),{setLegendSize:YO,setLegendSettings:f0e,addLegendPayload:$D,replaceLegendPayload:UD,removeLegendPayload:zD}=BD.actions,p0e=BD.reducer,m0e=["contextPayload"];function jN(){return jN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jN.apply(null,arguments)}function XO(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Qu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XO(Object(r),!0).forEach(function(n){g0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XO(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g0e(t,e,r){return(e=x0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x0e(t){var e=y0e(t,"string");return typeof e=="symbol"?e:e+""}function y0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b0e(t,e){if(t==null)return{};var r,n,i=v0e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function v0e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function w0e(t){return t.value}function j0e(t){var{contextPayload:e}=t,r=b0e(t,m0e),n=z7(e,t.payloadUniqBy,w0e),i=Qu(Qu({},r),{},{payload:n});return y.isValidElement(t.content)?y.cloneElement(t.content,i):typeof t.content=="function"?y.createElement(t.content,i):y.createElement(uue,i)}function N0e(t,e,r,n,i,a){var{layout:l,align:d,verticalAlign:u}=e,h,p;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(d==="center"&&l==="vertical"?h={left:((n||0)-a.width)/2}:h=d==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(u==="middle"?p={top:((i||0)-a.height)/2}:p=u==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Qu(Qu({},h),p)}function k0e(t){var e=Or();return y.useEffect(()=>{e(f0e(t))},[e,t]),null}function S0e(t){var e=Or();return y.useEffect(()=>(e(YO(t)),()=>{e(YO({width:0,height:0}))}),[e,t]),null}function _0e(t,e,r,n){return t==="vertical"&&gt(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var C0e={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function qD(t){var e=ss(t,C0e),r=ihe(),n=ede(),i=Zfe(),{width:a,height:l,wrapperStyle:d,portal:u}=e,[h,p]=G7([r]),m=TD(),x=OD();if(m==null||x==null)return null;var b=m-(i?.left||0)-(i?.right||0),v=_0e(e.layout,l,a,b),w=u?d:Qu(Qu({position:"absolute",width:v?.width||a||"auto",height:v?.height||l||"auto"},N0e(d,e,i,m,x,h)),d),k=u??n;if(k==null||r==null)return null;var _=y.createElement("div",{className:"recharts-legend-wrapper",style:w,ref:p},y.createElement(k0e,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!u&&y.createElement(S0e,{width:h.width,height:h.height}),y.createElement(j0e,jN({},e,v,{margin:i,chartWidth:m,chartHeight:x,contextPayload:r})));return ln.createPortal(_,k)}qD.displayName="Legend";function NN(){return NN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NN.apply(null,arguments)}function JO(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function O2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JO(Object(r),!0).forEach(function(n){E0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JO(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function E0e(t,e,r){return(e=A0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A0e(t){var e=T0e(t,"string");return typeof e=="symbol"?e:e+""}function T0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function O0e(t){return Array.isArray(t)&&ro(t[0])&&ro(t[1])?t.join(" ~ "):t}var M0e=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:l,itemSorter:d,wrapperClassName:u,labelClassName:h,label:p,labelFormatter:m,accessibilityLayer:x=!1}=t,b=()=>{if(a&&a.length){var O={padding:0,margin:0},M=(d?vy(a,d):a).map((E,R)=>{if(E.type==="none")return null;var $=E.formatter||l||O0e,{value:B,name:C}=E,U=B,L=C;if($){var q=$(B,C,E,R,a);if(Array.isArray(q))[U,L]=q;else if(q!=null)U=q;else return null}var K=O2({display:"block",paddingTop:4,paddingBottom:4,color:E.color||"#000"},n);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:K},ro(L)?y.createElement("span",{className:"recharts-tooltip-item-name"},L):null,ro(L)?y.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,y.createElement("span",{className:"recharts-tooltip-item-value"},U),y.createElement("span",{className:"recharts-tooltip-item-unit"},E.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:O},M)}return null},v=O2({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),w=O2({margin:0},i),k=!zn(p),_=k?p:"",T=gr("recharts-default-tooltip",u),A=gr("recharts-tooltip-label",h);k&&m&&a!==void 0&&a!==null&&(_=m(p,a));var I=x?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",NN({className:T,style:v},I),y.createElement("p",{className:A,style:w},y.isValidElement(_)?_:"".concat(_)),b())},gf="recharts-tooltip-wrapper",L0e={visibility:"hidden"};function R0e(t){var{coordinate:e,translateX:r,translateY:n}=t;return gr(gf,{["".concat(gf,"-right")]:gt(r)&&e&&gt(e.x)&&r>=e.x,["".concat(gf,"-left")]:gt(r)&&e&&gt(e.x)&&r<e.x,["".concat(gf,"-bottom")]:gt(n)&&e&&gt(e.y)&&n>=e.y,["".concat(gf,"-top")]:gt(n)&&e&&gt(e.y)&&n<e.y})}function QO(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:l,tooltipDimension:d,viewBox:u,viewBoxDimension:h}=t;if(a&&gt(a[n]))return a[n];var p=r[n]-d-(i>0?i:0),m=r[n]+i;if(e[n])return l[n]?p:m;var x=u[n];if(x==null)return 0;if(l[n]){var b=p,v=x;return b<v?Math.max(m,x):Math.max(p,x)}if(h==null)return 0;var w=m+d,k=x+h;return w>k?Math.max(p,x):Math.max(m,x)}function P0e(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function I0e(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:l,useTranslate3d:d,viewBox:u}=t,h,p,m;return l.height>0&&l.width>0&&r?(p=QO({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),m=QO({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),h=P0e({translateX:p,translateY:m,useTranslate3d:d})):h=L0e,{cssProperties:h,cssClasses:R0e({translateX:p,translateY:m,coordinate:r})}}function ZO(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ng(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZO(Object(r),!0).forEach(function(n){kN(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZO(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kN(t,e,r){return(e=D0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D0e(t){var e=B0e(t,"string");return typeof e=="symbol"?e:e+""}function B0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $0e extends y.PureComponent{constructor(){super(...arguments),kN(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),kN(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:l,hasPayload:d,isAnimationActive:u,offset:h,position:p,reverseDirection:m,useTranslate3d:x,viewBox:b,wrapperStyle:v,lastBoundingBox:w,innerRef:k,hasPortalFromProps:_}=this.props,{cssClasses:T,cssProperties:A}=I0e({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:h,position:p,reverseDirection:m,tooltipBox:{height:w.height,width:w.width},useTranslate3d:x,viewBox:b}),I=_?{}:ng(ng({transition:u&&e?"transform ".concat(n,"ms ").concat(i):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&d?"visible":"hidden",position:"absolute",top:0,left:0}),O=ng(ng({},I),{},{visibility:!this.state.dismissed&&e&&d?"visible":"hidden"},v);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:O,ref:k},a)}}var FD=()=>{var t;return(t=ft(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function SN(){return SN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},SN.apply(null,arguments)}function eM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function tM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eM(Object(r),!0).forEach(function(n){U0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function U0e(t,e,r){return(e=z0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z0e(t){var e=q0e(t,"string");return typeof e=="symbol"?e:e+""}function q0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rM={curveBasisClosed:bde,curveBasisOpen:vde,curveBasis:yde,curveBumpX:sde,curveBumpY:ide,curveLinearClosed:wde,curveLinear:yy,curveMonotoneX:jde,curveMonotoneY:Nde,curveNatural:kde,curveStep:Sde,curveStepAfter:Cde,curveStepBefore:_de},vx=t=>Jr(t.x)&&Jr(t.y),nM=t=>t.base!=null&&vx(t.base)&&vx(t),xf=t=>t.x,yf=t=>t.y,F0e=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(z0(t));return(r==="curveMonotone"||r==="curveBump")&&e?rM["".concat(r).concat(e==="vertical"?"Y":"X")]:rM[r]||yy},H0e=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,l=F0e(e,i),d=a?r.filter(vx):r,u;if(Array.isArray(n)){var h=r.map((b,v)=>tM(tM({},b),{},{base:n[v]}));i==="vertical"?u=Ym().y(yf).x1(xf).x0(b=>b.base.x):u=Ym().x(xf).y1(yf).y0(b=>b.base.y);var p=u.defined(nM).curve(l),m=a?h.filter(nM):h;return p(m)}i==="vertical"&&gt(n)?u=Ym().y(yf).x1(xf).x0(n):gt(n)?u=Ym().x(xf).y1(yf).y0(n):u=x7().x(xf).y(yf);var x=u.defined(vx).curve(l);return x(d)},D5=t=>{var{className:e,points:r,path:n,pathRef:i}=t,a=K0();if((!r||!r.length)&&!n)return null;var l={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||a,connectNulls:t.connectNulls},d=r&&r.length?H0e(l):n;return y.createElement("path",SN({},eo(t),Qde(t),{className:gr("recharts-curve",e),d:d===null?void 0:d,ref:i}))},W0e=["x","y","top","left","width","height","className"];function _N(){return _N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_N.apply(null,arguments)}function sM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function G0e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sM(Object(r),!0).forEach(function(n){V0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function V0e(t,e,r){return(e=K0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K0e(t){var e=Y0e(t,"string");return typeof e=="symbol"?e:e+""}function Y0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X0e(t,e){if(t==null)return{};var r,n,i=J0e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function J0e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Q0e=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),Z0e=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:l=0,className:d}=t,u=X0e(t,W0e),h=G0e({x:e,y:r,top:n,left:i,width:a,height:l},u);return!gt(e)||!gt(r)||!gt(a)||!gt(l)||!gt(n)||!gt(i)?null:y.createElement("path",_N({},Ki(h),{className:gr("recharts-cross",d),d:Q0e(e,r,a,l,n,i)}))};function epe(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function iM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function aM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iM(Object(r),!0).forEach(function(n){tpe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tpe(t,e,r){return(e=rpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rpe(t){var e=npe(t,"string");return typeof e=="symbol"?e:e+""}function npe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var spe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),HD=(t,e,r)=>t.map(n=>"".concat(spe(n)," ").concat(e,"ms ").concat(r)).join(","),ipe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),p0=(t,e)=>Object.keys(e).reduce((r,n)=>aM(aM({},r),{},{[n]:t(n,e[n])}),{});function oM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Cn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oM(Object(r),!0).forEach(function(n){ape(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ape(t,e,r){return(e=ope(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ope(t){var e=lpe(t,"string");return typeof e=="symbol"?e:e+""}function lpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wx=(t,e,r)=>t+(e-t)*r,CN=t=>{var{from:e,to:r}=t;return e!==r},WD=(t,e,r)=>{var n=p0((i,a)=>{if(CN(a)){var[l,d]=t(a.from,a.to,a.velocity);return Cn(Cn({},a),{},{from:l,velocity:d})}return a},e);return r<1?p0((i,a)=>CN(a)&&n[i]!=null?Cn(Cn({},a),{},{velocity:wx(a.velocity,n[i].velocity,r),from:wx(a.from,n[i].from,r)}):a,e):WD(t,n,r-1)};function cpe(t,e,r,n,i,a){var l,d=n.reduce((x,b)=>Cn(Cn({},x),{},{[b]:{from:t[b],velocity:0,to:e[b]}}),{}),u=()=>p0((x,b)=>b.from,d),h=()=>!Object.values(d).filter(CN).length,p=null,m=x=>{l||(l=x);var b=x-l,v=b/r.dt;d=WD(r,d,v),i(Cn(Cn(Cn({},t),e),u())),l=x,h()||(p=a.setTimeout(m))};return()=>(p=a.setTimeout(m),()=>{var x;(x=p)===null||x===void 0||x()})}function dpe(t,e,r,n,i,a,l){var d=null,u=i.reduce((m,x)=>{var b=t[x],v=e[x];return b==null||v==null?m:Cn(Cn({},m),{},{[x]:[b,v]})},{}),h,p=m=>{h||(h=m);var x=(m-h)/n,b=p0((w,k)=>wx(...k,r(x)),u);if(a(Cn(Cn(Cn({},t),e),b)),x<1)d=l.setTimeout(p);else{var v=p0((w,k)=>wx(...k,r(1)),u);a(Cn(Cn(Cn({},t),e),v))}};return()=>(d=l.setTimeout(p),()=>{var m;(m=d)===null||m===void 0||m()})}const upe=(t,e,r,n,i,a)=>{var l=ipe(t,e);return r==null?()=>(i(Cn(Cn({},t),e)),()=>{}):r.isStepper===!0?cpe(t,e,r,l,i,a):dpe(t,e,r,n,l,i,a)};var jx=1e-4,GD=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],VD=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),lM=(t,e)=>r=>{var n=GD(t,e);return VD(n,r)},hpe=(t,e)=>r=>{var n=GD(t,e),i=[...n.map((a,l)=>a*l).slice(1),0];return VD(i,r)},fpe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var i=n.map(a=>parseFloat(a));return[i[0],i[1],i[2],i[3]]},ppe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=fpe(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},mpe=(t,e,r,n)=>{var i=lM(t,r),a=lM(e,n),l=hpe(t,r),d=h=>h>1?1:h<0?0:h,u=h=>{for(var p=h>1?1:h,m=p,x=0;x<8;++x){var b=i(m)-p,v=l(m);if(Math.abs(b-p)<jx||v<jx)return a(m);m=d(m-b/v)}return a(m)};return u.isStepper=!1,u},cM=function(){return mpe(...ppe(...arguments))},gpe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(l,d,u)=>{var h=-(l-d)*r,p=u*n,m=u+(h-p)*i/1e3,x=u*i/1e3+l;return Math.abs(x-d)<jx&&Math.abs(m)<jx?[d,0]:[x,m]};return a.isStepper=!0,a.dt=i,a},xpe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return cM(t);case"spring":return gpe();default:if(t.split("(")[0]==="cubic-bezier")return cM(t)}return typeof t=="function"?t:null};function ype(t){var e,r=()=>null,n=!1,i=null,a=l=>{if(!n){if(Array.isArray(l)){if(!l.length)return;var d=l,[u,...h]=d;if(typeof u=="number"){i=t.setTimeout(a.bind(null,h),u);return}a(u),i=t.setTimeout(a.bind(null,h));return}typeof l=="string"&&(e=l,r(e)),typeof l=="object"&&(e=l,r(e)),typeof l=="function"&&l()}};return{stop:()=>{n=!0},start:l=>{n=!1,i&&(i(),i=null),a(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>t}}class bpe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=l=>{l-n>=r?e(l):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{i!=null&&cancelAnimationFrame(i)}}}function vpe(){return ype(new bpe)}var wpe=y.createContext(vpe);function jpe(t,e){var r=y.useContext(wpe);return y.useMemo(()=>e??r(t),[t,e,r])}var Npe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),$y={isSsr:Npe()},kpe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},dM={t:0},M2={t:1};function Uy(t){var e=ss(t,kpe),{isActive:r,canBegin:n,duration:i,easing:a,begin:l,onAnimationEnd:d,onAnimationStart:u,children:h}=e,p=r==="auto"?!$y.isSsr:r,m=jpe(e.animationId,e.animationManager),[x,b]=y.useState(p?dM:M2),v=y.useRef(null);return y.useEffect(()=>{p||b(M2)},[p]),y.useEffect(()=>{if(!p||!n)return q0;var w=upe(dM,M2,xpe(a),i,b,m.getTimeoutController()),k=()=>{v.current=w()};return m.start([u,l,k,i,d]),()=>{m.stop(),v.current&&v.current(),d()}},[p,n,i,a,l,u,d,m]),h(x.t)}function zy(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=y.useRef(o0(e)),n=y.useRef(t);return n.current!==t&&(r.current=o0(e),n.current=t),r.current}var Spe=["radius"],_pe=["radius"],uM,hM,fM,pM,mM,gM,xM,yM,bM,vM;function wM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wM(Object(r),!0).forEach(function(n){Cpe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Cpe(t,e,r){return(e=Epe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Epe(t){var e=Ape(t,"string");return typeof e=="symbol"?e:e+""}function Ape(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nx(){return Nx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nx.apply(null,arguments)}function NM(t,e){if(t==null)return{};var r,n,i=Tpe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Tpe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function qa(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var kM=(t,e,r,n,i)=>{var a=ic(r),l=ic(n),d=Math.min(Math.abs(a)/2,Math.abs(l)/2),u=l>=0?1:-1,h=a>=0?1:-1,p=l>=0&&a>=0||l<0&&a<0?1:0,m;if(d>0&&i instanceof Array){for(var x=[0,0,0,0],b=0,v=4;b<v;b++)x[b]=i[b]>d?d:i[b];m=sn(uM||(uM=qa(["M",",",""])),t,e+u*x[0]),x[0]>0&&(m+=sn(hM||(hM=qa(["A ",",",",0,0,",",",",",""])),x[0],x[0],p,t+h*x[0],e)),m+=sn(fM||(fM=qa(["L ",",",""])),t+r-h*x[1],e),x[1]>0&&(m+=sn(pM||(pM=qa(["A ",",",",0,0,",`,
        `,",",""])),x[1],x[1],p,t+r,e+u*x[1])),m+=sn(mM||(mM=qa(["L ",",",""])),t+r,e+n-u*x[2]),x[2]>0&&(m+=sn(gM||(gM=qa(["A ",",",",0,0,",`,
        `,",",""])),x[2],x[2],p,t+r-h*x[2],e+n)),m+=sn(xM||(xM=qa(["L ",",",""])),t+h*x[3],e+n),x[3]>0&&(m+=sn(yM||(yM=qa(["A ",",",",0,0,",`,
        `,",",""])),x[3],x[3],p,t,e+n-u*x[3])),m+="Z"}else if(d>0&&i===+i&&i>0){var w=Math.min(d,i);m=sn(bM||(bM=qa(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+u*w,w,w,p,t+h*w,e,t+r-h*w,e,w,w,p,t+r,e+u*w,t+r,e+n-u*w,w,w,p,t+r-h*w,e+n,t+h*w,e+n,w,w,p,t,e+n-u*w)}else m=sn(vM||(vM=qa(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return m},SM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},KD=t=>{var e=ss(t,SM),r=y.useRef(null),[n,i]=y.useState(-1);y.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var V=r.current.getTotalLength();V&&i(V)}catch{}},[]);var{x:a,y:l,width:d,height:u,radius:h,className:p}=e,{animationEasing:m,animationDuration:x,animationBegin:b,isAnimationActive:v,isUpdateAnimationActive:w}=e,k=y.useRef(d),_=y.useRef(u),T=y.useRef(a),A=y.useRef(l),I=y.useMemo(()=>({x:a,y:l,width:d,height:u,radius:h}),[a,l,d,u,h]),O=zy(I,"rectangle-");if(a!==+a||l!==+l||d!==+d||u!==+u||d===0||u===0)return null;var M=gr("recharts-rectangle",p);if(!w){var E=Ki(e),{radius:R}=E,$=NM(E,Spe);return y.createElement("path",Nx({},$,{x:ic(a),y:ic(l),width:ic(d),height:ic(u),radius:typeof h=="number"?h:void 0,className:M,d:kM(a,l,d,u,h)}))}var B=k.current,C=_.current,U=T.current,L=A.current,q="0px ".concat(n===-1?1:n,"px"),K="".concat(n,"px 0px"),W=HD(["strokeDasharray"],x,typeof m=="string"?m:SM.animationEasing);return y.createElement(Uy,{animationId:O,key:O,canBegin:n>0,duration:x,easing:m,isActive:w,begin:b},V=>{var X=_n(B,d,V),Z=_n(C,u,V),G=_n(U,a,V),F=_n(L,l,V);r.current&&(k.current=X,_.current=Z,T.current=G,A.current=F);var Y;v?V>0?Y={transition:W,strokeDasharray:K}:Y={strokeDasharray:q}:Y={strokeDasharray:K};var ne=Ki(e),{radius:re}=ne,ue=NM(ne,_pe);return y.createElement("path",Nx({},ue,{radius:typeof h=="number"?h:void 0,className:M,d:kM(G,F,X,Z,h),ref:r,style:jM(jM({},Y),e.style)}))})};function _M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function CM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_M(Object(r),!0).forEach(function(n){Ope(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_M(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ope(t,e,r){return(e=Mpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mpe(t){var e=Lpe(t,"string");return typeof e=="symbol"?e:e+""}function Lpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kx=Math.PI/180,Rpe=t=>t*180/Math.PI,Nn=(t,e,r,n)=>({x:t+Math.cos(-kx*n)*r,y:e+Math.sin(-kx*n)*r}),YD=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Ppe=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},Ipe=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,l=Ppe({x:r,y:n},{x:i,y:a});if(l<=0)return{radius:l,angle:0};var d=(r-i)/l,u=Math.acos(d);return n>a&&(u=2*Math.PI-u),{radius:l,angle:Rpe(u),angleInRadian:u}},Dpe=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},Bpe=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),l=Math.min(i,a);return t+l*360},$pe=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:i,angle:a}=Ipe({x:r,y:n},e),{innerRadius:l,outerRadius:d}=e;if(i<l||i>d||i===0)return null;var{startAngle:u,endAngle:h}=Dpe(e),p=a,m;if(u<=h){for(;p>h;)p-=360;for(;p<u;)p+=360;m=p>=u&&p<=h}else{for(;p>u;)p-=360;for(;p<h;)p+=360;m=p>=h&&p<=u}return m?CM(CM({},e),{},{radius:i,angle:Bpe(p,e)}):null};function XD(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,l=Nn(e,r,n,i),d=Nn(e,r,n,a);return{points:[l,d],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}var EM,AM,TM,OM,MM,LM,RM;function EN(){return EN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EN.apply(null,arguments)}function Zc(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Upe=(t,e)=>{var r=rs(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},sg=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:l,cornerRadius:d,cornerIsExternal:u}=t,h=d*(l?1:-1)+n,p=Math.asin(d/h)/kx,m=u?i:i+a*p,x=Nn(e,r,h,m),b=Nn(e,r,n,m),v=u?i-a*p:i,w=Nn(e,r,h*Math.cos(p*kx),v);return{center:x,circleTangency:b,lineTangency:w,theta:p}},JD=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:l}=t,d=Upe(a,l),u=a+d,h=Nn(e,r,i,a),p=Nn(e,r,i,u),m=sn(EM||(EM=Zc(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),h.x,h.y,i,i,+(Math.abs(d)>180),+(a>u),p.x,p.y);if(n>0){var x=Nn(e,r,n,a),b=Nn(e,r,n,u);m+=sn(AM||(AM=Zc(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),b.x,b.y,n,n,+(Math.abs(d)>180),+(a<=u),x.x,x.y)}else m+=sn(TM||(TM=Zc(["L ",","," Z"])),e,r);return m},zpe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:l,cornerIsExternal:d,startAngle:u,endAngle:h}=t,p=rs(h-u),{circleTangency:m,lineTangency:x,theta:b}=sg({cx:e,cy:r,radius:i,angle:u,sign:p,cornerRadius:a,cornerIsExternal:d}),{circleTangency:v,lineTangency:w,theta:k}=sg({cx:e,cy:r,radius:i,angle:h,sign:-p,cornerRadius:a,cornerIsExternal:d}),_=d?Math.abs(u-h):Math.abs(u-h)-b-k;if(_<0)return l?sn(OM||(OM=Zc(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),x.x,x.y,a,a,a*2,a,a,-a*2):JD({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:u,endAngle:h});var T=sn(MM||(MM=Zc(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),x.x,x.y,a,a,+(p<0),m.x,m.y,i,i,+(_>180),+(p<0),v.x,v.y,a,a,+(p<0),w.x,w.y);if(n>0){var{circleTangency:A,lineTangency:I,theta:O}=sg({cx:e,cy:r,radius:n,angle:u,sign:p,isExternal:!0,cornerRadius:a,cornerIsExternal:d}),{circleTangency:M,lineTangency:E,theta:R}=sg({cx:e,cy:r,radius:n,angle:h,sign:-p,isExternal:!0,cornerRadius:a,cornerIsExternal:d}),$=d?Math.abs(u-h):Math.abs(u-h)-O-R;if($<0&&a===0)return"".concat(T,"L").concat(e,",").concat(r,"Z");T+=sn(LM||(LM=Zc(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),E.x,E.y,a,a,+(p<0),M.x,M.y,n,n,+($>180),+(p>0),A.x,A.y,a,a,+(p<0),I.x,I.y)}else T+=sn(RM||(RM=Zc(["L",",","Z"])),e,r);return T},qpe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},QD=t=>{var e=ss(t,qpe),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:l,forceCornerRadius:d,cornerIsExternal:u,startAngle:h,endAngle:p,className:m}=e;if(a<i||h===p)return null;var x=gr("recharts-sector",m),b=a-i,v=xs(l,b,0,!0),w;return v>0&&Math.abs(h-p)<360?w=zpe({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(v,b/2),forceCornerRadius:d,cornerIsExternal:u,startAngle:h,endAngle:p}):w=JD({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:h,endAngle:p}),y.createElement("path",EN({},Ki(e),{className:x,d:w}))};function Fpe(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(O7(e)){if(t==="centric"){var{cx:n,cy:i,innerRadius:a,outerRadius:l,angle:d}=e,u=Nn(n,i,a,d),h=Nn(n,i,l,d);return[{x:u.x,y:u.y},{x:h.x,y:h.y}]}return XD(e)}}var L2={},R2={},P2={},PM;function Hpe(){return PM||(PM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=F7();function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(P2)),P2}var IM;function Wpe(){return IM||(IM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Hpe();function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(R2)),R2}var DM;function Gpe(){return DM||(DM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=H7(),r=Wpe();function n(i,a,l){l&&typeof l!="number"&&e.isIterateeCall(i,a,l)&&(a=l=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),l=l===void 0?i<a?1:-1:r.toFinite(l);const d=Math.max(Math.ceil((a-i)/(l||1)),0),u=new Array(d);for(let h=0;h<d;h++)u[h]=i,i+=l;return u}t.range=n})(L2)),L2}var I2,BM;function Vpe(){return BM||(BM=1,I2=Gpe().range),I2}var Kpe=Vpe();const ZD=Ms(Kpe);function hc(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ype(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function B5(t){let e,r,n;t.length!==2?(e=hc,r=(d,u)=>hc(t(d),u),n=(d,u)=>t(d)-u):(e=t===hc||t===Ype?t:Xpe,r=t,n=t);function i(d,u,h=0,p=d.length){if(h<p){if(e(u,u)!==0)return p;do{const m=h+p>>>1;r(d[m],u)<0?h=m+1:p=m}while(h<p)}return h}function a(d,u,h=0,p=d.length){if(h<p){if(e(u,u)!==0)return p;do{const m=h+p>>>1;r(d[m],u)<=0?h=m+1:p=m}while(h<p)}return h}function l(d,u,h=0,p=d.length){const m=i(d,u,h,p-1);return m>h&&n(d[m-1],u)>-n(d[m],u)?m-1:m}return{left:i,center:l,right:a}}function Xpe(){return 0}function eB(t){return t===null?NaN:+t}function*Jpe(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Qpe=B5(hc),X0=Qpe.right;B5(eB).center;class $M extends Map{constructor(e,r=tme){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(UM(this,e))}has(e){return super.has(UM(this,e))}set(e,r){return super.set(Zpe(this,e),r)}delete(e){return super.delete(eme(this,e))}}function UM({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function Zpe({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function eme({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function tme(t){return t!==null&&typeof t=="object"?t.valueOf():t}function rme(t=hc){if(t===hc)return tB;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function tB(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const nme=Math.sqrt(50),sme=Math.sqrt(10),ime=Math.sqrt(2);function Sx(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),l=a>=nme?10:a>=sme?5:a>=ime?2:1;let d,u,h;return i<0?(h=Math.pow(10,-i)/l,d=Math.round(t*h),u=Math.round(e*h),d/h<t&&++d,u/h>e&&--u,h=-h):(h=Math.pow(10,i)*l,d=Math.round(t/h),u=Math.round(e/h),d*h<t&&++d,u*h>e&&--u),u<d&&.5<=r&&r<2?Sx(t,e,r*2):[d,u,h]}function AN(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,l]=n?Sx(e,t,r):Sx(t,e,r);if(!(a>=i))return[];const d=a-i+1,u=new Array(d);if(n)if(l<0)for(let h=0;h<d;++h)u[h]=(a-h)/-l;else for(let h=0;h<d;++h)u[h]=(a-h)*l;else if(l<0)for(let h=0;h<d;++h)u[h]=(i+h)/-l;else for(let h=0;h<d;++h)u[h]=(i+h)*l;return u}function TN(t,e,r){return e=+e,t=+t,r=+r,Sx(t,e,r)[2]}function ON(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?TN(e,t,r):TN(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function zM(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function qM(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function rB(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?tB:rme(i);n>r;){if(n-r>600){const u=n-r+1,h=e-r+1,p=Math.log(u),m=.5*Math.exp(2*p/3),x=.5*Math.sqrt(p*m*(u-m)/u)*(h-u/2<0?-1:1),b=Math.max(r,Math.floor(e-h*m/u+x)),v=Math.min(n,Math.floor(e+(u-h)*m/u+x));rB(t,e,b,v,i)}const a=t[e];let l=r,d=n;for(bf(t,r,e),i(t[n],a)>0&&bf(t,r,n);l<d;){for(bf(t,l,d),++l,--d;i(t[l],a)<0;)++l;for(;i(t[d],a)>0;)--d}i(t[r],a)===0?bf(t,r,d):(++d,bf(t,d,n)),d<=e&&(r=d+1),e<=d&&(n=d-1)}return t}function bf(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function ame(t,e,r){if(t=Float64Array.from(Jpe(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return qM(t);if(e>=1)return zM(t);var n,i=(n-1)*e,a=Math.floor(i),l=zM(rB(t,a).subarray(0,a+1)),d=qM(t.subarray(a+1));return l+(d-l)*(i-a)}}function ome(t,e,r=eB){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),l=+r(t[a],a,t),d=+r(t[a+1],a+1,t);return l+(d-l)*(i-a)}}function lme(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function Qi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ml(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const MN=Symbol("implicit");function $5(){var t=new $M,e=[],r=[],n=MN;function i(a){let l=t.get(a);if(l===void 0){if(n!==MN)return n;t.set(a,l=e.push(a)-1)}return r[l%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new $M;for(const l of a)t.has(l)||t.set(l,e.push(l)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return $5(e,r).unknown(n)},Qi.apply(i,arguments),i}function U5(){var t=$5().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,l,d=!1,u=0,h=0,p=.5;delete t.unknown;function m(){var x=e().length,b=i<n,v=b?i:n,w=b?n:i;a=(w-v)/Math.max(1,x-u+h*2),d&&(a=Math.floor(a)),v+=(w-v-a*(x-u))*p,l=a*(1-u),d&&(v=Math.round(v),l=Math.round(l));var k=lme(x).map(function(_){return v+a*_});return r(b?k.reverse():k)}return t.domain=function(x){return arguments.length?(e(x),m()):e()},t.range=function(x){return arguments.length?([n,i]=x,n=+n,i=+i,m()):[n,i]},t.rangeRound=function(x){return[n,i]=x,n=+n,i=+i,d=!0,m()},t.bandwidth=function(){return l},t.step=function(){return a},t.round=function(x){return arguments.length?(d=!!x,m()):d},t.padding=function(x){return arguments.length?(u=Math.min(1,h=+x),m()):u},t.paddingInner=function(x){return arguments.length?(u=Math.min(1,x),m()):u},t.paddingOuter=function(x){return arguments.length?(h=+x,m()):h},t.align=function(x){return arguments.length?(p=Math.max(0,Math.min(1,x)),m()):p},t.copy=function(){return U5(e(),[n,i]).round(d).paddingInner(u).paddingOuter(h).align(p)},Qi.apply(m(),arguments)}function nB(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return nB(e())},t}function cme(){return nB(U5.apply(null,arguments).paddingInner(1))}function z5(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function sB(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function J0(){}var m0=.7,_x=1/m0,Hu="\\s*([+-]?\\d+)\\s*",g0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dme=/^#([0-9a-f]{3,8})$/,ume=new RegExp(`^rgb\\(${Hu},${Hu},${Hu}\\)$`),hme=new RegExp(`^rgb\\(${Xa},${Xa},${Xa}\\)$`),fme=new RegExp(`^rgba\\(${Hu},${Hu},${Hu},${g0}\\)$`),pme=new RegExp(`^rgba\\(${Xa},${Xa},${Xa},${g0}\\)$`),mme=new RegExp(`^hsl\\(${g0},${Xa},${Xa}\\)$`),gme=new RegExp(`^hsla\\(${g0},${Xa},${Xa},${g0}\\)$`),FM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};z5(J0,x0,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:HM,formatHex:HM,formatHex8:xme,formatHsl:yme,formatRgb:WM,toString:WM});function HM(){return this.rgb().formatHex()}function xme(){return this.rgb().formatHex8()}function yme(){return iB(this).formatHsl()}function WM(){return this.rgb().formatRgb()}function x0(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=dme.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?GM(e):r===3?new Ws(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?ig(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?ig(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ume.exec(t))?new Ws(e[1],e[2],e[3],1):(e=hme.exec(t))?new Ws(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=fme.exec(t))?ig(e[1],e[2],e[3],e[4]):(e=pme.exec(t))?ig(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=mme.exec(t))?YM(e[1],e[2]/100,e[3]/100,1):(e=gme.exec(t))?YM(e[1],e[2]/100,e[3]/100,e[4]):FM.hasOwnProperty(t)?GM(FM[t]):t==="transparent"?new Ws(NaN,NaN,NaN,0):null}function GM(t){return new Ws(t>>16&255,t>>8&255,t&255,1)}function ig(t,e,r,n){return n<=0&&(t=e=r=NaN),new Ws(t,e,r,n)}function bme(t){return t instanceof J0||(t=x0(t)),t?(t=t.rgb(),new Ws(t.r,t.g,t.b,t.opacity)):new Ws}function LN(t,e,r,n){return arguments.length===1?bme(t):new Ws(t,e,r,n??1)}function Ws(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}z5(Ws,LN,sB(J0,{brighter(t){return t=t==null?_x:Math.pow(_x,t),new Ws(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?m0:Math.pow(m0,t),new Ws(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ws(id(this.r),id(this.g),id(this.b),Cx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:VM,formatHex:VM,formatHex8:vme,formatRgb:KM,toString:KM}));function VM(){return`#${ed(this.r)}${ed(this.g)}${ed(this.b)}`}function vme(){return`#${ed(this.r)}${ed(this.g)}${ed(this.b)}${ed((isNaN(this.opacity)?1:this.opacity)*255)}`}function KM(){const t=Cx(this.opacity);return`${t===1?"rgb(":"rgba("}${id(this.r)}, ${id(this.g)}, ${id(this.b)}${t===1?")":`, ${t})`}`}function Cx(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function id(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ed(t){return t=id(t),(t<16?"0":"")+t.toString(16)}function YM(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new xa(t,e,r,n)}function iB(t){if(t instanceof xa)return new xa(t.h,t.s,t.l,t.opacity);if(t instanceof J0||(t=x0(t)),!t)return new xa;if(t instanceof xa)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),l=NaN,d=a-i,u=(a+i)/2;return d?(e===a?l=(r-n)/d+(r<n)*6:r===a?l=(n-e)/d+2:l=(e-r)/d+4,d/=u<.5?a+i:2-a-i,l*=60):d=u>0&&u<1?0:l,new xa(l,d,u,t.opacity)}function wme(t,e,r,n){return arguments.length===1?iB(t):new xa(t,e,r,n??1)}function xa(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}z5(xa,wme,sB(J0,{brighter(t){return t=t==null?_x:Math.pow(_x,t),new xa(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?m0:Math.pow(m0,t),new xa(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Ws(D2(t>=240?t-240:t+120,i,n),D2(t,i,n),D2(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new xa(XM(this.h),ag(this.s),ag(this.l),Cx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Cx(this.opacity);return`${t===1?"hsl(":"hsla("}${XM(this.h)}, ${ag(this.s)*100}%, ${ag(this.l)*100}%${t===1?")":`, ${t})`}`}}));function XM(t){return t=(t||0)%360,t<0?t+360:t}function ag(t){return Math.max(0,Math.min(1,t||0))}function D2(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const q5=t=>()=>t;function jme(t,e){return function(r){return t+r*e}}function Nme(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function kme(t){return(t=+t)==1?aB:function(e,r){return r-e?Nme(e,r,t):q5(isNaN(e)?r:e)}}function aB(t,e){var r=e-t;return r?jme(t,r):q5(isNaN(t)?e:t)}const JM=(function t(e){var r=kme(e);function n(i,a){var l=r((i=LN(i)).r,(a=LN(a)).r),d=r(i.g,a.g),u=r(i.b,a.b),h=aB(i.opacity,a.opacity);return function(p){return i.r=l(p),i.g=d(p),i.b=u(p),i.opacity=h(p),i+""}}return n.gamma=t,n})(1);function Sme(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function _me(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Cme(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),l;for(l=0;l<n;++l)i[l]=fh(t[l],e[l]);for(;l<r;++l)a[l]=e[l];return function(d){for(l=0;l<n;++l)a[l]=i[l](d);return a}}function Eme(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Ex(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Ame(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=fh(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var RN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,B2=new RegExp(RN.source,"g");function Tme(t){return function(){return t}}function Ome(t){return function(e){return t(e)+""}}function Mme(t,e){var r=RN.lastIndex=B2.lastIndex=0,n,i,a,l=-1,d=[],u=[];for(t=t+"",e=e+"";(n=RN.exec(t))&&(i=B2.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),d[l]?d[l]+=a:d[++l]=a),(n=n[0])===(i=i[0])?d[l]?d[l]+=i:d[++l]=i:(d[++l]=null,u.push({i:l,x:Ex(n,i)})),r=B2.lastIndex;return r<e.length&&(a=e.slice(r),d[l]?d[l]+=a:d[++l]=a),d.length<2?u[0]?Ome(u[0].x):Tme(e):(e=u.length,function(h){for(var p=0,m;p<e;++p)d[(m=u[p]).i]=m.x(h);return d.join("")})}function fh(t,e){var r=typeof e,n;return e==null||r==="boolean"?q5(e):(r==="number"?Ex:r==="string"?(n=x0(e))?(e=n,JM):Mme:e instanceof x0?JM:e instanceof Date?Eme:_me(e)?Sme:Array.isArray(e)?Cme:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Ame:Ex)(t,e)}function F5(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Lme(t,e){e===void 0&&(e=t,t=fh);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(l){var d=Math.max(0,Math.min(n-1,Math.floor(l*=n)));return a[d](l-d)}}function Rme(t){return function(){return t}}function Ax(t){return+t}var QM=[0,1];function Cs(t){return t}function PN(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Rme(isNaN(e)?NaN:.5)}function Pme(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function Ime(t,e,r){var n=t[0],i=t[1],a=e[0],l=e[1];return i<n?(n=PN(i,n),a=r(l,a)):(n=PN(n,i),a=r(a,l)),function(d){return a(n(d))}}function Dme(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),l=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<n;)i[l]=PN(t[l],t[l+1]),a[l]=r(e[l],e[l+1]);return function(d){var u=X0(t,d,1,n)-1;return a[u](i[u](d))}}function Q0(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function qy(){var t=QM,e=QM,r=fh,n,i,a,l=Cs,d,u,h;function p(){var x=Math.min(t.length,e.length);return l!==Cs&&(l=Pme(t[0],t[x-1])),d=x>2?Dme:Ime,u=h=null,m}function m(x){return x==null||isNaN(x=+x)?a:(u||(u=d(t.map(n),e,r)))(n(l(x)))}return m.invert=function(x){return l(i((h||(h=d(e,t.map(n),Ex)))(x)))},m.domain=function(x){return arguments.length?(t=Array.from(x,Ax),p()):t.slice()},m.range=function(x){return arguments.length?(e=Array.from(x),p()):e.slice()},m.rangeRound=function(x){return e=Array.from(x),r=F5,p()},m.clamp=function(x){return arguments.length?(l=x?!0:Cs,p()):l!==Cs},m.interpolate=function(x){return arguments.length?(r=x,p()):r},m.unknown=function(x){return arguments.length?(a=x,m):a},function(x,b){return n=x,i=b,p()}}function H5(){return qy()(Cs,Cs)}function Bme(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Tx(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Zu(t){return t=Tx(Math.abs(t)),t?t[1]:NaN}function $me(t,e){return function(r,n){for(var i=r.length,a=[],l=0,d=t[0],u=0;i>0&&d>0&&(u+d+1>n&&(d=Math.max(1,n-u)),a.push(r.substring(i-=d,i+d)),!((u+=d+1)>n));)d=t[l=(l+1)%t.length];return a.reverse().join(e)}}function Ume(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var zme=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function y0(t){if(!(e=zme.exec(t)))throw new Error("invalid format: "+t);var e;return new W5({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}y0.prototype=W5.prototype;function W5(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}W5.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qme(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var oB;function Fme(t,e){var r=Tx(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(oB=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=n.length;return a===l?n:a>l?n+new Array(a-l+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Tx(t,Math.max(0,e+a-1))[0]}function ZM(t,e){var r=Tx(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const e8={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Bme,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ZM(t*100,e),r:ZM,s:Fme,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function t8(t){return t}var r8=Array.prototype.map,n8=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Hme(t){var e=t.grouping===void 0||t.thousands===void 0?t8:$me(r8.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?t8:Ume(r8.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",d=t.minus===void 0?"":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function h(m){m=y0(m);var x=m.fill,b=m.align,v=m.sign,w=m.symbol,k=m.zero,_=m.width,T=m.comma,A=m.precision,I=m.trim,O=m.type;O==="n"?(T=!0,O="g"):e8[O]||(A===void 0&&(A=12),I=!0,O="g"),(k||x==="0"&&b==="=")&&(k=!0,x="0",b="=");var M=w==="$"?r:w==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",E=w==="$"?n:/[%p]/.test(O)?l:"",R=e8[O],$=/[defgprs%]/.test(O);A=A===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function B(C){var U=M,L=E,q,K,W;if(O==="c")L=R(C)+L,C="";else{C=+C;var V=C<0||1/C<0;if(C=isNaN(C)?u:R(Math.abs(C),A),I&&(C=qme(C)),V&&+C==0&&v!=="+"&&(V=!1),U=(V?v==="("?v:d:v==="-"||v==="("?"":v)+U,L=(O==="s"?n8[8+oB/3]:"")+L+(V&&v==="("?")":""),$){for(q=-1,K=C.length;++q<K;)if(W=C.charCodeAt(q),48>W||W>57){L=(W===46?i+C.slice(q+1):C.slice(q))+L,C=C.slice(0,q);break}}}T&&!k&&(C=e(C,1/0));var X=U.length+C.length+L.length,Z=X<_?new Array(_-X+1).join(x):"";switch(T&&k&&(C=e(Z+C,Z.length?_-L.length:1/0),Z=""),b){case"<":C=U+C+L+Z;break;case"=":C=U+Z+C+L;break;case"^":C=Z.slice(0,X=Z.length>>1)+U+C+L+Z.slice(X);break;default:C=Z+U+C+L;break}return a(C)}return B.toString=function(){return m+""},B}function p(m,x){var b=h((m=y0(m),m.type="f",m)),v=Math.max(-8,Math.min(8,Math.floor(Zu(x)/3)))*3,w=Math.pow(10,-v),k=n8[8+v/3];return function(_){return b(w*_)+k}}return{format:h,formatPrefix:p}}var og,G5,lB;Wme({thousands:",",grouping:[3],currency:["$",""]});function Wme(t){return og=Hme(t),G5=og.format,lB=og.formatPrefix,og}function Gme(t){return Math.max(0,-Zu(Math.abs(t)))}function Vme(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zu(e)/3)))*3-Zu(Math.abs(t)))}function Kme(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Zu(e)-Zu(t))+1}function cB(t,e,r,n){var i=ON(t,e,r),a;switch(n=y0(n??",f"),n.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=Vme(i,l))&&(n.precision=a),lB(n,l)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=Kme(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=Gme(i))&&(n.precision=a-(n.type==="%")*2);break}}return G5(n)}function Nc(t){var e=t.domain;return t.ticks=function(r){var n=e();return AN(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return cB(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,l=n[i],d=n[a],u,h,p=10;for(d<l&&(h=l,l=d,d=h,h=i,i=a,a=h);p-- >0;){if(h=TN(l,d,r),h===u)return n[i]=l,n[a]=d,e(n);if(h>0)l=Math.floor(l/h)*h,d=Math.ceil(d/h)*h;else if(h<0)l=Math.ceil(l*h)/h,d=Math.floor(d*h)/h;else break;u=h}return t},t}function dB(){var t=H5();return t.copy=function(){return Q0(t,dB())},Qi.apply(t,arguments),Nc(t)}function uB(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Ax),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return uB(t).unknown(e)},t=arguments.length?Array.from(t,Ax):[0,1],Nc(r)}function hB(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],l;return a<i&&(l=r,r=n,n=l,l=i,i=a,a=l),t[r]=e.floor(i),t[n]=e.ceil(a),t}function s8(t){return Math.log(t)}function i8(t){return Math.exp(t)}function Yme(t){return-Math.log(-t)}function Xme(t){return-Math.exp(-t)}function Jme(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Qme(t){return t===10?Jme:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Zme(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function a8(t){return(e,r)=>-t(-e,r)}function V5(t){const e=t(s8,i8),r=e.domain;let n=10,i,a;function l(){return i=Zme(n),a=Qme(n),r()[0]<0?(i=a8(i),a=a8(a),t(Yme,Xme)):t(s8,i8),e}return e.base=function(d){return arguments.length?(n=+d,l()):n},e.domain=function(d){return arguments.length?(r(d),l()):r()},e.ticks=d=>{const u=r();let h=u[0],p=u[u.length-1];const m=p<h;m&&([h,p]=[p,h]);let x=i(h),b=i(p),v,w;const k=d==null?10:+d;let _=[];if(!(n%1)&&b-x<k){if(x=Math.floor(x),b=Math.ceil(b),h>0){for(;x<=b;++x)for(v=1;v<n;++v)if(w=x<0?v/a(-x):v*a(x),!(w<h)){if(w>p)break;_.push(w)}}else for(;x<=b;++x)for(v=n-1;v>=1;--v)if(w=x>0?v/a(-x):v*a(x),!(w<h)){if(w>p)break;_.push(w)}_.length*2<k&&(_=AN(h,p,k))}else _=AN(x,b,Math.min(b-x,k)).map(a);return m?_.reverse():_},e.tickFormat=(d,u)=>{if(d==null&&(d=10),u==null&&(u=n===10?"s":","),typeof u!="function"&&(!(n%1)&&(u=y0(u)).precision==null&&(u.trim=!0),u=G5(u)),d===1/0)return u;const h=Math.max(1,n*d/e.ticks().length);return p=>{let m=p/a(Math.round(i(p)));return m*n<n-.5&&(m*=n),m<=h?u(p):""}},e.nice=()=>r(hB(r(),{floor:d=>a(Math.floor(i(d))),ceil:d=>a(Math.ceil(i(d)))})),e}function fB(){const t=V5(qy()).domain([1,10]);return t.copy=()=>Q0(t,fB()).base(t.base()),Qi.apply(t,arguments),t}function o8(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function l8(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function K5(t){var e=1,r=t(o8(e),l8(e));return r.constant=function(n){return arguments.length?t(o8(e=+n),l8(e)):e},Nc(r)}function pB(){var t=K5(qy());return t.copy=function(){return Q0(t,pB()).constant(t.constant())},Qi.apply(t,arguments)}function c8(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function ege(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function tge(t){return t<0?-t*t:t*t}function Y5(t){var e=t(Cs,Cs),r=1;function n(){return r===1?t(Cs,Cs):r===.5?t(ege,tge):t(c8(r),c8(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},Nc(e)}function X5(){var t=Y5(qy());return t.copy=function(){return Q0(t,X5()).exponent(t.exponent())},Qi.apply(t,arguments),t}function rge(){return X5.apply(null,arguments).exponent(.5)}function d8(t){return Math.sign(t)*t*t}function nge(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function mB(){var t=H5(),e=[0,1],r=!1,n;function i(a){var l=nge(t(a));return isNaN(l)?n:r?Math.round(l):l}return i.invert=function(a){return t.invert(d8(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Ax)).map(d8)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return mB(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Qi.apply(i,arguments),Nc(i)}function gB(){var t=[],e=[],r=[],n;function i(){var l=0,d=Math.max(1,e.length);for(r=new Array(d-1);++l<d;)r[l-1]=ome(t,l/d);return a}function a(l){return l==null||isNaN(l=+l)?n:e[X0(r,l)]}return a.invertExtent=function(l){var d=e.indexOf(l);return d<0?[NaN,NaN]:[d>0?r[d-1]:t[0],d<r.length?r[d]:t[t.length-1]]},a.domain=function(l){if(!arguments.length)return t.slice();t=[];for(let d of l)d!=null&&!isNaN(d=+d)&&t.push(d);return t.sort(hc),i()},a.range=function(l){return arguments.length?(e=Array.from(l),i()):e.slice()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return gB().domain(t).range(e).unknown(n)},Qi.apply(a,arguments)}function xB(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function l(u){return u!=null&&u<=u?i[X0(n,u,0,r)]:a}function d(){var u=-1;for(n=new Array(r);++u<r;)n[u]=((u+1)*e-(u-r)*t)/(r+1);return l}return l.domain=function(u){return arguments.length?([t,e]=u,t=+t,e=+e,d()):[t,e]},l.range=function(u){return arguments.length?(r=(i=Array.from(u)).length-1,d()):i.slice()},l.invertExtent=function(u){var h=i.indexOf(u);return h<0?[NaN,NaN]:h<1?[t,n[0]]:h>=r?[n[r-1],e]:[n[h-1],n[h]]},l.unknown=function(u){return arguments.length&&(a=u),l},l.thresholds=function(){return n.slice()},l.copy=function(){return xB().domain([t,e]).range(i).unknown(a)},Qi.apply(Nc(l),arguments)}function yB(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[X0(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var l=e.indexOf(a);return[t[l-1],t[l]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return yB().domain(t).range(e).unknown(r)},Qi.apply(i,arguments)}const $2=new Date,U2=new Date;function An(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const l=i(a),d=i.ceil(a);return a-l<d-a?l:d},i.offset=(a,l)=>(e(a=new Date(+a),l==null?1:Math.floor(l)),a),i.range=(a,l,d)=>{const u=[];if(a=i.ceil(a),d=d==null?1:Math.floor(d),!(a<l)||!(d>0))return u;let h;do u.push(h=new Date(+a)),e(a,d),t(a);while(h<a&&a<l);return u},i.filter=a=>An(l=>{if(l>=l)for(;t(l),!a(l);)l.setTime(l-1)},(l,d)=>{if(l>=l)if(d<0)for(;++d<=0;)for(;e(l,-1),!a(l););else for(;--d>=0;)for(;e(l,1),!a(l););}),r&&(i.count=(a,l)=>($2.setTime(+a),U2.setTime(+l),t($2),t(U2),Math.floor(r($2,U2))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?l=>n(l)%a===0:l=>i.count(0,l)%a===0):i)),i}const Ox=An(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Ox.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?An(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Ox);Ox.range;const Fo=1e3,Wi=Fo*60,Ho=Wi*60,tl=Ho*24,J5=tl*7,u8=tl*30,z2=tl*365,td=An(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Fo)},(t,e)=>(e-t)/Fo,t=>t.getUTCSeconds());td.range;const Q5=An(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Fo)},(t,e)=>{t.setTime(+t+e*Wi)},(t,e)=>(e-t)/Wi,t=>t.getMinutes());Q5.range;const Z5=An(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Wi)},(t,e)=>(e-t)/Wi,t=>t.getUTCMinutes());Z5.range;const ek=An(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Fo-t.getMinutes()*Wi)},(t,e)=>{t.setTime(+t+e*Ho)},(t,e)=>(e-t)/Ho,t=>t.getHours());ek.range;const tk=An(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Ho)},(t,e)=>(e-t)/Ho,t=>t.getUTCHours());tk.range;const Z0=An(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Wi)/tl,t=>t.getDate()-1);Z0.range;const Fy=An(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/tl,t=>t.getUTCDate()-1);Fy.range;const bB=An(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/tl,t=>Math.floor(t/tl));bB.range;function Dd(t){return An(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Wi)/J5)}const Hy=Dd(0),Mx=Dd(1),sge=Dd(2),ige=Dd(3),eh=Dd(4),age=Dd(5),oge=Dd(6);Hy.range;Mx.range;sge.range;ige.range;eh.range;age.range;oge.range;function Bd(t){return An(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/J5)}const Wy=Bd(0),Lx=Bd(1),lge=Bd(2),cge=Bd(3),th=Bd(4),dge=Bd(5),uge=Bd(6);Wy.range;Lx.range;lge.range;cge.range;th.range;dge.range;uge.range;const rk=An(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());rk.range;const nk=An(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());nk.range;const rl=An(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());rl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:An(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});rl.range;const nl=An(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());nl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:An(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});nl.range;function vB(t,e,r,n,i,a){const l=[[td,1,Fo],[td,5,5*Fo],[td,15,15*Fo],[td,30,30*Fo],[a,1,Wi],[a,5,5*Wi],[a,15,15*Wi],[a,30,30*Wi],[i,1,Ho],[i,3,3*Ho],[i,6,6*Ho],[i,12,12*Ho],[n,1,tl],[n,2,2*tl],[r,1,J5],[e,1,u8],[e,3,3*u8],[t,1,z2]];function d(h,p,m){const x=p<h;x&&([h,p]=[p,h]);const b=m&&typeof m.range=="function"?m:u(h,p,m),v=b?b.range(h,+p+1):[];return x?v.reverse():v}function u(h,p,m){const x=Math.abs(p-h)/m,b=B5(([,,k])=>k).right(l,x);if(b===l.length)return t.every(ON(h/z2,p/z2,m));if(b===0)return Ox.every(Math.max(ON(h,p,m),1));const[v,w]=l[x/l[b-1][2]<l[b][2]/x?b-1:b];return v.every(w)}return[d,u]}const[hge,fge]=vB(nl,nk,Wy,bB,tk,Z5),[pge,mge]=vB(rl,rk,Hy,Z0,ek,Q5);function q2(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function F2(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function vf(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function gge(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,l=t.shortDays,d=t.months,u=t.shortMonths,h=wf(i),p=jf(i),m=wf(a),x=jf(a),b=wf(l),v=jf(l),w=wf(d),k=jf(d),_=wf(u),T=jf(u),A={a:V,A:X,b:Z,B:G,c:null,d:x8,e:x8,f:$ge,g:Yge,G:Jge,H:Ige,I:Dge,j:Bge,L:wB,m:Uge,M:zge,p:F,q:Y,Q:v8,s:w8,S:qge,u:Fge,U:Hge,V:Wge,w:Gge,W:Vge,x:null,X:null,y:Kge,Y:Xge,Z:Qge,"%":b8},I={a:ne,A:re,b:ue,B:Le,c:null,d:y8,e:y8,f:rxe,g:hxe,G:pxe,H:Zge,I:exe,j:txe,L:NB,m:nxe,M:sxe,p:de,q:ve,Q:v8,s:w8,S:ixe,u:axe,U:oxe,V:lxe,w:cxe,W:dxe,x:null,X:null,y:uxe,Y:fxe,Z:mxe,"%":b8},O={a:B,A:C,b:U,B:L,c:q,d:m8,e:m8,f:Mge,g:p8,G:f8,H:g8,I:g8,j:Ege,L:Oge,m:Cge,M:Age,p:$,q:_ge,Q:Rge,s:Pge,S:Tge,u:wge,U:jge,V:Nge,w:vge,W:kge,x:K,X:W,y:p8,Y:f8,Z:Sge,"%":Lge};A.x=M(r,A),A.X=M(n,A),A.c=M(e,A),I.x=M(r,I),I.X=M(n,I),I.c=M(e,I);function M(te,ge){return function(ke){var oe=[],Ee=-1,Te=0,Ye=te.length,ze,le,pe;for(ke instanceof Date||(ke=new Date(+ke));++Ee<Ye;)te.charCodeAt(Ee)===37&&(oe.push(te.slice(Te,Ee)),(le=h8[ze=te.charAt(++Ee)])!=null?ze=te.charAt(++Ee):le=ze==="e"?" ":"0",(pe=ge[ze])&&(ze=pe(ke,le)),oe.push(ze),Te=Ee+1);return oe.push(te.slice(Te,Ee)),oe.join("")}}function E(te,ge){return function(ke){var oe=vf(1900,void 0,1),Ee=R(oe,te,ke+="",0),Te,Ye;if(Ee!=ke.length)return null;if("Q"in oe)return new Date(oe.Q);if("s"in oe)return new Date(oe.s*1e3+("L"in oe?oe.L:0));if(ge&&!("Z"in oe)&&(oe.Z=0),"p"in oe&&(oe.H=oe.H%12+oe.p*12),oe.m===void 0&&(oe.m="q"in oe?oe.q:0),"V"in oe){if(oe.V<1||oe.V>53)return null;"w"in oe||(oe.w=1),"Z"in oe?(Te=F2(vf(oe.y,0,1)),Ye=Te.getUTCDay(),Te=Ye>4||Ye===0?Lx.ceil(Te):Lx(Te),Te=Fy.offset(Te,(oe.V-1)*7),oe.y=Te.getUTCFullYear(),oe.m=Te.getUTCMonth(),oe.d=Te.getUTCDate()+(oe.w+6)%7):(Te=q2(vf(oe.y,0,1)),Ye=Te.getDay(),Te=Ye>4||Ye===0?Mx.ceil(Te):Mx(Te),Te=Z0.offset(Te,(oe.V-1)*7),oe.y=Te.getFullYear(),oe.m=Te.getMonth(),oe.d=Te.getDate()+(oe.w+6)%7)}else("W"in oe||"U"in oe)&&("w"in oe||(oe.w="u"in oe?oe.u%7:"W"in oe?1:0),Ye="Z"in oe?F2(vf(oe.y,0,1)).getUTCDay():q2(vf(oe.y,0,1)).getDay(),oe.m=0,oe.d="W"in oe?(oe.w+6)%7+oe.W*7-(Ye+5)%7:oe.w+oe.U*7-(Ye+6)%7);return"Z"in oe?(oe.H+=oe.Z/100|0,oe.M+=oe.Z%100,F2(oe)):q2(oe)}}function R(te,ge,ke,oe){for(var Ee=0,Te=ge.length,Ye=ke.length,ze,le;Ee<Te;){if(oe>=Ye)return-1;if(ze=ge.charCodeAt(Ee++),ze===37){if(ze=ge.charAt(Ee++),le=O[ze in h8?ge.charAt(Ee++):ze],!le||(oe=le(te,ke,oe))<0)return-1}else if(ze!=ke.charCodeAt(oe++))return-1}return oe}function $(te,ge,ke){var oe=h.exec(ge.slice(ke));return oe?(te.p=p.get(oe[0].toLowerCase()),ke+oe[0].length):-1}function B(te,ge,ke){var oe=b.exec(ge.slice(ke));return oe?(te.w=v.get(oe[0].toLowerCase()),ke+oe[0].length):-1}function C(te,ge,ke){var oe=m.exec(ge.slice(ke));return oe?(te.w=x.get(oe[0].toLowerCase()),ke+oe[0].length):-1}function U(te,ge,ke){var oe=_.exec(ge.slice(ke));return oe?(te.m=T.get(oe[0].toLowerCase()),ke+oe[0].length):-1}function L(te,ge,ke){var oe=w.exec(ge.slice(ke));return oe?(te.m=k.get(oe[0].toLowerCase()),ke+oe[0].length):-1}function q(te,ge,ke){return R(te,e,ge,ke)}function K(te,ge,ke){return R(te,r,ge,ke)}function W(te,ge,ke){return R(te,n,ge,ke)}function V(te){return l[te.getDay()]}function X(te){return a[te.getDay()]}function Z(te){return u[te.getMonth()]}function G(te){return d[te.getMonth()]}function F(te){return i[+(te.getHours()>=12)]}function Y(te){return 1+~~(te.getMonth()/3)}function ne(te){return l[te.getUTCDay()]}function re(te){return a[te.getUTCDay()]}function ue(te){return u[te.getUTCMonth()]}function Le(te){return d[te.getUTCMonth()]}function de(te){return i[+(te.getUTCHours()>=12)]}function ve(te){return 1+~~(te.getUTCMonth()/3)}return{format:function(te){var ge=M(te+="",A);return ge.toString=function(){return te},ge},parse:function(te){var ge=E(te+="",!1);return ge.toString=function(){return te},ge},utcFormat:function(te){var ge=M(te+="",I);return ge.toString=function(){return te},ge},utcParse:function(te){var ge=E(te+="",!0);return ge.toString=function(){return te},ge}}}var h8={"-":"",_:" ",0:"0"},qn=/^\s*\d+/,xge=/^%/,yge=/[\\^$*+?|[\]().{}]/g;function ir(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function bge(t){return t.replace(yge,"\\$&")}function wf(t){return new RegExp("^(?:"+t.map(bge).join("|")+")","i")}function jf(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function vge(t,e,r){var n=qn.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function wge(t,e,r){var n=qn.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function jge(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function Nge(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function kge(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function f8(t,e,r){var n=qn.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function p8(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Sge(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function _ge(t,e,r){var n=qn.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function Cge(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function m8(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function Ege(t,e,r){var n=qn.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function g8(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function Age(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function Tge(t,e,r){var n=qn.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function Oge(t,e,r){var n=qn.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function Mge(t,e,r){var n=qn.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Lge(t,e,r){var n=xge.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function Rge(t,e,r){var n=qn.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function Pge(t,e,r){var n=qn.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function x8(t,e){return ir(t.getDate(),e,2)}function Ige(t,e){return ir(t.getHours(),e,2)}function Dge(t,e){return ir(t.getHours()%12||12,e,2)}function Bge(t,e){return ir(1+Z0.count(rl(t),t),e,3)}function wB(t,e){return ir(t.getMilliseconds(),e,3)}function $ge(t,e){return wB(t,e)+"000"}function Uge(t,e){return ir(t.getMonth()+1,e,2)}function zge(t,e){return ir(t.getMinutes(),e,2)}function qge(t,e){return ir(t.getSeconds(),e,2)}function Fge(t){var e=t.getDay();return e===0?7:e}function Hge(t,e){return ir(Hy.count(rl(t)-1,t),e,2)}function jB(t){var e=t.getDay();return e>=4||e===0?eh(t):eh.ceil(t)}function Wge(t,e){return t=jB(t),ir(eh.count(rl(t),t)+(rl(t).getDay()===4),e,2)}function Gge(t){return t.getDay()}function Vge(t,e){return ir(Mx.count(rl(t)-1,t),e,2)}function Kge(t,e){return ir(t.getFullYear()%100,e,2)}function Yge(t,e){return t=jB(t),ir(t.getFullYear()%100,e,2)}function Xge(t,e){return ir(t.getFullYear()%1e4,e,4)}function Jge(t,e){var r=t.getDay();return t=r>=4||r===0?eh(t):eh.ceil(t),ir(t.getFullYear()%1e4,e,4)}function Qge(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ir(e/60|0,"0",2)+ir(e%60,"0",2)}function y8(t,e){return ir(t.getUTCDate(),e,2)}function Zge(t,e){return ir(t.getUTCHours(),e,2)}function exe(t,e){return ir(t.getUTCHours()%12||12,e,2)}function txe(t,e){return ir(1+Fy.count(nl(t),t),e,3)}function NB(t,e){return ir(t.getUTCMilliseconds(),e,3)}function rxe(t,e){return NB(t,e)+"000"}function nxe(t,e){return ir(t.getUTCMonth()+1,e,2)}function sxe(t,e){return ir(t.getUTCMinutes(),e,2)}function ixe(t,e){return ir(t.getUTCSeconds(),e,2)}function axe(t){var e=t.getUTCDay();return e===0?7:e}function oxe(t,e){return ir(Wy.count(nl(t)-1,t),e,2)}function kB(t){var e=t.getUTCDay();return e>=4||e===0?th(t):th.ceil(t)}function lxe(t,e){return t=kB(t),ir(th.count(nl(t),t)+(nl(t).getUTCDay()===4),e,2)}function cxe(t){return t.getUTCDay()}function dxe(t,e){return ir(Lx.count(nl(t)-1,t),e,2)}function uxe(t,e){return ir(t.getUTCFullYear()%100,e,2)}function hxe(t,e){return t=kB(t),ir(t.getUTCFullYear()%100,e,2)}function fxe(t,e){return ir(t.getUTCFullYear()%1e4,e,4)}function pxe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?th(t):th.ceil(t),ir(t.getUTCFullYear()%1e4,e,4)}function mxe(){return"+0000"}function b8(){return"%"}function v8(t){return+t}function w8(t){return Math.floor(+t/1e3)}var wu,SB,_B;gxe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function gxe(t){return wu=gge(t),SB=wu.format,wu.parse,_B=wu.utcFormat,wu.utcParse,wu}function xxe(t){return new Date(t)}function yxe(t){return t instanceof Date?+t:+new Date(+t)}function sk(t,e,r,n,i,a,l,d,u,h){var p=H5(),m=p.invert,x=p.domain,b=h(".%L"),v=h(":%S"),w=h("%I:%M"),k=h("%I %p"),_=h("%a %d"),T=h("%b %d"),A=h("%B"),I=h("%Y");function O(M){return(u(M)<M?b:d(M)<M?v:l(M)<M?w:a(M)<M?k:n(M)<M?i(M)<M?_:T:r(M)<M?A:I)(M)}return p.invert=function(M){return new Date(m(M))},p.domain=function(M){return arguments.length?x(Array.from(M,yxe)):x().map(xxe)},p.ticks=function(M){var E=x();return t(E[0],E[E.length-1],M??10)},p.tickFormat=function(M,E){return E==null?O:h(E)},p.nice=function(M){var E=x();return(!M||typeof M.range!="function")&&(M=e(E[0],E[E.length-1],M??10)),M?x(hB(E,M)):p},p.copy=function(){return Q0(p,sk(t,e,r,n,i,a,l,d,u,h))},p}function bxe(){return Qi.apply(sk(pge,mge,rl,rk,Hy,Z0,ek,Q5,td,SB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vxe(){return Qi.apply(sk(hge,fge,nl,nk,Wy,Fy,tk,Z5,td,_B).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Gy(){var t=0,e=1,r,n,i,a,l=Cs,d=!1,u;function h(m){return m==null||isNaN(m=+m)?u:l(i===0?.5:(m=(a(m)-r)*i,d?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([t,e]=m,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),h):[t,e]},h.clamp=function(m){return arguments.length?(d=!!m,h):d},h.interpolator=function(m){return arguments.length?(l=m,h):l};function p(m){return function(x){var b,v;return arguments.length?([b,v]=x,l=m(b,v),h):[l(0),l(1)]}}return h.range=p(fh),h.rangeRound=p(F5),h.unknown=function(m){return arguments.length?(u=m,h):u},function(m){return a=m,r=m(t),n=m(e),i=r===n?0:1/(n-r),h}}function kc(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function CB(){var t=Nc(Gy()(Cs));return t.copy=function(){return kc(t,CB())},ml.apply(t,arguments)}function EB(){var t=V5(Gy()).domain([1,10]);return t.copy=function(){return kc(t,EB()).base(t.base())},ml.apply(t,arguments)}function AB(){var t=K5(Gy());return t.copy=function(){return kc(t,AB()).constant(t.constant())},ml.apply(t,arguments)}function ik(){var t=Y5(Gy());return t.copy=function(){return kc(t,ik()).exponent(t.exponent())},ml.apply(t,arguments)}function wxe(){return ik.apply(null,arguments).exponent(.5)}function TB(){var t=[],e=Cs;function r(n){if(n!=null&&!isNaN(n=+n))return e((X0(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(hc),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>ame(t,a/n))},r.copy=function(){return TB(e).domain(t)},ml.apply(r,arguments)}function Vy(){var t=0,e=.5,r=1,n=1,i,a,l,d,u,h=Cs,p,m=!1,x;function b(w){return isNaN(w=+w)?x:(w=.5+((w=+p(w))-a)*(n*w<n*a?d:u),h(m?Math.max(0,Math.min(1,w)):w))}b.domain=function(w){return arguments.length?([t,e,r]=w,i=p(t=+t),a=p(e=+e),l=p(r=+r),d=i===a?0:.5/(a-i),u=a===l?0:.5/(l-a),n=a<i?-1:1,b):[t,e,r]},b.clamp=function(w){return arguments.length?(m=!!w,b):m},b.interpolator=function(w){return arguments.length?(h=w,b):h};function v(w){return function(k){var _,T,A;return arguments.length?([_,T,A]=k,h=Lme(w,[_,T,A]),b):[h(0),h(.5),h(1)]}}return b.range=v(fh),b.rangeRound=v(F5),b.unknown=function(w){return arguments.length?(x=w,b):x},function(w){return p=w,i=w(t),a=w(e),l=w(r),d=i===a?0:.5/(a-i),u=a===l?0:.5/(l-a),n=a<i?-1:1,b}}function OB(){var t=Nc(Vy()(Cs));return t.copy=function(){return kc(t,OB())},ml.apply(t,arguments)}function MB(){var t=V5(Vy()).domain([.1,1,10]);return t.copy=function(){return kc(t,MB()).base(t.base())},ml.apply(t,arguments)}function LB(){var t=K5(Vy());return t.copy=function(){return kc(t,LB()).constant(t.constant())},ml.apply(t,arguments)}function ak(){var t=Y5(Vy());return t.copy=function(){return kc(t,ak()).exponent(t.exponent())},ml.apply(t,arguments)}function jxe(){return ak.apply(null,arguments).exponent(.5)}const Mf=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:U5,scaleDiverging:OB,scaleDivergingLog:MB,scaleDivergingPow:ak,scaleDivergingSqrt:jxe,scaleDivergingSymlog:LB,scaleIdentity:uB,scaleImplicit:MN,scaleLinear:dB,scaleLog:fB,scaleOrdinal:$5,scalePoint:cme,scalePow:X5,scaleQuantile:gB,scaleQuantize:xB,scaleRadial:mB,scaleSequential:CB,scaleSequentialLog:EB,scaleSequentialPow:ik,scaleSequentialQuantile:TB,scaleSequentialSqrt:wxe,scaleSequentialSymlog:AB,scaleSqrt:rge,scaleSymlog:pB,scaleThreshold:yB,scaleTime:bxe,scaleUtc:vxe,tickFormat:cB},Symbol.toStringTag,{value:"Module"}));var gl=t=>t.chartData,Ky=we([gl],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),RB=(t,e,r,n)=>n?Ky(t):gl(t),Nxe=(t,e,r)=>r?Ky(t):gl(t);function yc(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(Jr(e)&&Jr(r))return!0}return!1}function j8(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function PB(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(Jr(r))i=r;else if(typeof r=="function")return;if(Jr(n))a=n;else if(typeof n=="function")return;var l=[i,a];if(yc(l))return l}}function kxe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(yc(n))return j8(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,l,d;if(i==="auto")e!=null&&(l=Math.min(...e));else if(gt(i))l=i;else if(typeof i=="function")try{e!=null&&(l=i(e?.[0]))}catch{}else if(typeof i=="string"&&OO.test(i)){var u=OO.exec(i);if(u==null||u[1]==null||e==null)l=void 0;else{var h=+u[1];l=e[0]-h}}else l=e?.[0];if(a==="auto")e!=null&&(d=Math.max(...e));else if(gt(a))d=a;else if(typeof a=="function")try{e!=null&&(d=a(e?.[1]))}catch{}else if(typeof a=="string"&&MO.test(a)){var p=MO.exec(a);if(p==null||p[1]==null||e==null)d=void 0;else{var m=+p[1];d=e[1]+m}}else d=e?.[1];var x=[l,d];if(yc(x))return e==null?x:j8(x,e,r)}}}var ph=1e9,Sxe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},lk,Vr=!0,Xi="[DecimalError] ",ad=Xi+"Invalid argument: ",ok=Xi+"Exponent out of range: ",mh=Math.floor,Kc=Math.pow,_xe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hi,$n=1e7,Br=7,IB=9007199254740991,Rx=mh(IB/Br),st={};st.absoluteValue=st.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};st.comparedTo=st.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};st.decimalPlaces=st.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*Br;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};st.dividedBy=st.div=function(t){return Vo(this,new this.constructor(t))};st.dividedToIntegerBy=st.idiv=function(t){var e=this,r=e.constructor;return Sr(Vo(e,new r(t),0,1),r.precision)};st.equals=st.eq=function(t){return!this.cmp(t)};st.exponent=function(){return kn(this)};st.greaterThan=st.gt=function(t){return this.cmp(t)>0};st.greaterThanOrEqualTo=st.gte=function(t){return this.cmp(t)>=0};st.isInteger=st.isint=function(){return this.e>this.d.length-2};st.isNegative=st.isneg=function(){return this.s<0};st.isPositive=st.ispos=function(){return this.s>0};st.isZero=function(){return this.s===0};st.lessThan=st.lt=function(t){return this.cmp(t)<0};st.lessThanOrEqualTo=st.lte=function(t){return this.cmp(t)<1};st.logarithm=st.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(hi))throw Error(Xi+"NaN");if(r.s<1)throw Error(Xi+(r.s?"NaN":"-Infinity"));return r.eq(hi)?new n(0):(Vr=!1,e=Vo(b0(r,a),b0(t,a),a),Vr=!0,Sr(e,i))};st.minus=st.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?$B(e,t):DB(e,(t.s=-t.s,t))};st.modulo=st.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(Xi+"NaN");return r.s?(Vr=!1,e=Vo(r,t,0,1).times(t),Vr=!0,r.minus(e)):Sr(new n(r),i)};st.naturalExponential=st.exp=function(){return BB(this)};st.naturalLogarithm=st.ln=function(){return b0(this)};st.negated=st.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};st.plus=st.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?DB(e,t):$B(e,(t.s=-t.s,t))};st.precision=st.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ad+t);if(e=kn(i)+1,n=i.d.length-1,r=n*Br+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};st.squareRoot=st.sqrt=function(){var t,e,r,n,i,a,l,d=this,u=d.constructor;if(d.s<1){if(!d.s)return new u(0);throw Error(Xi+"NaN")}for(t=kn(d),Vr=!1,i=Math.sqrt(+d),i==0||i==1/0?(e=Ga(d.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=mh((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new u(e)):n=new u(i.toString()),r=u.precision,i=l=r+3;;)if(a=n,n=a.plus(Vo(d,a,l+2)).times(.5),Ga(a.d).slice(0,l)===(e=Ga(n.d)).slice(0,l)){if(e=e.slice(l-3,l+1),i==l&&e=="4999"){if(Sr(a,r+1,0),a.times(a).eq(d)){n=a;break}}else if(e!="9999")break;l+=4}return Vr=!0,Sr(n,r)};st.times=st.mul=function(t){var e,r,n,i,a,l,d,u,h,p=this,m=p.constructor,x=p.d,b=(t=new m(t)).d;if(!p.s||!t.s)return new m(0);for(t.s*=p.s,r=p.e+t.e,u=x.length,h=b.length,u<h&&(a=x,x=b,b=a,l=u,u=h,h=l),a=[],l=u+h,n=l;n--;)a.push(0);for(n=h;--n>=0;){for(e=0,i=u+n;i>n;)d=a[i]+b[n]*x[i-n-1]+e,a[i--]=d%$n|0,e=d/$n|0;a[i]=(a[i]+e)%$n|0}for(;!a[--l];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Vr?Sr(t,m.precision):t};st.toDecimalPlaces=st.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(no(t,0,ph),e===void 0?e=n.rounding:no(e,0,8),Sr(r,t+kn(r)+1,e))};st.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=kd(n,!0):(no(t,0,ph),e===void 0?e=i.rounding:no(e,0,8),n=Sr(new i(n),t+1,e),r=kd(n,!0,t+1)),r};st.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?kd(i):(no(t,0,ph),e===void 0?e=a.rounding:no(e,0,8),n=Sr(new a(i),t+kn(i)+1,e),r=kd(n.abs(),!1,t+kn(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};st.toInteger=st.toint=function(){var t=this,e=t.constructor;return Sr(new e(t),kn(t)+1,e.rounding)};st.toNumber=function(){return+this};st.toPower=st.pow=function(t){var e,r,n,i,a,l,d=this,u=d.constructor,h=12,p=+(t=new u(t));if(!t.s)return new u(hi);if(d=new u(d),!d.s){if(t.s<1)throw Error(Xi+"Infinity");return d}if(d.eq(hi))return d;if(n=u.precision,t.eq(hi))return Sr(d,n);if(e=t.e,r=t.d.length-1,l=e>=r,a=d.s,l){if((r=p<0?-p:p)<=IB){for(i=new u(hi),e=Math.ceil(n/Br+4),Vr=!1;r%2&&(i=i.times(d),k8(i.d,e)),r=mh(r/2),r!==0;)d=d.times(d),k8(d.d,e);return Vr=!0,t.s<0?new u(hi).div(i):Sr(i,n)}}else if(a<0)throw Error(Xi+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,d.s=1,Vr=!1,i=t.times(b0(d,n+h)),Vr=!0,i=BB(i),i.s=a,i};st.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=kn(i),n=kd(i,r<=a.toExpNeg||r>=a.toExpPos)):(no(t,1,ph),e===void 0?e=a.rounding:no(e,0,8),i=Sr(new a(i),t,e),r=kn(i),n=kd(i,t<=r||r<=a.toExpNeg,t)),n};st.toSignificantDigits=st.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(no(t,1,ph),e===void 0?e=n.rounding:no(e,0,8)),Sr(new n(r),t,e)};st.toString=st.valueOf=st.val=st.toJSON=st[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=kn(t),r=t.constructor;return kd(t,e<=r.toExpNeg||e>=r.toExpPos)};function DB(t,e){var r,n,i,a,l,d,u,h,p=t.constructor,m=p.precision;if(!t.s||!e.s)return e.s||(e=new p(t)),Vr?Sr(e,m):e;if(u=t.d,h=e.d,l=t.e,i=e.e,u=u.slice(),a=l-i,a){for(a<0?(n=u,a=-a,d=h.length):(n=h,i=l,d=u.length),l=Math.ceil(m/Br),d=l>d?l+1:d+1,a>d&&(a=d,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(d=u.length,a=h.length,d-a<0&&(a=d,n=h,h=u,u=n),r=0;a;)r=(u[--a]=u[a]+h[a]+r)/$n|0,u[a]%=$n;for(r&&(u.unshift(r),++i),d=u.length;u[--d]==0;)u.pop();return e.d=u,e.e=i,Vr?Sr(e,m):e}function no(t,e,r){if(t!==~~t||t<e||t>r)throw Error(ad+t)}function Ga(t){var e,r,n,i=t.length-1,a="",l=t[0];if(i>0){for(a+=l,e=1;e<i;e++)n=t[e]+"",r=Br-n.length,r&&(a+=Xl(r)),a+=n;l=t[e],n=l+"",r=Br-n.length,r&&(a+=Xl(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return a+l}var Vo=(function(){function t(n,i){var a,l=0,d=n.length;for(n=n.slice();d--;)a=n[d]*i+l,n[d]=a%$n|0,l=a/$n|0;return l&&n.unshift(l),n}function e(n,i,a,l){var d,u;if(a!=l)u=a>l?1:-1;else for(d=u=0;d<a;d++)if(n[d]!=i[d]){u=n[d]>i[d]?1:-1;break}return u}function r(n,i,a){for(var l=0;a--;)n[a]-=l,l=n[a]<i[a]?1:0,n[a]=l*$n+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,l){var d,u,h,p,m,x,b,v,w,k,_,T,A,I,O,M,E,R,$=n.constructor,B=n.s==i.s?1:-1,C=n.d,U=i.d;if(!n.s)return new $(n);if(!i.s)throw Error(Xi+"Division by zero");for(u=n.e-i.e,E=U.length,O=C.length,b=new $(B),v=b.d=[],h=0;U[h]==(C[h]||0);)++h;if(U[h]>(C[h]||0)&&--u,a==null?T=a=$.precision:l?T=a+(kn(n)-kn(i))+1:T=a,T<0)return new $(0);if(T=T/Br+2|0,h=0,E==1)for(p=0,U=U[0],T++;(h<O||p)&&T--;h++)A=p*$n+(C[h]||0),v[h]=A/U|0,p=A%U|0;else{for(p=$n/(U[0]+1)|0,p>1&&(U=t(U,p),C=t(C,p),E=U.length,O=C.length),I=E,w=C.slice(0,E),k=w.length;k<E;)w[k++]=0;R=U.slice(),R.unshift(0),M=U[0],U[1]>=$n/2&&++M;do p=0,d=e(U,w,E,k),d<0?(_=w[0],E!=k&&(_=_*$n+(w[1]||0)),p=_/M|0,p>1?(p>=$n&&(p=$n-1),m=t(U,p),x=m.length,k=w.length,d=e(m,w,x,k),d==1&&(p--,r(m,E<x?R:U,x))):(p==0&&(d=p=1),m=U.slice()),x=m.length,x<k&&m.unshift(0),r(w,m,k),d==-1&&(k=w.length,d=e(U,w,E,k),d<1&&(p++,r(w,E<k?R:U,k))),k=w.length):d===0&&(p++,w=[0]),v[h++]=p,d&&w[0]?w[k++]=C[I]||0:(w=[C[I]],k=1);while((I++<O||w[0]!==void 0)&&T--)}return v[0]||v.shift(),b.e=u,Sr(b,l?a+kn(b)+1:a)}})();function BB(t,e){var r,n,i,a,l,d,u=0,h=0,p=t.constructor,m=p.precision;if(kn(t)>16)throw Error(ok+kn(t));if(!t.s)return new p(hi);for(Vr=!1,d=m,l=new p(.03125);t.abs().gte(.1);)t=t.times(l),h+=5;for(n=Math.log(Kc(2,h))/Math.LN10*2+5|0,d+=n,r=i=a=new p(hi),p.precision=d;;){if(i=Sr(i.times(t),d),r=r.times(++u),l=a.plus(Vo(i,r,d)),Ga(l.d).slice(0,d)===Ga(a.d).slice(0,d)){for(;h--;)a=Sr(a.times(a),d);return p.precision=m,e==null?(Vr=!0,Sr(a,m)):a}a=l}}function kn(t){for(var e=t.e*Br,r=t.d[0];r>=10;r/=10)e++;return e}function H2(t,e,r){if(e>t.LN10.sd())throw Vr=!0,r&&(t.precision=r),Error(Xi+"LN10 precision limit exceeded");return Sr(new t(t.LN10),e)}function Xl(t){for(var e="";t--;)e+="0";return e}function b0(t,e){var r,n,i,a,l,d,u,h,p,m=1,x=10,b=t,v=b.d,w=b.constructor,k=w.precision;if(b.s<1)throw Error(Xi+(b.s?"NaN":"-Infinity"));if(b.eq(hi))return new w(0);if(e==null?(Vr=!1,h=k):h=e,b.eq(10))return e==null&&(Vr=!0),H2(w,h);if(h+=x,w.precision=h,r=Ga(v),n=r.charAt(0),a=kn(b),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)b=b.times(t),r=Ga(b.d),n=r.charAt(0),m++;a=kn(b),n>1?(b=new w("0."+r),a++):b=new w(n+"."+r.slice(1))}else return u=H2(w,h+2,k).times(a+""),b=b0(new w(n+"."+r.slice(1)),h-x).plus(u),w.precision=k,e==null?(Vr=!0,Sr(b,k)):b;for(d=l=b=Vo(b.minus(hi),b.plus(hi),h),p=Sr(b.times(b),h),i=3;;){if(l=Sr(l.times(p),h),u=d.plus(Vo(l,new w(i),h)),Ga(u.d).slice(0,h)===Ga(d.d).slice(0,h))return d=d.times(2),a!==0&&(d=d.plus(H2(w,h+2,k).times(a+""))),d=Vo(d,new w(m),h),w.precision=k,e==null?(Vr=!0,Sr(d,k)):d;d=u,i+=2}}function N8(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=mh(r/Br),t.d=[],n=(r+1)%Br,r<0&&(n+=Br),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=Br;n<i;)t.d.push(+e.slice(n,n+=Br));e=e.slice(n),n=Br-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Vr&&(t.e>Rx||t.e<-Rx))throw Error(ok+r)}else t.s=0,t.e=0,t.d=[0];return t}function Sr(t,e,r){var n,i,a,l,d,u,h,p,m=t.d;for(l=1,a=m[0];a>=10;a/=10)l++;if(n=e-l,n<0)n+=Br,i=e,h=m[p=0];else{if(p=Math.ceil((n+1)/Br),a=m.length,p>=a)return t;for(h=a=m[p],l=1;a>=10;a/=10)l++;n%=Br,i=n-Br+l}if(r!==void 0&&(a=Kc(10,l-i-1),d=h/a%10|0,u=e<0||m[p+1]!==void 0||h%a,u=r<4?(d||u)&&(r==0||r==(t.s<0?3:2)):d>5||d==5&&(r==4||u||r==6&&(n>0?i>0?h/Kc(10,l-i):0:m[p-1])%10&1||r==(t.s<0?8:7))),e<1||!m[0])return u?(a=kn(t),m.length=1,e=e-a-1,m[0]=Kc(10,(Br-e%Br)%Br),t.e=mh(-e/Br)||0):(m.length=1,m[0]=t.e=t.s=0),t;if(n==0?(m.length=p,a=1,p--):(m.length=p+1,a=Kc(10,Br-n),m[p]=i>0?(h/Kc(10,l-i)%Kc(10,i)|0)*a:0),u)for(;;)if(p==0){(m[0]+=a)==$n&&(m[0]=1,++t.e);break}else{if(m[p]+=a,m[p]!=$n)break;m[p--]=0,a=1}for(n=m.length;m[--n]===0;)m.pop();if(Vr&&(t.e>Rx||t.e<-Rx))throw Error(ok+kn(t));return t}function $B(t,e){var r,n,i,a,l,d,u,h,p,m,x=t.constructor,b=x.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new x(t),Vr?Sr(e,b):e;if(u=t.d,m=e.d,n=e.e,h=t.e,u=u.slice(),l=h-n,l){for(p=l<0,p?(r=u,l=-l,d=m.length):(r=m,n=h,d=u.length),i=Math.max(Math.ceil(b/Br),d)+2,l>i&&(l=i,r.length=1),r.reverse(),i=l;i--;)r.push(0);r.reverse()}else{for(i=u.length,d=m.length,p=i<d,p&&(d=i),i=0;i<d;i++)if(u[i]!=m[i]){p=u[i]<m[i];break}l=0}for(p&&(r=u,u=m,m=r,e.s=-e.s),d=u.length,i=m.length-d;i>0;--i)u[d++]=0;for(i=m.length;i>l;){if(u[--i]<m[i]){for(a=i;a&&u[--a]===0;)u[a]=$n-1;--u[a],u[i]+=$n}u[i]-=m[i]}for(;u[--d]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=n,Vr?Sr(e,b):e):new x(0)}function kd(t,e,r){var n,i=kn(t),a=Ga(t.d),l=a.length;return e?(r&&(n=r-l)>0?a=a.charAt(0)+"."+a.slice(1)+Xl(n):l>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Xl(-i-1)+a,r&&(n=r-l)>0&&(a+=Xl(n))):i>=l?(a+=Xl(i+1-l),r&&(n=r-i-1)>0&&(a=a+"."+Xl(n))):((n=i+1)<l&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-l)>0&&(i+1===l&&(a+="."),a+=Xl(n))),t.s<0?"-"+a:a}function k8(t,e){if(t.length>e)return t.length=e,!0}function UB(t){var e,r,n;function i(a){var l=this;if(!(l instanceof i))return new i(a);if(l.constructor=i,a instanceof i){l.s=a.s,l.e=a.e,l.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(ad+a);if(a>0)l.s=1;else if(a<0)a=-a,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(a===~~a&&a<1e7){l.e=0,l.d=[a];return}return N8(l,a.toString())}else if(typeof a!="string")throw Error(ad+a);if(a.charCodeAt(0)===45?(a=a.slice(1),l.s=-1):l.s=1,_xe.test(a))N8(l,a);else throw Error(ad+a)}if(i.prototype=st,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=UB,i.config=i.set=Cxe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function Cxe(t){if(!t||typeof t!="object")throw Error(Xi+"Object expected");var e,r,n,i=["precision",1,ph,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(mh(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(ad+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(ad+r+": "+n);return this}var lk=UB(Sxe);hi=new lk(1);const mr=lk;var Exe=t=>t,zB={},qB=t=>t===zB,S8=t=>function e(){return arguments.length===0||arguments.length===1&&qB(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},FB=(t,e)=>t===1?e:S8(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(l=>l!==zB).length;return a>=t?e(...n):FB(t-a,S8(function(){for(var l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];var h=n.map(p=>qB(p)?d.shift():p);return e(...h,...d)}))}),Axe=t=>FB(t.length,t),IN=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},Txe=Axe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),Oxe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return Exe;var i=r.reverse(),a=i[0],l=i.slice(1);return function(){return l.reduce((d,u)=>u(d),a(...arguments))}};function HB(t){var e;return t===0?e=1:e=Math.floor(new mr(t).abs().log(10).toNumber())+1,e}function WB(t,e,r){for(var n=new mr(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var GB=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},VB=(t,e,r)=>{if(t.lte(0))return new mr(0);var n=HB(t.toNumber()),i=new mr(10).pow(n),a=t.div(i),l=n!==1?.05:.1,d=new mr(Math.ceil(a.div(l).toNumber())).add(r).mul(l),u=d.mul(i);return e?new mr(u.toNumber()):new mr(Math.ceil(u.toNumber()))},Mxe=(t,e,r)=>{var n=new mr(1),i=new mr(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new mr(10).pow(HB(t)-1),i=new mr(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new mr(Math.floor(t)))}else t===0?i=new mr(Math.floor((e-1)/2)):r||(i=new mr(Math.floor(t)));var l=Math.floor((e-1)/2),d=Oxe(Txe(u=>i.add(new mr(u-l).mul(n)).toNumber()),IN);return d(0,e)},KB=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new mr(0),tickMin:new mr(0),tickMax:new mr(0)};var l=VB(new mr(r).sub(e).div(n-1),i,a),d;e<=0&&r>=0?d=new mr(0):(d=new mr(e).add(r).div(2),d=d.sub(new mr(d).mod(l)));var u=Math.ceil(d.sub(e).div(l).toNumber()),h=Math.ceil(new mr(r).sub(d).div(l).toNumber()),p=u+h+1;return p>n?KB(e,r,n,i,a+1):(p<n&&(h=r>0?h+(n-p):h,u=r>0?u:u+(n-p)),{step:l,tickMin:d.sub(new mr(u).mul(l)),tickMax:d.add(new mr(h).mul(l))})},Lxe=function(e){var[r,n]=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(i,2),[d,u]=GB([r,n]);if(d===-1/0||u===1/0){var h=u===1/0?[d,...IN(0,i-1).map(()=>1/0)]:[...IN(0,i-1).map(()=>-1/0),u];return r>n?h.reverse():h}if(d===u)return Mxe(d,i,a);var{step:p,tickMin:m,tickMax:x}=KB(d,u,l,a,0),b=WB(m,x.add(new mr(.1).mul(p)),p);return r>n?b.reverse():b},Rxe=function(e,r){var[n,i]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,d]=GB([n,i]);if(l===-1/0||d===1/0)return[n,i];if(l===d)return[l];var u=Math.max(r,2),h=VB(new mr(d).sub(l).div(u-1),a,0),p=[...WB(new mr(l),new mr(d),h),d];return a===!1&&(p=p.map(m=>Math.round(m))),n>i?p.reverse():p},YB=t=>t.rootProps.maxBarSize,Pxe=t=>t.rootProps.barGap,XB=t=>t.rootProps.barCategoryGap,Ixe=t=>t.rootProps.barSize,ep=t=>t.rootProps.stackOffset,JB=t=>t.rootProps.reverseStackOrder,ck=t=>t.options.chartName,dk=t=>t.rootProps.syncId,QB=t=>t.rootProps.syncMethod,uk=t=>t.options.eventEmitter,gs={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Bo={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ui={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Yy=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},Dxe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Bo.angleAxisId,includeHidden:!1,name:void 0,reversed:Bo.reversed,scale:Bo.scale,tick:Bo.tick,tickCount:void 0,ticks:void 0,type:Bo.type,unit:void 0},Bxe={allowDataOverflow:ui.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ui.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ui.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ui.scale,tick:ui.tick,tickCount:ui.tickCount,ticks:void 0,type:ui.type,unit:void 0},$xe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Bo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Bo.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Bo.scale,tick:Bo.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Uxe={allowDataOverflow:ui.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ui.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ui.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ui.scale,tick:ui.tick,tickCount:ui.tickCount,ticks:void 0,type:"category",unit:void 0},hk=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?$xe:Dxe,fk=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?Uxe:Bxe,Xy=t=>t.polarOptions,pk=we([fl,pl,En],YD),ZB=we([Xy,pk],(t,e)=>{if(t!=null)return xs(t.innerRadius,e,0)}),e$=we([Xy,pk],(t,e)=>{if(t!=null)return xs(t.outerRadius,e,e*.8)}),zxe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},t$=we([Xy],zxe);we([hk,t$],Yy);var r$=we([pk,ZB,e$],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});we([fk,r$],Yy);var n$=we([ar,Xy,ZB,e$,fl,pl],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:l,cy:d,startAngle:u,endAngle:h}=e;return{cx:xs(l,i,i/2),cy:xs(d,a,a/2),innerRadius:r,outerRadius:n,startAngle:u,endAngle:h,clockWise:!1}}}),Kr=(t,e)=>e,tp=(t,e,r)=>r;function mk(t){return t?.id}function s$(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:i,dataKey:a}=r,l=new Map;return t.forEach(d=>{var u,h=(u=d.data)!==null&&u!==void 0?u:n;if(!(h==null||h.length===0)){var p=mk(d);h.forEach((m,x)=>{var b=a==null||i?x:String($r(m,a,null)),v=$r(m,d.dataKey,0),w;l.has(b)?w=l.get(b):w={},Object.assign(w,{[p]:v}),l.set(b,w)})}}),Array.from(l.values())}function Jy(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var Qy=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function Zy(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function qxe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Tn=t=>{var e=ar(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},gh=t=>t.tooltip.settings.axisId;function _8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Px(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_8(Object(r),!0).forEach(function(n){Fxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Fxe(t,e,r){return(e=Hxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hxe(t){var e=Wxe(t,"string");return typeof e=="symbol"?e:e+""}function Wxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DN=[0,"auto"],Dn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},i$=(t,e)=>t.cartesianAxis.xAxis[e],xl=(t,e)=>{var r=i$(t,e);return r??Dn},Bn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:DN,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:V0},a$=(t,e)=>t.cartesianAxis.yAxis[e],yl=(t,e)=>{var r=a$(t,e);return r??Bn},Gxe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},gk=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??Gxe},Qr=(t,e,r)=>{switch(e){case"xAxis":return xl(t,r);case"yAxis":return yl(t,r);case"zAxis":return gk(t,r);case"angleAxis":return hk(t,r);case"radiusAxis":return fk(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Vxe=(t,e,r)=>{switch(e){case"xAxis":return xl(t,r);case"yAxis":return yl(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},rp=(t,e,r)=>{switch(e){case"xAxis":return xl(t,r);case"yAxis":return yl(t,r);case"angleAxis":return hk(t,r);case"radiusAxis":return fk(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},o$=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function xk(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var yk=t=>t.graphicalItems.cartesianItems,Kxe=we([Kr,tp],xk),bk=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),np=we([yk,Qr,Kxe],bk,{memoizeOptions:{resultEqualityCheck:Zy}}),l$=we([np],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(Jy)),c$=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),Yxe=we([np],c$),vk=t=>t.map(e=>e.data).filter(Boolean).flat(1),Xxe=we([np],vk,{memoizeOptions:{resultEqualityCheck:Zy}}),wk=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},jk=we([Xxe,RB],wk),Nk=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:$r(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:$r(i,n)}))):t.map(n=>({value:n})),eb=we([jk,Qr,np],Nk);function d$(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Tg(t){if(ro(t)||t instanceof Date){var e=Number(t);if(Jr(e))return e}}function C8(t){if(Array.isArray(t)){var e=[Tg(t[0]),Tg(t[1])];return yc(e)?e:void 0}var r=Tg(t);if(r!=null)return[r,r]}function sl(t){return t.map(Tg).filter(zde)}function Jxe(t,e,r){return!r||typeof e!="number"||to(e)?[]:r.length?sl(r.flatMap(n=>{var i=$r(t,n.dataKey),a,l;if(Array.isArray(i)?[a,l]=i:a=l=i,!(!Jr(a)||!Jr(l)))return[e-a,e+l]})):[]}var On=t=>{var e=Tn(t),r=gh(t);return rp(t,e,r)},sp=we([On],t=>t?.dataKey),Qxe=we([l$,RB,On],s$),u$=(t,e,r,n)=>{var i={},a=e.reduce((l,d)=>{if(d.stackId==null)return l;var u=l[d.stackId];return u==null&&(u=[]),u.push(d),l[d.stackId]=u,l},i);return Object.fromEntries(Object.entries(a).map(l=>{var[d,u]=l,h=n?[...u].reverse():u,p=h.map(mk);return[d,{stackedData:mfe(t,p,r),graphicalItems:h}]}))},BN=we([Qxe,l$,ep,JB],u$),h$=(t,e,r,n)=>{var{dataStartIndex:i,dataEndIndex:a}=e;if(n==null&&r!=="zAxis"){var l=vfe(t,i,a);if(!(l!=null&&l[0]===0&&l[1]===0))return l}},Zxe=we([Qr],t=>t.allowDataOverflow),kk=t=>{var e;if(t==null||!("domain"in t))return DN;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=sl(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:DN},Sk=we([Qr],kk),_k=we([Sk,Zxe],PB),eye=we([BN,gl,Kr,_k],h$,{memoizeOptions:{resultEqualityCheck:Qy}}),tb=t=>t.errorBars,tye=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>d$(r,n)),Ix=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),l=Math.min(...a),d=Math.max(...a);return[l,d]}},Ck=(t,e,r,n,i)=>{var a,l;if(r.length>0&&t.forEach(d=>{r.forEach(u=>{var h,p,m=(h=n[u.id])===null||h===void 0?void 0:h.filter(_=>d$(i,_)),x=$r(d,(p=e.dataKey)!==null&&p!==void 0?p:u.dataKey),b=Jxe(d,x,m);if(b.length>=2){var v=Math.min(...b),w=Math.max(...b);(a==null||v<a)&&(a=v),(l==null||w>l)&&(l=w)}var k=C8(x);k!=null&&(a=a==null?k[0]:Math.min(a,k[0]),l=l==null?k[1]:Math.max(l,k[1]))})}),e?.dataKey!=null&&t.forEach(d=>{var u=C8($r(d,e.dataKey));u!=null&&(a=a==null?u[0]:Math.min(a,u[0]),l=l==null?u[1]:Math.max(l,u[1]))}),Jr(a)&&Jr(l))return[a,l]},rye=we([jk,Qr,Yxe,tb,Kr],Ck,{memoizeOptions:{resultEqualityCheck:Qy}});function nye(t){var{value:e}=t;if(ro(e)||e instanceof Date)return e}var sye=(t,e,r)=>{var n=t.map(nye).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&A7(n))?ZD(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},f$=t=>t.referenceElements.dots,xh=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),iye=we([f$,Kr,tp],xh),p$=t=>t.referenceElements.areas,aye=we([p$,Kr,tp],xh),m$=t=>t.referenceElements.lines,oye=we([m$,Kr,tp],xh),g$=(t,e)=>{if(t!=null){var r=sl(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},lye=we(iye,Kr,g$),x$=(t,e)=>{if(t!=null){var r=sl(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},cye=we([aye,Kr],x$);function dye(t){var e;if(t.x!=null)return sl([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:sl(r)}function uye(t){var e;if(t.y!=null)return sl([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:sl(r)}var y$=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?dye(n):uye(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},hye=we([oye,Kr],y$),fye=we(lye,hye,cye,(t,e,r)=>Ix(t,r,e)),Ek=(t,e,r,n,i,a,l,d)=>{if(r!=null)return r;var u=l==="vertical"&&d==="xAxis"||l==="horizontal"&&d==="yAxis",h=u?Ix(n,a,i):Ix(a,i);return kxe(e,h,t.allowDataOverflow)},pye=we([Qr,Sk,_k,eye,rye,fye,ar,Kr],Ek,{memoizeOptions:{resultEqualityCheck:Qy}}),mye=[0,1],Ak=(t,e,r,n,i,a,l)=>{if(!((t==null||r==null||r.length===0)&&l===void 0)){var{dataKey:d,type:u}=t,h=Id(e,a);if(h&&d==null){var p;return ZD(0,(p=r?.length)!==null&&p!==void 0?p:0)}return u==="category"?sye(n,t,h):i==="expand"?mye:l}},Tk=we([Qr,ar,jk,eb,ep,Kr,pye],Ak),b$=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:l}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof a=="string"){var d="scale".concat(z0(a));return d in Mf?d:"point"}}},yh=we([Qr,ar,o$,ck,Kr],b$);function gye(t){if(t!=null){if(t in Mf)return Mf[t]();var e="scale".concat(z0(t));if(e in Mf)return Mf[e]()}}function Ok(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=gye(e);if(i!=null){var a=i.domain(r).range(n);return dfe(a),a}}}var Mk=(t,e,r)=>{var n=kk(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&yc(t))return Lxe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&yc(t))return Rxe(t,e.tickCount,e.allowDecimals)}},Lk=we([Tk,rp,yh],Mk),Rk=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&yc(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],l=e[1],d=r[r.length-1];return[Math.min(i,a),Math.max(l,d)]}return e},xye=we([Qr,Tk,Lk,Kr],Rk),yye=we(eb,Qr,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(sl(t.map(m=>m.value))).sort((m,x)=>m-x),i=n[0],a=n[n.length-1];if(i==null||a==null)return 1/0;var l=a-i;if(l===0)return 1/0;for(var d=0;d<n.length-1;d++){var u=n[d],h=n[d+1];if(!(u==null||h==null)){var p=h-u;r=Math.min(r,p)}}return r/l}}),v$=we(yye,ar,XB,En,(t,e,r,n,i)=>i,(t,e,r,n,i)=>{if(!Jr(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var l=xs(r,t*a),d=t*a/2;return d-l-(d-l)/a*l}return 0}),bye=(t,e,r)=>{var n=xl(t,e);return n==null||typeof n.padding!="string"?0:v$(t,"xAxis",e,r,n.padding)},vye=(t,e,r)=>{var n=yl(t,e);return n==null||typeof n.padding!="string"?0:v$(t,"yAxis",e,r,n.padding)},wye=we(xl,bye,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),jye=we(yl,vye,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),Nye=we([En,wye,Ly,My,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),kye=we([En,ar,jye,Ly,My,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:l}=i;return a?[n.height-l.bottom,l.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),ip=(t,e,r,n)=>{var i;switch(e){case"xAxis":return Nye(t,r,n);case"yAxis":return kye(t,r,n);case"zAxis":return(i=gk(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return t$(t);case"radiusAxis":return r$(t,r);default:return}},w$=we([Qr,ip],Yy),rb=we([Qr,yh,xye,w$],Ok);we([np,tb,Kr],tye);function j$(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var nb=(t,e)=>e,sb=(t,e,r)=>r,Sye=we(Ty,nb,sb,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(j$)),_ye=we(Oy,nb,sb,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(j$)),N$=(t,e)=>({width:t.width,height:e.height}),Cye=(t,e)=>{var r=typeof e.width=="number"?e.width:V0;return{width:r,height:t.height}},k$=we(En,xl,N$),Eye=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},Aye=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},Tye=we(pl,En,Sye,nb,sb,(t,e,r,n,i)=>{var a={},l;return r.forEach(d=>{var u=N$(e,d);l==null&&(l=Eye(e,n,t));var h=n==="top"&&!i||n==="bottom"&&i;a[d.id]=l-Number(h)*u.height,l+=(h?-1:1)*u.height}),a}),Oye=we(fl,En,_ye,nb,sb,(t,e,r,n,i)=>{var a={},l;return r.forEach(d=>{var u=Cye(e,d);l==null&&(l=Aye(e,n,t));var h=n==="left"&&!i||n==="right"&&i;a[d.id]=l-Number(h)*u.width,l+=(h?-1:1)*u.width}),a}),Mye=(t,e)=>{var r=xl(t,e);if(r!=null)return Tye(t,r.orientation,r.mirror)},Lye=we([En,xl,Mye,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var i=r?.[n];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),Rye=(t,e)=>{var r=yl(t,e);if(r!=null)return Oye(t,r.orientation,r.mirror)},Pye=we([En,yl,Rye,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var i=r?.[n];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),S$=we(En,yl,(t,e)=>{var r=typeof e.width=="number"?e.width:V0;return{width:r,height:t.height}}),E8=(t,e,r)=>{switch(e){case"xAxis":return k$(t,r).width;case"yAxis":return S$(t,r).height;default:return}},_$=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:l}=r,d=Id(t,n),u=e.map(h=>h.value);if(l&&d&&a==="category"&&i&&A7(u))return u}},Pk=we([ar,eb,Qr,Kr],_$),C$=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,l=Id(t,n);if(l&&(i==="number"||a!=="auto"))return e.map(d=>d.value)}},Ik=we([ar,eb,rp,Kr],C$);we([ar,Vxe,yh,rb,Pk,Ik,ip,Lk,Kr],(t,e,r,n,i,a,l,d,u)=>{if(e!=null){var h=Id(t,u);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:u,categoricalDomain:a,duplicateDomain:i,isCategorical:h,niceTicks:d,range:l,realScaleType:r,scale:n}}});var Iye=(t,e,r,n,i,a,l,d,u)=>{if(!(e==null||n==null)){var h=Id(t,u),{type:p,ticks:m,tickCount:x}=e,b=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,v=p==="category"&&n.bandwidth?n.bandwidth()/b:0;v=u==="angleAxis"&&a!=null&&a.length>=2?rs(a[0]-a[1])*2*v:v;var w=m||i;if(w){var k=w.map((_,T)=>{var A=l?l.indexOf(_):_;return{index:T,coordinate:n(A)+v,value:_,offset:v}});return k.filter(_=>Jr(_.coordinate))}return h&&d?d.map((_,T)=>({coordinate:n(_)+v,value:_,index:T,offset:v})).filter(_=>Jr(_.coordinate)):n.ticks?n.ticks(x).map(_=>({coordinate:n(_)+v,value:_,offset:v})):n.domain().map((_,T)=>({coordinate:n(_)+v,value:l?l[_]:_,index:T,offset:v}))}},E$=we([ar,rp,yh,rb,Lk,ip,Pk,Ik,Kr],Iye),Dye=(t,e,r,n,i,a,l)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var d=Id(t,l),{tickCount:u}=e,h=0;return h=l==="angleAxis"&&n?.length>=2?rs(n[0]-n[1])*2*h:h,d&&a?a.map((p,m)=>({coordinate:r(p)+h,value:p,index:m,offset:h})):r.ticks?r.ticks(u).map(p=>({coordinate:r(p)+h,value:p,offset:h})):r.domain().map((p,m)=>({coordinate:r(p)+h,value:i?i[p]:p,index:m,offset:h}))}},rh=we([ar,rp,rb,ip,Pk,Ik,Kr],Dye),nh=we(Qr,rb,(t,e)=>{if(!(t==null||e==null))return Px(Px({},t),{},{scale:e})}),Bye=we([Qr,yh,Tk,w$],Ok);we((t,e,r)=>gk(t,r),Bye,(t,e)=>{if(!(t==null||e==null))return Px(Px({},t),{},{scale:e})});var $ye=we([ar,Ty,Oy],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),A$=t=>t.options.defaultTooltipEventType,T$=t=>t.options.validateTooltipEventTypes;function O$(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Dk(t,e){var r=A$(t),n=T$(t);return O$(e,r,n)}function Uye(t){return ft(e=>Dk(e,t))}var M$=(t,e)=>{var r,n=Number(e);if(!(to(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},zye=t=>t.tooltip.settings,rc={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},qye={itemInteraction:{click:rc,hover:rc},axisInteraction:{click:rc,hover:rc},keyboardInteraction:rc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},L$=Ys({name:"tooltip",initialState:qye,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Wr()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,i=Na(t).tooltipItemPayloads.indexOf(r);i>-1&&(t.tooltipItemPayloads[i]=n)},prepare:Wr()},removeTooltipEntrySettings:{reducer(t,e){var r=Na(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Wr()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:Fye,replaceTooltipEntrySettings:Hye,removeTooltipEntrySettings:Wye,setTooltipSettingsState:Gye,setActiveMouseOverItemIndex:R$,mouseLeaveItem:Vye,mouseLeaveChart:P$,setActiveClickItemIndex:Kye,setMouseOverAxisIndex:I$,setMouseClickAxisIndex:Yye,setSyncInteraction:$N,setKeyboardInteraction:UN}=L$.actions,Xye=L$.reducer;function A8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?A8(Object(r),!0).forEach(function(n){Jye(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jye(t,e,r){return(e=Qye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qye(t){var e=Zye(t,"string");return typeof e=="symbol"?e:e+""}function Zye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ebe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function tbe(t){return t.index!=null}var D$=(t,e,r,n)=>{if(e==null)return rc;var i=ebe(t,e,r);if(i==null)return rc;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(tbe(i)){if(a)return lg(lg({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return lg(lg({},rc),{},{coordinate:i.coordinate})};function rbe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function nbe(t,e){var r=rbe(t),n=e[0],i=e[1];if(r===void 0)return!1;var a=Math.min(n,i),l=Math.max(n,i);return r>=a&&r<=l}function sbe(t,e,r){if(r==null||e==null)return!0;var n=$r(t,e);return n==null||!yc(r)?!0:nbe(n,r)}var Bk=(t,e,r,n)=>{var i=t?.index;if(i==null)return null;var a=Number(i);if(!Jr(a))return i;var l=0,d=1/0;e.length>0&&(d=e.length-1);var u=Math.max(l,Math.min(a,d)),h=e[u];return h==null||sbe(h,r,n)?String(u):null},B$=(t,e,r,n,i,a,l,d)=>{if(!(a==null||d==null)){var u=l[0],h=u==null?void 0:d(u.positions,a);if(h!=null)return h;var p=i?.[Number(a)];if(p)return r==="horizontal"?{x:p.coordinate,y:(n.top+e)/2}:{x:(n.left+t)/2,y:p.coordinate}}},$$=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=t.itemInteraction.hover.graphicalItemId:i=t.itemInteraction.click.graphicalItemId,i==null&&n!=null){var a=t.tooltipItemPayloads[0];return a!=null?[a]:[]}return t.tooltipItemPayloads.filter(l=>{var d;return((d=l.settings)===null||d===void 0?void 0:d.graphicalItemId)===i})},ap=t=>t.options.tooltipPayloadSearcher,bh=t=>t.tooltip;function T8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function O8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?T8(Object(r),!0).forEach(function(n){ibe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ibe(t,e,r){return(e=abe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function abe(t){var e=obe(t,"string");return typeof e=="symbol"?e:e+""}function obe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lbe(t,e){return t??e}var U$=(t,e,r,n,i,a,l)=>{if(!(e==null||a==null)){var{chartData:d,computedData:u,dataStartIndex:h,dataEndIndex:p}=r,m=[];return t.reduce((x,b)=>{var v,{dataDefinedOnItem:w,settings:k}=b,_=lbe(w,d),T=Array.isArray(_)?jD(_,h,p):_,A=(v=k?.dataKey)!==null&&v!==void 0?v:n,I=k?.nameKey,O;if(n&&Array.isArray(T)&&!Array.isArray(T[0])&&l==="axis"?O=Ude(T,n,i):O=a(T,e,u,I),Array.isArray(O))O.forEach(E=>{var R=O8(O8({},k),{},{name:E.name,unit:E.unit,color:void 0,fill:void 0});x.push(LO({tooltipEntrySettings:R,dataKey:E.dataKey,payload:E.payload,value:$r(E.payload,E.dataKey),name:E.name}))});else{var M;x.push(LO({tooltipEntrySettings:k,dataKey:A,payload:O,value:$r(O,A),name:(M=$r(O,I))!==null&&M!==void 0?M:k?.name}))}return x},m)}},$k=we([On,ar,o$,ck,Tn],b$),cbe=we([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),dbe=we([Tn,gh],xk),vh=we([cbe,On,dbe],bk,{memoizeOptions:{resultEqualityCheck:Zy}}),ube=we([vh],t=>t.filter(Jy)),hbe=we([vh],vk,{memoizeOptions:{resultEqualityCheck:Zy}}),wh=we([hbe,gl],wk),fbe=we([ube,gl,On],s$),Uk=we([wh,On,vh],Nk),z$=we([On],kk),pbe=we([On],t=>t.allowDataOverflow),q$=we([z$,pbe],PB),mbe=we([vh],t=>t.filter(Jy)),gbe=we([fbe,mbe,ep,JB],u$),xbe=we([gbe,gl,Tn,q$],h$),ybe=we([vh],c$),bbe=we([wh,On,ybe,tb,Tn],Ck,{memoizeOptions:{resultEqualityCheck:Qy}}),vbe=we([f$,Tn,gh],xh),wbe=we([vbe,Tn],g$),jbe=we([p$,Tn,gh],xh),Nbe=we([jbe,Tn],x$),kbe=we([m$,Tn,gh],xh),Sbe=we([kbe,Tn],y$),_be=we([wbe,Sbe,Nbe],Ix),Cbe=we([On,z$,q$,xbe,bbe,_be,ar,Tn],Ek),op=we([On,ar,wh,Uk,ep,Tn,Cbe],Ak),Ebe=we([op,On,$k],Mk),Abe=we([On,op,Ebe,Tn],Rk),F$=t=>{var e=Tn(t),r=gh(t),n=!1;return ip(t,e,r,n)},H$=we([On,F$],Yy),W$=we([On,$k,Abe,H$],Ok),Tbe=we([ar,Uk,On,Tn],_$),Obe=we([ar,Uk,On,Tn],C$),Mbe=(t,e,r,n,i,a,l,d)=>{if(e){var{type:u}=e,h=Id(t,d);if(n){var p=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=u==="category"&&n.bandwidth?n.bandwidth()/p:0;return m=d==="angleAxis"&&i!=null&&i?.length>=2?rs(i[0]-i[1])*2*m:m,h&&l?l.map((x,b)=>({coordinate:n(x)+m,value:x,index:b,offset:m})):n.domain().map((x,b)=>({coordinate:n(x)+m,value:a?a[x]:x,index:b,offset:m}))}}},bl=we([ar,On,$k,W$,F$,Tbe,Obe,Tn],Mbe),zk=we([A$,T$,zye],(t,e,r)=>O$(r.shared,t,e)),G$=t=>t.tooltip.settings.trigger,qk=t=>t.tooltip.settings.defaultIndex,lp=we([bh,zk,G$,qk],D$),Sd=we([lp,wh,sp,op],Bk),V$=we([bl,Sd],M$),Fk=we([lp],t=>{if(t)return t.dataKey}),Lbe=we([lp],t=>{if(t)return t.graphicalItemId}),K$=we([bh,zk,G$,qk],$$),Rbe=we([fl,pl,ar,En,bl,qk,K$,ap],B$),Pbe=we([lp,Rbe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),Ibe=we([lp],t=>{var e;return(e=t?.active)!==null&&e!==void 0?e:!1}),Dbe=we([K$,Sd,gl,sp,V$,ap,zk],U$);we([Dbe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function M8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function L8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?M8(Object(r),!0).forEach(function(n){Bbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):M8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Bbe(t,e,r){return(e=$be(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $be(t){var e=Ube(t,"string");return typeof e=="symbol"?e:e+""}function Ube(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zbe=()=>ft(On),qbe=()=>{var t=zbe(),e=ft(bl),r=ft(W$);return gx(!t||!r?void 0:L8(L8({},t),{},{scale:r}),e)};function R8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ju(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?R8(Object(r),!0).forEach(function(n){Fbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Fbe(t,e,r){return(e=Hbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hbe(t){var e=Wbe(t,"string");return typeof e=="symbol"?e:e+""}function Wbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gbe=(t,e,r,n)=>{var i=e.find(a=>a&&a.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},Vbe=(t,e,r,n)=>{var i=e.find(h=>h&&h.index===r);if(i){if(t==="centric"){var a=i.coordinate,{radius:l}=n;return ju(ju(ju({},n),Nn(n.cx,n.cy,l,a)),{},{angle:a,radius:l})}var d=i.coordinate,{angle:u}=n;return ju(ju(ju({},n),Nn(n.cx,n.cy,d,u)),{},{angle:u,radius:d})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Kbe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var Y$=(t,e,r,n,i)=>{var a,l=(a=e?.length)!==null&&a!==void 0?a:0;if(l<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<l;d++){var u,h,p,m,x,b=d>0?(u=r[d-1])===null||u===void 0?void 0:u.coordinate:(h=r[l-1])===null||h===void 0?void 0:h.coordinate,v=(p=r[d])===null||p===void 0?void 0:p.coordinate,w=d>=l-1?(m=r[0])===null||m===void 0?void 0:m.coordinate:(x=r[d+1])===null||x===void 0?void 0:x.coordinate,k=void 0;if(!(b==null||v==null||w==null))if(rs(v-b)!==rs(w-v)){var _=[];if(rs(w-v)===rs(i[1]-i[0])){k=w;var T=v+i[1]-i[0];_[0]=Math.min(T,(T+b)/2),_[1]=Math.max(T,(T+b)/2)}else{k=b;var A=w+i[1]-i[0];_[0]=Math.min(v,(A+v)/2),_[1]=Math.max(v,(A+v)/2)}var I=[Math.min(v,(k+v)/2),Math.max(v,(k+v)/2)];if(t>I[0]&&t<=I[1]||t>=_[0]&&t<=_[1]){var O;return(O=r[d])===null||O===void 0?void 0:O.index}}else{var M=Math.min(b,w),E=Math.max(b,w);if(t>(M+v)/2&&t<=(E+v)/2){var R;return(R=r[d])===null||R===void 0?void 0:R.index}}}else if(e)for(var $=0;$<l;$++){var B=e[$];if(B!=null){var C=e[$+1],U=e[$-1];if($===0&&C!=null&&t<=(B.coordinate+C.coordinate)/2||$===l-1&&U!=null&&t>(B.coordinate+U.coordinate)/2||$>0&&$<l-1&&U!=null&&C!=null&&t>(B.coordinate+U.coordinate)/2&&t<=(B.coordinate+C.coordinate)/2)return B.index}}return-1},Ybe=()=>ft(ck),Hk=(t,e)=>e,X$=(t,e,r)=>r,Wk=(t,e,r,n)=>n,Xbe=we(bl,t=>vy(t,e=>e.coordinate)),Gk=we([bh,Hk,X$,Wk],D$),Vk=we([Gk,wh,sp,op],Bk),Jbe=(t,e,r)=>{if(e!=null){var n=bh(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},J$=we([bh,Hk,X$,Wk],$$),Dx=we([fl,pl,ar,En,bl,Wk,J$,ap],B$),Qbe=we([Gk,Dx],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),Q$=we([bl,Vk],M$),Zbe=we([J$,Vk,gl,sp,Q$,ap,Hk],U$),eve=we([Gk,Vk],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),tve=(t,e,r,n,i,a,l)=>{if(!(!t||!r||!n||!i)&&Kbe(t,l)){var d=wfe(t,e),u=Y$(d,a,i,r,n),h=Gbe(e,i,u,t);return{activeIndex:String(u),activeCoordinate:h}}},rve=(t,e,r,n,i,a,l)=>{if(!(!t||!n||!i||!a||!r)){var d=$pe(t,r);if(d){var u=jfe(d,e),h=Y$(u,l,a,n,i),p=Vbe(e,a,h,d);return{activeIndex:String(h),activeCoordinate:p}}}},nve=(t,e,r,n,i,a,l,d)=>{if(!(!t||!e||!n||!i||!a))return e==="horizontal"||e==="vertical"?tve(t,e,n,i,a,l,d):rve(t,e,r,n,i,a,l)},sve=we(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),ive=we(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(gs)),r=Array.from(new Set(e));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:qxe}});function P8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function I8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?P8(Object(r),!0).forEach(function(n){ave(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ave(t,e,r){return(e=ove(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ove(t){var e=lve(t,"string");return typeof e=="symbol"?e:e+""}function lve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cve={},dve={zIndexMap:Object.values(gs).reduce((t,e)=>I8(I8({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),cve)},uve=new Set(Object.values(gs));function hve(t){return uve.has(t)}var Z$=Ys({name:"zIndex",initialState:dve,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Wr()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!hve(r)&&delete t.zIndexMap[r])},prepare:Wr()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:i}=e.payload;t.zIndexMap[r]?i?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:Wr()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Wr()}}}),{registerZIndexPortal:fve,unregisterZIndexPortal:pve,registerZIndexPortalElement:mve,unregisterZIndexPortalElement:gve}=Z$.actions,xve=Z$.reducer;function co(t){var{zIndex:e,children:r}=t,n=e0e(),i=n&&e!==void 0&&e!==0,a=vi(),l=Or();y.useLayoutEffect(()=>i?(l(fve({zIndex:e})),()=>{l(pve({zIndex:e}))}):q0,[l,e,i]);var d=ft(u=>sve(u,e,a));return i?d?ln.createPortal(r,d):null:r}function zN(){return zN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zN.apply(null,arguments)}function D8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function cg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?D8(Object(r),!0).forEach(function(n){yve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):D8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yve(t,e,r){return(e=bve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bve(t){var e=vve(t,"string");return typeof e=="symbol"?e:e+""}function vve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wve(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return y.isValidElement(e)?y.cloneElement(e,n):y.createElement(r,n)}function jve(t){var e,{coordinate:r,payload:n,index:i,offset:a,tooltipAxisBandSize:l,layout:d,cursor:u,tooltipEventType:h,chartName:p}=t,m=r,x=n,b=i;if(!u||!m||p!=="ScatterChart"&&h!=="axis")return null;var v,w,k;if(p==="ScatterChart")v=m,w=Z0e,k=gs.cursorLine;else if(p==="BarChart")v=epe(d,m,a,l),w=KD,k=gs.cursorRectangle;else if(d==="radial"&&O7(m)){var{cx:_,cy:T,radius:A,startAngle:I,endAngle:O}=XD(m);v={cx:_,cy:T,startAngle:I,endAngle:O,innerRadius:A,outerRadius:A},w=QD,k=gs.cursorLine}else v={points:Fpe(d,m,a)},w=D5,k=gs.cursorLine;var M=typeof u=="object"&&"className"in u?u.className:void 0,E=cg(cg(cg(cg({stroke:"#ccc",pointerEvents:"none"},a),v),a0(u)),{},{payload:x,payloadIndex:b,className:gr("recharts-tooltip-cursor",M)});return y.createElement(co,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:k},y.createElement(wve,{cursor:u,cursorComp:w,cursorProps:E}))}function Nve(t){var e=qbe(),r=Qfe(),n=K0(),i=Ybe();return e==null||r==null||n==null||i==null?null:y.createElement(jve,zN({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var eU=y.createContext(null),kve=()=>y.useContext(eU),v0=new XI,qN="recharts.syncEvent.tooltip",B8="recharts.syncEvent.brush";function tU(t,e){if(e){var r=Number.parseInt(e,10);if(!to(r))return t?.[r]}}var Sve={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},rU=Ys({name:"options",initialState:Sve,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),_ve=rU.reducer,{createEventEmitter:Cve}=rU.actions;function Eve(t){return t.tooltip.syncInteraction}var Ave={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},nU=Ys({name:"chartData",initialState:Ave,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:$8,setDataStartEndIndexes:Tve,setComputedData:W5e}=nU.actions,Ove=nU.reducer,Mve=["x","y"];function U8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?U8(Object(r),!0).forEach(function(n){Lve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lve(t,e,r){return(e=Rve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rve(t){var e=Pve(t,"string");return typeof e=="symbol"?e:e+""}function Pve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ive(t,e){if(t==null)return{};var r,n,i=Dve(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Dve(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Bve(){var t=ft(dk),e=ft(uk),r=Or(),n=ft(QB),i=ft(bl),a=K0(),l=Ry(),d=ft(u=>u.rootProps.className);y.useEffect(()=>{if(t==null)return q0;var u=(h,p,m)=>{if(e!==m&&t===h){if(n==="index"){var x;if(l&&p!==null&&p!==void 0&&(x=p.payload)!==null&&x!==void 0&&x.coordinate&&p.payload.sourceViewBox){var b=p.payload.coordinate,{x:v,y:w}=b,k=Ive(b,Mve),{x:_,y:T,width:A,height:I}=p.payload.sourceViewBox,O=Nu(Nu({},k),{},{x:l.x+(A?(v-_)/A:0)*l.width,y:l.y+(I?(w-T)/I:0)*l.height});r(Nu(Nu({},p),{},{payload:Nu(Nu({},p.payload),{},{coordinate:O})}))}else r(p);return}if(i!=null){var M;if(typeof n=="function"){var E={activeTooltipIndex:p.payload.index==null?void 0:Number(p.payload.index),isTooltipActive:p.payload.active,activeIndex:p.payload.index==null?void 0:Number(p.payload.index),activeLabel:p.payload.label,activeDataKey:p.payload.dataKey,activeCoordinate:p.payload.coordinate},R=n(i,E);M=i[R]}else n==="value"&&(M=i.find(W=>String(W.value)===p.payload.label));var{coordinate:$}=p.payload;if(M==null||p.payload.active===!1||$==null||l==null){r($N({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:C}=$,U=Math.min(B,l.x+l.width),L=Math.min(C,l.y+l.height),q={x:a==="horizontal"?M.coordinate:U,y:a==="horizontal"?L:M.coordinate},K=$N({active:p.payload.active,coordinate:q,dataKey:p.payload.dataKey,index:String(M.index),label:p.payload.label,sourceViewBox:p.payload.sourceViewBox,graphicalItemId:p.payload.graphicalItemId});r(K)}}};return v0.on(qN,u),()=>{v0.off(qN,u)}},[d,r,e,t,n,i,a,l])}function $ve(){var t=ft(dk),e=ft(uk),r=Or();y.useEffect(()=>{if(t==null)return q0;var n=(i,a,l)=>{e!==l&&t===i&&r(Tve(a))};return v0.on(B8,n),()=>{v0.off(B8,n)}},[r,e,t])}function Uve(){var t=Or();y.useEffect(()=>{t(Cve())},[t]),Bve(),$ve()}function zve(t,e,r,n,i,a){var l=ft(b=>Jbe(b,t,e)),d=ft(uk),u=ft(dk),h=ft(QB),p=ft(Eve),m=p?.active,x=Ry();y.useEffect(()=>{if(!m&&u!=null&&d!=null){var b=$N({active:a,coordinate:r,dataKey:l,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:x,graphicalItemId:void 0});v0.emit(qN,u,b,d)}},[m,r,l,i,n,d,u,h,a,x])}function z8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function q8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?z8(Object(r),!0).forEach(function(n){qve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qve(t,e,r){return(e=Fve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fve(t){var e=Hve(t,"string");return typeof e=="symbol"?e:e+""}function Hve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wve(t){return t.dataKey}function Gve(t,e){return y.isValidElement(t)?y.cloneElement(t,e):typeof t=="function"?y.createElement(t,e):y.createElement(M0e,e)}var F8=[],Vve={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function H8(t){var e,r,n=ss(t,Vve),{active:i,allowEscapeViewBox:a,animationDuration:l,animationEasing:d,content:u,filterNull:h,isAnimationActive:p,offset:m,payloadUniqBy:x,position:b,reverseDirection:v,useTranslate3d:w,wrapperStyle:k,cursor:_,shared:T,trigger:A,defaultIndex:I,portal:O,axisId:M}=n,E=Or(),R=typeof I=="number"?String(I):I;y.useEffect(()=>{E(Gye({shared:T,trigger:A,axisId:M,active:i,defaultIndex:R}))},[E,T,A,M,i,R]);var $=Ry(),B=FD(),C=Uye(T),{activeIndex:U,isActive:L}=(e=ft(de=>eve(de,C,A,R)))!==null&&e!==void 0?e:{},q=ft(de=>Zbe(de,C,A,R)),K=ft(de=>Q$(de,C,A,R)),W=ft(de=>Qbe(de,C,A,R)),V=q,X=kve(),Z=(r=i??L)!==null&&r!==void 0?r:!1,[G,F]=G7([V,Z]),Y=C==="axis"?K:void 0;zve(C,A,W,Y,U,Z);var ne=O??X;if(ne==null||$==null||C==null)return null;var re=V??F8;Z||(re=F8),h&&re.length&&(re=z7(re.filter(de=>de.value!=null&&(de.hide!==!0||n.includeHidden)),x,Wve));var ue=re.length>0,Le=y.createElement($0e,{allowEscapeViewBox:a,animationDuration:l,animationEasing:d,isAnimationActive:p,active:Z,coordinate:W,hasPayload:ue,offset:m,position:b,reverseDirection:v,useTranslate3d:w,viewBox:$,wrapperStyle:k,lastBoundingBox:G,innerRef:F,hasPortalFromProps:!!O},Gve(u,q8(q8({},n),{},{payload:re,label:Y,active:Z,activeIndex:U,coordinate:W,accessibilityLayer:B})));return y.createElement(y.Fragment,null,ln.createPortal(Le,ne),Z&&y.createElement(Nve,{cursor:_,tooltipEventType:C,coordinate:W,payload:re,index:U}))}var sh=t=>null;sh.displayName="Cell";function Kve(t,e,r){return(e=Yve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yve(t){var e=Xve(t,"string");return typeof e=="symbol"?e:e+""}function Xve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jve{constructor(e){Kve(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function W8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Qve(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?W8(Object(r),!0).forEach(function(n){Zve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zve(t,e,r){return(e=e1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e1e(t){var e=t1e(t,"string");return typeof e=="symbol"?e:e+""}function t1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var r1e={cacheSize:2e3,enableCache:!0},sU=Qve({},r1e),G8=new Jve(sU.cacheSize),n1e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},V8="recharts_measurement_span";function s1e(t,e){var r=e.fontSize||"",n=e.fontFamily||"",i=e.fontWeight||"",a=e.fontStyle||"",l=e.letterSpacing||"",d=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(l,"|").concat(d)}var K8=(t,e)=>{try{var r=document.getElementById(V8);r||(r=document.createElement("span"),r.setAttribute("id",V8),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,n1e,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ff=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||$y.isSsr)return{width:0,height:0};if(!sU.enableCache)return K8(e,r);var n=s1e(e,r),i=G8.get(n);if(i)return i;var a=K8(e,r);return G8.set(n,a),a},iU;function i1e(t,e,r){return(e=a1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a1e(t){var e=o1e(t,"string");return typeof e=="symbol"?e:e+""}function o1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Y8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,X8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,l1e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,c1e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,d1e={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},u1e=["cm","mm","pt","pc","in","Q","px"];function h1e(t){return u1e.includes(t)}var Lu="NaN";function f1e(t,e){return t*d1e[e]}class es{static parse(e){var r,[,n,i]=(r=c1e.exec(e))!==null&&r!==void 0?r:[];return n==null?es.NaN:new es(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,to(e)&&(this.unit=""),r!==""&&!l1e.test(r)&&(this.num=NaN,this.unit=""),h1e(r)&&(this.num=f1e(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new es(NaN,""):new es(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new es(NaN,""):new es(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new es(NaN,""):new es(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new es(NaN,""):new es(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return to(this.num)}}iU=es;i1e(es,"NaN",new iU(NaN,""));function aU(t){if(t==null||t.includes(Lu))return Lu;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=Y8.exec(e))!==null&&r!==void 0?r:[],l=es.parse(n??""),d=es.parse(a??""),u=i==="*"?l.multiply(d):l.divide(d);if(u.isNaN())return Lu;e=e.replace(Y8,u.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var h,[,p,m,x]=(h=X8.exec(e))!==null&&h!==void 0?h:[],b=es.parse(p??""),v=es.parse(x??""),w=m==="+"?b.add(v):b.subtract(v);if(w.isNaN())return Lu;e=e.replace(X8,w.toString())}return e}var J8=/\(([^()]*)\)/;function p1e(t){for(var e=t,r;(r=J8.exec(e))!=null;){var[,n]=r;e=e.replace(J8,aU(n))}return e}function m1e(t){var e=t.replace(/\s+/g,"");return e=p1e(e),e=aU(e),e}function g1e(t){try{return m1e(t)}catch{return Lu}}function W2(t){var e=g1e(t.slice(5,-1));return e===Lu?"":e}var x1e=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],y1e=["dx","dy","angle","className","breakAll"];function FN(){return FN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},FN.apply(null,arguments)}function Q8(t,e){if(t==null)return{};var r,n,i=b1e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function b1e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var oU=/[ \f\n\r\t\v\u2028\u2029]+/,lU=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];zn(e)||(r?i=e.toString().split(""):i=e.toString().split(oU));var a=i.map(d=>({word:d,width:Ff(d,n).width})),l=r?0:Ff("",n).width;return{wordsWithComputedWidth:a,spaceWidth:l}}catch{return null}};function v1e(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var cU=(t,e,r,n)=>t.reduce((i,a)=>{var{word:l,width:d}=a,u=i[i.length-1];if(u&&d!=null&&(e==null||n||u.width+d+r<Number(e)))u.words.push(l),u.width+=d+r;else{var h={words:[l],width:d};i.push(h)}return i},[]),dU=t=>t.reduce((e,r)=>e.width>r.width?e:r),w1e="",Z8=(t,e,r,n,i,a,l,d)=>{var u=t.slice(0,e),h=lU({breakAll:r,style:n,children:u+w1e});if(!h)return[!1,[]];var p=cU(h.wordsWithComputedWidth,a,l,d),m=p.length>i||dU(p).width>Number(a);return[m,p]},j1e=(t,e,r,n,i)=>{var{maxLines:a,children:l,style:d,breakAll:u}=t,h=gt(a),p=String(l),m=cU(e,n,r,i);if(!h||i)return m;var x=m.length>a||dU(m).width>Number(n);if(!x)return m;for(var b=0,v=p.length-1,w=0,k;b<=v&&w<=p.length-1;){var _=Math.floor((b+v)/2),T=_-1,[A,I]=Z8(p,T,u,d,a,n,r,i),[O]=Z8(p,_,u,d,a,n,r,i);if(!A&&!O&&(b=_+1),A&&O&&(v=_-1),!A&&O){k=I;break}w++}return k||m},eL=t=>{var e=zn(t)?[]:t.toString().split(oU);return[{words:e,width:void 0}]},N1e=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:l}=t;if((e||r)&&!$y.isSsr){var d,u,h=lU({breakAll:a,children:n,style:i});if(h){var{wordsWithComputedWidth:p,spaceWidth:m}=h;d=p,u=m}else return eL(n);return j1e({breakAll:a,children:n,maxLines:l,style:i},d,u,e,!!r)}return eL(n)},uU="#808080",k1e={angle:0,breakAll:!1,capHeight:"0.71em",fill:uU,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},ib=y.forwardRef((t,e)=>{var r=ss(t,k1e),{x:n,y:i,lineHeight:a,capHeight:l,fill:d,scaleToFit:u,textAnchor:h,verticalAnchor:p}=r,m=Q8(r,x1e),x=y.useMemo(()=>N1e({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:u,style:m.style,width:m.width}),[m.breakAll,m.children,m.maxLines,u,m.style,m.width]),{dx:b,dy:v,angle:w,className:k,breakAll:_}=m,T=Q8(m,y1e);if(!ro(n)||!ro(i)||x.length===0)return null;var A=Number(n)+(gt(b)?b:0),I=Number(i)+(gt(v)?v:0);if(!Jr(A)||!Jr(I))return null;var O;switch(p){case"start":O=W2("calc(".concat(l,")"));break;case"middle":O=W2("calc(".concat((x.length-1)/2," * -").concat(a," + (").concat(l," / 2))"));break;default:O=W2("calc(".concat(x.length-1," * -").concat(a,")"));break}var M=[];if(u){var E=x[0].width,{width:R}=m;M.push("scale(".concat(gt(R)&&gt(E)?R/E:1,")"))}return w&&M.push("rotate(".concat(w,", ").concat(A,", ").concat(I,")")),M.length&&(T.transform=M.join(" ")),y.createElement("text",FN({},Ki(T),{ref:e,x:A,y:I,className:gr("recharts-text",k),textAnchor:h,fill:d.includes("url")?uU:d}),x.map(($,B)=>{var C=$.words.join(_?"":" ");return y.createElement("tspan",{x:A,dy:B===0?O:a,key:"".concat(C,"-").concat(B)},C)}))});ib.displayName="Text";var S1e=["labelRef"],_1e=["content"];function tL(t,e){if(t==null)return{};var r,n,i=C1e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function C1e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function rL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rL(Object(r),!0).forEach(function(n){E1e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function E1e(t,e,r){return(e=A1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A1e(t){var e=T1e(t,"string");return typeof e=="symbol"?e:e+""}function T1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $o(){return $o=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$o.apply(null,arguments)}var hU=y.createContext(null),O1e=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:i,width:a,height:l,children:d}=t,u=y.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:i,width:a,height:l}),[e,r,n,i,a,l]);return y.createElement(hU.Provider,{value:u},d)},fU=()=>{var t=y.useContext(hU),e=Ry();return t||AD(e)},M1e=y.createContext(null),L1e=()=>{var t=y.useContext(M1e),e=ft(n$);return t||e},R1e=t=>{var{value:e,formatter:r}=t,n=zn(t.children)?e:t.children;return typeof r=="function"?r(n):n},Kk=t=>t!=null&&typeof t=="function",P1e=(t,e)=>{var r=rs(e-t),n=Math.min(Math.abs(e-t),360);return r*n},I1e=(t,e,r,n,i)=>{var{offset:a,className:l}=t,{cx:d,cy:u,innerRadius:h,outerRadius:p,startAngle:m,endAngle:x,clockWise:b}=i,v=(h+p)/2,w=P1e(m,x),k=w>=0?1:-1,_,T;switch(e){case"insideStart":_=m+k*a,T=b;break;case"insideEnd":_=x-k*a,T=!b;break;case"end":_=x+k*a,T=b;break;default:throw new Error("Unsupported position ".concat(e))}T=w<=0?T:!T;var A=Nn(d,u,v,_),I=Nn(d,u,v,_+(T?1:-1)*359),O="M".concat(A.x,",").concat(A.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(T?0:1,`,
    `).concat(I.x,",").concat(I.y),M=zn(t.id)?o0("recharts-radial-line-"):t.id;return y.createElement("text",$o({},n,{dominantBaseline:"central",className:gr("recharts-radial-bar-label",l)}),y.createElement("defs",null,y.createElement("path",{id:M,d:O})),y.createElement("textPath",{xlinkHref:"#".concat(M)},r))},D1e=(t,e,r)=>{var{cx:n,cy:i,innerRadius:a,outerRadius:l,startAngle:d,endAngle:u}=t,h=(d+u)/2;if(r==="outside"){var{x:p,y:m}=Nn(n,i,l+e,h);return{x:p,y:m,textAnchor:p>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(a+l)/2,{x:b,y:v}=Nn(n,i,x,h);return{x:b,y:v,textAnchor:"middle",verticalAnchor:"middle"}},HN=t=>"cx"in t&&gt(t.cx),B1e=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,a;r!=null&&!HN(r)&&(a=r);var{x:l,y:d,upperWidth:u,lowerWidth:h,height:p}=e,m=l,x=l+(u-h)/2,b=(m+x)/2,v=(u+h)/2,w=m+u/2,k=p>=0?1:-1,_=k*n,T=k>0?"end":"start",A=k>0?"start":"end",I=u>=0?1:-1,O=I*n,M=I>0?"end":"start",E=I>0?"start":"end";if(i==="top"){var R={x:m+u/2,y:d-_,textAnchor:"middle",verticalAnchor:T};return pn(pn({},R),a?{height:Math.max(d-a.y,0),width:u}:{})}if(i==="bottom"){var $={x:x+h/2,y:d+p+_,textAnchor:"middle",verticalAnchor:A};return pn(pn({},$),a?{height:Math.max(a.y+a.height-(d+p),0),width:h}:{})}if(i==="left"){var B={x:b-O,y:d+p/2,textAnchor:M,verticalAnchor:"middle"};return pn(pn({},B),a?{width:Math.max(B.x-a.x,0),height:p}:{})}if(i==="right"){var C={x:b+v+O,y:d+p/2,textAnchor:E,verticalAnchor:"middle"};return pn(pn({},C),a?{width:Math.max(a.x+a.width-C.x,0),height:p}:{})}var U=a?{width:v,height:p}:{};return i==="insideLeft"?pn({x:b+O,y:d+p/2,textAnchor:E,verticalAnchor:"middle"},U):i==="insideRight"?pn({x:b+v-O,y:d+p/2,textAnchor:M,verticalAnchor:"middle"},U):i==="insideTop"?pn({x:m+u/2,y:d+_,textAnchor:"middle",verticalAnchor:A},U):i==="insideBottom"?pn({x:x+h/2,y:d+p-_,textAnchor:"middle",verticalAnchor:T},U):i==="insideTopLeft"?pn({x:m+O,y:d+_,textAnchor:E,verticalAnchor:A},U):i==="insideTopRight"?pn({x:m+u-O,y:d+_,textAnchor:M,verticalAnchor:A},U):i==="insideBottomLeft"?pn({x:x+O,y:d+p-_,textAnchor:E,verticalAnchor:T},U):i==="insideBottomRight"?pn({x:x+h-O,y:d+p-_,textAnchor:M,verticalAnchor:T},U):i&&typeof i=="object"&&(gt(i.x)||Zo(i.x))&&(gt(i.y)||Zo(i.y))?pn({x:l+xs(i.x,v),y:d+xs(i.y,p),textAnchor:"end",verticalAnchor:"end"},U):pn({x:w,y:d+p/2,textAnchor:"middle",verticalAnchor:"middle"},U)},$1e={angle:0,offset:5,zIndex:gs.label,position:"middle",textBreakAll:!1};function Jl(t){var e=ss(t,$1e),{viewBox:r,position:n,value:i,children:a,content:l,className:d="",textBreakAll:u,labelRef:h}=e,p=L1e(),m=fU(),x=n==="center"?m:p??m,b,v,w;if(r==null?b=x:HN(r)?b=r:b=AD(r),!b||zn(i)&&zn(a)&&!y.isValidElement(l)&&typeof l!="function")return null;var k=pn(pn({},e),{},{viewBox:b});if(y.isValidElement(l)){var{labelRef:_}=k,T=tL(k,S1e);return y.cloneElement(l,T)}if(typeof l=="function"){var{content:A}=k,I=tL(k,_1e);if(v=y.createElement(l,I),y.isValidElement(v))return v}else v=R1e(e);var O=Ki(e);if(HN(b)){if(n==="insideStart"||n==="insideEnd"||n==="end")return I1e(e,n,v,O,b);w=D1e(b,e.offset,e.position)}else w=B1e(e,b);return y.createElement(co,{zIndex:e.zIndex},y.createElement(ib,$o({ref:h,className:gr("recharts-label",d)},O,w,{textAnchor:v1e(O.textAnchor)?O.textAnchor:w.textAnchor,breakAll:u}),v))}Jl.displayName="Label";var U1e=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?y.createElement(Jl,$o({key:"label-implicit"},n)):ro(t)?y.createElement(Jl,$o({key:"label-implicit",value:t},n)):y.isValidElement(t)?t.type===Jl?y.cloneElement(t,pn({key:"label-implicit"},n)):y.createElement(Jl,$o({key:"label-implicit",content:t},n)):Kk(t)?y.createElement(Jl,$o({key:"label-implicit",content:t},n)):t&&typeof t=="object"?y.createElement(Jl,$o({},t,{key:"label-implicit"},n)):null};function z1e(t){var{label:e,labelRef:r}=t,n=fU();return U1e(e,n,r)||null}var G2={},V2={},nL;function q1e(){return nL||(nL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(V2)),V2}var K2={},sL;function F1e(){return sL||(sL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(K2)),K2}var iL;function H1e(){return iL||(iL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=q1e(),r=F1e(),n=N5();function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(G2)),G2}var Y2,aL;function W1e(){return aL||(aL=1,Y2=H1e().last),Y2}var G1e=W1e();const V1e=Ms(G1e);var K1e=["valueAccessor"],Y1e=["dataKey","clockWise","id","textBreakAll","zIndex"];function Bx(){return Bx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bx.apply(null,arguments)}function oL(t,e){if(t==null)return{};var r,n,i=X1e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function X1e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var J1e=t=>Array.isArray(t.value)?V1e(t.value):t.value,pU=y.createContext(void 0),Q1e=pU.Provider,mU=y.createContext(void 0),Z1e=mU.Provider;function ewe(){return y.useContext(pU)}function twe(){return y.useContext(mU)}function Og(t){var{valueAccessor:e=J1e}=t,r=oL(t,K1e),{dataKey:n,clockWise:i,id:a,textBreakAll:l,zIndex:d}=r,u=oL(r,Y1e),h=ewe(),p=twe(),m=h||p;return!m||!m.length?null:y.createElement(co,{zIndex:d??gs.label},y.createElement(Ts,{className:"recharts-label-list"},m.map((x,b)=>{var v,w=zn(n)?e(x,b):$r(x&&x.payload,n),k=zn(a)?{}:{id:"".concat(a,"-").concat(b)};return y.createElement(Jl,Bx({key:"label-".concat(b)},Ki(x),u,k,{fill:(v=r.fill)!==null&&v!==void 0?v:x.fill,parentViewBox:x.parentViewBox,value:w,textBreakAll:l,viewBox:x.viewBox,index:b,zIndex:0}))})))}Og.displayName="LabelList";function gU(t){var{label:e}=t;return e?e===!0?y.createElement(Og,{key:"labelList-implicit"}):y.isValidElement(e)||Kk(e)?y.createElement(Og,{key:"labelList-implicit",content:e}):typeof e=="object"?y.createElement(Og,Bx({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var xU=t=>t.graphicalItems.polarItems,rwe=we([Kr,tp],xk),ab=we([xU,Qr,rwe],bk),nwe=we([ab],vk),ob=we([nwe,Ky],wk),swe=we([ob,Qr,ab],Nk);we([ob,Qr,ab],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(i=>{var a,l=$r(n,(a=e.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):e?.dataKey!=null?t.map(n=>({value:$r(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var lL=()=>{},iwe=we([ob,Qr,ab,tb,Kr],Ck),awe=we([Qr,Sk,_k,lL,iwe,lL,ar,Kr],Ek),yU=we([Qr,ar,ob,swe,ep,Kr,awe],Ak),owe=we([yU,Qr,yh],Mk);we([Qr,yU,owe,Kr],Rk);var lwe={radiusAxis:{},angleAxis:{}},bU=Ys({name:"polarAxis",initialState:lwe,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:G5e,removeRadiusAxis:V5e,addAngleAxis:K5e,removeAngleAxis:Y5e}=bU.actions,cwe=bU.reducer;function cL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cL(Object(r),!0).forEach(function(n){dwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dwe(t,e,r){return(e=uwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uwe(t){var e=hwe(t,"string");return typeof e=="symbol"?e:e+""}function hwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fwe=(t,e)=>e,Yk=we([xU,fwe],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),pwe=[],Xk=(t,e,r)=>r?.length===0?pwe:r,vU=we([Ky,Yk,Xk],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var i;if(e?.data!=null&&e.data.length>0?i=e.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(a=>dL(dL({},e.presentationProps),a.props))),i!=null)return i}}),mwe=we([vU,Yk,Xk],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,i)=>{var a,l=$r(n,e.nameKey,e.name),d;return r!=null&&(a=r[i])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?d=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?d=n.fill:d=e.fill,{value:Ay(l,e.dataKey),color:d,payload:n,type:e.legendType}})}),gwe=we([vU,Yk,Xk,En],(t,e,r,n)=>{if(!(e==null||t==null))return v2e({offset:n,pieSettings:e,displayedData:t,cells:r})}),X2={exports:{}},vr={};var uL;function xwe(){if(uL)return vr;uL=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),b=Symbol.for("react.client.reference");function v(w){if(typeof w=="object"&&w!==null){var k=w.$$typeof;switch(k){case t:switch(w=w.type,w){case r:case i:case n:case u:case h:case x:return w;default:switch(w=w&&w.$$typeof,w){case l:case d:case m:case p:return w;case a:return w;default:return k}}case e:return k}}}return vr.ContextConsumer=a,vr.ContextProvider=l,vr.Element=t,vr.ForwardRef=d,vr.Fragment=r,vr.Lazy=m,vr.Memo=p,vr.Portal=e,vr.Profiler=i,vr.StrictMode=n,vr.Suspense=u,vr.SuspenseList=h,vr.isContextConsumer=function(w){return v(w)===a},vr.isContextProvider=function(w){return v(w)===l},vr.isElement=function(w){return typeof w=="object"&&w!==null&&w.$$typeof===t},vr.isForwardRef=function(w){return v(w)===d},vr.isFragment=function(w){return v(w)===r},vr.isLazy=function(w){return v(w)===m},vr.isMemo=function(w){return v(w)===p},vr.isPortal=function(w){return v(w)===e},vr.isProfiler=function(w){return v(w)===i},vr.isStrictMode=function(w){return v(w)===n},vr.isSuspense=function(w){return v(w)===u},vr.isSuspenseList=function(w){return v(w)===h},vr.isValidElementType=function(w){return typeof w=="string"||typeof w=="function"||w===r||w===i||w===n||w===u||w===h||typeof w=="object"&&w!==null&&(w.$$typeof===m||w.$$typeof===p||w.$$typeof===l||w.$$typeof===a||w.$$typeof===d||w.$$typeof===b||w.getModuleId!==void 0)},vr.typeOf=v,vr}var hL;function ywe(){return hL||(hL=1,X2.exports=xwe()),X2.exports}var bwe=ywe(),fL=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",pL=null,J2=null,wU=t=>{if(t===pL&&Array.isArray(J2))return J2;var e=[];return y.Children.forEach(t,r=>{zn(r)||(bwe.isFragment(r)?e=e.concat(wU(r.props.children)):e.push(r))}),J2=e,pL=t,e};function Jk(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>fL(i)):n=[fL(e)],wU(t).forEach(i=>{var a=vd(i,"type.displayName")||vd(i,"type.name");a&&n.indexOf(a)!==-1&&r.push(i)}),r}var Q2={},mL;function vwe(){return mL||(mL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(Q2)),Q2}var Z2,gL;function wwe(){return gL||(gL=1,Z2=vwe().isPlainObject),Z2}var jwe=wwe();const Nwe=Ms(jwe);var xL,yL,bL,vL,wL;function jL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function NL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jL(Object(r),!0).forEach(function(n){kwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kwe(t,e,r){return(e=Swe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Swe(t){var e=_we(t,"string");return typeof e=="symbol"?e:e+""}function _we(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $x(){return $x=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$x.apply(null,arguments)}function Nf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var kL=(t,e,r,n,i)=>{var a=r-n,l;return l=sn(xL||(xL=Nf(["M ",",",""])),t,e),l+=sn(yL||(yL=Nf(["L ",",",""])),t+r,e),l+=sn(bL||(bL=Nf(["L ",",",""])),t+r-a/2,e+i),l+=sn(vL||(vL=Nf(["L ",",",""])),t+r-a/2-n,e+i),l+=sn(wL||(wL=Nf(["L ",","," Z"])),t,e),l},Cwe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ewe=t=>{var e=ss(t,Cwe),{x:r,y:n,upperWidth:i,lowerWidth:a,height:l,className:d}=e,{animationEasing:u,animationDuration:h,animationBegin:p,isUpdateAnimationActive:m}=e,x=y.useRef(null),[b,v]=y.useState(-1),w=y.useRef(i),k=y.useRef(a),_=y.useRef(l),T=y.useRef(r),A=y.useRef(n),I=zy(t,"trapezoid-");if(y.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var q=x.current.getTotalLength();q&&v(q)}catch{}},[]),r!==+r||n!==+n||i!==+i||a!==+a||l!==+l||i===0&&a===0||l===0)return null;var O=gr("recharts-trapezoid",d);if(!m)return y.createElement("g",null,y.createElement("path",$x({},Ki(e),{className:O,d:kL(r,n,i,a,l)})));var M=w.current,E=k.current,R=_.current,$=T.current,B=A.current,C="0px ".concat(b===-1?1:b,"px"),U="".concat(b,"px 0px"),L=HD(["strokeDasharray"],h,u);return y.createElement(Uy,{animationId:I,key:I,canBegin:b>0,duration:h,easing:u,isActive:m,begin:p},q=>{var K=_n(M,i,q),W=_n(E,a,q),V=_n(R,l,q),X=_n($,r,q),Z=_n(B,n,q);x.current&&(w.current=K,k.current=W,_.current=V,T.current=X,A.current=Z);var G=q>0?{transition:L,strokeDasharray:U}:{strokeDasharray:C};return y.createElement("path",$x({},Ki(e),{className:O,d:kL(X,Z,K,W,V),ref:x,style:NL(NL({},G),e.style)}))})},Awe=["option","shapeType","activeClassName"];function Twe(t,e){if(t==null)return{};var r,n,i=Owe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Owe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function SL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ux(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SL(Object(r),!0).forEach(function(n){Mwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mwe(t,e,r){return(e=Lwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lwe(t){var e=Rwe(t,"string");return typeof e=="symbol"?e:e+""}function Rwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pwe(t,e){return Ux(Ux({},e),t)}function Iwe(t,e){return t==="symbols"}function _L(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return y.createElement(KD,r);case"trapezoid":return y.createElement(Ewe,r);case"sector":return y.createElement(QD,r);case"symbols":if(Iwe(e))return y.createElement(j5,r);break;case"curve":return y.createElement(D5,r);default:return null}}function Dwe(t){return y.isValidElement(t)?t.props:t}function jU(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,i=Twe(t,Awe),a;if(y.isValidElement(e))a=y.cloneElement(e,Ux(Ux({},i),Dwe(e)));else if(typeof e=="function")a=e(i,i.index);else if(Nwe(e)&&typeof e!="boolean"){var l=Pwe(e,i);a=y.createElement(_L,{shapeType:r,elementProps:l})}else{var d=i;a=y.createElement(_L,{shapeType:r,elementProps:d})}return i.isActive?y.createElement(Ts,{className:n},a):a}var Qk=(t,e,r)=>{var n=Or();return(i,a)=>l=>{t?.(i,a,l),n(R$({activeIndex:String(a),activeDataKey:e,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},Zk=t=>{var e=Or();return(r,n)=>i=>{t?.(r,n,i),e(Vye())}},eS=(t,e,r)=>{var n=Or();return(i,a)=>l=>{t?.(i,a,l),n(Kye({activeIndex:String(a),activeDataKey:e,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function NU(t){var{tooltipEntrySettings:e}=t,r=Or(),n=vi(),i=y.useRef(null);return y.useLayoutEffect(()=>{n||(i.current===null?r(Fye(e)):i.current!==e&&r(Hye({prev:i.current,next:e})),i.current=e)},[e,r,n]),y.useLayoutEffect(()=>()=>{i.current&&(r(Wye(i.current)),i.current=null)},[r]),null}function Bwe(t){var{legendPayload:e}=t,r=Or(),n=vi(),i=y.useRef(null);return y.useLayoutEffect(()=>{n||(i.current===null?r($D(e)):i.current!==e&&r(UD({prev:i.current,next:e})),i.current=e)},[r,n,e]),y.useLayoutEffect(()=>()=>{i.current&&(r(zD(i.current)),i.current=null)},[r]),null}function $we(t){var{legendPayload:e}=t,r=Or(),n=ft(ar),i=y.useRef(null);return y.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r($D(e)):i.current!==e&&r(UD({prev:i.current,next:e})),i.current=e)},[r,n,e]),y.useLayoutEffect(()=>()=>{i.current&&(r(zD(i.current)),i.current=null)},[r]),null}var ej,Uwe=()=>{var[t]=y.useState(()=>o0("uid-"));return t},zwe=(ej=$q.useId)!==null&&ej!==void 0?ej:Uwe;function qwe(t,e){var r=zwe();return e||(t?"".concat(t,"-").concat(r):r)}var Fwe=y.createContext(void 0),kU=t=>{var{id:e,type:r,children:n}=t,i=qwe("recharts-".concat(r),e);return y.createElement(Fwe.Provider,{value:i},n(i))},Hwe={cartesianItems:[],polarItems:[]},SU=Ys({name:"graphicalItems",initialState:Hwe,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Wr()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,i=Na(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},prepare:Wr()},removeCartesianGraphicalItem:{reducer(t,e){var r=Na(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Wr()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Wr()},removePolarGraphicalItem:{reducer(t,e){var r=Na(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Wr()}}}),{addCartesianGraphicalItem:Wwe,replaceCartesianGraphicalItem:Gwe,removeCartesianGraphicalItem:Vwe,addPolarGraphicalItem:Kwe,removePolarGraphicalItem:Ywe}=SU.actions,Xwe=SU.reducer,Jwe=t=>{var e=Or(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?e(Wwe(t)):r.current!==t&&e(Gwe({prev:r.current,next:t})),r.current=t},[e,t]),y.useLayoutEffect(()=>()=>{r.current&&(e(Vwe(r.current)),r.current=null)},[e]),null},Qwe=y.memo(Jwe);function Zwe(t){var e=Or();return y.useLayoutEffect(()=>(e(Kwe(t)),()=>{e(Ywe(t))}),[e,t]),null}var e2e=["key"],t2e=["onMouseEnter","onClick","onMouseLeave"],r2e=["id"],n2e=["id"];function CL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function an(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CL(Object(r),!0).forEach(function(n){s2e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function s2e(t,e,r){return(e=i2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i2e(t){var e=a2e(t,"string");return typeof e=="symbol"?e:e+""}function a2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bc(){return bc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bc.apply(null,arguments)}function lb(t,e){if(t==null)return{};var r,n,i=o2e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function o2e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function l2e(t){var e=y.useMemo(()=>Jk(t.children,sh),[t.children]),r=ft(n=>mwe(n,t.id,e));return r==null?null:y.createElement($we,{legendPayload:r})}var c2e=y.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:i,strokeWidth:a,fill:l,name:d,hide:u,tooltipType:h,id:p}=t,m={dataDefinedOnItem:n.map(x=>x.tooltipPayload),positions:n.map(x=>x.tooltipPosition),settings:{stroke:i,strokeWidth:a,fill:l,dataKey:e,nameKey:r,name:Ay(d,e),hide:u,type:h,color:l,unit:"",graphicalItemId:p}};return y.createElement(NU,{tooltipEntrySettings:m})}),d2e=(t,e)=>t>e?"start":t<e?"end":"middle",u2e=(t,e,r)=>xs(typeof e=="function"?e(t):e,r,r*.8),h2e=(t,e,r)=>{var{top:n,left:i,width:a,height:l}=e,d=YD(a,l),u=i+xs(t.cx,a,a/2),h=n+xs(t.cy,l,l/2),p=xs(t.innerRadius,d,0),m=u2e(r,t.outerRadius,d),x=t.maxRadius||Math.sqrt(a*a+l*l)/2;return{cx:u,cy:h,innerRadius:p,outerRadius:m,maxRadius:x}},f2e=(t,e)=>{var r=rs(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function p2e(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var m2e=(t,e)=>{if(y.isValidElement(t))return y.cloneElement(t,e);if(typeof t=="function")return t(e);var r=gr("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,i=lb(e,e2e);return y.createElement(D5,bc({},i,{type:"linear",className:r}))},g2e=(t,e,r)=>{if(y.isValidElement(t))return y.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),y.isValidElement(n)))return n;var i=gr("recharts-pie-label-text",p2e(t));return y.createElement(ib,bc({},e,{alignmentBaseline:"middle",className:i}),n)};function x2e(t){var{sectors:e,props:r,showLabels:n}=t,{label:i,labelLine:a,dataKey:l}=r;if(!n||!i||!e)return null;var d=eo(r),u=a0(i),h=a0(a),p=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,m=e.map((x,b)=>{var v=(x.startAngle+x.endAngle)/2,w=Nn(x.cx,x.cy,x.outerRadius+p,v),k=an(an(an(an({},d),x),{},{stroke:"none"},u),{},{index:b,textAnchor:d2e(w.x,x.cx)},w),_=an(an(an(an({},d),x),{},{fill:"none",stroke:x.fill},h),{},{index:b,points:[Nn(x.cx,x.cy,x.outerRadius,v),w],key:"line"});return y.createElement(co,{zIndex:gs.label,key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(b)},y.createElement(Ts,null,a&&m2e(a,_),g2e(i,k,$r(x,l))))});return y.createElement(Ts,{className:"recharts-pie-labels"},m)}function y2e(t){var{sectors:e,props:r,showLabels:n}=t,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?y.createElement(gU,{label:i}):y.createElement(x2e,{sectors:e,props:r,showLabels:n})}function b2e(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:a,id:l}=t,d=ft(Sd),u=ft(Fk),h=ft(Lbe),{onMouseEnter:p,onClick:m,onMouseLeave:x}=i,b=lb(i,t2e),v=Qk(p,i.dataKey,l),w=Zk(x),k=eS(m,i.dataKey,l);return e==null||e.length===0?null:y.createElement(y.Fragment,null,e.map((_,T)=>{if(_?.startAngle===0&&_?.endAngle===0&&e.length!==1)return null;var A=h==null||h===l,I=String(T)===d&&(u==null||i.dataKey===u)&&A,O=d?n:null,M=r&&I?r:O,E=an(an({},_),{},{stroke:_.stroke,tabIndex:-1,[kD]:T,[SD]:l});return y.createElement(Ts,bc({key:"sector-".concat(_?.startAngle,"-").concat(_?.endAngle,"-").concat(_.midAngle,"-").concat(T),tabIndex:-1,className:"recharts-pie-sector"},F0(b,_,T),{onMouseEnter:v(_,T),onMouseLeave:w(_,T),onClick:k(_,T)}),y.createElement(jU,bc({option:a??M,index:T,shapeType:"sector",isActive:I},E)))}))}function v2e(t){var e,{pieSettings:r,displayedData:n,cells:i,offset:a}=t,{cornerRadius:l,startAngle:d,endAngle:u,dataKey:h,nameKey:p,tooltipType:m}=r,x=Math.abs(r.minAngle),b=f2e(d,u),v=Math.abs(b),w=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,k=n.filter(M=>$r(M,h,0)!==0).length,_=(v>=360?k:k-1)*w,T=v-k*x-_,A=n.reduce((M,E)=>{var R=$r(E,h,0);return M+(gt(R)?R:0)},0),I;if(A>0){var O;I=n.map((M,E)=>{var R=$r(M,h,0),$=$r(M,p,E),B=h2e(r,a,M),C=(gt(R)?R:0)/A,U,L=an(an({},M),i&&i[E]&&i[E].props);E?U=O.endAngle+rs(b)*w*(R!==0?1:0):U=d;var q=U+rs(b)*((R!==0?x:0)+C*T),K=(U+q)/2,W=(B.innerRadius+B.outerRadius)/2,V=[{name:$,value:R,payload:L,dataKey:h,type:m,graphicalItemId:r.id}],X=Nn(B.cx,B.cy,W,K);return O=an(an(an(an({},r.presentationProps),{},{percent:C,cornerRadius:typeof l=="string"?parseFloat(l):l,name:$,tooltipPayload:V,midAngle:K,middleRadius:W,tooltipPosition:X},L),B),{},{value:R,dataKey:h,startAngle:U,endAngle:q,payload:L,paddingAngle:rs(b)*w}),O})}return I}function w2e(t){var{showLabels:e,sectors:r,children:n}=t,i=y.useMemo(()=>!e||!r?[]:r.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})),[r,e]);return y.createElement(Z1e,{value:e?i:void 0},n)}function j2e(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:i,isAnimationActive:a,animationBegin:l,animationDuration:d,animationEasing:u,activeShape:h,inactiveShape:p,onAnimationStart:m,onAnimationEnd:x}=e,b=zy(e,"recharts-pie-"),v=r.current,[w,k]=y.useState(!1),_=y.useCallback(()=>{typeof x=="function"&&x(),k(!1)},[x]),T=y.useCallback(()=>{typeof m=="function"&&m(),k(!0)},[m]);return y.createElement(w2e,{showLabels:!w,sectors:i},y.createElement(Uy,{animationId:b,begin:l,duration:d,isActive:a,easing:u,onAnimationStart:T,onAnimationEnd:_,key:b},A=>{var I=[],O=i&&i[0],M=O?.startAngle;return i?.forEach((E,R)=>{var $=v&&v[R],B=R>0?vd(E,"paddingAngle",0):0;if($){var C=_n($.endAngle-$.startAngle,E.endAngle-E.startAngle,A),U=an(an({},E),{},{startAngle:M+B,endAngle:M+C+B});I.push(U),M=U.endAngle}else{var{endAngle:L,startAngle:q}=E,K=_n(0,L-q,A),W=an(an({},E),{},{startAngle:M+B,endAngle:M+K+B});I.push(W),M=W.endAngle}}),r.current=I,y.createElement(Ts,null,y.createElement(b2e,{sectors:I,activeShape:h,inactiveShape:p,allOtherPieProps:e,shape:e.shape,id:n}))}),y.createElement(y2e,{showLabels:!w,sectors:i,props:e}),e.children)}var N2e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:gs.area};function k2e(t){var{id:e}=t,r=lb(t,r2e),{hide:n,className:i,rootTabIndex:a}=t,l=y.useMemo(()=>Jk(t.children,sh),[t.children]),d=ft(p=>gwe(p,e,l)),u=y.useRef(null),h=gr("recharts-pie",i);return n||d==null?(u.current=null,y.createElement(Ts,{tabIndex:a,className:h})):y.createElement(co,{zIndex:t.zIndex},y.createElement(c2e,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:d,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),y.createElement(Ts,{tabIndex:a,className:h},y.createElement(j2e,{props:an(an({},r),{},{sectors:d}),previousSectorsRef:u,id:e})))}function _U(t){var e=ss(t,N2e),{id:r}=e,n=lb(e,n2e),i=eo(n);return y.createElement(kU,{id:r,type:"pie"},a=>y.createElement(y.Fragment,null,y.createElement(Zwe,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:e.maxRadius}),y.createElement(l2e,bc({},n,{id:a})),y.createElement(k2e,bc({},n,{id:a}))))}_U.displayName="Pie";function EL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function AL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EL(Object(r),!0).forEach(function(n){S2e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function S2e(t,e,r){return(e=_2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _2e(t){var e=C2e(t,"string");return typeof e=="symbol"?e:e+""}function C2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CU=0,E2e={xAxis:{},yAxis:{},zAxis:{}},EU=Ys({name:"cartesianAxis",initialState:E2e,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Wr()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Wr()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Wr()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Wr()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Wr()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Wr()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Wr()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Wr()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Wr()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,i=t.yAxis[r];if(i){var a=i.widthHistory||[];if(a.length===3&&a[0]===a[2]&&n===a[1]&&n!==i.width&&Math.abs(n-a[0])<=1)return;var l=[...a,n].slice(-3);t.yAxis[r]=AL(AL({},t.yAxis[r]),{},{width:n,widthHistory:l})}}}}),{addXAxis:A2e,replaceXAxis:T2e,removeXAxis:O2e,addYAxis:M2e,replaceYAxis:L2e,removeYAxis:R2e,addZAxis:X5e,replaceZAxis:J5e,removeZAxis:Q5e,updateYAxisWidth:P2e}=EU.actions,I2e=EU.reducer,D2e=we([En],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),B2e=we([D2e,fl,pl],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),AU=()=>ft(B2e),TL=(t,e,r)=>{var n=r??t;if(!zn(n))return xs(n,e,0)},$2e=(t,e,r)=>{var n={},i=t.filter(Jy),a=t.filter(h=>h.stackId==null),l=i.reduce((h,p)=>(h[p.stackId]||(h[p.stackId]=[]),h[p.stackId].push(p),h),n),d=Object.entries(l).map(h=>{var[p,m]=h,x=m.map(v=>v.dataKey),b=TL(e,r,m[0].barSize);return{stackId:p,dataKeys:x,barSize:b}}),u=a.map(h=>{var p=[h.dataKey].filter(x=>x!=null),m=TL(e,r,h.barSize);return{stackId:void 0,dataKeys:p,barSize:m}});return[...d,...u]};function OL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OL(Object(r),!0).forEach(function(n){U2e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function U2e(t,e,r){return(e=z2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z2e(t){var e=q2e(t,"string");return typeof e=="symbol"?e:e+""}function q2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F2e(t,e,r,n,i){var a=n.length;if(!(a<1)){var l=xs(t,r,0,!0),d,u=[];if(Jr(n[0].barSize)){var h=!1,p=r/a,m=n.reduce((_,T)=>_+(T.barSize||0),0);m+=(a-1)*l,m>=r&&(m-=(a-1)*l,l=0),m>=r&&p>0&&(h=!0,p*=.9,m=a*p);var x=(r-m)/2>>0,b={offset:x-l,size:0};d=n.reduce((_,T)=>{var A,I={stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:b.offset+b.size+l,size:h?p:(A=T.barSize)!==null&&A!==void 0?A:0}},O=[..._,I];return b=O[O.length-1].position,O},u)}else{var v=xs(e,r,0,!0);r-2*v-(a-1)*l<=0&&(l=0);var w=(r-2*v-(a-1)*l)/a;w>1&&(w>>=0);var k=Jr(i)?Math.min(w,i):w;d=n.reduce((_,T,A)=>[..._,{stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:v+(w+l)*A+(w-k)/2,size:k}}],u)}return d}}var H2e=(t,e,r,n,i,a,l)=>{var d=zn(l)?e:l,u=F2e(r,n,i!==a?i:a,t,d);return i!==a&&u!=null&&(u=u.map(h=>dg(dg({},h),{},{position:dg(dg({},h.position),{},{offset:h.position.offset-i/2})}))),u},W2e=(t,e)=>{var r=mk(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var i=t[n];if(i){var{stackedData:a}=i;if(a)return a.find(l=>l.key===r)}}}};function G2e(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Jr(t.zIndex)?t.zIndex:e}var TU=t=>{var{chartData:e}=t,r=Or(),n=vi();return y.useEffect(()=>n?()=>{}:(r($8(e)),()=>{r($8(void 0))}),[e,r,n]),null},ML={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},OU=Ys({name:"brush",initialState:ML,reducers:{setBrushSettings(t,e){return e.payload==null?ML:e.payload}}}),{setBrushSettings:Z5e}=OU.actions,V2e=OU.reducer;function K2e(t,e,r){return(e=Y2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y2e(t){var e=X2e(t,"string");return typeof e=="symbol"?e:e+""}function X2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tS{static create(e){return new tS(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+l}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}K2e(tS,"EPS",1e-4);function J2e(t){return(t%180+180)%180}var Q2e=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=J2e(i),l=a*Math.PI/180,d=Math.atan(n/r),u=l>d&&l<Math.PI-d?n/Math.sin(l):r/Math.cos(l);return Math.abs(u)},Z2e={dots:[],areas:[],lines:[]},MU=Ys({name:"referenceElements",initialState:Z2e,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Na(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Na(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Na(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:eke,removeDot:tke,addArea:rke,removeArea:nke,addLine:ske,removeLine:ike}=MU.actions,eje=MU.reducer,tje=y.createContext(void 0),rje=t=>{var{children:e}=t,[r]=y.useState("".concat(o0("recharts"),"-clip")),n=AU();if(n==null)return null;var{x:i,y:a,width:l,height:d}=n;return y.createElement(tje.Provider,{value:r},y.createElement("defs",null,y.createElement("clipPath",{id:r},y.createElement("rect",{x:i,y:a,height:d,width:l}))),e)};function LU(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var i=t[n];i!==void 0&&r.push(i)}return r}function nje(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return Q2e(n,r)}function sje(t,e,r){var n=r==="width",{x:i,y:a,width:l,height:d}=t;return e===1?{start:n?i:a,end:n?i+l:a+d}:{start:n?i+l:a+d,end:n?i:a}}function w0(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function ije(t,e){return LU(t,e+1)}function aje(t,e,r,n,i){for(var a=(n||[]).slice(),{start:l,end:d}=e,u=0,h=1,p=l,m=function(){var v=n?.[u];if(v===void 0)return{v:LU(n,h)};var w=u,k,_=()=>(k===void 0&&(k=r(v,w)),k),T=v.coordinate,A=u===0||w0(t,T,_,p,d);A||(u=0,p=l,h+=1),A&&(p=T+t*(_()/2+i),u+=h)},x;h<=a.length;)if(x=m(),x)return x.v;return[]}function oje(t,e,r,n,i){var a=(n||[]).slice(),l=a.length;if(l===0)return[];for(var{start:d,end:u}=e,h=1;h<=l;h++){for(var p=(l-1)%h,m=d,x=!0,b=function(){var T=n[v],A=v,I,O=()=>(I===void 0&&(I=r(T,A)),I),M=T.coordinate,E=v===p||w0(t,M,O,m,u);if(!E)return x=!1,1;E&&(m=M+t*(O()/2+i))},v=p;v<l&&!b();v+=h);if(x){for(var w=[],k=p;k<l;k+=h)w.push(n[k]);return w}}return[]}function LL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function fs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LL(Object(r),!0).forEach(function(n){lje(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lje(t,e,r){return(e=cje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cje(t){var e=dje(t,"string");return typeof e=="symbol"?e:e+""}function dje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uje(t,e,r,n,i){for(var a=(n||[]).slice(),l=a.length,{start:d}=e,{end:u}=e,h=function(x){var b=a[x],v,w=()=>(v===void 0&&(v=r(b,x)),v);if(x===l-1){var k=t*(b.coordinate+t*w()/2-u);a[x]=b=fs(fs({},b),{},{tickCoord:k>0?b.coordinate-k*t:b.coordinate})}else a[x]=b=fs(fs({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var _=w0(t,b.tickCoord,w,d,u);_&&(u=b.tickCoord-t*(w()/2+i),a[x]=fs(fs({},b),{},{isShow:!0}))}},p=l-1;p>=0;p--)h(p);return a}function hje(t,e,r,n,i,a){var l=(n||[]).slice(),d=l.length,{start:u,end:h}=e;if(a){var p=n[d-1],m=r(p,d-1),x=t*(p.coordinate+t*m/2-h);if(l[d-1]=p=fs(fs({},p),{},{tickCoord:x>0?p.coordinate-x*t:p.coordinate}),p.tickCoord!=null){var b=w0(t,p.tickCoord,()=>m,u,h);b&&(h=p.tickCoord-t*(m/2+i),l[d-1]=fs(fs({},p),{},{isShow:!0}))}}for(var v=a?d-1:d,w=function(T){var A=l[T],I,O=()=>(I===void 0&&(I=r(A,T)),I);if(T===0){var M=t*(A.coordinate-t*O()/2-u);l[T]=A=fs(fs({},A),{},{tickCoord:M<0?A.coordinate-M*t:A.coordinate})}else l[T]=A=fs(fs({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var E=w0(t,A.tickCoord,O,u,h);E&&(u=A.tickCoord+t*(O()/2+i),l[T]=fs(fs({},A),{},{isShow:!0}))}},k=0;k<v;k++)w(k);return l}function fje(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:l,orientation:d,interval:u,tickFormatter:h,unit:p,angle:m}=t;if(!i||!i.length||!n)return[];if(gt(u)||$y.isSsr){var x;return(x=ije(i,gt(u)?u:0))!==null&&x!==void 0?x:[]}var b=[],v=d==="top"||d==="bottom"?"width":"height",w=p&&v==="width"?Ff(p,{fontSize:e,letterSpacing:r}):{width:0,height:0},k=(A,I)=>{var O=typeof h=="function"?h(A.value,I):A.value;return v==="width"?nje(Ff(O,{fontSize:e,letterSpacing:r}),w,m):Ff(O,{fontSize:e,letterSpacing:r})[v]},_=i.length>=2?rs(i[1].coordinate-i[0].coordinate):1,T=sje(a,_,v);return u==="equidistantPreserveStart"?aje(_,T,k,i,l):u==="equidistantPreserveEnd"?oje(_,T,k,i,l):(u==="preserveStart"||u==="preserveStartEnd"?b=hje(_,T,k,i,l,u==="preserveStartEnd"):b=uje(_,T,k,i,l),b.filter(A=>A.isShow))}var pje=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,l=0;if(e){Array.from(e).forEach(p=>{if(p){var m=p.getBoundingClientRect();m.width>l&&(l=m.width)}});var d=r?r.getBoundingClientRect().width:0,u=i+a,h=l+u+d+(r?n:0);return Math.round(h)}return 0},mje=["axisLine","width","height","className","hide","ticks","axisType"];function gje(t,e){if(t==null)return{};var r,n,i=xje(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function xje(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function _d(){return _d=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_d.apply(null,arguments)}function RL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RL(Object(r),!0).forEach(function(n){yje(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yje(t,e,r){return(e=bje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bje(t){var e=vje(t,"string");return typeof e=="symbol"?e:e+""}function vje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var od={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:gs.axis};function wje(t){var{x:e,y:r,width:n,height:i,orientation:a,mirror:l,axisLine:d,otherSvgProps:u}=t;if(!d)return null;var h=vn(vn(vn({},u),eo(d)),{},{fill:"none"});if(a==="top"||a==="bottom"){var p=+(a==="top"&&!l||a==="bottom"&&l);h=vn(vn({},h),{},{x1:e,y1:r+p*i,x2:e+n,y2:r+p*i})}else{var m=+(a==="left"&&!l||a==="right"&&l);h=vn(vn({},h),{},{x1:e+m*n,y1:r,x2:e+m*n,y2:r+i})}return y.createElement("line",_d({},h,{className:gr("recharts-cartesian-axis-line",vd(d,"className"))}))}function jje(t,e,r,n,i,a,l,d,u){var h,p,m,x,b,v,w=d?-1:1,k=t.tickSize||l,_=gt(t.tickCoord)?t.tickCoord:t.coordinate;switch(a){case"top":h=p=t.coordinate,x=r+ +!d*i,m=x-w*k,v=m-w*u,b=_;break;case"left":m=x=t.coordinate,p=e+ +!d*n,h=p-w*k,b=h-w*u,v=_;break;case"right":m=x=t.coordinate,p=e+ +d*n,h=p+w*k,b=h+w*u,v=_;break;default:h=p=t.coordinate,x=r+ +d*i,m=x+w*k,v=m+w*u,b=_;break}return{line:{x1:h,y1:m,x2:p,y2:x},tick:{x:b,y:v}}}function Nje(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function kje(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function Sje(t){var{option:e,tickProps:r,value:n}=t,i,a=gr(r.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(e))i=y.cloneElement(e,vn(vn({},r),{},{className:a}));else if(typeof e=="function")i=e(vn(vn({},r),{},{className:a}));else{var l="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(l=gr(l,e?.className)),i=y.createElement(ib,_d({},r,{className:l}),n)}return i}var _je=y.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:a,tickFormatter:l,unit:d,padding:u,tickTextProps:h,orientation:p,mirror:m,x,y:b,width:v,height:w,tickSize:k,tickMargin:_,fontSize:T,letterSpacing:A,getTicksConfig:I,events:O,axisType:M}=t,E=fje(vn(vn({},I),{},{ticks:r}),T,A),R=Nje(p,m),$=kje(p,m),B=eo(I),C=a0(n),U={};typeof i=="object"&&(U=i);var L=vn(vn({},B),{},{fill:"none"},U),q=E.map(V=>vn({entry:V},jje(V,x,b,v,w,p,k,m,_))),K=q.map(V=>{var{entry:X,line:Z}=V;return y.createElement(Ts,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(X.value,"-").concat(X.coordinate,"-").concat(X.tickCoord)},i&&y.createElement("line",_d({},L,Z,{className:gr("recharts-cartesian-axis-tick-line",vd(i,"className"))})))}),W=q.map((V,X)=>{var{entry:Z,tick:G}=V,F=vn(vn(vn(vn({textAnchor:R,verticalAnchor:$},B),{},{stroke:"none",fill:a},C),G),{},{index:X,payload:Z,visibleTicksCount:E.length,tickFormatter:l,padding:u},h);return y.createElement(Ts,_d({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(Z.value,"-").concat(Z.coordinate,"-").concat(Z.tickCoord)},F0(O,Z,X)),n&&y.createElement(Sje,{option:n,tickProps:F,value:"".concat(typeof l=="function"?l(Z.value,X):Z.value).concat(d||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(M,"-ticks")},W.length>0&&y.createElement(co,{zIndex:gs.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(M,"-tick-labels"),ref:e},W)),K.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(M,"-tick-lines")},K))}),Cje=y.forwardRef((t,e)=>{var{axisLine:r,width:n,height:i,className:a,hide:l,ticks:d,axisType:u}=t,h=gje(t,mje),[p,m]=y.useState(""),[x,b]=y.useState(""),v=y.useRef(null);y.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var k;return pje({ticks:v.current,label:(k=t.labelRef)===null||k===void 0?void 0:k.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var w=y.useCallback(k=>{if(k){var _=k.getElementsByClassName("recharts-cartesian-axis-tick-value");v.current=_;var T=_[0];if(T){var A=window.getComputedStyle(T),I=A.fontSize,O=A.letterSpacing;(I!==p||O!==x)&&(m(I),b(O))}}},[p,x]);return l||n!=null&&n<=0||i!=null&&i<=0?null:y.createElement(co,{zIndex:t.zIndex},y.createElement(Ts,{className:gr("recharts-cartesian-axis",a)},y.createElement(wje,{x:t.x,y:t.y,width:n,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:eo(t)}),y.createElement(_je,{ref:w,axisType:u,events:h,fontSize:p,getTicksConfig:t,height:t.height,letterSpacing:x,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:d,unit:t.unit,width:t.width,x:t.x,y:t.y}),y.createElement(O1e,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},y.createElement(z1e,{label:t.label,labelRef:t.labelRef}),t.children)))}),rS=y.forwardRef((t,e)=>{var r=ss(t,od);return y.createElement(Cje,_d({},r,{ref:e}))});rS.displayName="CartesianAxis";var Eje={},RU=Ys({name:"errorBars",initialState:Eje,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:i}=e.payload;t[r]&&(t[r]=t[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?i:a))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:ake,replaceErrorBar:oke,removeErrorBar:lke}=RU.actions,Aje=RU.reducer,Tje=["children"];function Oje(t,e){if(t==null)return{};var r,n,i=Mje(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Mje(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Lje={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Rje=y.createContext(Lje);function Pje(t){var{children:e}=t,r=Oje(t,Tje);return y.createElement(Rje.Provider,{value:r},e)}function PU(t,e){var r,n,i=ft(h=>xl(h,t)),a=ft(h=>yl(h,e)),l=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:Dn.allowDataOverflow,d=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:Bn.allowDataOverflow,u=l||d;return{needClip:u,needClipX:l,needClipY:d}}function Ije(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=AU(),{needClipX:a,needClipY:l,needClip:d}=PU(e,r);if(!d||!i)return null;var{x:u,y:h,width:p,height:m}=i;return y.createElement("clipPath",{id:"clipPath-".concat(n)},y.createElement("rect",{x:a?u:u-p/2,y:l?h:h-m/2,width:a?p:p*2,height:l?m:m*2}))}function Dje(t){t()}function Bje(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Dje(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var PL={notify(){},get:()=>[]};function $je(t,e){let r,n=PL,i=0,a=!1;function l(w){p();const k=n.subscribe(w);let _=!1;return()=>{_||(_=!0,k(),m())}}function d(){n.notify()}function u(){v.onStateChange&&v.onStateChange()}function h(){return a}function p(){i++,r||(r=t.subscribe(u),n=Bje())}function m(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=PL)}function x(){a||(a=!0,p())}function b(){a&&(a=!1,m())}const v={addNestedSub:l,notifyNestedSubs:d,handleChangeWrapper:u,isSubscribed:h,trySubscribe:x,tryUnsubscribe:b,getListeners:()=>n};return v}var Uje=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zje=Uje(),qje=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Fje=qje(),Hje=()=>zje||Fje?y.useLayoutEffect:y.useEffect,Wje=Hje();function IL(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Gje(t,e){if(IL(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(e,r[i])||!IL(t[r[i]],e[r[i]]))return!1;return!0}var Vje=Symbol.for("react-redux-context"),Kje=typeof globalThis<"u"?globalThis:{};function Yje(){if(!y.createContext)return{};const t=Kje[Vje]??=new Map;let e=t.get(y.createContext);return e||(e=y.createContext(null),t.set(y.createContext,e)),e}var Xje=Yje();function Jje(t){const{children:e,context:r,serverState:n,store:i}=t,a=y.useMemo(()=>{const u=$je(i);return{store:i,subscription:u,getServerState:n?()=>n:void 0}},[i,n]),l=y.useMemo(()=>i.getState(),[i]);Wje(()=>{const{subscription:u}=a;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),l!==i.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[a,l]);const d=r||Xje;return y.createElement(d.Provider,{value:a},e)}var Qje=Jje,Zje=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function eNe(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function nS(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(Zje.has(n)){if(t[n]==null&&e[n]==null)continue;if(!Gje(t[n],e[n]))return!1}else if(!eNe(t[n],e[n]))return!1;return!0}function $d(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(i=>i.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:CU}function Ud(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(i=>i.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:CU}var tNe="Invariant failed";function rNe(t,e){throw new Error(tNe)}function WN(){return WN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WN.apply(null,arguments)}function zx(t){return y.createElement(jU,WN({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var nNe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(gt(e))return e;var a=gt(n)||zn(n);return a?e(n,i):(a||rNe(),r)}},sNe=(t,e,r)=>r,iNe=(t,e)=>e,cp=we([yk,iNe],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),aNe=we([cp],t=>t?.maxBarSize),oNe=(t,e,r,n)=>n,lNe=we([ar,yk,$d,Ud,sNe],(t,e,r,n,i)=>e.filter(a=>t==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),cNe=(t,e,r)=>{var n=ar(t),i=$d(t,e),a=Ud(t,e);if(!(i==null||a==null))return n==="horizontal"?BN(t,"yAxis",a,r):BN(t,"xAxis",i,r)},dNe=(t,e)=>{var r=ar(t),n=$d(t,e),i=Ud(t,e);if(!(n==null||i==null))return r==="horizontal"?E8(t,"xAxis",n):E8(t,"yAxis",i)},uNe=we([lNe,Ixe,dNe],$2e),hNe=(t,e,r)=>{var n,i,a=cp(t,e);if(a!=null){var l=$d(t,e),d=Ud(t,e);if(!(l==null||d==null)){var u=ar(t),h=YB(t),{maxBarSize:p}=a,m=zn(p)?h:p,x,b;return u==="horizontal"?(x=nh(t,"xAxis",l,r),b=rh(t,"xAxis",l,r)):(x=nh(t,"yAxis",d,r),b=rh(t,"yAxis",d,r)),(n=(i=gx(x,b,!0))!==null&&i!==void 0?i:m)!==null&&n!==void 0?n:0}}},IU=(t,e,r)=>{var n=ar(t),i=$d(t,e),a=Ud(t,e);if(!(i==null||a==null)){var l,d;return n==="horizontal"?(l=nh(t,"xAxis",i,r),d=rh(t,"xAxis",i,r)):(l=nh(t,"yAxis",a,r),d=rh(t,"yAxis",a,r)),gx(l,d)}},fNe=we([uNe,YB,Pxe,XB,hNe,IU,aNe],H2e),pNe=(t,e,r)=>{var n=$d(t,e);if(n!=null)return nh(t,"xAxis",n,r)},mNe=(t,e,r)=>{var n=Ud(t,e);if(n!=null)return nh(t,"yAxis",n,r)},gNe=(t,e,r)=>{var n=$d(t,e);if(n!=null)return rh(t,"xAxis",n,r)},xNe=(t,e,r)=>{var n=Ud(t,e);if(n!=null)return rh(t,"yAxis",n,r)},yNe=we([fNe,cp],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),bNe=we([cNe,cp],W2e),vNe=we([En,L5,pNe,mNe,gNe,xNe,yNe,ar,Nxe,IU,bNe,cp,oNe],(t,e,r,n,i,a,l,d,u,h,p,m,x)=>{var{chartData:b,dataStartIndex:v,dataEndIndex:w}=u;if(!(m==null||l==null||e==null||d!=="horizontal"&&d!=="vertical"||r==null||n==null||i==null||a==null||h==null)){var{data:k}=m,_;if(k!=null&&k.length>0?_=k:_=b?.slice(v,w+1),_!=null)return YNe({layout:d,barSettings:m,pos:l,parentViewBox:e,bandSize:h,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,stackedData:p,displayedData:_,offset:t,cells:x,dataStartIndex:v})}}),wNe=["index"];function GN(){return GN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},GN.apply(null,arguments)}function jNe(t,e){if(t==null)return{};var r,n,i=NNe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function NNe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var DU=y.createContext(void 0),kNe=t=>{var e=y.useContext(DU);if(e!=null)return e.stackId;if(t!=null)return gfe(t)},SNe=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),_Ne=t=>{var e=y.useContext(DU);if(e!=null){var{stackId:r}=e;return"url(#".concat(SNe(r,t),")")}},CNe=t=>{var{index:e}=t,r=jNe(t,wNe),n=_Ne(e);return y.createElement(Ts,GN({className:"recharts-bar-stack-layer",clipPath:n},r))},ENe=["onMouseEnter","onMouseLeave","onClick"],ANe=["value","background","tooltipPosition"],TNe=["id"],ONe=["onMouseEnter","onClick","onMouseLeave"];function il(){return il=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},il.apply(null,arguments)}function DL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ss(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DL(Object(r),!0).forEach(function(n){MNe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MNe(t,e,r){return(e=LNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LNe(t){var e=RNe(t,"string");return typeof e=="symbol"?e:e+""}function RNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qx(t,e){if(t==null)return{};var r,n,i=PNe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function PNe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var INe=t=>{var{dataKey:e,name:r,fill:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:Ay(r,e),payload:t}]},DNe=y.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:i,name:a,hide:l,unit:d,tooltipType:u,id:h}=t,p={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:e,nameKey:void 0,name:Ay(a,e),hide:l,type:u,color:i,unit:d,graphicalItemId:h}};return y.createElement(NU,{tooltipEntrySettings:p})});function BNe(t){var e=ft(Sd),{data:r,dataKey:n,background:i,allOtherBarProps:a}=t,{onMouseEnter:l,onMouseLeave:d,onClick:u}=a,h=qx(a,ENe),p=Qk(l,n,a.id),m=Zk(d),x=eS(u,n,a.id);if(!i||r==null)return null;var b=a0(i);return y.createElement(co,{zIndex:G2e(i,gs.barBackground)},r.map((v,w)=>{var{value:k,background:_,tooltipPosition:T}=v,A=qx(v,ANe);if(!_)return null;var I=p(v,w),O=m(v,w),M=x(v,w),E=Ss(Ss(Ss(Ss(Ss({option:i,isActive:String(w)===e},A),{},{fill:"#eee"},_),b),F0(h,v,w)),{},{onMouseEnter:I,onMouseLeave:O,onClick:M,dataKey:n,index:w,className:"recharts-bar-background-rectangle"});return y.createElement(zx,il({key:"background-bar-".concat(w)},E))}))}function $Ne(t){var{showLabels:e,children:r,rects:n}=t,i=n?.map(a=>{var l={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return Ss(Ss({},l),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:l,fill:a.fill})});return y.createElement(Q1e,{value:e?i:void 0},r)}function UNe(t){var{shape:e,activeBar:r,baseProps:n,entry:i,index:a,dataKey:l}=t,d=ft(Sd),u=ft(Fk),h=r&&String(a)===d&&(u==null||l===u),p=h?r:e;return h?y.createElement(co,{zIndex:gs.activeBar},y.createElement(zx,il({},n,{name:String(n.name)},i,{isActive:h,option:p,index:a,dataKey:l}))):y.createElement(zx,il({},n,{name:String(n.name)},i,{isActive:h,option:p,index:a,dataKey:l}))}function zNe(t){var{shape:e,baseProps:r,entry:n,index:i,dataKey:a}=t;return y.createElement(zx,il({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:i,dataKey:a}))}function qNe(t){var e,{data:r,props:n}=t,i=(e=eo(n))!==null&&e!==void 0?e:{},{id:a}=i,l=qx(i,TNe),{shape:d,dataKey:u,activeBar:h}=n,{onMouseEnter:p,onClick:m,onMouseLeave:x}=n,b=qx(n,ONe),v=Qk(p,u,a),w=Zk(x),k=eS(m,u,a);return r?y.createElement(y.Fragment,null,r.map((_,T)=>y.createElement(CNe,il({index:T,key:"rectangle-".concat(_?.x,"-").concat(_?.y,"-").concat(_?.value,"-").concat(T),className:"recharts-bar-rectangle"},F0(b,_,T),{onMouseEnter:v(_,T),onMouseLeave:w(_,T),onClick:k(_,T)}),h?y.createElement(UNe,{shape:d,activeBar:h,baseProps:l,entry:_,index:T,dataKey:u}):y.createElement(zNe,{shape:d,baseProps:l,entry:_,index:T,dataKey:u})))):null}function FNe(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:i,isAnimationActive:a,animationBegin:l,animationDuration:d,animationEasing:u,onAnimationEnd:h,onAnimationStart:p}=e,m=r.current,x=zy(e,"recharts-bar-"),[b,v]=y.useState(!1),w=!b,k=y.useCallback(()=>{typeof h=="function"&&h(),v(!1)},[h]),_=y.useCallback(()=>{typeof p=="function"&&p(),v(!0)},[p]);return y.createElement($Ne,{showLabels:w,rects:n},y.createElement(Uy,{animationId:x,begin:l,duration:d,isActive:a,easing:u,onAnimationEnd:k,onAnimationStart:_,key:x},T=>{var A=T===1?n:n?.map((I,O)=>{var M=m&&m[O];if(M)return Ss(Ss({},I),{},{x:_n(M.x,I.x,T),y:_n(M.y,I.y,T),width:_n(M.width,I.width,T),height:_n(M.height,I.height,T)});if(i==="horizontal"){var E=_n(0,I.height,T),R=_n(I.stackedBarStart,I.y,T);return Ss(Ss({},I),{},{y:R,height:E})}var $=_n(0,I.width,T),B=_n(I.stackedBarStart,I.x,T);return Ss(Ss({},I),{},{width:$,x:B})});return T>0&&(r.current=A??null),A==null?null:y.createElement(Ts,null,y.createElement(qNe,{props:e,data:A}))}),y.createElement(gU,{label:e.label}),e.children)}function HNe(t){var e=y.useRef(null);return y.createElement(FNe,{previousRectanglesRef:e,props:t})}var BU=0,WNe=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:$r(t,e)}};class GNe extends y.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:i,xAxisId:a,yAxisId:l,needClip:d,background:u,id:h}=this.props;if(e||r==null)return null;var p=gr("recharts-bar",i),m=h;return y.createElement(Ts,{className:p,id:h},d&&y.createElement("defs",null,y.createElement(Ije,{clipPathId:m,xAxisId:a,yAxisId:l})),y.createElement(Ts,{className:"recharts-bar-rectangles",clipPath:d?"url(#clipPath-".concat(m,")"):void 0},y.createElement(BNe,{data:r,dataKey:n,background:u,allOtherBarProps:this.props}),y.createElement(HNe,this.props)))}}var VNe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:BU,xAxisId:0,yAxisId:0,zIndex:gs.bar};function KNe(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:l,animationBegin:d,animationDuration:u,animationEasing:h,isAnimationActive:p}=t,{needClip:m}=PU(e,r),x=K0(),b=vi(),v=Jk(t.children,sh),w=ft(T=>vNe(T,t.id,b,v));if(x!=="vertical"&&x!=="horizontal")return null;var k,_=w?.[0];return _==null||_.height==null||_.width==null?k=0:k=x==="vertical"?_.height/2:_.width/2,y.createElement(Pje,{xAxisId:e,yAxisId:r,data:w,dataPointFormatter:WNe,errorBarOffset:k},y.createElement(GNe,il({},t,{layout:x,needClip:m,data:w,xAxisId:e,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:l,animationBegin:d,animationDuration:u,animationEasing:h,isAnimationActive:p})))}function YNe(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:a,xAxis:l,yAxis:d,xAxisTicks:u,yAxisTicks:h,stackedData:p,displayedData:m,offset:x,cells:b,parentViewBox:v,dataStartIndex:w}=t,k=e==="horizontal"?d:l,_=p?k.scale.domain():null,T=xfe({numericAxis:k}),A=k.scale(T);return m.map((I,O)=>{var M,E,R,$,B,C;if(p){var U=p[O+w];if(U==null)return null;M=ufe(U,_)}else M=$r(I,r),Array.isArray(M)||(M=[T,M]);var L=nNe(n,BU)(M[1],O);if(e==="horizontal"){var q,[K,W]=[d.scale(M[0]),d.scale(M[1])];E=TO({axis:l,ticks:u,bandSize:a,offset:i.offset,entry:I,index:O}),R=(q=W??K)!==null&&q!==void 0?q:void 0,$=i.size;var V=K-W;if(B=to(V)?0:V,C={x:E,y:x.top,width:$,height:x.height},Math.abs(L)>0&&Math.abs(B)<Math.abs(L)){var X=rs(B||L)*(Math.abs(L)-Math.abs(B));R-=X,B+=X}}else{var[Z,G]=[l.scale(M[0]),l.scale(M[1])];if(E=Z,R=TO({axis:d,ticks:h,bandSize:a,offset:i.offset,entry:I,index:O}),$=G-Z,B=i.size,C={x:x.left,y:R,width:x.width,height:B},Math.abs(L)>0&&Math.abs($)<Math.abs(L)){var F=rs($||L)*(Math.abs(L)-Math.abs($));$+=F}}if(E==null||R==null||$==null||B==null)return null;var Y=Ss(Ss({},I),{},{stackedBarStart:A,x:E,y:R,width:$,height:B,value:p?M:M[1],payload:I,background:C,tooltipPosition:{x:E+$/2,y:R+B/2},parentViewBox:v},b&&b[O]&&b[O].props);return Y}).filter(Boolean)}function XNe(t){var e=ss(t,VNe),r=kNe(e.stackId),n=vi();return y.createElement(kU,{id:e.id,type:"bar"},i=>y.createElement(y.Fragment,null,y.createElement(Bwe,{legendPayload:INe(e)}),y.createElement(DNe,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:i}),y.createElement(Qwe,{type:"bar",id:i,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),y.createElement(co,{zIndex:e.zIndex},y.createElement(KNe,il({},e,{id:i})))))}var $U=y.memo(XNe,nS);$U.displayName="Bar";var JNe=["domain","range"],QNe=["domain","range"];function BL(t,e){if(t==null)return{};var r,n,i=ZNe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function ZNe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function $L(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function UU(t,e){if(t===e)return!0;var{domain:r,range:n}=t,i=BL(t,JNe),{domain:a,range:l}=e,d=BL(e,QNe);return!$L(r,a)||!$L(n,l)?!1:nS(i,d)}var e4e=["dangerouslySetInnerHTML","ticks","scale"],t4e=["id","scale"];function VN(){return VN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},VN.apply(null,arguments)}function UL(t,e){if(t==null)return{};var r,n,i=r4e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function r4e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function n4e(t){var e=Or(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?e(A2e(t)):r.current!==t&&e(T2e({prev:r.current,next:t})),r.current=t},[t,e]),y.useLayoutEffect(()=>()=>{r.current&&(e(O2e(r.current)),r.current=null)},[e]),null}var s4e=t=>{var{xAxisId:e,className:r}=t,n=ft(L5),i=vi(),a="xAxis",l=ft(_=>E$(_,a,e,i)),d=ft(_=>k$(_,e)),u=ft(_=>Lye(_,e)),h=ft(_=>i$(_,e));if(d==null||u==null||h==null)return null;var{dangerouslySetInnerHTML:p,ticks:m,scale:x}=t,b=UL(t,e4e),{id:v,scale:w}=h,k=UL(h,t4e);return y.createElement(rS,VN({},b,k,{x:u.x,y:u.y,width:d.width,height:d.height,className:gr("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:l,axisType:a}))},i4e={allowDataOverflow:Dn.allowDataOverflow,allowDecimals:Dn.allowDecimals,allowDuplicatedCategory:Dn.allowDuplicatedCategory,angle:Dn.angle,axisLine:od.axisLine,height:Dn.height,hide:!1,includeHidden:Dn.includeHidden,interval:Dn.interval,minTickGap:Dn.minTickGap,mirror:Dn.mirror,orientation:Dn.orientation,padding:Dn.padding,reversed:Dn.reversed,scale:Dn.scale,tick:Dn.tick,tickCount:Dn.tickCount,tickLine:od.tickLine,tickSize:od.tickSize,type:Dn.type,xAxisId:0},a4e=t=>{var e=ss(t,i4e);return y.createElement(y.Fragment,null,y.createElement(n4e,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),y.createElement(s4e,e))},zU=y.memo(a4e,UU);zU.displayName="XAxis";var o4e=["dangerouslySetInnerHTML","ticks","scale"],l4e=["id","scale"];function KN(){return KN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},KN.apply(null,arguments)}function zL(t,e){if(t==null)return{};var r,n,i=c4e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function c4e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function d4e(t){var e=Or(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?e(M2e(t)):r.current!==t&&e(L2e({prev:r.current,next:t})),r.current=t},[t,e]),y.useLayoutEffect(()=>()=>{r.current&&(e(R2e(r.current)),r.current=null)},[e]),null}var u4e=t=>{var{yAxisId:e,className:r,width:n,label:i}=t,a=y.useRef(null),l=y.useRef(null),d=ft(L5),u=vi(),h=Or(),p="yAxis",m=ft(M=>S$(M,e)),x=ft(M=>Pye(M,e)),b=ft(M=>E$(M,p,e,u)),v=ft(M=>a$(M,e));if(y.useLayoutEffect(()=>{if(!(n!=="auto"||!m||Kk(i)||y.isValidElement(i)||v==null)){var M=a.current;if(M){var E=M.getCalculatedWidth();Math.round(m.width)!==Math.round(E)&&h(P2e({id:e,width:E}))}}},[b,m,h,i,e,n,v]),m==null||x==null||v==null)return null;var{dangerouslySetInnerHTML:w,ticks:k,scale:_}=t,T=zL(t,o4e),{id:A,scale:I}=v,O=zL(v,l4e);return y.createElement(rS,KN({},T,O,{ref:a,labelRef:l,x:x.x,y:x.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:m.width,height:m.height,className:gr("recharts-".concat(p," ").concat(p),r),viewBox:d,ticks:b,axisType:p}))},h4e={allowDataOverflow:Bn.allowDataOverflow,allowDecimals:Bn.allowDecimals,allowDuplicatedCategory:Bn.allowDuplicatedCategory,angle:Bn.angle,axisLine:od.axisLine,hide:!1,includeHidden:Bn.includeHidden,interval:Bn.interval,minTickGap:Bn.minTickGap,mirror:Bn.mirror,orientation:Bn.orientation,padding:Bn.padding,reversed:Bn.reversed,scale:Bn.scale,tick:Bn.tick,tickCount:Bn.tickCount,tickLine:od.tickLine,tickSize:od.tickSize,type:Bn.type,width:Bn.width,yAxisId:0},f4e=t=>{var e=ss(t,h4e);return y.createElement(y.Fragment,null,y.createElement(d4e,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),y.createElement(u4e,e))},qU=y.memo(f4e,UU);qU.displayName="YAxis";var p4e=(t,e)=>e,sS=we([p4e,ar,n$,Tn,H$,bl,Xbe,En],nve),iS=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},FU=Yi("mouseClick"),HU=G0();HU.startListening({actionCreator:FU,effect:(t,e)=>{var r=t.payload,n=sS(e.getState(),iS(r));n?.activeIndex!=null&&e.dispatch(Yye({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var YN=Yi("mouseMove"),WU=G0(),ug=null;WU.startListening({actionCreator:YN,effect:(t,e)=>{var r=t.payload;ug!==null&&cancelAnimationFrame(ug);var n=iS(r);ug=requestAnimationFrame(()=>{var i=e.getState(),a=Dk(i,i.tooltip.settings.shared);if(a==="axis"){var l=sS(i,n);l?.activeIndex!=null?e.dispatch(I$({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):e.dispatch(P$())}ug=null})}});function m4e(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var qL={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},GU=Ys({name:"rootProps",initialState:qL,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:qL.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),g4e=GU.reducer,{updateOptions:x4e}=GU.actions,VU=Ys({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:y4e}=VU.actions,b4e=VU.reducer,KU=Yi("keyDown"),YU=Yi("focus"),aS=G0();aS.startListening({actionCreator:KU,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var l=Bk(i,wh(r),sp(r),op(r)),d=l==null?-1:Number(l);if(!(!Number.isFinite(d)||d<0)){var u=bl(r);if(a==="Enter"){var h=Dx(r,"axis","hover",String(i.index));e.dispatch(UN({active:!i.active,activeIndex:i.index,activeCoordinate:h}));return}var p=$ye(r),m=p==="left-to-right"?1:-1,x=a==="ArrowRight"?1:-1,b=d+x*m;if(!(u==null||b>=u.length||b<0)){var v=Dx(r,"axis","hover",String(b));e.dispatch(UN({active:!0,activeIndex:b.toString(),activeCoordinate:v}))}}}}}});aS.startListening({actionCreator:YU,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",l=Dx(r,"axis","hover",String(a));e.dispatch(UN({active:!0,activeIndex:a,activeCoordinate:l}))}}}});var Bi=Yi("externalEvent"),XU=G0(),tj=new Map;XU.startListening({actionCreator:Bi,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var i=n.type,a=tj.get(i);a!==void 0&&cancelAnimationFrame(a);var l=requestAnimationFrame(()=>{try{var d=e.getState(),u={activeCoordinate:Pbe(d),activeDataKey:Fk(d),activeIndex:Sd(d),activeLabel:V$(d),activeTooltipIndex:Sd(d),isTooltipActive:Ibe(d)};r(u,n)}finally{tj.delete(i)}});tj.set(i,l)}}});var v4e=we([bh],t=>t.tooltipItemPayloads),w4e=we([v4e,ap,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(d=>d.settings.graphicalItemId===n);if(i!=null){var{positions:a}=i;if(a!=null){var l=e(a,r);return l}}}),JU=Yi("touchMove"),QU=G0();QU.startListening({actionCreator:JU,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),i=Dk(n,n.tooltip.settings.shared);if(i==="axis"){var a=r.touches[0];if(a==null)return;var l=sS(n,iS({clientX:a.clientX,clientY:a.clientY,currentTarget:r.currentTarget}));l?.activeIndex!=null&&e.dispatch(I$({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}else if(i==="item"){var d,u=r.touches[0];if(document.elementFromPoint==null||u==null)return;var h=document.elementFromPoint(u.clientX,u.clientY);if(!h||!h.getAttribute)return;var p=h.getAttribute(kD),m=(d=h.getAttribute(SD))!==null&&d!==void 0?d:void 0,x=vh(n).find(w=>w.id===m);if(p==null||x==null||m==null)return;var{dataKey:b}=x,v=w4e(n,p,m);e.dispatch(R$({activeDataKey:b,activeIndex:p,activeCoordinate:v,activeGraphicalItemId:m}))}}}});var j4e=K7({brush:V2e,cartesianAxis:I2e,chartData:Ove,errorBars:Aje,graphicalItems:Xwe,layout:ife,legend:p0e,options:_ve,polarAxis:cwe,polarOptions:b4e,referenceElements:eje,rootProps:g4e,tooltip:Xye,zIndex:xve}),N4e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return The({reducer:j4e,preloadedState:e,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([HU.middleware,WU.middleware,aS.middleware,XU.middleware,QU.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(cD({type:"raf"}))},devTools:{serialize:{replacer:m4e},name:"recharts-".concat(r)}})};function ZU(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=vi(),a=y.useRef(null);if(i)return r;a.current==null&&(a.current=N4e(e,n));var l=k5;return y.createElement(Qje,{context:l,store:a.current},r)}function k4e(t){var{layout:e,margin:r}=t,n=Or(),i=vi();return y.useEffect(()=>{i||(n(rfe(e)),n(tfe(r)))},[n,i,e,r]),null}var ez=y.memo(k4e,nS);function tz(t){var e=Or();return y.useEffect(()=>{e(x4e(t))},[e,t]),null}function FL(t){var{zIndex:e,isPanorama:r}=t,n=y.useRef(null),i=Or();return y.useLayoutEffect(()=>(n.current&&i(mve({zIndex:e,element:n.current,isPanorama:r})),()=>{i(gve({zIndex:e,isPanorama:r}))}),[i,e,r]),y.createElement("g",{tabIndex:-1,ref:n})}function HL(t){var{children:e,isPanorama:r}=t,n=ft(ive);if(!n||n.length===0)return e;var i=n.filter(l=>l<0),a=n.filter(l=>l>0);return y.createElement(y.Fragment,null,i.map(l=>y.createElement(FL,{key:l,zIndex:l,isPanorama:r})),e,a.map(l=>y.createElement(FL,{key:l,zIndex:l,isPanorama:r})))}var S4e=["children"];function _4e(t,e){if(t==null)return{};var r,n,i=C4e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function C4e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Fx(){return Fx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Fx.apply(null,arguments)}var E4e={width:"100%",height:"100%",display:"block"},A4e=y.forwardRef((t,e)=>{var r=TD(),n=OD(),i=FD();if(!xc(r)||!xc(n))return null;var{children:a,otherAttributes:l,title:d,desc:u}=t,h,p;return l!=null&&(typeof l.tabIndex=="number"?h=l.tabIndex:h=i?0:void 0,typeof l.role=="string"?p=l.role:p=i?"application":void 0),y.createElement(m5,Fx({},l,{title:d,desc:u,role:p,tabIndex:h,width:r,height:n,style:E4e,ref:e}),a)}),T4e=t=>{var{children:e}=t,r=ft(Ly);if(!r)return null;var{width:n,height:i,y:a,x:l}=r;return y.createElement(m5,{width:n,height:i,x:l,y:a},e)},WL=y.forwardRef((t,e)=>{var{children:r}=t,n=_4e(t,S4e),i=vi();return i?y.createElement(T4e,null,y.createElement(HL,{isPanorama:!0},r)):y.createElement(A4e,Fx({ref:e},n),y.createElement(HL,{isPanorama:!1},r))});function O4e(){var t=Or(),[e,r]=y.useState(null),n=ft(Nfe);return y.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;Jr(a)&&a!==n&&t(sfe(a))}},[e,t,n]),r}function GL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function M4e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GL(Object(r),!0).forEach(function(n){L4e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function L4e(t,e,r){return(e=R4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R4e(t){var e=P4e(t,"string");return typeof e=="symbol"?e:e+""}function P4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cd(){return Cd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cd.apply(null,arguments)}var I4e=()=>(Uve(),null);function Hx(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var D4e=y.forwardRef((t,e)=>{var r,n,i=y.useRef(null),[a,l]=y.useState({containerWidth:Hx((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:Hx((n=t.style)===null||n===void 0?void 0:n.height)}),d=y.useCallback((h,p)=>{l(m=>{var x=Math.round(h),b=Math.round(p);return m.containerWidth===x&&m.containerHeight===b?m:{containerWidth:x,containerHeight:b}})},[]),u=y.useCallback(h=>{if(typeof e=="function"&&e(h),h!=null&&typeof ResizeObserver<"u"){var{width:p,height:m}=h.getBoundingClientRect();d(p,m);var x=v=>{var{width:w,height:k}=v[0].contentRect;d(w,k)},b=new ResizeObserver(x);b.observe(h),i.current=b}},[e,d]);return y.useEffect(()=>()=>{var h=i.current;h?.disconnect()},[d]),y.createElement(y.Fragment,null,y.createElement(Py,{width:a.containerWidth,height:a.containerHeight}),y.createElement("div",Cd({ref:u},t)))}),B4e=y.forwardRef((t,e)=>{var{width:r,height:n}=t,[i,a]=y.useState({containerWidth:Hx(r),containerHeight:Hx(n)}),l=y.useCallback((u,h)=>{a(p=>{var m=Math.round(u),x=Math.round(h);return p.containerWidth===m&&p.containerHeight===x?p:{containerWidth:m,containerHeight:x}})},[]),d=y.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null){var{width:h,height:p}=u.getBoundingClientRect();l(h,p)}},[e,l]);return y.createElement(y.Fragment,null,y.createElement(Py,{width:i.containerWidth,height:i.containerHeight}),y.createElement("div",Cd({ref:d},t)))}),$4e=y.forwardRef((t,e)=>{var{width:r,height:n}=t;return y.createElement(y.Fragment,null,y.createElement(Py,{width:r,height:n}),y.createElement("div",Cd({ref:e},t)))}),U4e=y.forwardRef((t,e)=>{var{width:r,height:n}=t;return Zo(r)||Zo(n)?y.createElement(B4e,Cd({},t,{ref:e})):y.createElement($4e,Cd({},t,{ref:e}))});function z4e(t){return t===!0?D4e:U4e}var q4e=y.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:l,onDoubleClick:d,onMouseDown:u,onMouseEnter:h,onMouseLeave:p,onMouseMove:m,onMouseUp:x,onTouchEnd:b,onTouchMove:v,onTouchStart:w,style:k,width:_,responsive:T,dispatchTouchEvents:A=!0}=t,I=y.useRef(null),O=Or(),[M,E]=y.useState(null),[R,$]=y.useState(null),B=O4e(),C=R5(),U=C?.width>0?C.width:_,L=C?.height>0?C.height:i,q=y.useCallback(te=>{B(te),typeof e=="function"&&e(te),E(te),$(te),te!=null&&(I.current=te)},[B,e,E,$]),K=y.useCallback(te=>{O(FU(te)),O(Bi({handler:a,reactEvent:te}))},[O,a]),W=y.useCallback(te=>{O(YN(te)),O(Bi({handler:h,reactEvent:te}))},[O,h]),V=y.useCallback(te=>{O(P$()),O(Bi({handler:p,reactEvent:te}))},[O,p]),X=y.useCallback(te=>{O(YN(te)),O(Bi({handler:m,reactEvent:te}))},[O,m]),Z=y.useCallback(()=>{O(YU())},[O]),G=y.useCallback(te=>{O(KU(te.key))},[O]),F=y.useCallback(te=>{O(Bi({handler:l,reactEvent:te}))},[O,l]),Y=y.useCallback(te=>{O(Bi({handler:d,reactEvent:te}))},[O,d]),ne=y.useCallback(te=>{O(Bi({handler:u,reactEvent:te}))},[O,u]),re=y.useCallback(te=>{O(Bi({handler:x,reactEvent:te}))},[O,x]),ue=y.useCallback(te=>{O(Bi({handler:w,reactEvent:te}))},[O,w]),Le=y.useCallback(te=>{A&&O(JU(te)),O(Bi({handler:v,reactEvent:te}))},[O,A,v]),de=y.useCallback(te=>{O(Bi({handler:b,reactEvent:te}))},[O,b]),ve=z4e(T);return y.createElement(eU.Provider,{value:M},y.createElement(u7.Provider,{value:R},y.createElement(ve,{width:U??k?.width,height:L??k?.height,className:gr("recharts-wrapper",n),style:M4e({position:"relative",cursor:"default",width:U,height:L},k),onClick:K,onContextMenu:F,onDoubleClick:Y,onFocus:Z,onKeyDown:G,onMouseDown:ne,onMouseEnter:W,onMouseLeave:V,onMouseMove:X,onMouseUp:re,onTouchEnd:de,onTouchMove:Le,onTouchStart:ue,ref:q},y.createElement(I4e,null),r)))}),F4e=["width","height","responsive","children","className","style","compact","title","desc"];function H4e(t,e){if(t==null)return{};var r,n,i=W4e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function W4e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var rz=y.forwardRef((t,e)=>{var{width:r,height:n,responsive:i,children:a,className:l,style:d,compact:u,title:h,desc:p}=t,m=H4e(t,F4e),x=eo(m);return u?y.createElement(y.Fragment,null,y.createElement(Py,{width:r,height:n}),y.createElement(WL,{otherAttributes:x,title:h,desc:p},a)):y.createElement(q4e,{className:l,style:d,width:r,height:n,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},y.createElement(WL,{otherAttributes:x,title:h,desc:p,ref:e},y.createElement(rje,null,a)))});function XN(){return XN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},XN.apply(null,arguments)}var G4e={top:5,right:5,bottom:5,left:5},V4e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:G4e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},K4e=y.forwardRef(function(e,r){var n,i=ss(e.categoricalChartProps,V4e),{chartName:a,defaultTooltipEventType:l,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,categoricalChartProps:h}=e,p={chartName:a,defaultTooltipEventType:l,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return y.createElement(ZU,{preloadedState:{options:p},reduxStoreName:(n=h.id)!==null&&n!==void 0?n:a},y.createElement(TU,{chartData:h.data}),y.createElement(ez,{layout:i.layout,margin:i.margin}),y.createElement(tz,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),y.createElement(rz,XN({},i,{ref:r})))}),Y4e=["axis","item"],X4e=y.forwardRef((t,e)=>y.createElement(K4e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Y4e,tooltipPayloadSearcher:tU,categoricalChartProps:t,ref:e}));function J4e(t){var e=Or();return y.useEffect(()=>{e(y4e(t))},[e,t]),null}var Q4e=["layout"];function JN(){return JN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},JN.apply(null,arguments)}function Z4e(t,e){if(t==null)return{};var r,n,i=e5e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function e5e(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var t5e={top:5,right:5,bottom:5,left:5},nz={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:t5e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},r5e=y.forwardRef(function(e,r){var n,i=ss(e.categoricalChartProps,nz),{layout:a}=i,l=Z4e(i,Q4e),{chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:p}=e,m={chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:p,eventEmitter:void 0};return y.createElement(ZU,{preloadedState:{options:m},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:d},y.createElement(TU,{chartData:i.data}),y.createElement(ez,{layout:a,margin:i.margin}),y.createElement(tz,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),y.createElement(J4e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),y.createElement(rz,JN({},l,{ref:r})))});function VL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function KL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VL(Object(r),!0).forEach(function(n){n5e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function n5e(t,e,r){return(e=s5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s5e(t){var e=i5e(t,"string");return typeof e=="symbol"?e:e+""}function i5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var a5e=["item"],o5e=KL(KL({},nz),{},{layout:"centric",startAngle:0,endAngle:360}),l5e=y.forwardRef((t,e)=>{var r=ss(t,o5e);return y.createElement(r5e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:a5e,tooltipPayloadSearcher:tU,categoricalChartProps:r,ref:e})});const Wx=({cards:t=[],type:e="all"})=>{const r=y.useMemo(()=>{const d={0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0};return t.forEach(u=>{const h=u.data||u,p=(h.type_line||"").toLowerCase();if(p.includes("land")&&!p.includes("creature")&&!p.includes("artifact"))return;const m=h.cmc??h.manavalue??0;m>=7?d["7+"]++:d[Math.floor(m)]++}),Object.entries(d).map(([u,h])=>({label:u,value:h}))},[t]),n=y.useMemo(()=>{const d={};return t.forEach(u=>{const p=(u.data||u).type_line||"";["Creature","Instant","Sorcery","Artifact","Enchantment","Planeswalker","Land","Battle"].forEach(x=>{p.includes(x)&&(d[x]=(d[x]||0)+1)})}),Object.entries(d).map(([u,h])=>({name:u,value:h}))},[t]),i=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c","#d0ed57","#8dd1e1"],a=()=>s.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[e==="all"&&s.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Mana Curve"}),s.jsx(qO,{width:"100%",height:"100%",children:s.jsxs(X4e,{data:r,children:[s.jsx(zU,{dataKey:"label",stroke:"#9ca3af",tick:{fontSize:12}}),s.jsx(qU,{stroke:"#9ca3af",allowDecimals:!1,tick:{fontSize:12},width:30}),s.jsx(H8,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(255,255,255,0.1)"}}),s.jsx($U,{dataKey:"value",fill:"#6366f1",radius:[4,4,0,0],children:r.map((d,u)=>s.jsx(sh,{fill:i[u%i.length]},`cell-${u}`))})]})})]}),l=()=>s.jsxs("div",{className:"h-full w-full min-h-[160px]",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-4 text-center",children:"Card Types"}),s.jsx(qO,{width:"100%",height:"100%",children:s.jsxs(l5e,{children:[s.jsx(_U,{data:n,cx:"50%",cy:"50%",labelLine:!1,outerRadius:"80%",fill:"#8884d8",dataKey:"value",label:({cx:d,cy:u,midAngle:h,innerRadius:p,outerRadius:m,percent:x,index:b})=>null,children:n.map((d,u)=>s.jsx(sh,{fill:i[u%i.length]},`cell-${u}`))}),s.jsx(H8,{contentStyle:{backgroundColor:"#1f2937",borderColor:"#374151",color:"#fff"}}),s.jsx(qD,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"12px"}})]})})]});return e==="mana"?s.jsx("div",{className:"w-full h-full",children:a()}):e==="types"?s.jsx("div",{className:"w-full h-full",children:l()}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-800 rounded-xl border border-gray-700",children:[s.jsx("div",{className:"h-64",children:a()}),s.jsx("div",{className:"h-64",children:l()})]})},rj=[{badge:"White",colors:["W"],theme:"Absolute Order"},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry"},{badge:"Black",colors:["B"],theme:"Unrestricted Power"},{badge:"Red",colors:["R"],theme:"Chaotic Passion"},{badge:"Green",colors:["G"],theme:"Primal Growth"},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control"},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration"},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage"},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction"},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony"},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity"},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genus"},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot"},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression"},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution"},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic"},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny"},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation"},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty"},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order"},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance"},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark"},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay"},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest"},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct"},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence"},{badge:"Colorless",colors:["C"],theme:"The Great Void"}],c5e=()=>{const{id:t}=ol(),e=on(),{currentUser:r,userProfile:n}=Mt(),{addToast:i}=_r(),[a,l]=y.useState(null),[d,u]=y.useState(!0),[h,p]=y.useState("grid"),[m,x]=y.useState(null),[b,v]=y.useState(0);y.useEffect(()=>{(async()=>{try{const K=await Pe.get(`/api/precons/${t}`);l(K)}catch(K){console.error("Precon load failed",K),i("Failed to load precon","error"),e("/precons")}finally{u(!1)}})()},[t,e,i]);const w=y.useMemo(()=>a?[...(a.data.commander||[]).map(q=>({...q,isCommander:!0})),...a.data.mainBoard||[]]:[],[a]),k=y.useMemo(()=>{if(!a)return null;const q=a.data.commander||[];if(q.length>0)return q[0];let K=null,W=-1;const V=X=>X.data?.cmc||X.cmc||0;for(const X of a.data.mainBoard||[]){const Z=V(X);Z>W&&(W=Z,K=X)}return K},[a]),_=y.useMemo(()=>!a?.data?.commander||a.data.commander.length<2?null:a.data.commander[1],[a]),T=b===0?k:_||k,A=q=>q?q.image_uris?.normal?q.image_uris.normal:q.card_faces?.[0]?.image_uris?.normal?q.card_faces[0].image_uris.normal:q.data?.image_uris?.normal?q.data.image_uris.normal:q.data?.card_faces?.[0]?.image_uris?.normal?q.data.card_faces[0].image_uris.normal:"https://placehold.co/400x600":"",O=(q=>q?q.image_uris?.art_crop?q.image_uris.art_crop:q.data?.image_uris?.art_crop?q.data.image_uris.art_crop:q.card_faces?.[0]?.image_uris?.art_crop?q.card_faces[0].image_uris.art_crop:q.data?.card_faces?.[0]?.image_uris?.art_crop?q.data.card_faces[0].image_uris.art_crop:A(q):"")(T),M={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},E=y.useMemo(()=>w.reduce((q,K)=>q+(K.count||K.quantity||1),0),[w]),R=y.useMemo(()=>w.reduce((q,K)=>{const W=parseFloat(K.prices?.usd||K.prices?.usd_foil||K.data?.prices?.usd||K.data?.prices?.usd_foil||0);return q+W*(K.count||K.quantity||1)},0),[w]),$=y.useMemo(()=>{const q={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return w.forEach(K=>{if(K.isCommander){q.Commander.push(K);return}const W=(K.data?.type_line||K.type||"").toLowerCase();W.includes("creature")?q.Creature.push(K):W.includes("planeswalker")?q.Planeswalker.push(K):W.includes("instant")?q.Instant.push(K):W.includes("sorcery")?q.Sorcery.push(K):W.includes("artifact")?q.Artifact.push(K):W.includes("enchantment")?q.Enchantment.push(K):W.includes("land")?q.Land.push(K):q.Other.push(K)}),Object.keys(q).forEach(K=>{q[K]=q[K].map(W=>({...W,image_uri:A(W)}))}),Object.fromEntries(Object.entries(q).filter(([K,W])=>W.length>0))},[w]),B=y.useMemo(()=>{if(!a)return rj.find(W=>W.badge==="Colorless");const q=a.data?.colors||[];return rj.find(W=>W.colors.length!==q.length?!1:W.colors.every(V=>q.includes(V)))||rj.find(W=>W.badge==="Colorless")},[a]),{cards:C}=Gs(),{decks:U}=Pd(),L=async q=>{const K=n?.subscription_tier||"free",W=Yt(K),V=W.limits.decks;if(V!==1/0&&U&&U.length>=V){i(`Deck limit reached (${U.length}/${V}). Upgrade to add this deck!`,"error");return}const X=q==="wishlist",Z=X?"wishlist":"collection",G=W.limits[Z];if(G!==1/0&&C){const F=C.filter(ne=>!!ne.is_wishlist===X).reduce((ne,re)=>ne+(re.count||1),0),Y=E;if(F+Y>G){i(`${X?"Wishlist":"Collection"} limit reached. Cannot add ${Y} cards. Upgrade needed!`,"error");return}}x(q);try{const F=await Pe.post(`/api/precons/${a.id}/create`,{mode:q});F.success&&(i("Deck created successfully!","success"),e(`/decks/${F.deckId}`))}catch(F){console.error(F),F.message&&F.message.includes("Limit reached")?i(F.message,"error"):i("Failed to create deck","error")}finally{x(null)}};return d?s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})}):a?s.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${O})`},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2 font-bold",children:[s.jsx(_t,{to:"/precons",className:"hover:text-white transition-colors",children:"Precons"}),s.jsx("span",{children:"/"}),a.data.code&&s.jsxs(s.Fragment,{children:[s.jsx(_t,{to:`/precons/set/${a.data.code}`,className:"hover:text-white transition-colors",children:a.data.code}),s.jsx("span",{children:"/"})]}),s.jsx("span",{className:"text-white",children:a.name})]}),s.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:a.type||"Commander"}),s.jsx("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:"Official Precon"})]}),s.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:a.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:(a.data.colors||[]).map(q=>s.jsx("img",{src:M[q],alt:q,className:"w-6 h-6"},q))}),s.jsx("div",{className:"h-4 w-px bg-white/10"}),s.jsx("div",{className:"text-sm font-bold text-gray-400",children:B?.theme||"Deck"})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",R.toFixed(2)]}),s.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[E," Cards"]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 mt-2",children:[s.jsxs("a",{href:`https://www.amazon.com/s?k=${encodeURIComponent(a.name)}&tag=mtgsite-20`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#FF9900] text-black px-4 py-2 rounded-xl font-black hover:bg-[#FF9900]/90 transition-colors shadow-lg shadow-orange-900/20 text-xs uppercase tracking-wider flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M15.54 13.924c-1.35 1.572-3.645 2.502-5.466 2.502-3.132 0-5.187-1.487-6.264-2.292l-.768 1.488c1.374 1.05 4.092 3.036 8.046 2.454 2.829-.414 5.37-2.67 6.096-3.816l-1.644-.336zM3.444 19.542l1.626 1.104c.126.066.27.018.33-.096.792-2.142 2.766-3.21 2.898-3.276.102-.054.126-.18.066-.27l-1.632-2.07c-.066-.09-.192-.09-.264-.024-.03.042-2.22 2.652-3.09 4.392-.048.102.006.21.066.24zM20.598 6.942C20.598 6.942 18.078 2.37 11.232 2.598 4.296 2.826 2.898 7.356 2.898 7.356c-.054.168.042.33.204.372l1.83.474c.144.036.294-.036.354-.168.03-.066 1.038-2.61 5.388-2.88 2.058-.126 4.194.516 5.34 1.764.57.624.81 1.434.69 2.214-1.284.186-2.58.348-3.84.48-4.2.438-6.198 2.052-6.114 4.542.06 1.764 1.344 3.324 3.96 3.258 2.634-.066 4.104-1.848 4.104-1.848v1.446c0 .168.126.3.288.3h1.992c.162 0 .288-.132.288-.3l.006-4.944c-.006-3.324-1.746-5.124-4.8-5.124H20.598zM12.924 10.998c0 .672-.084 1.458-.87 2.016-.624.456-1.398.546-1.956.558-1.098.024-1.722-.594-1.758-1.218-.048-1.02 0-1.872 4.584-2.316v.96z"})}),"Amazon"]}),s.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${a.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#2a2a2a] text-white px-4 py-2 rounded-xl font-black hover:bg-[#3a3a3a] transition-colors shadow-lg shadow-black/20 text-xs uppercase tracking-wider flex items-center gap-2 border border-white/10",children:[s.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"TCGPlayer"]}),s.jsx("button",{onClick:()=>L("collection"),disabled:m,className:"bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm disabled:opacity-50",children:m==="collection"?"Adding...":"Add to Collection"}),s.jsx("button",{onClick:()=>L("wishlist"),disabled:m,className:"bg-gray-800 text-white border border-gray-700 px-4 py-2 rounded-xl font-bold hover:bg-gray-700 transition-colors text-sm disabled:opacity-50",children:"Wishlist"})]})]})]})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>p("grid"),className:`p-1.5 rounded ${h==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>p("table"),className:`p-1.5 rounded ${h==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsx("div",{className:"p-4 space-y-8",children:Object.entries($).map(([q,K])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[s.jsx("span",{children:q}),s.jsx("span",{className:"text-gray-500",children:K.reduce((W,V)=>W+(V.count||V.quantity||1),0)})]}),h==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:K.map((W,V)=>s.jsx(Yu,{card:W,readOnly:!0,showQuantity:!0},V))}):s.jsx("div",{className:"space-y-1",children:K.map((W,V)=>s.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:"font-mono text-gray-500",children:W.count||W.quantity||1}),s.jsx("span",{className:W.finish==="foil"?"text-yellow-200":"",children:W.name})]}),s.jsx("div",{className:"font-mono text-xs opacity-50",children:W.manacost||W.mana_cost||W.data?.mana_cost})]},V))})]},q))})]})}),s.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:k?.isCommander?"Commander":"Spotlight Card"}),s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:A(T)||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Featured Card"}),T?.data?.card_faces?.length>1&&T.data.card_faces[1].image_uris&&s.jsx("button",{className:"absolute bottom-2 right-2 p-2 bg-gray-900/80 rounded block md:hidden",title:"Flip",children:""})]}),_&&s.jsx("button",{onClick:()=>v(q=>q===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:b===0?"View Partner":"View Commander"})]}),s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[s.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"h-[120px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),s.jsx(Wx,{cards:w,type:"mana"})]}),s.jsxs("div",{className:"h-[220px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),s.jsx(Wx,{cards:w,type:"types"})]})]})]})]})]})]})]}):null},Ro={ANALYSIS:1,ARCHITECT:2,DEPLOY:3},d5e=()=>{const{deckId:t}=ol(),e=on(),{userProfile:r,currentUser:n}=Mt(),{addToast:i}=_r(),{deck:a,cards:l,loading:d}=I9(t),{cards:u}=Gs(),[h,p]=y.useState(Ro.ANALYSIS),[m,x]=y.useState(`Initializing ${r?.settings?.helper?.name||"Oracle"}...`),[b,v]=y.useState([]),[w,k]=y.useState(!1),[_,T]=y.useState({}),[A,I]=y.useState(new Set),[O,M]=y.useState("All"),[E,R]=y.useState("grid"),$=y.useRef(null),[B,C]=y.useState({ownedOnly:!0,excludeAssigned:!0,restrictSet:!1,setName:""});y.useEffect(()=>{$.current?.scrollIntoView({behavior:"smooth"})},[b]),y.useEffect(()=>{a?.commander?.set_name&&!B.setName&&C(de=>({...de,setName:a.commander.set_name}))},[a,B.setName]);const U=de=>{v(ve=>[...ve,`[${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}] ${de}`])},L=r?.settings?.helper?.name||"The Oracle",q=de=>{if(!de)return null;const ve=de.data||de;return ve.image_uris?.art_crop?ve.image_uris.art_crop:ve.card_faces?.[0]?.image_uris?.art_crop?ve.card_faces[0].image_uris.art_crop:ve.image_uris?.normal?ve.image_uris.normal:null},K=de=>new Promise(ve=>setTimeout(ve,de)),W={W:"00000000-0000-0000-0000-000000000001",U:"00000000-0000-0000-0000-000000000002",B:"00000000-0000-0000-0000-000000000003",R:"00000000-0000-0000-0000-000000000004",G:"00000000-0000-0000-0000-000000000005"},V=(de,ve)=>{const te={W:0,U:0,B:0,R:0,G:0,total:0},ge=ke=>{ke&&(te.W+=(ke.match(/\{W\}/g)||[]).length,te.U+=(ke.match(/\{U\}/g)||[]).length,te.B+=(ke.match(/\{B\}/g)||[]).length,te.R+=(ke.match(/\{R\}/g)||[]).length,te.G+=(ke.match(/\{G\}/g)||[]).length)};return de.forEach(ke=>ge(ke.mana_cost||ke.data?.mana_cost)),Object.values(ve).forEach(ke=>ge(ke.data?.mana_cost||ke.type_line)),te.total=te.W+te.U+te.B+te.R+te.G,te},X=(de,ve,te)=>{if(de<=0)return{};if(ve.total===0)return{};const ge={W:{name:"Plains",type:"Basic Land  Plains"},U:{name:"Island",type:"Basic Land  Island"},B:{name:"Swamp",type:"Basic Land  Swamp"},R:{name:"Mountain",type:"Basic Land  Mountain"},G:{name:"Forest",type:"Basic Land  Forest"}},ke={};let oe=0;const Ee={};if(["W","U","B","R","G"].forEach(Te=>{if(ve[Te]>0){const Ye=ve[Te]/ve.total,ze=Math.round(de*Ye);Ee[Te]=ze,oe+=ze}}),oe>0){const Te=Object.keys(Ee).filter(Ye=>Ee[Ye]>0);Te.sort((Ye,ze)=>Ee[ze]-Ee[Ye]),oe<de?Ee[Te[0]]+=de-oe:oe>de&&(Ee[Te[0]]-=oe-de)}return Object.entries(Ee).forEach(([Te,Ye])=>{if(Ye>0){const ze=ge[Te],le=W[Te],pe=te.find(me=>me.name===ze.name)||{name:ze.name,type_line:ze.type,scryfall_id:le,id:le,image_uris:{normal:`https://api.scryfall.com/cards/named?exact=${ze.name}&format=image`}};for(let me=0;me<Ye;me++){const Ie=`basic-${Te}-${me}-${Date.now()}`;ke[Ie]={firestoreId:Ie,name:ze.name,type_line:ze.type,rating:10,reason:`Auto-filled to match ${Math.round(ve[Te]/ve.total*100)}% ${Te} pip density.`,suggestedType:"Land",data:{...pe.data||pe,scryfall_id:pe.scryfall_id||pe.id||le},isVirtual:!0}}}}),ke},Z=(de,ve)=>{if(!de||de.length===0)return!0;if(!ve||ve.length===0)return de.length===0;const te=new Set(ve);return de.every(ge=>te.has(ge))},G=async()=>{if(!r?.settings?.geminiApiKey){i("Gemini API Key missing in settings.","error"),e("/settings/ai");return}k(!0),x("Scanning Collection..."),U(`Starting analysis (Owned: ${B.ownedOnly}, Exclude Assigned: ${B.excludeAssigned}, Set: ${B.restrictSet?B.setName:"Any"})...`);try{const de=[...new Set([...a.commander?.color_identity||[],...a.commander_partner?.color_identity||[]])],ve=a.aiBlueprint||{},te=["Synergy / Strategy","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Land"],ge=new Set(l.map(nt=>nt.name));a.commander?.name&&ge.add(a.commander.name),a.commander_partner?.name&&ge.add(a.commander_partner.name);const ke={Land:36,"Mana Ramp":10,"Card Draw":10,"Targeted Removal":10,"Board Wipes":3,"Synergy / Strategy":30,...ve.suggestedCounts||{}},oe={},Ee=new Set,Te=B.setName.toLowerCase().trim(),Ye={};let ze=0;for(const nt of te){const kt=l.filter(it=>(it.data?.type_line||it.type_line||"").includes(nt)).reduce((it,jt)=>it+(jt.countInDeck||1),0),mt=ke[nt]||0;let Re=Math.max(0,mt-kt);Re>0&&(Ye[nt]=Re,ze+=Re)}if(ze===0){U("Deck goals appear met! No missing slots found based on targets."),k(!1),x("Idle");return}U(`Scanning collection for candidates (Need ${ze} total items)...`);const le=[],pe=new Set;for(const nt of u){if(pe.has(nt.name)||B.ownedOnly&&nt.is_wishlist||B.excludeAssigned&&nt.deckId)continue;const kt=nt.data?.color_identity||nt.data?.colors||[];if(Z(kt,de)&&!ge.has(nt.name)){if(B.restrictSet&&Te){const mt=(nt.set_name||nt.data?.set_name||"").toLowerCase(),Re=(nt.set||nt.data?.set||"").toLowerCase();if(!mt.includes(Te)&&Re!==Te)continue}le.push({firestoreId:nt.id,name:nt.name,type_line:nt.data?.type_line||nt.type_line}),pe.add(nt.name)}}if(le.length===0){U("No valid candidates found with current filters."),k(!1),x("Idle");return}const me={Creature:0,Instant:0,Sorcery:0,Artifact:0,Enchantment:0,Land:0,Planeswalker:0};le.forEach(nt=>{const kt=(nt.type_line||"").toLowerCase();kt.includes("creature")&&me.Creature++,kt.includes("instant")&&me.Instant++,kt.includes("sorcery")&&me.Sorcery++,kt.includes("artifact")&&me.Artifact++,kt.includes("enchantment")&&me.Enchantment++,kt.includes("land")&&me.Land++,kt.includes("planeswalker")&&me.Planeswalker++}),U(`Payload: ${le.length} Cards available for Analysis.`),U(`Breakdown: ${me.Creature} Creatures, ${me.Instant} Instants, ${me.Sorcery} Sorceries, ${me.Artifact} Artifacts, ${me.Enchantment} Enchantments, ${me.Land} Lands`);const Ie={deckName:a.name,commander:`${a.commander?.name}${a.commander_partner?" & "+a.commander_partner.name:""}`,playerProfile:JSON.stringify(r?.playstyle||{}),strategyGuide:ve?.strategy||"No specific strategy guide.",helperPersona:r?.settings?.helper,instructions:`Fill the following deck slots: ${JSON.stringify(Ye)}.`,deckRequirements:Ye,candidates:le.slice(0,3500),currentContext:Array.from(ge),neededCount:ze,experienceLevel:"Advanced"},Fe=["Consulting the archives...","Analysing mana curves...","Simulating 10,000 games...","Checking for infinite combos...","Optimizing synergy lines...","Reviewing EDHRec data...","Considering card advantage engines...","Balancing interaction package...","Calculating probability of turn 3 win...","Searching for hidden gems...","Double-checking rule 0...","Consulting the Oracle...","Gathering arcane wisdom...","Tapping into the leyline..."];let qe=0;for(;qe<2;){let nt;try{U(`Consulting ${L} for Holistic Analysis (Need ${ze} cards from ${le.length} candidates)...`),nt=setInterval(()=>{const mt=Fe[Math.floor(Math.random()*Fe.length)];x(`${L}: ${mt}`)},2500),x(`Consulting ${L}...`),await K(1500);const kt=await _s.generateDeckSuggestions(r.settings.geminiApiKey,Ie);if(clearInterval(nt),kt?.suggestions){kt.suggestions.forEach(mt=>{const Re=le.find(it=>it.firestoreId===mt.firestoreId);if(Re){const it=u.find(Et=>Et.id===mt.firestoreId),jt=mt.firestoreId,yt=mt.role||"Synergy / Strategy";oe[jt]={...mt,firestoreId:jt,name:it?.name||Re.name,type_line:it?.data?.type_line||Re.type_line,data:it?.data||it,rating:mt.rating,reason:mt.reason,suggestedType:yt},Ee.add(jt)}}),U(`${L} provided ${kt.suggestions.length} suggestions across all roles.`);break}}catch(kt){nt&&clearInterval(nt),console.error(kt),U(`Error: ${kt.message}. Retrying...`),qe++,await K(2e3)}}const Xe=l.filter(nt=>(nt.data?.type_line||nt.type_line||"").includes("Land")).length,He=Object.values(oe).filter(nt=>nt.suggestedType==="Land").length,ut=Xe+He,Tt=ke.Land||36,Ut=Math.max(0,Tt-ut);if(Ut>0){U(`Calculating mana base for ${Ut} remaining land slots...`);const nt=V(l,oe),kt=X(Ut,nt,u);Object.assign(oe,kt),Object.keys(kt).forEach(mt=>Ee.add(mt)),U(`Added ${Object.keys(kt).length} Basic Lands to balance mana curve.`)}T(oe),I(Ee),U("Architecture complete. Proceeding to Architect view."),p(Ro.ARCHITECT)}catch(de){console.error(de),i("Architecture failed. Please check your AI key.","error")}finally{k(!1),x("Ready.")}},F=()=>{(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&p(Ro.ARCHITECT)},Y=de=>{const ve=new Set(A);ve.has(de)?ve.delete(de):ve.add(de),I(ve)},ne=()=>s.jsxs("div",{className:"max-w-4xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"inline-block p-4 rounded-3xl bg-indigo-500/10 border border-indigo-500/20 mb-4 animate-bounce",children:s.jsx("span",{className:"text-4xl",children:""})}),s.jsxs("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase italic",children:[L," Deck Architect"]}),s.jsxs("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:[L," will analyze your collection and current deck composition to architect the perfect additions for ",s.jsx("span",{className:"text-indigo-400 font-bold",children:a?.name}),"."]})]}),s.jsxs("div",{className:"bg-gray-900/40 backdrop-blur-xl rounded-3xl border border-white/10 p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),s.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Builder Configuration"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Candidate Pool"}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Owned Cards Only"}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"Hide wishlist items"})]}),s.jsx("div",{onClick:()=>C(de=>({...de,ownedOnly:!de.ownedOnly})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${B.ownedOnly?"bg-indigo-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${B.ownedOnly?"translate-x-6":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-950/30 rounded-xl border border-white/5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-bold text-gray-200",children:"Exclude Assigned"}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"Skip cards in other decks"})]}),s.jsx("div",{onClick:()=>C(de=>({...de,excludeAssigned:!de.excludeAssigned})),className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors ${B.excludeAssigned?"bg-indigo-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white shadow-sm transition-transform ${B.excludeAssigned?"translate-x-6":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("label",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"Set Priority"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"restrictSet",checked:B.restrictSet,onChange:de=>C(ve=>({...ve,restrictSet:de.target.checked})),className:"rounded bg-gray-800 border-gray-700 text-indigo-500 focus:ring-indigo-500 focus:ring-offset-gray-900"}),s.jsx("label",{htmlFor:"restrictSet",className:"text-xs text-indigo-300 font-bold cursor-pointer select-none",children:"Restrict to Set"})]})]}),s.jsx("input",{type:"text",disabled:!B.restrictSet,value:B.setName,onChange:de=>C(ve=>({...ve,setName:de.target.value})),placeholder:"e.g. Avatar, KTK, Khans...",className:`w-full bg-gray-950/50 border rounded-xl px-4 py-2.5 text-sm transition-all focus:ring-2 focus:ring-indigo-500/50 outline-none ${B.restrictSet?"border-indigo-500/30 text-white placeholder-gray-600":"border-white/5 text-gray-600 cursor-not-allowed"}`}),B.restrictSet&&s.jsxs("p",{className:"text-[10px] text-yellow-500/80 font-medium animate-fade-in",children:[' Only cards matching "',B.setName,'" will be suggested.']})]})]})]}),s.jsxs("div",{className:"bg-gray-950/40 backdrop-blur-3xl rounded-[2.5rem] border border-white/10 overflow-hidden shadow-2xl",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 bg-white/5 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${w?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500",children:m})]}),s.jsxs("div",{className:"flex gap-4",children:[(n?.uid==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3"||r?.firestore_id==="Kyrlwz6G6NWICCEPYbXtFfyLzWI3")&&s.jsx("button",{onClick:F,className:"bg-amber-600/20 hover:bg-amber-600/40 text-amber-500 font-black px-6 py-3 rounded-2xl transition-all uppercase tracking-widest text-[10px] border border-amber-500/20",children:"Quick Skip (Dev)"}),!w&&s.jsx("button",{onClick:G,className:"bg-indigo-600 hover:bg-indigo-500 text-white font-black px-8 py-3 rounded-2xl transition-all shadow-lg shadow-indigo-500/20 uppercase tracking-widest text-xs border border-white/10",children:"Start Architecture"})]})]}),s.jsxs("div",{className:"p-8 h-[400px] overflow-y-auto font-mono text-xs space-y-3 custom-scrollbar bg-black/40 backdrop-blur-inner shadow-inner box-shadow-inner border-t border-white/5 font-medium leading-relaxed",children:[b.length===0?s.jsx("div",{className:"text-gray-600 italic animate-pulse",children:"Waiting for architecture to start..."}):b.map((de,ve)=>s.jsx("div",{className:"text-gray-300 animate-fade-in pl-4 border-l-2 border-indigo-500/40 py-1 hover:bg-white/5 transition-colors rounded-r",children:de},ve)),s.jsx("div",{ref:$})]})]})]}),re=()=>{const de=Object.values(_).filter(te=>O==="All"||te.suggestedType===O),ve=["All","Land","Mana Ramp","Card Draw","Targeted Removal","Board Wipes","Synergy / Strategy"];return s.jsxs("div",{className:"h-full flex flex-col gap-6 py-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-6 px-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:"Selection Phase"}),s.jsxs("p",{className:"text-gray-500 text-sm font-medium",children:["Review ",L,"'s suggestions and select the ones you want to draft into your deck."]})]}),s.jsx("div",{className:"flex items-center gap-3 bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md",children:[{mode:"grid",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{mode:"table",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"list",icon:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}].map(({mode:te,icon:ge})=>s.jsx("button",{onClick:()=>R(te),className:`p-2 rounded-xl transition-all ${E===te?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,title:`${te.charAt(0).toUpperCase()+te.slice(1)} View`,children:ge},te))})]}),s.jsx("div",{className:"flex bg-gray-950/50 p-1.5 rounded-2xl border border-white/5 backdrop-blur-md overflow-x-auto no-scrollbar mx-4",children:ve.map(te=>{const ge=Object.values(_).filter(ke=>te==="All"||ke.suggestedType===te).length;return te!=="All"&&ge===0?null:s.jsxs("button",{onClick:()=>M(te),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${O===te?"bg-indigo-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[te," ",s.jsx("span",{className:"ml-1 opacity-40 font-mono",children:ge})]},te)})}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 custom-scrollbar",children:[E==="list"&&s.jsx("div",{className:"space-y-4",children:de.map(te=>s.jsxs("div",{onClick:()=>Y(te.firestoreId),className:`grid grid-cols-[auto_1fr_auto_auto] gap-8 items-center p-6 rounded-[2rem] border transition-all cursor-pointer group ${A.has(te.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${A.has(te.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10 group-hover:border-white/30"}`,children:A.has(te.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"block text-xl font-black text-white uppercase italic tracking-tight group-hover:text-indigo-300 transition-colors",children:te.name}),s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.2em] uppercase",children:te.type_line})]}),s.jsxs("div",{className:"text-center font-mono text-indigo-400 font-bold bg-white/5 px-4 py-2 rounded-2xl border border-white/5",children:[te.rating,"/10"]}),s.jsxs("div",{className:"max-w-md bg-black/30 p-4 rounded-2xl border border-white/5 text-sm text-gray-400 font-medium italic leading-relaxed",children:['"',te.reason,'"']})]},te.firestoreId))}),E==="grid"&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-6",children:de.map(te=>s.jsxs("div",{onClick:()=>Y(te.firestoreId),className:`flex flex-col rounded-[2rem] border transition-all cursor-pointer group overflow-hidden ${A.has(te.firestoreId)?"bg-indigo-500/10 border-indigo-500/40 shadow-2xl":"bg-gray-950/30 border-white/5 hover:border-white/20"}`,children:[s.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden",children:[s.jsx("img",{src:te.data?.image_uris?.normal||`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(te.name)}&format=image`,alt:te.name,className:"w-full h-full object-cover transition-transform group-hover:scale-110",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent opacity-60"}),s.jsx("div",{className:`absolute top-4 right-4 w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all ${A.has(te.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"bg-black/40 border-white/20 group-hover:border-white/40"}`,children:A.has(te.firestoreId)&&s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[s.jsx("span",{className:"block text-lg font-black text-white uppercase italic tracking-tight line-clamp-1",children:te.name}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-300 tracking-[0.2em] uppercase truncate max-w-[70%]",children:te.type_line}),s.jsxs("span",{className:"text-xs font-mono text-indigo-400 font-bold bg-black/60 px-2 py-0.5 rounded-lg border border-white/10",children:[te.rating,"/10"]})]})]})]}),s.jsx("div",{className:"p-4 flex-1 flex flex-col justify-between",children:s.jsxs("div",{className:"text-xs text-gray-400 font-medium italic leading-relaxed line-clamp-3",children:['"',te.reason,'"']})})]},te.firestoreId))}),E==="table"&&s.jsx("div",{className:"bg-gray-950/30 rounded-[2rem] border border-white/5 overflow-hidden",children:s.jsxs("table",{className:"w-full text-left",children:[s.jsx("thead",{className:"bg-white/5 font-black text-[10px] uppercase tracking-[0.2em] text-gray-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 w-16",children:"Select"}),s.jsx("th",{className:"px-6 py-4",children:"Card Name"}),s.jsx("th",{className:"px-6 py-4",children:"Type"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"Rating"}),s.jsx("th",{className:"px-6 py-4",children:"Reasoning"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:de.map(te=>s.jsxs("tr",{onClick:()=>Y(te.firestoreId),className:`hover:bg-white/5 cursor-pointer transition-colors ${A.has(te.firestoreId)?"bg-indigo-500/5":""}`,children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${A.has(te.firestoreId)?"bg-indigo-500 border-indigo-400 text-white":"border-white/10"}`,children:A.has(te.firestoreId)&&s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"font-bold text-white uppercase italic tracking-tight",children:te.name})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-[10px] font-black text-indigo-400 tracking-[0.1em] uppercase",children:te.type_line})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"font-mono text-indigo-400 font-bold bg-white/5 px-3 py-1 rounded-lg border border-white/5",children:te.rating})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-xs text-gray-400 italic line-clamp-1",children:['"',te.reason,'"']})})]},te.firestoreId))})]})})]}),s.jsxs("div",{className:"p-8 bg-gray-950/40 backdrop-blur-3xl rounded-3xl border border-white/10 flex justify-between items-center shadow-2xl mx-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.4em]",children:"Draft Progress"}),s.jsxs("span",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:[A.size," Cards Selected"]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>p(Ro.ANALYSIS),className:"px-8 py-3.5 bg-white/5 hover:bg-white/10 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-[11px] transition-all",children:"Re-Analyze"}),s.jsx("button",{onClick:()=>p(Ro.DEPLOY),className:"px-10 py-3.5 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-xl shadow-indigo-500/20 uppercase tracking-widest text-[11px] border border-white/10 transition-all",children:"Review & Deploy"})]})]})]})},ue=()=>{const de=Array.from(A).map(te=>_[te]),ve=async()=>{if(!w){k(!0);try{const te=[],ge=new Map;u.forEach(Ee=>{const Te=Ee.scryfall_id||Ee.data?.scryfall_id;Te&&!Ee.deck_id&&ge.set(Te,(ge.get(Te)||0)+1)});const ke=new Set(l.map(Ee=>Ee.name)),oe=new Set;for(const Ee of de){const Te=Ee.data||Ee,Ye=Te.scryfall_id||Te.id||(Ee.isVirtual?null:Ee.firestoreId),ze=Ee.type_line&&Ee.type_line.includes("Basic Land"),le=Ee.type_line&&(Ee.type_line.includes("Relentless Rats")||Ee.type_line.includes("Shadowborn Apostle")||Ee.type_line.includes("Persistent Petitioners")||Ee.type_line.includes("Nazgl")||Ee.type_line.includes("Slime Against Humanity"));if(!ze&&!le&&oe.has(Ee.name)){console.warn(`[Deploy] Skipping duplicate in batch: ${Ee.name}`);continue}if(!ze&&!le&&ke.has(Ee.name)){console.warn(`[Deploy] Skipping card already in deck: ${Ee.name}`);continue}oe.add(Ee.name);let pe=!1;if(Ye&&ge.has(Ye)){const me=ge.get(Ye);me>0&&(pe=!0,ge.set(Ye,me-1))}if(!pe&&a.is_mockup===!1&&!ze)throw new Error(`Cannot add unowned card "${Ee.name}" to a Collection Deck.`);te.push({scryfall_id:Ye,name:Ee.name||Te.name||"Unknown Card",set_code:Te.set||Te.set_code||"???",collector_number:Te.collector_number||"0",finish:"nonfoil",image_uri:Te.image_uris&&Te.image_uris.normal||Te.image_uri||null,data:Te,count:1,is_wishlist:!(pe||ze)})}await Pe.post(`/api/decks/${t}/cards/batch`,{cards:te}),i(`Successfully added ${te.length} cards to ${a.name}!`,"success"),e(`/decks/${t}`)}catch(te){console.error("Deployment failed:",te),i("Failed to deploy cards. Please try again.","error")}finally{k(!1)}}};return s.jsxs("div",{className:"max-w-5xl mx-auto space-y-12 py-12",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase",children:"Final Deployment"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"Review your selected additions before applying them to your deck."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:de.map(te=>s.jsxs("div",{className:"bg-gray-950/30 p-6 rounded-[2rem] border border-white/10 space-y-4",children:[s.jsx("span",{className:"font-black text-white uppercase italic text-lg truncate block",children:te.name}),s.jsxs("div",{className:"text-xs text-gray-400 leading-relaxed italic",children:['"',te.reason,'"']})]},te.firestoreId))}),s.jsxs("div",{className:"flex gap-6 justify-center",children:[s.jsx("button",{onClick:()=>p(Ro.ARCHITECT),className:"px-12 py-4 bg-gray-900 hover:bg-gray-800 text-white font-black rounded-2xl border border-white/5 uppercase tracking-widest text-xs transition-all",children:"Back to Architect"}),s.jsxs("button",{onClick:ve,disabled:w,className:"px-16 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-black rounded-2xl shadow-2xl shadow-indigo-500/40 uppercase tracking-widest text-xs border border-white/10 transition-all",children:['Apply to "',a?.name,'"']})]})]})};if(d)return s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-indigo-500 border-t-transparent rounded-full"})});const Le=q(a?.commander)||q(a?.commander_partner);return s.jsxs("div",{className:"min-h-screen bg-gray-950 text-gray-200 font-sans relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 transition-all duration-1000 ease-in-out",style:{backgroundImage:`url(${Le})`,backgroundSize:"cover",backgroundPosition:"center"},children:[s.jsx("div",{className:"absolute inset-0 bg-gray-950/60 backdrop-blur-[2px]"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-gray-950/80 to-gray-950/40"})]}),s.jsxs("div",{className:"sticky top-0 z-50 px-6 py-4 flex justify-between items-center bg-gray-950 border-b border-white/5",children:[s.jsxs("button",{onClick:()=>e(`/decks/${t}`),className:"text-gray-500 hover:text-white flex items-center gap-2 group transition-all",children:[s.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:"Exit Wizard"})]}),s.jsx("div",{className:"flex gap-12",children:[1,2,3].map(de=>s.jsxs("div",{className:`flex items-center gap-3 transition-all ${h===de?"scale-110":"opacity-40"}`,children:[s.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${h>=de?"bg-indigo-500 text-white":"bg-gray-800 text-gray-600"}`,children:de}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em]",children:de===1?"Analysis":de===2?"Architect":"Deploy"})]},de))}),s.jsx("div",{className:"w-32"})," "]}),s.jsxs("main",{className:"flex-1 relative z-10 px-4 max-w-7xl mx-auto w-full",children:[h===Ro.ANALYSIS&&ne(),h===Ro.ARCHITECT&&re(),h===Ro.DEPLOY&&ue()]}),s.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .animate-pulse-slow { animation: pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
                @keyframes pulse { 0%, 100% { opacity: 0.2; transform: scale(1.05); } 50% { opacity: 0.4; transform: scale(1); } }
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.4); }
            `}})]})},u5e=({onNext:t,onBack:e,currentTier:r})=>{const[n,i]=y.useState("monthly"),[a,l]=y.useState(!1),d=async u=>{l(!0),await t(u,n),l(!1)};return s.jsxs("div",{className:"max-w-7xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"space-y-4 mb-8",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50 shadow-[0_0_30px_rgba(168,85,247,0.3)]",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h2",{className:"text-4xl font-extrabold text-white",children:"Choose Your Power Level"}),s.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Unlock advanced deck building tools, unlimited storage, and AI-powered insights."})]}),s.jsx(n5,{billingInterval:n,setBillingInterval:i,onSubscribe:d,isLoading:a,currentTier:r||"free",showIntervalSelector:!0}),s.jsx("div",{className:"flex justify-center pt-8",children:e&&s.jsxs("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors flex items-center gap-2",disabled:a,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})})]})},h5e=({onNext:t})=>s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-8 animate-fade-in-up",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-indigo-500/20 rounded-full flex items-center justify-center ring-1 ring-indigo-500/50 shadow-[0_0_30px_rgba(99,102,241,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-extrabold text-white mb-4",children:"Welcome to MTG-Forge"}),s.jsxs("p",{className:"text-xl text-gray-300 leading-relaxed",children:["Your ultimate companion for deck building, collection management, and magical optimization.",s.jsx("br",{}),"Let's get everything set up in just a few clicks."]})]}),s.jsx("button",{onClick:t,className:"px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-indigo-500/25 transition-all transform hover:-translate-y-1",children:"Let's Go"})]}),f5e=({onNext:t,onBack:e})=>{const[r,n]=y.useState("");return s.jsxs("div",{className:"max-w-3xl w-full space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 mx-auto bg-purple-500/20 rounded-full flex items-center justify-center mb-6 ring-1 ring-purple-500/50",children:s.jsx("svg",{className:"w-10 h-10 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Enable AI Architect"}),s.jsx("p",{className:"text-gray-400 max-w-lg mx-auto",children:"Our AI analyzes your cards to suggest synergies, optimal mana curves, and complete deck strategies."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Automated Building"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Generate entire commander decks from a single prompt or theme using your own collection."})]}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700",children:[s.jsxs("h3",{className:"font-bold text-lg text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-green-400",children:""})," Synergy Scouting"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Find hidden gems in your binder that perfectly match your commander's strategy."})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl text-left",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Why do I need my own API Key?"}),s.jsx("p",{className:"text-sm text-blue-100/80 leading-relaxed",children:"MTG-Forge connects directly to Google's Gemini AI to power its deck architect features. To ensure usage, privacy, and zero rampingsubscription fees, we ask users to provide their own free API key. Your key is stored locally on your device and is never shared with us."}),s.jsxs("div",{className:"mt-4 p-3 bg-indigo-900/40 border border-indigo-500/30 rounded-lg",children:[s.jsxs("h4",{className:"font-bold text-indigo-200 mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-amber-400",children:""})," AI is Experimental"]}),s.jsxs("p",{className:"text-sm text-gray-300",children:["Our AI Architect is a powerful assistant, but ",s.jsx("strong",{children:"YOU"})," are the true deck builder. AI can suggest amazing synergies, but it can also make mistakes or suggest suboptimal cards. Always review and refine the suggestions to match your personal playstyle and meta."]})]})]})]})}),s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700 space-y-4 text-left",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Enter your Gemini API Key"}),s.jsx("input",{type:"password",value:r,onChange:i=>n(i.target.value),placeholder:"AIzaSy...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors"}),s.jsxs("div",{className:"text-sm text-gray-400",children:["Don't have a key? ",s.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:text-purple-300 underline",children:"Get a free key from Google AI Studio "})]})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 pt-4",children:[e&&s.jsx("button",{onClick:e,className:"nav-button px-10 py-3 rounded-lg font-bold transition-all border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-800/50",children:"Back"}),s.jsx("button",{onClick:()=>t(r),disabled:!r,className:`nav-button px-10 py-3 rounded-lg font-bold transition-all shadow-lg transform hover:-translate-y-0.5 ${r?"bg-purple-600 hover:bg-purple-500 text-white hover:shadow-purple-500/25":"bg-gray-700 text-gray-400 cursor-not-allowed shadow-none"}`,children:"Save & Enable AI"}),s.jsx("button",{onClick:()=>t(null),className:"text-gray-500 text-sm hover:text-gray-300 underline transition-colors",children:"Skip (Features Disabled)"})]})]})},p5e=({onNext:t,onBack:e})=>{const[r,n]=Ge.useState(0),[i,a]=Ge.useState(!1),l=[{title:"Manage Your Collection",desc:"Import cards, track values, and organize your entire library in one place.",details:["Navigate to the 'Collection' page via the top navigation bar.","Click the 'Add Cards' button to bulk add cards from CSV, text, or card scanner.","Use the 'Binder' view to visually organize your cards by Set, Color, or Rarity.","More organizational features coming soon, as in folders and custom groupings."],icon:s.jsx("svg",{className:"w-16 h-16 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{title:"Build & Analyze Decks",desc:"Use the Architect Wizard to construct powerful decks with real-time stats and mana analysis.",details:["Go to 'Decks' and click 'Create New Deck'.","Choose your format: 'Commander' or 'Standard'.","Select a Commander or Spotlight Card to anchor your strategy.","Use the 'AI Architect' to generate suggested cards based on your themes.","Review mana curves, color distribution, and type breakdowns in the 'Stats' tab."],icon:s.jsx("svg",{className:"w-16 h-16 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{title:"Wishlist & Tracking",desc:"Keep track of cards you need and plan your next purchases directly from deck builds.",details:["Search for any card in the database, even ones you don't own.","Click the 'Heart' icon to add it to your Wishlist.","When building decks, enable 'Theorycraft Mode' to include wishlist cards.","View your shopping list in the 'Wishlist' tab of your Collection."],icon:s.jsx("svg",{className:"w-16 h-16 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}],d=l[r],u=()=>{r<l.length-1?(n(r+1),a(!1)):t()};return s.jsxs("div",{className:"max-w-2xl w-full text-center space-y-10 animate-fade-in relative",children:[s.jsxs("div",{className:"h-80 flex flex-col items-center justify-center bg-gray-800/30 rounded-2xl border border-gray-700/50 p-8 relative overflow-hidden group",children:[s.jsxs("div",{className:`absolute inset-0 bg-gray-900/95 backdrop-blur-md z-20 flex flex-col items-center justify-center p-8 transition-all duration-300 ${i?"opacity-100 translate-y-0":"opacity-0 translate-y-full pointer-events-none"}`,children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx("span",{children:""})," How it Works"]}),s.jsx("ul",{className:"space-y-4 text-left w-full max-w-md",children:d.details.map((h,p)=>s.jsxs("li",{className:"flex gap-3 text-gray-300 text-sm",children:[s.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-indigo-500/20 text-indigo-400 flex items-center justify-center font-bold text-xs border border-indigo-500/30",children:p+1}),s.jsx("span",{className:"leading-relaxed",children:h})]},p))}),s.jsx("button",{onClick:()=>a(!1),className:"mt-8 text-sm text-gray-500 hover:text-white underline",children:"Close Details"})]}),s.jsxs("div",{className:"animate-fade-in-up flex flex-col items-center",children:[s.jsx("div",{className:"mb-6 opacity-90 transform group-hover:scale-110 transition-transform duration-500",children:d.icon}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:d.title}),s.jsx("p",{className:"text-lg text-gray-400 max-w-md mb-6",children:d.desc}),s.jsxs("button",{onClick:()=>a(!0),className:"text-sm font-bold text-indigo-400 hover:text-indigo-300 flex items-center gap-1 transition-colors px-4 py-2 rounded-lg hover:bg-indigo-500/10",children:[s.jsx("span",{children:"View Walkthrough"}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]},r)]}),s.jsxs("div",{className:"flex flex-col items-center gap-6",children:[s.jsx("div",{className:"flex gap-2",children:l.map((h,p)=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${p===r?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},p))}),s.jsxs("div",{className:"flex gap-4 w-full sm:w-auto",children:[e&&s.jsx("button",{onClick:()=>{r>0?(n(r-1),a(!1)):e()},className:"px-6 py-3 bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white rounded-lg font-bold transition-colors w-full sm:w-auto",children:"Back"}),s.jsx("button",{onClick:u,className:"px-10 py-3 bg-white text-gray-900 hover:bg-gray-100 rounded-lg font-bold transition-colors w-full sm:w-auto",children:r===l.length-1?"Finish Setup":"Next Feature"})]})]})]})},m5e=({onNext:t,onBack:e})=>{const{userProfile:r}=Mt(),[n,i]=y.useState("selection"),[a,l]=y.useState({name:"",type:"",personality:""}),[d,u]=y.useState([]),[h,p]=y.useState(""),[m,x]=y.useState(!1),b=y.useRef(null),v={name:"Oracle",type:"Mystic Construct",personality:"Wise, Efficient, Slightly Mystical"};y.useEffect(()=>{b.current?.scrollIntoView({behavior:"smooth"})},[d]);const w=()=>{t(v)},k=async()=>{i("forge"),x(!0),u([{role:"model",content:"Booting Forge System... I am the construct builder. Let's create your companion. First, does your helper have a name, or shall we define their personality first?"}]),x(!1)},_=async()=>{if(!h.trim())return;const I={role:"user",content:h},O=[...d,I];u(O),p(""),x(!0);try{const M=r?.settings?.geminiApiKey;if(!M)throw new Error("API Key missing.");const E=await _s.forgeHelperChat(M,O,a);l(R=>({...R,...E.updatedDraft})),u(R=>[...R,{role:"model",content:E.aiResponse}])}catch(M){console.error("Forge Error:",M),u(E=>[...E,{role:"model",content:"System Glitch. Please repeat."}])}finally{x(!1)}},T=()=>{const I={name:a.name||"Companion",type:a.type||"Construct",personality:a.personality||"Helpful"};t(I)},A=I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),_())};return s.jsxs("div",{className:"w-full max-w-5xl animate-fade-in mx-auto",children:[n==="selection"&&s.jsxs("div",{className:"text-center space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-amber-500/20 rounded-full flex items-center justify-center ring-1 ring-amber-500/50 shadow-[0_0_30px_rgba(245,158,11,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Forge Your Helper"}),s.jsx("p",{className:"text-gray-300 max-w-2xl mx-auto",children:'Who will guide you through the multiverse? You can use our standard "Oracle" construct, or forge a completely custom AI companion with its own name and personality.'})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto",children:[e&&s.jsx("button",{onClick:e,className:"col-span-1 md:col-span-2 mx-auto text-gray-500 hover:text-white mb-2 underline",children:" Go Back"}),s.jsxs("button",{onClick:w,className:"p-6 bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-gray-500 rounded-xl transition-all group text-left",children:[s.jsx("div",{className:"text-xl font-bold text-white mb-2 group-hover:text-amber-400",children:"Default: The Oracle"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"A wise, mystical construct focused on efficient and accurate advice."}),s.jsx("span",{className:"text-xs font-bold uppercase text-gray-500 group-hover:text-white tracking-wider",children:"Select Oracle "})]}),s.jsxs("button",{onClick:()=>{Yt(r?.subscription_tier).features.customAiPersona&&k()},disabled:!Yt(r?.subscription_tier).features.customAiPersona,className:`p-6 border rounded-xl transition-all group text-left relative overflow-hidden ${Yt(r?.subscription_tier).features.customAiPersona?"bg-amber-900/20 hover:bg-amber-900/30 border-amber-500/30 hover:border-amber-500 cursor-pointer":"bg-gray-800/50 border-gray-700 opacity-50 cursor-not-allowed"}`,children:[s.jsx("div",{className:`absolute top-0 right-0 p-2 ${Yt(r?.subscription_tier).features.customAiPersona?"opacity-50":"opacity-20"}`,children:s.jsx("svg",{className:`w-16 h-16 ${Yt(r?.subscription_tier).features.customAiPersona?"text-amber-500":"text-gray-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:`text-xl font-bold mb-2 ${Yt(r?.subscription_tier).features.customAiPersona?"text-white group-hover:text-amber-400":"text-gray-400"}`,children:"Forge Custom Helper"}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Create a unique companion. Define their name, species, and personality via chat."}),s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${Yt(r?.subscription_tier).features.customAiPersona?"text-amber-500 group-hover:text-white":"text-gray-600"}`,children:Yt(r?.subscription_tier).features.customAiPersona?"Start Forging ":"Requires Wizard Tier"})]})]})]})]}),n==="forge"&&s.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border border-gray-700 rounded-2xl overflow-hidden bg-gray-900",children:[s.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-800",children:[s.jsx("div",{className:"p-4 border-b border-gray-800 bg-gray-800/50 flex justify-between items-center",children:s.jsx("span",{className:"font-mono text-amber-400 text-sm",children:"SYSTEM: FORGE PROTOCOL ENGAGED"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[d.map((I,O)=>s.jsx("div",{className:`flex ${I.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] p-3 rounded-lg text-sm ${I.role==="user"?"bg-amber-600 text-white":"bg-gray-800 text-gray-300"}`,children:I.content})},O)),m&&s.jsx("div",{className:"text-gray-500 text-xs animate-pulse ml-2",children:" Processing..."}),s.jsx("div",{ref:b})]}),s.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:h,onChange:I=>p(I.target.value),onKeyDown:A,placeholder:"Ex: Name him 'Gobbo', make him a goblin...",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-amber-500 focus:outline-none",disabled:m}),s.jsx("button",{onClick:_,disabled:m||!h.trim(),className:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold",children:"Send"})]})})]}),s.jsxs("div",{className:"w-full md:w-80 bg-gray-950 p-6 flex flex-col",children:[s.jsx("h3",{className:"text-gray-400 font-bold uppercase tracking-wider text-xs mb-6",children:"Blueprint Status"}),s.jsxs("div",{className:"space-y-6 flex-1",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"DESIGNATION (NAME)"}),s.jsx("div",{className:`text-lg font-bold ${a.name?"text-amber-400":"text-gray-700 italic"}`,children:a.name||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"CLASSIFICATION (TYPE)"}),s.jsx("div",{className:`text-sm font-medium ${a.type?"text-white":"text-gray-700 italic"}`,children:a.type||"Undefined"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"PARAMETERS (PERSONALITY)"}),s.jsx("div",{className:`text-sm font-medium ${a.personality?"text-white":"text-gray-700 italic"}`,children:a.personality||"Undefined"})]})]}),s.jsx("button",{onClick:T,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg shadow-lg hover:shadow-green-500/20 transition-all mt-4",children:"Complete Forge Protocol"})]})]})]})},g5e=()=>{const t=on(),[e,r]=n4(),{userProfile:n,updateSettings:i,refreshUserProfile:a}=Mt(),[l,d]=y.useState(n?.settings?.onboarding_step||0),[u,h]=y.useState(!1),[p,m]=y.useState(null),[x,b]=y.useState([null,null,null,null]),[v,w]=y.useState(1),[k,_]=y.useState(!1);y.useEffect(()=>{e.get("success")==="true"&&l<=1&&(async()=>{try{await Pe.post("/api/payments/sync-subscription"),await a()}catch(W){console.error("Sync failed",W)}await i({subscription_status:"active",onboarding_step:2}),d(2),r({})})()},[e,l,i,r]);const T=[{id:"deckbuilder",name:"The Deckbuilder",description:"Optimized for brewing and gameplay. Find specific effects and colors instantly.",features:["Sort by Color Identity & Type","Group by Card Color","Best for: Commander players","Fastest to find game pieces"],icon:"",sort:["color_identity","type","cmc","name"],grouping:"color"},{id:"collector",name:"The Collector",description:"Traditional binder organization. Perfect for tracking set completion and variants.",features:["Sort by Set & Collector Number","Group by Expansion Set","Best for: Set completists","Matches physical binder layouts"],icon:"",sort:["set","collector_number","name"],grouping:"set"},{id:"hybrid",name:"The Hybrid",description:"The best of both. Keep your bulk in boxes and your staples in binders.",features:["Bulk sorted by Set (Boxes)","Smart Binders for Rares/Foils","Best for: Large collections","Separates value from bulk"],icon:"",sort:["set","collector_number"],grouping:"set",hasSmartBinders:!0},{id:"advanced",name:"Advanced",description:"Complete control. Define your own sorting and priority hierarchy.",features:["Custom Sort Logic (Max 4 layers)","User-defined Grouping","Best for: Specific needs","Full granularity control"],icon:"",sort:[],grouping:"custom"}],A=async()=>{const q=l+1;d(q),await i({onboarding_step:q})},I=async()=>{const q=Math.max(0,l-1);d(q),await i({onboarding_step:q})},O=async q=>{const K=l+1;d(K),await i({helper:q,onboarding_step:K})},M=async(q,K)=>{if(q===tt.FREE||q==="free"){const W=l+1;d(W),await i({subscription_tier:"free",onboarding_step:W});return}try{const W=await Pe.post("/api/payments/create-checkout-session",{tierId:q,interval:K,successUrl:`${window.location.origin}/onboarding?success=true`,cancelUrl:`${window.location.origin}/onboarding?canceled=true`});W.url&&(window.location.href=W.url)}catch(W){console.error("Subscription error:",W),alert("Failed to start checkout. Please try again.")}},E=async q=>{const K=l+1;d(K),await i({ai_enabled:!!q,geminiApiKey:q||void 0,onboarding_step:K})},R=async(q,K,W)=>{_(!0);try{const V={organization:{mode:q.id,sortHierarchy:K.filter(Boolean),groupingPreference:W}};await i(V);const X=l+1;d(X),await i({onboarding_step:X})}catch(V){console.error(V)}finally{_(!1)}},$=()=>{if(!p)return;let q=p.sort,K=p.grouping;if(p.id==="advanced"&&(q=x,q.filter(Boolean).length>0)){const W=q.filter(Boolean)[0];["color","color_identity"].includes(W)?K="color":["set","release"].includes(W)?K="set":["type"].includes(W)?K="type":["rarity"].includes(W)&&(K="rarity")}R(p,q,K)},B=()=>{h(!0)},C=async q=>{const K=l+1;d(K),await i({playstyle:q,onboarding_step:K}),await a(),h(!1)},U=async()=>{const q=l+1;d(q),await i({onboarding_step:q})},L=async()=>{await i({onboarding_complete:!0,onboarding_step:7}),t("/dashboard")};return s.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx("img",{src:"/MTG-Forge_Logo_Background_80.png",alt:"Background",className:"w-full h-full object-cover opacity-30"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900/90 to-black/80"})]}),s.jsxs("div",{className:"relative z-10 flex-grow flex items-center justify-center p-4",children:[l===0&&s.jsx(h5e,{onNext:A}),l===1&&s.jsx(u5e,{onNext:M,onBack:I,currentTier:n?.subscription_tier}),l===2&&s.jsx(f5e,{onNext:E,onBack:I}),l===3&&s.jsxs("div",{className:"text-center max-w-6xl animate-fade-in-up w-full",children:[v===1&&s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Organize Your Collection"}),s.jsx("p",{className:"text-gray-400 mb-8",children:"How do you want to sort and view your cards?"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 max-w-5xl mx-auto items-stretch",children:T.map(q=>s.jsxs("button",{onClick:()=>{m(q),q.id==="advanced"?w(1.5):q.id==="hybrid"?w(2):R(q,q.sort,q.grouping)},disabled:k,className:"group relative bg-gray-800/50 hover:bg-gray-800 border-2 border-transparent hover:border-indigo-500 rounded-2xl p-6 text-left transition-all hover:-translate-y-1 hover:shadow-xl disabled:opacity-50 flex flex-col h-full",children:[s.jsx("div",{className:"text-3xl mb-3 group-hover:scale-110 transition-transform",children:q.icon}),s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:q.name}),s.jsx("p",{className:"text-xs text-gray-300 mb-3 h-8",children:q.description}),s.jsx("ul",{className:"text-[10px] text-gray-400 space-y-1.5 mt-auto pt-4 border-t border-gray-700/50",children:q.features.map((K,W)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-500",children:""}),K]},W))})]},q.id))}),s.jsx("div",{className:"mt-8",children:s.jsx("button",{onClick:I,className:"text-gray-500 hover:text-white",children:"Back"})})]}),v===1.5&&s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Custom Hierarchy"}),s.jsx("div",{className:"space-y-3",children:[0,1,2,3].map(q=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-sm font-bold text-gray-500 border border-gray-700",children:q+1}),s.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none",value:x[q]||"",onChange:K=>{const W=[...x];W[q]=K.target.value,b(W)},children:[s.jsx("option",{value:"",children:"(None)"}),s.jsx("option",{value:"color",children:"Color"}),s.jsx("option",{value:"type",children:"Type"}),s.jsx("option",{value:"cmc",children:"Mana Value"}),s.jsx("option",{value:"set",children:"Set"}),s.jsx("option",{value:"rarity",children:"Rarity"}),s.jsx("option",{value:"name",children:"Name"}),s.jsx("option",{value:"price",children:"Price"})]})]},q))}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx("button",{onClick:()=>w(1),className:"text-gray-400 hover:text-white",children:"Back"}),s.jsx("button",{onClick:$,disabled:k,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold",children:k?"Saving...":"Save Hierarchy"})]})]}),v===2&&s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Hybrid Organization"}),s.jsx("div",{className:"p-4 bg-indigo-900/20 border border-indigo-500/30 rounded-xl",children:s.jsxs("p",{className:"text-sm text-indigo-300",children:["Your collection will be grouped by ",s.jsx("strong",{children:"Set"}),"."]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx("button",{onClick:()=>w(1),className:"text-gray-400 hover:text-white",children:"Back"}),s.jsx("button",{onClick:$,disabled:k,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-xl font-bold",children:k?"Saving...":"Finish Setup"})]})]})]}),l===4&&s.jsx(m5e,{onNext:O,onBack:I}),l===5&&s.jsxs("div",{className:"text-center max-w-2xl animate-fade-in-up space-y-8",children:[s.jsx("div",{className:"w-24 h-24 mx-auto bg-green-500/20 rounded-full flex items-center justify-center ring-1 ring-green-500/50 shadow-[0_0_30px_rgba(34,197,94,0.3)]",children:s.jsx("svg",{className:"w-12 h-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Define Your Playstyle"}),s.jsxs("p",{className:"text-gray-300",children:["Let us get to know what kind of mage you are.",s.jsx("br",{}),"We'll tailor card suggestions and deck strategies to your personal taste."]})]}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsx("button",{onClick:I,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Back"}),s.jsx("button",{onClick:B,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"Start Quiz"}),s.jsx("button",{onClick:U,className:"px-8 py-3 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-xl font-medium transition-colors border border-gray-700",children:"Skip for Now"})]})]}),l===6&&s.jsx(p5e,{onNext:L,onBack:I})]}),s.jsx("div",{className:"relative z-10 py-8 flex justify-center gap-3",children:[0,1,2,3,4,5,6].map(q=>s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${q===l?"w-8 bg-indigo-500":"w-2 bg-gray-700"}`},q))}),s.jsx(_P,{isOpen:u,onClose:()=>h(!1),onComplete:C})]})},x5e=()=>s.jsxs("div",{className:"min-h-screen bg-gray-900 pb-20",children:[s.jsxs("div",{className:"relative py-20 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-900/10"}),s.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto px-6 text-center",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white mb-6 tracking-tight",children:"About The Forge"}),s.jsx("p",{className:"text-xl text-gray-400 leading-relaxed",children:"Built by players, for players. The Forge is designed to be the ultimate companion for Magic: The Gathering deck building and collection management."})]})]}),s.jsxs("div",{className:"max-w-4xl mx-auto px-6 space-y-16",children:[s.jsxs("section",{className:"space-y-6 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-amber-500 rounded-full"}),"The Human Factor"]}),s.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-3xl border border-amber-500/10 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 pointer-events-none",children:s.jsx("svg",{className:"w-64 h-64 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"AI is a Tool, Not a Replacement"}),s.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[s.jsx("p",{children:"At The Forge, we believe AI can be an incredible creative partner. It can scan thousands of cards in seconds, find obscure combos, and suggest perfectly curved land bases."}),s.jsxs("p",{children:[s.jsx("strong",{className:"text-amber-400",children:"However, AI is still a work in progress."}),' It can hallucinate interactions, suggest banned cards, or miss the subtle "fun factor" that makes a Commander deck truly special.']}),s.jsx("p",{children:"We built these tools to get you 80% of the way there. The final 20%the soul of the deckcomes from you. Use our suggestions as a starting point, but trust your intuition and knowledge to build something truly unique."})]})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-indigo-500 rounded-full"}),"Powered By"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("a",{href:"https://scryfall.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-indigo-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Scryfall"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"The best MTG card database in the world. All card data and imagery is provided by their incredible API."})]}),s.jsxs("a",{href:"https://tcgplayer.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-green-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-green-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"TCGPlayer"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Real-time pricing data for card values. Keeping your collection valuation accurate and up to date."})]}),s.jsxs("a",{href:"https://magic.wizards.com",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-orange-500 hover:bg-gray-800 transition-all group",children:[s.jsx("div",{className:"text-orange-400 mb-4 group-hover:scale-110 transition-transform origin-left",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Wizards of the Coast"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Creators of Magic: The Gathering. All mana symbols, card names, and art are copyright WotC."})]})]})]}),s.jsxs("section",{className:"space-y-8 animate-fade-in-up delay-100",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[s.jsx("span",{className:"w-8 h-1 bg-purple-500 rounded-full"}),"Get in Touch"]}),s.jsx("div",{className:"bg-gradient-to-br from-indigo-900/20 to-purple-900/20 p-8 rounded-3xl border border-white/5 relative overflow-hidden",children:s.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[s.jsxs("div",{className:"space-y-4 text-center md:text-left",children:[s.jsx("h3",{className:"text-2xl font-bold text-white",children:"Join the Community"}),s.jsx("p",{className:"text-gray-400 max-w-md",children:"Have a feature request? Found a bug? Or just want to show off your latest brew? Come chat with us on Discord."})]}),s.jsxs("a",{href:"https://discord.gg/your-discord-link",target:"_blank",rel:"noopener noreferrer",className:"px-8 py-4 bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-indigo-500/25 flex items-center gap-3 transform hover:-translate-y-1",children:[s.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.956 2.419-2.157 2.419zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.419 0 1.334-.946 2.419-2.157 2.419z"})}),"Join Discord"]})]})})]}),s.jsx("div",{className:"text-center text-gray-600 text-xs pt-20",children:s.jsx("p",{children:"The Forge is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. Wizards of the Coast LLC."})})]})]}),kf=[{badge:"White",colors:["W"],theme:"Absolute Order",flavor_text:"A single spark of light can banish a world of shadows."},{badge:"Blue",colors:["U"],theme:"Infinite Inquiry",flavor_text:"The mind is the only battlefield where victory is absolute."},{badge:"Black",colors:["B"],theme:"Unrestricted Power",flavor_text:"Power at any cost, for greatness is written in blood."},{badge:"Red",colors:["R"],theme:"Chaotic Passion",flavor_text:"Do not fear the fire; fear the heart that commands it."},{badge:"Green",colors:["G"],theme:"Primal Growth",flavor_text:"The forest does not ask for permission to grow."},{badge:"Azorius",colors:["W","U"],theme:"Bureaucratic Control",flavor_text:"Justice is blind, but she has a very long reach."},{badge:"Dimir",colors:["U","B"],theme:"Subterfuge & Infiltration",flavor_text:"The finest secrets are those that kill the ones who keep them."},{badge:"Rakdos",colors:["B","R"],theme:"Carnival of Carnage",flavor_text:"Entertain us, or become the entertainment."},{badge:"Gruul",colors:["R","G"],theme:"Primal Destruction",flavor_text:"Not for city-dwellers. Not for the weak. Only for the weak."},{badge:"Selesnya",colors:["G","W"],theme:"Collective Harmony",flavor_text:"One voice is a whisper; the Conclave is a roar."},{badge:"Orzhov",colors:["W","B"],theme:"Indentured Eternity",flavor_text:"Even death is no excuse for a breach of contract."},{badge:"Izzet",colors:["U","R"],theme:"Volatile Genius",flavor_text:"If it doesnt explode, you aren't trying hard enough."},{badge:"Golgari",colors:["B","G"],theme:"Cycles of Rot",flavor_text:"Every grave is a garden if you wait long enough."},{badge:"Boros",colors:["R","W"],theme:"Tactical Aggression",flavor_text:"First to the fight, last to the fall."},{badge:"Simic",colors:["G","U"],theme:"Biological Evolution",flavor_text:"Nature is a rough draft; we are the final edit."},{badge:"Esper",colors:["W","U","B"],theme:"Obsidian Logic",flavor_text:"Perfection is not a goal; it is a requirement."},{badge:"Grixis",colors:["U","B","R"],theme:"Ruthless Tyranny",flavor_text:"A wasteland of power where only the cruelest thrive."},{badge:"Jund",colors:["B","R","G"],theme:"Apex Predation",flavor_text:"In this world, you are either the dragon or the meal."},{badge:"Naya",colors:["R","G","W"],theme:"Primal Majesty",flavor_text:"Where the mountains wake and the earth trembles."},{badge:"Bant",colors:["G","W","U"],theme:"Knightly Order",flavor_text:"The sigil of the sun protects those who stand together."},{badge:"Abzan",colors:["W","B","G"],theme:"Eternal Endurance",flavor_text:"We do not break; we simply outlast."},{badge:"Jeskai",colors:["U","R","W"],theme:"Disciplined Spark",flavor_text:"The wind carries the strike; the mind guides the bolt."},{badge:"Sultai",colors:["B","G","U"],theme:"Opulent Decay",flavor_text:"Power is measured in gold and the bones of the fallen."},{badge:"Mardu",colors:["R","W","B"],theme:"Relentless Conquest",flavor_text:"Victory is the only law worth following."},{badge:"Temur",colors:["G","U","R"],theme:"Elemental Instinct",flavor_text:"The wild does not think; it reacts with ice and fire."},{badge:"Glint-Eye",colors:["U","B","R","G"],theme:"Chaotic Adaptation",flavor_text:"Order is a cage; we have chosen to break the locks."},{badge:"Dune-Brood",colors:["W","B","R","G"],theme:"Sandless Conquest",flavor_text:"When the logic of the mind fails, the instinct of the swarm prevails."},{badge:"Ink-Treader",colors:["W","U","R","G"],theme:"Radiant Reflection",flavor_text:"To touch one is to touch the whole of the world."},{badge:"Witch-Maw",colors:["W","U","B","G"],theme:"Eldritch Growth",flavor_text:"There is a hunger beneath the earth that knows no fire."},{badge:"Yore-Tiller",colors:["W","U","B","R"],theme:"Relentless History",flavor_text:"The past is a weapon we sharpen for the future."},{badge:"WUBRG",colors:["W","U","B","R","G"],theme:"The Convergence",flavor_text:"The full spectrum of power, bound in a single hand."},{badge:"Colorless",colors:["C"],theme:"The Great Void",flavor_text:"Existence is a fleeting dream in the eyes of the silent."}],y5e=()=>{const{slug:t}=ol(),e=on(),{currentUser:r}=Mt(),{addToast:n}=_r(),[i,a]=y.useState(null),[l,d]=y.useState(!0),[u,h]=y.useState(null),[p,m]=y.useState("grid"),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[k,_]=y.useState(0);y.useEffect(()=>{(async()=>{try{const K=await Pe.get(`/api/decks/public/${t}`);a(K)}catch(K){console.error("Public deck load failed",K),h("Deck not found or private.")}finally{d(!1)}})()},[t]);const{deck:T,items:A}=i||{},I=y.useMemo(()=>{if(!T)return kf.find(X=>X.badge==="Colorless");if(T?.format?.toLowerCase()==="standard"){const X=T.colors||T.commander?.color_identity||[];return kf.find(G=>G.colors.length!==X.length?!1:G.colors.every(F=>X.includes(F)))||{badge:"Standard",theme:"Constructed",flavor_text:"A format defined by rotation and meta mastery."}}const q=T?.commander?.color_identity||[],K=T?.commander_partner?.color_identity||[],W=[...new Set([...q,...K])];return W.length===0?kf.find(X=>X.badge==="Colorless"):kf.find(X=>X.colors.length!==W.length?!1:X.colors.every(Z=>W.includes(Z)))||kf.find(X=>X.badge==="Colorless")},[T]),O=y.useMemo(()=>{if(!A)return 0;let q=A.reduce((V,X)=>V+(X.countInDeck||X.count||1),0);const K=T?.commander?.id||T?.commander?.scryfall_id,W=T?.commander_partner?.id||T?.commander_partner?.scryfall_id;return T?.commander&&!A.some(V=>(V.scryfall_id||V.id)===K)&&q++,T?.commander_partner&&!A.some(V=>(V.scryfall_id||V.id)===W)&&q++,q},[A,T]),M=y.useMemo(()=>{if(!A)return 0;let q=A.reduce((V,X)=>{const Z=parseFloat(X.prices?.[X.finish==="foil"?"usd_foil":"usd"]||X.data?.prices?.[X.finish==="foil"?"usd_foil":"usd"]||0);return V+Z*(X.countInDeck||X.count||1)},0);const K=T?.commander?.id||T?.commander?.scryfall_id,W=T?.commander_partner?.id||T?.commander_partner?.scryfall_id;if(T?.commander&&!A.some(V=>(V.scryfall_id||V.id)===K)){const V=T.commander;q+=parseFloat(V.prices?.usd||0)}if(T?.commander_partner&&!A.some(V=>(V.scryfall_id||V.id)===W)){const V=T.commander_partner;q+=parseFloat(V.prices?.usd||0)}return q},[A,T]),E=q=>{if(!A)return 0;let K=A.reduce((X,Z)=>((Z.data||Z).type_line||"").includes(q)?X+(Z.countInDeck||1):X,0);const W=T?.commander?.id||T?.commander?.scryfall_id,V=T?.commander_partner?.id||T?.commander_partner?.scryfall_id;return T?.commander&&!A.some(X=>(X.scryfall_id||X.id)===W)&&(T.commander.type_line||"").includes(q)&&K++,T?.commander_partner&&!A.some(X=>(X.scryfall_id||X.id)===V)&&(T.commander_partner.type_line||"").includes(q)&&K++,K},R=y.useMemo(()=>{const q=T?.ai_blueprint||T?.aiBlueprint||{},K=q.layout?.types||q.suggestedCounts||{};return[{label:"Total",current:O,target:T?.format?.toLowerCase()==="standard"||T?.format?.toLowerCase()==="modern"?60:100},{label:"Creatures",current:E("Creature"),target:K.Creatures||K.Creature||30},{label:"Lands",current:E("Land"),target:K.Lands||K.Land||36},{label:"Instants",current:E("Instant"),target:K.Instants||K.Instant||10},{label:"Sorceries",current:E("Sorcery"),target:K.Sorceries||K.Sorcery||10},{label:"Enchantments",current:E("Enchantment"),target:K.Enchantments||K.Enchantment||5},{label:"Artifacts",current:E("Artifact"),target:K.Artifacts||K.Artifact||10},{label:"Planeswalkers",current:E("Planeswalker"),target:K.Planeswalkers||K.Planeswalker||0}].filter(V=>V.target>0)},[T,O,A]),$=y.useMemo(()=>{if(!A)return{};const q={Commander:[],Creature:[],Planeswalker:[],Instant:[],Sorcery:[],Artifact:[],Enchantment:[],Land:[],Other:[]};return A.forEach(K=>{const V=((K.data||K).type_line||"").toLowerCase(),X=K.scryfall_id||K.id,Z=T?.commander&&X===(T.commander.id||T.commander.scryfall_id),G=T?.commander_partner&&X===(T.commander_partner.id||T.commander_partner.scryfall_id);if(Z||G){q.Commander.push(K);return}V.includes("creature")?q.Creature.push(K):V.includes("planeswalker")?q.Planeswalker.push(K):V.includes("instant")?q.Instant.push(K):V.includes("sorcery")?q.Sorcery.push(K):V.includes("artifact")?q.Artifact.push(K):V.includes("enchantment")?q.Enchantment.push(K):V.includes("land")?q.Land.push(K):q.Other.push(K)}),Object.fromEntries(Object.entries(q).filter(([K,W])=>W.length>0))},[A,T]);if(l)return s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center",children:s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-500"})});if(u||!T)return s.jsx("div",{className:"min-h-screen bg-gray-950 flex justify-center items-center text-red-500 font-bold text-xl",children:u||"Deck inaccessible"});const B=k===0?T.commander:T.commander_partner||T.commander,C=B?.image_uris?.art_crop||B?.card_faces?.[0]?.image_uris?.art_crop||"",U={W:"https://svgs.scryfall.io/card-symbols/W.svg",U:"https://svgs.scryfall.io/card-symbols/U.svg",B:"https://svgs.scryfall.io/card-symbols/B.svg",R:"https://svgs.scryfall.io/card-symbols/R.svg",G:"https://svgs.scryfall.io/card-symbols/G.svg"},L=async()=>{if(r)try{n("Cloning deck...","info");const q=await di.createDeck(r.uid,{name:`Copy of ${T.name}`,commander:T.commander,commanderPartner:T.commander_partner,format:T.format,isMockup:!0}),K=A.map(W=>({scryfall_id:W.scryfall_id||W.id,name:W.name,set_code:W.set_code,collector_number:W.collector_number,finish:W.finish,image_uri:W.image_uri,data:W.data}));await Pe.post(`/api/decks/${q.id}/cards/batch`,{cards:K}),n("Deck cloned successfully!","success"),e(`/decks/${q.id}`)}catch(q){console.error(q),n("Failed to clone deck","error")}};return s.jsxs("div",{className:"relative min-h-screen bg-gray-950 text-white font-sans",children:[s.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${C})`},children:s.jsx("div",{className:"absolute inset-0 bg-gray-950/20"})}),s.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-8 pb-24 pt-20",children:[s.jsx("div",{className:"bg-gradient-to-r from-gray-900/90 via-gray-900/60 to-white/5 backdrop-blur-md border border-white/10 rounded-3xl p-6 md:p-8 mb-8 shadow-2xl",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 items-start md:items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-300 text-[10px] font-black uppercase tracking-widest rounded border border-indigo-500/30",children:T.format||"Commander"}),s.jsxs("span",{className:"text-gray-500 text-xs font-bold uppercase tracking-wide",children:["Shared by ",T.user_id?"a User":"Unknown"]})]}),s.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white tracking-tighter leading-tight mb-2",children:T.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:(()=>{const q=T?.commander?.color_identity||[],K=T?.commander_partner?.color_identity||[];return[...new Set([...q,...K])].map(V=>s.jsx("img",{src:U[V],alt:V,className:"w-6 h-6"},V))})()}),s.jsx("div",{className:"h-4 w-px bg-white/10"}),s.jsx("div",{className:"text-sm font-bold text-gray-400",children:I.theme})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsxs("div",{className:"text-2xl font-mono font-bold text-green-400",children:["$",M.toFixed(2)]}),s.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-widest font-bold",children:[O," Cards"]}),r?s.jsx("button",{onClick:L,className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Clone to Collection"}):s.jsx(_t,{to:"/login",className:"mt-2 bg-white text-gray-900 px-6 py-2 rounded-xl font-bold hover:bg-gray-200 transition-colors shadow-lg shadow-white/10 text-sm",children:"Login to Clone"})]})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-8",children:R.map((q,K)=>{const W=q.target>0?Math.min(q.current/q.target*100,100):0,V=q.target>0&&q.current===q.target,X=q.target>0&&q.current>q.target;return s.jsxs("div",{className:"bg-gray-950/20 p-3 rounded-xl border border-white/5 backdrop-blur-md shadow-lg",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:q.label}),s.jsxs("span",{className:`text-xs font-mono font-bold ${V?"text-green-400":X?"text-orange-400":"text-indigo-300"}`,children:[q.current,s.jsx("span",{className:"text-gray-600 mx-0.5",children:"/"}),q.target||"?"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-gray-900 rounded-full overflow-hidden border border-gray-700/30",children:s.jsx("div",{className:`h-full transition-all duration-700 ${V?"bg-green-500":X?"bg-orange-500":"bg-indigo-500"}`,style:{width:`${W||0}%`}})})]},K)})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"flex-1 order-3 lg:order-1 space-y-8",children:s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/5 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decklist"]}),s.jsxs("div",{className:"flex bg-gray-900/50 rounded-lg p-1 gap-1 border border-gray-700",children:[s.jsx("button",{onClick:()=>m("grid"),className:`p-1.5 rounded ${p==="grid"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>m("table"),className:`p-1.5 rounded ${p==="table"?"bg-gray-700 text-white":"text-gray-400"}`,children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),s.jsx("div",{className:"p-4 space-y-8",children:Object.entries($).map(([q,K])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-black text-indigo-300 uppercase tracking-widest border-b border-indigo-500/20 mb-3 pb-1 flex justify-between",children:[s.jsx("span",{children:q}),s.jsx("span",{className:"text-gray-500",children:K.length})]}),p==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:K.map((W,V)=>s.jsx(Yu,{card:W,readOnly:!0},V))}):s.jsx("div",{className:"space-y-1",children:K.map((W,V)=>s.jsxs("div",{className:"flex justify-between p-2 hover:bg-white/5 rounded text-sm text-gray-300",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:"font-mono text-gray-500",children:W.countInDeck||1}),s.jsx("span",{className:W.finish==="foil"?"text-yellow-200":"",children:W.name})]}),s.jsx("div",{className:"font-mono text-xs opacity-50",children:W.mana_cost})]},V))})]},q))})]})}),s.jsxs("div",{className:"w-full lg:w-80 shrink-0 order-1 lg:order-2 space-y-6",children:[T.commander&&s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 relative",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-white/5 pb-2",children:"Commander"}),s.jsx("img",{src:B?.image_uris?.normal||B?.card_faces?.[0]?.image_uris?.normal||"https://placehold.co/400x600",className:"w-full rounded-xl shadow-2xl hover:scale-105 transition-transform duration-500",alt:"Commander"}),T.commander_partner&&s.jsx("button",{onClick:()=>_(q=>q===0?1:0),className:"mt-4 w-full py-2 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-300 text-xs font-bold uppercase rounded-lg border border-indigo-500/20 transition-colors",children:"View Partner"})]}),s.jsxs("div",{className:"bg-gray-950/10 backdrop-blur-md rounded-3xl border border-white/5 overflow-hidden p-6 order-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Analytics"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>w(!0),className:"text-[10px] font-black text-white uppercase tracking-[0.2em] bg-indigo-600 flex flex-col items-center gap-2 p-3 rounded-2xl hover:bg-indigo-500 transition-all shadow-xl shadow-indigo-900/40 group overflow-hidden",children:[s.jsx("svg",{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),s.jsx("span",{className:"text-[8px]",children:"Deck Doctor"})]}),s.jsx("button",{onClick:()=>b(!0),className:"text-[10px] font-bold text-indigo-400 hover:text-white uppercase tracking-wider bg-indigo-500/10 px-2 py-1 rounded hover:bg-indigo-500/20 transition-colors",children:"Details "})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"h-[120px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Mana Curve"}),s.jsx(Wx,{cards:A,type:"mana"})]}),s.jsxs("div",{className:"h-[160px]",children:[s.jsx("h4",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2 text-center",children:"Type Dist"}),s.jsx(Wx,{cards:A,type:"types"})]})]})]}),!r&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 backdrop-blur-md rounded-3xl border border-white/10 p-6 text-center",children:[s.jsx("h3",{className:"font-bold text-white mb-2",children:"Build Your Own Decks"}),s.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Join MTG Forge to manage your collection, build decks with AI, and track prices."}),s.jsx(_t,{to:"/login",className:"block w-full py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold shadow-lg shadow-indigo-900/20 transition-all text-sm",children:"Get Started Free"})]})]})]})]}),s.jsx(D9,{isOpen:x,onClose:()=>b(!1),cards:A,deckName:T.name}),s.jsx(B9,{isOpen:v,onClose:()=>w(!1),deck:T,cards:A,isOwner:!1})]})},b5e=()=>{const[t,e]=y.useState([]);return y.useEffect(()=>{const r=console.log,n=console.warn,i=console.error,a=(l,d)=>{const u=d.map(h=>typeof h=="object"?JSON.stringify(h):String(h)).join(" ");e(h=>[`[${l}] ${u}`,...h].slice(0,8))};return console.log=(...l)=>{r(...l),a("LOG",l)},console.warn=(...l)=>{n(...l),a("WARN",l)},console.error=(...l)=>{i(...l),a("ERR",l)},()=>{console.log=r,console.warn=n,console.error=i}},[]),s.jsx("div",{className:"fixed bottom-0 left-0 w-full h-32 bg-black/80 text-[10px] font-mono text-green-400 p-2 overflow-y-auto pointer-events-none z-50 border-t border-green-500/20",children:t.map((r,n)=>s.jsx("div",{className:"border-b border-white/5 pb-0.5 mb-0.5",children:r},n))})},v5e=()=>{const[t,e]=y.useState("connecting"),[r,n]=y.useState(null),[i,a]=y.useState([]),[l,d]=y.useState(!1),u=y.useRef(null),h=y.useRef(null),[p,m]=y.useState(null),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[k,_]=y.useState(null);y.useEffect(()=>{const M=Bf();return n(M),M.on("connect",()=>{console.log("Connected to Forge Bridge"),M.emit("join-pairing",sessionId),e("ready")}),M.on("disconnect",()=>{console.log("Disconnected"),e("error")}),()=>M.disconnect()},[sessionId]),y.useEffect(()=>{let M=null;return(async()=>{try{console.log("[OCR] Initializing Tesseract (Remote)...");const R=await OP.createWorker("eng",1,{workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js",corePath:"https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core.wasm.js"});console.log("[OCR] Worker Ready"),M=R,m(R),w(!0)}catch(R){console.error("OCR Worker Init Failed",R||"Unknown Error")}})(),()=>{M&&M.terminate()}},[]);const T=async()=>{if(!(!v||x||!u.current)){b(!0);try{const M=u.current.getScreenshot();if(!M)return;const E=new Image;E.src=M,await new Promise($=>E.onload=$);const R=await A(E);await O(R)}catch(M){console.error("Processing error",M),_({error:"Processing Error"})}finally{b(!1),setTimeout(()=>{_(M=>M?.error?null:M)},3e3)}}},A=async M=>{const E=h.current,R=E.getContext("2d",{willReadFrequently:!0}),$=async(Y,ne,re,ue)=>{let Le=250/ue;Le=Math.max(.1,Math.min(Le,4));let de=Math.floor(re*Le),ve=Math.floor(ue*Le);de>4e3&&(Le=4e3/re,de=4e3,ve=Math.floor(ue*Le)),console.log(`[RemoteLens] OCR Crop: ${de}x${ve} (Src: ${Math.floor(re)}x${Math.floor(ue)})`),E.width=de,E.height=ve,R.imageSmoothingEnabled=!0,R.imageSmoothingQuality="high",R.drawImage(M,Y,ne,re,ue,0,0,de,ve);const te=R.getImageData(0,0,E.width,E.height),ge=te.data;for(let Ee=0;Ee<ge.length;Ee+=4){const Te=(ge[Ee]+ge[Ee+1]+ge[Ee+2])/3;ge[Ee]=ge[Ee+1]=ge[Ee+2]=Te}R.putImageData(te,0,0);const{data:{text:ke}}=await p.recognize(E);return ke.split(`
`).map(Ee=>Ee.replace(/[^a-zA-Z0-9\s-/]/g,"").trim()).filter(Ee=>Ee.length>=1)},B=M.width,C=M.height,U=Math.min(B,C),L=(B-U)/2,q=(C-U)/2;console.log(`[RemoteLens] Precision Mode: ${B}x${C}, Crop: ${U}x${U} @ (${L}, ${q})`);const K=await $(L+U*.1,q+U*.35,U*.8,U*.3);let W="",V="";const X=K.join(" ").toUpperCase();console.log(`[RemoteLens] Raw Scan: "${X}"`);const G=(X.match(/\b\d{1,5}[A-Z]?\b/g)||[]).filter(Y=>!/^(19|20)\d{2}$/.test(Y));G.length>0&&(V=G[0]);const F=X.match(/\b[A-Z0-9]{3,4}\b/g);if(F){const Y=["THE","LLC","WIZ","TM","INC","COM","ART","NOT","FOR"],ne=["EN","JP","FR","DE","IT","CN","RU","KO","ES","PT","PH"],re=F.find(ue=>!ne.includes(ue)&&!Y.includes(ue)&&!/^\d+$/.test(ue));re&&(W=re)}return{name:"",set:W,cn:V,raw_footer:X}},I=(M,E,R)=>{const $={id:Math.random().toString(36).substr(2,9),scryfall_id:M.scryfall_id||M.uuid,name:M.name,set_name:M.set_name||M.setcode,set_code:M.set||M.setcode,collector_number:M.collector_number||M.number,image:M.image_uri||M.image_uris?.small||M.card_faces?.[0]?.image_uris?.small,finish:l?"foil":"nonfoil",quantity:1,data:M,variants:E,raw_ocr:R};r.emit("card-scanned",{sessionId,card:$}),a(B=>[$,...B].slice(0,5)),_({success:!0,name:M.name})},O=async({name:M,set:E,cn:R,raw_footer:$})=>{if(console.log(`[RemoteLens] Resolving: Set="${E}", CN="${R}"`),E&&R){console.log(`[RemoteLens] Attempting Set/CN match: ${E} #${R}`);try{const B=await Pe.post("/api/cards/search",{set:E,cn:R});if(B.data&&B.data.length>0){const C=B.data[0];console.log(`[RemoteLens] Match found: ${C.name}`);const U=B.data.length>1?B.data:[C];I(C,U,{name:M,set:E,cn:R});return}else{_({error:`Not Found: ${E} #${R}`});return}}catch(B){console.warn("[RemoteLens] Set/CN search failed",B)}}_({error:"Scan Set Code & Number"})};return s.jsxs("div",{className:"fixed inset-0 bg-gray-950 flex flex-col items-center justify-between p-6 text-white overflow-hidden",children:[s.jsx(b5e,{}),s.jsxs("div",{className:"w-full flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(RP,{className:"w-5 h-5 text-indigo-400"}),s.jsx("h1",{className:"font-black italic uppercase text-lg",children:"Forge Remote"})]}),s.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${t==="ready"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[t==="ready"?s.jsx(oJ,{className:"w-3 h-3"}):s.jsx(iJ,{className:"w-3 h-3"}),t==="ready"?"Paired":"Connecting..."]})]}),s.jsxs("div",{className:"relative w-full aspect-[3/4] max-h-[60vh] rounded-3xl overflow-hidden border-2 border-white/10 shadow-2xl bg-black",children:[s.jsx(CP,{ref:u,audio:!1,screenshotFormat:"image/webp",videoConstraints:{facingMode:"environment"},className:"w-full h-full object-cover brightness-110 contrast-125"}),s.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:s.jsxs("div",{className:"w-[80%] aspect-[80/30] border-2 border-white/5 rounded-2xl relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),s.jsx("div",{className:"absolute -bottom-20 left-1/2 -translate-x-1/2 w-[120%]",children:x?s.jsx("div",{className:"bg-indigo-600 text-white text-xs py-2 rounded-full font-black text-center animate-pulse",children:"ANALYZING..."}):k?.success?s.jsxs("div",{className:"bg-green-600 text-white text-xs py-2 rounded-full font-black text-center flex items-center justify-center gap-2",children:[s.jsx(lc,{className:"w-4 h-4"})," ",k.name," SENT!"]}):k?.error?s.jsx("div",{className:"bg-red-600 text-white text-xs py-2 rounded-full font-black text-center",children:k.error}):s.jsx("div",{className:"bg-black/60 backdrop-blur-md text-white/60 text-[10px] py-2 rounded-full text-center uppercase font-bold tracking-widest",children:"Align Set Code & Number"})})]})})]}),s.jsxs("div",{className:"w-full flex flex-col items-center gap-6 mb-20",children:[s.jsxs("div",{className:"flex items-center gap-8",children:[s.jsxs("button",{onClick:()=>d(!l),className:`flex flex-col items-center gap-1 transition-all ${l?"text-yellow-400":"text-gray-500"}`,children:[s.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center border-2 transition-all ${l?"bg-yellow-500/20 border-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.3)]":"bg-gray-800 border-white/5"}`,children:s.jsx("span",{className:"text-xl",children:""})}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:l?"Foil":"Normal"})]}),s.jsx("button",{onClick:T,disabled:x||!v,className:"w-24 h-24 bg-indigo-600 rounded-full flex items-center justify-center shadow-2xl active:scale-90 transition-all border-4 border-white/5",children:x?s.jsx(gj,{className:"w-10 h-10 animate-spin"}):s.jsx(LP,{className:"w-10 h-10"})}),s.jsx("div",{className:"w-12 h-12"})]}),s.jsx("div",{className:"w-full h-20 flex gap-3 overflow-x-auto pb-2 scroll-smooth",children:i.map((M,E)=>s.jsxs("div",{className:"flex-shrink-0 w-12 h-16 rounded-lg overflow-hidden border border-white/10 relative group",children:[s.jsx("img",{src:M.image,className:"w-full h-full object-cover",alt:""}),s.jsx("div",{className:"absolute inset-0 bg-green-500/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(lc,{className:"w-4 h-4 text-white"})})]},E))})]}),s.jsx("canvas",{ref:h,className:"hidden"})]})},w5e=()=>s.jsxs("div",{className:"min-h-screen bg-gray-950 text-white relative flex flex-col pt-16",children:[s.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-indigo-600/10 blur-[120px] rounded-full"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-orange-600/10 blur-[120px] rounded-full"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[radial-gradient(circle_at_center,rgba(30,27,75,0.2)_0%,transparent_70%)]"})]}),s.jsxs("div",{className:"relative z-20 max-w-7xl mx-auto px-4 w-full py-8",children:[s.jsxs(_t,{to:"/",className:"inline-flex items-center text-gray-400 hover:text-white transition-colors gap-2 group mb-12",children:[s.jsx(kX,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),s.jsx("span",{className:"font-bold uppercase tracking-widest text-xs",children:"Back to The Forge"})]}),s.jsxs("div",{className:"max-w-4xl",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 mb-6 text-indigo-400",children:[s.jsx(pA,{className:"w-4 h-4"}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Actionable Intelligence"})]}),s.jsxs("h1",{className:"text-5xl md:text-7xl font-black tracking-tight mb-8 leading-tight",children:["The AI Strategic",s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-500 to-orange-500",children:"Companion Guide"})]}),s.jsx("p",{className:"text-xl md:text-2xl text-gray-400 leading-relaxed font-medium max-w-2xl",children:"Stop tracking data. Start forging strategy. Explore the neural engines that give you the edge in every brew and every match."})]})]}),s.jsxs("main",{className:"relative z-10 max-w-7xl mx-auto px-4 py-24 space-y-48",children:[s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-600/30 blur-[80px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-black/60 border border-white/10 rounded-[3rem] p-12 backdrop-blur-3xl shadow-2xl",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:"Neural Synthesis Engine"}),s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-sm font-bold text-gray-400 italic",children:'"Architect, build me a Bracket 4 competitive deck around [Selected Commander], prioritize my collection first..."'}),s.jsx("div",{className:"h-[1px] w-full bg-white/10"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{l:"Analyzing Archetype...",s:"100%"},{l:"Mapping Collection Staples...",s:"84%"},{l:"Optimizing Mana Curve...",s:"92%"},{l:"Finalizing Deck List...",s:"Processing"}].map((t,e)=>s.jsxs("div",{className:"flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-500",children:[s.jsx("span",{children:t.l}),s.jsx("span",{className:t.s==="100%"?"text-green-400":"text-indigo-400",children:t.s})]},e))})]}),s.jsxs("div",{className:"p-6 bg-indigo-500/10 rounded-2xl border border-indigo-500/20",children:[s.jsx("div",{className:"text-white font-black text-lg mb-2",children:"The Neural Architect"}),s.jsxs("div",{className:"text-gray-400 text-sm leading-relaxed",children:["Generating 100-card Commander list... ",s.jsx("br",{}),s.jsx("span",{className:"text-indigo-300",children:"62/100 Cards found in your collection."})," ",s.jsx("br",{}),s.jsx("span",{className:"text-orange-300",children:"38/100 Cards required for purchase."})]})]})]})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"w-20 h-20 bg-indigo-500/20 rounded-3xl flex items-center justify-center text-indigo-400 border border-indigo-500/20 shadow-[0_0_40px_rgba(79,70,229,0.3)]",children:s.jsx(xj,{className:"w-10 h-10"})}),s.jsxs("h2",{className:"text-5xl font-black leading-tight",children:["Zero-to-Brews:",s.jsx("br",{}),"The Neural Architect"]}),s.jsx("p",{className:"text-gray-400 text-xl leading-relaxed",children:"While other sites give you a search bar, we give you a brain. The **Neural Architect** is the world's first AI engine that doesn't just suggest cardsit synthesizes entire, playable decks from your Commander selection."}),s.jsx("ul",{className:"space-y-6",children:[{t:"Commander-Centric Synthesis",d:"Select your Commander and target a specific power bracket for a precision brew."},{t:"Collection-Aware logic",d:"The AI builds around what you own, drastically reducing the cost of new brews."},{t:"Bracket-Targeting",d:"Specify exactly which pod power level you want to compete in."}].map((t,e)=>s.jsxs("li",{className:"flex gap-4",children:[s.jsx("div",{className:"mt-1 w-5 h-5 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400 text-[10px] font-black border border-indigo-500/30 shrink-0",children:e+1}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-bold",children:t.t}),s.jsx("div",{className:"text-gray-500 text-sm",children:t.d})]})]},e))})]})]}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"space-y-8 order-2 lg:order-1",children:[s.jsx("div",{className:"w-16 h-16 bg-orange-500/10 rounded-2xl flex items-center justify-center text-orange-400 border border-orange-500/20",children:s.jsx(hA,{className:"w-8 h-8"})}),s.jsx("h2",{className:"text-4xl font-black",children:"The AI Deck Doctor"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Traditional deck-building tools treat your list like a static file. The **Deck Doctor** treats it like a living strategy. It uses advanced neural analysis to evaluate not just individual cards, but the synergistic web they form."}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-xl font-bold flex items-center gap-3",children:[s.jsx(JX,{className:"w-5 h-5 text-indigo-400"}),"The 1-5 Bracket System"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[{t:"Bracket 1",d:"Casual/Precon: Narrative focus."},{t:"Bracket 3",d:"High Power: Efficient execution."},{t:"Bracket 5",d:"Maximum Power: Competitive meta."},{t:"0.01 PL Step",d:"Precision tracking of deck shifts."}].map((t,e)=>s.jsxs("div",{className:"p-4 bg-white/5 rounded-xl border border-white/10",children:[s.jsx("div",{className:"font-black text-indigo-400 text-sm mb-1 uppercase tracking-wider",children:t.t}),s.jsx("div",{className:"text-sm text-gray-400",children:t.d})]},e))})]})]}),s.jsxs("div",{className:"relative order-1 lg:order-2 group",children:[s.jsx("div",{className:"absolute inset-0 bg-indigo-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Power Level"}),s.jsx("div",{className:"text-5xl font-black text-white",children:"7.42"})]}),s.jsx("div",{className:"px-4 py-2 bg-indigo-500/20 rounded-lg border border-indigo-500/30 text-indigo-400 font-bold uppercase tracking-widest text-xs",children:"Bracket 3"})]}),s.jsx("div",{className:"h-2 w-full bg-gray-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-orange-500 w-[74%]"})}),s.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/5 italic text-gray-400 text-sm leading-relaxed",children:'"Your deck is highly efficient but lacks sufficient early-game interaction. At Bracket 3, you are vulnerable to faster combo strategies."'})]})})]})]}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-orange-600/20 blur-[60px] rounded-full scale-75 group-hover:scale-100 transition-transform duration-1000"}),s.jsx("div",{className:"relative bg-gray-900/80 border border-white/10 rounded-[2.5rem] p-8 backdrop-blur-xl shadow-2xl",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Recommended Adjustments"}),[{out:"Murder",in:"Assassin's Trophy",reason:"Broadened threat coverage"},{out:"Sol Ring",in:"Mana Crypt",reason:"Maximum acceleration"}].map((t,e)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-black/40 rounded-2xl border border-white/5",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-red-400 text-xs font-bold line-through",children:["OUT: ",t.out]}),s.jsxs("div",{className:"text-green-400 text-sm font-bold mt-1",children:["IN: ",t.in]})]}),s.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black",children:t.reason})]},e))]})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-500/10 rounded-2xl flex items-center justify-center text-indigo-400 border border-indigo-500/20",children:s.jsx(xj,{className:"w-8 h-8"})}),s.jsx("h2",{className:"text-4xl font-black",children:"Surgical Swaps"}),s.jsx("p",{className:"text-gray-400 text-lg leading-relaxed",children:"Stop buying proxies you don't need or spending money on cards that clash with your goals. Our AI scans your **available collection** in real-time to suggest surgical changes."}),s.jsx("ul",{className:"space-y-4",children:["Find hidden staples already in your binders","Optimize curve without increasing budget","Identify over-committed resources"].map((t,e)=>s.jsxs("li",{className:"flex items-center gap-3 text-white font-medium",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),t]},e))})]})]}),s.jsxs("section",{className:"space-y-16",children:[s.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[s.jsx("h2",{className:"text-4xl font-black mb-6",children:"Tactical Advisor Personas"}),s.jsx("p",{className:"text-xl text-gray-400",children:"Different archetypes for different goals. Choose who critiques your brew."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{n:"Ruthless Optimizer",t:"Cedh Meta",icon:s.jsx(EX,{className:"w-6 h-6"}),color:"text-red-400",bg:"hover:border-red-500/30"},{n:"Flavor Specialist",t:"Vorthos/Lore",icon:s.jsx(nJ,{className:"w-6 h-6"}),color:"text-blue-400",bg:"hover:border-blue-500/30"},{n:"Budget Engineer",t:"Cost Neutral",icon:s.jsx(pA,{className:"w-6 h-6"}),color:"text-green-400",bg:"hover:border-green-500/30"},{n:"Chaos Librarian",t:"Unique Tech",icon:s.jsx(hA,{className:"w-6 h-6"}),color:"text-purple-400",bg:"hover:border-purple-500/30"}].map((t,e)=>s.jsxs("div",{className:`p-8 bg-white/5 border border-white/10 rounded-3xl transition-all ${t.bg} group`,children:[s.jsx("div",{className:`w-12 h-12 mb-6 flex items-center justify-center bg-gray-900 rounded-xl ${t.color} border border-white/5 group-hover:scale-110 transition-transform`,children:t.icon}),s.jsx("h4",{className:"text-lg font-black mb-1",children:t.n}),s.jsx("div",{className:"text-xs font-bold uppercase tracking-widest text-gray-500",children:t.t})]},e))})]}),s.jsxs("section",{className:"relative overflow-hidden rounded-[3rem] bg-gradient-to-br from-indigo-600 to-purple-800 p-12 md:p-24 text-center",children:[s.jsx("div",{className:"absolute inset-0 bg-[url(/MTG-Forge_Logo_Background.png)] bg-cover bg-center mix-blend-overlay opacity-20"}),s.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto space-y-8",children:[s.jsx("h2",{className:"text-4xl md:text-6xl font-black text-white leading-tight",children:"Ready to Forge Your Legends?"}),s.jsx("p",{className:"text-xl text-indigo-100 font-medium",children:"Join the new generation of brewers using Actionable Intelligence to dominate their pods."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center pt-8",children:[s.jsx(_t,{to:"/dashboard",className:"px-10 py-5 bg-white text-indigo-900 font-black rounded-2xl shadow-xl hover:scale-105 transition-all",children:"Enter The Forge"}),s.jsx(_t,{to:"/pricing",className:"px-10 py-5 bg-black/30 backdrop-blur-md text-white border border-white/20 font-black rounded-2xl hover:bg-black/40 transition-all",children:"View Pricing"})]})]})]})]}),s.jsx("footer",{className:"relative z-10 py-24 border-t border-white/5 bg-gray-950 mt-auto",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center space-y-4",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:" 2025 MTG-Forge. Not affiliated with Wizards of the Coast."}),s.jsxs("div",{className:"flex justify-center gap-8 text-xs font-bold uppercase tracking-widest text-gray-600",children:[s.jsx(_t,{to:"/about",className:"hover:text-white transition-colors",children:"About"}),s.jsx(_t,{to:"/pricing",className:"hover:text-white transition-colors",children:"Pricing"}),s.jsx(_t,{to:"/settings",className:"hover:text-white transition-colors",children:"Settings"})]})]})})]}),j5e=Ge.memo(({item:t,onUpdate:e,onViewDetails:r,onSwapFoil:n})=>{const[i,a]=y.useState(!1),l=t.reviewed,d=l&&t.actual_quantity===t.expected_quantity,u=l&&t.actual_quantity!==t.expected_quantity,h=!l,p=t.finish==="foil",m=t.card_data?.card_faces,x=m&&m.length>1;let b=t.image_uri,v=t.art_uri,w=t.name;if(x){const O=m[i?1:0];O.image_uris?.art_crop&&(v=O.image_uris.art_crop),O.image_uris?.large?b=O.image_uris.large:O.image_uris?.normal&&(b=O.image_uris.normal),w=O.name}const k=u,_=I=>{I.stopPropagation(),u||e(t.id,0,!0)},T=I=>{I.stopPropagation(),d||e(t.id,t.expected_quantity,!0)},A=I=>{const O=parseInt(I.target.value);isNaN(O)||O<0||e(t.id,O,!0)};return s.jsxs("div",{onClick:()=>r(t),className:`group relative flex flex-col rounded-xl overflow-hidden border transition-all duration-300 hover:-translate-y-1 hover:shadow-xl cursor-pointer 
                ${d?"bg-gray-800/80 border-green-500/30 shadow-green-500/5":""}
                ${u?"bg-red-900/20 border-red-500/50 shadow-red-500/10":""}
                ${h?"bg-gray-800/40 border-gray-700/50 hover:border-gray-500/50":""}
            `,children:[s.jsxs("div",{className:"relative aspect-[4/3] bg-gray-900 w-full overflow-hidden",children:[v||b?s.jsx("img",{src:v||b,alt:w,loading:"lazy",className:"w-full h-full object-cover transition-transform group-hover:scale-110 duration-700"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-600",children:"No Image"}),s.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 transition-colors z-20 
                    ${d?"bg-green-500":""}
                    ${u?"bg-red-500":""}
                    ${h?"bg-gray-700":""}
                `}),s.jsx("div",{className:`absolute top-2 right-2 px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-wider shadow-lg backdrop-blur-md border z-10 
                    ${p?"bg-gradient-to-r from-yellow-600/90 to-yellow-400/90 text-white border-yellow-300/50":"bg-gray-900/80 text-gray-400 border-gray-600/50"}`,children:p?"Foil":"Normal"}),x&&s.jsxs("button",{onClick:I=>{I.stopPropagation(),a(!i)},className:"absolute bottom-2 left-1/2 -translate-x-1/2 px-3 py-1 bg-black/60 hover:bg-black/80 text-white text-xs font-bold rounded-full backdrop-blur-sm border border-white/20 shadow-lg flex items-center gap-1 z-30 transition-all hover:scale-105",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Flip"]})]}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[s.jsx("h3",{className:"text-white font-black text-lg leading-tight mb-1 truncate",title:w,children:w}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono mb-4 flex items-center justify-between",children:[s.jsxs("span",{children:["#",t.collector_number,"  ",t.set_code.toUpperCase()]}),s.jsxs("span",{className:"text-gray-400 font-bold",children:["Goal: ",t.expected_quantity]})]}),s.jsxs("div",{className:"mt-auto flex items-center justify-between gap-3",onClick:I=>I.stopPropagation(),children:[s.jsx("button",{onClick:_,disabled:u,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${u?"bg-red-500 text-white shadow-lg shadow-red-500/20":"text-gray-500 hover:text-red-400 hover:bg-red-500/10"}`,title:"Mark Mismatch (Set to 0)",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("div",{className:"relative flex-1",children:s.jsx("input",{type:"number",min:"0",value:t.actual_quantity,disabled:!k,onChange:A,className:`w-full bg-gray-900 border rounded-lg px-3 py-1.5 font-mono text-center focus:outline-none focus:ring-2 transition-colors 
                                ${d?"border-green-500/50 text-green-400 opacity-90 cursor-not-allowed":""}
                                ${u?"border-red-500/50 text-white focus:ring-red-500":""}
                                ${h?"border-gray-700 text-gray-400 cursor-not-allowed":""}
                            `})}),s.jsx("button",{onClick:T,disabled:d,className:`w-8 h-8 flex items-center justify-center rounded-lg transition-colors 
                            ${d?"bg-green-500 text-white shadow-lg shadow-green-500/20":"text-gray-500 hover:text-green-400 hover:bg-green-500/10"}`,title:"Confirm Match",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]})]})});function N5e(){const{userProfile:t}=Mt(),{auditId:e}=ol(),[r]=n4(),n=r.get("deckId"),i=r.get("group"),{openCardModal:a}=L0(),{addToast:l}=_r(),[d,u]=y.useState(!1),[h,p]=y.useState(null),[m,x]=y.useState([]),[b,v]=y.useState(!0),[w,k]=y.useState(null),[_,T]=y.useState(50),A=y.useRef(null),[I,O]=y.useState("all"),M=on();y.useEffect(()=>{const L=new IntersectionObserver(q=>{q[0].isIntersecting&&T(K=>K+50)},{rootMargin:"200px"});return A.current&&L.observe(A.current),()=>L.disconnect()},[m?.length]),y.useEffect(()=>{E(),n&&Pe.get(`/api/decks/${n}`).then(L=>k((L.deck||L).name)).catch(()=>{})},[e,n]);const E=async()=>{try{const L=await Pe.getActiveAudit();if(!L){alert("No active audit session found."),M("/dashboard");return}p(L);const q=await Pe.getAuditItems(L.id,{deckId:n,group:i}),K=t?.settings?.organization?.sortHierarchy||["name"];x(R(q,K))}catch(L){console.error(L)}finally{v(!1)}},R=(L,q)=>[...L].sort((K,W)=>{for(const V of q){let X=0;if(V==="set"?X=(K.set_code||"").localeCompare(W.set_code||""):V==="collector_number"?X=parseInt(K.collector_number||0)-parseInt(W.collector_number||0):V==="name"&&(X=(K.name||"").localeCompare(W.name||"")),X!==0)return X}return(K.name||"").localeCompare(W.name||"")}),$=async(L,q,K=null)=>{const W=parseInt(q);if(!(isNaN(W)||W<0)){x(V=>V.map(X=>X.id!==L?X:{...X,actual_quantity:W,reviewed:K!==null?K:X.reviewed}));try{await Pe.updateAuditItem(h.id,L,W,K)}catch(V){console.error(V)}}},B=async()=>{try{v(!0),await Pe.reviewAuditSection(h.id,{deckId:n,group:i}),M(`/audit/${h.id}`)}catch(L){console.error(L),v(!1)}},C=y.useMemo(()=>I==="all"?m:I==="pending"?m.filter(L=>!L.reviewed):I==="mismatch"?m.filter(L=>L.reviewed&&L.actual_quantity!==L.expected_quantity):m,[m,I]),U=C.slice(0,_);return b?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-500 rounded-full"})}):h?s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 animate-fade-in pb-24",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-8 bg-gray-900/50 p-6 rounded-2xl border border-white/5 backdrop-blur-md sticky top-20 z-30 shadow-xl",children:[s.jsxs("div",{children:[s.jsx("button",{onClick:()=>M(`/audit/${h.id}`),className:"text-gray-500 hover:text-white flex items-center gap-2 text-sm font-bold mb-2",children:"Back to Hub"}),s.jsxs("h1",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx("span",{className:"text-indigo-400",children:"Audit:"})," ",w||i||h.type]})]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsxs("div",{className:"bg-gray-800 p-1 rounded-lg flex text-xs font-bold",children:[s.jsx("button",{onClick:()=>O("all"),className:`px-3 py-1.5 rounded-md transition-colors ${I==="all"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"All"}),s.jsx("button",{onClick:()=>O("pending"),className:`px-3 py-1.5 rounded-md transition-colors ${I==="pending"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Pending"}),s.jsx("button",{onClick:()=>O("mismatch"),className:`px-3 py-1.5 rounded-md transition-colors ${I==="mismatch"?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:"Mismatches"})]}),s.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-500/30 hover:bg-indigo-600/30 font-bold rounded-lg text-sm flex items-center gap-2 transition-all",title:"Verify Cards with Camera",children:[s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Scan Verify"]}),s.jsx("button",{onClick:B,className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg shadow-lg shadow-blue-500/20 text-sm flex items-center gap-2",children:"Finish Section"})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:U.map(L=>s.jsx(j5e,{item:L,onUpdate:$,onViewDetails:q=>a({...q,data:q.card_data}),onSwapFoil:()=>{}},L.id))}),_<C.length&&s.jsx("div",{ref:A,className:"h-24 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-indigo-500 rounded-full"})}),s.jsx(ey,{isOpen:d,onClose:()=>u(!1),onFinish:async(L,q={})=>{if(!L.length)return;const{targetDeckId:K,additionMode:W}=q,V=L.filter(Y=>!Y.is_wishlist),X=L.filter(Y=>Y.is_wishlist);if(X.length>0)try{const Y=X.map(ne=>({name:ne.name,scryfall_id:ne.scryfall_id,set_code:ne.set_code,collector_number:ne.collector_number,image_uri:ne.data.image_uris?.normal||ne.data.card_faces?.[0]?.image_uris?.normal,count:ne.quantity,data:ne.data,is_wishlist:!0,tags:[]}));await Pe.batchAddToCollection(Y),l(`Saved ${X.length} items to wishlist!`,"success")}catch(Y){console.error("Wishlist save failed",Y)}let Z=0;const G=[],F=[...m];for(const Y of V){const ne=F.findIndex(re=>re.scryfall_id===Y.scryfall_id&&(Y.finish?re.finish===Y.finish:!0));if(ne!==-1){const re=F[ne],ue=(re.actual_quantity||0)+Y.quantity;F[ne]={...re,actual_quantity:ue,reviewed:!0};try{await Pe.updateAuditItem(h.id,re.id,ue,!0),Z++}catch(Le){console.error("Failed to update audit item",Le)}}else G.push(Y)}if(G.length>0)try{const Y=G.map(ue=>({name:ue.name,scryfall_id:ue.scryfall_id,set_code:ue.set_code,collector_number:ue.collector_number,image_uri:ue.data.image_uris?.normal||ue.data.card_faces?.[0]?.image_uris?.normal,count:ue.quantity,data:ue.data,finish:ue.finish||"nonfoil",deck_id:K||(n&&n!=="null"?n:null),tags:[]})),ne=W==="transfer"?"transfer_to_deck":"merge";await Pe.batchAddToCollection(Y,ne);const re=K?"deck":n?"this deck":"collection";l(`Added ${G.length} bonus cards to ${re}!`,"info")}catch(Y){console.error("Bonus card addition failed",Y)}x(F),Z>0&&l(`Verified ${Z} cards!`,"success")}})]}):null}function YL(){const{id:t}=ol(),[e,r]=y.useState(null),[n,i]=y.useState(null),[a,l]=y.useState(!0),[d,u]=y.useState(null),h=on(),[p,m]=y.useState({isOpen:!1,type:null,onConfirm:()=>{}}),[x,b]=y.useState(!1),[v,w]=y.useState("");y.useEffect(()=>{(async()=>{try{let B=t;if(!B){const C=await Pe.getActiveAudit();if(C)B=C.id;else return}if(B){const C=await Pe.get(`/api/audit/${B}/stats`);i(C);const U=await Pe.getActiveAudit();r(U)}}catch(B){console.error("Failed to load audit hub",B),u(B.message)}finally{l(!1)}})()},[t]);const k=($,B)=>{m({isOpen:!0,type:$,onConfirm:B}),w("")},_=async()=>{const $=p.type==="cancel"?"delete":"complete";v.toLowerCase().trim()===$&&(await p.onConfirm(),m({isOpen:!1,type:null,onConfirm:()=>{}}))},T=()=>{e&&k("cancel",async()=>{try{await Pe.cancelAudit(e.id),h("/dashboard")}catch($){alert("Failed to cancel: "+$.message)}})},A=()=>{k("finalize",async()=>{try{await Pe.finalizeAudit(e.id),h("/dashboard")}catch($){console.error("Finalize failed",$),alert("Finalize failed: "+$.message)}})};if(a)return s.jsx("div",{className:"p-8 text-center text-gray-400 animate-pulse",children:"Loading Audit..."});if(d)return s.jsxs("div",{className:"p-8 text-center text-red-400",children:["Error: ",d]});if(!e||!n)return s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"No Active Audit"}),s.jsx("button",{onClick:()=>h("/dashboard"),className:"px-4 py-2 bg-gray-700 rounded text-white",children:"Return to Dashboard"})]});const I=n.total_cards||1,O=n.total_reviewed||0,M=n.total_verified||0,E=Math.round(O/I*100),R=($,B,C)=>{if(B===0)return"from-gray-800 to-gray-900 border-gray-700";if(C>0&&C>=B)return"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400";const U=C/B;return U===1?$===B?"from-green-900/40 to-green-900/20 border-green-500/50 hover:border-green-400":"from-blue-900/40 to-blue-900/20 border-blue-500/50 hover:border-blue-400":U<.1?"from-gray-800/40 to-gray-800/20 border-gray-700/50 hover:border-gray-600":"from-yellow-900/40 to-yellow-900/20 border-yellow-500/50 hover:border-yellow-400"};return s.jsxs("div",{className:"min-h-screen bg-gray-900 p-8 pt-24 relative",children:[s.jsxs("div",{className:`max-w-7xl mx-auto space-y-8 animate-fade-in-up transition-all ${p.isOpen?"blur-sm pointer-events-none":""}`,children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 text-xs font-bold uppercase px-2 py-1 rounded border border-indigo-500/30",children:"Audit in Progress"}),s.jsxs("span",{className:"text-gray-500 text-sm",children:["Started ",new Date(e.created_at).toLocaleDateString()]})]}),s.jsx("h1",{className:"text-4xl font-black text-white",children:"Audit the Forge"}),s.jsxs("p",{className:"text-gray-400 mt-2 flex items-center gap-2",children:["Verify decks and binder to reconcile your inventory.",s.jsxs("button",{onClick:()=>b(!0),className:"text-indigo-400 hover:text-indigo-300 font-bold ml-2 text-sm flex items-center gap-1 group/guide",children:[s.jsx("svg",{className:"w-4 h-4 transition-transform group-hover/guide:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Setup Guide"]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:T,className:"px-4 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors font-medium text-sm",children:"Cancel Audit"}),s.jsx("button",{onClick:A,className:"px-6 py-2 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white font-bold rounded-lg shadow-lg shadow-green-500/20 text-sm transition-all hover:scale-105",children:"Finalize Results"})]})]}),s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700 relative overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 relative z-10",children:[s.jsx("span",{className:"text-xl font-bold text-white",children:"Total Progress"}),s.jsxs("span",{className:"text-2xl font-mono text-indigo-400",children:[E,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-700/50 rounded-full h-4 overflow-hidden relative z-10",children:s.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-500 h-full transition-all duration-1000 ease-out",style:{width:`${E}%`}})}),s.jsxs("div",{className:"mt-2 flex justify-between text-sm text-gray-400 relative z-10",children:[s.jsxs("span",{children:[O," / ",I," Cards Reviewed (",M," Matched)"]}),s.jsxs("span",{children:[n.decks.length," Decks  ",Object.keys(n.collection.groups).length," Loose Groups"]})]})]}),n.decks.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Decks"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.decks.map($=>s.jsxs("button",{onClick:()=>h(`/audit/${e.id}/wizard?deckId=${$.id}`),className:`relative group p-6 rounded-xl border transition-all hover:-translate-y-1 hover:shadow-xl bg-gradient-to-br ${R($.verified,$.total,$.reviewed)} overflow-hidden`,children:[s.jsx("h4",{className:"font-bold text-white text-lg truncate mb-1 relative z-10 text-left",children:$.name}),s.jsxs("div",{className:"text-sm text-gray-300 mb-4 flex justify-between relative z-10",children:[s.jsx("span",{children:$.colors?$.colors.join(""):"Colorless"}),s.jsx("span",{children:$.reviewed>=$.total?s.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})," Complete"]}):s.jsxs("span",{children:[$.reviewed,"/",$.total," Done"]})})]}),s.jsx("div",{className:"w-full bg-black/30 rounded-full h-1.5 overflow-hidden relative z-10",children:s.jsx("div",{className:"bg-white/80 h-full transition-all",style:{width:`${$.reviewed/$.total*100}%`}})})]},$.id))})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Collection (Loose Cards)"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[n.collection.groups.map($=>s.jsxs("button",{onClick:()=>h(`/audit/${e.id}/wizard?group=${$.name}`),className:`relative p-4 rounded-xl border text-left transition-all hover:brightness-110 bg-gradient-to-br ${R($.verified,$.total,$.reviewed)} overflow-hidden group isolate`,children:[s.jsx("div",{className:"text-3xl font-black text-white/5 absolute -bottom-1 -right-1 select-none pointer-events-none transition-colors z-0 whitespace-nowrap transform rotate-0 origin-bottom-right",children:$.name}),s.jsx("h4",{className:"font-bold text-white text-md mb-2 relative z-10",children:$.name}),s.jsx("div",{className:"text-xs text-gray-300 relative z-10",children:$.reviewed>=$.total?s.jsxs("span",{className:"flex items-center gap-1 text-blue-300",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})," Complete"]}):s.jsxs("span",{children:[$.reviewed,"/",$.total," Done"]})})]},$.name)),n.collection.total>0&&n.collection.groups.length===0&&s.jsx("div",{className:"col-span-full text-gray-500 italic p-4",children:"No groups found for loose cards. (All cards might be in decks)"}),n.collection.total===0&&s.jsx("div",{className:"col-span-full border border-dashed border-gray-700 rounded-xl p-8 text-center text-gray-500",children:"No loose cards in this audit scope."})]})]}),n.mismatches&&n.mismatches.length>0&&s.jsxs("div",{className:"bg-gray-800/50 rounded-2xl border border-red-500/20 overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-700/50 flex items-center gap-3",children:s.jsx("h3",{className:"text-xl font-bold text-white",children:"Discrepancy Report"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-900/50 text-gray-400 text-xs uppercase tracking-wider",children:[s.jsx("th",{className:"p-4",children:"Card"}),s.jsx("th",{className:"p-4",children:"Set"}),s.jsx("th",{className:"p-4",children:"Location"}),s.jsx("th",{className:"p-4 text-center",children:"Expected"}),s.jsx("th",{className:"p-4 text-center",children:"Actual"}),s.jsx("th",{className:"p-4 text-right",children:"Diff"})]})}),s.jsx("tbody",{className:"text-sm divide-y divide-gray-700/50",children:n.mismatches.map($=>{const B=$.actual-$.expected;return s.jsxs("tr",{className:"text-white hover:bg-white/5 transition-colors",children:[s.jsxs("td",{className:"p-4 font-bold max-w-xs truncate",children:[$.name," ",$.finish==="foil"&&s.jsx("span",{className:"text-xs text-yellow-500 ml-1",children:"FOIL"})]}),s.jsxs("td",{className:"p-4 font-mono text-gray-400",children:[$.set_code.toUpperCase()," #",$.collector_number]}),s.jsx("td",{className:"p-4 text-gray-300",children:$.deck_name?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-indigo-500"})," ",$.deck_name]}):s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-500"})," Collection"]})}),s.jsx("td",{className:"p-4 text-center font-mono text-gray-400",children:$.expected}),s.jsx("td",{className:"p-4 text-center font-mono font-bold",children:$.actual}),s.jsx("td",{className:`p-4 text-right font-mono font-bold ${B>0?"text-green-400":"text-red-400"}`,children:B>0?`+${B}`:B})]},$.id)})})]})})]})]}),p.isOpen&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>m({...p,isOpen:!1})}),s.jsxs("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 p-6 max-w-md w-full relative z-10 shadow-2xl animate-fade-in-up",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:p.type==="cancel"?"Delete Audit Session?":"Complete Audit?"}),s.jsx("p",{className:"text-gray-400 text-sm mb-6",children:p.type==="cancel"?"This will definitively DELETE this session and all progress. This cannot be undone.":"This will sync all verified counts to your collection. Cards in 'Reviewed' sections with mismatching counts will NOT be synced, only exact matches are auto-synced. Proceed?"}),s.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:["Type ",s.jsx("span",{className:"text-white select-none",children:p.type==="cancel"?"Delete":"Complete"})," to confirm"]}),s.jsx("input",{type:"text",value:v,onChange:$=>w($.target.value),placeholder:p.type==="cancel"?"Delete":"Complete",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-600 focus:border-indigo-500 outline-none mb-6",autoFocus:!0}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>m({...p,isOpen:!1}),className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{onClick:_,disabled:v.toLowerCase().trim()!==(p.type==="cancel"?"delete":"complete"),className:`px-4 py-2 rounded-lg font-bold text-white transition-all ${v.toLowerCase().trim()===(p.type==="cancel"?"delete":"complete")?p.type==="cancel"?"bg-red-500 hover:bg-red-600":"bg-green-600 hover:bg-green-500":"bg-gray-700 opacity-50 cursor-not-allowed"}`,children:p.type==="cancel"?"Delete Audit":"Complete Audit"})]})]})]}),s.jsx(Xf,{isOpen:x,onClose:()=>b(!1)})]})}const k5e=()=>{const{userProfile:t}=Mt(),[e,r]=y.useState(!1),[n,i]=y.useState(!1),a=t?.settings?.helper,l=a?.name||"MTG Forge",[d,u]=y.useState([]),[h,p]=y.useState(""),[m,x]=y.useState(!1),[b,v]=y.useState(!1),w=y.useRef(null),k=()=>{w.current?.scrollIntoView({behavior:"smooth"})};y.useEffect(()=>{k()},[d]),y.useEffect(()=>{if(!e)return;(async()=>{const M=t?.settings?.geminiApiKey;if(!M||b){!M&&d.length===0&&u([{role:"model",content:'<p class="text-gray-300">Please add your Gemini API Key in Settings to enable the chat.</p>'}]);return}if(v(!0),!(d.length>0))try{const E=`
                    You are about to have a conversation with a user.
                    your name is ${l}.
                    Your personality is: ${a?.personality||"Knowledgeable and friendly"}.
                    It is not their first time working with you, interact with them appropriately.
                    Use emojis. 
                `,R=await _s.sendMessage(M,[],E,"",a);u([{role:"model",content:R}])}catch(E){console.error("Intro fetch failed",E),u([{role:"model",content:`<p>Greetings. I am ${l}. How may I assist?</p>`}])}})()},[e,t?.settings?.geminiApiKey,l,b]);const _=t?.settings?.playstyle,T=_?`
User's Playstyle Profile:
- Archetypes: ${_.archetypes?.join(", ")||"Unknown"}
- Summary: ${_.summary||"Unknown"}
- Combat Preference: ${_.scores?.aggression>50?"Aggressive":"Defensive"}
- Interaction Level: ${_.scores?.interaction>50?"High":"Low"}
    `.trim():"",A=async O=>{if(O.preventDefault(),!h.trim()||m)return;const M=h.trim();p(""),u(E=>[...E,{role:"user",content:M}]),x(!0);try{const E=t?.settings?.geminiApiKey;if(!E){u(B=>[...B,{role:"model",content:'<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Please add your Gemini API Key in <a href="/settings" class="underline font-bold">Settings</a> to use the chat.</div>'}]);return}const R=d.map(B=>({role:B.role,content:B.content})),$=await _s.sendMessage(E,R,M,T,a);u(B=>[...B,{role:"model",content:$}])}catch(E){console.error(E),u(R=>[...R,{role:"model",content:`<div class="p-3 bg-red-900/30 border border-red-700 rounded text-red-200">Error: ${E.message}</div>`}])}finally{x(!1)}},I=n?"fixed inset-0 top-16 z-40":`fixed bottom-0 right-0 z-[60] transition-all duration-300 ${e?"":"w-16 h-16 mb-20 mr-4 md:mb-6 md:mr-6"}`;return s.jsxs("div",{className:`${I} ${!n&&e?"w-full md:w-96 h-[600px] mb-16 md:mb-0 mr-0":""}`,children:[!e&&s.jsx("button",{onClick:()=>r(!0),className:"w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full shadow-lg shadow-purple-500/30 flex items-center justify-center hover:scale-110 transition-transform animate-bounce-slow",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e&&s.jsxs("div",{className:`flex flex-col h-full bg-gray-800 border-t border-l border-gray-700 shadow-2xl overflow-hidden ${n?"w-full h-full":"rounded-tl-2xl md:rounded-tr-2xl md:border-r"}`,children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),s.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:l})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>i(!n),className:"text-gray-400 hover:text-white p-1 hover:bg-gray-800 rounded transition-colors",title:n?"Collapse":"Expand",children:n?s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6m-6 0v6M20 10h-6m6 0V4"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),s.jsx("button",{onClick:()=>{r(!1),i(!1)},className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-800/95 backdrop-blur",children:[d.length===0&&!m?s.jsxs("div",{className:"flex justify-center items-center h-full text-gray-500 italic",children:["Summoning ",l,"..."]}):d.map((O,M)=>s.jsx("div",{className:`flex ${O.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[85%] p-3 rounded-2xl ${O.role==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-gray-700 text-gray-200 rounded-bl-none"} shadow-md`,children:O.role==="user"?O.content:s.jsx("div",{dangerouslySetInnerHTML:{__html:O.content}})})},M)),m&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"bg-gray-700 rounded-2xl rounded-bl-none p-3 flex gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-75"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-150"})]})}),s.jsx("div",{ref:w})]}),s.jsx("form",{onSubmit:A,className:"p-4 bg-gray-900 border-t border-gray-700",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:h,onChange:O=>p(O.target.value),placeholder:`Ask ${l}...`,className:"flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"}),s.jsx("button",{type:"submit",disabled:m,className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg hover:shadow-indigo-500/20 transition-all disabled:opacity-50",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})},S5e=()=>{const{isOpen:t,selectedCard:e,closeCardModal:r}=L0(),{cards:n,removeCard:i,updateCard:a}=Gs(),{addToast:l}=_r(),[d,u]=y.useState(!1),[h,p]=y.useState(!1),[m,x]=y.useState({quantity:1,finish:"nonfoil",deckId:"",price_bought:"",tags:[],currentTag:""}),[b,v]=y.useState([]);if(y.useEffect(()=>{t&&e&&(u(!1),p(!1),x({quantity:e.count||e.quantity||1,finish:e.finish||"nonfoil",deckId:e.deckId||e.deck_id||"",price_bought:e.price_bought||"",tags:typeof e.tags=="string"?JSON.parse(e.tags):e.tags||[],currentTag:""}),Pe.get("/api/decks").then(v).catch(Z=>console.error("Failed to load decks",Z)))},[t,e]),!t||!e)return null;const w=e.data||e,k=w.card_faces,_=k&&k.length>1&&!!k[1].image_uris,I=(Z=>_?w.card_faces[Z]:w)(d?1:0),O=Z=>Z.image_uris?.normal||Z.image_uris?.large||null,M=Z=>Z.image_uris?.art_crop||Z.image_uris?.large||Z.image_uris?.normal||null,E=_?O(w.card_faces[0]):w.image_uris?.normal||w.image_uris?.large||e.image_uri,R=_?O(w.card_faces[1]):null,$=_?M(w.card_faces[0]):w.image_uris?.art_crop||w.image_uris?.large||e.image_uri,B=_?M(w.card_faces[1]):null,C=d?R:E,U=(d?B:$)||"https://placehold.co/1000x800?text=No+Art",L=Z=>Z?Z.replace(/\{/g,"").replace(/\}/g," "):"",q=(Z,G)=>{const F={legal:"bg-green-600 text-white border-green-700",not_legal:"bg-gray-700 text-gray-400 border-gray-600",banned:"bg-red-600 text-white border-red-700",restricted:"bg-yellow-600 text-white border-yellow-700"},Y=F[G]||F.not_legal;return s.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase border ${Y} flex justify-center items-center shadow-sm`,children:s.jsx("span",{children:Z})},Z)},K=async()=>{if(window.confirm(`Are you sure you want to delete ${e.name} from your collection?`))try{await i(e.id||e.firestoreId),l("Card deleted","success"),r()}catch(Z){console.error(Z),l("Failed to delete card","error")}},W=async()=>{try{const Z={count:parseInt(m.quantity),finish:m.finish,deck_id:m.deckId?parseInt(m.deckId):null,price_bought:m.price_bought?parseFloat(m.price_bought):null,tags:m.tags};await a(e.id||e.firestoreId,Z),l("Card details updated","success"),p(!1)}catch(Z){console.error(Z),l("Failed to update details","error")}},V=Z=>{Z.key==="Enter"&&m.currentTag.trim()&&(Z.preventDefault(),m.tags.includes(m.currentTag.trim())||x(G=>({...G,tags:[...G.tags,G.currentTag.trim()],currentTag:""})))},X=Z=>{x(G=>({...G,tags:G.tags.filter(F=>F!==Z)}))};return s.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center overflow-hidden animate-fade-in",role:"dialog",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity",onClick:r}),s.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full md:h-[90vh] max-h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-y-auto md:overflow-hidden bg-gray-900/50 border border-gray-700",children:[s.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden rounded-2xl",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-700 ease-in-out transform scale-110 opacity-100",style:{backgroundImage:`url('${U}')`}}),s.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),s.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-50 p-2 bg-black/30 hover:bg-black/60 rounded-full text-white/70 hover:text-white transition-colors backdrop-blur-md",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"w-full md:w-1/2 lg:w-5/12 p-8 flex flex-col items-center justify-center relative shrink-0 z-10",children:[s.jsxs("div",{className:"relative w-full max-w-xs md:max-w-md aspect-[2.5/3.5] perspective-1000 transition-transform duration-500",children:[s.jsx("img",{src:C||"https://placehold.co/250x350?text=No+Image",alt:e.name,className:"w-full h-full object-contain drop-shadow-2xl rounded-xl shadow-black/50"}),_&&s.jsx("button",{onClick:()=>u(!d),className:"absolute top-4 right-4 bg-black/60 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg border border-white/20 hover:border-indigo-400 transition-all group backdrop-blur-md",title:"Flip Card",children:s.jsx("svg",{className:`w-6 h-6 transform transition-transform duration-500 ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),w.artist&&s.jsxs("div",{className:"mt-4 text-white/80 text-xs flex items-center gap-1 bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Illustrated by ",s.jsx("span",{className:"font-medium",children:w.artist})]})]}),s.jsxs("div",{className:"flex-1 flex flex-col md:h-full bg-gray-900/60 backdrop-blur-xl min-h-0 z-10 border-l border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700 bg-gray-900/50 shrink-0 relative group",children:[s.jsx("button",{onClick:()=>p(!h),className:`absolute top-6 right-16 p-2 rounded-full transition-all ${h?"text-indigo-400 bg-indigo-500/20":"text-gray-500 hover:text-white hover:bg-gray-700"}`,title:h?"Cancel Editing":"Edit Card Details",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("h2",{className:"text-3xl font-bold text-white mb-1 pr-10",children:w.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-gray-400 text-sm mt-2",children:[s.jsx("span",{className:"font-medium text-gray-300",children:I.type_line}),I.mana_cost&&s.jsx("span",{className:"bg-gray-800 px-2 py-0.5 rounded border border-gray-700 text-gray-200 font-mono tracking-wider",children:L(I.mana_cost)}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-indigo-400 font-bold",children:w.set_name||w.set?.toUpperCase()}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsx("span",{className:"capitalize",children:w.rarity}),s.jsx("span",{className:"text-gray-600",children:""}),s.jsxs("span",{children:["#",w.collector_number]})]})]})]}),s.jsxs("div",{className:"flex-1 overflow-visible md:overflow-y-auto p-6 space-y-8 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Gameplay & Rules"]}),s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-5 border border-gray-700/50 shadow-inner",children:[I.oracle_text?s.jsx("div",{className:"text-gray-200 whitespace-pre-wrap font-serif leading-relaxed text-lg",children:I.oracle_text.split(`
`).map((Z,G)=>s.jsx("p",{className:"mb-2 last:mb-0",children:Z},G))}):s.jsx("span",{className:"text-gray-500 italic",children:"No rules text."}),I.flavor_text&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 text-gray-400 italic font-serif text-sm",children:['"',I.flavor_text,'"']})]}),(I.power||I.loyalty)&&s.jsx("div",{className:"flex justify-end",children:s.jsx("div",{className:"bg-gray-800 border border-gray-600 px-4 py-2 rounded-lg text-xl font-bold text-white shadow-lg",children:I.power?`${I.power} / ${I.toughness}`:`Loyalty: ${I.loyalty}`})})]}),w.legalities&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Legalities"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[q("Commander",w.legalities.commander),q("Standard",w.legalities.standard),q("Modern",w.legalities.modern),q("Pauper",w.legalities.pauper),q("Legacy",w.legalities.legacy),q("Vintage",w.legalities.vintage)]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Status & Ownership ",h&&s.jsx("span",{className:"text-indigo-400 text-[10px] ml-2 font-normal animate-pulse",children:"(Editing)"})]}),e.is_wishlist&&!h&&s.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-3 animate-pulse space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-orange-500 rounded-full text-white shrink-0",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-orange-400 font-black text-xs uppercase tracking-wider",children:"In Wishlist"}),s.jsx("div",{className:"text-gray-400 text-[10px]",children:"This card is on your want list."})]})]}),s.jsxs("a",{href:`https://partner.tcgplayer.com/jexzaZ?u=${encodeURIComponent(`https://www.tcgplayer.com/search/magic/product?productLineName=magic&q=${e.name}&view=grid`)}`,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center py-2 bg-gray-900/50 hover:bg-gray-900 text-white text-[10px] font-bold uppercase tracking-widest rounded border border-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})}),"Find on TCGPlayer"]})]}),(()=>{const Z=w.id,G=n.filter(re=>re.scryfall_id===Z||re.scryfallId===Z||re.id===Z),F=G.filter(re=>!re.is_wishlist&&re.finish==="nonfoil").reduce((re,ue)=>re+(ue.count||1),0),Y=G.filter(re=>!re.is_wishlist&&re.finish==="foil").reduce((re,ue)=>re+(ue.count||1),0),ne=G.filter(re=>re.is_wishlist).reduce((re,ue)=>re+(ue.count||1),0);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${F>0?"bg-indigo-500/10 border-indigo-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Normal"}),s.jsx("div",{className:"text-xl font-black text-white",children:F}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${Y>0?"bg-purple-500/10 border-purple-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Foil"}),s.jsx("div",{className:"text-xl font-black text-indigo-400",children:Y}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Owned"})]}),s.jsxs("div",{className:`p-2.5 rounded-xl border transition-all ${ne>0?"bg-orange-500/10 border-orange-500/30":"bg-gray-800/20 border-gray-700/30 opacity-40"}`,children:[s.jsx("div",{className:"text-[10px] font-black uppercase tracking-tighter text-gray-400 mb-0.5",children:"Wishlist"}),s.jsx("div",{className:"text-xl font-black text-orange-400",children:ne}),s.jsx("div",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Wanted"})]})]}),(h||e.firestoreId||e.firestore_id)&&s.jsxs("div",{className:"bg-gray-950/40 rounded-xl overflow-hidden border border-gray-700/50",children:[s.jsxs("div",{className:"px-3 py-2 bg-gray-800/40 border-b border-gray-700/50 flex justify-between items-center text-[10px] uppercase font-black tracking-widest text-gray-400",children:[s.jsx("span",{children:"Selected Item Details"}),e.is_wishlist&&s.jsx("span",{className:"text-orange-500",children:"Wishlist Copy"})]}),s.jsxs("table",{className:"w-full text-xs text-left",children:[s.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2",children:"Location"}),s.jsx("th",{className:"px-3 py-2 text-center",children:"Foil"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Added"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700/30 text-gray-300",children:s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2",children:h?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("select",{value:m.deckId,onChange:re=>x({...m,deckId:re.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full",children:[s.jsx("option",{value:"",children:"Binder"}),b.map(re=>s.jsxs("option",{value:re.id,children:["Deck: ",re.name]},re.id))]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-500 text-[9px]",children:"PAID $"}),s.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:m.price_bought,onChange:re=>x({...m,price_bought:re.target.value}),className:"bg-gray-800 border-none rounded px-2 py-0.5 text-[10px] text-white w-20 focus:ring-1 focus:ring-indigo-500"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:m.tags&&m.tags.map(re=>s.jsxs("span",{className:"bg-indigo-600/50 text-white px-1.5 rounded text-[9px] flex items-center gap-1 border border-indigo-500/30",children:[re,s.jsx("button",{onClick:()=>X(re),className:"hover:text-red-300",children:""})]},re))}),s.jsx("input",{type:"text",placeholder:"+ Tag...",value:m.currentTag,onChange:re=>x({...m,currentTag:re.target.value}),onKeyDown:V,className:"bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-[10px] text-white w-full focus:ring-1 focus:ring-indigo-500"})]})]}):s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{children:e.deckId?`Deck #${e.deckId}`:"Binder"}),e.tags&&(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(typeof e.tags=="string"?JSON.parse(e.tags):e.tags).map(re=>s.jsx("span",{className:"text-[9px] bg-gray-700 px-1 rounded text-gray-300",children:re},re))})]})}),s.jsx("td",{className:"px-3 py-2 text-center align-top",children:h?s.jsx("input",{type:"checkbox",checked:m.finish==="foil",onChange:re=>x({...m,finish:re.target.checked?"foil":"nonfoil"}),className:"rounded bg-gray-700 border-gray-600 text-indigo-600",title:"Is Foil?"}):e.finish==="foil"?"Yes":"-"}),s.jsx("td",{className:"px-3 py-2 text-right font-black align-top",children:h?s.jsx("input",{type:"number",min:"1",value:m.quantity,onChange:re=>x({...m,quantity:re.target.value}),className:"bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-[10px] text-white w-12 text-center"}):e.count||e.quantity||1}),s.jsxs("td",{className:"px-3 py-2 text-right text-gray-500 font-mono text-[10px] align-top",children:[s.jsx("div",{children:e.added_at?new Date(e.added_at).toLocaleDateString():"N/A"}),e.price_bought&&s.jsxs("div",{className:"text-green-500/70 mt-1",title:"Price Paid",children:["$",parseFloat(e.price_bought).toFixed(2)]})]})]})})]})]}),e.is_wishlist&&!h&&s.jsxs("button",{onClick:async()=>{try{await a(e.id||e.firestoreId,{is_wishlist:!1}),l("Card moved to collection!","success")}catch{l("Failed to move card","error")}},className:"w-full py-2.5 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-lg shadow-lg shadow-orange-900/30 transition-all flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})}),"I Got This Copy!"]})]})})()]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Art & Aesthetics"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Artist"}),s.jsx("span",{className:"text-white font-medium",children:w.artist||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Frame"}),s.jsx("span",{className:"text-white",children:w.frame||"2015"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Border Color"}),s.jsx("span",{className:"text-white capitalize",children:w.border_color||"Black"})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Finishes"}),s.jsx("span",{className:"text-white capitalize",children:w.finishes?.join(", ")})]}),w.watermark&&s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Watermark"}),s.jsx("span",{className:"text-white capitalize",children:w.watermark})]}),s.jsxs("div",{className:"flex justify-between border-b border-gray-800 py-1",children:[s.jsx("span",{className:"text-gray-500",children:"Illustration ID"}),s.jsxs("span",{className:"text-gray-400 font-mono text-xs",children:[w.illustration_id?.slice(0,8),"..."]})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700/50",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Developer / Metadata"]}),s.jsxs("div",{className:"bg-gray-900/30 rounded-xl p-4 border border-gray-700/50 space-y-2 text-sm font-mono",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"External Links"}),s.jsx("a",{href:w.scryfall_uri,target:"_blank",rel:"noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"View on Scryfall"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Scryfall ID"}),s.jsx("span",{className:"text-gray-400",children:w.id})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Oracle ID"}),s.jsx("span",{className:"text-gray-400",children:w.oracle_id})]}),e.firestoreId&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Database ID"}),s.jsx("span",{className:"text-gray-400",children:e.firestoreId})]}),s.jsxs("div",{className:"border-t border-gray-800 pt-2 mt-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Released At"}),s.jsx("span",{className:"text-gray-300",children:w.released_at})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Reserved List"}),s.jsx("span",{className:w.reserved?"text-red-400":"text-gray-400",children:w.reserved?"true":"false"})]})]})]})]}),h&&s.jsxs("div",{className:"pt-6 mt-6 border-t border-gray-700 flex gap-4 animate-fade-in-up",children:[s.jsx("button",{onClick:()=>p(!1),className:"flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg border border-gray-500 transition-all font-bold tracking-wide uppercase text-sm",children:"Cancel"}),s.jsx("button",{onClick:K,className:"flex-1 bg-red-600/80 hover:bg-red-600 text-white py-3 rounded-lg shadow-md transition-all font-bold tracking-wide uppercase text-sm",children:"Delete Card"}),s.jsx("button",{onClick:W,className:"flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg shadow-lg shadow-green-900/20 transition-all font-bold tracking-wide uppercase text-sm",children:"Save Changes"})]})]})]})]})]})},_5e=({children:t})=>{const{currentUser:e,userProfile:r,loading:n}=Mt(),i=yi(),a=on(),[l,d]=y.useState(!1);return y.useEffect(()=>{if(!e&&!n){d(!1);return}if(!(n||l)&&e&&r){const h=["/","/login","/about"].includes(i.pathname)||i.pathname.startsWith("/share/"),p=i.pathname==="/onboarding";!r.settings?.onboarding_complete&&!p&&!h&&a("/onboarding"),d(!0)}},[e,r,n,i,a,l]),n?s.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-indigo-500",children:"Loading..."}):t},C5e=()=>{const{addToast:t}=_r();return y.useEffect(()=>(qE(t),()=>qE(null)),[t]),null},E5e=()=>{const t=yi();return y.useEffect(()=>{const r=new URLSearchParams(t.search).get("ref");r&&(console.log("[ReferralTracker] Capturing referral code:",r),localStorage.setItem("mtg_forge_ref",r))},[t]),null};function A5e(){return s.jsx(BY,{children:s.jsx(IY,{children:s.jsx(UY,{children:s.jsxs("div",{className:"bg-gray-900 text-gray-200 font-sans min-h-screen flex flex-col",children:[s.jsx(kH,{}),s.jsx(E5e,{}),s.jsx(yQ,{}),s.jsx(_5e,{children:s.jsx("div",{className:"flex-grow pb-24 md:pb-0",children:s.jsxs(FF,{children:[s.jsx(Cr,{path:"/",element:s.jsx(TQ,{})}),s.jsx(Cr,{path:"/about",element:s.jsx(x5e,{})}),s.jsx(Cr,{path:"/dashboard",element:s.jsx(Aoe,{})}),s.jsx(Cr,{path:"/login",element:s.jsx(Moe,{})}),s.jsx(Cr,{path:"/onboarding",element:s.jsx(g5e,{})}),s.jsx(Cr,{path:"/collection",element:s.jsx(qoe,{})}),s.jsx(Cr,{path:"/pricing",element:s.jsx(Ooe,{})}),s.jsx(Cr,{path:"/decks",element:s.jsx(Voe,{})}),s.jsx(Cr,{path:"/precons",element:s.jsx(_w,{})}),s.jsx(Cr,{path:"/precons/type/:type",element:s.jsx(_w,{})}),s.jsx(Cr,{path:"/precons/set/:set",element:s.jsx(_w,{})}),s.jsx(Cr,{path:"/precons/deck/:id",element:s.jsx(c5e,{})}),s.jsx(Cr,{path:"/decks/new",element:s.jsx(Yoe,{})}),s.jsx(Cr,{path:"/decks/:deckId",element:s.jsx(rle,{})}),s.jsx(Cr,{path:"/share/:slug",element:s.jsx(y5e,{})}),s.jsx(Cr,{path:"/decks/:deckId/build",element:s.jsx(d5e,{})}),s.jsx(Cr,{path:"/sets",element:s.jsx(sle,{})}),s.jsx(Cr,{path:"/sets/:setCode",element:s.jsx(ile,{})}),s.jsx(Cr,{path:"/wishlist",element:s.jsx(Hce,{})}),s.jsx(Cr,{path:"/settings/:tab?",element:s.jsx(Fce,{})}),s.jsx(Cr,{path:"/audit",element:s.jsx(YL,{})}),s.jsx(Cr,{path:"/audit/:id",element:s.jsx(YL,{})}),s.jsx(Cr,{path:"/audit/:auditId/wizard",element:s.jsx(N5e,{})}),s.jsx(Cr,{path:"/remote/:sessionId",element:s.jsx(v5e,{})}),s.jsx(Cr,{path:"/strategy",element:s.jsx(w5e,{})})]})})}),s.jsx(C5e,{}),s.jsx(k5e,{}),s.jsx(S5e,{})]})})})})}Gq.createRoot(document.getElementById("root")).render(s.jsx(Ge.StrictMode,{children:s.jsx(pH,{children:s.jsx(A5e,{})})}))});export default T5e();
